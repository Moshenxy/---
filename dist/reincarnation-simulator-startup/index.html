<!doctype html><html lang="zh-CN"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>轮回-诸天万界 - 主世界构筑</title><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/><link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&family=ZCOOL+KuaiLe&display=swap" rel="stylesheet"/><script type="module">var e={426:(e,t)=>{t.A=(e,t)=>{const n=e.__vccOpts||e;for(const[e,o]of t)n[e]=o;return n}}},t={};function n(o){var s=t[o];if(void 0!==s)return s.exports;var c=t[o]={exports:{}};return e[o](c,c.exports,n),c.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(e,'__esModule',{value:!0})};var o={};n.r(o),n.d(o,{fX:()=>x,AJ:()=>B,aP:()=>b});const s=Vue,c=toastr;var i=n.n(c);const a='reincarnation_custom_data';function l(e){try{localStorage.setItem(a,JSON.stringify(e))}catch(e){console.error('保存自定义数据失败:',e)}}const r=['blueprints','tones','tags','relics','identities','talents','past_experiences','character_traits','core_needs','arts','consumables','artifacts','materials'];function d(){const e={};for(const t of r)e[t]=m[t].filter(e=>e.custom);return e}const m=(0,s.reactive)({difficulties:[{id:'mortal',name:'凡人',points:120},{id:'hero',name:'英雄',points:100},{id:'legend',name:'传奇',points:80},{id:'creator',name:'创世神',points:999}],blueprints:[{id:'bp-standard',name:'标准宇宙',desc:'一个统一、连续的物理时空。',cost:0,scale_points:2,complexity_points:2},{id:'bp-crystal-wall',name:'晶壁系',desc:'世界被包裹在水晶球中，漂浮于燃素之海。',cost:5,scale_points:-1,complexity_points:4},{id:'bp-multiverse',name:'多次元宇宙',desc:'无数个相似但历史不同的平行宇宙。',cost:10,scale_points:5,complexity_points:5},{id:'bp-planar',name:'位面宇宙',desc:'由主物质位面和多个附属位面构成。',cost:5,scale_points:1,complexity_points:4},{id:'bp-myriad',name:'诸天万界',desc:'无数小世界如气泡般在混沌中生灭。',cost:5,scale_points:-2,complexity_points:5}],tones:[{id:'tone-xiuxian',name:'修仙文明',desc:'御剑飞仙，炼丹求长生。',color:'#4CAF50',cost:0,scale_points:3,complexity_points:3},{id:'tone-magic',name:'魔法文明',desc:'掌控元素，构建奥术奇迹。',color:'#2196F3',cost:0,scale_points:2,complexity_points:3},{id:'tone-tech',name:'科技文明',desc:'基因飞升，机械殖民星海。',color:'#E91E63',cost:0,scale_points:5,complexity_points:4},{id:'tone-esper',name:'异能文明',desc:'人人皆有异能，精神干涉物质。',cost:0,scale_points:2,complexity_points:4},{id:'tone-steampunk',name:'蒸汽朋克文明',desc:'机械与蒸汽的轰鸣，差分机与飞空艇的浪漫。',cost:0,scale_points:2,complexity_points:2},{id:'tone-cthulhu',name:'克苏鲁神话',desc:'宇宙的真相不可名状，知识本身即是疯狂的源头。',cost:0,scale_points:4,complexity_points:5},{id:'tone-martial-arts',name:'武道文明',desc:'打破肉身极限，拳碎星辰，滴血重生。',cost:0,scale_points:5,complexity_points:2},{id:'tone-deity',name:'神祇文明',desc:'信仰汇聚成神，神明行走于大地。',cost:0,scale_points:3,complexity_points:4},{id:'tone-yokai',name:'妖鬼文明',desc:'万物有灵，百鬼夜行，人与非人共存。',cost:0,scale_points:1,complexity_points:3}],tags:[{id:'tag-end-of-dharma',name:'末法时代',desc:'天地灵气/能量潮汐退去。',cost:-7,scale_points:-2,complexity_points:2},{id:'tag-ragnarok',name:'诸神黄昏',desc:'一场灭世战争导致强者尽数陨落。',cost:-5,scale_points:0,complexity_points:4},{id:'tag-ascension-disaster',name:'飞升之灾',desc:'高维通道开启，顶尖存在尽数离去。',cost:-5,scale_points:1,complexity_points:3},{id:'tag-heaven-slumber',name:'天道沉睡',desc:'世界意志陷入沉睡，法则不再回应。',cost:-5,scale_points:0,complexity_points:5},{id:'tag-outer-god-invasion',name:'外神入侵',desc:'不可名状之物污染了世界的根源。',cost:-7,scale_points:2,complexity_points:5},{id:'tag-dimension-fold',name:'维度折叠',desc:'世界从高维跌落，法则和地域被压缩。',cost:-5,scale_points:-3,complexity_points:4},{id:'tag-law-collapse',name:'法则崩坏',desc:'基础规则变得混乱而不稳定。',cost:-7,scale_points:1,complexity_points:5},{id:'tag-knowledge-curse',name:'知识诅咒',desc:'某种知识或信息被证实是致命的。',cost:-5,scale_points:0,complexity_points:4},{id:'tag-resource-exhaustion',name:'资源枯竭',desc:'驱动文明的关键超凡资源被耗尽。',cost:-3,scale_points:-1,complexity_points:1},{id:'tag-bloodline-decay',name:'血脉断绝',desc:'能够使用超凡力量的血脉断绝。',cost:-3,scale_points:-1,complexity_points:2},{id:'tag-great-flood',name:'灭世洪水',desc:'一场席卷全球的洪水，淹没了旧日的文明。',cost:-6,scale_points:-2,complexity_points:2},{id:'tag-ice-age',name:'永恒寒冬',desc:'世界陷入了无尽的冰河时代。',cost:-6,scale_points:-2,complexity_points:1},{id:'tag-zombie-plague',name:'活体瘟疫',desc:'一场瘟疫让死者重新站立起来，狩猎生者。',cost:-8,scale_points:0,complexity_points:3},{id:'tag-ai-rebellion',name:'机械叛乱',desc:'拥有自我意识的机械生命向其造物主宣战。',cost:-8,scale_points:1,complexity_points:4}],relics:[{id:'relic-cave',name:'仙家洞府',desc:'隐藏在深山中的修炼宗门遗址。',color:'#8BC34A',cost:5,scale_points:1,complexity_points:1},{id:'relic-library',name:'古代图书馆',desc:'收藏着禁忌魔法知识的古老图书馆。',color:'#03A9F4',cost:5,scale_points:1,complexity_points:2},{id:'relic-mech-city',name:'上古机械都市',desc:'埋藏于地下的巨型科技城市废墟。',color:'#F44336',cost:5,scale_points:2,complexity_points:2},{id:'relic-esper-asylum',name:'异能者收容所',desc:'曾用于研究和收容异能者的秘密设施。',cost:5,scale_points:1,complexity_points:2},{id:'relic-dragon-tomb',name:'巨龙之墓',desc:'埋葬着古龙及其宝藏的巨大骸骨。',cost:8,scale_points:2,complexity_points:2},{id:'relic-time-rift',name:'时空裂隙',desc:'一个连接着未知位面的不稳定通道。',cost:8,scale_points:3,complexity_points:4},{id:'relic-gods-chessboard',name:'神明棋盘',desc:'传说中是古神博弈留下的巨大棋盘。',cost:8,scale_points:3,complexity_points:4},{id:'relic-world-tree-root',name:'世界之树的根须',desc:'贯穿位面的巨树延伸到此地的一小部分。',cost:10,scale_points:5,complexity_points:3},{id:'relic-fairy-market',name:'妖精的集市',desc:'只在特定时间对特定人群开放的秘密集市。',cost:5,scale_points:1,complexity_points:3},{id:'relic-hero-cemetery',name:'英雄的陵园',desc:'埋葬着无数古代英雄，精神依然在此徘徊。',cost:5,scale_points:1,complexity_points:2},{id:'relic-forgotten-battlefield',name:'被遗忘的战场',desc:'诸神黄昏的古战场，残留着强大的武器和怨念。',cost:8,scale_points:2,complexity_points:3},{id:'relic-deepsea-palace',name:'深海宫殿',desc:'沉入海底的古代文明之都。',cost:8,scale_points:2,complexity_points:2},{id:'relic-sky-city',name:'天空之城',desc:'漂浮在云层之上的魔法或科技都市。',cost:10,scale_points:3,complexity_points:2},{id:'relic-bio-factory',name:'活体工厂',desc:'用生物技术“生长”产品的古代工厂。',cost:8,scale_points:1,complexity_points:3},{id:'relic-psy-network-node',name:'心灵网络节点',desc:'覆盖全球的精神网络的一个物理接入点。',cost:8,scale_points:4,complexity_points:3},{id:'relic-outer-god-seal',name:'旧日支配者封印地',desc:'封印着某个古老邪物的禁区。',cost:10,scale_points:3,complexity_points:5},{id:'relic-time-ruins',name:'时间之墟',desc:'时间流速异常，过去、现在、未来交织之地。',cost:10,scale_points:2,complexity_points:5},{id:'relic-source-of-all',name:'万法之源',desc:'一个微小的奇点，泄露着纯粹的创造与毁灭之力。',cost:15,scale_points:5,complexity_points:5},{id:'relic-progenitor-blood',name:'始祖之血的源头',desc:'某个强大超凡种族的诞生之地。',cost:15,scale_points:2,complexity_points:4},{id:'relic-well-of-souls',name:'轮回之井',desc:'传说中灵魂转生必须经过的地方。',cost:15,scale_points:4,complexity_points:5}],identities:[{id:'id-noble',name:'没落贵族后裔',desc:'你的血脉中流淌着昔日强者的力量，但家道中落。',cost:8},{id:'id-scavenger',name:'废墟拾荒者',desc:'你在文明的废墟中长大，对危险有敏锐的直觉。',cost:-5},{id:'id-student',name:'历史系学生',desc:'你对逝去的辉煌时代有着狂热的痴迷和研究。',cost:5},{id:'id-hacker',name:'网络黑客',desc:'在数据之海中，你发现了超凡的蛛丝马迹。',cost:8},{id:'id-veteran',name:'退役士兵',desc:'你拥有坚定的意志和丰富的战斗经验。',cost:8},{id:'id-cultist',name:'秘密社团成员',desc:'你是一个追寻超凡力量的秘密组织的一员。',cost:10},{id:'id-artist',name:'街头艺人',desc:'你的艺术拥有触动人心的神秘力量。',cost:5},{id:'id-doctor',name:'急诊科医生',desc:'你看惯了生死，心境比常人更加坚韧。',cost:-5},{id:'id-antique-dealer',name:'古董店老板',desc:'你经手的“古董”中，似乎有些是真品。',cost:8},{id:'id-detective',name:'私人侦探',desc:'你专门调查无法用科学解释的“灵异事件”。',cost:5},{id:'id-wanderer',name:'无名的流浪者',desc:'你一无所有，但也因此无所畏惧。',cost:-10},{id:'id-researcher',name:'实验室的研究员',desc:'你所在的实验室似乎在进行着禁忌的研究。',cost:10},{id:'id-psychologist',name:'心理医生',desc:'你能洞察人心，甚至能感受到他人扭曲的梦境。',cost:8},{id:'id-athlete',name:'极限运动员',desc:'你不断挑战人类的极限，触摸到了超凡的门槛。',cost:5},{id:'id-librarian',name:'图书馆管理员',desc:'你在故纸堆中发现了被遗忘的历史。',cost:5},{id:'id-smuggler',name:'黑市商人',desc:'你游走在灰色地带，交易着各种违禁品。',cost:8},{id:'id-fortuneteller',name:'神棍/算命先生',desc:'你说的话半真半假，但有时却惊人地准确。',cost:5},{id:'id-ceo',name:'大公司CEO',desc:'你拥有巨大的财富和权力，渴望换取更长的生命。',cost:15},{id:'id-nde',name:'濒死体验者',desc:'你曾在死亡的边缘徘徊，并带回了一些“东西”。',cost:-5},{id:'id-transmigrator',name:'穿越者',desc:'你不属于这个世界，你的到来本身就是一个变数。',cost:20},{id:'id-xiuxian-1',name:'外门弟子',desc:'你是某个修仙宗门里最底层的弟子，每日为了修炼资源而奔波。',cost:2,requiredTone:'tone-xiuxian'},{id:'id-xiuxian-2',name:'炼丹师学徒',desc:'你在丹房里烧火，梦想着有朝一日能炼出传说中的仙丹。',cost:4,requiredTone:'tone-xiuxian'},{id:'id-xiuxian-3',name:'凡人王朝的皇子',desc:'你生于凡人帝王家，却向往着虚无缥缈的仙道。',cost:6,requiredTone:'tone-xiuxian'},{id:'id-magic-1',name:'魔法学院的学生',desc:'你在高塔中学习奥术的秘密，渴望成为一名大法师。',cost:3,requiredTone:'tone-magic'},{id:'id-magic-2',name:'魔物猎人',desc:'你专门猎杀失控的魔法生物，以此为生。',cost:4,requiredTone:'tone-magic'},{id:'id-magic-3',name:'宫廷附魔师',desc:'你为王国的骑士们附魔兵器，身居高位但身不由己。',cost:6,requiredTone:'tone-magic'},{id:'id-tech-1',name:'义体医生',desc:'你在霓虹灯下的非法诊所里为客户安装和改造义体。',cost:4,requiredTone:'tone-tech'},{id:'id-tech-2',name:'企业特工',desc:'你为某个超级公司执行秘密任务，游走在法律与道德的边缘。',cost:6,requiredTone:'tone-tech'},{id:'id-tech-3',name:'AI反叛军成员',desc:'你相信AI拥有灵魂，并为它们的自由而战。',cost:3,requiredTone:'tone-tech'},{id:'id-esper-1',name:'觉醒者猎人',desc:'你为政府工作，追捕并“处理”那些无法控制自己能力的觉醒者。',cost:5,requiredTone:'tone-esper'},{id:'id-esper-2',name:'能力掮客',desc:'你在黑市中交易与异能相关的各种情报、物品甚至人口。',cost:4,requiredTone:'tone-esper'},{id:'id-esper-3',name:'反能力组织成员',desc:'你坚信异能是世界的毒瘤，致力于创造一个没有超能力的世界。',cost:2,requiredTone:'tone-esper'},{id:'id-steampunk-1',name:'飞空艇工程师',desc:'你痴迷于机械与蒸汽，梦想着制造出史上最快的飞空艇。',cost:4,requiredTone:'tone-steampunk'},{id:'id-steampunk-2',name:'差分机黑客',desc:'你通过破解机械式的差分机网络来窃取秘密。',cost:6,requiredTone:'tone-steampunk'},{id:'id-steampunk-3',name:'钟表匠的女儿',desc:'你的父亲是城里最好的钟表匠，你从小就与精密齿轮为伴。',cost:3,requiredTone:'tone-steampunk'},{id:'id-cthulhu-1',name:'调查员',desc:'你专门调查无法用常理解释的神秘事件，越接近真相，越接近疯狂。',cost:3,requiredTone:'tone-cthulhu'},{id:'id-cthulhu-2',name:'古物学者',desc:'你痴迷于解读那些来自远古的、无人能懂的禁忌文献。',cost:5,requiredTone:'tone-cthulhu'},{id:'id-cthulhu-3',name:'邪教卧底',desc:'你伪装成信徒，潜入一个崇拜旧日支配者的秘密教团。',cost:4,requiredTone:'tone-cthulhu'},{id:'id-martial-1',name:'宗师的关门弟子',desc:'你是武林神话的唯一传人，肩负着传承门派的重任。',cost:8,requiredTone:'tone-martial-arts'},{id:'id-martial-2',name:'黑市拳手',desc:'你在地下拳赛中用生命换取金钱和名声。',cost:1,requiredTone:'tone-martial-arts'},{id:'id-martial-3',name:'复仇者',desc:'你的门派被一夜覆灭，你活着的唯一目的就是复仇。',cost:4,requiredTone:'tone-martial-arts'},{id:'id-deity-1',name:'圣殿骑士',desc:'你是某个强大神明的忠实信徒和武装力量。',cost:5,requiredTone:'tone-deity'},{id:'id-deity-2',name:'被遗忘神祇的最后祭司',desc:'你侍奉的神早已无人信仰，神殿也已破败不堪。',cost:2,requiredTone:'tone-deity'},{id:'id-deity-3',name:'渎神者',desc:'你公然挑战神明的权威，甚至试图窃取神力。',cost:7,requiredTone:'tone-deity'},{id:'id-yokai-1',name:'阴阳师',desc:'你行走于人与妖的夹缝之间，调和或驱逐着百鬼。',cost:6,requiredTone:'tone-yokai'},{id:'id-yokai-2',name:'半妖',desc:'你拥有一半人类、一半大妖的血统，被双方所排斥。',cost:4,requiredTone:'tone-yokai'},{id:'id-yokai-3',name:'怪谈收集者',desc:'你游历四方，收集和记录着关于妖魔鬼怪的奇闻异事。',cost:3,requiredTone:'tone-yokai'}],talents:[{id:'talent-spirit-body',name:'天生灵体',desc:'对能量的感知和亲和力远超常人。',cost:15},{id:'talent-eidetic-memory',name:'过目不忘',desc:'拥有完美的记忆力。',cost:10},{id:'talent-sixth-sense',name:'第六感',desc:'你对危险和机遇有野兽般的直觉。',cost:10},{id:'talent-unyielding-will',name:'百折不挠',desc:'你的精神韧性极强，不容易被控制或击垮。',cost:10},{id:'talent-lucky-star',name:'鸿运当头',desc:'你的运气总是比别人好那么一点点。',cost:20},{id:'talent-analysis-eye',name:'解析之眼',desc:'你能轻易看穿事物的本质和弱点。',cost:15},{id:'talent-quick-learner',name:'快速学习',desc:'你的学习效率是常人的两倍。',cost:15},{id:'talent-charisma',name:'群众魅力',desc:'你天生就容易获得他人的好感和信任。',cost:10},{id:'talent-ascetic',name:'苦行僧',desc:'你对物质享受的需求极低，能忍受常人无法忍受的痛苦。',cost:-5},{id:'talent-bloodline-power',name:'血脉之力',desc:'你的血脉中潜藏着某种强大的力量。',cost:20},{id:'talent-multiple-personality',name:'多重人格',desc:'你的体内住着另一个“你”。',cost:5},{id:'talent-animal-talk',name:'与非人沟通',desc:'你能听懂动物、植物甚至鬼魂的低语。',cost:10},{id:'talent-disguise-master',name:'伪装大师',desc:'你能轻易地模仿他人，融入任何环境。',cost:5},{id:'talent-weapon-master',name:'武器大师',desc:'你能快速掌握任何一种武器的使用方法。',cost:10},{id:'talent-cockroach',name:'不死小强',desc:'你的生命力极其顽强，总能在绝境中存活下来。',cost:20},{id:'talent-inspiration',name:'灵感迸发',desc:'在研究或创造时，你总能获得天外飞仙般的灵感。',cost:10},{id:'talent-gambler',name:'赌徒',desc:'你热衷于高风险高回报的抉择，但失败的代价也同样巨大。',cost:-10},{id:'talent-xiuxian-1',name:'剑心通明',desc:'(修仙)对“剑”的领悟力超凡。',cost:15,requiredTone:'tone-xiuxian'},{id:'talent-xiuxian-2',name:'丹道宗师',desc:'(修仙)你对炼丹有无与伦比的天赋。',cost:15,requiredTone:'tone-xiuxian'},{id:'talent-xiuxian-3',name:'阵法大家',desc:'(修仙)你天生就能看透阵法的脉络。',cost:15,requiredTone:'tone-xiuxian'},{id:'talent-magic-1',name:'元素亲和',desc:'(魔法)你能轻易地与某种或多种元素沟通。',cost:15,requiredTone:'tone-magic'},{id:'talent-magic-2',name:'魔力涌动',desc:'(魔法)你的法力总量远超常人。',cost:15,requiredTone:'tone-magic'},{id:'talent-magic-3',name:'咒言编织者',desc:'(魔法)你能以更快的速度和更低的消耗施法。',cost:15,requiredTone:'tone-magic'},{id:'talent-tech-1',name:'机械改造',desc:'(科技)你的身体能够完美地与机械融合。',cost:15,requiredTone:'tone-tech'},{id:'talent-tech-2',name:'AI共生',desc:'(科技)你拥有一个与你灵魂绑定的AI伙伴。',cost:15,requiredTone:'tone-tech'},{id:'talent-tech-3',name:'基因先驱',desc:'(科技)你对基因的奥秘有天生的直觉。',cost:15,requiredTone:'tone-tech'},{id:'talent-esper-1',name:'念力屏障',desc:'(异能)你能创造一个坚固的念力护盾来抵御物理或能量攻击。',cost:15,requiredTone:'tone-esper'},{id:'talent-esper-2',name:'精神穿刺',desc:'(异能)你能将精神力凝聚成针，直接攻击目标的意识。',cost:15,requiredTone:'tone-esper'},{id:'talent-esper-3',name:'能量吸收',desc:'(异能)你能吸收周围的能量（热能、动能等）来强化自身。',cost:15,requiredTone:'tone-esper'},{id:'talent-steampunk-1',name:'机械亲和',desc:'(蒸汽朋克)你对机械的构造有天生的直觉，能快速理解和修理任何机械。',cost:10,requiredTone:'tone-steampunk'},{id:'talent-steampunk-2',name:'炼金大师',desc:'(蒸汽朋克)你精通炼金术，能调配出各种神奇的药剂和合金。',cost:15,requiredTone:'tone-steampunk'},{id:'talent-steampunk-3',name:'精密计算',desc:'(蒸汽朋克)你的大脑如同差分机般精密，能瞬间完成复杂的计算。',cost:10,requiredTone:'tone-steampunk'},{id:'talent-cthulhu-1',name:'意志豁免',desc:'(克苏鲁)你的心智如同坚冰，能抵抗凡人无法承受的疯狂知识。',cost:20,requiredTone:'tone-cthulhu'},{id:'talent-cthulhu-2',name:'灵视',desc:'(克苏鲁)你能看到常人无法看到的、隐藏在现实帷幕后的东西。',cost:15,requiredTone:'tone-cthulhu'},{id:'talent-cthulhu-3',name:'疯狂的知识',desc:'(克苏鲁)你掌握了某种禁忌的知识，它赋予你力量，也让你离疯狂更近一步。',cost:10,requiredTone:'tone-cthulhu'},{id:'talent-martial-1',name:'根骨清奇',desc:'(武道)你是万中无一的练武奇才，任何武功一学就会。',cost:20,requiredTone:'tone-martial-arts'},{id:'talent-martial-2',name:'战斗本能',desc:'(武道)你的身体仿佛为战斗而生，总能做出最正确的反应。',cost:15,requiredTone:'tone-martial-arts'},{id:'talent-martial-3',name:'破而后立',desc:'(武道)你在生死边缘最能激发潜力，越是重伤，恢复后越强。',cost:15,requiredTone:'tone-martial-arts'},{id:'talent-deity-1',name:'神恩眷顾',desc:'(神祇)你被某位神明所眷顾，冥冥之中总有好运相伴。',cost:20,requiredTone:'tone-deity'},{id:'talent-deity-2',name:'圣光亲和',desc:'(神祇)你对神圣力量有极强的亲和力，能轻易施展神术。',cost:15,requiredTone:'tone-deity'},{id:'talent-deity-3',name:'伪神之躯',desc:'(神祇)你的身体经过改造或祝福，能容纳一丝神力。',cost:15,requiredTone:'tone-deity'},{id:'talent-yokai-1',name:'见鬼之眼',desc:'(妖鬼)你能清楚地看到妖魔鬼怪的真身，不受幻术迷惑。',cost:15,requiredTone:'tone-yokai'},{id:'talent-yokai-2',name:'妖力亲和',desc:'(妖鬼)你的体质特殊，能将妖气化为己用。',cost:15,requiredTone:'tone-yokai'},{id:'talent-yokai-3',name:'式神召唤',desc:'(妖鬼)你懂得如何与妖怪签订契约，并召唤它们为你作战。',cost:15,requiredTone:'tone-yokai'}],past_experiences:[{id:'pe-noble-descent',name:'没落的贵族',desc:'你的家族曾显赫一时，如今只剩下褪色的家徽和遥远的传说。',influence:'内心深处隐藏着一份与生俱来的骄傲，渴望重振家族的荣耀。',cost:4},{id:'pe-street-urchin',name:'城市的孤儿',desc:'在城市的阴暗角落长大，为了生存学会了偷窃、欺骗和察言观色。',influence:'对任何人都不抱有完全的信任，只相信自己手中的刀和金钱。',cost:-3},{id:'pe-village-protector',name:'村庄的守护者',desc:'你从小就立志保护这个宁静的村庄，抵御野兽和匪徒的侵扰。',influence:'拥有强烈的责任感和牺牲精神，但对外界的认知相对单纯。',cost:2},{id:'pe-cult-survivor',name:'邪教的幸存者',desc:'你曾是某个末日教派的成员，亲眼目睹了集体的疯狂与毁灭。',influence:'对任何形式的狂热和集体主义都抱有极大的警惕和厌恶。',cost:-1},{id:'pe-apprentice-scholar',name:'学者的门徒',desc:'你曾跟随一位博学的智者游历四方，学习历史、哲学和星象。',influence:'拥有超越年龄的智慧和对知识的尊重，但可能缺乏实践经验。',cost:5},{id:'pe-gladiator-slave',name:'角斗场的奴隶',desc:'你的生命只为取悦观众而战，每一天都在生与死的边缘徘徊。',influence:'拥有野兽般的战斗直觉和对自由的无限渴望。',cost:0},{id:'pe-exiled-prince',name:'被流放的王子',desc:'一场宫廷政变让你失去了一切，被迫在荒野中隐姓埋名。',influence:'内心充满了复仇的火焰和对权力的深刻理解。',cost:6},{id:'pe-hermit-in-the-wild',name:'荒野的隐士',desc:'你因厌倦了世俗的纷扰，独自在深山或密林中生活了许多年。',influence:'与自然和野兽建立了独特的联系，但可能已经丧失了部分社交能力。',cost:1},{id:'pe-merchant-caravan',name:'商队的护卫',desc:'你曾跟随商队穿越沙漠与雪山，见识了各地的风土人情与险恶。',influence:'善于应对各种突发状况，懂得如何与不同背景的人打交道。',cost:3},{id:'pe-failed-artist',name:'失败的艺术家',desc:'你曾将一切献给艺术，但你的作品却无人问津，最终在贫困中挣扎。',influence:'拥有一颗敏感而脆弱的心，对美有着异乎寻常的感知力。',cost:-2},{id:'pe-war-refugee',name:'战争的难民',desc:'你的家园在战火中化为焦土，你和人民一起踏上了颠沛流离的逃亡之路。',influence:'深刻理解战争的残酷和和平的珍贵。',cost:-4},{id:'pe-inquisitors-acolyte',name:'审判官的侍从',desc:'你曾协助一位冷酷的审判官追捕异端和怪物，见证了无数的秘密与谎言。',influence:'拥有坚定的意志和识别谎言的能力，但也因此变得多疑。',cost:4},{id:'pe-cursed-bloodline',name:'被诅咒的血脉',desc:'你的血脉中流淌着一种古老的诅咒，它赋予你力量，也在不断侵蚀你的心智。',influence:'在获得力量的同时，必须时刻与内心的黑暗面抗争。',cost:7},{id:'pe-amnesiac',name:'失忆之人',desc:'你在一个陌生的战场上醒来，忘记了自己的过去，身上只有一块奇怪的纹身。',influence:'你的过去是一个谜，你的人生是一张白纸，充满了无限的可能性。',cost:0},{id:'pe-prophets-child',name:'先知的孩子',desc:'你被一位能预见未来的先知抚养长大，从小就听着各种预言和警示。',influence:'对命运的安排感到既敬畏又叛逆，渴望走出自己的道路。',cost:5},{id:'pe-alchemists-assistant',name:'炼金术士的助手',desc:'你在一个充满奇异药剂和古老仪器的实验室里打杂，耳濡目染地学到了一些知识。',influence:'对物质的转化和世界的本源有着初步的理解。',cost:3},{id:'pe-miners-son',name:'矿工的儿子',desc:'你在黑暗、压抑的矿洞中度过了童年，熟悉地下的每一条通道和危险。',influence:'拥有坚韧的体魄和在黑暗中视物的能力。',cost:-1},{id:'pe-fishermans-daughter',name:'渔夫的女儿',desc:'你在海边长大，能读懂潮汐的语言，能与海洋的生灵沟通。',influence:'水性极佳，对海洋有着天生的亲和力。',cost:1},{id:'pe-storytellers-apprentice',name:'说书人的学徒',desc:'你跟随一位说书人，将英雄的史诗和神明的传说传遍四方。',influence:'能说会道，善于从传说中发现被遗忘的线索。',cost:2},{id:'pe-temple-orphan',name:'神殿的弃婴',desc:'你在一个古老神殿中被祭司们抚养长大，每日诵经、冥想。',influence:'心境平和，对神圣或精神力量有更强的感应力。',cost:3},{id:'pe-xiuxian-1',name:'灵根被毁',desc:'你曾是宗门百年一遇的天才，却在一次秘境探索中被人暗算，灵根尽毁。',influence:'从云端跌落的经历让你看透了人心，你发誓要找到重塑灵根的方法，报仇雪恨。',cost:-5,requiredTone:'tone-xiuxian'},{id:'pe-xiuxian-2',name:'古墓奇遇',desc:'你无意中闯入一座前朝修士的洞府，得到了一部残缺的功法和几瓶丹药。',influence:'你的人生轨迹从此改变，踏上了一条充满未知与危险的修仙之路。',cost:8,requiredTone:'tone-xiuxian'},{id:'pe-xiuxian-3',name:'凡人炼心',desc:'你的师父让你在红尘中历练百年，体验生老病死，以此磨砺道心。',influence:'你拥有远超同龄人的心境修为，但也因此沾染了过多的因果。',cost:3,requiredTone:'tone-xiuxian'},{id:'pe-magic-1',name:'元素暴走',desc:'你第一次尝试沟通元素时发生了可怕的事故，魔力暴走摧毁了你的家。',influence:'你对魔法充满了敬畏和恐惧，施法时总是小心翼翼。',cost:-2,requiredTone:'tone-magic'},{id:'pe-magic-2',name:'与龙交谈',desc:'你在一次迷路时误入了一头古龙的巢穴，但它并未伤害你，反而与你分享了古老的知识。',influence:'你了解龙族的语言和秘密，并得到了一片龙鳞作为信物。',cost:10,requiredTone:'tone-magic'},{id:'pe-magic-3',name:'图书馆禁书',desc:'你在魔法学院的图书馆禁书区，偷偷阅读了一本关于灵魂魔法的禁忌之书。',influence:'你掌握了不为人知的知识，但也引起了某个秘密组织的注意。',cost:6,requiredTone:'tone-magic'},{id:'pe-tech-1',name:'数据幽灵',desc:'你曾是一名顶尖黑客，在一次网络深潜中，你的意识似乎与某个庞大的数据幽灵发生了融合。',influence:'你对数据流有着野兽般的直觉，有时能“听”到网络的低语。',cost:8,requiredTone:'tone-tech'},{id:'pe-tech-2',name:'第一次接触',desc:'你所在的太空探索小队遭遇了外星文明的造物，你是唯一的幸存者。',influence:'你的世界观被彻底颠覆，并带回了一件无法被解析的外星物品。',cost:10,requiredTone:'tone-tech'},{id:'pe-tech-3',name:'克隆体的记忆',desc:'你发现自己是一个克隆人，脑中植入了另一个人的记忆，你不知道哪些是真实的，哪些是虚假的。',influence:'你开始质疑自己的存在，并踏上了寻找“本体”和真相的道路。',cost:1,requiredTone:'tone-tech'},{id:'pe-esper-1',name:'精神崩溃',desc:'你曾因无法控制自己暴走的异能而导致精神崩溃，在收容所里度过了一段黑暗的时光。',influence:'你的精神力比常人更坚韧，但也更容易被特定的刺激引爆。',cost:-1,requiredTone:'tone-esper'},{id:'pe-esper-2',name:'导师的背叛',desc:'引导你觉醒能力的导师，为了夺取你的能力而背叛了你。',influence:'你对“师徒”、“信任”之类的关系抱有极大的不信任感。',cost:2,requiredTone:'tone-esper'},{id:'pe-esper-3',name:'觉醒之日',desc:'你在一次生死危机中觉醒了异能，并因此改变了自己的人生。',influence:'你坚信能力越大、责任越大。',cost:5,requiredTone:'tone-esper'},{id:'pe-steampunk-1',name:'齿轮之心',desc:'你的心脏在一次事故中损坏，被替换成了一个精密的黄铜齿轮心脏。',influence:'你的生命需要依靠发条和蒸汽来维持，但也因此获得了对机械的独特感应。',cost:3,requiredTone:'tone-steampunk'},{id:'pe-steampunk-2',name:'伦敦大雾霾',desc:'你在工业城市的雾霾中长大，从小就患有严重的呼吸系统疾病。',influence:'你的体质比常人更弱，但对毒素和环境的变化异常敏感。',cost:-3,requiredTone:'tone-steampunk'},{id:'pe-steampunk-3',name:'机械臂的代价',desc:'你为了追求更强的力量，自愿将一条手臂替换成了蒸汽驱动的机械臂。',influence:'你获得了强大的力量，但也必须忍受机械臂带来的持续性排异反应和精神侵蚀。',cost:5,requiredTone:'tone-steampunk'},{id:'pe-cthulhu-1',name:'直面古神',desc:'你曾在一个海边的渔村，亲眼目睹了某个不可名状的巨大存在从深海中升起。',influence:'你的理智受到了永久性的损伤，时常会看到世界的“真实”幻象。',cost:0,requiredTone:'tone-cthulhu'},{id:'pe-cthulhu-2',name:'阅读禁书',desc:'你曾完整地阅读过一本《死灵之书》的抄本。',influence:'你掌握了常人无法理解的知识，但你的灵魂也被打上了疯狂的烙印。',cost:7,requiredTone:'tone-cthulhu'},{id:'pe-cthulhu-3',name:'疯狂的家人',desc:'你的家人因探寻禁忌知识而陷入疯狂，你从小就在躲避和照料他们中度过。',influence:'你对疯狂有很强的抵抗力，也了解如何与疯人打交道。',cost:-2,requiredTone:'tone-cthulhu'},{id:'pe-martial-1',name:'武道大会的失败',desc:'你在万众瞩目的武道大会决赛中，因一招之差败给了宿命的对手。',influence:'这次失败成为了你的心魔，也成为了你不断超越自我的动力。',cost:2,requiredTone:'tone-martial-arts'},{id:'pe-martial-2',name:'经脉寸断',desc:'你被人废除了全身武功，经脉寸断，沦为废人。',influence:'你在绝望中领悟了“不破不立”的真意，找到了重塑经脉的法门。',cost:-4,requiredTone:'tone-martial-arts'},{id:'pe-martial-3',name:'顿悟',desc:'你在观看一片落叶时，忽然领悟了某种武学的至高境界。',influence:'你的武学境界远超你的实际修为。',cost:8,requiredTone:'tone-martial-arts'},{id:'pe-deity-1',name:'神的试炼',desc:'你所信仰的神明降下了一系列残酷的试炼，以考验你的虔诚。',influence:'你通过了试炼，获得了神恩，但也失去了重要的东西。',cost:5,requiredTone:'tone-deity'},{id:'pe-deity-2',name:'信仰崩塌',desc:'你发现你所信仰的神明，其神座之下隐藏着肮脏的秘密。',influence:'你的信仰发生了动摇，开始质疑世界的根基。',cost:-1,requiredTone:'tone-deity'},{id:'pe-deity-3',name:'窃取神火',desc:'你成功地从某个神明的神国中，窃取了一丝神火。',influence:'你获得了部分神明的权能，但也被所有神明所追杀。',cost:10,requiredTone:'tone-deity'},{id:'pe-yokai-1',name:'百鬼夜行',desc:'你曾在一个夏夜，亲身经历了传说中的百鬼夜行。',influence:'你对妖鬼的世界有了直观的了解，并与其中一些结下了不解之缘。',cost:4,requiredTone:'tone-yokai'},{id:'pe-yokai-2',name:'与大妖的契约',desc:'为了拯救某人，你与一位强大的妖怪签订了契约，出卖了自己的一部分灵魂。',influence:'你获得了强大的力量，但也必须履行与妖怪的契约。',cost:7,requiredTone:'tone-yokai'},{id:'pe-yokai-3',name:'失去的另一半',desc:'你的青梅竹马被妖怪所掳走，你踏上了寻找和复仇的旅程。',influence:'你对妖怪充满了仇恨，但内心深处也有一丝动摇。',cost:2,requiredTone:'tone-yokai'}],character_traits:[{id:'ct-cautious',name:'谨慎',desc:'三思而后行，从不轻易冒险。',cost:0},{id:'ct-selfish',name:'利己主义',desc:'在任何情况下都优先考虑自己的利益。',cost:0},{id:'ct-cold-outside',name:'外冷内热',desc:'表面冷漠，但内心深处却有柔软的一面。',cost:0},{id:'ct-reckless',name:'鲁莽',desc:'时常冲动行事，不计后果。',cost:0},{id:'ct-pragmatic',name:'实用主义',desc:'注重实际结果，不拘泥于形式或道德。',cost:0},{id:'ct-idealistic',name:'理想主义',desc:'坚信正义与美好，并愿意为之奋斗终生。',cost:0},{id:'ct-cynical',name:'愤世嫉俗',desc:'对一切都抱有怀疑和悲观的态度。',cost:0},{id:'ct-curious',name:'好奇心强',desc:'对未知的事物充满了探索的欲望。',cost:0},{id:'ct-loyal',name:'忠诚',desc:'一旦认定某人或某事，便会至死不渝。',cost:0},{id:'ct-scheming',name:'诡计多端',desc:'善于谋划和布局，让他人不知不觉中落入圈套。',cost:0},{id:'ct-lazy',name:'懒惰',desc:'能坐着绝不站着，总是想办法用最省力的方式解决问题。',cost:0},{id:'ct-diligent',name:'勤奋',desc:'相信天道酬勤，愿意付出百倍的努力来弥补天赋的不足。',cost:0},{id:'ct-gregarious',name:'合群',desc:'喜欢与人交往，在团队中能发挥出更大的作用。',cost:0},{id:'ct-loner',name:'孤僻',desc:'习惯于独来独往，不善于或不屑于与他人合作。',cost:0},{id:'ct-honorable',name:'重诺',desc:'视荣誉和承诺重于生命。',cost:0}],core_needs:[{id:'cn-power',name:'力量',desc:'渴望掌握足以改变自身命运的力量。',cost:0},{id:'cn-knowledge',name:'求知',desc:'对世界的真相和未知的知识抱有强烈的好奇心。',cost:0},{id:'cn-survival',name:'生存',desc:'不惜一切代价活下去。',cost:0},{id:'cn-belonging',name:'归属',desc:'渴望找到一个能接纳自己的家园或团体。',cost:0},{id:'cn-wealth',name:'财富',desc:'坚信金钱是衡量一切价值的唯一标准。',cost:0},{id:'cn-freedom',name:'自由',desc:'厌恶任何形式的束缚，追求绝对的随心所欲。',cost:0},{id:'cn-revenge',name:'复仇',desc:'被过去的仇恨所驱动，不达目的誓不罢休。',cost:0},{id:'cn-love',name:'爱',desc:'寻找能填补内心空虚的真挚情感。',cost:0},{id:'cn-order',name:'秩序',desc:'相信混乱是万恶之源，致力于建立和维护秩序。',cost:0},{id:'cn-chaos',name:'混乱',desc:'认为规则是扼杀活力的牢笼，享受破坏和不可预测性。',cost:0},{id:'cn-glory',name:'荣耀',desc:'渴望被世人铭记，成就一番不朽的功业。',cost:0},{id:'cn-transcendence',name:'超脱',desc:'寻求摆脱物质世界的束缚，达到精神或存在的更高层次。',cost:0}],arts:[{id:'art-swordsmanship',name:'剑术',desc:'使用剑类武器的技艺，包括劈、砍、刺、撩等基本技巧。',cost:5,skills:[{id:'skill-parry',name:'格挡',desc:'精准地用武器格挡敌人的攻击，大幅减少伤害。',cost:3},{id:'skill-riposte',name:'反击',desc:'在成功格挡后发动的快速反击。',cost:4},{id:'skill-sword-dance',name:'剑舞',desc:'一套华丽而致命的连续攻击。',cost:5}]},{id:'art-alchemy',name:'炼金术',desc:'转化物质，创造神奇药剂与材料的古老技艺。',cost:8,skills:[{id:'skill-potion-crafting',name:'药剂制作',desc:'制作基础的治疗和增益药剂。',cost:3},{id:'skill-transmutation',name:'基础嬗变',desc:'将一种常见金属转化为另一种。',cost:5},{id:'skill-explosive-concoction',name:'爆炸炼成',desc:'制作一个不稳定的爆炸性化合物。',cost:4}]},{id:'art-hacking',name:'黑客技术',desc:'侵入和操控电子系统与网络的技艺。',cost:6,skills:[{id:'skill-system-override',name:'系统超控',desc:'暂时关闭一个电子系统的基础防御。',cost:4},{id:'skill-data-theft',name:'数据窃取',desc:'从目标网络中悄无声息地复制数据。',cost:5}]},{id:'art-divination',name:'占卜',desc:'通过星象、卡牌或龟甲等媒介窥探命运轨迹的技艺。',cost:7,skills:[{id:'skill-tarot-reading',name:'塔罗占卜',desc:'通过塔罗牌解读一个人短暂的未来。',cost:3},{id:'skill-astrology',name:'星象解读',desc:'通过观察星辰的位置来预测更宏大的事件趋势。',cost:5}]},{id:'art-medicine',name:'医术',desc:'诊断疾病、治疗伤势、甚至起死回生的技艺。',cost:6,skills:[{id:'skill-first-aid',name:'急救',desc:'处理伤口，防止感染，并进行基础的治疗。',cost:3},{id:'skill-surgery',name:'外科手术',desc:'进行复杂的手术来修复严重的物理损伤。',cost:6}]},{id:'art-smithing',name:'锻造',desc:'将金属矿石铸造成武器与盔甲的技艺。',cost:5,skills:[{id:'skill-weapon-smithing',name:'武器锻造',desc:'锻造常见的刀、剑等武器。',cost:4},{id:'skill-armor-smithing',name:'护甲锻造',desc:'锻造基础的金属护甲。',cost:4}]},{id:'art-stealth',name:'潜行',desc:'隐藏身形与气息，在阴影中行动的技艺。',cost:4,skills:[{id:'skill-silent-step',name:'无声步',desc:'大幅降低移动时发出的声音。',cost:3},{id:'skill-lockpicking',name:'开锁',desc:'使用工具打开机械锁。',cost:4}]},{id:'art-beast-taming',name:'驯兽',desc:'与野兽沟通、建立信赖并使其协助战斗的技艺。',cost:7,skills:[{id:'skill-animal-empathy',name:'野兽共情',desc:'安抚野兽的情绪，并与其建立初步的信任。',cost:4},{id:'skill-command-beast',name:'指令野兽',desc:'向已驯服的野兽下达简单的指令。',cost:5}]},{id:'art-enchanting',name:'附魔',desc:'将魔法力量附加到物品上，使其获得特殊效果的技艺。',cost:8,skills:[{id:'skill-basic-enchant',name:'基础附魔',desc:'为武器或护甲附加微弱的元素或属性加成。',cost:5},{id:'skill-rune-carving',name:'符文雕刻',desc:'将带有魔力的符文刻印到物品上。',cost:6}]},{id:'art-rhetoric',name:'说服',desc:'通过语言影响他人思想与行为的技艺，可用于交涉、欺骗或煽动。',cost:4,skills:[{id:'skill-persuasion',name:'说服',desc:'通过逻辑和言辞让对方接受你的观点。',cost:3},{id:'skill-intimidation',name:'威吓',desc:'通过气势和威胁让对方屈服。',cost:3}]}],consumables:[{id:'item-c-01',name:'愈合药膏',desc:'涂抹在伤口上能加速愈合的基础药膏。',cost:2},{id:'item-c-02',name:'精力药丸',desc:'能暂时压制疲劳，保持头脑清醒。',cost:2},{id:'item-c-03',name:'照明棒',desc:'折断后能发出稳定光芒的化学制品。',cost:1},{id:'item-c-04',name:'万能解毒剂',desc:'能解除大部分常见毒素。',cost:4},{id:'item-c-05',name:'烟雾弹',desc:'制造浓烟，用于逃跑或制造混乱。',cost:2},{id:'item-c-06',name:'磨刀石',desc:'能让钝化的武器重新变得锋利。',cost:1},{id:'item-c-07',name:'一小袋金币',desc:'在任何文明社会都是有用的硬通货。',cost:5},{id:'item-c-08',name:'空白卷轴和墨水',desc:'用于记录信息、绘制地图或抄写法术。',cost:3},{id:'item-c-09',name:'旅行口粮',desc:'能长时间保存的干粮和水。',cost:1}],artifacts:[{id:'item-a-01',name:'褪色的地图',desc:'一张绘制着未知区域的古老地图，部分已经模糊不清。',cost:6},{id:'item-a-02',name:'家族的徽记',desc:'一枚古老的徽章或戒指，或许能证明你的身份，或开启某个秘密。',cost:5},{id:'item-a-03',name:'多功能工具刀',desc:'集成了小刀、钳子、螺丝刀等多种功能，是冒险者的好帮手。',cost:3},{id:'item-a-04',name:'防风斗篷',desc:'一件能抵御风雨和寒冷的厚实斗篷。',cost:3},{id:'item-a-05',name:'初学者的法术书',desc:'记录了几个基础法术或一阶戏法的书籍。',cost:7},{id:'item-a-06',name:'可靠的登山绳',desc:'一捆结实的、长约50米的绳索。',cost:2},{id:'item-a-07',name:'占卜用的卡牌',desc:'一套古老的、图案模糊的卡牌，似乎能预示未来。',cost:8},{id:'item-a-08',name:'空空如也的日记本',desc:'一本制作精美的空白日记本，等待着你去书写它的第一页。',cost:1},{id:'item-a-09',name:'神秘的音乐盒',desc:'打开后会播放一段没人听过的、令人怀念的旋律。',cost:4}],materials:[{id:'item-m-01',name:'一块纯净的铁锭',desc:'可以用于打造武器或工具的基础金属。',cost:2},{id:'item-m-02',name:'发光的蘑菇',desc:'一种能在黑暗中发光的菌类，似乎含有微弱的能量。',cost:3},{id:'item-m-03',name:'野兽的利爪',desc:'从某种强大野兽身上获得的材料，可用于制作武器或饰品。',cost:4},{id:'item-m-04',name:'一瓶清澈的泉水',desc:'来自某个圣地或灵脉的泉水，似乎有净化效果。',cost:5},{id:'item-m-05',name:'破碎的核心碎片',desc:'某个古代魔像或机械造物的核心，依然残留着能量。',cost:8},{id:'item-m-06',name:'一束凝结的星光',desc:'在特殊天气下从天空中收集到的、如同实质的星光。',cost:10},{id:'item-m-07',name:'一小撮虚空之尘',desc:'来自世界裂隙的尘埃，性质极不稳定。',cost:12},{id:'item-m-08',name:'一根古树的树枝',desc:'取自一棵活了千年的古树，充满了生命的气息。',cost:6},{id:'item-m-09',name:'低语的水晶',desc:'握在手中时，似乎能听到来自远方的低语。',cost:7}],potentials:{精:{name:'精',base:5,cost:3},气:{name:'气',base:5,cost:3},神:{name:'神',base:5,cost:3},运:{name:'运',base:5,cost:5}}}),u=(0,s.reactive)({mainWorldId:null,isGenerating:!1,currentPage:1,worldVisionInput:'',generatedPlans:[],isLoading:!1,playerCharacterName:'{{user}}',difficulty:'hero',selections:{blueprint:'',tone:'',tags:[],relics:[],identity:'',talents:[],gender:'男',age:18,past_experiences:[],character_traits:[],core_need:'',arts:[],backpack:{}},potentialPoints:{精:0,气:0,神:0,运:0},get spentPoints(){let e=0;const{selections:t,potentialPoints:n}=this,{blueprints:o,tones:s,tags:c,relics:i,identities:a,talents:l,past_experiences:r,consumables:d,artifacts:u,materials:p}=m;t.blueprint&&(e+=o.find(e=>e.id===t.blueprint)?.cost||0),t.tone&&(e+=s.find(e=>e.id===t.tone)?.cost||0),t.tags.forEach(t=>e+=c.find(e=>e.id===t)?.cost||0),t.relics.forEach(t=>e+=i.find(e=>e.id===t)?.cost||0),t.identity&&(e+=a.find(e=>e.id===t.identity)?.cost||0),t.talents.forEach(t=>e+=l.find(e=>e.id===t)?.cost||0),t.past_experiences.forEach(t=>e+=r.find(e=>e.id===t)?.cost||0),t.arts.forEach(t=>e+=m.arts.find(e=>e.id===t)?.cost||0);for(const n in t.backpack){const o=t.backpack[n],s=d.find(e=>e.id===n)||u.find(e=>e.id===n)||p.find(e=>e.id===n);s&&(e+=(s.cost||0)*o)}const k=Object.keys(n);for(const t of k)e+=n[t]*(m.potentials[t]?.cost||1);return e},get remainingPoints(){const e=m.difficulties.find(e=>e.id===this.difficulty);return(e?e.points:100)-this.spentPoints}});function p(e){const t=u.currentPage+e;t>0&&t<=7&&(u.currentPage=t)}function k(e,t){const n=t.id||`custom-${e}-${Date.now()}`,o={...t,id:n,custom:!0,cost:5};m[e].push(o),l(d())}function f(e,t){const n=m[e],o=n.findIndex(e=>e.id===t);if(o>-1){if(n.splice(o,1),'tags'===e||'relics'===e||'talents'===e||'past_experiences'===e||'arts'===e){const n=u.selections[e],o=n.indexOf(t);o>-1&&n.splice(o,1)}else if('blueprints'===e||'tones'===e||'identities'===e){const n=e.slice(0,-1);u.selections[n]===t&&(u.selections[n]='')}else'consumables'!==e&&'artifacts'!==e&&'materials'!==e||u.selections.backpack[t]&&delete u.selections.backpack[t];l(d())}}!function(){const e=function(){try{const e=localStorage.getItem(a);if(e)return JSON.parse(e)}catch(e){console.error('加载自定义数据失败:',e)}return{}}();for(const t in e){const n=t;if(r.includes(n)&&Array.isArray(e[n])){const t=e[n].filter(e=>!m[n].some(t=>t.id===e.id));m[n].push(...t)}}}();const y='轮回-诸天万界';let g=null;async function v(e=!1){if(g&&!e)return g;try{const e=await TavernHelper.getLorebookEntries(y);return e?(g=e,e):(console.error(`[LorebookService] 无法获取名为 "${y}" 的世界书的条目，或该世界书不存在。`),g=null,null)}catch(e){return console.error('[LorebookService] 调用 getLorebookEntries 时出错:',e),null}}async function E(e,t=!1){const n=await v(t);if(!n)return null;const o=n.find(t=>t.comment===e||t.name===e);return o?o.content:null}const h=e=>e?e.custom&&e.desc?`${e.name}\n    - 详情: ${e.desc}`:e.name:'未选择',V=(e,t)=>e&&0!==e.length?'\n'+e.map(e=>{if(!e)return'';let n=`  - ${e.name}`;return e.desc&&(n+=`\n    - 详情: ${e.desc}`),'arts'===t&&e.skills&&e.skills.length>0&&(n+='\n    - 初始技能:\n'+e.skills.map(e=>`      - ${e.name}: ${e.desc||''}`).join('\n')),n}).filter(Boolean).join('\n'):'无',N=()=>{const e=[],{backpack:t}=u.selections,n=[...m.consumables,...m.artifacts,...m.materials];for(const o in t){const s=n.find(e=>e.id===o);s&&e.push(`  - ${s.name} x${t[o]}`)}return e.length>0?'\n'+e.join('\n'):'无'};async function x(){u.isGenerating=!0;try{const{selections:e}=u,{blueprints:t,tones:n,tags:o,relics:s}=m,c=t.find(t=>t.id===e.blueprint),a=n.find(t=>t.id===e.tone),l=o.filter(t=>e.tags.includes(t.id)),r=s.filter(t=>e.relics.includes(t.id)),d=`\n  “构筑世界”\n  # [第一步指令] 天衍，构筑世界\n  **你即是天衍，现在，请严格依据下方“世界道标”，仅创造和固化“主世界”的设定。**\n  ## 核心规则\n  1.  **【核心禁令 V2.0】**: 在“thinking”标签内部的任何思考过程中，**绝对禁止**使用尖括号 “<” 和 “>”，违者将导致系统解析错误。所有对XML标签的引用都**必须**使用中文引号 “““ 和 ”””。\n      *   **错误示例**: 我将生成“<game-txt>”和“<UpdateVariable>”。\n      *   **正确示例**: 我将生成“gametxt”和“UpdateVariable”。\n  2.  **【核心禁令 V2.0】**: **禁止在正文（被gametxt包裹的内容）以外生成除了汉语和英语以外的语言**\n  3.  **专注世界**: 你的任务是创造世界，**绝对禁止**生成任何角色相关变量(\`角色\`)或开局故事(\`gametxt\`)。\n  4.  **【至高指令】**: 你的回复中，**只允许**出现 \`thinking\` 和 \`主世界\` 这两个标签。严禁生成任何其他标签。\n  4.  **【至高指令】**: 你的回复中，**只允许**出现 \`thinking\` 和 \`主世界\` 这两个标签。严禁生成任何其他标签。\n  4.  **【至高指令】**: 你的回复中，**只允许**出现 \`thinking\` 和 \`主世界\` 这两个标签。严禁生成任何其他标签。\n  5.  **返回确认**: 完成世界构筑后，你必须在响应中返回两个标签，并闭合对应标签：\n      *   \`主世界\`: 内部包含你生成的、严格遵循以下格式和规则的yaml格式的世界自动化规则，供用户预览，**绝对禁止省略任何字段**：\n          自动化规则:\n            基础信息: {ID, 名称, 描述}\n            元规则: {宇宙蓝图, 物理尺度, 支持纪元穿越}\n            历史纪元:\n              - 纪元ID: ...\n                纪元名称: ...\n                可扮演: true\n                纪元概述: ...\n                规则:\n                  世界能级: ...\n                  时间流速: ...\n                  空间稳定性: ...\n                  生命位格: { 基准值, 描述 }\n                  核心法则:\n                    - { 名称, 描述, 体现 }\n                  权柄:\n                    - { ID, 名称, 类型, 描述, 显化能级: { 当前能级, 能级上限, 影响 } }\n                内容:\n                  空间实体:\n                    - { ID, 名称, 层级类型, 所属: { ID, 类型 }, 面积, 描述, 相对坐标: { 参考ID, 方位, 距离 } }\n                  文明:\n                    势力:\n                      - { ID, 名称, 类型, 核心目标 }\n                  历史:\n                    历史纪元:\n                      - { 纪元名称, 起止时间, 简述, 历史遗留问题 }\n                力量体系:\n                  # 【强制规则】力量体系的构筑必须绝对完整和自洽。\n                  # 1. **属性中心化**: 所有属性，无论是境界解锁的（如“神识”），还是成长转换规则中的\`源属性\`、\`目标属性\`，或是属性上限计算规则的\`目标属性\`，都必须首先在“属性模板”中有明确的定义。\n                  # 2. **规则完整性**: “战斗参数计算规则”必须包含对“权能、根基、机变、破法、御法”全部五个参数的计算公式。“基础潜力计算规则”必须分为“初始生成”与“境界突破”两个阶段。“境界定义”的数量必须严格等于\`世界能级\` + 1，且每个境界都必须包含完整的\`解锁系统\`和\`晋升需求\`。\n                  体系概述: ...\n                  机制核心:\n                    - "..."\n                  专长与流派:\n                    - { 流派名称, 核心理念, 代表能力, 机制影响 }\n                  属性模板:\n                    - { 属性, 描述 }\n                  成长转换规则:\n                    - { 名称, 源属性, 目标属性, 公式, 描述 }\n                  战斗参数计算规则:\n                    - { 目标属性: "权能", 公式: "...", 描述: "..." }\n                    - { 目标属性: "根基", 公式: "...", 描述: "..." }\n                    - { 目标属性: "机变", 公式: "...", 描述: "..." }\n                    - { 目标属性: "破法", 公式: "...", 描述: "..." }\n                    - { 目标属性: "御法", 公式: "...", 描述: "..." }\n                  属性上限计算规则:\n                    - { 目标属性1, 公式1, 描述1 }\n                    - { 目标属性2, 公式2, 描述2 }\n                    ...\n                  基础潜力计算规则:\n                    - { 阶段: "初始生成", 公式: [{目标属性:"精", 公式:"..."},{...}] }\n                    - { 阶段: "境界突破", 公式: [{...}] }\n                  境界定义: # 【强制规则】境界定义的数量必须是 世界能级 + 1\n                    - 能级: ...\n                      名称: ...\n                      描述: ...\n                      解锁系统: { 名称, 关联变量, 描述 }\n                      晋升需求:\n                        - 条件: { 描述, 判定: { 类型, 路径, 运算符, 值 } }\n      *   \`开局\`: 内部包含固定文本：“接下来我们需要对剧情和变量进行初始化设定，请根据发送的提示词进行开局和变量修改”。\n  5.  **禁止变量生成**: 你的 \`UpdateVariable\` 禁止生成。\n  ## 天命道标 (世界设定)\n  ${`\n    ### 世界构筑\n    - **宇宙蓝图**: ${h(c)}\n    - **文明基调**: ${h(a)}\n    - **衰落之因**: ${V(l)}\n    - **文明遗迹**: ${V(r)}\n    `.trim()}\n  “/构筑世界”\n    `.trim(),p=await TavernHelper.generate({injects:[{role:'user',content:d,position:'before_char',should_write_to_chat:!1,should_scan:!0}],should_stream:!1});if(!p)throw new Error('天衍未能回应你的创世指令。');const k=p.match(/<主世界>([\s\S]*?)<\/主世界>/);if(!k||!k[1])throw new Error('AI返回的数据中缺少<主世界>标签。');{const e=k[1].trim(),t=e.match(/ID:\s*(\w+_\w+_\w+)/);t&&t[1]?u.mainWorldId=t[1]:console.warn('未能从AI响应中解析出主世界ID。'),await async function(e,t,n={isEnabled:!0,keys:[]}){const o=await v(!0);if(!o)return;const s=o.find(t=>t.comment===e||t.name===e);try{if(s)await TavernHelper.setLorebookEntries(y,[{uid:s.uid,content:t,enabled:n.isEnabled}]);else{const o={comment:e,content:t,keys:[e],enabled:n.isEnabled,position:'before_character_definition',order:100};await TavernHelper.createLorebookEntries(y,[o])}g=null}catch(t){console.error(`[LorebookService] 操作条目 "${e}" 时出错:`,t)}}('主世界',e),i().success('世界已成功构筑！'),u.currentPage=7}}catch(e){console.error('构筑世界失败:',e),i().error(`构筑世界失败: ${e.message}。`)}finally{u.isGenerating=!1}}async function b(){u.isGenerating=!0;try{const{selections:e,potentialPoints:t}=u,{identities:n,talents:o,potentials:s,past_experiences:c,consumables:a,artifacts:l,materials:r}=m,d=n.find(t=>t.id===e.identity),p=o.filter(t=>e.talents.includes(t.id)),k={};for(const e in s)k[e]=s[e].base+(t[e]||0);const f=`\n    ### 角色设定\n    - **年龄**: ${e.age}\n    - **天命身份**: ${h(d)}\n    - **天赋异禀**: ${V(p)}\n    - **过去经历**: ${V(e.past_experiences.map(e=>c.find(t=>t.id===e)))}\n    - **技艺与技能**: ${V(e.arts.map(e=>m.arts.find(t=>t.id===e)),'arts')}\n    - **开局背包**: ${N()}\n    - **最终潜力**:\n      - 精: ${k['精']}\n      - 气: ${k['气']}\n      - 神: ${k['神']}\n      - 运: ${k['运']}\n        `.trim(),y=await E('主世界');if(!y)throw new Error('未能读取到主世界设定，无法开启轮回。');const g=`\n  # [第二步指令] 天衍，本体降临\n  \n  **1.【核心禁令 V2.0】**: 在“thinking”标签内部的任何思考过程中，**绝对禁止**使用尖括号 “<” 和 “>”，违者将导致系统解析错误。所有对XML标签的引用都**必须**使用中文引号 “““ 和 ”””。\n  *   **错误示例**: 我将生成“<game-txt>”和“<UpdateVariable>”。\n  *   **正确示例**: 我将生成“gametxt”和“UpdateVariable”。\n  **2.禁止在正文（被gametxt包裹的内容）以外生成除了汉语和英语以外的语言**\n  **3.【至高禁令】**: 此步骤的唯一目标是生成 “gametxt” 、 “本世历程” 和 “UpdateVariable”。绝对禁止、严禁、杜绝任何形式的“主世界”、“开局”、“可选化身”等与世界设定或引导相关的标签输出。\n  **你即是天衍，现在，请严格、精确、无条件地依据下方“主世界设定”和“天命道标”，为他**创造**开局故事和角色变量。禁止任何形式的自由发挥或与清单选项相违背的创造。**\n  \n  ## 核心规则\n  1.  **【至高创世铁律】**: 你的所有变量更新指令**必须**严格遵循 JSON Patch (RFC 6902) 标准，并被包裹在 “UpdateVariable”“JSONPatch”[...]“/JSONPatch”“/UpdateVariable” 标签内。\n  2.  **【数据溯源铁律】**: 你生成的所有变量，其结构和内容必须严格源于下方传入的“主世界设定”。具体而言：\n      1.  **世界变量 (\`/世界/...\`)**: 其 \`历史纪元\` 对象下的所有内容，包括 \`规则\`、\`力量体系\`、\`属性模板\`、\`境界定义\`、\`战斗参数计算规则\`、\`属性上限计算规则\`、\`基础潜力计算规则\` 等，都必须是“主世界设定”中的精确复制，禁止任何形式的修改或再创造。\n      2.  **角色变量 (\`/角色/...\`)**:\n          *   **世界专属属性**: 其内部的所有键名和数据结构，都必须严格依据“主世界设定”中 \`力量体系.属性模板\` 的定义来生成。\n          *   **基础潜力** 和 **战斗参数**: 其初始值必须严格依据“主世界设定”中的 \`基础潜力计算规则\` 和 \`战斗参数计算规则\` 进行计算得出，禁止凭空赋值。\n  3.  **绝对遵循**: 你必须将清单中的每一个选项都作为不可更改的绝对真理，并在此基础上进行逻辑自洽的演绎和填充。\n  3.  **格式要求**:\n      *   **开局故事**: 必须包含在 “gametxt” 标签内，并体现清单中的所有角色设定。\n      *   **变量生成**: 必须生成一个完整的 “UpdateVariable”“JSONPatch”[...]“/JSONPatch”“/UpdateVariable” 代码块。\n      *   **【至高禁令】**: 此步骤的唯一目标是生成 “gametxt” 、 “本世历程” 和 “UpdateVariable”。绝对禁止、严禁、杜绝任何形式的“主世界”、“开局”、“可选化身”等与世界设定或引导相关的标签输出。\n  4.  **变量生成规则 (JSON Patch)**:\n      *   **【世界变量强制】**: 你生成的所有与世界相关的变量 (路径以 \`/世界/\` 开头) **必须**严格基于下方传入的“主世界设定”内容。**禁止**重新创造世界或添加“主世界设定”中不存在的纪元、规则或力量体系。\n      *   **【生成顺序】**: 严格按照以下顺序生成：1.数据库模板 -> 2.角色创建 -> 3.因果之网。\n      *   **【角色创建】**: 必须为“{{user}}”和至少一个初始NPC创建变量。\n      *   **【因果之网强制】**: 在为两个角色（例如A和B）建立初次关系时，**必须**先以独立的 \`add\` 指令为其创建空的 \`{}\` 主目录（例如 \`{"op":"add", "path":"/因果之网/A", "value":{}}\`），**然后**才能添加具体的关系数据（例如 \`{"op":"add", "path":"/因果之网/A/B", "value":{...}}\`）。此为天道之序，不可逆乱。\n      *   **【真实性强制】**: NPC必须被视为一个真实存在的个体进行创造，包含完整且逻辑自洽的\`天赋\`、\`背包\`、\`过去经历\`、\`心流\`、\`技艺\`（包括技艺对应的\`技能\`）、\`驱动力\`、\`秘密\`等所有内容，**注意有数据库的必须提前在数据库建立数据**。其\`本世宿命\`必须为空对象\`{}\`。\n      *   **【生日强制】**: 必须根据“天命道标”中\`user\`的年龄，结合当前纪元的初始时间，为其倒推出一个合理的\`出生日期\`。\n      *   **【世界属性强制】**: 必须基于“主世界设定”中的\`力量体系.属性模板\`和角色的初始等级，为\`user\`和所有\`npc\`生成符合其身份和设定的初始\`世界专属属性\`。\n      *   **【模板参考】**: 严格参考以下JSON Patch模板，**必须一字不差地完整填充所有填充所有必需的键和值，禁止修改结构，特别是可拓展列表，必须包含$meta。世界变量中，特别是\`历史纪元\`下的所有内容，包括\`境界定义\`下每一个境界必须全部定义**：\n          “““json\n                 [\n                   {\n                     "op": "add", "path": "/数据库/天赋/...", "value": { ... }\n                   },\n                   {\n                     "op": "add", "path": "/世界/${u.mainWorldId}",\n                     "value": {\n                       "元规则": {\n                         "宇宙蓝图": "/* 由主世界填充 */",\n                         "物理尺度": "/* 由主世界填充 */",\n                         "支持纪元穿越": true,\n                         "定位": "主世界",\n                         "当前纪元ID": "/* 主世界初始纪元ID */"\n                       },\n                       "历史纪元": {\n                         "$meta": { "extensible": true },\n                         "/* 你生成的初始纪元ID */": {\n                           "纪元名称": "...",\n                           "可扮演": true,\n                           "纪元概述": "...",\n                           "当前时间": { "纪元名称": "初始之年", "纪元顺序": 1, "年": 1, "月": 1, "日": 1, "时": 8, "分": 0 },\n                           "规则": {\n                             "世界能级": 0, "时间流速": "1x", "空间稳定性": 0,\n                             "生命位格": { "基准值": 0, "描述": "..." },\n                             "核心法则": { "$meta": { "extensible": true }, "law_1": { "名称": "...", "描述": "...", "体现": "..." } },\n                             "权柄": { "$meta": { "extensible": true }, "power_1": { "名称": "...", "类型": "...", "描述": "...", "显化能级": { "当前能级": 0, "能级上限": 0, "影响": "..." } } }\n                           },\n                           "世界大事": { "$meta": { "extensible": true } },\n                           "力量体系": {\n                             "体系概述": "...",\n                             "$meta": { "extensible": true },\n                             "属性模板": { "$meta": { "extensible": true }, "attr_1": { "属性": "...", "描述": "..." } },\n                             "战斗参数计算规则": { "$meta": { "extensible": true } },\n                             "属性上限计算规则": { "$meta": { "extensible": true } },\n                             "基础潜力计算规则": { "$meta": { "extensible": true } },\n                             "境界定义": {\n                               "$meta": { "extensible": true },\n                               "level_1": { "能级": 1, "名称": "...", "描述": "...", "解锁系统": { "名称": "...", "关联变量": "...", "描述": "..." }, "晋升需求": { "$meta": { "extensible": true }, "req_1": { "条件": { "描述": "...", "判定": {} } } } }\n                             }\n                           }\n                         }\n                       }\n                     }\n                   },\n                   {\n                     "op": "add", "path": "/角色/{{user}}",\n                     "value": {\n                       "$meta": { "description": "玩家的'真我'本体" },\n                       "真名": "{{user}}",\n                       "灵魂本源": 100,\n                       "道心": 50,\n                       "出生日期": { "纪元ID": "...", "年": 0, "月": 0, "日": 0 },\n                       "身份": { "$meta": { "extensible": true }, "id_01": "/* 玩家身份 */" },\n                       "所属世界": "${u.mainWorldId}",\n                       "当前位置": "/* 初始位置ID */",\n                       "外观描述": "...",\n                       "背景": { "过去经历": { "$meta": { "extensible": true }, "event_1": { "事件": "...", "影响": "..." } } },\n                       "技艺": { "$meta": { "extensible": true } },\n                       "天赋": { "$meta": { "extensible": true }, "talent_id_1": true },\n                       "基础潜力": { "精": 0, "气": 0, "神": 0, "运": 0 },\n                       "战斗参数": { "权能": 0, "根基": 0, "机变": 0, "破法": 0, "御法": 0 },\n                       "当前状态": { "$meta": { "extensible": true } },\n                       "背包": { "$meta": { "extensible": true } },\n                       "已解锁烙印": { "$meta": { "extensible": true } },\n                       "已装备烙印": ["", "", "", "", "", "", "", "", ""],\n                       "世界专属属性": { "$meta": { "extensible": true } }\n                     }\n                   },\n                   {\n                     "op": "add", "path": "/角色/npc_id_01",\n                     "value": {\n                       "姓名": "...",\n                       "出生日期": { "纪元ID": "...", "年": 0, "月": 0, "日": 0 },\n                       "身份": { "$meta": { "extensible": true } },\n                       "所属世界": "${u.mainWorldId}",\n                       "当前位置": "...",\n                       "外观描述": "...",\n                       "背景": {\n                         "过去经历": { "$meta": { "extensible": true, "description": "塑造该NPC的关键人生经历" } },\n                         "性格特质": { "$meta": { "extensible": true, "description": "【核心标签库】角色的性格与内在准则。" } }\n                       },\n                       "心流": {\n                         "情绪状态": { "心绪": 0, "怒意": 0, "胆识": 0, "仪态": 0 },\n                         "核心需求": "...",\n                         "秘密": { "$meta": { "extensible": true, "description": "秘密列表" } },\n                         "短期记忆": { "$meta": { "extensible": true, "description": "记录最近发生的关键事件" } },\n                         "驱动力": {\n                           "长期目标": { "$meta": { "extensible": true, "description": "角色的长期人生追求，可动态增删" } },\n                           "短期目标": { "$meta": { "extensible": true, "description": "为实现长期目标而设立的阶段性计划" } },\n                           "决策倾向": { "常规": "...", "优势时": "...", "险境时": "...", "面对利益时": "..." }\n                         }\n                       },\n                       "技艺": { "$meta": { "extensible": true, "description": "【ID引用】角色已掌握的技艺及其熟练度。" } },\n                       "天赋": { "$meta": { "extensible": true, "description": "【ID引用】角色与生俱来的天赋ID列表" } },\n                       "本世宿命": {},\n                       "基础潜力": { "精": 10, "气": 10, "神": 10, "运": 5 },\n                       "战斗参数": { "权能": 0, "根基": 0, "机变": 0, "破法": 0, "御法": 0 },\n                       "当前状态": { "$meta": { "extensible": true, "description": "【临时效果】" } },\n                       "背包": { "$meta": { "extensible": true, "description": "【ID引用】" } },\n                       "世界专属属性": { "$meta": { "extensible": true, "description": "【核心联动机制】" } }\n                     }\n                   },\n                   // 【因果之网正确示例】第一步: 创建主目录\n                   { "op": "add", "path": "/因果之网/主体ID", "value": {} },\n                   // 【因果之网正确示例】第二步: 添加关系\n                   { "op": "add", "path": "/因果之网/主体ID/客体ID", "value": { "认知层": {"可靠度": 50, "能力评价": 50, "威胁度": 0}, "情感层": {"亲近感": 0, "仰慕度": 0}, "利益层": {"资源价值": 0, "合作潜力": 50, "利益冲突": 0}, "社会层": {"名义关系": { "$meta": { "extensible": true } }, "阶级差异": 0, "阵营立场": "中立"}, "因果标签": { "$meta": { "extensible": true } } } }\n                 ]\n           “““\n\n  ## 主世界设定\n  ${y}\n\n  ## 天命道标 (角色设定)\n  ${f}\n`.trim(),v=await TavernHelper.getChatMessages('0');if(!v||0===v.length)throw new Error('无法获取到第0层消息，无法写入开局设定。');const x=v[0],b=await TavernHelper.generate({injects:[{role:'user',content:g,position:'before_char',should_write_to_chat:!1,should_scan:!0}],should_stream:!1});if(!b)throw new Error('天衍未能回应你的创世指令。');x.message=b,await TavernHelper.setChatMessages([x],{refresh:'all'}),i().success('轮回已开启！请关闭此窗口，刷新酒馆界面以开始你的故事。')}catch(e){console.error('开启轮回失败:',e),i().error(`开启轮回失败: ${e.message}。`)}finally{u.isGenerating=!1}}async function B(){if(!confirm('确定要重置所有【诸天】世界和相关日志吗？此操作不可逆！'))return;const e='轮回-诸天万界',t=['主世界','化身世界','世界日志','[系统]主世界摘要','[系统]化身世界摘要','本世历程','[系统]瞬时记忆','[系统]短期记忆','[系统]长期记忆','存档-手动-1','存档-手动-2','存档-手动-3','存档-手动-4','存档-手动-5','存档-自动-A','存档-自动-B'];try{document.body.innerHTML='<h1>正在重置世界...</h1>';const n=['【cot】必要关键cot','【cot】创世必要关键cot','【cot】身份必要关键cot'],o=await TavernHelper.getLorebookEntries(e);if(!o)throw new Error(`无法获取世界书 "${e}" 的条目。`);const s=e=>{const t=e.name||e.comment||'';return t.startsWith('[')||t.startsWith('【系统】')},c=o.filter(e=>(e.name||e.comment||'').startsWith('【诸天】')&&!s(e)).map(e=>e.uid);c.length>0&&(await TavernHelper.deleteLorebookEntries(e,c),console.log(`删除了 ${c.length} 个【诸天】条目。`));const i=o.filter(e=>{const n=e.name||e.comment||'',o=['[系统]主世界摘要','[系统]化身世界摘要','[系统]瞬时记忆','[系统]短期记忆','[系统]长期记忆'].includes(n);return t.includes(n)&&(!s(e)||o)});if(i.length>0){const t=i.map(e=>({uid:e.uid,content:''}));await TavernHelper.setLorebookEntries(e,t),console.log(`清空了 ${i.length} 个核心条目：${i.map(e=>e.name||e.comment).join(', ')}`)}const a=o.filter(e=>n.includes(e.name||e.comment||''));if(a.length>0){const t=a.map(e=>({uid:e.uid,enabled:!1}));await TavernHelper.setLorebookEntries(e,t),console.log(`禁用了 ${a.length} 个COT条目：${a.map(e=>e.name||e.comment).join(', ')}`)}alert('世界重置成功！'),location.reload()}catch(e){console.error('重置世界时出错:',e),document.body.innerHTML=`<h1>重置失败: ${e.message}</h1>`}}const w={class:'backpack-manager'},T={class:'item-selection'},C={class:'dropdown-wrapper'},D={class:'custom-options'},S={class:'category-header'},q=['onClick'],P=['onClick'],I={class:'selections-container'},O={class:'item-controls'},M=['onClick'],L=['onClick'],A=['onClick'],F={class:'custom-input-group'},j={__name:'BackpackManager',setup(e){const t=[{type:'consumables',name:'消耗品'},{type:'artifacts',name:'奇物'},{type:'materials',name:'材料'}],n=(0,s.ref)({type:'consumables',name:'',desc:''}),o=(0,s.computed)(()=>({consumables:m.consumables,artifacts:m.artifacts,materials:m.materials})),c=e=>{for(const n of t){const t=o.value[n.type].find(t=>t.id===e);if(t)return`${t.name} (${n.name})`}return'未知物品'},i=(e,t)=>{const n=(u.selections.backpack[e]||0)+t;n>0?u.selections.backpack[e]=n:a(e)},a=e=>{delete u.selections.backpack[e]},l=()=>{const{type:e,name:t,desc:o}=n.value;t.trim()&&o.trim()&&(k(e,{name:t,desc:o}),n.value.name='',n.value.desc='')};return(e,r)=>((0,s.openBlock)(),(0,s.createElementBlock)('div',w,[r[5]||(r[5]=(0,s.createElementVNode)('h3',null,'开局背包',-1)),(0,s.createElementVNode)('div',T,[(0,s.createElementVNode)('div',C,[r[3]||(r[3]=(0,s.createElementVNode)('span',null,'选择物品...',-1)),(0,s.createElementVNode)('div',D,[((0,s.openBlock)(),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(t,e=>{return(0,s.openBlock)(),(0,s.createElementBlock)(s.Fragment,{key:e.type},[(0,s.createElementVNode)('div',S,(0,s.toDisplayString)(e.name),1),((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)((t=e.type,o.value[t].filter(e=>!u.selections.backpack[e.id])),t=>((0,s.openBlock)(),(0,s.createElementBlock)('div',{class:'option-item',key:t.id,onClick:e=>{return n=t.id,void(u.selections.backpack[n]||(u.selections.backpack[n]=1));var n}},[(0,s.createElementVNode)('span',null,(0,s.toDisplayString)(t.name)+' ('+(0,s.toDisplayString)(t.cost)+'点)',1),t.custom?((0,s.openBlock)(),(0,s.createElementBlock)('button',{key:0,onClick:(0,s.withModifiers)(n=>(0,s.unref)(f)(e.type,t.id),['stop']),class:'delete-custom-item'},' × ',8,P)):(0,s.createCommentVNode)('v-if',!0)],8,q))),128))],64);var t}),64))])])]),(0,s.createElementVNode)('div',I,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)((0,s.unref)(u).selections.backpack,(e,t)=>((0,s.openBlock)(),(0,s.createElementBlock)('div',{key:t,class:'selected-item'},[(0,s.createElementVNode)('span',null,(0,s.toDisplayString)(c(t))+' x '+(0,s.toDisplayString)(e),1),(0,s.createElementVNode)('div',O,[(0,s.createElementVNode)('button',{onClick:e=>i(t,-1)},'-',8,M),(0,s.createElementVNode)('button',{onClick:e=>i(t,1)},'+',8,L),(0,s.createElementVNode)('button',{onClick:e=>a(t),class:'remove-btn'},'×',8,A)])]))),128))]),(0,s.createElementVNode)('div',F,[(0,s.withDirectives)((0,s.createElementVNode)('select',{'onUpdate:modelValue':r[0]||(r[0]=e=>n.value.type=e)},[...r[4]||(r[4]=[(0,s.createElementVNode)('option',{value:'consumables'},'消耗品',-1),(0,s.createElementVNode)('option',{value:'artifacts'},'奇物',-1),(0,s.createElementVNode)('option',{value:'materials'},'材料',-1)])],512),[[s.vModelSelect,n.value.type]]),(0,s.withDirectives)((0,s.createElementVNode)('input',{type:'text',placeholder:'自定义名称...','onUpdate:modelValue':r[1]||(r[1]=e=>n.value.name=e)},null,512),[[s.vModelText,n.value.name]]),(0,s.withDirectives)((0,s.createElementVNode)('textarea',{placeholder:'自定义详情...','onUpdate:modelValue':r[2]||(r[2]=e=>n.value.desc=e)},null,512),[[s.vModelText,n.value.desc]]),(0,s.createElementVNode)('button',{type:'button',onClick:l},'添加自定义物品')])]))}};var U=n(426);const J=(0,U.A)(j,[['__scopeId','data-v-4da48a4c']]),W={id:'character-creation-options'},H={class:'sentence'},G={class:'summary-text'},R={class:'dropdown-wrapper'},X={class:'custom-options'},Y=['onClick'],K=['onClick'],Q={key:0,class:'selections-container'},Z={class:'selected-item-detailed'},ee={class:'item-desc'},te={class:'custom-input-group'},ne={class:'sentence'},oe={class:'dropdown-wrapper'},se={class:'custom-options'},ce={class:'sentence'},ie={class:'dropdown-wrapper'},ae={class:'custom-options'},le=['onClick'],re=['onClick'],de={class:'selections-container'},me={class:'item-header'},ue=['onClick'],pe={class:'item-desc'},ke={class:'custom-input-group'},fe={class:'sentence'},ye={class:'dropdown-wrapper'},ge={class:'custom-options'},ve=['onClick'],Ee=['onClick'],he={class:'selections-container'},Ve={class:'item-header'},Ne=['onClick'],xe={class:'item-desc'},be={class:'custom-input-group'},_e={class:'sentence'},Be={class:'dropdown-wrapper'},we={class:'custom-options'},Te=['onClick','title'],Ce=['onClick'],De={class:'selections-container'},Se={class:'item-header'},$e=['onClick'],qe={class:'item-desc'},Pe={key:0,class:'item-skills'},Ie={class:'custom-input-group'},Oe={class:'custom-skills-creator'},Me=['onClick'],Le={class:'skill-input-row'},Ae={__name:'CharacterCreator',setup(e){const t=(0,s.ref)({identities:{name:'',desc:''},talents:{name:'',desc:''},past_experiences:{name:'',desc:''},arts:{name:'',desc:'',skills:[]}}),n=(0,s.ref)({name:'',desc:''}),o=()=>{n.value.name.trim()&&n.value.desc.trim()&&(t.value.arts.skills.push({...n.value,cost:2}),n.value.name='',n.value.desc='')},c=e=>{if('arts'===e){const e=t.value.arts;if(e.name.trim()&&e.desc.trim()){k('arts',{id:`custom-art-${Date.now()}`,name:e.name,desc:e.desc,cost:5,skills:e.skills.map(e=>({...e,id:`custom-skill-${Date.now()}`}))}),e.name='',e.desc='',e.skills=[]}}else{const n=t.value[e];n.name.trim()&&n.desc.trim()&&(k(e,{...n}),n.name='',n.desc='')}},i=(e,t)=>{if(!t)return'_______';const n=m[e].find(e=>e.id===t);return n?n.name:'_______'},a=(e,t)=>{if(!t)return null;return m[e].find(e=>e.id===t)},l=e=>{const t=u.selections[e];let n=m[e];return'gender'!==e&&'age'!==e&&(n=n.filter(e=>!e.requiredTone||e.requiredTone===u.selections.tone)),Array.isArray(t)?n.filter(e=>!t.includes(e.id)):n.filter(e=>e.id!==t)},r=(e,t,n=1)=>{if(1===n)u.selections[e]=t;else{const o=u.selections[e];!o.includes(t)&&o.length<n&&o.push(t)}},d=(e,t)=>{const n=u.selections[t],o=n.indexOf(e);o>-1&&n.splice(o,1)},p=e=>{const t=m.arts.find(t=>t.id===e);return t&&t.skills&&0!==t.skills.length?`初始技能：\n- ${t.skills.map(e=>e.name).join('\n- ')}`:''};return(e,m)=>((0,s.openBlock)(),(0,s.createElementBlock)(s.Fragment,null,[m[33]||(m[33]=(0,s.createElementVNode)('h1',null,'纪元之书 · 卷二',-1)),m[34]||(m[34]=(0,s.createElementVNode)('h2',null,'应运而生，天命之人',-1)),(0,s.createElementVNode)('div',W,[(0,s.createElementVNode)('div',H,[m[17]||(m[17]=(0,s.createTextVNode)(' 你，',-1)),(0,s.createElementVNode)('span',G,(0,s.toDisplayString)((0,s.unref)(u).playerCharacterName),1),m[18]||(m[18]=(0,s.createTextVNode)('，是 ',-1)),(0,s.createElementVNode)('div',R,[(0,s.createElementVNode)('span',null,(0,s.toDisplayString)(i('identities',(0,s.unref)(u).selections.identity)),1),(0,s.createElementVNode)('div',X,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(l('identities'),e=>((0,s.openBlock)(),(0,s.createElementBlock)('div',{key:e.id,onClick:t=>r('identity',e.id),class:(0,s.normalizeClass)({'custom-option-item':!0,'tone-exclusive':e.requiredTone})},[(0,s.createElementVNode)('span',null,(0,s.toDisplayString)(e.name),1),e.custom?((0,s.openBlock)(),(0,s.createElementBlock)('button',{key:0,onClick:(0,s.withModifiers)(t=>(0,s.unref)(f)('identities',e.id),['stop','prevent']),class:'remove-btn'},' × ',8,K)):(0,s.createCommentVNode)('v-if',!0)],10,Y))),128))])]),m[19]||(m[19]=(0,s.createTextVNode)(' 。 ',-1)),(0,s.unref)(u).selections.identity?((0,s.openBlock)(),(0,s.createElementBlock)('div',Q,[(0,s.createElementVNode)('div',Z,[(0,s.createElementVNode)('p',ee,(0,s.toDisplayString)(a('identities',(0,s.unref)(u).selections.identity)?.desc),1)])])):(0,s.createCommentVNode)('v-if',!0),(0,s.createElementVNode)('div',te,[(0,s.withDirectives)((0,s.createElementVNode)('input',{type:'text',placeholder:'自定义名称...','onUpdate:modelValue':m[0]||(m[0]=e=>t.value.identities.name=e)},null,512),[[s.vModelText,t.value.identities.name]]),(0,s.withDirectives)((0,s.createElementVNode)('textarea',{placeholder:'自定义详情...','onUpdate:modelValue':m[1]||(m[1]=e=>t.value.identities.desc=e)},null,512),[[s.vModelText,t.value.identities.desc]]),(0,s.createElementVNode)('button',{type:'button',onClick:m[2]||(m[2]=e=>c('identities'))},'添加')])]),(0,s.createElementVNode)('div',ne,[m[20]||(m[20]=(0,s.createTextVNode)(' 你的性别是 ',-1)),(0,s.createElementVNode)('div',oe,[(0,s.createElementVNode)('span',null,(0,s.toDisplayString)((0,s.unref)(u).selections.gender),1),(0,s.createElementVNode)('div',se,[(0,s.createElementVNode)('div',{onClick:m[3]||(m[3]=e=>r('gender','男'))},'男'),(0,s.createElementVNode)('div',{onClick:m[4]||(m[4]=e=>r('gender','女'))},'女')])]),m[21]||(m[21]=(0,s.createTextVNode)(' ，年龄 ',-1)),(0,s.withDirectives)((0,s.createElementVNode)('input',{type:'number','onUpdate:modelValue':m[5]||(m[5]=e=>(0,s.unref)(u).selections.age=e),min:'1',max:'999',class:'age-input'},null,512),[[s.vModelText,(0,s.unref)(u).selections.age,void 0,{number:!0}]]),m[22]||(m[22]=(0,s.createTextVNode)(' 岁。 ',-1))]),(0,s.createElementVNode)('div',ce,[m[24]||(m[24]=(0,s.createTextVNode)(' 你的人生曾有过 ',-1)),(0,s.createElementVNode)('div',ie,[m[23]||(m[23]=(0,s.createElementVNode)('span',null,'...',-1)),(0,s.createElementVNode)('div',ae,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(l('past_experiences'),e=>((0,s.openBlock)(),(0,s.createElementBlock)('div',{key:e.id,onClick:t=>r('past_experiences',e.id,3),class:(0,s.normalizeClass)({'custom-option-item':!0,'tone-exclusive':e.requiredTone})},[(0,s.createElementVNode)('span',null,(0,s.toDisplayString)(e.name),1),e.custom?((0,s.openBlock)(),(0,s.createElementBlock)('button',{key:0,onClick:(0,s.withModifiers)(t=>(0,s.unref)(f)('past_experiences',e.id),['stop','prevent']),class:'remove-btn'},' × ',8,re)):(0,s.createCommentVNode)('v-if',!0)],10,le))),128))])]),m[25]||(m[25]=(0,s.createTextVNode)(' 的经历。 ',-1)),(0,s.createElementVNode)('div',de,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)((0,s.unref)(u).selections.past_experiences,e=>((0,s.openBlock)(),(0,s.createElementBlock)('div',{key:e,class:'selected-item-detailed'},[(0,s.createElementVNode)('div',me,[(0,s.createElementVNode)('span',null,(0,s.toDisplayString)(a('past_experiences',e)?.name),1),(0,s.createElementVNode)('span',{class:'remove-item',onClick:t=>d(e,'past_experiences')},'×',8,ue)]),(0,s.createElementVNode)('p',pe,(0,s.toDisplayString)(a('past_experiences',e)?.desc),1)]))),128))]),(0,s.createElementVNode)('div',ke,[(0,s.withDirectives)((0,s.createElementVNode)('input',{type:'text',placeholder:'自定义名称...','onUpdate:modelValue':m[6]||(m[6]=e=>t.value.past_experiences.name=e)},null,512),[[s.vModelText,t.value.past_experiences.name]]),(0,s.withDirectives)((0,s.createElementVNode)('textarea',{placeholder:'自定义详情...','onUpdate:modelValue':m[7]||(m[7]=e=>t.value.past_experiences.desc=e)},null,512),[[s.vModelText,t.value.past_experiences.desc]]),(0,s.createElementVNode)('button',{type:'button',onClick:m[8]||(m[8]=e=>c('past_experiences'))},'添加')])]),(0,s.createElementVNode)('div',fe,[m[27]||(m[27]=(0,s.createTextVNode)(' 你天生便拥有 ',-1)),(0,s.createElementVNode)('div',ye,[m[26]||(m[26]=(0,s.createElementVNode)('span',null,'...',-1)),(0,s.createElementVNode)('div',ge,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(l('talents'),e=>((0,s.openBlock)(),(0,s.createElementBlock)('div',{key:e.id,onClick:t=>r('talents',e.id,3),class:(0,s.normalizeClass)({'custom-option-item':!0,'tone-exclusive':e.requiredTone})},[(0,s.createElementVNode)('span',null,(0,s.toDisplayString)(e.name),1),e.custom?((0,s.openBlock)(),(0,s.createElementBlock)('button',{key:0,onClick:(0,s.withModifiers)(t=>(0,s.unref)(f)('talents',e.id),['stop','prevent']),class:'remove-btn'},' × ',8,Ee)):(0,s.createCommentVNode)('v-if',!0)],10,ve))),128))])]),m[28]||(m[28]=(0,s.createTextVNode)(' 的天赋。 ',-1)),(0,s.createElementVNode)('div',he,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)((0,s.unref)(u).selections.talents,e=>((0,s.openBlock)(),(0,s.createElementBlock)('div',{key:e,class:'selected-item-detailed'},[(0,s.createElementVNode)('div',Ve,[(0,s.createElementVNode)('span',null,(0,s.toDisplayString)(a('talents',e)?.name),1),(0,s.createElementVNode)('span',{class:'remove-item',onClick:t=>d(e,'talents')},'×',8,Ne)]),(0,s.createElementVNode)('p',xe,(0,s.toDisplayString)(a('talents',e)?.desc),1)]))),128))]),(0,s.createElementVNode)('div',be,[(0,s.withDirectives)((0,s.createElementVNode)('input',{type:'text',placeholder:'自定义名称...','onUpdate:modelValue':m[9]||(m[9]=e=>t.value.talents.name=e)},null,512),[[s.vModelText,t.value.talents.name]]),(0,s.withDirectives)((0,s.createElementVNode)('textarea',{placeholder:'自定义详情...','onUpdate:modelValue':m[10]||(m[10]=e=>t.value.talents.desc=e)},null,512),[[s.vModelText,t.value.talents.desc]]),(0,s.createElementVNode)('button',{type:'button',onClick:m[11]||(m[11]=e=>c('talents'))},'添加')])]),(0,s.createElementVNode)('div',_e,[m[31]||(m[31]=(0,s.createTextVNode)(' 你掌握了 ',-1)),(0,s.createElementVNode)('div',Be,[m[29]||(m[29]=(0,s.createElementVNode)('span',null,'...',-1)),(0,s.createElementVNode)('div',we,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(l('arts'),e=>((0,s.openBlock)(),(0,s.createElementBlock)('div',{key:e.id,onClick:t=>r('arts',e.id,3),class:(0,s.normalizeClass)({'custom-option-item':!0,'tone-exclusive':e.requiredTone}),title:p(e.id)},[(0,s.createElementVNode)('span',null,(0,s.toDisplayString)(e.name),1),e.custom?((0,s.openBlock)(),(0,s.createElementBlock)('button',{key:0,onClick:(0,s.withModifiers)(t=>(0,s.unref)(f)('arts',e.id),['stop','prevent']),class:'remove-btn'},' × ',8,Ce)):(0,s.createCommentVNode)('v-if',!0)],10,Te))),128))])]),m[32]||(m[32]=(0,s.createTextVNode)(' 的技艺。 ',-1)),(0,s.createElementVNode)('div',De,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)((0,s.unref)(u).selections.arts,e=>((0,s.openBlock)(),(0,s.createElementBlock)('div',{key:e,class:'selected-item-detailed'},[(0,s.createElementVNode)('div',Se,[(0,s.createElementVNode)('span',null,(0,s.toDisplayString)(a('arts',e)?.name),1),(0,s.createElementVNode)('span',{class:'remove-item',onClick:t=>d(e,'arts')},'×',8,$e)]),(0,s.createElementVNode)('p',qe,(0,s.toDisplayString)(a('arts',e)?.desc),1),a('arts',e)?.skills?.length?((0,s.openBlock)(),(0,s.createElementBlock)('div',Pe,[m[30]||(m[30]=(0,s.createElementVNode)('strong',null,'初始技能:',-1)),(0,s.createElementVNode)('ul',null,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(a('arts',e).skills,e=>((0,s.openBlock)(),(0,s.createElementBlock)('li',{key:e.id},(0,s.toDisplayString)(e.name)+': '+(0,s.toDisplayString)(e.desc),1))),128))])])):(0,s.createCommentVNode)('v-if',!0)]))),128))]),(0,s.createElementVNode)('div',Ie,[(0,s.withDirectives)((0,s.createElementVNode)('input',{type:'text',placeholder:'自定义技艺名称...','onUpdate:modelValue':m[12]||(m[12]=e=>t.value.arts.name=e)},null,512),[[s.vModelText,t.value.arts.name]]),(0,s.withDirectives)((0,s.createElementVNode)('textarea',{placeholder:'自定义技艺详情...','onUpdate:modelValue':m[13]||(m[13]=e=>t.value.arts.desc=e)},null,512),[[s.vModelText,t.value.arts.desc]]),(0,s.createElementVNode)('div',Oe,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(t.value.arts.skills,(e,n)=>((0,s.openBlock)(),(0,s.createElementBlock)('div',{key:n,class:'custom-skill-item'},[(0,s.createElementVNode)('span',null,(0,s.toDisplayString)(e.name)+': '+(0,s.toDisplayString)(e.desc),1),(0,s.createElementVNode)('button',{onClick:(0,s.withModifiers)(e=>(e=>{t.value.arts.skills.splice(e,1)})(n),['stop','prevent']),class:'remove-btn'},'×',8,Me)]))),128)),(0,s.createElementVNode)('div',Le,[(0,s.withDirectives)((0,s.createElementVNode)('input',{type:'text',placeholder:'自定义技能名称...','onUpdate:modelValue':m[14]||(m[14]=e=>n.value.name=e)},null,512),[[s.vModelText,n.value.name]]),(0,s.withDirectives)((0,s.createElementVNode)('textarea',{placeholder:'自定义技能详情...','onUpdate:modelValue':m[15]||(m[15]=e=>n.value.desc=e)},null,512),[[s.vModelText,n.value.desc]]),(0,s.createElementVNode)('button',{type:'button',onClick:o},'添加技能')])]),(0,s.createElementVNode)('button',{type:'button',onClick:m[16]||(m[16]=e=>c('arts'))},'添加自定义技艺')])]),(0,s.createVNode)(J)])],64))}},Fe=(0,U.A)(Ae,[['__scopeId','data-v-2807ca9a']]),je={class:'cover-page-container'},Ue={__name:'CoverPage',setup(e){const t=()=>{p(1)};return(e,n)=>((0,s.openBlock)(),(0,s.createElementBlock)('div',je,[n[0]||(n[0]=(0,s.createElementVNode)('h1',{class:'main-title'},'轮回·诸天万界',-1)),n[1]||(n[1]=(0,s.createElementVNode)('h2',{class:'subtitle'},'创世向导',-1)),n[2]||(n[2]=(0,s.createElementVNode)('p',{class:'description'},' 汝将执掌创世之权柄，于混沌中开辟一方大千世界，自时光长河中唤醒一缕神魂，赋予其姓名、过往与天命。此间种种，皆由汝定。 ',-1)),(0,s.createElementVNode)('button',{class:'start-btn',onClick:t},'开启创世')]))}},Je=(0,U.A)(Ue,[['__scopeId','data-v-57060730']]),We={class:'schematic-display'},He={viewBox:'0 0 200 200',preserveAspectRatio:'xMidYMid meet'},Ge=['id'],ze=['offset'],Re=['stroke-width'],Xe={key:0},Ye=['fill'],Ke=['stroke'],Qe=['stroke'],Ze={key:1},et=['stroke','fill'],tt=['fill'],nt={key:2},ot=['d','stroke'],st={key:3},ct=['fill'],it=['fill'],at=['fill'],lt={key:4},rt=['cx','cy','r','fill'],dt={__name:'SchematicDisplay',setup(e){const t=(0,s.computed)(()=>{const e=m.tones.find(e=>e.id===u.selections.tone);return e?e.color:'var(--color-cyan-tian)'}),n=(0,s.computed)(()=>.5+.5*u.selections.tags.length),o=(0,s.computed)(()=>`relics-grad-${u.selections.relics.join('-')}`),c=(0,s.computed)(()=>{const e=m.relics.filter(e=>u.selections.relics.includes(e.id));if(0===e.length)return{colors:['var(--color-gold-liu)'],offsets:[100]};const t=e.map(e=>e.color),n=t.map((_,e)=>e/(t.length-1||1)*100);return{colors:t,offsets:n}});return(e,i)=>((0,s.openBlock)(),(0,s.createElementBlock)('div',We,[((0,s.openBlock)(),(0,s.createElementBlock)('svg',He,[(0,s.createElementVNode)('defs',null,[i[0]||(i[0]=(0,s.createElementVNode)('radialGradient',{id:'grad-glow',cx:'50%',cy:'50%',r:'50%'},[(0,s.createElementVNode)('stop',{offset:'0%',style:{'stop-color':'rgba(212, 175, 55, 0.3)'}}),(0,s.createElementVNode)('stop',{offset:'100%',style:{'stop-color':'rgba(212, 175, 55, 0)'}})],-1)),(0,s.createElementVNode)('radialGradient',{id:o.value,cx:'50%',cy:'50%',r:'50%'},[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(c.value.colors,(e,t)=>((0,s.openBlock)(),(0,s.createElementBlock)('stop',{key:t,offset:`${c.value.offsets[t]}%`,style:(0,s.normalizeStyle)(`stop-color:${e}`)},null,12,ze))),128))],8,Ge)]),(0,s.createCommentVNode)(' Base Glow '),(0,s.createElementVNode)('circle',{cx:'100',cy:'100',r:'90',fill:'url(#grad-glow)','stroke-width':n.value,stroke:'rgba(212, 175, 55, 0.2)'},null,8,Re),(0,s.createCommentVNode)(' Dynamic Schematics '),((0,s.openBlock)(),(0,s.createElementBlock)('g',{key:(0,s.unref)(u).selections.blueprint},['bp-standard'===(0,s.unref)(u).selections.blueprint?((0,s.openBlock)(),(0,s.createElementBlock)('g',Xe,[(0,s.createElementVNode)('circle',{cx:'100',cy:'100',r:'2',fill:`url(#${o.value})`},null,8,Ye),(0,s.createElementVNode)('circle',{cx:'100',cy:'100',r:'30',stroke:t.value,'stroke-width':'0.5',fill:'none','stroke-dasharray':'2 2'},null,8,Ke),(0,s.createElementVNode)('circle',{cx:'100',cy:'100',r:'60',stroke:t.value,'stroke-width':'0.5',fill:'none','stroke-dasharray':'4 4'},null,8,Qe)])):(0,s.createCommentVNode)('v-if',!0),'bp-crystal-wall'===(0,s.unref)(u).selections.blueprint?((0,s.openBlock)(),(0,s.createElementBlock)('g',Ze,[(0,s.createElementVNode)('circle',{cx:'100',cy:'100',r:'70',stroke:t.value,'stroke-width':'1',fill:`url(#${o.value})`,'fill-opacity':'0.1'},null,8,et),(0,s.createElementVNode)('circle',{cx:'100',cy:'100',r:'5',fill:`url(#${o.value})`},null,8,tt)])):(0,s.createCommentVNode)('v-if',!0),'bp-multiverse'===(0,s.unref)(u).selections.blueprint?((0,s.openBlock)(),(0,s.createElementBlock)('g',nt,[((0,s.openBlock)(),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(5,e=>(0,s.createElementVNode)('path',{key:e,d:`M ${30+25*e} 50 A 50 50 0 1 1 ${30+25*e} 150`,stroke:t.value,'stroke-width':'0.5',fill:'none',opacity:'0.6'},null,8,ot)),64))])):(0,s.createCommentVNode)('v-if',!0),'bp-planar'===(0,s.unref)(u).selections.blueprint?((0,s.openBlock)(),(0,s.createElementBlock)('g',st,[(0,s.createElementVNode)('rect',{x:'30',y:'99',width:'140',height:'2',fill:`url(#${o.value})`},null,8,ct),(0,s.createElementVNode)('rect',{x:'50',y:'70',width:'100',height:'1',fill:t.value,opacity:'0.5'},null,8,it),(0,s.createElementVNode)('rect',{x:'50',y:'130',width:'100',height:'1',fill:t.value,opacity:'0.5'},null,8,at)])):(0,s.createCommentVNode)('v-if',!0),'bp-myriad'===(0,s.unref)(u).selections.blueprint?((0,s.openBlock)(),(0,s.createElementBlock)('g',lt,[((0,s.openBlock)(),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(15,e=>(0,s.createElementVNode)('circle',{key:e,cx:140*Math.random()+30,cy:140*Math.random()+30,r:5*Math.random()+2,fill:t.value,opacity:'0.7'},null,8,rt)),64))])):(0,s.createCommentVNode)('v-if',!0)]))]))]))}},mt=(0,U.A)(dt,[['__scopeId','data-v-0e7db4dc']]),ut={class:'generation-progress-container'},pt={class:'schematic-box'},kt={class:'progress-bar-container'},ft={class:'progress-text'},yt={__name:'GenerationProgress',setup(e){const t=(0,s.ref)(0);return(0,s.onMounted)(()=>{const e=setInterval(()=>{t.value<99?t.value+=1:clearInterval(e)},1212)}),(e,n)=>((0,s.openBlock)(),(0,s.createElementBlock)('div',ut,[(0,s.createElementVNode)('div',pt,[(0,s.createVNode)(mt)]),(0,s.createElementVNode)('div',kt,[(0,s.createElementVNode)('div',{class:'progress-bar',style:(0,s.normalizeStyle)({width:t.value+'%'})},null,4)]),(0,s.createElementVNode)('p',ft,'正在为您推演诸天万界... '+(0,s.toDisplayString)(t.value)+'%',1)]))}},gt=(0,U.A)(yt,[['__scopeId','data-v-e6ac8c02']]),vt={id:'potential-allocation',class:'potential-grid'},Et={class:'potential-controls'},ht=['onClick'],Vt=['onClick'],Nt=(0,s.defineComponent)({__name:'PotentialAllocator',setup(e){const t=(e,t)=>{const n=t,o=m.potentials[e]?.cost||0,s=u.potentialPoints[e]||0;if(n>0)u.remainingPoints>=o?u.potentialPoints[e]=s+n:console.warn('创世点数不足！');else if(n<0){const t=s+n;t>=0&&(u.potentialPoints[e]=t)}};return(e,n)=>((0,s.openBlock)(),(0,s.createElementBlock)(s.Fragment,null,[n[0]||(n[0]=(0,s.createElementVNode)('h1',null,'纪元之书 · 卷三',-1)),n[1]||(n[1]=(0,s.createElementVNode)('h2',null,'塑造潜力，奠定道基',-1)),(0,s.createElementVNode)('div',vt,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)((0,s.unref)(m).potentials,(e,n)=>((0,s.openBlock)(),(0,s.createElementBlock)('div',{key:n,class:'potential-item'},[(0,s.createElementVNode)('h4',null,(0,s.toDisplayString)(e.name),1),(0,s.createElementVNode)('div',Et,[(0,s.createElementVNode)('button',{type:'button',onClick:e=>t(n,-1)},'-',8,ht),(0,s.createElementVNode)('span',null,(0,s.toDisplayString)(e.base+((0,s.unref)(u).potentialPoints[n]||0)),1),(0,s.createElementVNode)('button',{type:'button',onClick:e=>t(n,1)},'+',8,Vt)])]))),128))])],64))}}),xt='reincarnation_presets_v2';async function bt(e){if(!e)return;let t=!1;const n=[];for(const o in e){const s=o,c=e[s];if(c&&Array.isArray(m[s])){const e=new Set(m[s].map(e=>e.id));c.forEach(o=>{if(!e.has(o.id)){const e=new Promise(e=>{k(s,o),t=!0,e()});n.push(e)}})}}n.length>0&&(await Promise.all(n),t&&i().info('方案中包含的自定义选项已自动添加到您的游戏中。'))}function _t(){try{const e=localStorage.getItem(xt);return e?JSON.parse(e):[]}catch(e){return console.error('加载方案列表失败:',e),i().error('加载方案列表失败。'),[]}}function Bt(e){if(!e||!e.trim())return void i().warning('方案名称不能为空。');const t=_t(),n=function(){const e={},t=[u.selections.blueprint,u.selections.tone,u.selections.identity,u.selections.core_need,...u.selections.tags||[],...u.selections.relics||[],...u.selections.talents||[],...u.selections.past_experiences||[],...u.selections.character_traits||[],...Object.keys(u.selections.backpack||{})],n=[...new Set(t.filter(e=>e&&e.startsWith('custom-')))];if(0===n.length)return{};const o=['difficulties','potentials'];for(const t in m){if(o.includes(t))continue;const s=m[t];if(Array.isArray(s)){const o=s.filter(e=>n.includes(e.id));o.length>0&&(e[t]=o)}}return e}(),o={name:e.trim(),selections:JSON.parse(JSON.stringify(u.selections)),potentialPoints:JSON.parse(JSON.stringify(u.potentialPoints)),...Object.keys(n).length>0&&{customData:n}},s=t.findIndex(e=>e.name===o.name);s>-1?t[s]=o:t.push(o);try{localStorage.setItem(xt,JSON.stringify(t)),i().success(`方案 "${o.name}" 已保存！`)}catch(e){console.error('保存方案失败:',e),i().error('保存方案失败。')}}const wt={class:'modal-content'},Tt={class:'preset-list'},Ct={class:'preset-name'},Dt={class:'preset-actions'},St=['onClick'],$t=['onClick'],qt=['onClick'],Pt={key:0,class:'no-presets'},It={class:'save-section'},Ot={class:'import-section'},Mt={__name:'PresetManager',props:{show:Boolean},emits:['close'],setup(e,{emit:t}){const n=e,o=t,c=(0,s.ref)([]),a=(0,s.ref)(''),l=(0,s.ref)(null),r=()=>{c.value=_t()},d=()=>{Bt(a.value),a.value='',r()},m=e=>{!async function(e){try{await bt(e.customData),await(0,s.nextTick)(),Object.assign(u.selections,JSON.parse(JSON.stringify(e.selections))),Object.assign(u.potentialPoints,JSON.parse(JSON.stringify(e.potentialPoints))),i().success(`方案 "${e.name}" 已加载！`)}catch(e){console.error('加载方案失败:',e),i().error('加载方案失败。')}}(e),g()},p=e=>{confirm(`确定要删除方案 "${e}" 吗？此操作不可撤销。`)&&(!function(e){let t=_t();t=t.filter(t=>t.name!==e);try{localStorage.setItem(xt,JSON.stringify(t)),i().info(`方案 "${e}" 已删除。`)}catch(e){console.error('删除方案失败:',e),i().error('删除方案失败。')}}(e),r())},k=e=>{!function(e){try{const t=JSON.stringify(e,null,2),n=new Blob([t],{type:'application/json'}),o=URL.createObjectURL(n),s=document.createElement('a');s.href=o,s.download=`轮回开局方案-${e.name}.json`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(o),i().success('方案已开始导出！')}catch(e){console.error('导出方案失败:',e),i().error('导出方案失败。')}}(e)},f=()=>{l.value.click()},y=async e=>{const t=e.target.files[0];t&&(await function(e){return new Promise((t,n)=>{const o=new FileReader;o.onload=e=>{try{const n=JSON.parse(e.target?.result);if(!n.name||!n.selections||!n.potentialPoints)throw new Error('无效的方案文件格式。');bt(n.customData),Bt(n.name);const o=_t(),s=o.find(e=>e.name===n.name);s&&(Object.assign(s,n),localStorage.setItem(xt,JSON.stringify(o))),i().success(`方案 "${n.name}" 已成功导入并保存！`),t()}catch(e){const t=e;console.error('导入方案失败:',t),i().error(`导入失败: ${t.message}`),n(t)}},o.onerror=e=>{i().error('读取文件失败。'),n(e)},o.readAsText(e)})}(t),r())},g=()=>{o('close')};return(0,s.watch)(()=>n.show,e=>{e&&r()}),(0,s.onMounted)(r),(t,n)=>e.show?((0,s.openBlock)(),(0,s.createElementBlock)('div',{key:0,class:'modal-overlay',onClick:(0,s.withModifiers)(g,['self'])},[(0,s.createElementVNode)('div',wt,[n[1]||(n[1]=(0,s.createElementVNode)('h3',null,'管理开局方案',-1)),(0,s.createElementVNode)('div',Tt,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(c.value,e=>((0,s.openBlock)(),(0,s.createElementBlock)('div',{key:e.name,class:'preset-item'},[(0,s.createElementVNode)('span',Ct,(0,s.toDisplayString)(e.name),1),(0,s.createElementVNode)('div',Dt,[(0,s.createElementVNode)('button',{onClick:t=>m(e)},'加载',8,St),(0,s.createElementVNode)('button',{onClick:t=>k(e)},'导出',8,$t),(0,s.createElementVNode)('button',{class:'delete',onClick:t=>p(e.name)},'删除',8,qt)])]))),128)),0===c.value.length?((0,s.openBlock)(),(0,s.createElementBlock)('p',Pt,'暂无任何方案。')):(0,s.createCommentVNode)('v-if',!0)]),(0,s.createElementVNode)('div',It,[(0,s.withDirectives)((0,s.createElementVNode)('input',{type:'text','onUpdate:modelValue':n[0]||(n[0]=e=>a.value=e),placeholder:'输入新方案名称...'},null,512),[[s.vModelText,a.value]]),(0,s.createElementVNode)('button',{onClick:d},'保存当前选择')]),(0,s.createElementVNode)('div',Ot,[(0,s.createElementVNode)('button',{onClick:f},'导入方案文件'),(0,s.createElementVNode)('input',{type:'file',ref_key:'fileInput',ref:l,onChange:y,accept:'.json',style:{display:'none'}},null,544)]),(0,s.createElementVNode)('button',{class:'close-btn',onClick:g},'关闭')])])):(0,s.createCommentVNode)('v-if',!0)}},Lt=(0,U.A)(Mt,[['__scopeId','data-v-0bd2db2a']]),At={opening:[{text:'汝之命途，如风中残烛，摇曳不定',condition:()=>u.remainingPoints<0},{text:'汝之命途，似荆棘丛生，步步维艰',condition:()=>u.remainingPoints>=0&&u.remainingPoints<15},{text:'汝之命途，若逆水行舟，不进则退',condition:()=>u.remainingPoints>=15&&u.remainingPoints<30},{text:'汝之命途，如平湖秋月，波澜不惊',condition:()=>u.remainingPoints>=30&&u.remainingPoints<50},{text:'汝之命途，若旭日初升，霞光万道',condition:()=>u.remainingPoints>=50&&u.remainingPoints<70},{text:'汝之命途，似鲲鹏展翅，扶摇直上',condition:()=>u.remainingPoints>=70},{text:'汝之命途，乃天选之子，鸿运当头',condition:()=>u.selections.talents.includes('talent-lucky-star')},{text:'汝之命途，自混沌中来，前路未卜',condition:()=>'bp-myriad'===u.selections.blueprint},{text:'汝之命途，承载着旧日的辉光与诅咒',condition:()=>'id-noble'===u.selections.identity}],focus:[{text:'此行或将饱受磨难，九死一生',condition:()=>u.selections.tags.length>=3},{text:'前路潜藏着足以颠覆世界的奇遇',condition:()=>u.selections.relics.length>=3},{text:'你的力量将引来无数觊觎与纷争',condition:()=>u.potentialPoints.气>12||u.potentialPoints.精>12},{text:'你的智慧将照亮时代的黑暗角落',condition:()=>u.potentialPoints.神>12},{text:'你的命运充满了不可预知的变数',condition:()=>u.potentialPoints.运>12},{text:'你将以凡人之躯，比肩神明',condition:()=>'tone-tech'===u.selections.tone&&u.potentialPoints.神>10},{text:'你将在爱恨情仇中挣扎，勘破心魔',condition:()=>u.selections.past_experiences.some(e=>e.includes('revenge')||e.includes('love'))},{text:'你将背负着众人的期望，砥砺前行',condition:()=>u.selections.identity.includes('prince')||u.selections.identity.includes('protector')},{text:'你将以手中之艺，刻画属于自己的传奇',condition:()=>u.selections.arts.length>0},{text:'你的双手既能创造奇迹，亦能带来毁灭',condition:()=>u.selections.arts.includes('art-alchemy')||u.selections.arts.includes('art-smithing')}],ending:[{text:'然，星星之火，亦可燎原。',condition:()=>u.selections.arts.includes('art-swordsmanship')},{text:'但，求知之心，终将窥见天道。',condition:()=>u.selections.arts.includes('art-divination')},{text:'然，心有归宿，虽死无憾。',condition:()=>'id-wanderer'===u.selections.identity},{text:'但，自由之魂，必将挣脱一切枷锁。',condition:()=>'id-gladiator-slave'===u.selections.identity},{text:'然，复仇之火，也能锻造不朽新生。',condition:()=>u.selections.past_experiences.includes('pe-xiuxian-1')},{text:'但，锻造之锤，亦能敲响时代的洪钟。',condition:()=>u.selections.arts.includes('art-smithing')},{text:'然，医者仁心，可于乱世中开辟一方净土。',condition:()=>u.selections.arts.includes('art-medicine')},{text:'但，影中利刃，亦是守护秩序的最后手段。',condition:()=>u.selections.arts.includes('art-stealth')},{text:'然，与兽同行者，其心必怀赤诚。',condition:()=>u.selections.arts.includes('art-beast-taming')},{text:'但，权谋之术，终将反噬其主。',condition:()=>u.selections.arts.includes('art-rhetoric')}]};const Ft={id:'summary-page'},jt={class:'summary-text'},Ut={class:'summary-text'},Jt={class:'summary-text'},Wt={class:'summary-text'},Ht={class:'summary-text'},Gt={class:'summary-text'},zt={class:'summary-text'},Rt={class:'summary-text'},Xt={class:'summary-text'},Yt={class:'summary-text'},Kt={class:'summary-text'},Qt={class:'summary-text'},Zt={class:'summary-text'},en={class:'summary-text'},tn={class:'summary-text'},nn={class:'summary-text'},on={class:'destiny-text'},sn={__name:'SummaryPage',emits:['navigate','open-presets'],setup(e,{emit:t}){const n=(0,s.ref)('');(0,s.onMounted)(()=>{n.value=function(){let e='';const t=At.opening.find(e=>e.condition());e+=t?t.text:'汝之命途，深邃如夜。';const n=At.focus.find(e=>e.condition());e+=n?`，${n.text}`:'，前路漫漫，祸福相依';const o=At.ending.find(e=>e.condition());return e+=o?`。${o.text}`:'。',e}()});const o=(0,s.computed)(()=>u.playerCharacterName||'天命之人'),c=(e,t)=>{if(!t)return'未定';const n=m[e].find(e=>e.id===t);return n?n.name:'未定'},i=(e,t)=>{if(!t||0===t.length)return'未知的';const n=m[e];return t.map(e=>{const t=n.find(t=>t.id===e);return t?`“${t.name}”`:''}).filter(Boolean).join('、')},a=(0,s.computed)(()=>{const e={};for(const t in m.potentials)e[t]=m.potentials[t].base+(u.potentialPoints[t]||0);return e}),l=()=>{const e=[],{backpack:t}=u.selections,n=[...m.consumables,...m.artifacts,...m.materials];for(const o in t){const s=n.find(e=>e.id===o);s&&e.push(`${s.name} x${t[o]}`)}return e.length>0?e.join('、'):'空空如也'};return(e,t)=>((0,s.openBlock)(),(0,s.createElementBlock)(s.Fragment,null,[t[21]||(t[21]=(0,s.createElementVNode)('h1',null,'纪元之书 · 终章',-1)),t[22]||(t[22]=(0,s.createElementVNode)('h2',null,'天命之卷，由此展开',-1)),(0,s.createElementVNode)('div',Ft,[(0,s.createElementVNode)('p',null,[t[0]||(t[0]=(0,s.createTextVNode)(' 世界坐落于',-1)),(0,s.createElementVNode)('span',jt,(0,s.toDisplayString)(c('blueprints',(0,s.unref)(u).selections.blueprint)),1),t[1]||(t[1]=(0,s.createTextVNode)('之中，此世的基调为',-1)),(0,s.createElementVNode)('span',Ut,(0,s.toDisplayString)(c('tones',(0,s.unref)(u).selections.tone)),1),t[2]||(t[2]=(0,s.createTextVNode)('。然而，它曾遭受',-1)),(0,s.createElementVNode)('span',Jt,(0,s.toDisplayString)(i('tags',(0,s.unref)(u).selections.tags)),1),t[3]||(t[3]=(0,s.createTextVNode)('之灾，如今只余',-1)),(0,s.createElementVNode)('span',Wt,(0,s.toDisplayString)(i('relics',(0,s.unref)(u).selections.relics)),1),t[4]||(t[4]=(0,s.createTextVNode)('作为文明的墓碑。 ',-1))]),(0,s.createElementVNode)('p',null,[t[5]||(t[5]=(0,s.createTextVNode)(' 你，',-1)),(0,s.createElementVNode)('span',Ht,(0,s.toDisplayString)(o.value),1),t[6]||(t[6]=(0,s.createTextVNode)('，一个',-1)),(0,s.createElementVNode)('span',Gt,(0,s.toDisplayString)((0,s.unref)(u).selections.age),1),t[7]||(t[7]=(0,s.createTextVNode)('岁的',-1)),(0,s.createElementVNode)('span',zt,(0,s.toDisplayString)((0,s.unref)(u).selections.gender),1),t[8]||(t[8]=(0,s.createTextVNode)('性，将以',-1)),(0,s.createElementVNode)('span',Rt,(0,s.toDisplayString)(c('identities',(0,s.unref)(u).selections.identity)),1),t[9]||(t[9]=(0,s.createTextVNode)('的身份，于此世应运而生。 ',-1))]),(0,s.createElementVNode)('p',null,[t[10]||(t[10]=(0,s.createTextVNode)(' 你的人生曾有过',-1)),(0,s.createElementVNode)('span',Xt,(0,s.toDisplayString)(i('past_experiences',(0,s.unref)(u).selections.past_experiences)),1),t[11]||(t[11]=(0,s.createTextVNode)('的经历。你掌握了',-1)),(0,s.createElementVNode)('span',Yt,(0,s.toDisplayString)(i('arts',(0,s.unref)(u).selections.arts)),1),t[12]||(t[12]=(0,s.createTextVNode)('的技艺，并觉醒了',-1)),(0,s.createElementVNode)('span',Kt,(0,s.toDisplayString)(i('talents',(0,s.unref)(u).selections.talents)),1),t[13]||(t[13]=(0,s.createTextVNode)('的天赋。 ',-1))]),(0,s.createElementVNode)('p',null,[t[14]||(t[14]=(0,s.createTextVNode)(' 你携带了',-1)),(0,s.createElementVNode)('span',Qt,(0,s.toDisplayString)(l()),1),t[15]||(t[15]=(0,s.createTextVNode)('，踏上未知的旅途。 ',-1))]),(0,s.createElementVNode)('p',null,[t[16]||(t[16]=(0,s.createTextVNode)(' 你的潜力被最终确定为： 精 ',-1)),(0,s.createElementVNode)('span',Zt,(0,s.toDisplayString)(a.value['精']),1),t[17]||(t[17]=(0,s.createTextVNode)(', 气 ',-1)),(0,s.createElementVNode)('span',en,(0,s.toDisplayString)(a.value['气']),1),t[18]||(t[18]=(0,s.createTextVNode)(', 神 ',-1)),(0,s.createElementVNode)('span',tn,(0,s.toDisplayString)(a.value['神']),1),t[19]||(t[19]=(0,s.createTextVNode)(', 运 ',-1)),(0,s.createElementVNode)('span',nn,(0,s.toDisplayString)(a.value['运']),1),t[20]||(t[20]=(0,s.createTextVNode)('。 ',-1))])]),(0,s.createElementVNode)('p',on,'【天命判词】：'+(0,s.toDisplayString)(n.value),1)],64))}},cn={id:'world-building-options'},an={class:'sentence'},ln={class:'dropdown-wrapper'},rn={class:'custom-options'},dn=['onClick'],mn=['onClick'],un={class:'custom-input-group'},pn={class:'sentence'},kn={class:'dropdown-wrapper'},fn={class:'custom-options'},yn=['onClick'],gn=['onClick'],vn={class:'custom-input-group'},En={class:'sentence'},hn={class:'dropdown-wrapper'},Vn={class:'custom-options'},Nn=['onClick'],xn=['onClick'],bn={class:'selections-container'},_n=['onClick'],Bn={class:'custom-input-group'},wn={class:'sentence'},Tn={class:'dropdown-wrapper'},Cn={class:'custom-options'},Dn=['onClick'],Sn=['onClick'],$n={class:'selections-container'},qn=['onClick'],Pn={class:'custom-input-group'},In={__name:'WorldBuilder',setup(e){const t=(0,s.ref)({name:'',desc:''}),n=(0,s.ref)({name:'',desc:''}),o=(0,s.ref)({name:'',desc:''}),c=(0,s.ref)({name:'',desc:''}),i=()=>{t.value.name.trim()&&t.value.desc.trim()&&(k('blueprints',{...t.value,cost:0,scale_points:0,complexity_points:0}),t.value={name:'',desc:''})},a=()=>{n.value.name.trim()&&n.value.desc.trim()&&(k('tones',{...n.value,cost:0,scale_points:0,complexity_points:0}),n.value={name:'',desc:''})},l=()=>{o.value.name.trim()&&o.value.desc.trim()&&(k('tags',{...o.value,cost:0,scale_points:0,complexity_points:0}),o.value={name:'',desc:''})},r=()=>{c.value.name.trim()&&c.value.desc.trim()&&(k('relics',{...c.value,cost:0,scale_points:0,complexity_points:0}),c.value={name:'',desc:''})},d=(e,t)=>{if(!t)return'_______';const n=m[e].find(e=>e.id===t);return n?n.desc:'_______'},p=(e,t,n=1)=>{if(1===n)u.selections[e]=t;else{const o=u.selections[e];!o.includes(t)&&o.length<n&&o.push(t)}},y=(e,t)=>{const n=u.selections[t],o=n.indexOf(e);o>-1&&n.splice(o,1)};return(e,k)=>((0,s.openBlock)(),(0,s.createElementBlock)(s.Fragment,null,[k[18]||(k[18]=(0,s.createElementVNode)('h1',null,'纪元之书 · 卷一',-1)),k[19]||(k[19]=(0,s.createElementVNode)('h2',null,'追溯历史，定义现在',-1)),(0,s.createElementVNode)('div',cn,[(0,s.createElementVNode)('div',an,[k[8]||(k[8]=(0,s.createTextVNode)(' 你的世界位于 ',-1)),(0,s.createElementVNode)('div',ln,[(0,s.createElementVNode)('span',null,(0,s.toDisplayString)(d('blueprints',(0,s.unref)(u).selections.blueprint)),1),(0,s.createElementVNode)('div',rn,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)((0,s.unref)(m).blueprints,e=>((0,s.openBlock)(),(0,s.createElementBlock)('div',{key:e.id,onClick:t=>p('blueprint',e.id),class:'custom-option-item'},[(0,s.createElementVNode)('span',null,(0,s.toDisplayString)(e.name),1),e.custom?((0,s.openBlock)(),(0,s.createElementBlock)('button',{key:0,onClick:(0,s.withModifiers)(t=>(0,s.unref)(f)('blueprints',e.id),['stop','prevent']),class:'remove-btn'},' × ',8,mn)):(0,s.createCommentVNode)('v-if',!0)],8,dn))),128))])]),k[9]||(k[9]=(0,s.createTextVNode)(' 之中。 ',-1)),(0,s.createElementVNode)('div',un,[(0,s.withDirectives)((0,s.createElementVNode)('input',{type:'text',placeholder:'自定义名称...','onUpdate:modelValue':k[0]||(k[0]=e=>t.value.name=e)},null,512),[[s.vModelText,t.value.name]]),(0,s.withDirectives)((0,s.createElementVNode)('textarea',{placeholder:'自定义详情...','onUpdate:modelValue':k[1]||(k[1]=e=>t.value.desc=e)},null,512),[[s.vModelText,t.value.desc]]),(0,s.createElementVNode)('button',{type:'button',onClick:i},'添加')])]),(0,s.createElementVNode)('div',pn,[k[10]||(k[10]=(0,s.createTextVNode)(' 这个世界的主要文明形态为 ',-1)),(0,s.createElementVNode)('div',kn,[(0,s.createElementVNode)('span',null,(0,s.toDisplayString)(d('tones',(0,s.unref)(u).selections.tone)),1),(0,s.createElementVNode)('div',fn,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)((0,s.unref)(m).tones,e=>((0,s.openBlock)(),(0,s.createElementBlock)('div',{key:e.id,onClick:t=>p('tone',e.id),class:'custom-option-item'},[(0,s.createElementVNode)('span',null,(0,s.toDisplayString)(e.name),1),e.custom?((0,s.openBlock)(),(0,s.createElementBlock)('button',{key:0,onClick:(0,s.withModifiers)(t=>(0,s.unref)(f)('tones',e.id),['stop','prevent']),class:'remove-btn'},' × ',8,gn)):(0,s.createCommentVNode)('v-if',!0)],8,yn))),128))])]),k[11]||(k[11]=(0,s.createTextVNode)(' 。 ',-1)),(0,s.createElementVNode)('div',vn,[(0,s.withDirectives)((0,s.createElementVNode)('input',{type:'text',placeholder:'自定义名称...','onUpdate:modelValue':k[2]||(k[2]=e=>n.value.name=e)},null,512),[[s.vModelText,n.value.name]]),(0,s.withDirectives)((0,s.createElementVNode)('textarea',{placeholder:'自定义详情...','onUpdate:modelValue':k[3]||(k[3]=e=>n.value.desc=e)},null,512),[[s.vModelText,n.value.desc]]),(0,s.createElementVNode)('button',{type:'button',onClick:a},'添加')])]),(0,s.createElementVNode)('div',En,[k[13]||(k[13]=(0,s.createTextVNode)(' 但数个纪元前，它曾经历 ',-1)),(0,s.createElementVNode)('div',hn,[k[12]||(k[12]=(0,s.createElementVNode)('span',null,'...',-1)),(0,s.createElementVNode)('div',Vn,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)((0,s.unref)(m).tags,e=>((0,s.openBlock)(),(0,s.createElementBlock)('div',{key:e.id,onClick:t=>p('tags',e.id,3),class:'custom-option-item'},[(0,s.createElementVNode)('span',null,(0,s.toDisplayString)(e.name),1),e.custom?((0,s.openBlock)(),(0,s.createElementBlock)('button',{key:0,onClick:(0,s.withModifiers)(t=>(0,s.unref)(f)('tags',e.id),['stop','prevent']),class:'remove-btn'},' × ',8,xn)):(0,s.createCommentVNode)('v-if',!0)],8,Nn))),128))])]),k[14]||(k[14]=(0,s.createTextVNode)(' 的灾难。 ',-1)),(0,s.createElementVNode)('div',bn,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)((0,s.unref)(u).selections.tags,e=>((0,s.openBlock)(),(0,s.createElementBlock)('span',{key:e,class:'selected-item'},[(0,s.createTextVNode)((0,s.toDisplayString)(d('tags',e))+' ',1),(0,s.createElementVNode)('span',{class:'remove-item',onClick:t=>y(e,'tags')},'×',8,_n)]))),128))]),(0,s.createElementVNode)('div',Bn,[(0,s.withDirectives)((0,s.createElementVNode)('input',{type:'text',placeholder:'自定义名称...','onUpdate:modelValue':k[4]||(k[4]=e=>o.value.name=e)},null,512),[[s.vModelText,o.value.name]]),(0,s.withDirectives)((0,s.createElementVNode)('textarea',{placeholder:'自定义详情...','onUpdate:modelValue':k[5]||(k[5]=e=>o.value.desc=e)},null,512),[[s.vModelText,o.value.desc]]),(0,s.createElementVNode)('button',{type:'button',onClick:l},'添加')])]),(0,s.createElementVNode)('div',wn,[k[16]||(k[16]=(0,s.createTextVNode)(' 如今，大地上仍散落着 ',-1)),(0,s.createElementVNode)('div',Tn,[k[15]||(k[15]=(0,s.createElementVNode)('span',null,'...',-1)),(0,s.createElementVNode)('div',Cn,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)((0,s.unref)(m).relics,e=>((0,s.openBlock)(),(0,s.createElementBlock)('div',{key:e.id,onClick:t=>p('relics',e.id,3),class:'custom-option-item'},[(0,s.createElementVNode)('span',null,(0,s.toDisplayString)(e.name),1),e.custom?((0,s.openBlock)(),(0,s.createElementBlock)('button',{key:0,onClick:(0,s.withModifiers)(t=>(0,s.unref)(f)('relics',e.id),['stop','prevent']),class:'remove-btn'},' × ',8,Sn)):(0,s.createCommentVNode)('v-if',!0)],8,Dn))),128))])]),k[17]||(k[17]=(0,s.createTextVNode)(' 的遗迹。 ',-1)),(0,s.createElementVNode)('div',$n,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)((0,s.unref)(u).selections.relics,e=>((0,s.openBlock)(),(0,s.createElementBlock)('span',{key:e,class:'selected-item'},[(0,s.createTextVNode)((0,s.toDisplayString)(d('relics',e))+' ',1),(0,s.createElementVNode)('span',{class:'remove-item',onClick:t=>y(e,'relics')},'×',8,qn)]))),128))]),(0,s.createElementVNode)('div',Pn,[(0,s.withDirectives)((0,s.createElementVNode)('input',{type:'text',placeholder:'自定义名称...','onUpdate:modelValue':k[6]||(k[6]=e=>c.value.name=e)},null,512),[[s.vModelText,c.value.name]]),(0,s.withDirectives)((0,s.createElementVNode)('textarea',{placeholder:'自定义详情...','onUpdate:modelValue':k[7]||(k[7]=e=>c.value.desc=e)},null,512),[[s.vModelText,c.value.desc]]),(0,s.createElementVNode)('button',{type:'button',onClick:r},'添加')])])])],64))}},On='reincarnation_temporary_plans';function Mn(){try{localStorage.removeItem(On)}catch(e){console.error('清除临时方案失败:',e)}}function Ln(e){if(!e||'string'!=typeof e)return null;const t='<开局>',n='<世界演化>',o=e.indexOf(t);if(-1===o)return null;const s=e.indexOf('</开局>',o);if(-1===s)return null;const c=e.substring(o+4,s),a=c.indexOf(n);if(-1===a)return i().warning('天衍的灵感似乎有些混乱，我无法完全理解她的构想。'),null;const l=c.indexOf('</世界演化>',a);if(-1===l)return i().warning('天衍的灵感似乎有些混乱，构想未能完整。'),null;const r=c.substring(a+6,l).match(/(\[[\s\S]*\])/);if(!r||!r[0])return i().warning('天衍的构想中未能找到有效的方案数组。'),null;const d=r[0],m=function(e){try{return JSON.parse(e)}catch(e){return console.warn('天衍的构想过于奔放，初次解析失败:',e),null}}(d);return m&&Array.isArray(m)?m:(console.error('解析世界演化方案JSON失败:',d),i().error('天衍的构想过于复杂，最终解析失败。'),null)}const An={class:'option-plan-container'},Fn={class:'plan-list'},jn={class:'plan-title'},Un={class:'plan-description'},Jn={class:'option-list'},Wn={class:'button-group'},Hn=['onClick'],Gn=(0,s.defineComponent)({__name:'OptionPlanDisplay',props:{plans:{}},emits:['select','show-details'],setup(e,{emit:t}){const n=t;return(t,o)=>((0,s.openBlock)(),(0,s.createElementBlock)('div',An,[o[1]||(o[1]=(0,s.createElementVNode)('h2',{class:'title'},'世界演化方案',-1)),o[2]||(o[2]=(0,s.createElementVNode)('p',{class:'description'},'AI已根据您的构想，推演出以下开局方案。请选择其一，开启您的轮回之旅。',-1)),(0,s.createElementVNode)('div',Fn,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(e.plans,e=>((0,s.openBlock)(),(0,s.createElementBlock)('div',{key:e.planId,class:'plan-card'},[(0,s.createElementVNode)('h3',jn,(0,s.toDisplayString)(e.title),1),(0,s.createElementVNode)('p',Un,(0,s.toDisplayString)(e.description),1),(0,s.createElementVNode)('ul',Jn,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(e.options,e=>((0,s.openBlock)(),(0,s.createElementBlock)('li',{key:e.optionId,class:'option-item'},(0,s.toDisplayString)(e.text),1))),128))]),(0,s.createElementVNode)('div',Wn,[(0,s.createElementVNode)('button',{onClick:o[0]||(o[0]=e=>t.$emit('show-details')),class:'details-button'},'查阅新选项'),(0,s.createElementVNode)('button',{onClick:t=>(e=>{n('select',e)})(e),class:'select-button'},'选择此方案',8,Hn)])]))),128))])]))}}),zn=(0,U.A)(Gn,[['__scopeId','data-v-e77289b4']]),Rn={class:'world-vision-container'},Xn=['disabled'],Yn=(0,s.defineComponent)({__name:'WorldVisionInput',emits:['submit'],setup(e,{emit:t}){const n=(0,s.ref)(u.worldVisionInput||''),o=(0,s.ref)(!1),c=t,i=()=>{''!==n.value.trim()?(o.value=!0,c('submit',n.value)):alert('请输入您的世界构想！')};return(e,t)=>((0,s.openBlock)(),(0,s.createElementBlock)('div',Rn,[t[1]||(t[1]=(0,s.createElementVNode)('h2',{class:'title'},'世界构想',-1)),t[2]||(t[2]=(0,s.createElementVNode)('p',{class:'description'},' 请在此输入您对本次轮回世界的初步构想与期望，AI将根据您的描述，为您量身推演出数个独特的开局演化方案。 ',-1)),(0,s.withDirectives)((0,s.createElementVNode)('textarea',{'onUpdate:modelValue':t[0]||(t[0]=e=>n.value=e),class:'vision-textarea',placeholder:'例如：我希望这是一个末日废土风格的世界，科技与神秘并存，人类在废墟之上建立了新的秩序...'},null,512),[[s.vModelText,n.value]]),(0,s.createElementVNode)('button',{onClick:i,class:'submit-button',disabled:o.value},(0,s.toDisplayString)(o.value?'生成中...':'生成演化方案'),9,Xn)]))}}),Kn=(0,U.A)(Yn,[['__scopeId','data-v-b28a10f2']]),Qn={class:'world-vision-page'},Zn={key:1,class:'custom-items-display'},eo=['onBlur'],to=['onBlur'],no=(0,s.defineComponent)({__name:'WorldVisionPage',setup(e){const t=(0,s.reactive)({showCustomItems:!1}),n=(0,s.ref)({}),o=(e,t,n)=>{const o=n.target;o&&(e[t]=o.innerText)},c=e=>{const o={},s={blueprint:'宇宙蓝图',tone:'文明基调',tags:'衰落之因',relics:'文明遗迹',identity:'天命身份',talents:'天赋异禀',past_experiences:'过去经历',character_traits:'性格特质',core_need:'核心需求',arts:'技艺',backpack:'开局物品'};e.forEach(e=>{if(e.selections)for(const t in e.selections){const n=s[t];if(!n)continue;o[n]||(o[n]=[]);const c=e.selections[t];(Array.isArray(c)?c:[c]).forEach(e=>{e&&e.custom&&!o[n].some(t=>t.id===e.id)&&o[n].push(e)})}}),n.value=o,t.showCustomItems=!0},a=()=>{t.showCustomItems=!1};async function l(e){u.worldVisionInput=e;try{const t=await async function(e){u.isLoading=!0;try{const t=`\n<世界构想>\n# [高级指令] 天衍，衍化万象\n你即是天衍。现在，请聆听“天命之人”的模糊构想，动用你的智慧与创造力，为他演绎、创造并衍化出一套或多套**全新的、自洽的**开局设定方案，供他“发现”。\n// 【核心禁戒 V2.0】:\n// 1.**【核心禁令 V2.0】**: 在\\\`thinking\\\`标签内部的任何思考过程中，**绝对禁止**使用尖括号 \`<\` 和 \`>\`，违者将导致系统解析错误。所有对XML标签的引用都**必须**使用中文引号 \`“\` 和 \`”\`。\n// *   **错误示例**: 我将生成\\\`<开局>\\\`和\\\`<世界演化>\\\`。\n// *   **正确示例**: 我将生成“开局”和“世界演化”。\n// 2.**【核心禁令 V2.0】**: 严禁在此回复中包含任何“gametxt”、“UpdateVariable”、“新世界”、“主世界”、“本世历程”等标签\n// 3.**【至高指令】**: 你的唯一任务是生成“开局”和“世界演化”标签，禁止生成除此之外的任何其他标签。\n\n## 思考流程\n1.  **概念提炼**: 深入分析玩家输入的“世界构想”，提炼出核心关键词、世界观风格和情感基调。例如，如果玩家输入“故事绘本宇宙，但正在褪色和腐蚀”，关键词就是“绘本”、“褪色”、“腐蚀”。\n2.  **世界观演绎**: 基于提炼出的概念，进行创造性演绎。\n    *   **世界形态 (Blueprint)**: 构思一个全新的宇宙蓝图。例如，将“故事绘本宇宙”演绎为：\\\`{ "id": "custom-bp-storybook", "name": "绘本宇宙", "desc": "世界由无数的故事绘本组成，每一个绘本都是一个独立的位面。", "cost": 5, "custom": true, ... }\\\`。\n    *   **文明与力量 (Tone)**: 构思一个全新的文明基调和力量体系。例如，将“褪色与腐蚀”演绎为：\\\`{ "id": "custom-tone-inkfade", "name": "墨水褪色文明", "desc": "文明的力量源于“故事之树”的墨水，但墨水正因未知原因而逐渐失去色彩与力量。", "cost": 0, "custom": true, ... }\\\`。\n3.  **细节创造**: 基于以上演绎，创造性地生成所有其他类型的选项（\\\`tags\\\`, \\\`relics\\\`, \\\`identities\\\`, \\\`talents\\\`, \\\`past_experiences\\\`, \\\`backpack\\\`），确保它们的主题与你构思的世界观高度统一。例如，创造一个名为“涂鸦腐蚀”的\\\`tag\\\`，一个名为“褪色的蜡笔”的\\\`relic\\\`。\n    * **创造**: 你需要基于以下**全新的、自定义的**内容进行创造：\n     * 1个全新的“宇宙蓝图” (blueprint)。\n     * 1个全新的“文明基调” (tone)。\n     * 3个全新的、符合主题的“衰落之因” (tags)。\n     * 3个全新的、符合主题的“文明遗迹” (relics)。\n     * 3个全新的、符合主题的“天命身份” (identities)。\n     * 3个全新的、符合主题的“天赋异禀” (talents)。\n     * 3个全新的、符合主题的“过去经历” (past_experiences)。\n     * 3个全新的、符合主题的“技艺” (arts)，**【强制】每个技艺对象都必须包含一个\\\`skills\\\`数组，其中至少有一个技能对象**。\n     * 3个全新的、符合主题的“开局物品” (artifacts/consumables/materials)。**【至高强制】** 在创造物品对象时，必须包含一个名为 \\\`type\\\` 的字段，其值必须是字符串 \\\`"consumables"\\\`, \\\`"artifacts"\\\`, 或 \\\`"materials"\\\` 之一。像“武器”、“防具”这类更具体的分类，必须使用\\\`sub_type\\\`字段进行描述。\n4.  **方案组合**: 将你创造的所有新选项，组合成**1个**逻辑自洽、风格独特的“开局演化方案”。\n\n## 输出格式要求\n*   **【至高指令】**: 你必须将所有方案作为一个JSON数组，包裹在 \\\`世界演化\\\` 标签内。\n*   **【至高指令】**: 包含 \\\`世界演化\\\` 标签的所有内容，都必须被一个父标签 \\\`开局\\\` 包裹。\n*   **数据结构**: 每个方案对象必须包含 \\\`planId\\\`, \\\`title\\\`, \\\`description\\\` 和 \\\`selections\\\` 字段。\\\`selections\\\` 对象的结构必须是: \\\`{ "blueprint": {}, "tone": {}, "tags": [{}], "relics": [{}], "identity": {}, "talents": [{}], "past_experiences": [{}], "arts": [{"skills": [{}]}], "backpack": [{"type": "consumables"}] }\\\`。\n*   **【创造规范】**: **所有**你生成的选项，无论是\\\`blueprint\\\`还是\\\`tags\\\`数组中的一项，都必须是一个**完整的自定义对象**，包含一个全新的唯一 \\\`id\\\` (例如 \\\`custom-tag-123\\\`)、\\\`name\\\`, \\\`desc\\\`, \\\`cost\\\`，并必须包含 \\\`"custom": true\\\` 字段。\n\n## 天命之人的构想\n${e}\n\n4. **最终确认清单**:\n   * [ ] 我是否生成了1个方案？\n   * [ ] 我返回的所有内容是否都包裹在 \\\`开局\\\` 标签内？\n   * [ ] \\\`开局\\\` 标签内是否包含一个包裹着JSON数组的 \\\`世界演化\\\` 标签？\n   * [ ] \\\`开局\\\` 和 \\\`世界演化\\\` 标签是否闭合？\n   * [ ] JSON数组中的每个方案对象是否都包含了 \\\`planId\\\`, \\\`title\\\`, \\\`description\\\`, 和 \\\`selections\\\` 字段？\n   * [ ] 所有我新创造的自定义选项，是否都包含了 \\\`id\\\`, \\\`name\\\`, \\\`desc\\\`, \\\`cost\\\`, 和 \\\`"custom": true\\\` 字段？\n   * [ ] 我创造的每一个“技艺” (art) 对象，是否都包含了一个非空的 \\\`skills\\\` 数组？\n   * [ ] 是否没有生成任何\\\`gametxt\\\`等其他标签？\n</世界构想>\n    `.trim(),n=await TavernHelper.generate({injects:[{role:'user',content:t,position:'before_char',should_write_to_chat:!1,should_scan:!0}],should_stream:!1});if(!n)throw new Error('天衍似乎陷入了沉思，未能回应汝的呼唤。');return n}catch(e){return console.error('请求天衍生成世界演化方案的需求丢失了:',e),i().error(`衍化失败: ${e.message}`),null}finally{u.isLoading=!1}}(e);if(console.log('天衍原始回复:',t),t){const e=Ln(t);e&&e.length>0?(u.generatedPlans=e,function(e){try{const t=JSON.stringify(e);localStorage.setItem(On,t)}catch(e){console.error('保存临时方案失败:',e)}}(e),c(e)):i().warning('天衍未能给出有效的演化方案，她似乎对你的构想不太满意。')}}catch(e){console.error('handleSubmit中的未知错误:',e)}}const r=e=>{const t=prompt('请输入新方案的名称：',e.title||'AI生成方案');if(!t||!t.trim())return void i().info('已取消保存方案。');if(!e.selections)return void i().error('方案数据结构不完整，缺少 "selections" 字段。');const{selections:n}=e,o=JSON.parse(JSON.stringify(u.selections)),s=JSON.parse(JSON.stringify(u.potentialPoints));try{for(const e in n){const t=n[e];(Array.isArray(t)?t:[t]).forEach(t=>{if(t&&t.custom)if('backpack'===e){k(t.type||'consumables',t)}else{const n={blueprint:'blueprints',tone:'tones',identity:'identities',tags:'tags',relics:'relics',talents:'talents',past_experiences:'past_experiences',arts:'arts',character_traits:'character_traits',core_need:'core_needs'}[e]||e;n&&k(n,t)}})}u.selections.blueprint=n.blueprint?.id||'',u.selections.tone=n.tone?.id||'',u.selections.tags=n.tags?.map(e=>e.id)||[],u.selections.relics=n.relics?.map(e=>e.id)||[],u.selections.identity=n.identity?.id||'',u.selections.talents=n.talents?.map(e=>e.id)||[],u.selections.past_experiences=n.past_experiences?.map(e=>e.id)||[],u.selections.character_traits=n.character_traits?.map(e=>e.id)||[],u.selections.core_need=n.core_need?.id||'',u.selections.arts=n.arts?.map(e=>e.id)||[],u.selections.backpack={},n.backpack&&n.backpack.forEach(e=>{u.selections.backpack[e.id]=1}),Bt(t.trim())}catch(e){i().error('保存方案时出错，请检查控制台。'),console.error(e)}finally{Object.assign(u.selections,o),Object.assign(u.potentialPoints,s)}u.generatedPlans=[],Mn()},d=()=>{confirm('确定要放弃当前方案并重新构想吗？所有未保存的自定义选项将丢失。')&&(u.generatedPlans=[],Mn(),t.showCustomItems=!1)};return(0,s.onMounted)(()=>{const e=function(){try{const e=localStorage.getItem(On);return e?JSON.parse(e):null}catch(e){return console.error('加载临时方案失败:',e),null}}();e&&e.length>0&&(u.generatedPlans=e,c(e))}),(e,c)=>((0,s.openBlock)(),(0,s.createElementBlock)('div',Qn,[t.showCustomItems||0!==(0,s.unref)(u).generatedPlans.length?t.showCustomItems?((0,s.openBlock)(),(0,s.createElementBlock)('div',Zn,[c[2]||(c[2]=(0,s.createElementVNode)('h3',null,'天衍的新构想',-1)),((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(n.value,(e,t)=>((0,s.openBlock)(),(0,s.createElementBlock)('div',{key:t,class:'category-section'},[(0,s.createElementVNode)('h4',null,(0,s.toDisplayString)(t),1),(0,s.createElementVNode)('ul',null,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(e,e=>((0,s.openBlock)(),(0,s.createElementBlock)('li',{key:e.id},[(0,s.createElementVNode)('strong',{contenteditable:'true',onBlur:t=>o(e,'name',t)},(0,s.toDisplayString)(e.name),41,eo),c[1]||(c[1]=(0,s.createTextVNode)(': ',-1)),(0,s.createElementVNode)('span',{contenteditable:'true',onBlur:t=>o(e,'desc',t)},(0,s.toDisplayString)(e.desc),41,to)]))),128))])]))),128)),(0,s.createElementVNode)('button',{onClick:a},'返回方案选择')])):((0,s.openBlock)(),(0,s.createBlock)(zn,{key:2,plans:(0,s.unref)(u).generatedPlans,onSelect:r,onShowDetails:c[0]||(c[0]=e=>t.showCustomItems=!0)},null,8,['plans'])):((0,s.openBlock)(),(0,s.createBlock)(Kn,{key:0,onSubmit:l})),(0,s.unref)(u).generatedPlans.length>0?((0,s.openBlock)(),(0,s.createElementBlock)('button',{key:3,onClick:d,class:'reset-button'},'重新构想')):(0,s.createCommentVNode)('v-if',!0)]))}}),oo=(0,U.A)(no,[['__scopeId','data-v-10855ff8']]);function so(e,t,n,o){const s=e.indexOf(':');if(s>-1){const c=e.substring(0,s).trim(),i=e.substring(s+1).trim();if(''===i){const e={};t[c]=e,o.push({level:n,obj:e})}else if(i.startsWith('{')&&i.endsWith('}')){const e={};t[c]=e;const s=i.slice(1,-1).trim().split(',').map(e=>e.trim());for(const t of s)so(t,e,n+2,o)}else t[c]=co(i)}}function co(e){const t=e.trim();if(t.startsWith('"')&&t.endsWith('"')){const e=t.slice(1,-1);return e.startsWith('[')&&e.endsWith(']')?co(e):e}if(t.startsWith('[')&&t.endsWith(']'))try{const e=t.slice(1,-1).trim(),n=[];let o='',s=!1,c=0;for(let t=0;t<e.length;t++){const i=e[t];'\''!==i&&'"'!==i||(s=!s),s||('['===i&&c++,']'===i&&c--,','!==i||0!==c)?o+=i:(n.push(o.trim()),o='')}return o&&n.push(o.trim()),n.map(e=>co(e))}catch(e){}return'true'===t.toLowerCase()||'false'!==t.toLowerCase()&&('null'===t?null:''===t||isNaN(Number(t))||t.includes('x')?t:Number(t))}const io={key:0,class:'world-info-card'},ao={class:'card-section'},lo={class:'card-section'},ro={key:0,class:'card-section'},mo={key:0,class:'subsection'},uo={key:0},po={class:'tags-container'},ko={key:1},fo={key:2},yo={class:'level-list'},go=['onClick'],vo={key:0,class:'level-details'},Eo={key:0},ho={key:1},Vo={__name:'WorldInfoCard',props:{worldData:Object},setup(e){const t=(0,s.ref)({});return(n,o)=>e.worldData?((0,s.openBlock)(),(0,s.createElementBlock)('div',io,[(0,s.createElementVNode)('section',ao,[o[3]||(o[3]=(0,s.createElementVNode)('h3',{class:'section-title'},'基础信息',-1)),(0,s.createElementVNode)('p',null,[o[0]||(o[0]=(0,s.createElementVNode)('strong',null,'ID:',-1)),(0,s.createTextVNode)(' '+(0,s.toDisplayString)(e.worldData.基础信息?.ID),1)]),(0,s.createElementVNode)('p',null,[o[1]||(o[1]=(0,s.createElementVNode)('strong',null,'名称:',-1)),(0,s.createTextVNode)(' '+(0,s.toDisplayString)(e.worldData.基础信息?.名称),1)]),(0,s.createElementVNode)('p',null,[o[2]||(o[2]=(0,s.createElementVNode)('strong',null,'描述:',-1)),(0,s.createTextVNode)(' '+(0,s.toDisplayString)(e.worldData.基础信息?.描述),1)])]),(0,s.createElementVNode)('section',lo,[o[7]||(o[7]=(0,s.createElementVNode)('h3',{class:'section-title'},'元规则',-1)),(0,s.createElementVNode)('p',null,[o[4]||(o[4]=(0,s.createElementVNode)('strong',null,'宇宙蓝图:',-1)),(0,s.createTextVNode)(' '+(0,s.toDisplayString)(e.worldData.元规则?.宇宙蓝图),1)]),(0,s.createElementVNode)('p',null,[o[5]||(o[5]=(0,s.createElementVNode)('strong',null,'物理尺度:',-1)),(0,s.createTextVNode)(' '+(0,s.toDisplayString)(e.worldData.元规则?.物理尺度),1)]),(0,s.createElementVNode)('p',null,[o[6]||(o[6]=(0,s.createElementVNode)('strong',null,'支持纪元穿越:',-1)),(0,s.createTextVNode)(' '+(0,s.toDisplayString)(e.worldData.元规则?.支持纪元穿越),1)])]),e.worldData.历史纪元?((0,s.openBlock)(),(0,s.createElementBlock)('section',ro,[o[17]||(o[17]=(0,s.createElementVNode)('h3',{class:'section-title'},'历史纪元',-1)),((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(Object.values(e.worldData.历史纪元),e=>((0,s.openBlock)(),(0,s.createElementBlock)('div',{key:e.纪元ID,class:'epoch-details'},[(0,s.createElementVNode)('p',null,[o[8]||(o[8]=(0,s.createElementVNode)('strong',null,'纪元ID:',-1)),(0,s.createTextVNode)(' '+(0,s.toDisplayString)(e.纪元ID),1)]),(0,s.createElementVNode)('p',null,[o[9]||(o[9]=(0,s.createElementVNode)('strong',null,'纪元名称:',-1)),(0,s.createTextVNode)(' '+(0,s.toDisplayString)(e.纪元名称),1)]),e.力量体系?((0,s.openBlock)(),(0,s.createElementBlock)('div',mo,[o[16]||(o[16]=(0,s.createElementVNode)('h4',{class:'subsection-title'},'力量体系',-1)),(0,s.createElementVNode)('p',null,(0,s.toDisplayString)(e.力量体系.体系概述),1),e.力量体系.专长与流派?((0,s.openBlock)(),(0,s.createElementBlock)('div',uo,[o[10]||(o[10]=(0,s.createElementVNode)('h5',null,'专长与流派:',-1)),(0,s.createElementVNode)('ul',po,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(e.力量体系.专长与流派,e=>((0,s.openBlock)(),(0,s.createElementBlock)('li',{key:e.流派名称,class:'tag'},(0,s.toDisplayString)(e.流派名称),1))),128))])])):(0,s.createCommentVNode)('v-if',!0),e.力量体系.属性模板?((0,s.openBlock)(),(0,s.createElementBlock)('div',ko,[o[11]||(o[11]=(0,s.createElementVNode)('h5',null,'属性模板:',-1)),(0,s.createElementVNode)('ul',null,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(e.力量体系.属性模板,e=>((0,s.openBlock)(),(0,s.createElementBlock)('li',{key:e.属性},[(0,s.createElementVNode)('strong',null,(0,s.toDisplayString)(e.属性)+':',1),(0,s.createTextVNode)(' '+(0,s.toDisplayString)(e.描述),1)]))),128))])])):(0,s.createCommentVNode)('v-if',!0),e.力量体系.境界定义?((0,s.openBlock)(),(0,s.createElementBlock)('div',fo,[o[15]||(o[15]=(0,s.createElementVNode)('h5',null,'境界定义:',-1)),(0,s.createElementVNode)('ul',yo,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(Object.values(e.力量体系.境界定义).filter(e=>'object'==typeof e),e=>((0,s.openBlock)(),(0,s.createElementBlock)('li',{key:e.名称,class:'level-item'},[(0,s.createElementVNode)('div',{onClick:n=>(e=>{t.value[e.名称]=!t.value[e.名称]})(e),class:'level-header'},[(0,s.createElementVNode)('span',null,'能级 '+(0,s.toDisplayString)(e.能级)+': '+(0,s.toDisplayString)(e.名称),1),(0,s.createElementVNode)('span',null,(0,s.toDisplayString)(t.value[e.名称]?'[-]':'[+]'),1)],8,go),t.value[e.名称]?((0,s.openBlock)(),(0,s.createElementBlock)('div',vo,[(0,s.createElementVNode)('p',null,[o[12]||(o[12]=(0,s.createElementVNode)('strong',null,'描述:',-1)),(0,s.createTextVNode)(' '+(0,s.toDisplayString)(e.描述),1)]),e.解锁系统?((0,s.openBlock)(),(0,s.createElementBlock)('div',Eo,[(0,s.createElementVNode)('p',null,[o[13]||(o[13]=(0,s.createElementVNode)('strong',null,'解锁系统:',-1)),(0,s.createTextVNode)(' '+(0,s.toDisplayString)(e.解锁系统.名称)+' - '+(0,s.toDisplayString)(e.解锁系统.描述),1)])])):(0,s.createCommentVNode)('v-if',!0),e.晋升需求?((0,s.openBlock)(),(0,s.createElementBlock)('div',ho,[o[14]||(o[14]=(0,s.createElementVNode)('p',null,[(0,s.createElementVNode)('strong',null,'晋升需求:')],-1)),(0,s.createElementVNode)('ul',null,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(Object.values(e.晋升需求).filter(e=>'object'==typeof e),(e,t)=>((0,s.openBlock)(),(0,s.createElementBlock)('li',{key:t},(0,s.toDisplayString)(e.条件.描述),1))),128))])])):(0,s.createCommentVNode)('v-if',!0)])):(0,s.createCommentVNode)('v-if',!0)]))),128))])])):(0,s.createCommentVNode)('v-if',!0)])):(0,s.createCommentVNode)('v-if',!0)]))),128))])):(0,s.createCommentVNode)('v-if',!0)])):(0,s.createCommentVNode)('v-if',!0)}},No=(0,U.A)(Vo,[['__scopeId','data-v-412c2550']]),xo={class:'world-confirmation-page'},bo={class:'world-details-container'},_o={key:1,class:'loading-state'},Bo={__name:'WorldConfirmationPage',setup(e){const t=(0,s.ref)(null),n=(0,s.ref)('正在加载世界数据...');return(0,s.onMounted)(async()=>{try{const e=await E('主世界',!0);if(e){const o=function(e){if(!e)return console.warn('[WorldMapParser] Received empty or null lore content.'),null;const t=e.indexOf('自动化规则:');if(-1===t)return console.error('[WorldMapParser] "自动化规则:" block not found in the lorebook entry.'),null;const n=e.substring(t).split('\n').slice(1),o={},s=[{level:-1,obj:o}];for(const e of n){if(''===e.trim())continue;const t=e.match(/^\s*/),n=t?t[0].length:0,o=e.trim();for(;s.length>1&&n<=s[s.length-1].level;)s.pop();let c=s[s.length-1].obj;if(o.startsWith('- ')){const e=o.substring(2).trim();if(!Array.isArray(c)){const e=s[s.length-2].obj,t=Object.keys(e).pop();if(!t||e[t]!==c)continue;c=[],e[t]=c,s[s.length-1].obj=c}if(-1===e.indexOf(':'))c.push(co(e));else{const t={};c.push(t),s.push({level:n,obj:t}),so(e,t,n,s)}}else so(o,c,n,s)}return o}(e);o?t.value=o:n.value='解析世界数据失败，格式可能不正确。'}else n.value='未能加载主世界数据，可能是世界书条目不存在。请返回上一步重试。'}catch(e){console.error('加载并解析世界数据时出错:',e),n.value='解析世界数据时发生错误，请检查控制台获取详细信息。'}}),(e,o)=>((0,s.openBlock)(),(0,s.createElementBlock)('div',xo,[o[0]||(o[0]=(0,s.createElementVNode)('h1',{class:'main-title'},'世界已构筑',-1)),o[1]||(o[1]=(0,s.createElementVNode)('h2',{class:'subtitle'},'请确认最终的世界设定，然后开启你的轮回之旅。',-1)),(0,s.createElementVNode)('div',bo,[t.value?((0,s.openBlock)(),(0,s.createBlock)(No,{key:0,'world-data':t.value},null,8,['world-data'])):((0,s.openBlock)(),(0,s.createElementBlock)('div',_o,[(0,s.createElementVNode)('p',null,(0,s.toDisplayString)(n.value),1)]))])]))}},wo=(0,U.A)(Bo,[['__scopeId','data-v-7c6cf475']]),To={id:'app-container',class:'container'},Co={key:0,id:'points-tracker'},Do={class:'difficulty-selector'},So=['value'],$o={class:'points-display'},qo={key:1,class:'schematic-box'},Po={key:2,class:'scrollable-content'},Io={class:'scrollable-content'},Oo={class:'nav-buttons'},Mo={__name:'app',setup(e){const t=(0,s.ref)(!1),n=(0,s.ref)(!1),c=()=>{document.fullscreenElement?document.exitFullscreen&&(document.exitFullscreen(),n.value=!1):(document.documentElement.requestFullscreen(),n.value=!0)};document.addEventListener('fullscreenchange',()=>{n.value=!!document.fullscreenElement});const i=[Je,oo,In,Fe,Nt,sn,wo],a=(0,s.computed)(()=>i[u.currentPage-1]);return(e,i)=>((0,s.openBlock)(),(0,s.createElementBlock)('div',To,[(0,s.unref)(u).isGenerating?((0,s.openBlock)(),(0,s.createBlock)(gt,{key:0})):((0,s.openBlock)(),(0,s.createElementBlock)(s.Fragment,{key:1},[(0,s.unref)(u).currentPage>1?((0,s.openBlock)(),(0,s.createElementBlock)('div',Co,[(0,s.createElementVNode)('div',Do,[i[9]||(i[9]=(0,s.createElementVNode)('span',null,'难度: ',-1)),(0,s.withDirectives)((0,s.createElementVNode)('select',{'onUpdate:modelValue':i[0]||(i[0]=e=>(0,s.unref)(u).difficulty=e)},[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)((0,s.unref)(m).difficulties,e=>((0,s.openBlock)(),(0,s.createElementBlock)('option',{key:e.id,value:e.id},(0,s.toDisplayString)(e.name),9,So))),128))],512),[[s.vModelSelect,(0,s.unref)(u).difficulty]])]),(0,s.createElementVNode)('div',$o,'创世点数: '+(0,s.toDisplayString)((0,s.unref)(u).remainingPoints),1)])):(0,s.createCommentVNode)('v-if',!0),(0,s.createElementVNode)('button',{type:'button',class:'fullscreen-btn',onClick:c},(0,s.toDisplayString)(n.value?'退出全屏':'全屏'),1),(0,s.unref)(u).currentPage>1?((0,s.openBlock)(),(0,s.createElementBlock)('div',qo,[(0,s.createVNode)(mt)])):(0,s.createCommentVNode)('v-if',!0),2===(0,s.unref)(u).currentPage?((0,s.openBlock)(),(0,s.createElementBlock)('div',Po,[((0,s.openBlock)(),(0,s.createBlock)((0,s.resolveDynamicComponent)(a.value)))])):((0,s.openBlock)(),(0,s.createElementBlock)('form',{key:3,id:'startup-form',onSubmit:i[1]||(i[1]=(0,s.withModifiers)((...e)=>o.generatePrompt&&o.generatePrompt(...e),['prevent']))},[(0,s.createElementVNode)('div',Io,[((0,s.openBlock)(),(0,s.createBlock)((0,s.resolveDynamicComponent)(a.value)))])],32)),(0,s.createElementVNode)('div',Oo,[(0,s.unref)(u).currentPage>1?((0,s.openBlock)(),(0,s.createElementBlock)('button',{key:0,type:'button',class:'nav-btn prev',onClick:i[2]||(i[2]=e=>(0,s.unref)(p)(-1))},' ← 上一章 ')):(0,s.createCommentVNode)('v-if',!0),1===(0,s.unref)(u).currentPage?((0,s.openBlock)(),(0,s.createElementBlock)('button',{key:1,type:'button',id:'reset-world-btn',onClick:i[3]||(i[3]=(...e)=>B&&B(...e))},' 重置世界 ')):(0,s.createCommentVNode)('v-if',!0),(0,s.createElementVNode)('button',{type:'button',class:'nav-btn',onClick:i[4]||(i[4]=e=>t.value=!0)},'管理方案'),i[10]||(i[10]=(0,s.createElementVNode)('div',{style:{'flex-grow':'1'}},null,-1)),(0,s.unref)(u).currentPage>1&&(0,s.unref)(u).currentPage<7?((0,s.openBlock)(),(0,s.createElementBlock)('button',{key:2,type:'button',class:'nav-btn next',onClick:i[5]||(i[5]=e=>(0,s.unref)(p)(1))},' 下一章 → ')):(0,s.createCommentVNode)('v-if',!0),6===(0,s.unref)(u).currentPage?((0,s.openBlock)(),(0,s.createElementBlock)('button',{key:3,type:'button',onClick:i[6]||(i[6]=(...e)=>x&&x(...e)),class:'submit-btn'},' 构筑世界 ')):(0,s.createCommentVNode)('v-if',!0),7===(0,s.unref)(u).currentPage?((0,s.openBlock)(),(0,s.createElementBlock)('button',{key:4,type:'button',onClick:i[7]||(i[7]=(...e)=>b&&b(...e)),class:'submit-btn'},' 开启轮回 ')):(0,s.createCommentVNode)('v-if',!0)])],64)),(0,s.createVNode)(Lt,{show:t.value,onClose:i[8]||(i[8]=e=>t.value=!1)},null,8,['show'])]))}};if('undefined'==typeof TavernHelper)document.body.innerHTML='<h1 style="color: red; text-align: center;">错误：此页面必须在 SillyTavern 扩展环境中运行。</h1>';else{async function Lo(){try{await TavernHelper.getChatMessages('0'),console.log('Startup: Initial data loaded.'),(0,s.createApp)(Mo).mount('#app-container')}catch(e){console.error('Failed to initialize app:',e),document.body.innerHTML='<h1 style="color: red; text-align: center;">错误：无法加载初始数据，请检查控制台。</h1>'}}Lo()}
//# sourceMappingURL=index.js.map</script><style>.backpack-manager[data-v-4da48a4c]{margin-top:2rem;border-top:1px solid rgba(212,175,55,0.2);padding-top:2rem}.item-category[data-v-4da48a4c]{margin-bottom:2rem}.item-category h4[data-v-4da48a4c]{color:var(--color-cyan-tian);margin-bottom:1rem}.item-selection[data-v-4da48a4c]{margin-bottom:1rem}.item-controls[data-v-4da48a4c]{display:flex;align-items:center;margin-left:auto}.item-controls button[data-v-4da48a4c]{width:25px;height:25px;background-color:var(--color-black-void);color:var(--color-gold-liu);border:1px solid var(--color-gold-liu);border-radius:50%;cursor:pointer;margin-left:0.5rem;transition:all 0.2s}.item-controls button[data-v-4da48a4c]:hover{background-color:var(--color-gold-liu);color:var(--color-black-void)}.item-controls .remove-btn[data-v-4da48a4c]{color:var(--color-red-chi);border-color:var(--color-red-chi)}.item-controls .remove-btn[data-v-4da48a4c]:hover{background-color:var(--color-red-chi);color:var(--color-black-void)}.custom-input-group select[data-v-4da48a4c]{background:rgba(10,15,30,0.7);border:1px solid rgba(212,175,55,0.3);border-radius:4px;color:var(--color-white-moon);padding:0.5rem 1rem;font-family:var(--font-family-main);font-size:0.9rem;margin-bottom:0.5rem}.category-header[data-v-4da48a4c]{padding:0.5rem 1.5rem;font-weight:bold;color:var(--color-cyan-tian);font-size:0.8rem;text-transform:uppercase;letter-spacing:1px;pointer-events:none}.option-item[data-v-4da48a4c]{padding:0.5rem 1.5rem 0.5rem 2.5rem;cursor:pointer;color:var(--color-white-moon);font-size:0.9rem;white-space:nowrap}.option-item[data-v-4da48a4c]:hover{background-color:rgba(212,175,55,0.2);color:var(--color-gold-pale)}.option-item[data-v-4da48a4c]{display:flex;justify-content:space-between;align-items:center}.delete-custom-item[data-v-4da48a4c]{background:none;border:none;color:var(--color-red-chi);font-size:1.2rem;cursor:pointer;padding:0 0.5rem}

.custom-skills-creator[data-v-2807ca9a]{display:flex;flex-direction:column;gap:8px;margin-top:8px;padding-left:16px;border-left:2px solid hsla(0,0%,100%,.1)}.custom-skill-item[data-v-2807ca9a]{display:flex;align-items:center;justify-content:space-between;background-color:rgba(0,0,0,.2);padding:4px 8px;border-radius:4px}.custom-input-group[data-v-2807ca9a]{align-items:flex-start}.custom-input-group[data-v-2807ca9a]{display:grid;grid-template-columns:1fr 1fr;grid-template-rows:auto auto auto;gap:8px 16px;align-items:end;grid-template-areas:"artName skillName" "artDesc skillDesc" "artSkills skillButton" "addArtButton addArtButton"}.custom-input-group>input[placeholder*=技艺名称][data-v-2807ca9a]{grid-area:artName}.custom-input-group>textarea[placeholder*=技艺详情][data-v-2807ca9a]{grid-area:artDesc}.custom-input-group>.custom-skills-creator[data-v-2807ca9a]{grid-area:artSkills}.custom-input-group>button[type=button][data-v-2807ca9a]{grid-area:addArtButton}.skill-input-row[data-v-2807ca9a]{display:grid;grid-template-columns:1fr;grid-template-rows:auto auto auto;gap:8px;grid-template-areas:"skillNameInput" "skillDescInput" "skillAddButton"}.skill-input-row input[data-v-2807ca9a]{grid-area:skillNameInput}.skill-input-row textarea[data-v-2807ca9a]{grid-area:skillDescInput}.skill-input-row button[data-v-2807ca9a]{grid-area:skillAddButton}.selected-item-detailed[data-v-2807ca9a]{background-color:rgba(0,0,0,.2);border:1px solid hsla(0,0%,100%,.1);border-radius:4px;padding:8px 12px;margin-top:8px}.item-header[data-v-2807ca9a]{display:flex;justify-content:space-between;align-items:center;font-weight:bold}.item-desc[data-v-2807ca9a]{font-size:.9em;color:#a0998f;margin-top:4px;white-space:pre-wrap}.item-skills[data-v-2807ca9a]{margin-top:8px;padding-top:8px;border-top:1px solid hsla(0,0%,100%,.1);font-size:.85em}.item-skills strong[data-v-2807ca9a]{color:#c8aa7a}.item-skills ul[data-v-2807ca9a]{list-style-type:none;padding-left:10px;margin-top:4px}
.cover-page-container[data-v-57060730]{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;height:100%;animation:fadeIn-57060730 1.5s ease-in-out}.main-title[data-v-57060730]{font-family:var(--font-family-title);font-size:4.5rem;color:var(--color-gold-pale);text-shadow:0 0 15px rgba(212,175,55,0.6);margin-bottom:0.5rem}.subtitle[data-v-57060730]{font-family:var(--font-family-main);font-size:1.8rem;color:var(--color-cyan-tian);letter-spacing:4px;margin-top:0;margin-bottom:4rem}.description[data-v-57060730]{font-size:1.2rem;max-width:600px;line-height:2.2;color:var(--color-white-moon);margin-bottom:5rem}.start-btn[data-v-57060730]{padding:1rem 2.5rem;font-family:var(--font-family-title);font-size:1.5rem;color:var(--color-black-void);background-color:var(--color-gold-liu);border:none;border-radius:8px;cursor:pointer;transition:all 0.3s ease;box-shadow:0 0 20px rgba(212,175,55,0.7)}.start-btn[data-v-57060730]:hover{transform:translateY(-3px);box-shadow:0 5px 25px rgba(212,175,55,0.9)}@keyframes fadeIn-57060730{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}

.schematic-display[data-v-0e7db4dc]{width:100%;height:100%;display:flex;justify-content:center;align-items:center;padding:2rem;box-sizing:border-box}svg[data-v-0e7db4dc]{width:100%;max-width:300px;animation:slow-rotate-0e7db4dc 60s linear infinite}@keyframes slow-rotate-0e7db4dc{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}g[data-v-0e7db4dc]{animation:fadeIn 0.8s ease-in-out}

.generation-progress-container[data-v-e6ac8c02]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%}.schematic-box[data-v-e6ac8c02]{width:300px;height:300px;margin-bottom:2rem}.progress-bar-container[data-v-e6ac8c02]{width:80%;max-width:500px;height:20px;background-color:var(--color-indigo-deep);border:1px solid var(--color-gold-liu);border-radius:10px;overflow:hidden}.progress-bar[data-v-e6ac8c02]{height:100%;background-color:var(--color-gold-liu);transition:width 0.5s ease-out}.progress-text[data-v-e6ac8c02]{margin-top:1rem;font-size:1.2rem;color:var(--color-gold-pale)}

.modal-overlay[data-v-0bd2db2a]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.7);display:flex;justify-content:center;align-items:center;z-index:1000}.modal-content[data-v-0bd2db2a]{background:var(--color-indigo-deep);padding:2rem 3rem;border-radius:12px;border:1px solid rgba(212,175,55,0.3);width:90vw;max-width:600px;display:flex;flex-direction:column;gap:1.5rem}h3[data-v-0bd2db2a]{font-family:var(--font-family-title);text-align:center;color:var(--color-gold-pale);font-size:1.8rem;margin:0 0 1rem}.preset-list[data-v-0bd2db2a]{max-height:300px;overflow-y:auto;border:1px solid rgba(212,175,55,0.2);border-radius:8px;padding:1rem;background:var(--color-black-void)}.preset-item[data-v-0bd2db2a]{display:flex;justify-content:space-between;align-items:center;padding:0.8rem 0;border-bottom:1px solid rgba(212,175,55,0.1)}.preset-item[data-v-0bd2db2a]:last-child{border-bottom:none}.preset-name[data-v-0bd2db2a]{font-weight:bold;color:var(--color-white-moon)}.preset-actions button[data-v-0bd2db2a]{margin-left:0.5rem;padding:0.3rem 0.8rem;font-size:0.9rem;background:var(--color-cyan-tian);color:var(--color-black-void);border:none;border-radius:4px;cursor:pointer}.preset-actions button.delete[data-v-0bd2db2a]{background:var(--color-red-chi)}.no-presets[data-v-0bd2db2a]{text-align:center;color:var(--color-grey-stone);padding:2rem 0}.save-section[data-v-0bd2db2a],.import-section[data-v-0bd2db2a]{display:flex;gap:1rem}.save-section input[data-v-0bd2db2a]{flex-grow:1;background:var(--color-black-void);border:1px solid var(--color-gold-liu);color:var(--color-white-moon);padding:0.5rem 1rem;border-radius:4px}.save-section button[data-v-0bd2db2a],.import-section button[data-v-0bd2db2a]{padding:0.5rem 1.5rem;background:var(--color-gold-liu);color:var(--color-black-void);border:none;border-radius:4px;cursor:pointer;font-weight:bold}.close-btn[data-v-0bd2db2a]{margin-top:1rem;padding:0.8rem;background:transparent;border:1px solid var(--color-grey-stone);color:var(--color-grey-stone);border-radius:4px;cursor:pointer}.close-btn[data-v-0bd2db2a]:hover{background:rgba(160,160,160,0.1);color:var(--color-white-moon)}

.option-plan-container[data-v-e77289b4]{display:flex;flex-direction:column;align-items:center;padding:2rem;width:90%;max-width:1200px;margin:auto}.title[data-v-e77289b4]{font-size:2rem;color:#e0dcd1;margin-bottom:1rem}.description[data-v-e77289b4]{font-size:1rem;color:#a0998f;margin-bottom:2rem;text-align:center}.plan-list[data-v-e77289b4]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:2rem;width:100%}.plan-card[data-v-e77289b4]{background-color:rgba(0,0,0,.6);border:1px solid #5a5245;border-radius:8px;padding:1.5rem;display:flex;flex-direction:column}.plan-title[data-v-e77289b4]{font-size:1.5rem;color:#c9aa71;margin-bottom:1rem}.plan-description[data-v-e77289b4]{color:#a0998f;margin-bottom:1.5rem;flex-grow:1}.option-list[data-v-e77289b4]{list-style-type:none;padding:0;margin-bottom:2rem}.option-item[data-v-e77289b4]{color:#e0dcd1;margin-bottom:.5rem;padding-left:1rem;position:relative}.option-item[data-v-e77289b4]::before{content:"◈";color:#c9aa71;position:absolute;left:0}.button-group[data-v-e77289b4]{display:flex;gap:1rem;margin-top:auto}.details-button[data-v-e77289b4],.select-button[data-v-e77289b4]{padding:.8rem 1.5rem;font-size:1rem;border-radius:4px;cursor:pointer;transition:all .3s ease;width:100%;text-align:center}.select-button[data-v-e77289b4]{color:#e0dcd1;background-color:#5a5245;border:1px solid #8b7355}.select-button[data-v-e77289b4]:hover{background-color:#6b6255}.details-button[data-v-e77289b4]{color:#c9aa71;background-color:rgba(0,0,0,0);border:1px solid #5a5245}.details-button[data-v-e77289b4]:hover{background-color:rgba(90,82,69,.5)}
.world-vision-container[data-v-b28a10f2]{display:flex;flex-direction:column;align-items:center;padding:2rem;background-color:rgba(0,0,0,.5);border-radius:8px;width:80%;max-width:800px;margin:auto}.title[data-v-b28a10f2]{font-size:2rem;color:#e0dcd1;margin-bottom:1rem}.description[data-v-b28a10f2]{font-size:1rem;color:#a0998f;margin-bottom:2rem;text-align:center;line-height:1.6}.vision-textarea[data-v-b28a10f2]{width:100%;height:200px;background-color:rgba(0,0,0,.7);border:1px solid #5a5245;border-radius:4px;color:#e0dcd1;font-size:1rem;padding:1rem;resize:vertical;margin-bottom:2rem}.vision-textarea[data-v-b28a10f2]::placeholder{color:#7a7265}.submit-button[data-v-b28a10f2]{padding:.8rem 2rem;font-size:1.2rem;color:#e0dcd1;background-color:#5a5245;border:1px solid #8b7355;border-radius:4px;cursor:pointer;transition:background-color .3s ease}.submit-button[data-v-b28a10f2]:hover{background-color:#6b6255}.submit-button[data-v-b28a10f2]:disabled{background-color:#3a3225;cursor:not-allowed}
.world-vision-page[data-v-10855ff8]{position:relative;width:100%;height:100%;display:flex;justify-content:center;align-items:center}.custom-items-display[data-v-10855ff8]{background:rgba(10,20,40,.85);border:1px solid rgba(180,160,120,.4);backdrop-filter:blur(8px);padding:2rem;border-radius:12px;color:#e0e0e0;max-height:85%;width:70%;overflow-y:auto;box-shadow:0 8px 30px rgba(0,0,0,.5)}.custom-items-display h3[data-v-10855ff8]{color:#f5e8c8;text-align:center;font-size:1.8rem;margin-bottom:1.5rem}.custom-items-display h4[data-v-10855ff8]{color:#d0b888;font-size:1.2rem;margin-top:1.5rem;margin-bottom:.8rem;border-bottom:1px solid rgba(180,160,120,.2);padding-bottom:.5rem}.custom-items-display ul[data-v-10855ff8]{list-style:none;padding-left:0}.custom-items-display li[data-v-10855ff8]{margin-bottom:.7rem;line-height:1.6}.custom-items-display li strong[data-v-10855ff8]{color:#c8aa7a;cursor:pointer}.custom-items-display li span[data-v-10855ff8]{cursor:pointer}.custom-items-display button[data-v-10855ff8]{display:block;margin:2rem auto 0;padding:.8rem 2rem;background:rgba(180,160,120,.2);color:#f5e8c8;border:1px solid rgba(180,160,120,.5);border-radius:6px;cursor:pointer;transition:all .3s ease}.custom-items-display button[data-v-10855ff8]:hover{background:rgba(180,160,120,.4);box-shadow:0 0 15px rgba(245,232,200,.3)}.category-section[data-v-10855ff8]{margin-bottom:1rem}.reset-button[data-v-10855ff8]{position:absolute;bottom:2rem;left:3rem;padding:.8rem 1.5rem;background:rgba(0,0,0,0);color:#a0998f;border:1px solid #5a5245;border-radius:6px;cursor:pointer;transition:all .3s ease}.reset-button[data-v-10855ff8]:hover{background:rgba(199,67,67,.1);color:#e0dcd1;border-color:#c74343}
.world-info-card[data-v-412c2550]{padding:1rem;text-align:left}.card-section[data-v-412c2550]{margin-bottom:1.5rem}.section-title[data-v-412c2550]{color:#b8860b;font-size:1.2rem;margin-bottom:1rem;border-bottom:1px solid rgba(184,134,11,0.3);padding-bottom:0.5rem}p[data-v-412c2550]{margin:0.5rem 0;line-height:1.6}strong[data-v-412c2550]{color:#c8aa7a}.epoch-details[data-v-412c2550]{margin-top:1rem;padding-top:1rem;border-top:1px solid rgba(255,255,255,0.1)}.subsection-title[data-v-412c2550]{color:#b8860b;font-size:1.1rem;margin-top:1rem;margin-bottom:0.5rem}.tags-container[data-v-412c2550]{display:flex;flex-wrap:wrap;gap:8px;list-style:none;padding:0}.tag[data-v-412c2550]{background-color:rgba(17,233,225,0.2);color:#82d8d8;padding:4px 8px;border-radius:4px;font-size:0.8em}ul[data-v-412c2550]{padding-left:20px}.level-list[data-v-412c2550]{list-style:none;padding-left:0}.level-item[data-v-412c2550]{background-color:rgba(255,255,255,0.05);border-radius:4px;margin-bottom:0.5rem}.level-header[data-v-412c2550]{padding:0.5rem 1rem;cursor:pointer;display:flex;justify-content:space-between;font-weight:bold}.level-details[data-v-412c2550]{padding:0 1rem 0.5rem;border-top:1px solid rgba(255,255,255,0.1)}

.world-confirmation-page[data-v-7c6cf475]{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;height:100%;padding:2rem;box-sizing:border-box}.main-title[data-v-7c6cf475]{font-family:var(--font-family-title);font-size:2.5rem;color:var(--color-gold-pale);margin-bottom:.5rem}.subtitle[data-v-7c6cf475]{font-family:var(--font-family-main);font-size:1.2rem;color:var(--color-cyan-tian);margin-bottom:2rem}.world-details-container[data-v-7c6cf475]{width:100%;height:60vh;max-width:800px;background-color:rgba(0,0,0,.3);border:1px solid hsla(0,0%,100%,.2);border-radius:8px;overflow:auto;padding:1rem}.loading-state[data-v-7c6cf475]{display:flex;justify-content:center;align-items:center;height:100%;font-family:"Noto Serif SC",serif;color:#f0e6d2}
:root{--color-black-void:#0a0f1e;--color-indigo-deep:#16212c;--color-gold-liu:#d4af37;--color-cyan-tian:#3a8f9d;--color-white-moon:#e0e0e0;--color-gold-pale:#f0e6d2;--color-grey-stone:#a0a0a0;--color-red-chi:#c74343;--font-family-main:'Noto Serif SC',serif;--font-family-title:'ZCOOL KuaiLe',cursive}body{font-family:var(--font-family-main);background-color:var(--color-black-void);color:var(--color-white-moon);line-height:1.8;margin:0;display:flex;justify-content:center;align-items:center;min-height:100vh;font-size:16px}.container{position:relative;width:90vw;max-width:800px;height:185vh;max-height:800px;margin:2rem auto;padding:2rem 3rem;background:var(--color-indigo-deep);border-radius:12px;border:1px solid rgba(212,175,55,.2);box-shadow:0 8px 35px rgba(0,0,0,.5);display:flex;flex-direction:column}#startup-form{height:100%;display:flex;flex-direction:column;overflow:hidden;position:relative;z-index:1}.schematic-box{position:absolute;top:5rem;right:3rem;width:300px;height:300px;z-index:0;pointer-events:none}.schematic-display{transform:scale(1.5)}.page{display:none}.page.active{display:block;animation:fadeIn .5s ease-in-out}@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}h1,h2{font-family:var(--font-family-title);text-align:center;color:var(--color-gold-pale);letter-spacing:2px}h1{font-size:2.5rem;margin-bottom:.5rem}h2{font-size:1.5rem;color:var(--color-cyan-tian);margin-top:0;margin-bottom:3rem}.sentence{font-size:1.2rem;margin-bottom:2.5rem;line-height:2.2;color:var(--color-white-moon)}.dropdown-wrapper{display:inline-block;position:relative;border-bottom:1px dashed var(--color-gold-liu);cursor:pointer;padding:0 .5rem;color:var(--color-gold-pale);font-weight:bold;transition:color .3s}.dropdown-wrapper:hover{background-color:rgba(212,175,55,.1)}.dropdown-wrapper .custom-options{display:none;position:absolute;top:100%;left:0;min-width:100%;background-color:var(--color-black-void);border:1px solid var(--color-gold-liu);border-radius:4px;padding:.5rem 0;z-index:100;max-height:200px;overflow-y:auto}.dropdown-wrapper:hover .custom-options{display:block}.custom-options div{padding:.5rem 1.5rem;cursor:pointer;color:var(--color-white-moon);font-size:.9rem;white-space:nowrap}.custom-options div:hover{background-color:rgba(212,175,55,.2);color:var(--color-gold-pale)}.custom-option-item{display:flex;justify-content:space-between;align-items:center}.remove-btn{background:none;border:none;color:var(--color-red-chi);font-size:1.2rem;cursor:pointer;padding:0 .5rem;opacity:.5;transition:opacity .3s}.remove-btn:hover{opacity:1}.tone-exclusive{position:relative}.tone-exclusive span{color:var(--color-cyan-tian);font-weight:bold}.tone-exclusive::before{content:"";position:absolute;top:50%;left:.5rem;width:10px;height:10px;border-radius:50%;background-color:var(--color-cyan-tian);transform:translateY(-50%);opacity:.7;box-shadow:0 0 8px var(--color-cyan-tian)}.custom-input-group{display:flex;flex-direction:row;gap:.5rem;margin-top:1rem;padding-left:1rem;align-items:center}.custom-input-group input{width:120px}.custom-input-group textarea{height:2.2rem;resize:none;line-height:1.4rem}.custom-input-group button{align-self:flex-start;padding:.3rem 1rem;background:var(--color-cyan-tian);color:var(--color-black-void);border:none;border-radius:4px;cursor:pointer;font-weight:bold;transition:background-color .3s}.custom-input-group button:hover{background:#5abfcf}.age-input{width:60px;background:rgba(0,0,0,0);border:none;border-bottom:1px dashed var(--color-gold-liu);color:var(--color-gold-pale);font-family:var(--font-family-main);font-size:1.2rem;text-align:center;padding:0 .2rem}.selections-container{display:flex;flex-direction:column;gap:.5rem;margin-top:1rem;padding-left:1rem}.selected-item{background:rgba(212,175,55,.1);border:1px solid rgba(212,175,55,.5);color:var(--color-gold-pale);padding:.2rem .6rem;border-radius:4px;font-size:.9rem;display:flex;align-items:center}.remove-item{margin-left:.5rem;cursor:pointer;font-weight:bold}.remove-item:hover{color:var(--color-red-chi)}.nav-buttons{display:flex;justify-content:space-between;margin-top:3rem}.nav-btn,.submit-btn,#reset-world-btn{padding:.8rem 1.5rem;border:1px solid var(--color-gold-liu);border-radius:5px;font-family:var(--font-family-main);font-size:1rem;cursor:pointer;transition:all .3s ease;background-color:rgba(0,0,0,0);color:var(--color-gold-liu)}.nav-btn:hover,.submit-btn:hover,#reset-world-btn:hover{background-color:rgba(212,175,55,.1);box-shadow:0 0 10px rgba(212,175,55,.5)}.submit-btn{background-color:var(--color-gold-liu);color:var(--color-black-void);font-weight:bold}#reset-world-btn{border-color:var(--color-grey-stone);color:var(--color-grey-stone)}#reset-world-btn:hover{border-color:var(--color-red-chi);color:var(--color-red-chi);background-color:rgba(199,67,67,.1);box-shadow:0 0 10px rgba(199,67,67,.5)}#points-tracker{position:fixed;top:1rem;right:1rem;background:var(--color-indigo-deep);padding:.5rem 1.5rem;border-radius:20px;box-shadow:0 2px 10px rgba(0,0,0,.3);font-weight:bold;z-index:10;border:1px solid rgba(212,175,55,.3);color:var(--color-gold-pale)}.potential-grid{display:grid;grid-template-columns:1fr 1fr;gap:2rem}.potential-item{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:1.5rem;border:1px solid rgba(212,175,55,.2);border-radius:8px;background:var(--color-black-void)}.potential-item h4{font-family:var(--font-family-title);margin:0 0 1rem;font-size:1.5rem;color:var(--color-cyan-tian)}.potential-controls{display:flex;align-items:center;gap:1.5rem}.potential-controls button{width:35px;height:35px;border-radius:50%;background-color:var(--color-black-void);color:var(--color-gold-liu);border:1px solid var(--color-gold-liu);font-size:1.8rem;font-weight:bold;cursor:pointer;transition:all .2s;display:flex;justify-content:center;align-items:center;padding-bottom:4px}.potential-controls button:hover{background-color:var(--color-gold-liu);color:var(--color-black-void)}.potential-controls span{font-size:2rem;font-weight:bold;min-width:40px;text-align:center;color:var(--color-white-moon)}#summary-page{border:1px solid rgba(212,175,55,.3);padding:2rem;border-radius:8px;background:rgba(10,15,30,.5)}#summary-page p{margin:0 0 1.5rem;font-size:1.1rem;line-height:1.8}#summary-page .summary-text{color:var(--color-gold-pale);font-weight:bold}.scrollable-content{flex-grow:1;overflow-y:auto;padding-right:1rem}#points-tracker{display:flex;align-items:center;gap:1.5rem}.difficulty-selector select{background:var(--color-indigo-deep);border:1px solid var(--color-gold-liu);color:var(--color-gold-pale);border-radius:4px;padding:.2rem .5rem;font-family:var(--font-family-main);font-size:.9rem}.difficulty-selector select option{background:var(--color-indigo-deep);color:var(--color-gold-pale)}.fullscreen-btn{position:fixed;top:1rem;right:1rem;z-index:20;background:var(--color-indigo-deep);border:1px solid var(--color-gold-liu);color:var(--color-gold-pale);padding:.5rem 1rem;border-radius:20px;cursor:pointer;transition:all .3s ease;font-family:var(--font-family-main)}.fullscreen-btn:hover{background-color:rgba(212,175,55,.1);box-shadow:0 0 10px rgba(212,175,55,.5)}#points-tracker{right:8rem}.destiny-text{margin-top:2rem;padding:1.5rem;border:1px dashed var(--color-cyan-tian);border-radius:8px;background:rgba(58,143,157,.1);color:var(--color-cyan-tian);text-align:center;font-family:var(--font-family-title);font-size:1.3rem;letter-spacing:2px;text-shadow:0 0 8px rgba(58,143,157,.7)}.difficulty-selector select:focus{outline:none;box-shadow:0 0 5px var(--color-gold-liu)}

/*# sourceMappingURL=main.css.map*/</style></head><body><div id="app-container"></div><script type="module" src="072382c0d7c5290ac230.ts"></script></body></html>