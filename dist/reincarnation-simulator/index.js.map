{"version":3,"file":"index.js","mappings":"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","sources":["src://tavern_helper_template/node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js","src://tavern_helper_template/webpack/bootstrap","src://tavern_helper_template/webpack/runtime/compat get default export","src://tavern_helper_template/webpack/runtime/define property getters","src://tavern_helper_template/webpack/runtime/hasOwnProperty shorthand","src://tavern_helper_template/webpack/runtime/make namespace object","src://tavern_helper_template/external var \"Vue\"","src://tavern_helper_template/external var \"VueRouter\"","webpack://tavern_helper_template/./src/reincarnation-simulator/app.vue?0555","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/ActionPanel.vue?9e2d","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/ActionPanel.vue?38e1","src://tavern_helper_template/src/reincarnation-simulator/services/CommandService.ts","src://tavern_helper_template/src/reincarnation-simulator/services/InputHistoryService.ts","src://tavern_helper_template/external var \"_\"","src://tavern_helper_template/external var \"z\"","src://tavern_helper_template/src/reincarnation-simulator/services/EntityIndexService.ts","src://tavern_helper_template/src/reincarnation-simulator/services/ContextService.ts","src://tavern_helper_template/src/reincarnation-simulator/modules/world-map/services/WorldMapParser.ts","src://tavern_helper_template/src/reincarnation-simulator/services/LorebookService.ts","src://tavern_helper_template/src/reincarnation-simulator/services/EventBus.ts","src://tavern_helper_template/src/reincarnation-simulator/services/MemoryService.ts","src://tavern_helper_template/src/reincarnation-simulator/services/NotificationService.ts","src://tavern_helper_template/src/reincarnation-simulator/services/service-locator.ts","src://tavern_helper_template/src/reincarnation-simulator/services/tavern.ts","src://tavern_helper_template/src/reincarnation-simulator/services/WorkflowService.ts","src://tavern_helper_template/src/reincarnation-simulator/services/WorldEvolutionService.ts","src://tavern_helper_template/src/reincarnation-simulator/store/state.ts","src://tavern_helper_template/src/reincarnation-simulator/store/getters.ts","src://tavern_helper_template/src/reincarnation-simulator/services/updater.ts","src://tavern_helper_template/src/reincarnation-simulator/store/actions.ts","src://tavern_helper_template/src/reincarnation-simulator/utils/tagProcessor.ts","src://tavern_helper_template/src/reincarnation-simulator/services/InputModalService.ts","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/EnhancedInputBox.vue?61f3","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/EnhancedInputBox.vue?422a","src://tavern_helper_template/src/reincarnation-simulator/components/common/InputHistoryPopup.vue","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/InputHistoryPopup.vue?a007","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/Notification.vue?719a","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/Notification.vue?b15e","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/NotificationContainer.vue?4cc4","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/NotificationContainer.vue?544e","webpack://tavern_helper_template/./src/reincarnation-simulator/components/controls/SideMenuButton.vue?2518","webpack://tavern_helper_template/src/reincarnation-simulator/components/controls/SideMenuButton.vue?52f0","src://tavern_helper_template/src/reincarnation-simulator/services/NpcService.ts","src://tavern_helper_template/src/reincarnation-simulator/services/DetailModalService.ts","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/NpcInfoCard.vue?78b4","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/NpcInfoCard.vue?acb2","src://tavern_helper_template/src/reincarnation-simulator/utils/yamlParser.ts","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/LocationInfoCard.vue?64ce","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/LocationInfoCard.vue?d62a","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/DatabaseItemCard.vue?d4d6","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/DatabaseItemCard.vue?e5e9","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/FormattedTextRenderer.vue?9990","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/FormattedTextRenderer.vue?f242","webpack://tavern_helper_template/./src/reincarnation-simulator/MainView.vue?d048","webpack://tavern_helper_template/src/reincarnation-simulator/MainView.vue?296b","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/DestinyPlate.vue?6cc2","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/DestinyPlate.vue?c7f4","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/avatar/AvatarCharacterPanel.vue?ba4b","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/avatar/AvatarCharacterPanel.vue?f1e8","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/avatar/AvatarInventoryPanel.vue?218f","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/avatar/AvatarInventoryPanel.vue?db69","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/avatar/AvatarTasksPanel.vue?6c7d","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/avatar/AvatarTasksPanel.vue?2ba4","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/CharacterPanel.vue?ac72","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/CharacterPanel.vue?9be1","src://tavern_helper_template/src/reincarnation-simulator/components/modals/ImprintDetailModal.vue","webpack://tavern_helper_template/src/reincarnation-simulator/components/modals/ImprintDetailModal.vue?9e96","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/ImprintsPanel.vue?0006","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/ImprintsPanel.vue?01f0","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/inventory/ItemDetailPanel.vue?e060","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/inventory/ItemDetailPanel.vue?52be","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/InventoryPanel.vue?ba4d","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/InventoryPanel.vue?88c3","src://tavern_helper_template/src/reincarnation-simulator/services/useFollowSystem.ts","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/FollowButton.vue?8dc4","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/FollowButton.vue?c3d1","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/npc-details/NpcArchiveTab.vue?8b78","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/npc-details/NpcArchiveTab.vue?686f","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/AttributeGrid.vue?bfc1","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/AttributeGrid.vue?fe77","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/ObjectRendererItem.vue?8fd3","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/ObjectRendererItem.vue?383e","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/ObjectRenderer.vue?9495","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/ObjectRenderer.vue?2d8c","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/npc-details/ArtDetail.vue?656f","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/npc-details/ArtDetail.vue?e27d","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/npc-details/TalentDetail.vue?051d","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/npc-details/TalentDetail.vue?69de","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/npc-details/NpcPowerTab.vue?a64c","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/npc-details/NpcPowerTab.vue?14ad","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/ProgressBar.vue?5d59","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/ProgressBar.vue?b1a4","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/RelationsDisplay.vue?e891","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/RelationsDisplay.vue?3f5e","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/InventoryGrid.vue?32b1","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/InventoryGrid.vue?1b60","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/npc-details/NpcCauseTab.vue?8eb4","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/npc-details/NpcCauseTab.vue?8b64","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/NpcDetailDisplay.vue?86cd","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/NpcDetailDisplay.vue?cf57","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/NpcDirectoryPanel.vue?6dca","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/NpcDirectoryPanel.vue?6652","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/LogPanel.vue?e6b8","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/LogPanel.vue?89da","src://tavern_helper_template/src/reincarnation-simulator/services/RipplesService.ts","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/RipplesPanel.vue?ab45","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/RipplesPanel.vue?8c74","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/reincarnation/AvatarSelection.vue?6917","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/reincarnation/AvatarSelection.vue?fe4a","src://tavern_helper_template/external var \"toastr\"","src://tavern_helper_template/src/reincarnation-simulator/services/ConfirmationService.ts","src://tavern_helper_template/src/reincarnation-simulator/components/panels/reincarnation/SettlementChoiceCard.vue","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/reincarnation/SettlementChoiceCard.vue?592b","src://tavern_helper_template/src/reincarnation-simulator/components/panels/reincarnation/SettlementView.vue","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/reincarnation/SettlementView.vue?b93a","src://tavern_helper_template/src/reincarnation-simulator/services/StarMapService.ts","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/reincarnation/WorldSelection.vue?9945","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/reincarnation/WorldSelection.vue?ebda","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/ReincarnationPanel.vue?b826","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/ReincarnationPanel.vue?c3e8","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/RippleDetailPanel.vue?86bc","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/RippleDetailPanel.vue?0cea","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/SkillsPanel.vue?36ad","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/SkillsPanel.vue?d8a4","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/MemoryPanel.vue?47fd","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/MemoryPanel.vue?9b05","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/SaveLoadPanel.vue?256e","src://tavern_helper_template/src/reincarnation-simulator/services/saveLoadService.ts","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/SaveLoadPanel.vue?65a4","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/SaveLoadPanel.vue?78bd","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/SystemPanel.vue?6d64","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/SystemPanel.vue?6462","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/RealmDetailCard.vue?7acb","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/RealmDetailCard.vue?cd49","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/WorldDetailsPanel.vue?8a00","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/WorldDetailsPanel.vue?2d3d","src://tavern_helper_template/src/reincarnation-simulator/modules/world-map/services/ColorService.ts","src://tavern_helper_template/src/reincarnation-simulator/modules/world-map/services/CoordinateService.ts","src://tavern_helper_template/src/reincarnation-simulator/modules/world-map/services/WorldMapDataService.ts","src://tavern_helper_template/src/reincarnation-simulator/modules/world-map/store/mapState.ts","webpack://tavern_helper_template/./src/reincarnation-simulator/modules/world-map/components/MapNavigator.vue?9756","webpack://tavern_helper_template/src/reincarnation-simulator/modules/world-map/components/MapNavigator.vue?a5da","webpack://tavern_helper_template/./src/reincarnation-simulator/modules/world-map/components/NodeDetailPanel.vue?b48a","webpack://tavern_helper_template/src/reincarnation-simulator/modules/world-map/components/NodeDetailPanel.vue?eb2b","webpack://tavern_helper_template/./src/reincarnation-simulator/modules/world-map/components/AvatarWorldMapView.vue?a4ff","webpack://tavern_helper_template/src/reincarnation-simulator/modules/world-map/components/AvatarWorldMapView.vue?fd30","webpack://tavern_helper_template/./src/reincarnation-simulator/modules/world-map/components/WorldMapView.vue?ff1f","src://tavern_helper_template/src/reincarnation-simulator/services/panelRegistry.ts","src://tavern_helper_template/src/reincarnation-simulator/services/DockManagerService.ts","src://tavern_helper_template/src/reincarnation-simulator/services/usePanelManager.ts","webpack://tavern_helper_template/./src/reincarnation-simulator/components/DockManager.vue?a6d2","webpack://tavern_helper_template/src/reincarnation-simulator/components/DockManager.vue?be41","webpack://tavern_helper_template/./src/reincarnation-simulator/components/LoadingIndicator.vue?6cac","webpack://tavern_helper_template/src/reincarnation-simulator/components/LoadingIndicator.vue?efe3","webpack://tavern_helper_template/./src/reincarnation-simulator/components/modals/NpcListModal.vue?ff1a","webpack://tavern_helper_template/src/reincarnation-simulator/components/modals/NpcListModal.vue?dd90","src://tavern_helper_template/external var \"$\"","src://tavern_helper_template/src/reincarnation-simulator/services/fullscreenService.ts","src://tavern_helper_template/src/reincarnation-simulator/services/NpcModalService.ts","src://tavern_helper_template/src/reincarnation-simulator/store/ui.ts","webpack://tavern_helper_template/./src/reincarnation-simulator/components/WorldTimeDisplay.vue?e0b6","webpack://tavern_helper_template/src/reincarnation-simulator/components/WorldTimeDisplay.vue?4ade","webpack://tavern_helper_template/./src/reincarnation-simulator/components/TopStatusBar.vue?d514","webpack://tavern_helper_template/src/reincarnation-simulator/components/TopStatusBar.vue?68f1","src://tavern_helper_template/src/reincarnation-simulator/services/LayoutService.ts","webpack://tavern_helper_template/./src/reincarnation-simulator/app.vue?39ea","webpack://tavern_helper_template/src/reincarnation-simulator/app.vue?1335","webpack://tavern_helper_template/./src/reincarnation-simulator/components/AttributeDisplay.vue?8028","webpack://tavern_helper_template/src/reincarnation-simulator/components/AttributeDisplay.vue?d0c0","webpack://tavern_helper_template/./src/reincarnation-simulator/views/CharacterView.vue?353a","webpack://tavern_helper_template/src/reincarnation-simulator/views/CharacterView.vue?7eba","webpack://tavern_helper_template/./src/reincarnation-simulator/views/InventoryView.vue?1dd1","webpack://tavern_helper_template/src/reincarnation-simulator/views/InventoryView.vue?93a6","webpack://tavern_helper_template/./src/reincarnation-simulator/views/MainContentView.vue?3170","webpack://tavern_helper_template/src/reincarnation-simulator/views/MainContentView.vue?074e","webpack://tavern_helper_template/./src/reincarnation-simulator/views/NpcListView.vue?574d","webpack://tavern_helper_template/src/reincarnation-simulator/views/NpcListView.vue?7cc1","webpack://tavern_helper_template/./src/reincarnation-simulator/views/WorldStateView.vue?b8c7","src://tavern_helper_template/src/reincarnation-simulator/core/vue-loader.ts","webpack://tavern_helper_template/src/reincarnation-simulator/views/WorldStateView.vue?30ec","src://tavern_helper_template/src/reincarnation-simulator/services/LogSyncService.ts","src://tavern_helper_template/src/reincarnation-simulator/index.ts"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = Vue;","const __WEBPACK_NAMESPACE_OBJECT__ = VueRouter;","import { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, withModifiers as _withModifiers, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveDynamicComponent as _resolveDynamicComponent, normalizeProps as _normalizeProps, guardReactiveProps as _guardReactiveProps, createBlock as _createBlock, renderList as _renderList, Fragment as _Fragment, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"main-layout\" };\nconst _hoisted_2 = { class: \"modal-content confirmation-modal\" };\nconst _hoisted_3 = { class: \"confirmation-title\" };\nconst _hoisted_4 = { class: \"confirmation-message\" };\nconst _hoisted_5 = { class: \"confirmation-buttons\" };\nconst _hoisted_6 = { class: \"modal-content detail-modal\" };\nconst _hoisted_7 = { class: \"modal-header\" };\nconst _hoisted_8 = { class: \"modal-title\" };\nconst _hoisted_9 = { class: \"modal-body\" };\nconst _hoisted_10 = { class: \"modal-content detail-modal\" };\nconst _hoisted_11 = { class: \"modal-header\" };\nconst _hoisted_12 = { class: \"modal-title\" };\nconst _hoisted_13 = { class: \"modal-body\" };\nconst _hoisted_14 = {\n    key: 4,\n    class: \"modal-overlay input-modal-overlay\"\n};\nconst _hoisted_15 = { class: \"modal-content input-modal-content\" };\nconst _hoisted_16 = { class: \"input-area-container\" };\nconst _hoisted_17 = { class: \"input-area-with-buttons\" };\nconst _hoisted_18 = {\n    key: 2,\n    class: \"command-queue-popup\",\n    style: { \"background-color\": \"#0a0f1e\", \"border\": \"1px solid #d4af37\" }\n};\nconst _hoisted_19 = { class: \"popup-header\" };\nconst _hoisted_20 = { class: \"popup-body\" };\nconst _hoisted_21 = {\n    key: 0,\n    class: \"command-list\"\n};\nconst _hoisted_22 = {\n    key: 1,\n    class: \"empty-queue\"\n};\nconst _hoisted_23 = {\n    key: 0,\n    class: \"popup-footer\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n    const _component_TopStatusBar = _resolveComponent(\"TopStatusBar\");\n    const _component_DockManager = _resolveComponent(\"DockManager\");\n    const _component_LoadingIndicator = _resolveComponent(\"LoadingIndicator\");\n    const _component_NpcListModal = _resolveComponent(\"NpcListModal\");\n    const _component_ActionPanel = _resolveComponent(\"ActionPanel\");\n    const _component_EnhancedInputBox = _resolveComponent(\"EnhancedInputBox\");\n    const _component_InputHistoryPopup = _resolveComponent(\"InputHistoryPopup\");\n    const _component_NotificationContainer = _resolveComponent(\"NotificationContainer\");\n    return (_openBlock(), _createElementBlock(\"div\", {\n        class: _normalizeClass([\"guixu-root-container\", { 'web-fullscreen': _ctx.isWebFullscreen }])\n    }, [\n        _createVNode(_component_TopStatusBar),\n        _createElementVNode(\"div\", _hoisted_1, [\n            _createVNode(_component_DockManager)\n        ]),\n        _createCommentVNode(\" Global Confirmation Modal \"),\n        (_ctx.confirmation.isVisible)\n            ? (_openBlock(), _createElementBlock(\"div\", {\n                key: 0,\n                class: \"modal-overlay\",\n                onClick: _cache[2] || (_cache[2] = _withModifiers(($event) => (_ctx.confirmationService.hide()), [\"self\"]))\n            }, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"h3\", _hoisted_3, _toDisplayString(_ctx.confirmation.title), 1 /* TEXT */),\n                    _createElementVNode(\"p\", _hoisted_4, _toDisplayString(_ctx.confirmation.message), 1 /* TEXT */),\n                    _createElementVNode(\"div\", _hoisted_5, [\n                        _createElementVNode(\"button\", {\n                            onClick: _cache[0] || (_cache[0] = ($event) => (_ctx.confirmationService.hide()))\n                        }, \"\"),\n                        _createElementVNode(\"button\", {\n                            class: \"primary\",\n                            onClick: _cache[1] || (_cache[1] = ($event) => (_ctx.confirmationService.confirm()))\n                        }, \"\")\n                    ])\n                ])\n            ]))\n            : _createCommentVNode(\"v-if\", true),\n        _createCommentVNode(\" Global Detail Modal \"),\n        (_ctx.detailModal.isVisible)\n            ? (_openBlock(), _createElementBlock(\"div\", {\n                key: 1,\n                class: \"modal-overlay\",\n                onClick: _cache[4] || (_cache[4] = _withModifiers(($event) => (_ctx.detailModalService.hide()), [\"self\"]))\n            }, [\n                _createElementVNode(\"div\", _hoisted_6, [\n                    _createElementVNode(\"div\", _hoisted_7, [\n                        _createElementVNode(\"h3\", _hoisted_8, _toDisplayString(_ctx.detailModal.title), 1 /* TEXT */),\n                        _createElementVNode(\"button\", {\n                            class: \"close-button\",\n                            onClick: _cache[3] || (_cache[3] = ($event) => (_ctx.detailModalService.hide()))\n                        }, \"\")\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_9, [\n                        (_openBlock(), _createBlock(_resolveDynamicComponent(_ctx.detailModal.component), _normalizeProps(_guardReactiveProps(_ctx.detailModal.props)), null, 16 /* FULL_PROPS */))\n                    ])\n                ])\n            ]))\n            : _createCommentVNode(\"v-if\", true),\n        (_ctx.store.isGenerating)\n            ? (_openBlock(), _createBlock(_component_LoadingIndicator, {\n                key: 2,\n                error: _ctx.store.generationError\n            }, null, 8 /* PROPS */, [\"error\"]))\n            : _createCommentVNode(\"v-if\", true),\n        _createCommentVNode(\" Global NPC List Modal \"),\n        (_ctx.npcModal.isVisible)\n            ? (_openBlock(), _createElementBlock(\"div\", {\n                key: 3,\n                class: \"modal-overlay\",\n                onClick: _cache[6] || (_cache[6] = _withModifiers(($event) => (_ctx.npcModalService.hide()), [\"self\"]))\n            }, [\n                _createElementVNode(\"div\", _hoisted_10, [\n                    _createElementVNode(\"div\", _hoisted_11, [\n                        _createElementVNode(\"h3\", _hoisted_12, _toDisplayString(_ctx.npcModal.title), 1 /* TEXT */),\n                        _createElementVNode(\"button\", {\n                            class: \"close-button\",\n                            onClick: _cache[5] || (_cache[5] = ($event) => (_ctx.npcModalService.hide()))\n                        }, \"\")\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_13, [\n                        _createVNode(_component_NpcListModal, _normalizeProps(_guardReactiveProps(_ctx.npcModal.props)), null, 16 /* FULL_PROPS */)\n                    ])\n                ])\n            ]))\n            : _createCommentVNode(\"v-if\", true),\n        _createCommentVNode(\" Global Input Modal \"),\n        (_ctx.inputModal.isVisible)\n            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_14, [\n                _createElementVNode(\"div\", _hoisted_15, [\n                    _createElementVNode(\"div\", _hoisted_16, [\n                        (_ctx.isActionPanelVisible)\n                            ? (_openBlock(), _createBlock(_component_ActionPanel, {\n                                key: 0,\n                                \"command-count\": _ctx.commandCount,\n                                \"main-options\": _ctx.menuOptions.main,\n                                \"avatar-options\": _ctx.menuOptions.avatar,\n                                \"common-options\": _ctx.menuOptions.common,\n                                onToggleHistory: _ctx.toggleHistory,\n                                onToggleCommands: _ctx.toggleCommandQueue\n                            }, null, 8 /* PROPS */, [\"command-count\", \"main-options\", \"avatar-options\", \"common-options\", \"onToggleHistory\", \"onToggleCommands\"]))\n                            : _createCommentVNode(\"v-if\", true),\n                        _createElementVNode(\"div\", _hoisted_17, [\n                            _createVNode(_component_EnhancedInputBox, {\n                                onSubmitAction: _ctx.handleSubmit,\n                                onToggleActionPanel: _ctx.toggleActionPanel\n                            }, null, 8 /* PROPS */, [\"onSubmitAction\", \"onToggleActionPanel\"])\n                        ]),\n                        (_ctx.isHistoryVisible)\n                            ? (_openBlock(), _createBlock(_component_InputHistoryPopup, {\n                                key: 1,\n                                onClose: _ctx.toggleHistory,\n                                onSelectEntry: _ctx.selectHistoryEntry\n                            }, null, 8 /* PROPS */, [\"onClose\", \"onSelectEntry\"]))\n                            : _createCommentVNode(\"v-if\", true),\n                        (_ctx.isQueueVisible)\n                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_18, [\n                                _createElementVNode(\"div\", _hoisted_19, [\n                                    _cache[9] || (_cache[9] = _createElementVNode(\"h3\", null, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"button\", {\n                                        class: \"close-popup-button\",\n                                        onClick: _cache[7] || (_cache[7] =\n                                            //@ts-ignore\n                                            (...args) => (_ctx.toggleCommandQueue && _ctx.toggleCommandQueue(...args)))\n                                    }, \"\")\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_20, [\n                                    (_ctx.commandCount > 0)\n                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_21, [\n                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.commands, (cmd, index) => {\n                                                return (_openBlock(), _createElementBlock(\"div\", {\n                                                    key: index,\n                                                    class: \"command-item\"\n                                                }, _toDisplayString(cmd), 1 /* TEXT */));\n                                            }), 128 /* KEYED_FRAGMENT */))\n                                        ]))\n                                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_22, \"\"))\n                                ]),\n                                (_ctx.commandCount > 0)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_23, [\n                                        _createElementVNode(\"button\", {\n                                            class: \"clear-button\",\n                                            onClick: _cache[8] || (_cache[8] =\n                                                //@ts-ignore\n                                                (...args) => (_ctx.clearCommands && _ctx.clearCommands(...args)))\n                                        }, \"\")\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ])\n                ])\n            ]))\n            : _createCommentVNode(\"v-if\", true),\n        _createVNode(_component_NotificationContainer)\n    ], 2 /* CLASS */));\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode } from \"vue\";\nconst _hoisted_1 = { class: \"action-panel\" };\nconst _hoisted_2 = { class: \"button-row\" };\nconst _hoisted_3 = [\"disabled\", \"onClick\"];\nconst _hoisted_4 = { class: \"button-row\" };\nconst _hoisted_5 = [\"disabled\", \"onClick\"];\nconst _hoisted_6 = { class: \"button-row\" };\nconst _hoisted_7 = [\"disabled\", \"onClick\"];\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ActionPanel',\n    props: {\n        commandCount: {},\n        mainOptions: {},\n        avatarOptions: {},\n        commonOptions: {}\n    },\n    emits: ['toggle-history', 'toggle-commands'],\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.mainOptions, (option) => {\n                        return (_openBlock(), _createElementBlock(\"button\", {\n                            key: option.id,\n                            class: \"action-button\",\n                            disabled: option.disabled && option.disabled(),\n                            onClick: option.action\n                        }, _toDisplayString(option.text), 9 /* TEXT, PROPS */, _hoisted_3));\n                    }), 128 /* KEYED_FRAGMENT */))\n                ]),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.avatarOptions, (option) => {\n                        return (_openBlock(), _createElementBlock(\"button\", {\n                            key: option.id,\n                            class: \"action-button\",\n                            disabled: option.disabled && option.disabled(),\n                            onClick: option.action\n                        }, _toDisplayString(option.text), 9 /* TEXT, PROPS */, _hoisted_5));\n                    }), 128 /* KEYED_FRAGMENT */))\n                ]),\n                _createElementVNode(\"div\", _hoisted_6, [\n                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.commonOptions, (option) => {\n                        return (_openBlock(), _createElementBlock(\"button\", {\n                            key: option.id,\n                            class: \"action-button\",\n                            disabled: option.disabled && option.disabled(),\n                            onClick: option.action\n                        }, _toDisplayString(option.text), 9 /* TEXT, PROPS */, _hoisted_7));\n                    }), 128 /* KEYED_FRAGMENT */)),\n                    _createElementVNode(\"button\", {\n                        class: \"action-button\",\n                        onClick: _cache[0] || (_cache[0] = ($event) => (_ctx.$emit('toggle-history')))\n                    }, \"\"),\n                    _createElementVNode(\"button\", {\n                        class: \"action-button\",\n                        onClick: _cache[1] || (_cache[1] = ($event) => (_ctx.$emit('toggle-commands')))\n                    }, \" (\" + _toDisplayString(__props.commandCount) + \")\", 1 /* TEXT */)\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ActionPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ActionPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ActionPanel.vue?vue&type=style&index=0&id=fa88c5d8&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-fa88c5d8\"]])\n\nexport default __exports__","type CommandListener = (commands: string[]) => void;\n\nclass CommandService {\n  private commands: string[] = [];\n  private listeners: CommandListener[] = [];\n\n  subscribe(listener: CommandListener) {\n    this.listeners.push(listener);\n  }\n\n  unsubscribe(listener: CommandListener) {\n    this.listeners = this.listeners.filter(l => l !== listener);\n  }\n\n  private notify() {\n    this.listeners.forEach(listener => listener([...this.commands]));\n  }\n\n  addCommand(command: string) {\n    this.commands.push(command);\n    this.notify();\n  }\n\n  getCommands(): string[] {\n    return [...this.commands];\n  }\n\n  clearCommands() {\n    this.commands = [];\n    this.notify();\n  }\n}\n\nexport const commandService = new CommandService();\n","import { reactive } from 'vue';\n\nconst MAX_RECENT_HISTORY = 5;\nconst MAX_SAVED_HISTORY = 5;\nconst STORAGE_KEY_RECENT = 'reincarnation_input_history_recent';\nconst STORAGE_KEY_SAVED = 'reincarnation_input_history_saved';\n\nclass InputHistoryService {\n  public state = reactive({\n    recent: [] as string[],\n    saved: [] as string[],\n  });\n\n  constructor() {\n    this.loadHistory();\n  }\n\n  private loadHistory() {\n    const recentData = localStorage.getItem(STORAGE_KEY_RECENT);\n    const savedData = localStorage.getItem(STORAGE_KEY_SAVED);\n    if (recentData) {\n      this.state.recent = JSON.parse(recentData);\n    }\n    if (savedData) {\n      this.state.saved = JSON.parse(savedData);\n    }\n  }\n\n  private saveHistory() {\n    localStorage.setItem(STORAGE_KEY_RECENT, JSON.stringify(this.state.recent));\n    localStorage.setItem(STORAGE_KEY_SAVED, JSON.stringify(this.state.saved));\n  }\n\n  add(input: string) {\n    if (!input || input.trim() === '') {\n      return;\n    }\n    // Avoid duplicates\n    const existingIndex = this.state.recent.indexOf(input);\n    if (existingIndex > -1) {\n      this.state.recent.splice(existingIndex, 1);\n    }\n\n    this.state.recent.unshift(input);\n    if (this.state.recent.length > MAX_RECENT_HISTORY) {\n      this.state.recent.pop();\n    }\n    this.saveHistory();\n  }\n\n  save(entry: string) {\n    if (this.state.saved.includes(entry)) {\n      return;\n    }\n\n    this.state.saved.unshift(entry);\n    if (this.state.saved.length > MAX_SAVED_HISTORY) {\n      this.state.saved.pop();\n    }\n    this.saveHistory();\n  }\n\n  deleteRecent(index: number) {\n    this.state.recent.splice(index, 1);\n    this.saveHistory();\n  }\n\n  deleteSaved(index: number) {\n    this.state.saved.splice(index, 1);\n    this.saveHistory();\n  }\n\n  clearAll() {\n    this.state.recent = [];\n    this.state.saved = [];\n    this.saveHistory();\n  }\n}\n\nexport const inputHistoryService = new InputHistoryService();\n","const __WEBPACK_NAMESPACE_OBJECT__ = _;","const __WEBPACK_NAMESPACE_OBJECT__ = z;","import { get } from 'lodash';\nimport { AppState, Character, World, WorldState, WorldbookEntry } from '../types';\n// @ts-ignore\nimport { parse } from 'yaml';\n\n// API\ndeclare const TavernHelper: any;\n\n/**\n * \n */\nexport interface EntityMetadata {\n  id: string; // ID\n  name: string; // \n  type: 'character' | 'location' | 'dbItem' | 'imprint' | 'skill' | 'artifice' | 'talent' | 'resource' | 'faction';\n  worldId: string; // ID\n  epochId?: string; // ID ()\n  // \n  entryId?: string; // ID ()\n  category?: string; // \n  source?: 'player' | 'world'; // \n  parentId?: string | null; // ID\n  path?: string; //  ()\n}\n\n/**\n * \n * \n */\nclass EntityIndexService {\n  private indexByName = new Map<string, EntityMetadata[]>();\n  private indexById = new Map<string, EntityMetadata>();\n  private isInitialized = false;\n\n  /**\n   * \n   */\n  public async buildIndex(worldState: AppState['worldState']): Promise<void> {\n    if (this.isInitialized || !worldState) return;\n\n    console.log('[EntityIndexService] Starting to build global entity index...');\n    this.indexByName.clear();\n    this.indexById.clear();\n\n    // 1.  ([InitVar].txt)\n    this.indexPlayerData(worldState.);\n\n    // 2.  ([InitVar].txt)\n    for (const worldId in worldState.) {\n      const world = worldState.[worldId];\n      if (world) {\n        this.indexWorldData(world, worldId);\n      }\n    }\n\n    // 3.  ()\n\n    this.isInitialized = true;\n    console.log(`[EntityIndexService] Global entity index built successfully with ${this.indexById.size} entries.`);\n  }\n\n  /**\n   * \n   */\n  public findByName(name: string): EntityMetadata[] | undefined {\n    return this.indexByName.get(name);\n  }\n\n  /**\n   * IDID\n   */\n  public findById(id: string): EntityMetadata | undefined {\n    return this.indexById.get(id);\n  }\n\n  // ---  ---\n\n  private addEntity(entity: EntityMetadata) {\n    // \n    const existingByName = this.indexByName.get(entity.name) || [];\n    this.indexByName.set(entity.name, [...existingByName, entity]);\n    // ID\n    if (!this.indexById.has(entity.id)) {\n      this.indexById.set(entity.id, entity);\n    }\n  }\n\n  private indexPlayerData(playerState: WorldState['']) {\n    if (!playerState) return;\n    // ...\n    const imprints = get(playerState, '.', {}) as { [id: string]: { ?: string } };\n    for (const id in imprints) {\n      if (id === '$meta') continue;\n      const imprint = imprints[id];\n      if (imprint && imprint.) {\n        this.addEntity({\n          id,\n          name: imprint.,\n          type: 'imprint',\n          worldId: '_player', // \n          source: 'player',\n        });\n      }\n    }\n  }\n\n  private indexWorldData(world: World, worldId: string) {\n    // \n    const characters = get(world, '', {}) as { [id: string]: Character };\n    for (const id in characters) {\n      if (id === '$meta' || id.startsWith('sample_')) continue;\n      const char = characters[id];\n      if (char && char.) {\n        this.addEntity({\n          id,\n          name: char.,\n          type: 'character',\n          worldId,\n          source: 'world',\n        });\n      }\n    }\n\n    // \n    const database = get(world, '', {});\n    for (const category in database) {\n      if (category === '$meta') continue;\n      const items = database[category as keyof typeof database] as { [id: string]: { ?: string } };\n      if (!items) continue;\n      for (const id in items) {\n        if (id === '$meta') continue;\n        const item = items[id];\n        if (item && item.) {\n          this.addEntity({\n            id,\n            name: item.,\n            type: 'dbItem',\n            worldId,\n            category,\n            source: 'world',\n          });\n        }\n      }\n    }\n\n    //  (V8.0 )\n    const definition = get(world, '', {});\n    const epochs = get(definition, '', {}) as { [key: string]: any };\n    for (const epochId in epochs) {\n      if (epochId === '$meta') continue;\n      const epoch = epochs[epochId];\n      const content = get(epoch, '', {});\n\n      // \n      const locations = get(content, '', {});\n      for (const id in locations) {\n        if (id === '$meta') continue;\n        const loc = (locations as Record<string, any>)[id];\n        if (loc && loc.) {\n          this.addEntity({\n            id: id,\n            name: loc.,\n            type: 'location',\n            worldId,\n            epochId,\n            source: 'world',\n            path: `..${epochId}..`,\n            parentId: loc.?.ID || null,\n          });\n        }\n      }\n\n      // \n      const resources = get(content, '', {});\n      for (const id in resources) {\n        if (id === '$meta') continue;\n        const res = (resources as Record<string, any>)[id];\n        if (res && res.) {\n          this.addEntity({\n            id: id,\n            name: res.,\n            type: 'resource',\n            worldId,\n            epochId,\n            source: 'world',\n            path: `..${epochId}..`,\n          });\n        }\n      }\n\n      // \n      const factions = get(content, '.', {});\n      for (const id in factions) {\n        if (id === '$meta') continue;\n        const fac = (factions as Record<string, any>)[id];\n        if (fac && fac.) {\n          this.addEntity({\n            id: id,\n            name: fac.,\n            type: 'faction',\n            worldId,\n            epochId,\n            source: 'world',\n            path: `..${epochId}...`,\n          });\n        }\n      }\n    }\n  }\n}\n\nexport const entityIndexService = new EntityIndexService();\n","import { get } from 'lodash';\nimport { AppState, Character, World, WorldEpoch, WorldState } from '../types';\nimport { InformationRipple } from '../types/evolution';\nimport { entityIndexService } from './EntityIndexService';\n\nexport interface UserIntent {\n  actionType: 'combat' | 'social' | 'exploration' | 'inventory' | 'creation' | 'default';\n  crossContextQuery?: { worldId: string; epochId?: string; items?: string[]; locations?: string[] };\n  explicitEntities: {\n    characters: string[];\n    locations: string[];\n    dbItems: string[];\n  };\n  triggeredRipples: InformationRipple[]; // \n  loadFullPlayerData?: (keyof WorldState[''][''])[];\n}\n\n/**\n * AI\n */\nclass ContextService {\n  public analyzeUserIntent(\n    userInput: string,\n    worldState: AppState['worldState'],\n    availableRipples: InformationRipple[],\n  ): UserIntent {\n    const intent: UserIntent = {\n      actionType: 'default',\n      explicitEntities: {\n        characters: [],\n        locations: [],\n        dbItems: [],\n      },\n      triggeredRipples: [],\n    };\n\n    if (!worldState) return intent;\n\n    // 1. \n    const activeWorld = Object.values(worldState. || {}).find(w =>\n      ['', ''].includes(get(w, '..', '')),\n    );\n    const avatarId = get(worldState, '...ID');\n    const currentPlayer = avatarId ? get(activeWorld, `.${avatarId}`) : get(worldState, '.');\n\n    if (currentPlayer && activeWorld) {\n      const currentLocationId = currentPlayer.;\n      if (currentLocationId) {\n        intent.explicitEntities.locations.push(currentLocationId);\n\n        // \n        let parentId = entityIndexService.findById(currentLocationId)?.parentId;\n        while (parentId && parentId !== 'WORLD_ORIGIN') {\n          intent.explicitEntities.locations.push(parentId);\n          parentId = entityIndexService.findById(parentId)?.parentId;\n        }\n\n        // NPC\n        const worldChars = get(activeWorld, '', {});\n        for (const charId in worldChars) {\n          if (get(worldChars, `${charId}.`) === currentLocationId) {\n            intent.explicitEntities.characters.push(charId);\n          }\n        }\n      }\n    }\n\n    // 2.  (Action Type) - \n    const intentScores: Record<UserIntent['actionType'], number> = {\n      combat: 0,\n      inventory: 0,\n      social: 0,\n      exploration: 0,\n      creation: 0,\n      default: 1, // \n    };\n\n    const patterns: { type: UserIntent['actionType']; regex: RegExp; weight: number }[] = [\n      { type: 'combat', regex: /(|||||||||||)/, weight: 3 },\n      { type: 'inventory', regex: /(|||||||||)/, weight: 2 },\n      { type: 'social', regex: /(|||||||||||)/, weight: 2 },\n      { type: 'social', regex: /[\"].*[\"]/, weight: 1.5 }, // \n      { type: 'exploration', regex: /(|||||||||||)/, weight: 2 },\n      { type: 'creation', regex: /(||||||)/, weight: 3 },\n    ];\n\n    patterns.forEach(({ type, regex, weight }) => {\n      if (regex.test(userInput)) {\n        intentScores[type] += weight;\n      }\n    });\n\n    // \n    let maxScore = 0;\n    let bestIntent: UserIntent['actionType'] = 'default';\n\n    for (const [type, score] of Object.entries(intentScores)) {\n      if (score > maxScore) {\n        maxScore = score;\n        bestIntent = type as UserIntent['actionType'];\n      }\n    }\n    intent.actionType = bestIntent;\n\n    // 2. \n    // A simple regex to find potential entities (could be improved)\n    const potentialNames = userInput.match(/[\\u4e00-\\u9fa5a-zA-Z]+/g) || [];\n\n    for (const name of potentialNames) {\n      const results = entityIndexService.findByName(name);\n      if (results) {\n        for (const meta of results) {\n          switch (meta.type) {\n            case 'character':\n              intent.explicitEntities.characters.push(meta.id);\n              break;\n            case 'location':\n              intent.explicitEntities.locations.push(meta.id);\n              break;\n            case 'dbItem':\n            case 'skill':\n            case 'artifice':\n            case 'talent':\n              intent.explicitEntities.dbItems.push(meta.id);\n              break;\n            case 'imprint':\n              if (meta.source === 'player') {\n                if (!intent.loadFullPlayerData) intent.loadFullPlayerData = [];\n                intent.loadFullPlayerData.push('');\n              }\n              break;\n          }\n\n          // /\n          const activeWorldId = Object.keys(worldState.).find(wId =>\n            ['', ''].includes(get(worldState, `.${wId}...`) || ''),\n          );\n          if (meta.worldId !== activeWorldId && meta.worldId !== '_player') {\n            if (!intent.crossContextQuery) {\n              intent.crossContextQuery = { worldId: meta.worldId, items: [], locations: [] };\n            }\n            if (meta.type === 'location') {\n              intent.crossContextQuery.locations?.push(meta.id);\n            } else {\n              intent.crossContextQuery.items?.push(meta.id);\n            }\n          }\n        }\n      }\n    }\n\n    // 3. \n    if (currentPlayer) {\n      for (const ripple of availableRipples) {\n        const influence = ripple.sphereOfInfluence;\n        let isTriggered = false;\n        // \n        if (currentPlayer. && influence.locationIds.includes(currentPlayer.)) {\n          isTriggered = true;\n        }\n        // TODO: \n\n        if (isTriggered) {\n          console.log(`[EvoSys-Gravity] Ripple ${ripple.id} was triggered by narrative gravity.`, ripple);\n          intent.triggeredRipples.push(ripple);\n          // \n          const rippleEntities = this.extractEntitiesFromText(ripple.content, worldState);\n          intent.explicitEntities.characters.push(...rippleEntities.characters);\n          intent.explicitEntities.locations.push(...rippleEntities.locations);\n          intent.explicitEntities.dbItems.push(...rippleEntities.dbItems);\n        }\n      }\n    }\n\n    // 4. \n    if (intent.actionType === 'inventory') {\n      if (!intent.loadFullPlayerData) intent.loadFullPlayerData = [];\n      intent.loadFullPlayerData.push('', '');\n    }\n\n    console.log('[ContextService] User Intent Analyzed:', intent);\n    return intent;\n  }\n\n  private extractEntitiesFromText(text: string, worldState: AppState['worldState']): UserIntent['explicitEntities'] {\n    const entities: UserIntent['explicitEntities'] = { characters: [], locations: [], dbItems: [] };\n    if (!worldState) return entities;\n\n    const potentialNames = text.match(/[\\u4e00-\\u9fa5a-zA-Z]+/g) || [];\n    for (const name of potentialNames) {\n      const results = entityIndexService.findByName(name);\n      if (results) {\n        for (const meta of results) {\n          switch (meta.type) {\n            case 'character':\n              entities.characters.push(meta.id);\n              break;\n            case 'location':\n              entities.locations.push(meta.id);\n              break;\n            case 'dbItem':\n              entities.dbItems.push(meta.id);\n              break;\n          }\n        }\n      }\n    }\n    return entities;\n  }\n\n  /**\n   * ID\n   */\n  public identifyCoreEntities(\n    userInput: string,\n    currentCharacterId: string,\n    worldState: AppState['worldState'],\n  ): string[] {\n    const entities = new Set<string>([currentCharacterId]);\n    if (!worldState || !worldState.) return Array.from(entities);\n\n    const activeWorld = Object.values(worldState.).find(\n      w => get(w, '..') === '' || get(w, '..') === '',\n    );\n    if (!activeWorld) return Array.from(entities);\n\n    const allCharacters = get(activeWorld, '', {}) as { [id: string]: Character };\n    const currentUser = get(allCharacters, currentCharacterId) || get(worldState, '.');\n    if (!currentUser) return Array.from(entities);\n\n    const currentLocationId = currentUser.;\n\n    // 1. NPC\n    for (const charId in allCharacters) {\n      if (allCharacters[charId]. === currentLocationId) {\n        entities.add(charId);\n      }\n    }\n\n    // 2. NPC\n    const causalNet = get(activeWorld, '', {});\n    const playerRelations = get(causalNet, currentCharacterId, {});\n\n    const sortedRelations = Object.entries(playerRelations)\n      .map(([id, rel]: [string, any]) => ({\n        id,\n        intimacy: get(rel, '.', 0),\n        conflict: get(rel, '.', 0),\n      }))\n      .sort((a, b) => b.intimacy - a.intimacy);\n\n    if (sortedRelations.length > 0) {\n      entities.add(sortedRelations[0].id); // \n      const mostHostile = sortedRelations.sort((a, b) => b.conflict - a.conflict)[0];\n      if (mostHostile) entities.add(mostHostile.id); // \n    }\n\n    // 3. \n    for (const id in allCharacters) {\n      const character = allCharacters[id];\n      if (character && character. && userInput.includes(character.)) {\n        entities.add(id);\n      }\n    }\n\n    return Array.from(entities);\n  }\n\n  /**\n   * \n   * @param intent - \n   * @param worldState - \n   * @param userId - ID\n   * @returns \n   */\n  public buildLeanContext(\n    intent: UserIntent,\n    userInput: string, //  <--  userInput \n    worldState: AppState['worldState'],\n    userId: string,\n  ): { stat_data: Partial<AppState['worldState']> } {\n    if (!worldState) return { stat_data: {} };\n\n    const leanState: any = {\n      : {\n        : {},\n        : get(worldState, '.'),\n        : get(worldState, '.'),\n      },\n      : {},\n    };\n\n    // 1.  ()\n    const playerFullData = get(worldState, '.', {}) as Character;\n    // \n    const playerLeanData: any = { ...playerFullData };\n    // \n    if (playerFullData.) {\n      playerLeanData. = this.simplifyIdMap(playerFullData.);\n    }\n    if (playerFullData.) {\n      playerLeanData. = this.simplifyIdMap(playerFullData.);\n    }\n\n    // \n    if (intent.loadFullPlayerData) {\n      intent.loadFullPlayerData.forEach((key: any) => {\n        if (playerFullData[key]) {\n          playerLeanData[key] = playerFullData[key];\n        }\n      });\n    }\n    leanState.. = playerLeanData;\n\n    // 2. \n    const coreEntities = Array.from(new Set([userId, ...intent.explicitEntities.characters]));\n\n    // 3. \n    const activeWorldEntry = Object.entries(get(worldState, '', {}) as { [id: string]: World }).find(\n      ([, w]) => get(w, '..') === '' || get(w, '..') === '',\n    );\n\n    if (activeWorldEntry) {\n      const [worldId, activeWorld] = activeWorldEntry;\n      const epochId = get(activeWorld, '..ID');\n\n      // 3.1  ()\n      if (epochId) {\n        const activeEpoch = get(activeWorld, ['', '', epochId]) as WorldEpoch;\n        if (activeEpoch) {\n          const leanEpoch = { ...activeEpoch };\n          // \n          delete (leanEpoch as any).;\n          leanEpoch. = get(activeEpoch, '', {});\n\n          //  (Location Injection)\n          //  intent.explicitEntities.locations ID activeEpoch.. \n          const allLocations = get(activeEpoch, '.', {});\n          const leanLocations: Record<string, any> = {};\n\n          if (intent.explicitEntities.locations.length > 0) {\n            for (const locId of intent.explicitEntities.locations) {\n              const loc = (allLocations as Record<string, any>)[locId];\n              if (loc) {\n                leanLocations[locId] = loc;\n                //  ()\n                let parentId = get(loc, '.ID');\n                while (parentId && parentId !== 'WORLD_ORIGIN') {\n                  const parent = (allLocations as Record<string, any>)[parentId];\n                  if (parent) {\n                    // \n                    if (!leanLocations[parentId]) {\n                      leanLocations[parentId] = parent;\n                    }\n                    parentId = get(parent, '.ID');\n                  } else {\n                    break;\n                  }\n                }\n              }\n            }\n          }\n\n          //  leanEpoch\n          if (Object.keys(leanLocations).length > 0) {\n            (leanEpoch as any). = { : leanLocations };\n          }\n\n          if (!leanState.[worldId]) leanState.[worldId] = {};\n          leanState.[worldId]. = {\n            : get(activeWorld, '.'),\n            : { [epochId]: leanEpoch },\n          };\n        }\n      }\n\n      // 3.2  ()\n      const worldChars = get(worldState.[worldId], '', {}) as { [id: string]: Character };\n      const leanChars: any = {};\n\n      // \n      const avatarId = get(worldState, '...ID');\n      const currentPlayer = (avatarId ? get(worldChars, avatarId) : playerFullData) as Character;\n\n      // \n      const sceneEntities = this.identifyCoreEntities(userInput, userId, worldState);\n      coreEntities.push(...sceneEntities);\n\n      const allActiveCharIds = Array.from(new Set(coreEntities));\n\n      for (const charId of allActiveCharIds) {\n        const char = get(worldChars, charId) || (charId === userId ? playerFullData : null);\n        if (char) {\n          // \n          if (\n            intent.actionType === 'combat' ||\n            intent.actionType === 'inventory' ||\n            char. === currentPlayer?.\n          ) {\n            leanChars[charId] = char; // \n          } else {\n            leanChars[charId] = {\n              // \n              : char.,\n              : char.,\n              : char.,\n              : char.,\n              : char.,\n              : char.,\n            };\n          }\n        }\n      }\n      leanState.[worldId]. = leanChars;\n\n      // 3.3  ()\n      const fullCausalNet = get(activeWorld, '', {});\n      leanState.[worldId]. = {};\n      const activeCharIds = Object.keys(leanChars);\n      if (!activeCharIds.includes(userId)) {\n        activeCharIds.push(userId); // \n      }\n\n      for (const subjectId of activeCharIds) {\n        const relations = get(fullCausalNet, subjectId);\n        if (relations) {\n          if (!leanState.[worldId].) leanState.[worldId]. = {};\n          leanState.[worldId].[subjectId] = {};\n          for (const objectId in relations) {\n            if (activeCharIds.includes(objectId)) {\n              leanState.[worldId].[subjectId][objectId] = relations[objectId];\n            }\n          }\n        }\n      }\n\n      // 3.4  ( intent )\n      const referencedDbIds = new Set<string>([...intent.explicitEntities.dbItems]);\n      const fullDatabase = get(activeWorld, '', {});\n      //  leanChars  playerLeanData  ()\n      [playerLeanData, ...Object.values(leanChars)].forEach((char: any) => {\n        if (char.) Object.keys(char.).forEach(id => referencedDbIds.add(id));\n        if (char.) char..forEach((id: string) => id && referencedDbIds.add(id));\n      });\n\n      if (referencedDbIds.size > 0 && fullDatabase) {\n        if (!leanState.[worldId].) leanState.[worldId]. = {};\n        for (const category in fullDatabase) {\n          if (category === '$meta') continue;\n          const categoryStore = get(fullDatabase, category, {});\n          for (const itemId of referencedDbIds) {\n            if (get(categoryStore, itemId)) {\n              if (!leanState.[worldId].[category]) leanState.[worldId].[category] = {};\n              leanState.[worldId].[category][itemId] = get(categoryStore, itemId);\n            }\n          }\n        }\n      }\n    }\n\n    // 4.  (Cross Context Query)\n    if (intent.crossContextQuery) {\n      const { worldId, items, locations } = intent.crossContextQuery;\n      const targetWorld = get(worldState., worldId);\n      if (targetWorld) {\n        if (!leanState.[worldId]) leanState.[worldId] = {};\n\n        // \n        if (items && items.length > 0) {\n          const targetDb = get(targetWorld, '', {});\n          if (!leanState.[worldId].) leanState.[worldId]. = {};\n          for (const category in targetDb) {\n            if (category === '$meta') continue;\n            const store = targetDb[category as keyof typeof targetDb] as any;\n            items.forEach(itemId => {\n              if (store[itemId]) {\n                if (!leanState.[worldId].[category]) leanState.[worldId].[category] = {};\n                leanState.[worldId].[category][itemId] = store[itemId];\n              }\n            });\n          }\n        }\n      }\n    }\n\n    console.log('[ContextService] Built Lean Context V4:', { stat_data: leanState });\n    return { stat_data: leanState };\n  }\n\n  private simplifyIdMap(map: any) {\n    if (!map) return {};\n    const simple: any = {};\n    for (const key in map) {\n      if (key === '$meta') continue;\n      //  ()\n      simple[key] = typeof map[key] === 'number' ? map[key] : true;\n    }\n    return simple;\n  }\n}\n\nexport const contextService = new ContextService();\n","import type { WorldDefinition } from '../../../types/world';\n\n/**\n * A robust, non-regex based parser for the custom YAML-like format.\n */\nexport function parseWorldLoreForMap(text: string): WorldDefinition | null {\n  if (!text) {\n    console.warn('[WorldMapParser] Received empty or null lore content.');\n    return null;\n  }\n\n  const automationRuleMarker = ':';\n  const startIndex = text.indexOf(automationRuleMarker);\n  if (startIndex === -1) {\n    console.error('[WorldMapParser] \":\" block not found in the lorebook entry.');\n    return null;\n  }\n\n  const yamlText = text.substring(startIndex);\n  const lines = yamlText.split('\\n').slice(1); // Skip the \":\" line\n\n  const root = {};\n  const stack: { level: number; obj: any }[] = [{ level: -1, obj: root }];\n\n  for (const line of lines) {\n    if (line.trim() === '') continue;\n\n    const indentMatch = line.match(/^\\s*/);\n    const indent = indentMatch ? indentMatch[0].length : 0;\n    const trimmedLine = line.trim();\n\n    while (stack.length > 1 && indent <= stack[stack.length - 1].level) {\n      stack.pop();\n    }\n\n    let parentObj = stack[stack.length - 1].obj;\n\n    if (trimmedLine.startsWith('- ')) {\n      const listItemContent = trimmedLine.substring(2).trim();\n\n      if (!Array.isArray(parentObj)) {\n        const grandParent = stack[stack.length - 2].obj;\n        const lastKey = Object.keys(grandParent).pop();\n        if (lastKey && grandParent[lastKey] === parentObj) {\n          parentObj = [];\n          grandParent[lastKey] = parentObj;\n          stack[stack.length - 1].obj = parentObj;\n        } else {\n          continue;\n        }\n      }\n\n      const separatorIndex = listItemContent.indexOf(':');\n      if (separatorIndex === -1) {\n        parentObj.push(parseValue(listItemContent));\n      } else {\n        const newListItem = {};\n        parentObj.push(newListItem);\n        stack.push({ level: indent, obj: newListItem });\n        processKeyValue(listItemContent, newListItem, indent, stack);\n      }\n    } else {\n      processKeyValue(trimmedLine, parentObj, indent, stack);\n    }\n  }\n\n  return root as WorldDefinition;\n}\n\nfunction processKeyValue(line: string, parent: any, indent: number, stack: any[]) {\n  const separatorIndex = line.indexOf(':');\n  if (separatorIndex > -1) {\n    const key = line.substring(0, separatorIndex).trim();\n    const valueStr = line.substring(separatorIndex + 1).trim();\n\n    if (valueStr === '') {\n      const newChild = {};\n      parent[key] = newChild;\n      stack.push({ level: indent, obj: newChild });\n    } else if (valueStr.startsWith('{') && valueStr.endsWith('}')) {\n      const newObj = {};\n      parent[key] = newObj;\n      const objContent = valueStr.slice(1, -1).trim();\n      const pairs = objContent.split(',').map(p => p.trim());\n      for (const pair of pairs) {\n        processKeyValue(pair, newObj, indent + 2, stack);\n      }\n    } else {\n      parent[key] = parseValue(valueStr);\n    }\n  }\n}\n\nfunction parseValue(value: string): any {\n  const trimmed = value.trim();\n\n  if (trimmed.startsWith('\"') && trimmed.endsWith('\"')) {\n    const inner = trimmed.slice(1, -1);\n    if (inner.startsWith('[') && inner.endsWith(']')) {\n      return parseValue(inner);\n    }\n    return inner;\n  }\n\n  if (trimmed.startsWith('[') && trimmed.endsWith(']')) {\n    try {\n      const content = trimmed.slice(1, -1).trim();\n      const parts = [];\n      let buffer = '';\n      let inQuotes = false;\n      let bracketLevel = 0;\n\n      for (let i = 0; i < content.length; i++) {\n        const char = content[i];\n        if (char === \"'\" || char === '\"') {\n          inQuotes = !inQuotes;\n        }\n        if (!inQuotes) {\n          if (char === '[') bracketLevel++;\n          if (char === ']') bracketLevel--;\n          if (char === ',' && bracketLevel === 0) {\n            parts.push(buffer.trim());\n            buffer = '';\n            continue;\n          }\n        }\n        buffer += char;\n      }\n      if (buffer) {\n        parts.push(buffer.trim());\n      }\n\n      return parts.map(part => parseValue(part));\n    } catch (e) {\n      // Fallback\n    }\n  }\n\n  if (trimmed.toLowerCase() === 'true') return true;\n  if (trimmed.toLowerCase() === 'false') return false;\n  if (trimmed === 'null') return null;\n  if (trimmed !== '' && !isNaN(Number(trimmed)) && !trimmed.includes('x')) {\n    return Number(trimmed);\n  }\n\n  return trimmed;\n}\n","//  TavernHelper API\ndeclare const TavernHelper: any;\n\nconst LOREBOOK_NAME = '-';\nlet entriesCache: any[] | null = null;\n\nasync function getEntries(forceRefresh = false) {\n  if (entriesCache && !forceRefresh) {\n    return entriesCache;\n  }\n  try {\n    const entries = await TavernHelper.getLorebookEntries(LOREBOOK_NAME);\n    if (!entries) {\n      console.error(`[LorebookService]  \"${LOREBOOK_NAME}\" `);\n      entriesCache = null;\n      return null;\n    }\n    entriesCache = entries;\n    return entries;\n  } catch (error) {\n    console.error(`[LorebookService]  getLorebookEntries :`, error);\n    return null;\n  }\n}\n\nfunction findEntryByComment(comment: string): any | null {\n  if (!entriesCache) {\n    console.warn('[LorebookService] findEntryByComment called before cache was populated.');\n    return null;\n  }\n  return entriesCache.find((e: any) => e.comment === comment) || null;\n}\n\nasync function readFromLorebook(entryName: string, forceRefresh = false): Promise<string | null> {\n  const entries = await getEntries(forceRefresh);\n  if (!entries) return null;\n  const entry = entries.find((e: any) => e.comment === entryName || e.name === entryName);\n  return entry ? entry.content : null;\n}\n\nasync function writeToLorebook(\n  entryName: string,\n  content: string,\n  options: { isEnabled: boolean; keys: string[] } = { isEnabled: true, keys: [] },\n) {\n  console.log(`[Roo Debug] Lorebook: Preparing to write/create entry: \"${entryName}\".`);\n  const allEntries = await getEntries();\n  if (!allEntries) return;\n\n  const targetEntry = allEntries.find((e: any) => e.comment === entryName || e.name === entryName);\n\n  try {\n    if (targetEntry) {\n      // ---  ---\n      console.log(`[Roo Debug] Lorebook: Entry \"${entryName}\" exists. Updating with setLorebookEntries.`);\n      await TavernHelper.setLorebookEntries(LOREBOOK_NAME, [\n        { uid: targetEntry.uid, content: content, enabled: options.isEnabled },\n      ]);\n    } else {\n      // ---  ( UpdateVariable5.html) ---\n      console.log(`[Roo Debug] Lorebook: Entry \"${entryName}\" does not exist. Creating with createLorebookEntries.`);\n\n      const baseKey = entryName.replace(/\\(\\d+\\)$/, '');\n      const baseEntryTemplate = allEntries.find((entry: any) => entry.comment === baseKey || entry.name === baseKey);\n\n      // \n      const newEntryData: any = {\n        comment: entryName,\n        content: content,\n        keys: [entryName],\n        enabled: options.isEnabled,\n        position: 'before_character_definition',\n        order: 100,\n      };\n\n      // \n      if (baseEntryTemplate) {\n        Object.assign(newEntryData, {\n          keys: [...(baseEntryTemplate.keys || []), entryName],\n          selective: baseEntryTemplate.selective,\n          constant: baseEntryTemplate.constant,\n          position: baseEntryTemplate.position,\n          order: baseEntryTemplate.order,\n          case_sensitive: baseEntryTemplate.case_sensitive,\n        });\n      }\n\n      console.log(\n        `[Roo Debug] Lorebook: Calling createLorebookEntries for \"${entryName}\" with payload:`,\n        JSON.stringify(newEntryData),\n      );\n      await TavernHelper.createLorebookEntries(LOREBOOK_NAME, [newEntryData]);\n    }\n    console.log(`[LorebookService] API call for \"${entryName}\" completed successfully.`);\n    entriesCache = null; // \n  } catch (error) {\n    console.error(`[LorebookService]  \"${entryName}\" :`, error);\n  }\n}\n\nasync function appendToEntry(entryName: string, newContent: string, separator = '\\n\\n---\\n\\n'): Promise<void> {\n  console.log(`[Roo Debug] Lorebook: Appending to entry \"${entryName}\".`);\n  try {\n    const existingContent = await readFromLorebook(entryName);\n    const content = existingContent ? `${existingContent}${separator}${newContent}` : newContent;\n    // `writeToLorebook` \n    await writeToLorebook(entryName, content);\n  } catch (error) {\n    console.error(`[LorebookService]  \"${entryName}\" :`, error);\n  }\n}\n\nimport { parseWorldLoreForMap } from '../modules/world-map/services/WorldMapParser';\nimport type { Epoch, WorldDefinition } from '../types/world';\n\nasync function loadAndParseWorldData(worldName = ''): Promise<Epoch | null> {\n  try {\n    const content = await readFromLorebook(worldName);\n    if (!content) {\n      console.warn(`[LorebookService]  \"${worldName}\" `);\n      return null;\n    }\n\n    const worldData = parseWorldLoreForMap(content) as WorldDefinition | null;\n\n    if (worldData && worldData. && worldData.) {\n      // ID\n      const currentEpochId = worldData..ID;\n      if (currentEpochId && worldData.[currentEpochId]) {\n        return worldData.[currentEpochId];\n      }\n      // \n      const firstPlayableEpoch = Object.values(worldData.).find(epoch => epoch.);\n      if (firstPlayableEpoch) {\n        return firstPlayableEpoch;\n      }\n    }\n\n    console.warn(`[LorebookService]  \"${worldName}\" `);\n    return null;\n  } catch (error) {\n    console.error(`[LorebookService]  \"${worldName}\" :`, error);\n    return null;\n  }\n}\n\nexport const lorebookService = {\n  getEntries,\n  readFromLorebook,\n  writeToLorebook,\n  appendToEntry,\n  findEntryByComment,\n  setEntryEnabled,\n  loadAndParseWorldData, // \n};\n\nasync function setEntryEnabled(entryName: string, isEnabled: boolean): Promise<void> {\n  console.log(`[LorebookService] Setting entry \"${entryName}\" enabled status to: ${isEnabled}`);\n  try {\n    const allEntries = await getEntries();\n    if (!allEntries) return;\n\n    const targetEntry = allEntries.find((e: any) => e.comment === entryName || e.name === entryName);\n\n    if (targetEntry) {\n      // [PATCH] \n      const updatedEntry = { ...targetEntry, enabled: isEnabled };\n      await TavernHelper.setLorebookEntries(LOREBOOK_NAME, [updatedEntry]);\n      console.log(`[LorebookService] Successfully set \"${entryName}\" enabled=${isEnabled}.`);\n    } else {\n      // \n      console.warn(`[LorebookService] setEntryEnabled: Entry \"${entryName}\" not found. Skipping.`);\n    }\n  } catch (error) {\n    console.error(`[LorebookService]  \"${entryName}\" :`, error);\n  }\n}\n","type EventCallback = (...args: any[]) => void;\n\nclass EventBus {\n  private events: Record<string, EventCallback[]> = {};\n\n  on(event: string, callback: EventCallback): void {\n    if (!this.events[event]) {\n      this.events[event] = [];\n    }\n    this.events[event].push(callback);\n  }\n\n  off(event: string, callback: EventCallback): void {\n    if (!this.events[event]) return;\n    this.events[event] = this.events[event].filter(cb => cb !== callback);\n  }\n\n  emit(event: string, ...args: any[]): void {\n    if (!this.events[event]) return;\n    this.events[event].forEach(callback => {\n      try {\n        callback(...args);\n      } catch (e) {\n        console.error(`Error in event handler for ${event}:`, e);\n      }\n    });\n  }\n}\n\nexport const eventBus = new EventBus();\n","import { eventBus } from './EventBus';\nimport { lorebookService } from './LorebookService';\nimport type { WorldLogEntry } from '../types';\n\nclass MemoryService {\n  private readonly INSTANT_MEMORY_KEY = '[]';\n  private readonly SHORT_TERM_MEMORY_KEY = '[]';\n  private readonly LONG_TERM_MEMORY_KEY = '[]';\n\n  // \n  private config = {\n    instantMemoryCount: 15,\n    shortTermMemoryCount: 30, // \n    longTermMemoryCount: 60, // \n  };\n\n  /**\n   * \n   */\n  public async updateMemory(worldLog: WorldLogEntry[]): Promise<void> {\n    console.log('[MemoryService] Updating all memory tiers...');\n    try {\n      // \n      await this.updateInstantMemory(worldLog);\n      await this.updateShortTermMemory(worldLog);\n      await this.updateLongTermMemory(worldLog);\n      console.log('[MemoryService] All memory tiers updated successfully.');\n      eventBus.emit('memoryUpdated'); // UI\n    } catch (error) {\n      console.error('[MemoryService] Failed to update memory tiers:', error);\n    }\n  }\n\n  /**\n   *  ()\n   */\n  public async updateInstantMemory(worldLog: WorldLogEntry[]): Promise<void> {\n    const logs = worldLog.slice(-this.config.instantMemoryCount);\n    if (logs.length === 0) {\n      await this.writeMemory(this.INSTANT_MEMORY_KEY, '');\n      return;\n    }\n\n    const newContent = logs\n      .map(log => {\n        //  key|value \n        return [\n          `|${log.}`,\n          `|${log.}`,\n          `|${log.}`,\n          `|${log.}`,\n          `|${log.}`,\n          `|${log.}`,\n          `|${Array.isArray(log.) ? log..join(', ') : log.}`,\n          `|${log.}`,\n          `|${log.}`,\n          `|${log.}`,\n        ].join('\\n');\n      })\n      .join('\\n\\n---\\n\\n');\n\n    // \n    const existingContent = await lorebookService.readFromLorebook(this.INSTANT_MEMORY_KEY);\n    if (existingContent !== newContent.trim()) {\n      await this.writeMemory(this.INSTANT_MEMORY_KEY, newContent.trim());\n      console.log('[MemoryService] Instant memory updated.');\n    } else {\n      console.log('[MemoryService] Instant memory is already up-to-date. Skipping write.');\n    }\n  }\n\n  /**\n   *  ()\n   */\n  public async updateShortTermMemory(worldLog: WorldLogEntry[]): Promise<void> {\n    const logs = worldLog.slice(-this.config.shortTermMemoryCount);\n    if (logs.length === 0) {\n      await this.writeMemory(this.SHORT_TERM_MEMORY_KEY, '');\n      return;\n    }\n\n    const newContent = logs\n      .map(log => {\n        // key|value\n        return [\n          `|${log.}`,\n          `|${log.}`,\n          `|${log.}`,\n          `|${log.}`,\n          `|${log.}`,\n          `|${log.}`,\n          `|${log.}`,\n        ].join('\\n');\n      })\n      .join('\\n\\n---\\n\\n');\n\n    const existingContent = await lorebookService.readFromLorebook(this.SHORT_TERM_MEMORY_KEY);\n    if (existingContent !== newContent.trim()) {\n      await this.writeMemory(this.SHORT_TERM_MEMORY_KEY, newContent.trim());\n      console.log('[MemoryService] Short-term memory updated.');\n    } else {\n      console.log('[MemoryService] Short-term memory is already up-to-date. Skipping write.');\n    }\n  }\n\n  /**\n   *  ()\n   */\n  public async updateLongTermMemory(worldLog: WorldLogEntry[]): Promise<void> {\n    const logs = worldLog.slice(-this.config.longTermMemoryCount);\n    if (logs.length === 0) {\n      await this.writeMemory(this.LONG_TERM_MEMORY_KEY, '');\n      return;\n    }\n\n    const newContent = logs\n      .map(log => {\n        return [\n          `|${log.}`,\n          `|${log.}`,\n          `|${log.}`,\n          `|${log.}`,\n          `|${(log as any). || ''}`,\n        ].join('\\n');\n      })\n      .join('\\n\\n---\\n\\n');\n\n    const existingContent = await lorebookService.readFromLorebook(this.LONG_TERM_MEMORY_KEY);\n    if (existingContent !== newContent.trim()) {\n      await this.writeMemory(this.LONG_TERM_MEMORY_KEY, newContent.trim());\n      console.log('[MemoryService] Long-term memory updated.');\n    } else {\n      console.log('[MemoryService] Long-term memory is already up-to-date. Skipping write.');\n    }\n  }\n\n  /**\n   * \n   * @param key \n   * @param content \n   */\n  private async writeMemory(key: string, content: string): Promise<void> {\n    await lorebookService.writeToLorebook(key, content, {\n      isEnabled: true,\n      keys: [key],\n    });\n  }\n\n  public getConfig() {\n    return this.config;\n  }\n\n  public setConfig(newConfig: Partial<typeof this.config>) {\n    this.config = { ...this.config, ...newConfig };\n    // localStorage\n    console.log('[MemoryService] Config updated:', this.config);\n  }\n}\n\nexport const memoryService = new MemoryService();\n","import { reactive } from 'vue';\n\nexport type NotificationType = 'info' | 'success' | 'warning' | 'error';\n\nexport interface Notification {\n  id: number;\n  title: string;\n  message: string;\n  type: NotificationType;\n}\n\nconst state = reactive({\n  notifications: [] as Notification[],\n});\n\nlet nextId = 0;\n\nconst actions = {\n  show(title: string, message: string, type: NotificationType = 'info', duration: number = 4000) {\n    const id = nextId++;\n    state.notifications.push({ id, title, message, type });\n\n    if (duration > 0) {\n      setTimeout(() => {\n        this.hide(id);\n      }, duration);\n    }\n  },\n\n  hide(id: number) {\n    const index = state.notifications.findIndex(n => n.id === id);\n    if (index !== -1) {\n      state.notifications.splice(index, 1);\n    }\n  },\n\n  success(title: string, message: string, duration: number = 4000) {\n    this.show(title, message, 'success', duration);\n  },\n\n  info(title: string, message: string, duration: number = 4000) {\n    this.show(title, message, 'info', duration);\n  },\n\n  warn(title: string, message: string, duration: number = 5000) {\n    this.show(title, message, 'warning', duration);\n  },\n\n  error(title: string, message: string, duration: number = 7000) {\n    this.show(title, message, 'error', duration);\n  },\n};\n\nexport const notificationState = state;\nexport const notificationService = actions;\n","import type { saveLoadService } from './saveLoadService';\nimport type { inputModalActions, inputModalState } from './InputModalService';\nimport type { store, actions } from '../store';\n\n// \nexport type SaveLoadService = typeof saveLoadService;\nexport type InputModalActions = typeof inputModalActions;\nexport type InputModalState = typeof inputModalState;\nexport type Store = typeof store;\nexport type Actions = typeof actions;\n\ninterface ServiceRegistry {\n  saveLoadService: SaveLoadService;\n  inputModalActions: InputModalActions;\n  inputModalState: InputModalState;\n  store: Store;\n  actions: Actions;\n}\n\nconst registry: Partial<ServiceRegistry> = {};\n\nexport const serviceLocator = {\n  register<K extends keyof ServiceRegistry>(key: K, instance: ServiceRegistry[K]): void {\n    registry[key] = instance;\n  },\n  get<K extends keyof ServiceRegistry>(key: K): NonNullable<ServiceRegistry[K]> {\n    const instance = registry[key];\n    if (!instance) {\n      throw new Error(`Service with key \"${key}\" has not been registered.`);\n    }\n    return instance as NonNullable<ServiceRegistry[K]>;\n  },\n};\n","// API\ndeclare const TavernHelper: any;\ndeclare const eventEmit: any;\ndeclare const getChatMessages: (id: string) => Promise<any[]>;\ndeclare const getCurrentMessageId: () => string;\n\nclass TavernService {\n  /**\n   * Tavern\n   */\n  async fetchTavernData() {\n    console.debug('Fetching data from Tavern...');\n    const messages = await getChatMessages(getCurrentMessageId());\n    console.debug('Messages received:', messages);\n    return messages;\n  }\n\n  /**\n   * AI\n   * @param prompt - AI\n   * @param variables - \n   */\n  async generateAiResponse(prompt: string, variables?: any): Promise<string> {\n    const generateConfig: any = {\n      injects: [{ role: 'user', content: prompt, position: 'in_chat', should_scan: true }],\n      should_stream: false,\n    };\n\n    if (variables) {\n      generateConfig.variables = variables;\n    }\n\n    const aiResponse = await TavernHelper.generate(generateConfig);\n    if (typeof aiResponse !== 'string') {\n      throw new Error('AI');\n    }\n    return aiResponse;\n  }\n\n  /**\n   * MVU\n   * @param script - MVU\n   * @param oldVariables - \n   */\n  async invokeMvuScript(script: string, oldVariables: any): Promise<any> {\n    const inputData: any = { old_variables: oldVariables };\n\n    await eventEmit('mag_invoke_mvu', script, inputData);\n    return inputData.new_variables;\n  }\n}\n\nexport const tavernService = new TavernService();\n","import { lorebookService } from './LorebookService';\n\n// \nexport type WorkflowState = 'NORMAL' | 'CREATION' | 'IDENTITY';\n\n// CoT\n// \nconst COT_FILES: Record<WorkflowState, string[]> = {\n  NORMAL: ['cotcot'],\n  CREATION: ['cotcot'],\n  IDENTITY: ['cotcot'],\n};\n\nclass WorkflowService {\n  private currentState: WorkflowState = 'NORMAL';\n  private narrativeCache: string | null = null; //  <gametxt>\n  private updateScriptCache: string | null = null; //  <UpdateVariable>\n  private preserveMode: 'none' | 'gametxt' | 'full' = 'none';\n\n  constructor() {\n    // CoT\n    this.switchTo('NORMAL');\n  }\n\n  /**\n   * \n   */\n  public getCurrentState(): WorkflowState {\n    return this.currentState;\n  }\n\n  /**\n   * CoT/\n   * @param newState \n   */\n  public async switchTo(newState: WorkflowState, force: boolean = false) {\n    if (this.currentState === newState && !force) {\n      return; // \n    }\n\n    console.log(`[WorkflowService] Switching from ${this.currentState} to ${newState} (Forced: ${force})`);\n\n    const allCots = Object.values(COT_FILES).flat();\n    const cotsToEnable = COT_FILES[newState];\n\n    // CoT\n    for (const cotName of allCots) {\n      const shouldBeEnabled = cotsToEnable.includes(cotName);\n      await lorebookService.setEntryEnabled(cotName, shouldBeEnabled);\n    }\n\n    this.currentState = newState;\n    console.log(`[WorkflowService] Switched to ${newState}. Enabled CoTs: ${cotsToEnable.join(', ')}`);\n  }\n\n  /**\n   * \n   * @param narrative  <gametxt> \n   */\n  public cacheNarrative(narrative: string) {\n    this.narrativeCache = narrative;\n    console.log('[WorkflowService] Narrative cached.');\n  }\n\n  /**\n   * \n   * @returns  <gametxt>  null\n   */\n  public popNarrative(): string | null {\n    const narrative = this.narrativeCache;\n    this.narrativeCache = null;\n    if (narrative) {\n      console.log('[WorkflowService] Popped cached narrative.');\n    }\n    return narrative;\n  }\n\n  /**\n   * \n   */\n  public cacheUpdateScript(script: string) {\n    this.updateScriptCache = script;\n    console.log('[WorkflowService] Update script cached.');\n  }\n\n  /**\n   * \n   */\n  public popUpdateScript(): string | null {\n    const script = this.updateScriptCache;\n    this.updateScriptCache = null;\n    if (script) {\n      console.log('[WorkflowService] Popped cached update script.');\n    }\n    return script;\n  }\n\n  /**\n   * AI\n   * @param mode 'gametxt' , 'full' \n   */\n  public setPreserveMode(mode: 'none' | 'gametxt' | 'full') {\n    this.preserveMode = mode;\n    console.log(`[WorkflowService] Preserve mode set to: ${mode}`);\n  }\n\n  /**\n   * \n   * @returns \n   */\n  public popPreservedContent(): string {\n    let content = '';\n\n    if (this.preserveMode === 'gametxt' || this.preserveMode === 'full') {\n      if (this.narrativeCache) {\n        content += `\\n<gametxt>${this.narrativeCache}</gametxt>`;\n        console.log('[WorkflowService] Popped cached narrative for appending.');\n      }\n    }\n\n    if (this.preserveMode === 'full') {\n      if (this.updateScriptCache) {\n        content += `\\n<UpdateVariable>${this.updateScriptCache}</UpdateVariable>`;\n        console.log('[WorkflowService] Popped cached update script for appending.');\n      }\n    }\n\n    // \n    this.narrativeCache = null;\n    this.updateScriptCache = null;\n    this.preserveMode = 'none';\n\n    if (content) {\n      console.log('[WorkflowService] Final content to append length:', content.length);\n    }\n\n    return content;\n  }\n}\n\nexport const workflowService = new WorkflowService();\n","import { get } from 'lodash';\nimport { AppState, World, SpatialEntity } from '../types';\nimport {\n  EvolutionaryPressure,\n  InformationPropagationRule,\n  InformationRipple,\n  StressReactionEvent,\n} from '../types/evolution';\nimport { entityIndexService } from './EntityIndexService';\n\n/**\n * \n * \n * 1. \n * 2. \n * 3. \n */\nclass WorldEvolutionService {\n  /**\n   * \n   */\n  private informationDelayQueue: InformationRipple[] = [];\n\n  /**\n   * \n   * @param worldState - \n   * @returns \n   */\n  public applyPressure(worldState: AppState['worldState']): EvolutionaryPressure[] {\n    const pressures: EvolutionaryPressure[] = [];\n    if (!worldState?.) return pressures;\n\n    for (const world of Object.values(worldState.)) {\n      // 1. : NPC\n      const characters = get(world, '', {}) as { [id: string]: Character };\n      for (const charId in characters) {\n        if (charId.startsWith('sample_')) continue; // NPC\n        const char = characters[charId] as Character;\n        if (!char || !('' in char)) continue;\n\n        const desire = get(char, '..');\n        const powerLevel = get(char, '.', 0);\n        const spirit = get(char, '.', 0);\n\n        // 1\n        const isAmbitious = desire && Object.values(desire).some((g: any) => g. === '');\n\n        // 2\n        const isPowerful = powerLevel > 100 || spirit > 8; // \n\n        if (isAmbitious || isPowerful) {\n          const firstGoal = isAmbitious\n            ? (Object.values(desire)[0] as any)\n            : { : '', : '' };\n          let intensity = spirit * 5 + get(char, '..', 0);\n          if (isPowerful && !isAmbitious) {\n            intensity = powerLevel / 10; // \n          }\n\n          pressures.push({\n            type: isAmbitious ? 'desire' : 'authority', // \n            source: { type: 'npc', id: charId },\n            intensity,\n            description: `[${char.}] `,\n            intent: firstGoal. || '',\n          });\n        }\n      }\n    }\n\n    console.log(`[EvoSys-Pressure] Identified ${pressures.length} evolutionary pressures.`, pressures);\n    return pressures;\n  }\n\n  /**\n   * \n   * @param pressures - \n   * @param worldState - \n   * @returns \n   */\n  public simulateReactions(\n    pressures: EvolutionaryPressure[],\n    worldState: AppState['worldState'],\n  ): StressReactionEvent[] {\n    const reactions: StressReactionEvent[] = [];\n    if (!worldState) return reactions;\n\n    console.log(`[EvoSys-Reaction] Simulating reactions for ${pressures.length} pressures...`);\n    for (const pressure of pressures) {\n      if (pressure.intensity > 50) {\n        // \n        const sourceChar = get(\n          worldState,\n          `.${entityIndexService.findById(pressure.source.id)?.worldId}..${pressure.source.id}`,\n        );\n        if (sourceChar) {\n          const newEvent: StressReactionEvent = {\n            id: `event_${pressure.source.id}_${Date.now()}`,\n            timestamp: Date.now(), // \n            locationId: sourceChar.,\n            type: 'personal',\n            description: `${sourceChar.} ${pressure.intent}`,\n            participants: [pressure.source.id],\n            sourcePressure: pressure,\n          };\n          reactions.push(newEvent);\n          console.log(`[EvoSys-Reaction] Generated event:`, newEvent);\n        }\n      }\n    }\n\n    return reactions;\n  }\n\n  /**\n   * \n   * @param event - \n   * @param worldState - \n   */\n  public propagateRipples(event: StressReactionEvent, worldState: AppState['worldState']) {\n    if (!worldState?.) return;\n\n    const worldId = event.locationId ? entityIndexService.findById(event.locationId)?.worldId : null;\n    if (!worldId) return;\n\n    const world = worldState.[worldId];\n    if (!world) return;\n\n    // 1.  InformationRipple\n    // \n    const ripple: Omit<InformationRipple, 'arrivalTimestamp'> = {\n      id: `ripple_${event.id}_${Math.random().toString(36).substring(2, 6)}`,\n      sourceEventId: event.id,\n      type: 'rumor',\n      content: `${entityIndexService.findById(event.locationId)?.name || ''}`,\n      sphereOfInfluence: { locationIds: [], factionIds: [] },\n      decayRate: 0.1,\n      distortion: 0,\n    };\n\n    // 2. \n    const propagationRules = get(world, '..', []) as InformationPropagationRule[];\n    const rule = propagationRules.find(r => r.medium === ripple.type) || { baseSpeed: 100 }; // \n\n    // 3. \n    // \n    // \n    const distance = 1000; // 1000\n    const delayDays = distance / rule.baseSpeed;\n    const delayMilliseconds = delayDays * 24 * 60 * 60 * 1000;\n    const arrivalTimestamp = event.timestamp + delayMilliseconds;\n\n    // 4.  informationDelayQueue\n    const newRipple: InformationRipple = { ...ripple, arrivalTimestamp };\n    this.informationDelayQueue.push(newRipple);\n    console.log(\n      `[EvoSys-Ripple] New ripple queued. Distance: ${distance}km. Arrival in ${delayDays.toFixed(1)} days.`,\n      newRipple,\n    );\n    console.log('[EvoSys-Queue] Current Information Delay Queue:', this.informationDelayQueue);\n  }\n\n  /**\n   * \n   * @param currentTime - \n   * @returns \n   */\n  public getAvailableRipples(currentTime: number): InformationRipple[] {\n    const availableRipples: InformationRipple[] = [];\n    const remainingRipples: InformationRipple[] = [];\n\n    for (const ripple of this.informationDelayQueue) {\n      if (ripple.arrivalTimestamp <= currentTime) {\n        availableRipples.push(ripple);\n      } else {\n        remainingRipples.push(ripple);\n      }\n    }\n\n    // \n    this.informationDelayQueue = remainingRipples;\n\n    if (availableRipples.length > 0) {\n      console.log(\n        `[EvoSys-Gravity] ${availableRipples.length} ripples have arrived and are now available as 'narrative material'.`,\n        availableRipples,\n      );\n    }\n\n    return availableRipples;\n  }\n\n  /**\n   * \n   * @param locationIdA - ID\n   * @param locationIdB - ID\n   * @param world - \n   * @returns null\n   */\n  private calculateDistance(locationIdA: string, locationIdB: string, world: World): number | null {\n    const locationA = entityIndexService.findById(locationIdA);\n    const locationB = entityIndexService.findById(locationIdB);\n\n    if (!locationA || !locationB || !world) return null;\n\n    // \n    // A*\n    if (locationA.parentId === locationB.parentId && locationA.parentId !== 'WORLD_ORIGIN') {\n      const epochId = locationA.epochId || get(world, '..ID');\n      if (!epochId) return null;\n      const parentEntity = get(world, `..${epochId}...${locationA.parentId}`) as SpatialEntity;\n      const locAData = get(world, `..${epochId}...${locationIdA}`) as SpatialEntity;\n      const locBData = get(world, `..${epochId}...${locationIdB}`) as SpatialEntity;\n\n      if (locAData?. && locBData?.) {\n        // \n        return (locAData..?.[0] || 0) + (locBData..?.[0] || 0);\n      }\n    }\n\n    // /\n    return 1000;\n  }\n}\n\nexport const worldEvolutionService = new WorldEvolutionService();\n","import { reactive, watch } from 'vue';\nimport { get } from 'lodash';\nimport type { AppState, Character } from '../types';\n\nexport const USER_ID = '';\n\n//  AppState \nconst initialState: AppState = {\n  isReady: false,\n  character: null,\n  worldState: null,\n  userId: USER_ID,\n  mainWorldNarrative: '...',\n  avatarWorldNarrative: '',\n  activeView: 'mainWorld',\n  selectedWorldForReincarnation: null,\n  reincarnationWorldOptions: [],\n  reincarnationAvatarOptions: [],\n  worldLog: [],\n  settlementData: null,\n  newWorldsAvailable: false, // \n  isGenerating: false,\n  generationError: null as string | null,\n  lastSubmittedAction: null,\n  lastGeneratedPatch: null,\n};\n\n//  reactive  store\nexport const store = reactive<AppState & { getItemNameById: (id: string) => string | null }>({\n  ...initialState,\n  getItemNameById(id: string): string | null {\n    const activeWorldId =\n      this.activeView === 'mainWorld'\n        ? get(this.worldState, '..')\n        : get(this.worldState, '...ID')\n          ? get(this.worldState, '...ID')\n          : null;\n\n    if (!activeWorldId) return null;\n\n    const database = get(this.worldState, `.${activeWorldId}.`);\n    if (!database) return null;\n\n    for (const category in database) {\n      const categoryStore = (database as any)[category];\n      if (categoryStore && categoryStore[id]) {\n        return categoryStore[id]. || null;\n      }\n    }\n    return null;\n  },\n});\n\n//  watch \nwatch(\n  () => store.worldState,\n  (newState, oldState) => {\n    console.log('[State Watch] worldState changed.');\n    if (newState) {\n      store.character = get(newState, '.', null);\n    } else {\n      store.character = null;\n    }\n  },\n  { deep: true },\n);\n\nwatch(\n  () => store.isReady,\n  (isReady: boolean) => {\n    console.log(`[State Watch] Store is now ${isReady ? 'ready' : 'not ready'}.`);\n  },\n);\n","import { get } from 'lodash';\nimport { computed, ComputedRef } from 'vue';\nimport { lorebookService } from '../services/LorebookService';\nimport { Character } from '../types';\nimport { store } from './state';\n\n// --- Core Getters ---\n\n/**\n * \n */\nexport const playerCharacter: ComputedRef<Character | null> = computed(() => {\n  if (!store.worldState) return null;\n  return get(store.worldState, '.', null);\n});\n\n/**\n * \n */\nexport const currentAvatar: ComputedRef<Character | null> = computed(() => {\n  if (!store.worldState?.?. || !store.worldState?.) return null;\n\n  // 1. ID\n  const avatarId = get(store.worldState.., '.ID');\n\n  // 2. ID\n  if (!avatarId) {\n    return null;\n  }\n\n  // 3. \n  for (const worldId in store.worldState.) {\n    const character = get(store.worldState.[worldId], `.${avatarId}`);\n    if (character) {\n      return character;\n    }\n  }\n  return null;\n});\n\n/**\n * \n */\nexport const simulator: ComputedRef<any> = computed(() => {\n  return store.worldState?..;\n});\n\n/**\n * \n */\nexport const mainWorldNarrative = computed(() => store.mainWorldNarrative);\n\n/**\n * \n */\nexport const avatarWorldNarrative = computed(() => store.avatarWorldNarrative);\n\n/**\n * \n * @param path - lodash get-style path to the variable\n */\nexport const getVariable = (path: string, defaultValue: any = null) => {\n  return computed(() => get(store.worldState, path, defaultValue));\n};\n\n// --- Player Character Getters ---\n\nexport const soulEssence = computed(() => {\n  if (!playerCharacter.value) return 0;\n  return get(playerCharacter.value, '', 0);\n});\n\nexport const daoHeart = computed(() => {\n  if (!playerCharacter.value) return 0;\n  return get(playerCharacter.value, '', 0);\n});\n\nexport const reincarnationImprints = computed(() => {\n  const character = playerCharacter.value;\n  const world = mainWorld.value;\n  const database = world?.;\n\n  if (!character || !database?.) {\n    return [];\n  }\n\n  const unlockedImprints = get(character, '', {}) as Record<string, boolean>;\n  const imprints = [];\n\n  for (const imprintId in unlockedImprints) {\n    if (unlockedImprints[imprintId] && database.[imprintId]) {\n      imprints.push({\n        ...(database. as any)[imprintId],\n        ID: imprintId,\n      });\n    }\n  }\n  return imprints;\n});\n\nexport const playerSkills = computed(() => {\n  const character = playerCharacter.value;\n  const world = mainWorld.value;\n  const database = world?. as any;\n\n  if (!character || !database?.) {\n    return [];\n  }\n\n  const playerArts = get(character, '', {}) as Record<string, { : number; : number }>;\n  const skills = [];\n\n  for (const artId in playerArts) {\n    const artData = playerArts[artId];\n    const artTemplate = (database. as any)[artId];\n\n    if (artTemplate && artTemplate.) {\n      // Convert  object to array, filtering out metadata\n      const levelSystem = Object.values(artTemplate.).filter(\n        (l: any) => typeof l === 'object' && l !== null && '' in l,\n      );\n\n      const currentLevelInfo = levelSystem.find((l: any) => l. === artData.) as\n        | { : number; : string }\n        | undefined;\n      const nextLevelInfo = levelSystem.find((l: any) => l. === artData. + 1) as\n        | { : number }\n        | undefined;\n\n      // Find associated active skills\n      const associatedSkills = [];\n      if (database.) {\n        for (const skillId in database.) {\n          const skillTemplate = (database. as any)[skillId];\n          if (skillTemplate. === artId) {\n            associatedSkills.push(skillTemplate);\n          }\n        }\n      }\n\n      skills.push({\n        id: artId,\n        name: artTemplate.,\n        description: artTemplate.,\n        level: artData.,\n        exp: artData.,\n        expToNextLevel: nextLevelInfo ? nextLevelInfo. : currentLevelInfo?. || 'MAX',\n        title: currentLevelInfo ? currentLevelInfo. : '',\n        associatedSkills,\n      });\n    }\n  }\n\n  return skills;\n});\n\n// ---  Getter ---\n\nconst createInventoryGetter = (characterRef: ComputedRef<Character | null>) => {\n  return computed(() => {\n    const character = characterRef.value;\n    const world = store.activeView === 'mainWorld' ? mainWorld.value : avatarWorld.value;\n    const database = world?. as any;\n\n    if (!character || !database) {\n      return [];\n    }\n\n    const backpack = get(character, '', {});\n    const items = [];\n\n    for (const itemId in backpack) {\n      const quantity = (backpack as any)[itemId];\n      if (quantity <= 0) continue;\n\n      // \n      let itemDetails = null;\n      for (const category in database) {\n        const categoryStore = (database as any)[category];\n        if (categoryStore && categoryStore[itemId]) {\n          itemDetails = categoryStore[itemId];\n          break;\n        }\n      }\n\n      if (itemDetails) {\n        items.push({\n          ...itemDetails,\n          ID: itemId, // ID\n          : quantity,\n        });\n      }\n    }\n    return items;\n  });\n};\n\nexport const playerInventory = createInventoryGetter(playerCharacter);\nexport const avatarInventory = createInventoryGetter(currentAvatar);\n\nexport const basePotentials = computed(() => {\n  if (!playerCharacter.value) return {};\n  return get(playerCharacter.value, '', {});\n});\n\nexport const playerWorldAttributes = computed(() => {\n  const character = playerCharacter.value;\n  if (!character || !character. || !character.) {\n    return [];\n  }\n\n  const world = store.worldState?.?.[character.];\n  const currentEpochId = world?.?.?.ID;\n  if (!world || !currentEpochId) {\n    // ID\n    return Object.entries(character.)\n      .filter(([key]) => key !== '$meta')\n      .map(([key, value]) => ({ key, value, description: null }));\n  }\n\n  const currentEpoch = (world.. as Record<string, any>)?.[currentEpochId];\n  const attributeTemplates = currentEpoch?.?. as Record<string, any> | undefined;\n\n  const result: { key: string; value: any; description: string | null }[] = [];\n  const attributesData = character.;\n\n  for (const key in attributesData) {\n    if (key === '$meta') continue;\n\n    const value = (attributesData as any)[key];\n    const template = attributeTemplates ? attributeTemplates[key] : null;\n\n    result.push({\n      key: template?. || key,\n      value: value,\n      description: template?. || null,\n    });\n  }\n\n  return result;\n});\n\n// --- Simulator Getters ---\n\nexport const isSimulationRunning = computed(() => {\n  if (!simulator.value) return false;\n\n  // \n  const isRunningValue = get(simulator.value, '.', false);\n\n  // \n  return !!isRunningValue;\n});\n\nexport const simulatorCooldown = computed(() => {\n  if (!simulator.value) return { status: '', remainingTime: 'N/A' };\n  const prep = get(simulator.value, '', {});\n  const status = get(prep, '', '');\n  const time = get(prep, '', 'N/A');\n\n  return { status, remainingTime: time };\n});\n\nexport const simulatorStatus = computed(() => {\n  const sim = simulator.value;\n  if (!sim) return 'unknown';\n\n  if (get(sim, '.')) {\n    return 'settlement';\n  }\n  if (get(sim, '.')) {\n    return 'simulating';\n  }\n  if (get(sim, '.ID') && !get(sim, '.')) {\n    return 'avatar-selection';\n  }\n  if (get(sim, '.') === '') {\n    return 'cooldown';\n  }\n  if (get(sim, '.') === '') {\n    return 'world-selection';\n  }\n  return 'unknown';\n});\n\n/**\n * \n */\nexport const mainWorld = computed(() => {\n  if (!store.worldState?.) return null;\n  const worlds = store.worldState.;\n  for (const worldId in worlds) {\n    if (worldId === '$meta' || worldId.includes('template')) continue;\n    if (get(worlds[worldId], '..') === '') {\n      return worlds[worldId];\n    }\n  }\n  return null;\n});\n\n/**\n * \n */\nexport const avatarWorld = computed(() => {\n  if (!store.worldState?.) return null;\n  const worlds = store.worldState.;\n  for (const worldId in worlds) {\n    if (worldId === '$meta' || worldId.includes('template')) continue;\n    if (get(worlds[worldId], '..') === '') {\n      return worlds[worldId];\n    }\n  }\n  return null;\n});\n\n/**\n * \n */\nexport const activeEpoch = computed(() => {\n  const world = avatarWorld.value || mainWorld.value;\n  if (!world) return null;\n\n  const currentEpochId = get(world, '..ID');\n  if (!currentEpochId) return null;\n\n  return get(world, `..${currentEpochId}`, null);\n});\n\n/**\n * \n */\nconst formatTime = (time: any, defaultString: string): string => {\n  if (!time) return defaultString;\n\n  const era = get(time, '', '');\n  const year = get(time, '', '----');\n  const month = String(get(time, '', '--')).padStart(2, '0');\n  const day = String(get(time, '', '--')).padStart(2, '0');\n  const hour = String(get(time, '', '--')).padStart(2, '0');\n  const minuteValue = get(time, '');\n  // null\n  const minute =\n    minuteValue !== null && minuteValue !== undefined && !isNaN(parseInt(String(minuteValue), 10))\n      ? String(parseInt(String(minuteValue), 10)).padStart(2, '0')\n      : '--';\n\n  return `${era} ${year}${month}${day} ${hour}:${minute}`;\n};\n\n/**\n * \n */\nexport const mainWorldTimeStr = computed(() => {\n  const world = mainWorld.value;\n  if (!world) return '';\n  const epochId = get(world, '..ID');\n  if (!epochId) return '';\n  const epoch = get(world, `..${epochId}`);\n  return formatTime(get(epoch, ''), '');\n});\n\n/**\n * \n */\nexport const timeStr = computed(() => {\n  const world = avatarWorld.value;\n  if (!world) return '';\n  const epochId = get(world, '..ID');\n  if (!epochId) return '';\n  const epoch = get(world, `..${epochId}`);\n  return formatTime(get(epoch, ''), '');\n});\n\n/**\n * \n */\nexport const calculateAge = (character: Character | null, world: any | null): number | null => {\n  if (!character || !world) return null;\n\n  const birthDate = get(character, '');\n  const epochId = get(world, '..ID');\n  const epoch = get(world, `..${epochId}`);\n  const currentTime = get(epoch, '');\n\n  if (!birthDate || !currentTime || birthDate.ID !== epochId) {\n    // \n    return null;\n  }\n\n  let age = currentTime. - birthDate.;\n  if (currentTime. < birthDate. || (currentTime. === birthDate. && currentTime. < birthDate.)) {\n    age--;\n  }\n  return age >= 0 ? age : null;\n};\n\n/**\n * \n */\nexport const playerAge = computed(() => {\n  return calculateAge(playerCharacter.value, mainWorld.value);\n});\n\n/**\n * \n */\nexport const combinedNarrative = computed(() => {\n  //  activeView \n  if (store.activeView === 'mainWorld') {\n    const narrative = store.mainWorldNarrative || '...';\n    //  HTML\n    return `<div class=\"narrative-block main-world-narrative\">${narrative}</div>`;\n  }\n\n  if (store.activeView === 'avatarWorld') {\n    if (isSimulationRunning.value) {\n      const narrative = store.avatarWorldNarrative || '...';\n      //  HTML\n      return `<div class=\"narrative-block avatar-world-narrative\">${narrative}</div>`;\n    }\n    return '<div class=\"narrative-block narrative-placeholder\"></div>';\n  }\n\n  // \n  return '<div class=\"narrative-block narrative-placeholder\">...</div>';\n});\n\n// --- Entity Getters for Tooltips ---\n\n/**\n * Finds an item across all known item lists by its name.\n * @param name The name of the item to find.\n */\nexport const getItemByName = (name: string): any | null => {\n  const world = store.activeView === 'mainWorld' ? mainWorld.value : avatarWorld.value;\n  const database = world?.;\n  if (!database) return null;\n\n  for (const category in database) {\n    const categoryStore = (database as any)[category];\n    if (categoryStore) {\n      for (const itemId in categoryStore) {\n        const item = categoryStore[itemId];\n        if (item. === name) {\n          return item;\n        }\n      }\n    }\n  }\n  return null;\n};\n\n/**\n * Finds an NPC from the world state by their name.\n * @param name The name of the NPC to find.\n */\nexport const getNpcByName = (name: string): Character | null => {\n  const worlds = store.worldState?.;\n  if (!worlds) return null;\n\n  for (const worldId in worlds) {\n    const characters = get(worlds[worldId], '');\n    if (characters) {\n      for (const charId in characters) {\n        if (charId === '$meta') continue;\n\n        const character = characters[charId];\n        if (character && character. && character. === name) {\n          return character;\n        }\n      }\n    }\n  }\n  return null;\n};\n\nexport const worldSandboxData = computed(() => {\n  const nodes: any[] = [];\n  const edges: any[] = [];\n  const worldState = store.worldState;\n\n  if (!worldState) {\n    return { nodes, edges };\n  }\n\n  // Add worlds as nodes\n  if (worldState.) {\n    for (const worldId in worldState.) {\n      // ID\n      if (worldId === '$meta' || worldId.includes('template')) continue;\n      const world = worldState.[worldId];\n      // world\n      const epochId = get(world, '..ID');\n      if (!epochId) continue;\n\n      const activeEpoch = get(world, `..${epochId}`);\n      if (!activeEpoch || !activeEpoch.) continue;\n\n      const loreEntry = lorebookService.findEntryByComment(worldId);\n      const worldName = loreEntry?.comment || get(world, '..') || worldId;\n\n      const title = `\n        : ${activeEpoch.?. || ''}<br>\n        : ${activeEpoch.?. || ''}x<br>\n        : ${activeEpoch.?. || ''}\n      `.trim();\n\n      nodes.push({\n        id: worldId,\n        label: worldName,\n        group: 'world',\n        title: title,\n      });\n    }\n  }\n\n  // Add characters as nodes\n  const player = playerCharacter.value;\n  if (player) {\n    const potentials = player.;\n    const potentialText = potentials\n      ? `: ${potentials.} | : ${potentials.} | : ${potentials.} | : ${potentials.}`\n      : '';\n    const identities = player.\n      ? Object.values(player.)\n          .filter(item => typeof item === 'string')\n          .join(', ')\n      : '';\n    const title = `\n        ${identities}<br>\n        ${potentialText}\n      `.trim();\n\n    nodes.push({\n      id: store.userId,\n      label: player. || store.userId,\n      group: 'player',\n      title: title,\n    });\n  }\n\n  if (worldState.) {\n    for (const worldId in worldState.) {\n      const world = worldState.[worldId];\n      if (!world.) continue;\n      for (const charId in world.) {\n        if (charId === '$meta' || charId.includes('sample')) continue;\n        const character = world.[charId];\n        if (!character.) continue;\n\n        const potentials = character.;\n        const potentialText = potentials\n          ? `: ${potentials.} | : ${potentials.} | : ${potentials.} | : ${potentials.}`\n          : '';\n        const identities = character.\n          ? Object.values(character.)\n              .filter(item => typeof item === 'string')\n              .join(', ')\n          : '';\n        const title = `\n          ${identities}<br>\n          ${potentialText}\n        `.trim();\n\n        nodes.push({\n          id: charId,\n          label: character. || charId,\n          group: 'npc',\n          title: title,\n        });\n\n        if (character. && worldState.?.[character.]) {\n          edges.push({\n            from: charId,\n            to: character.,\n            arrows: 'to',\n          });\n        }\n      }\n    }\n  }\n\n  // Add edges for relationships from \n  if (worldState.) {\n    for (const worldId in worldState.) {\n      const world = worldState.[worldId];\n      if (!world.) continue;\n      for (const subjectId in world.) {\n        if (!get(world, `.${subjectId}`) && subjectId !== store.userId) continue;\n\n        const subjectRelations = world.[subjectId];\n        for (const objectId in subjectRelations) {\n          if (!get(world, `.${objectId}`) && objectId !== store.userId) continue;\n\n          const relationship = subjectRelations[objectId];\n          const totalFavor =\n            (get(relationship, '.', 0) || 0) + (get(relationship, '.', 0) || 0);\n          const conflict = get(relationship, '.', 0) || 0;\n\n          edges.push({\n            from: subjectId,\n            to: objectId,\n            label: get(relationship, '.', ''),\n            color: totalFavor > 50 ? '#4caf50' : totalFavor < -50 ? '#f44336' : '#9e9e9e',\n            dashes: conflict > 50, // Dashed line for high conflict\n            arrows: 'to',\n          });\n        }\n      }\n    }\n  }\n\n  return { nodes, edges };\n});\n\nexport const ripples = computed(() => {\n  if (!store.worldState?.?.?.) return null;\n  return store.worldState...;\n});\n","class SilentUpdater {\n  private timerId: number | null = null;\n  private isRunning: boolean = false;\n  private isUpdating: boolean = false;\n  private updateCallback: (() => Promise<void>) | null = null;\n\n  /**\n   * Starts the silent update polling.\n   * @param updateFn The function to call to fetch data.\n   * @param interval The interval in milliseconds. Defaults to 5 seconds for faster feedback.\n   */\n  public start(updateFn: () => Promise<void>, interval: number = 5000) {\n    if (this.isRunning) {\n      console.log('[SilentUpdater] Updater is already running.');\n      return;\n    }\n    this.updateCallback = updateFn;\n    this.timerId = window.setInterval(() => this.runUpdate(), interval);\n    this.isRunning = true;\n    console.log(`[SilentUpdater] Started with an interval of ${interval / 1000} seconds.`);\n  }\n\n  /**\n   * Stops the silent update polling.\n   */\n  public stop() {\n    if (this.timerId) {\n      window.clearInterval(this.timerId);\n      this.timerId = null;\n    }\n    this.isRunning = false;\n    this.updateCallback = null;\n    console.log('[SilentUpdater] Stopped.');\n  }\n\n  /**\n   * Resets the polling timer.\n   */\n  public reset() {\n    if (!this.isRunning || !this.updateCallback) return;\n    if (this.timerId) {\n      window.clearInterval(this.timerId);\n    }\n    const interval = this.timerId ? (this.timerId as any).__interval : 5000;\n    this.timerId = window.setInterval(() => this.runUpdate(), interval);\n  }\n\n  /**\n   * Runs a single update cycle.\n   */\n  private async runUpdate() {\n    if (this.isUpdating || !this.updateCallback) {\n      console.log('[SilentUpdater] Update in progress or callback not set. Skipping.');\n      return;\n    }\n\n    this.isUpdating = true;\n    try {\n      await this.updateCallback();\n      console.debug('[SilentUpdater] Silent update check completed.');\n    } catch (error) {\n      console.error('[SilentUpdater] Error during silent update:', error);\n    } finally {\n      this.isUpdating = false;\n    }\n  }\n}\n\nexport const silentUpdater = new SilentUpdater();\n","import { cloneDeep, get, set } from 'lodash';\nimport { z } from 'zod';\nimport { commandService } from '../services/CommandService';\nimport { contextService } from '../services/ContextService';\nimport { lorebookService } from '../services/LorebookService';\nimport { memoryService } from '../services/MemoryService';\nimport { notificationService } from '../services/NotificationService';\nimport { serviceLocator } from '../services/service-locator';\nimport { tavernService } from '../services/tavern';\nimport { workflowService } from '../services/WorkflowService';\nimport { worldEvolutionService } from '../services/WorldEvolutionService';\nimport type { WorldbookEntry } from '../types';\nimport { EvolutionaryPressure } from '../types/evolution';\nimport { processTags } from '../utils/tagProcessor';\nimport { isSimulationRunning } from './getters';\nimport { store } from './state';\n\n/**\n *  Tavern \n *  `stat_data` \n * @param data -  `getChatMessages`  `invokeMvuScript` \n * @returns \n */\nfunction sanitizeStateData(data: any): any {\n  if (!data) return null;\n  // \n  // \n  if (data. || data.) {\n    // `stat_data`\n    // \n    const cleanState: any = {};\n    const stateKeys = ['', ''];\n    for (const key of stateKeys) {\n      if (data[key] !== undefined) {\n        cleanState[key] = data[key];\n      }\n    }\n    console.log('[sanitizeStateData] Detected corrupted state, returning cleaned top-level data.');\n    return cleanState;\n  }\n  //  stat_data  stat_data \n  return data.stat_data || data;\n}\n\nlet lastProcessedMessageId: string | null = null; // ID\nlet isLogHistoryLoaded = false; // Flag to ensure history is loaded only once\nconst ZOD_ERROR_NOTIFIED_KEY = 'zodErrorNotified';\nlet isZodErrorNotified = sessionStorage.getItem(ZOD_ERROR_NOTIFIED_KEY) === 'true';\n\n/**\n * Compares old and new game states and triggers notifications for changes.\n * @param oldState The game state before the update.\n * @param newState The game state after the update.\n */\nfunction checkForChangesAndNotify(oldState: any, newState: any) {\n  if (!oldState || !newState) return;\n\n  // 1.  NPC  & \n  const oldWorlds = get(oldState, '', {});\n  const newWorlds = get(newState, '', {});\n  for (const worldId in newWorlds) {\n    //  NPC \n    const oldNpcIds = Object.keys(get(oldWorlds, `${worldId}.`, {})).filter(id => id.startsWith('npc_'));\n    const newNpcIds = Object.keys(get(newWorlds, `${worldId}.`, {})).filter(id => id.startsWith('npc_'));\n    for (const npcId of newNpcIds) {\n      if (!oldNpcIds.includes(npcId)) {\n        const npcName = get(newWorlds, `${worldId}..${npcId}.`, npcId);\n        notificationService.info('', ` ${npcName}`);\n      }\n    }\n\n    // \n    const oldEpochs = get(oldWorlds, `${worldId}..`, {});\n    const newEpochs = get(newWorlds, `${worldId}..`, {});\n    for (const epochId in newEpochs) {\n      const oldEvents = get(oldEpochs, `${epochId}.`, {});\n      const newEvents = get(newEpochs, `${epochId}.`, {});\n      const newEventKeys = Object.keys(newEvents).filter(key => !oldEvents[key]);\n      for (const key of newEventKeys) {\n        notificationService.warn('', newEvents[key].);\n      }\n    }\n  }\n\n  // 2. Inventory Change Notification\n  const oldInventory = get(oldState, '..', {});\n  const newInventory = get(newState, '..', {});\n  const allItemIds = new Set([...Object.keys(oldInventory), ...Object.keys(newInventory)].filter(id => id !== '$meta'));\n\n  for (const itemId of allItemIds) {\n    const oldQty = oldInventory[itemId] || 0;\n    const newQty = newInventory[itemId] || 0;\n    const diff = newQty - oldQty;\n    if (diff !== 0) {\n      const itemName = store.getItemNameById(itemId) || itemId;\n      const action = diff > 0 ? '' : '';\n      notificationService.success('', `${action} ${itemName} x${Math.abs(diff)}`);\n    }\n  }\n\n  // 3. User Attribute Change Notification\n  const oldUser = get(oldState, '.', {});\n  const newUser = get(newState, '.', {});\n\n  const compareAndNotify = (path: string, name: string) => {\n    const oldVal = get(oldUser, path);\n    const newVal = get(newUser, path);\n\n    if (JSON.stringify(oldVal) !== JSON.stringify(newVal)) {\n      if (typeof newVal === 'object' && newVal !== null) {\n        // For objects, find what changed\n        for (const key in newVal) {\n          if (get(oldVal, key) !== get(newVal, key)) {\n            notificationService.info('', `${name} - ${key}  ${get(newVal, key)}`);\n          }\n        }\n      } else {\n        notificationService.info('', `${name}  ${newVal}`);\n      }\n    }\n  };\n\n  compareAndNotify('', '');\n  compareAndNotify('', '');\n  compareAndNotify('', '');\n  compareAndNotify('', '');\n  compareAndNotify('', '');\n}\n\nasync function loadWorldLogFromLorebook() {\n  try {\n    const logContent = await lorebookService.readFromLorebook('');\n    if (!logContent || !logContent.trim()) {\n      console.log('[Store] \"\" lorebook is empty. Skipping log population.');\n      store.worldLog = []; // Ensure log is cleared if entry is empty\n      return;\n    }\n\n    const logBlocks = logContent.split('\\n\\n---\\n\\n');\n    const allLogs = logBlocks\n      .map(block => {\n        if (!block.trim()) return null;\n        try {\n          const parsed = parseBlock(block);\n          if (!parsed || !parsed['']) return null;\n          // Ensure all properties of WorldLogEntry are present\n          return {\n            : parseInt(parsed[''], 10),\n            : parsed[''] || '',\n            : parsed[''] || '',\n            : parsed[''] || '',\n            : parsed[''] || '',\n            : parsed[''] || '',\n            : parsed[''] || '',\n            : parsed['']\n              ? parsed['']\n                  .replace(/[[\\]\"]/g, '')\n                  .split(',')\n                  .map(t => t.trim())\n                  .filter(t => t)\n              : [],\n            : parsed[''] || '',\n            : parsed[''] || '',\n            : parsed[''] || '',\n          };\n        } catch (e) {\n          console.error('Failed to parse log block:', block, e);\n          return null;\n        }\n      })\n      .filter(log => log && !isNaN(log.));\n\n    // De-duplication\n    const uniqueLogs = [];\n    const seenIds = new Set();\n    for (const log of allLogs) {\n      if (log && !seenIds.has(log.)) {\n        seenIds.add(log.);\n        uniqueLogs.push(log);\n      }\n    }\n\n    store.worldLog = uniqueLogs.sort((a, b) => a. - b.);\n    console.log(`[Store] Loaded ${store.worldLog.length} entries from \"\" lorebook.`);\n  } catch (error) {\n    console.error('Error loading world log from lorebook:', error);\n    store.worldLog = []; // Reset on error\n  }\n}\n\nasync function fetchCoreData() {\n  try {\n    const messages = await tavernService.fetchTavernData();\n    if (messages && messages.length > 0 && messages[0].data) {\n      const rawStateData = sanitizeStateData(messages[0].data);\n      const fullMessageContent = messages[0].message;\n      const currentMessageId = messages[0].id;\n      const oldState = JSON.parse(JSON.stringify(store.worldState)); // Capture state before update\n\n      try {\n        store.worldState = rawStateData as any;\n        // \n        if (isZodErrorNotified) {\n          sessionStorage.removeItem(ZOD_ERROR_NOTIFIED_KEY);\n          isZodErrorNotified = false;\n        }\n      } catch (error) {\n        console.warn('[Zod-AutoFix] Initial parsing failed. Attempting to auto-fix...', error);\n        const fixedData = cloneDeep(rawStateData);\n\n        if (error instanceof z.ZodError) {\n          for (const issue of error.issues) {\n            if (issue.code === 'invalid_type' && 'received' in issue && issue.received === 'undefined') {\n              let defaultValue: any = ''; // Default to empty string\n              if (issue.expected === 'number') defaultValue = 0;\n              else if (issue.expected === 'boolean') defaultValue = false;\n              else if (issue.expected === 'object') defaultValue = {};\n              else if (issue.expected === 'array') defaultValue = [];\n\n              console.log(\n                `[Zod-AutoFix] Fixing path [${issue.path.join(' -> ')}]: setting to default value`,\n                defaultValue,\n              );\n              set(fixedData, issue.path, defaultValue);\n            }\n          }\n\n          try {\n            store.worldState = fixedData as any;\n            notificationService.success('', '');\n            // \n            if (isZodErrorNotified) {\n              sessionStorage.removeItem(ZOD_ERROR_NOTIFIED_KEY);\n              isZodErrorNotified = false;\n            }\n          } catch (finalError) {\n            if (!isZodErrorNotified) {\n              const finalZodError = finalError as z.ZodError;\n              const firstIssue = finalZodError.issues[0];\n              const errorMessage = ` [${firstIssue.path.join(' -> ')}] : ${firstIssue.message}`;\n\n              console.error('Zod validation failed even after auto-fixing:', finalError);\n              notificationService.error('', `: ${errorMessage}`);\n              sessionStorage.setItem(ZOD_ERROR_NOTIFIED_KEY, 'true');\n              isZodErrorNotified = true;\n            }\n            store.worldState = fixedData as any;\n          }\n        } else {\n          store.worldState = rawStateData as any;\n          if (!isZodErrorNotified) {\n            console.error('Validation failed with non-Zod error:', error);\n            notificationService.error('', '');\n            sessionStorage.setItem(ZOD_ERROR_NOTIFIED_KEY, 'true');\n            isZodErrorNotified = true;\n          }\n        }\n      }\n\n      // After updating the state, compare with the old state for notifications\n      checkForChangesAndNotify(oldState, store.worldState);\n\n      const gameTextContent = fullMessageContent?.match(/<gametxt>([\\s\\S]*?)<\\/gametxt>/i)?.[1].trim();\n\n      // \n      if (gameTextContent) {\n        if (store.activeView === 'mainWorld') {\n          store.mainWorldNarrative = gameTextContent;\n        } else if (store.activeView === 'avatarWorld') {\n          store.avatarWorldNarrative = gameTextContent;\n        } else {\n          // \n          store.mainWorldNarrative = gameTextContent;\n        }\n      }\n\n      // \n      // ID\n      if (fullMessageContent && currentMessageId !== lastProcessedMessageId) {\n        // \n        // ---  () ---\n        const summaryRegex = /< a_id=\"(.+?)\">([\\s\\S]+?)<\\/>/g;\n        const mainWorldSummaryRegex = /<>([\\s\\S]+?)<\\/>/g;\n        const avatarWorldSummaryRegex = /<>([\\s\\S]+?)<\\/>/g;\n        let match;\n\n        const formatWorldTime = (time: any): string => {\n          if (!time) return new Date().toLocaleString('zh-CN', { hour12: false }); // Fallback\n\n          const era = get(time, '', '');\n          const year = get(time, '', '----');\n          const month = String(get(time, '', '--')).padStart(2, '0');\n          const day = String(get(time, '', '--')).padStart(2, '0');\n          const hour = String(get(time, '', '--')).padStart(2, '0');\n          const minute = String(get(time, '', '--')).padStart(2, '0');\n\n          return `${era} ${year}${month}${day} ${hour}:${minute}`;\n        };\n\n        const processAndWriteSummary = async (content: string, entryName: string, toastrTitle: string) => {\n          const existingSummaries = await lorebookService.readFromLorebook(entryName);\n          if (existingSummaries && existingSummaries.includes(content)) {\n            console.log(`[Actions] Summary content already exists in \"${entryName}\". Skipping.`);\n            return;\n          }\n\n          // \n          const targetWorldLocation = entryName === '[]' ? '' : '';\n          const world = Object.values(get(store.worldState, '', {})).find(\n            (w: any) => get(w, '.') === targetWorldLocation,\n          );\n\n          let timestamp = new Date().toLocaleString('zh-CN', { hour12: false });\n          if (world) {\n            const currentEpochId = get(world, '.ID');\n            if (currentEpochId) {\n              const currentTime = get(world, `.${currentEpochId}.`);\n              timestamp = formatWorldTime(currentTime);\n            }\n          }\n\n          notificationService.info(toastrTitle, content);\n          const formattedSummary = `${timestamp}\\n${content}`;\n          await lorebookService.appendToEntry(entryName, formattedSummary, '\\n\\n---\\n\\n');\n        };\n\n        // : < a_id=\"...\">\n        while ((match = summaryRegex.exec(fullMessageContent)) !== null) {\n          const worldId = match[1];\n          const summaryContent = match[2].trim();\n          const world = get(store.worldState, `.${worldId}`);\n          if (world) {\n            const worldName = get(world, '', '');\n            const location = get(world, '.[0]');\n            const entryName = location === '' ? '[]' : '[]';\n            const worldTime = formatWorldTime(get(world, '.'));\n            await processAndWriteSummary(summaryContent, entryName, `${worldName} `);\n          }\n        }\n\n        // : <> / <>\n        if ((match = mainWorldSummaryRegex.exec(fullMessageContent)) !== null) {\n          const mainWorld = Object.values(get(store.worldState, '', {})).find(\n            (w: any) => get(w, '.[0]') === '',\n          );\n          const worldTime = formatWorldTime(get(mainWorld, '.'));\n          await processAndWriteSummary(match[1].trim(), '[]', '');\n        }\n        if ((match = avatarWorldSummaryRegex.exec(fullMessageContent)) !== null) {\n          const avatarWorld = Object.values(get(store.worldState, '', {})).find(\n            (w: any) => get(w, '.[0]') === '',\n          );\n          const worldTime = formatWorldTime(get(avatarWorld, '.'));\n          await processAndWriteSummary(match[1].trim(), '[]', '');\n        }\n\n        // 3. \n        const avatarOptionsMatch = fullMessageContent.match(/<>([\\s\\S]+?)<\\/>/i);\n        if (avatarOptionsMatch) {\n          const parser = new DOMParser();\n          const xmlDoc = parser.parseFromString(`<root>${avatarOptionsMatch[1]}</root>`, 'application/xml');\n          const avatars = Array.from(xmlDoc.getElementsByTagName('')).map(el => {\n            return {\n              : el.getElementsByTagName('')[0]?.textContent || '',\n              : el.getElementsByTagName('')[0]?.textContent || '',\n              : el.getElementsByTagName('')[0]?.textContent || '',\n            };\n          });\n          store.reincarnationAvatarOptions = avatars;\n        }\n\n        console.log('[Roo Debug] fetchCoreData: New message content detected. Processing world tags...');\n        console.log('[Roo Debug] fetchCoreData: New message content detected. Processing world tags...');\n\n        // \n\n        // ID\n        lastProcessedMessageId = currentMessageId;\n\n        // \n        await memoryService.updateMemory(store.worldLog);\n      }\n    }\n  } catch (error) {\n    console.error(':', error);\n  }\n}\n\nasync function syncWorldEntries() {\n  console.log('[Roo Debug] Syncing world entries based on World ID...');\n  const worlds = get(store.worldState, '', {}) as { [id: string]: any };\n  const allEntries = await lorebookService.getEntries(true); // Force refresh cache\n  if (!allEntries) return;\n\n  // \n  const avatarWorldEntry = allEntries.find((e: any) => e.name === '');\n  if (avatarWorldEntry && avatarWorldEntry.content && avatarWorldEntry.content.trim() !== '') {\n    const idMatch = avatarWorldEntry.content.match(/ID:\\s*(\\S+)/);\n    const nameMatch = avatarWorldEntry.content.match(/:\\s*(.*)/);\n    if (idMatch && nameMatch) {\n      const worldId = idMatch[1].trim();\n      const worldName = nameMatch[1].trim();\n      const targetEntryName = `${worldName || worldId}`;\n\n      console.log(`[Actions] Archiving '' to '${targetEntryName}'...`);\n\n      // \n      await lorebookService.writeToLorebook(targetEntryName, avatarWorldEntry.content, {\n        isEnabled: false, // \n        keys: [targetEntryName],\n      });\n\n      // \n      await lorebookService.writeToLorebook('', '', { isEnabled: true, keys: [''] });\n      console.log(`[Actions] '' has been cleared and archived.`);\n    }\n  }\n\n  // ---  ---\n  const worldIdToLocation: { [id: string]: string } = {};\n  for (const worldId in worlds) {\n    if (worldId === '$meta') continue;\n    const location = get(worlds[worldId], '.[0]');\n    if (location === '' || location === '') {\n      worldIdToLocation[worldId] = location;\n    }\n  }\n\n  for (const sourceEntry of allEntries) {\n    const entryIdentifier = (sourceEntry as any).comment || sourceEntry.name;\n    if (!entryIdentifier || typeof entryIdentifier !== 'string' || !entryIdentifier.startsWith('')) {\n      continue;\n    }\n    if (!sourceEntry.content) continue;\n\n    const match = sourceEntry.content.match(/ID:\\s*(\\S+)/);\n    if (match && match[1]) {\n      const entryWorldId = match[1].trim();\n      const location = worldIdToLocation[entryWorldId];\n\n      if (location) {\n        const targetEntryName = location === '' ? '' : '';\n        if (entryIdentifier !== targetEntryName) {\n          console.log(`[Roo Debug] Found match: Moving content from \"${entryIdentifier}\" to \"${targetEntryName}\"`);\n          await lorebookService.writeToLorebook(targetEntryName, sourceEntry.content, {\n            isEnabled: true,\n            keys: [targetEntryName],\n          });\n          await lorebookService.writeToLorebook(entryIdentifier, '', { isEnabled: false, keys: [entryIdentifier] });\n          delete worldIdToLocation[entryWorldId];\n        }\n      }\n    }\n  }\n}\n\nasync function loadAllData() {\n  // Load the full log history only on the first run\n  if (!isLogHistoryLoaded) {\n    await loadWorldLogFromLorebook();\n    isLogHistoryLoaded = true;\n  }\n\n  await fetchCoreData();\n  // Force a refresh of the lorebook cache after fetching new data\n  await lorebookService.getEntries(true);\n  store.isReady = true;\n  console.log('[Store] Core data loaded and lorebook cache refreshed.');\n}\n\n/**\n * \n * @param prefixedInput \n */\nasync function processAiResponse(response: string, prefixedInput: string) {\n  if (!response) return;\n\n  // 1. \n  const gameTextMatch = response.match(/<gametxt>([\\s\\S]+?)<\\/gametxt>/i);\n  const narrative = gameTextMatch ? gameTextMatch[1].trim() : null;\n\n  if (narrative) {\n    if (prefixedInput.startsWith('')) {\n      store.mainWorldNarrative = narrative;\n    } else if (prefixedInput.startsWith('')) {\n      store.avatarWorldNarrative = narrative;\n    } else {\n      store.mainWorldNarrative = narrative;\n    }\n  } else {\n    // AIgametxt\n    const cachedNarrative = workflowService.popNarrative();\n    if (cachedNarrative) {\n      if (store.activeView === 'mainWorld') {\n        store.mainWorldNarrative = cachedNarrative;\n      } else {\n        store.avatarWorldNarrative = cachedNarrative;\n      }\n    }\n  }\n\n  // 2. \n  const summaryRegex = /< a_id=\"(.+?)\">([\\s\\S]+?)<\\/>/g;\n  let summaryMatch;\n  while ((summaryMatch = summaryRegex.exec(response)) !== null) {\n    const worldId = summaryMatch[1];\n    const summaryContent = summaryMatch[2];\n    const worldName = get(store.worldState, `.${worldId}.`, '');\n    notificationService.info(`${worldName} `, summaryContent);\n  }\n\n  // 3. \n  const avatarOptionsMatch = response.match(/<>([\\s\\S]+?)<\\/>/i);\n  if (avatarOptionsMatch) {\n    const parser = new DOMParser();\n    const xmlDoc = parser.parseFromString(`<root>${avatarOptionsMatch[1]}</root>`, 'application/xml');\n    const avatars = Array.from(xmlDoc.getElementsByTagName('')).map(el => {\n      return {\n        : el.getElementsByTagName('')[0]?.textContent || '',\n        : el.getElementsByTagName('')[0]?.textContent || '',\n        : el.getElementsByTagName('')[0]?.textContent || '',\n      };\n    });\n    store.reincarnationAvatarOptions = avatars;\n\n    // \n    // \n  }\n\n  //  fetchCoreData\n  // \n\n  // 4. \n  const updateScriptMatch = response.match(/<UpdateVariable>([\\s\\S]+?)<\\/UpdateVariable>/i);\n  let updateScript = updateScriptMatch ? updateScriptMatch[1].trim() : null;\n\n  //  gametxt  updateScript\n  if (narrative) {\n    workflowService.cacheNarrative(narrative);\n  }\n  if (updateScript) {\n    workflowService.cacheUpdateScript(updateScript);\n  }\n\n  // [Roo-Fix]  handleAction\n  // //  gametxt\n  // if (!narrative) {\n  //   const cachedNarrative = workflowService.popNarrative();\n  //   if (cachedNarrative) {\n  //     if (store.activeView === 'mainWorld') {\n  //       store.mainWorldNarrative = cachedNarrative;\n  //     } else {\n  //       store.avatarWorldNarrative = cachedNarrative;\n  //     }\n  //   }\n  // }\n\n  //  processAiResponse \n  if (updateScript) {\n    // [PATCH] AI''[0]\n    // \n    const scriptLines = updateScript.split('\\n');\n    const patchedLines = scriptLines.map(line => {\n      if (line.includes('..') && line.includes('[0]')) {\n        return line.replace('[0]', '');\n      }\n      return line;\n    });\n    const patchedScript = patchedLines.join('\\n');\n    if (patchedScript !== updateScript) {\n      console.log('[PATCH] Corrected invalid [0] access in UpdateVariable script for .');\n      updateScript = patchedScript;\n    }\n\n    // [PATCH]  \"Cannot assign into path\" \n    const commands = updateScript\n      .split(';')\n      .map(cmd => cmd.trim())\n      .filter(Boolean);\n    const creationCommands = commands.filter(cmd => cmd.startsWith(\"_.assign('',\"));\n    const relationCommands = commands.filter(cmd => cmd.startsWith(\"_.assign('.\") && cmd.includes(\".'\"));\n    const otherCommands = commands.filter(cmd => !creationCommands.includes(cmd) && !relationCommands.includes(cmd));\n\n    const sortedScript = [...creationCommands, ...relationCommands, ...otherCommands].join(';\\n') + ';';\n\n    if (sortedScript !== updateScript) {\n      console.log('[PATCH] Reordered UpdateVariable script to ensure correct execution order.');\n      updateScript = sortedScript;\n    }\n\n    const latestState = (await tavernService.fetchTavernData())?.[0]?.data ?? store.worldState;\n    const oldState = JSON.parse(JSON.stringify(store.worldState)); // Deep copy for comparison\n    const newVariables = await tavernService.invokeMvuScript(updateScript, latestState);\n    if (newVariables) {\n      const sanitizedVars = sanitizeStateData(newVariables);\n      try {\n        store.worldState = sanitizedVars as any;\n        isZodErrorNotified = false; // Reset on successful parse\n      } catch (error) {\n        if (!isZodErrorNotified) {\n          const zodError = error as z.ZodError;\n          const firstIssue = zodError.issues[0];\n          const errorMessage = ` [${firstIssue.path.join(' -> ')}] : ${firstIssue.message}`;\n\n          console.error('Zod validation failed for newVariables from MVU script:', error);\n          notificationService.error('', errorMessage);\n          isZodErrorNotified = true;\n        }\n        // \n        store.worldState = sanitizedVars as any;\n      }\n      store.character = get(store.worldState, ['', store.userId]) || null;\n      checkForChangesAndNotify(oldState, store.worldState);\n    }\n  }\n}\n\nasync function updateLastPatchFromHistory() {\n  try {\n    const messages = await tavernService.fetchTavernData();\n    if (messages && messages.length > 0) {\n      // \n      const lastAiMessage = [...messages].reverse().find(m => !m.is_user);\n      if (!lastAiMessage) return;\n\n      const lastMessage = lastAiMessage;\n      const updateScriptMatch = lastMessage.message?.match(/<UpdateVariable>([\\s\\S]+?)<\\/UpdateVariable>/i);\n      const updateScript = updateScriptMatch ? updateScriptMatch[1].trim() : null;\n      const jsonPatchMatch = updateScript?.match(/<JSONPatch>([\\s\\S]*?)<\\/JSONPatch>/i);\n\n      if (jsonPatchMatch && jsonPatchMatch[1]) {\n        const patchContent = jsonPatchMatch[1].trim();\n        store.lastGeneratedPatch = patchContent;\n        console.log('[CACHE_DEBUG] Silently updated JSONPatch from history.');\n      } else {\n        store.lastGeneratedPatch = null; // Ensure cache is cleared if no patch is found\n      }\n    }\n  } catch (error) {\n    console.error('Failed to silently update patch from history:', error);\n  }\n}\n\nasync function handleAction(actionText: string, isReroll = false) {\n  const saveLoadService = serviceLocator.get('saveLoadService');\n  if (!actionText.trim()) return;\n  if (!store.isReady) await loadAllData();\n\n  // \n  if (!isReroll) {\n    await saveLoadService.saveStateForReroll();\n  }\n\n  store.isGenerating = true;\n  try {\n    // : \n    //  Patch\n    await updateLastPatchFromHistory();\n\n    console.log('[EvoSys] Executing Pre-Action Deduction...');\n    const pressures = worldEvolutionService.applyPressure(store.worldState);\n    const reactions = worldEvolutionService.simulateReactions(pressures, store.worldState);\n    for (const event of reactions) {\n      worldEvolutionService.propagateRipples(event, store.worldState);\n    }\n    const availableRipples = worldEvolutionService.getAvailableRipples(Date.now()); // \n\n    const currentState = workflowService.getCurrentState();\n\n    // :  ()\n    const intent = contextService.analyzeUserIntent(actionText, store.worldState, availableRipples);\n    const leanContextVariables = contextService.buildLeanContext(intent, actionText, store.worldState, store.userId);\n\n    console.log('[Actions] Generating AI response with lean context variables informed by world pulse.');\n\n    // Patch\n    const aiInput = `<previous_patch>\n${store.lastGeneratedPatch || ''}\n</previous_patch>\n<user_input>\n${actionText}\n</user_input>`;\n\n    console.log('[SUBMIT_DEBUG] Submitting to AI with combined input:', aiInput);\n\n    //  Prompt  AI\n    const rawAiResponse = await tavernService.generateAiResponse(aiInput, leanContextVariables);\n\n    // \n    const aiResponseString = processTags(rawAiResponse);\n\n    // 2. \n    const preservedContent = workflowService.popPreservedContent();\n    const finalResponseString = aiResponseString + preservedContent;\n\n    // 3. \n    await processAiResponse(finalResponseString, actionText);\n\n    // 2024-05-24:  LogSyncService  index.ts  watch \n    // await processAndSaveLorebookTags(finalResponseString);\n    // await memoryService.updateMemory(store.worldLog);\n\n    // \n    const messages = await tavernService.fetchTavernData();\n    if (messages && messages.length > 0) {\n      const messageZero = messages[0];\n      messageZero.message = finalResponseString; // \n\n      // ROO-FIX:  `stat_data` \n      //  `message.data` \n      const newData = messageZero.data || {};\n      newData.stat_data = JSON.parse(JSON.stringify(store.worldState));\n\n      // \n      const stateKeys = ['', '', '', '', '', ''];\n      for (const key of stateKeys) {\n        delete newData[key];\n      }\n\n      messageZero.data = newData;\n\n      await TavernHelper.setChatMessages([messageZero], { refresh: 'none' });\n    }\n\n    // \n    await saveLoadService.performAutoSave();\n\n    // : \n    console.log('[EvoSys] Executing Post-Action Deduction...');\n    const actionAsPressure: EvolutionaryPressure = {\n      type: 'custom',\n      source: { type: 'npc', id: store.userId },\n      intensity: 75, // \n      description: `: \"${actionText}\"`,\n      intent: actionText,\n    };\n    const actionReactions = worldEvolutionService.simulateReactions([actionAsPressure], store.worldState);\n    for (const event of actionReactions) {\n      worldEvolutionService.propagateRipples(event, store.worldState);\n    }\n\n    // // \n    // // \n    // if (currentState === 'CREATION' || currentState === 'NORMAL') {\n    //   window.location.reload();\n    // }\n  } catch (error) {\n    console.error(':', error);\n    const errorMessage = error instanceof Error ? error.message : String(error);\n    store.generationError = `AI: ${errorMessage}`;\n    notificationService.error('', 'AI');\n  } finally {\n    // \n    if (store.generationError) {\n      setTimeout(() => {\n        store.isGenerating = false;\n        store.generationError = null; // \n      }, 5000);\n    } else {\n      store.isGenerating = false;\n    }\n  }\n}\n\nlet isInitialized = false;\n\nimport { silentUpdater } from '../services/updater';\n\nfunction initializeEventListeners() {\n  if (isInitialized) return;\n  console.log('[Store] Initializing data synchronization...');\n\n  // AI\n  eventOn(tavern_events.GENERATION_ENDED, () => {\n    console.log('[Store] Generation ended. Scheduling data fetch and error check.');\n\n    // \n    setTimeout(async () => {\n      console.log('[Store] Executing scheduled data fetch and error check...');\n\n      // MVU\n      try {\n        const messages = await tavernService.fetchTavernData();\n        if (messages && messages.length > 0) {\n          const latestMessage = messages[messages.length - 1];\n          const content = latestMessage?.message || '';\n\n          // \n          console.log('[ErrorInterceptor DEBUG] Fetched latest message content:', JSON.stringify(content));\n\n          // MVU beta\n          const regex =\n            / \\| mvu beta: Path '(.+?)' does not exist in stat_data, skipping set command \\(json_patch\\)/g;\n          let match;\n\n          while ((match = regex.exec(content)) !== null) {\n            const failedPath = match[1];\n            if (failedPath) {\n              const correctionCommand = ` '${failedPath}' `;\n\n              const commands = commandService.getCommands();\n              // \n              if (!commands.includes(correctionCommand)) {\n                commandService.addCommand(correctionCommand);\n                console.log(`[ErrorInterceptor] JSON Patch: ${failedPath}`);\n                notificationService.warn('AI ', ' AI ');\n              }\n            }\n          }\n        }\n      } catch (error) {\n        console.error('[ErrorInterceptor] MVU:', error);\n      }\n\n      // \n      // [Roo-Fix]  loadAllData() \n      // await loadAllData();\n      silentUpdater.reset();\n    }, 500); // 500\n  });\n\n  // \n  // [Roo-Fix] \n  // silentUpdater.start(loadAllData, 5000); // 5\n\n  isInitialized = true;\n  console.log('[Store] Data synchronization listeners and polling are active.');\n}\n\nasync function fetchReincarnationWorlds() {\n  // \n  if (isSimulationRunning.value || store.reincarnationWorldOptions.length > 0) {\n    return;\n  }\n\n  const allWorlds = await lorebookService.getEntries();\n  if (!allWorlds) {\n    return;\n  }\n\n  const zhutianWorlds = allWorlds.filter((w: WorldbookEntry) => {\n    const name = w.name || (w as any).comment || '';\n    return name.startsWith('') && w.content && w.content.trim() !== '';\n  });\n  const randomWorlds = zhutianWorlds.sort(() => 0.5 - Math.random()).slice(0, 3);\n\n  const parseJson = (jsonString: string) => {\n    try {\n      const cleanedString = jsonString.trim().replace(/,$/, '');\n      return JSON.parse(cleanedString);\n    } catch {\n      return null;\n    }\n  };\n\n  // \n  store.reincarnationWorldOptions = randomWorlds;\n}\n\nfunction resetReincarnationSelection() {\n  store.reincarnationWorldOptions = [];\n  store.selectedWorldForReincarnation = null;\n  console.log('[Actions] Reincarnation selection has been reset.');\n}\n\nasync function prepareReincarnation(world: WorldbookEntry) {\n  if (world) {\n    const worldIdMatch = world.content.match(/ID:\\s*(.*)/);\n    if (worldIdMatch && worldIdMatch[1]) {\n      const worldId = worldIdMatch[1].trim();\n      const command = `< ID=\"${worldId}\">`;\n      // \n      handleAction(command);\n      store.selectedWorldForReincarnation = world; // \n      notificationService.success('', `${world.name || worldId}`);\n    } else {\n      notificationService.error('', 'ID');\n    }\n  }\n}\n\nasync function clearSettlementData() {\n  const script = `\n    _.set('..', false);\n    _.set('..', {});\n  `;\n  try {\n    const latestState = (await tavernService.fetchTavernData())?.[0]?.data ?? store.worldState;\n    const newVariables = await tavernService.invokeMvuScript(script, latestState);\n    if (newVariables) {\n      store.worldState = newVariables;\n      notificationService.success('', '');\n    }\n  } catch (error) {\n    console.error('Failed to clear settlement data:', error);\n    notificationService.error('', '');\n  }\n}\n\nexport const actions = {\n  loadAllData,\n  handleAction,\n  rerollLastAction: async () => {\n    const saveLoadService = serviceLocator.get('saveLoadService');\n    console.log('[Actions] Reroll requested.');\n    try {\n      // This will now set a flag and reload the page.\n      // The startup logic in index.ts will handle restoring the input.\n      notificationService.info('...', '');\n      await saveLoadService.loadRerollState();\n    } catch (error) {\n      console.error('Reroll failed:', error);\n      notificationService.error('', error instanceof Error ? error.message : '');\n    }\n  },\n  initializeEventListeners,\n  fetchReincarnationWorlds,\n  prepareReincarnation,\n  clearSettlementData,\n  triggerCreationWorkflow: async () => {\n    console.log('[Actions] Triggering CREATION workflow...');\n    // 1.  gametxt\n    const currentNarrative = store.activeView === 'mainWorld' ? store.mainWorldNarrative : store.avatarWorldNarrative;\n    if (currentNarrative) {\n      workflowService.cacheNarrative(currentNarrative);\n    }\n    // 2. CoT\n    await workflowService.switchTo('CREATION');\n    workflowService.setPreserveMode('gametxt'); //  gametxt\n    // CoTCoT\n    await lorebookService.getEntries(true);\n    // 3. \n    notificationService.info('', 'AI...');\n    await handleAction('');\n  },\n  triggerIdentityWorkflow: async (world: WorldbookEntry) => {\n    console.log('[Actions] Triggering IDENTITY workflow...');\n    // 1.  gametxt\n    const currentNarrative = store.activeView === 'mainWorld' ? store.mainWorldNarrative : store.avatarWorldNarrative;\n    if (currentNarrative) {\n      workflowService.cacheNarrative(currentNarrative);\n    }\n    // 2. CoT\n    await workflowService.switchTo('IDENTITY');\n    workflowService.setPreserveMode('full'); //  gametxt  UpdateVariable\n    // CoT\n    if (world && world.content) {\n      await lorebookService.writeToLorebook('', world.content, { isEnabled: true, keys: [''] });\n      // \n      const sourceEntryName = world.name || world.comment || '';\n      if (sourceEntryName) {\n        await lorebookService.writeToLorebook(sourceEntryName, '', { isEnabled: false, keys: [sourceEntryName] });\n      }\n    }\n    // 3.  prepareReincarnation \n    await prepareReincarnation(world);\n  },\n  selectAvatarAndStart: async (avatarName: string) => {\n    console.log(`[Actions] Avatar \"${avatarName}\" selected. Switching to NORMAL workflow and sending action...`);\n\n    // 1.  gametxt ()\n    const currentNarrative = store.activeView === 'mainWorld' ? store.mainWorldNarrative : store.avatarWorldNarrative;\n    if (currentNarrative) {\n      workflowService.cacheNarrative(currentNarrative);\n    }\n\n    // 2. CoT\n    await workflowService.switchTo('NORMAL');\n\n    // CoTCoT\n    await lorebookService.getEntries(true);\n\n    // 3. \n    const command = ` ${avatarName}`;\n    notificationService.info('', `${avatarName}...`);\n\n    // 4.  handleAction\n    await handleAction(command);\n\n    // 5. \n    store.reincarnationAvatarOptions = [];\n  },\n  setActiveView(view: 'mainWorld' | 'avatarWorld') {\n    store.activeView = view;\n  },\n  switchFocus(targetWorld: 'mainWorld' | 'avatarWorld') {\n    // \n    store.activeView = targetWorld;\n\n    const targetName = targetWorld === 'mainWorld' ? '' : '';\n    const command = ` ${targetName}`;\n    commandService.addCommand(command);\n    notificationService.info('', `${targetName}`);\n  },\n  // \n  addActionToQueue(action: any) {\n    console.warn('[Actions] addActionToQueue is not implemented yet.', action);\n  },\n  resetReincarnationSelection,\n};\n\n/**\n * [Roo-Fix] \n * @param fullMessageContent - AI\n */\nasync function processAndSaveLorebookTags(fullMessageContent: string) {\n  if (!fullMessageContent) return;\n\n  let match;\n  const processLogRegex = /<>([\\s\\S]+?)<\\/>/g;\n  const settlementRegex = /<>([\\s\\S]+?)<\\/>/g;\n  const summaryRegex = /< a_id=\"(.+?)\">([\\s\\S]+?)<\\/>/g;\n  const mainWorldSummaryRegex = /<>([\\s\\S]+?)<\\/>/g;\n  const avatarWorldSummaryRegex = /<>([\\s\\S]+?)<\\/>/g;\n\n  // ---  ---\n  const formatWorldTime = (time: any): string => {\n    if (!time) return new Date().toLocaleString('zh-CN', { hour12: false });\n    const era = get(time, '', '');\n    const year = get(time, '', '----');\n    const month = String(get(time, '', '--')).padStart(2, '0');\n    const day = String(get(time, '', '--')).padStart(2, '0');\n    const hour = String(get(time, '', '--')).padStart(2, '0');\n    const minute = String(get(time, '', '--')).padStart(2, '0');\n    return `${era} ${year}${month}${day} ${hour}:${minute}`;\n  };\n\n  const processAndWriteSummary = async (content: string, entryName: string, toastrTitle: string) => {\n    const existingSummaries = await lorebookService.readFromLorebook(entryName);\n    if (existingSummaries && existingSummaries.includes(content)) {\n      return;\n    }\n    const world = Object.values(get(store.worldState, '', {})).find(\n      (w: any) =>\n        (entryName === '[]' && get(w, '.') === '') ||\n        (entryName === '[]' && get(w, '.') === ''),\n    );\n    let timestamp = new Date().toLocaleString('zh-CN', { hour12: false });\n    if (world) {\n      const currentEpochId = get(world, '.ID');\n      if (currentEpochId) {\n        const currentTime = get(world, `.${currentEpochId}.`);\n        timestamp = formatWorldTime(currentTime);\n      }\n    }\n    notificationService.info(toastrTitle, content);\n    const formattedSummary = `${timestamp}\\n${content}`;\n    await lorebookService.appendToEntry(entryName, formattedSummary, '\\n\\n---\\n\\n');\n  };\n\n  while ((match = summaryRegex.exec(fullMessageContent)) !== null) {\n    const worldId = match[1];\n    const summaryContent = match[2].trim();\n    const world = get(store.worldState, `.${worldId}`);\n    if (world) {\n      const worldName = get(world, '', '');\n      const location = get(world, '.');\n      const entryName = location === '' ? '[]' : '[]';\n      await processAndWriteSummary(summaryContent, entryName, `${worldName} `);\n    }\n  }\n  if ((match = mainWorldSummaryRegex.exec(fullMessageContent)) !== null) {\n    await processAndWriteSummary(match[1].trim(), '[]', '');\n  }\n  if ((match = avatarWorldSummaryRegex.exec(fullMessageContent)) !== null) {\n    await processAndWriteSummary(match[1].trim(), '[]', '');\n  }\n\n  // ---  ---\n  while ((match = processLogRegex.exec(fullMessageContent)) !== null) {\n    const block = parseBlock(match[1]);\n    const newLogEntry: any = {\n      ...block,\n      : parseInt(block[''], 10),\n      : block['']\n        ? block['']\n            .replace(/[[\\]\"]/g, '')\n            .split(',')\n            .map(t => t.trim())\n            .filter(t => t)\n        : [],\n    };\n    if (!store.worldLog.some(log => log. === newLogEntry.)) {\n      store.worldLog.push(newLogEntry);\n    }\n  }\n  store.worldLog.sort((a, b) => a. - b.);\n\n  const latestLog = store.worldLog.length > 0 ? store.worldLog[store.worldLog.length - 1] : null;\n  if (latestLog) {\n    const existingLogs = await lorebookService.readFromLorebook('');\n    const newLogContent = Object.entries(latestLog)\n      .map(([key, value]) => `${key}|${typeof value === 'object' ? JSON.stringify(value, null, 2) : value}`)\n      .join('\\n');\n    if (!existingLogs || !existingLogs.includes(`|${latestLog.}`)) {\n      console.log(`[Actions] Appending new log (: ${latestLog.}) to \"\".`);\n      await lorebookService.appendToEntry('', newLogContent, '\\n\\n---\\n\\n');\n    }\n  }\n\n  // ---  ---\n  if ((match = settlementRegex.exec(fullMessageContent)) !== null) {\n    const block = parseBlock(match[1]);\n    const settlementData = {\n      x: parseInt(block['x'], 10) || 0,\n      : block[''] || '',\n      : block[''] || '',\n      : block[''] || '',\n      : block[''] || '',\n      : block[''] || '',\n      : block[''] || '',\n      : block[''] || '',\n      : block[''] || '',\n    };\n    store.settlementData = settlementData;\n    const settlementContent = Object.entries(settlementData)\n      .map(([key, value]) => `${key}|${value}`)\n      .join('\\n');\n    await lorebookService.writeToLorebook('', settlementContent, { isEnabled: true, keys: [''] });\n    await lorebookService.writeToLorebook('', '', { isEnabled: true, keys: [''] });\n    store.worldLog = [];\n  }\n}\n\n/**\n * \n */\nfunction parseBlock(block: string): { [key: string]: string } {\n  const data: { [key: string]: string } = {};\n  const lines = block.trim().split('\\n');\n  let currentKey = '';\n  for (const line of lines) {\n    const separatorIndex = line.indexOf('|');\n    if (separatorIndex !== -1) {\n      // This line defines a new key-value pair\n      const key = line.substring(0, separatorIndex).trim();\n      const value = line.substring(separatorIndex + 1).trim();\n      data[key] = value;\n      currentKey = key;\n    } else if (currentKey && line.trim()) {\n      // This is a continuation of the previous key's value. Append with a newline.\n      // The `.trim()` check prevents adding empty lines.\n      data[currentKey] += '\\n' + line;\n    }\n  }\n  // Trim the final value for each key to remove leading/trailing whitespace from multi-line content\n  for (const key in data) {\n    data[key] = data[key].trim();\n  }\n  return data;\n}\n","/**\n * AI &#x60;<thinking>&#x60;  &#x60;<gametxt>&#x60; \n * @param text - AI\n * @returns - \n */\nexport function processTags(text: string): string {\n  let processedText = text;\n\n  // \n  //  thinking \n  processedText = processedText.replace(/<\\/?think(ing)?>/g, match => {\n    return match.startsWith('</') ? '</thinking>' : '<thinking>';\n  });\n\n  //  gametxt \n  processedText = processedText.replace(/<\\/?(game-?txt|gamet-?xt|gametxtt)>/g, match => {\n    return match.startsWith('</') ? '</gametxt>' : '<gametxt>';\n  });\n\n  // 1.  <thinking> \n  if (!processedText.includes('<thinking>')) {\n    processedText = '<thinking>\\n</thinking>\\n' + processedText;\n  }\n\n  // 2.  <thinking> \n  const thinkingOpenIndex = processedText.indexOf('<thinking>');\n  const thinkingCloseIndex = processedText.indexOf('</thinking>');\n  const gametxtOpenIndex = processedText.indexOf('<gametxt>');\n\n  if (thinkingOpenIndex !== -1 && thinkingCloseIndex === -1) {\n    if (gametxtOpenIndex !== -1 && gametxtOpenIndex > thinkingOpenIndex) {\n      //  <gametxt> \n      processedText =\n        processedText.slice(0, gametxtOpenIndex) + '</thinking>\\n' + processedText.slice(gametxtOpenIndex);\n    } else {\n      //  <gametxt>\n      processedText += '\\n</thinking>';\n    }\n  }\n\n  // 3.  <thinking>  <  > \n  const thinkingRegex = /<thinking>([\\s\\S]*?)<\\/thinking>/g;\n  processedText = processedText.replace(thinkingRegex, (match, content) => {\n    const sanitizedContent = content.replace(/<|>/g, '');\n    return `<thinking>${sanitizedContent}</thinking>`;\n  });\n\n  //  thinkingCloseIndex\n  const newThinkingCloseIndex = processedText.indexOf('</thinking>');\n\n  // 4.  <gametxt>  </thinking> \n  if (newThinkingCloseIndex !== -1 && !processedText.includes('<gametxt>')) {\n    processedText =\n      processedText.slice(0, newThinkingCloseIndex + '</thinking>'.length) +\n      '\\n<gametxt></gametxt>' +\n      processedText.slice(newThinkingCloseIndex + '</thinking>'.length);\n  }\n\n  // 5.  <gametxt> \n  const gametxtOpenIndexAgain = processedText.indexOf('<gametxt>');\n  const gametxtCloseIndex = processedText.indexOf('</gametxt>');\n\n  if (gametxtOpenIndexAgain !== -1 && gametxtCloseIndex === -1) {\n    //  < \n    const nextTagIndex = processedText.indexOf('<', gametxtOpenIndexAgain + '<gametxt>'.length);\n    if (nextTagIndex !== -1) {\n      processedText = processedText.slice(0, nextTagIndex) + '</gametxt>\\n' + processedText.slice(nextTagIndex);\n    } else {\n      // \n      processedText += '\\n</gametxt>';\n    }\n  }\n\n  return processedText;\n}\n","import { reactive, readonly } from 'vue';\nimport { store } from '../store';\n\ninterface InputModalState {\n  isVisible: boolean;\n  inputValue: string;\n  lastSubmittedValue: string;\n}\n\nconst STORAGE_KEY = 'reincarnation-simulator-input-value';\nconst LAST_SUBMITTED_STORAGE_KEY = 'reincarnation-simulator-last-submitted';\n\nconst state = reactive<InputModalState>({\n  isVisible: false,\n  inputValue: localStorage.getItem(STORAGE_KEY) || '',\n  lastSubmittedValue: localStorage.getItem(LAST_SUBMITTED_STORAGE_KEY) || '',\n});\n\nconst actions = {\n  show(): void {\n    if (store.generationError) {\n      // \n      state.inputValue = state.lastSubmittedValue;\n    }\n    state.isVisible = true;\n  },\n\n  hide(): void {\n    state.isVisible = false;\n  },\n\n  setValue(value: string): void {\n    state.inputValue = value;\n    localStorage.setItem(STORAGE_KEY, value);\n  },\n\n  setLastSubmittedValue(value: string): void {\n    state.lastSubmittedValue = value;\n    localStorage.setItem(LAST_SUBMITTED_STORAGE_KEY, value);\n  },\n\n  clearValue(): void {\n    state.inputValue = '';\n    localStorage.removeItem(STORAGE_KEY);\n  },\n};\n\nexport const inputModalState = readonly(state);\nexport const inputModalActions = actions;\n","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, withModifiers as _withModifiers, withKeys as _withKeys, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"enhanced-input-box-container\" };\nconst _hoisted_2 = { class: \"input-wrapper\" };\nconst _hoisted_3 = [\"value\", \"placeholder\", \"onKeypress\"];\nimport { computed } from 'vue';\nimport { commandService } from '../../services/CommandService';\nimport { inputHistoryService } from '../../services/InputHistoryService';\nimport { inputModalActions, inputModalState } from '../../services/InputModalService';\nimport { workflowService } from '../../services/WorkflowService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'EnhancedInputBox',\n    props: {\n        placeholder: {\n            type: String,\n            default: '...',\n        },\n    },\n    emits: ['submit-action', 'toggle-action-panel'],\n    setup(__props, { emit: __emit }) {\n        const emit = __emit;\n        const inputValue = computed(() => inputModalState.inputValue);\n        const commands = computed(() => commandService.getCommands());\n        const onInput = (event) => {\n            const target = event.target;\n            inputModalActions.setValue(target.value);\n        };\n        const submitAction = () => {\n            const trimmedInput = inputValue.value.trim();\n            const hasCommands = commands.value.length > 0;\n            if (!trimmedInput && !hasCommands) {\n                return;\n            }\n            if (trimmedInput) {\n                inputHistoryService.add(trimmedInput);\n            }\n            let combinedContent = '';\n            if (hasCommands) {\n                combinedContent += '[]\\n' + commands.value.map(cmd => `- ${cmd}`).join('\\n');\n            }\n            if (trimmedInput) {\n                if (hasCommands) {\n                    combinedContent += '\\n';\n                }\n                combinedContent += `<>\\n${trimmedInput}\\n</>`;\n            }\n            workflowService.switchTo('NORMAL', true);\n            emit('submit-action', combinedContent);\n            commandService.clearCommands();\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"button\", {\n                        class: \"action-button activator\",\n                        onClick: _cache[0] || (_cache[0] = ($event) => (_ctx.$emit('toggle-action-panel')))\n                    }, \"\"),\n                    _createElementVNode(\"textarea\", {\n                        value: inputValue.value,\n                        onInput: onInput,\n                        placeholder: __props.placeholder,\n                        onKeypress: _withKeys(_withModifiers(submitAction, [\"exact\", \"prevent\"]), [\"enter\"])\n                    }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_3),\n                    _createElementVNode(\"button\", {\n                        class: \"action-button primary\",\n                        onClick: submitAction\n                    }, \"\")\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./EnhancedInputBox.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./EnhancedInputBox.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./EnhancedInputBox.vue?vue&type=style&index=0&id=1eccedfd&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1eccedfd\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = { class: \"input-history-popup\" };\nconst _hoisted_2 = { class: \"history-section\" };\nconst _hoisted_3 = { key: 0 };\nconst _hoisted_4 = [\"onClick\"];\nconst _hoisted_5 = { class: \"actions\" };\nconst _hoisted_6 = [\"onClick\", \"disabled\"];\nconst _hoisted_7 = [\"onClick\"];\nconst _hoisted_8 = {\n    key: 1,\n    class: \"empty-text\"\n};\nconst _hoisted_9 = { class: \"history-section\" };\nconst _hoisted_10 = { key: 0 };\nconst _hoisted_11 = [\"onClick\"];\nconst _hoisted_12 = { class: \"actions\" };\nconst _hoisted_13 = [\"onClick\"];\nconst _hoisted_14 = {\n    key: 1,\n    class: \"empty-text\"\n};\nimport { inputHistoryService } from '../../services/InputHistoryService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'InputHistoryPopup',\n    emits: ['select-entry', 'close'],\n    setup(__props, { emit: __emit }) {\n        const historyState = inputHistoryService.state;\n        const emit = __emit;\n        const useEntry = (entry) => {\n            emit('select-entry', entry);\n        };\n        const saveEntry = (entry) => {\n            inputHistoryService.save(entry);\n        };\n        const deleteRecentEntry = (index) => {\n            inputHistoryService.deleteRecent(index);\n        };\n        const deleteSavedEntry = (index) => {\n            inputHistoryService.deleteSaved(index);\n        };\n        const isSaved = (entry) => {\n            return historyState.saved.includes(entry);\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[1] || (_cache[1] = _createElementVNode(\"h4\", null, \"\", -1 /* CACHED */)),\n                    (_unref(historyState).recent.length > 0)\n                        ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_3, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(historyState).recent, (entry, index) => {\n                                return (_openBlock(), _createElementBlock(\"li\", {\n                                    key: `recent-${index}`\n                                }, [\n                                    _createElementVNode(\"span\", {\n                                        class: \"entry-text\",\n                                        onClick: ($event) => (useEntry(entry))\n                                    }, _toDisplayString(entry), 9 /* TEXT, PROPS */, _hoisted_4),\n                                    _createElementVNode(\"div\", _hoisted_5, [\n                                        _createElementVNode(\"button\", {\n                                            onClick: ($event) => (saveEntry(entry)),\n                                            disabled: isSaved(entry)\n                                        }, \"\", 8 /* PROPS */, _hoisted_6),\n                                        _createElementVNode(\"button\", {\n                                            onClick: ($event) => (deleteRecentEntry(index))\n                                        }, \"\", 8 /* PROPS */, _hoisted_7)\n                                    ])\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"p\", _hoisted_8, \"\"))\n                ]),\n                _createElementVNode(\"div\", _hoisted_9, [\n                    _cache[2] || (_cache[2] = _createElementVNode(\"h4\", null, \"\", -1 /* CACHED */)),\n                    (_unref(historyState).saved.length > 0)\n                        ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_10, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(historyState).saved, (entry, index) => {\n                                return (_openBlock(), _createElementBlock(\"li\", {\n                                    key: `saved-${index}`\n                                }, [\n                                    _createElementVNode(\"span\", {\n                                        class: \"entry-text\",\n                                        onClick: ($event) => (useEntry(entry))\n                                    }, _toDisplayString(entry), 9 /* TEXT, PROPS */, _hoisted_11),\n                                    _createElementVNode(\"div\", _hoisted_12, [\n                                        _createElementVNode(\"button\", {\n                                            onClick: ($event) => (deleteSavedEntry(index))\n                                        }, \"\", 8 /* PROPS */, _hoisted_13)\n                                    ])\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"p\", _hoisted_14, \"\"))\n                ]),\n                _createElementVNode(\"button\", {\n                    onClick: _cache[0] || (_cache[0] = ($event) => (_ctx.$emit('close'))),\n                    class: \"close-button-popup\"\n                }, \"\")\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./InputHistoryPopup.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./InputHistoryPopup.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./InputHistoryPopup.vue?vue&type=style&index=0&id=4ad5c044&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-4ad5c044\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, Transition as _Transition, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = { class: \"notification__content\" };\nconst _hoisted_2 = { class: \"notification__title\" };\nconst _hoisted_3 = { class: \"notification__message\" };\nimport { notificationService } from '../../services/NotificationService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'Notification',\n    props: {\n        notification: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const hideNotification = () => {\n            notificationService.hide(props.notification.id);\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createBlock(_Transition, { name: \"notification-fade\" }, {\n                default: _withCtx(() => [\n                    _createElementVNode(\"div\", {\n                        class: _normalizeClass(['notification', `notification--${__props.notification.type}`]),\n                        onClick: hideNotification\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_1, [\n                            _createElementVNode(\"h4\", _hoisted_2, _toDisplayString(__props.notification.title), 1 /* TEXT */),\n                            _createElementVNode(\"p\", _hoisted_3, _toDisplayString(__props.notification.message), 1 /* TEXT */)\n                        ]),\n                        _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"notification__arrow\" }, null, -1 /* CACHED */))\n                    ], 2 /* CLASS */)\n                ]),\n                _: 1 /* STABLE */\n            }));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./Notification.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./Notification.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./Notification.vue?vue&type=style&index=0&id=27a32f02&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = { class: \"notification-container\" };\nimport { notificationState } from '../../services/NotificationService';\nimport Notification from './Notification.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NotificationContainer',\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(notificationState).notifications, (notification) => {\n                    return (_openBlock(), _createBlock(Notification, {\n                        key: notification.id,\n                        notification: notification\n                    }, null, 8 /* PROPS */, [\"notification\"]));\n                }), 128 /* KEYED_FRAGMENT */))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NotificationContainer.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NotificationContainer.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NotificationContainer.vue?vue&type=style&index=0&id=fa029a0a&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"icon\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'SideMenuButton',\n    props: {\n        icon: {}\n    },\n    emits: ['open'],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emit = __emit;\n        const handleClick = (event) => {\n            emit('open', { x: event.clientX, y: event.clientY });\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"button\", {\n                class: \"side-menu-button\",\n                onClick: handleClick\n            }, [\n                _createElementVNode(\"span\", _hoisted_1, _toDisplayString(__props.icon), 1 /* TEXT */)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./SideMenuButton.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SideMenuButton.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./SideMenuButton.vue?vue&type=style&index=0&id=5fd70906&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-5fd70906\"]])\n\nexport default __exports__","import { get } from 'lodash';\nimport { computed, reactive } from 'vue';\nimport { store } from '../store';\nimport type { Character } from '../types';\nimport { parseSimpleYaml } from '../utils/yamlParser';\nimport { lorebookService } from './LorebookService';\n\n// ID\nconst locationCache = reactive(new Map<string, { name: string; parentId: string | null }>());\n\n/**\n * NPC\n */\nconst allNpcs = computed(() => {\n  const worldState = store.worldState;\n  if (!worldState?.) return [];\n\n  const avatarId = get(worldState, '...ID');\n  const excludeIds = ['', avatarId].filter(Boolean);\n\n  const allNpcs: Character[] = [];\n  for (const worldId in worldState.) {\n    const world = (worldState. as Record<string, any>)[worldId];\n    if (!world || !world.) continue;\n\n    for (const charId in world.) {\n      // \n      if (charId === '$meta' || excludeIds.includes(charId)) {\n        continue;\n      }\n      // NPC\n      // Additional check to prevent player character from being listed as NPC\n      if (\n        charId === '' ||\n        (worldState. &&\n          worldState.. &&\n          (world. as Record<string, any>)[charId] === worldState..)\n      ) {\n        continue;\n      }\n      allNpcs.push(world.[charId]);\n    }\n  }\n  return allNpcs;\n});\n\n/**\n * IDNPC\n */\nfunction getNpcsByWorld(worldId: string): Character[] {\n  if (!worldId) return [];\n  return allNpcs.value.filter((npc: Character) => {\n    //  Described<string> \n    return npc. === worldId;\n  });\n}\n\n/**\n * \n */\nasync function initializeWorldAndLocationData(): Promise<{ id: string; name: string }[]> {\n  const worlds = store.worldState?.;\n  if (!worlds) {\n    console.warn('[NpcService] worldState. is not available for initialization.');\n    return [];\n  }\n\n  const worldInfoList: { id: string; name: string }[] = [];\n\n  for (const worldId in worlds) {\n    if (worldId === '$meta') continue;\n\n    const world = (worlds as Record<string, any>)[worldId];\n    const worldName = get(world, '');\n\n    if (worldId && worldName) {\n      worldInfoList.push({ id: worldId, name: worldName });\n    }\n\n    // \n    const historicalEpochs = get(world, '.', {});\n    for (const epochId in historicalEpochs) {\n      if (epochId === '$meta') continue;\n      const epoch = (historicalEpochs as Record<string, any>)[epochId];\n      const spatialEntities = get(epoch, '.');\n      // [InitVar].txt \n      if (typeof spatialEntities === 'object' && spatialEntities !== null) {\n        for (const entityId in spatialEntities) {\n          if (entityId === '$meta') continue;\n          const entity = (spatialEntities as Record<string, any>)[entityId];\n          if (entity && entity.) {\n            locationCache.set(entityId, { name: entity., parentId: entity.?.ID || null });\n          }\n        }\n      }\n    }\n  }\n\n  console.log('[NpcService] Initialized worlds and locations from worldState.', worldInfoList);\n  return worldInfoList;\n}\n\nfunction getLocationName(id: string): string {\n  return locationCache.get(id)?.name || id;\n}\n\nfunction getParentLocationName(id: string): string {\n  const parentId = locationCache.get(id)?.parentId;\n  if (!parentId) return '';\n  if (parentId === 'WORLD_ORIGIN') return '';\n  return locationCache.get(parentId)?.name || '';\n}\n\nfunction getNpcNameById(id: string): string {\n  if (id === '') {\n    return store.worldState?.?.?. || '';\n  }\n  const worlds = store.worldState?.;\n  if (!worlds) return id;\n\n  for (const worldId in worlds) {\n    const world = (worlds as Record<string, any>)[worldId];\n    const character = get(world, `.${id}`);\n    if (character && character.) {\n      return character.;\n    }\n  }\n  return id;\n}\n\nfunction getNpcId(npc: Character): string | null {\n  const worldState = store.worldState;\n  if (!worldState?.) return null;\n\n  for (const worldId in worldState.) {\n    const world = (worldState. as Record<string, any>)[worldId];\n    const characters = get(world, '');\n    if (characters) {\n      for (const id in characters) {\n        if ((characters as Record<string, any>)[id] === npc) {\n          return id;\n        }\n      }\n    }\n  }\n  return null;\n}\n\nfunction cacheLocationData(spatialEntities: any[]) {\n  if (Array.isArray(spatialEntities)) {\n    for (const entity of spatialEntities) {\n      if (entity.ID && entity.) {\n        locationCache.set(entity.ID, { name: entity., parentId: entity.?.ID || null });\n      }\n    }\n  }\n}\n\nexport const npcService = {\n  getNpcsByWorld,\n  allNpcs,\n  initializeWorldAndLocationData,\n  getLocationName,\n  getNpcNameById,\n  getNpcId,\n  locationCache,\n  getParentLocationName,\n  cacheLocationData,\n};\n","import { reactive, markRaw, readonly } from 'vue';\nimport type { Component } from 'vue';\n\ninterface DetailModalState {\n  isVisible: boolean;\n  component: Component | null;\n  props: Record<string, any>;\n  title: string;\n}\n\nconst state = reactive<DetailModalState>({\n  isVisible: false,\n  component: null,\n  props: {},\n  title: '',\n});\n\nexport const detailModalService = {\n  /**\n   * The reactive state of the detail modal.\n   */\n  state: readonly(state),\n\n  /**\n   * Shows a modal with a specified component and props.\n   * @param title The title to display in the modal header.\n   * @param component The Vue component to render inside the modal.\n   * @param props The props to pass to the component.\n   */\n  show(title: string, component: Component, props: Record<string, any> = {}) {\n    state.title = title;\n    state.component = markRaw(component);\n    state.props = props;\n    state.isVisible = true;\n  },\n\n  /**\n   * Hides the currently visible modal.\n   */\n  hide() {\n    state.isVisible = false;\n    // Delay clearing to allow for fade-out animations\n    setTimeout(() => {\n      state.component = null;\n      state.props = {};\n      state.title = '';\n    }, 300);\n  },\n};\n","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"npc-info-card\" };\nconst _hoisted_2 = { class: \"info-grid\" };\nconst _hoisted_3 = { class: \"info-item\" };\nconst _hoisted_4 = { class: \"info-item\" };\nconst _hoisted_5 = { class: \"info-item\" };\nconst _hoisted_6 = { class: \"info-item\" };\nconst _hoisted_7 = { class: \"info-item full-width\" };\nconst _hoisted_8 = { class: \"info-item full-width\" };\nconst _hoisted_9 = { class: \"info-item full-width\" };\nimport { computed } from 'vue';\nimport { store } from '../../store';\nimport { calculateAge } from '../../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcInfoCard',\n    props: {\n        npc: {\n            type: Object,\n            required: true,\n        },\n    },\n    setup(__props) {\n        const props = __props;\n        const identities = computed(() => {\n            if (!props.npc.)\n                return '';\n            return Object.values(props.npc.)\n                .filter(val => typeof val === 'string')\n                .join('');\n        });\n        const age = computed(() => {\n            if (!props.npc.)\n                return '';\n            const world = store.worldState?.?.[props.npc.];\n            if (!world)\n                return '';\n            const calculated = calculateAge(props.npc, world);\n            return calculated === null ? '' : calculated;\n        });\n        const getMoodDescription = (emotions) => {\n            if (!emotions)\n                return '';\n            const emotionMapping = {\n                : {\n                    100: '',\n                    90: '',\n                    80: '',\n                    70: '',\n                    60: '',\n                    50: '',\n                    40: '',\n                    30: '',\n                    20: '',\n                    10: '',\n                    0: '',\n                    '-10': '',\n                    '-20': '',\n                    '-30': '',\n                    '-40': '',\n                    '-50': '',\n                    '-60': '',\n                    '-70': '',\n                    '-80': '',\n                    '-90': '',\n                    '-100': '',\n                },\n                : {\n                    100: '',\n                    90: '',\n                    80: '',\n                    70: '',\n                    60: '',\n                    50: '',\n                    40: '',\n                    30: '',\n                    20: '',\n                    10: '',\n                    0: '',\n                    '-10': '',\n                    '-20': '',\n                    '-30': '',\n                    '-40': '',\n                    '-50': '',\n                    '-60': '',\n                    '-70': '',\n                    '-80': '',\n                    '-90': '',\n                    '-100': '',\n                },\n                : {\n                    100: '',\n                    90: '',\n                    80: '',\n                    70: '',\n                    60: '',\n                    50: '',\n                    40: '',\n                    30: '',\n                    20: '',\n                    10: '',\n                    0: '',\n                    '-10': '',\n                    '-20': '',\n                    '-30': '',\n                    '-40': '',\n                    '-50': '',\n                    '-60': '',\n                    '-70': '',\n                    '-80': '',\n                    '-90': '',\n                    '-100': '',\n                },\n                : {\n                    100: '',\n                    90: '',\n                    80: '',\n                    70: '',\n                    60: '',\n                    50: '',\n                    40: '',\n                    30: '',\n                    20: '',\n                    10: '',\n                    0: '',\n                    '-10': '',\n                    '-20': '',\n                    '-30': '',\n                    '-40': '',\n                    '-50': '',\n                    '-60': '',\n                    '-70': '',\n                    '-80': '',\n                    '-90': '',\n                    '-100': '',\n                },\n            };\n            const getDesc = (key, value) => {\n                const map = emotionMapping[key];\n                const sortedKeys = Object.keys(map)\n                    .map(Number)\n                    .sort((a, b) => a - b);\n                if (value >= 0) {\n                    // For positive values, find the largest key that is less than or equal to the value\n                    const foundKey = sortedKeys.reverse().find(k => k >= 0 && value >= k);\n                    return map[foundKey ?? 0];\n                }\n                else {\n                    // For negative values, find the smallest key that is greater than or equal to the value\n                    const foundKey = sortedKeys.find(k => k < 0 && value <= k);\n                    return map[foundKey ?? 0];\n                }\n            };\n            const sortedEmotions = Object.keys(emotions)\n                .map(key => ({ name: key, value: Number(Array.isArray(emotions[key]) ? emotions[key][0] : emotions[key]) }))\n                .filter(e => e.value !== 0)\n                .sort((a, b) => Math.abs(b.value) - Math.abs(a.value));\n            if (sortedEmotions.length === 0)\n                return '';\n            const primary = sortedEmotions[0];\n            const primaryDesc = getDesc(primary.name, primary.value);\n            if (sortedEmotions.length === 1 || Math.abs(sortedEmotions[1].value) < 25) {\n                return primaryDesc;\n            }\n            const secondary = sortedEmotions[1];\n            const secondaryDesc = getDesc(secondary.name, secondary.value).toLowerCase();\n            return `${primaryDesc}${secondaryDesc}`;\n        };\n        const mood = computed(() => {\n            const emotions = props.npc.?.;\n            if (!emotions)\n                return '';\n            return getMoodDescription(emotions);\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _cache[0] || (_cache[0] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.npc. ? `${__props.npc..}${__props.npc..}${__props.npc..}` : ''), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_4, [\n                        _cache[1] || (_cache[1] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.npc. ? __props.npc. : ''), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_5, [\n                        _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(age.value), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_6, [\n                        _cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(mood.value), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_7, [\n                        _cache[4] || (_cache[4] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(identities.value), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_8, [\n                        _cache[5] || (_cache[5] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.npc. ? __props.npc. : ''), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_9, [\n                        _cache[6] || (_cache[6] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.npc. ? __props.npc. : ''), 1 /* TEXT */)\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcInfoCard.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcInfoCard.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcInfoCard.vue?vue&type=style&index=0&id=2d1434f2&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-2d1434f2\"]])\n\nexport default __exports__","/**\n *  { key: \"value\", ... } \n * @param str - \n * @returns \n */\nfunction tryParseObject(str: string): any {\n  str = str.trim();\n  if (str.startsWith('{') && str.endsWith('}')) {\n    try {\n      // \n      const properties = str.slice(1, -1).split(',');\n      const obj: any = {};\n      for (const prop of properties) {\n        const parts = prop.split(':');\n        if (parts.length === 2) {\n          const key = parts[0].trim().replace(/[\"']/g, '');\n          const value = parts[1].trim().replace(/[\"']/g, '');\n          obj[key] = value;\n        }\n      }\n      return obj;\n    } catch (e) {\n      // \n      return str;\n    }\n  }\n  return str;\n}\n\n/**\n * YAMLJavaScript\n * @param text - \n * @returns \n */\nexport function parseSimpleYaml(text: string): any {\n  if (!text) return null;\n\n  const lines = text.split('\\n');\n  const result: any = {};\n  const stack: { obj: any; indent: number }[] = [{ obj: result, indent: -1 }];\n\n  for (const line of lines) {\n    if (line.trim() === '') continue;\n\n    const indent = (line.match(/^\\s*/) || [''])[0].length;\n    const trimmedLine = line.trim();\n\n    while (indent <= stack[stack.length - 1].indent) {\n      stack.pop();\n    }\n\n    const parent = stack[stack.length - 1].obj;\n\n    if (trimmedLine.startsWith('- ')) {\n      const value = trimmedLine.substring(2).trim();\n      // \n      if (Array.isArray(parent)) {\n        //  \"key: value\"\n        const separatorIndex = value.indexOf(':');\n        if (separatorIndex > -1) {\n          const key = value.substring(0, separatorIndex).trim();\n          const val = value.substring(separatorIndex + 1).trim();\n          const newObj: any = {};\n          newObj[key] = val;\n          parent.push(newObj);\n          stack.push({ obj: newObj, indent });\n        } else {\n          parent.push(value);\n        }\n      }\n    } else {\n      const separatorIndex = trimmedLine.indexOf(':');\n      if (separatorIndex > -1) {\n        const key = trimmedLine.substring(0, separatorIndex).trim();\n        const value = trimmedLine.substring(separatorIndex + 1).trim();\n\n        if (value) {\n          parent[key] = tryParseObject(value);\n        } else {\n          // /\n          const nextLineIndex = lines.indexOf(line) + 1;\n          if (nextLineIndex < lines.length && lines[nextLineIndex].trim().startsWith('-')) {\n            const newList: any[] = [];\n            parent[key] = newList;\n            stack.push({ obj: newList, indent });\n          } else {\n            const newObj = {};\n            parent[key] = newObj;\n            stack.push({ obj: newObj, indent });\n          }\n\n          /**\n           *  { key: \"value\", ... } \n           * @param str - \n           * @returns \n           */\n          function tryParseObject(str: string): any {\n            str = str.trim();\n            if (str.startsWith('{') && str.endsWith('}')) {\n              try {\n                // \n                const properties = str.slice(1, -1).split(',');\n                const obj: any = {};\n                for (const prop of properties) {\n                  const parts = prop.split(':');\n                  if (parts.length === 2) {\n                    const key = parts[0].trim().replace(/[\"']/g, '');\n                    const value = parts[1].trim().replace(/[\"']/g, '');\n                    obj[key] = value;\n                  }\n                }\n                return obj;\n              } catch (e) {\n                // \n                return str;\n              }\n            }\n            return str;\n          }\n        }\n      }\n    }\n  }\n\n  // ''\n  if (Object.keys(result).length === 1 && result['']) {\n    return result[''];\n  }\n\n  return result;\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n    key: 0,\n    class: \"location-info-card\"\n};\nconst _hoisted_2 = { class: \"info-grid\" };\nconst _hoisted_3 = { class: \"info-item\" };\nconst _hoisted_4 = { class: \"info-item\" };\nconst _hoisted_5 = { class: \"info-item\" };\nconst _hoisted_6 = { class: \"info-item\" };\nconst _hoisted_7 = { class: \"info-item full-width\" };\nconst _hoisted_8 = {\n    key: 1,\n    class: \"loading-placeholder\"\n};\nimport { ref, onMounted, computed } from 'vue';\nimport { lorebookService } from '../../services/LorebookService';\nimport { parseSimpleYaml } from '../../utils/yamlParser';\nimport { npcService } from '../../services/NpcService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'LocationInfoCard',\n    props: {\n        locationId: {\n            type: String,\n            required: true,\n        },\n    },\n    setup(__props) {\n        const props = __props;\n        const locationDetails = ref(null);\n        const parentLocationName = computed(() => {\n            if (!locationDetails.value)\n                return '';\n            return npcService.getParentLocationName(props.locationId);\n        });\n        const cleanValue = (value) => {\n            if (typeof value !== 'string')\n                return value;\n            return value.replace(/[\"'\\[\\]]/g, '');\n        };\n        const formatArea = (area) => {\n            if (!area)\n                return '';\n            const cleaned = cleanValue(String(area));\n            const parts = cleaned.split(',');\n            return parts.join(' ');\n        };\n        const formatCoordinates = (coords) => {\n            if (!coords)\n                return '';\n            try {\n                const refId = cleanValue(coords.ID);\n                const refName = npcService.getLocationName(refId);\n                const bearingString = cleanValue(coords.);\n                const bearingParts = bearingString.split(',');\n                const direction = bearingParts[0] || '';\n                const angle = bearingParts[1] || '';\n                const distanceString = cleanValue(String(coords.));\n                const distanceParts = distanceString.split(',');\n                const value = distanceParts[0] || '';\n                const unit = distanceParts[1] || '';\n                return ` ${refName} ${value}${unit} ${direction}${angle}`;\n            }\n            catch (e) {\n                console.error('Error formatting coordinates:', e);\n                return '';\n            }\n        };\n        onMounted(async () => {\n            const entries = await lorebookService.getEntries();\n            if (!entries)\n                return;\n            const allEntities = [];\n            // 1. Gather all spatial entities from all lorebook entries\n            for (const entry of entries) {\n                if (entry.content) {\n                    try {\n                        const parsed = parseSimpleYaml(entry.content);\n                        if (parsed?.) {\n                            for (const epochId in parsed.) {\n                                const epoch = parsed.[epochId];\n                                const spatialEntities = epoch?.?.;\n                                if (Array.isArray(spatialEntities)) {\n                                    allEntities.push(...spatialEntities);\n                                }\n                            }\n                        }\n                    }\n                    catch (e) {\n                        // silent\n                    }\n                }\n            }\n            // 2. Populate the cache with all found entities\n            npcService.cacheLocationData(allEntities);\n            // 3. Find the details for the current location\n            const found = allEntities.find(e => e.ID === props.locationId);\n            if (found) {\n                locationDetails.value = found;\n            }\n        });\n        return (_ctx, _cache) => {\n            return (locationDetails.value)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                    _createElementVNode(\"div\", _hoisted_2, [\n                        _createElementVNode(\"div\", _hoisted_3, [\n                            _cache[0] || (_cache[0] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"span\", null, _toDisplayString(cleanValue(locationDetails.value.)), 1 /* TEXT */)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_4, [\n                            _cache[1] || (_cache[1] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"span\", null, _toDisplayString(parentLocationName.value), 1 /* TEXT */)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_5, [\n                            _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"span\", null, _toDisplayString(formatArea(locationDetails.value.)), 1 /* TEXT */)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_6, [\n                            _cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"span\", null, _toDisplayString(formatCoordinates(locationDetails.value.)), 1 /* TEXT */)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_7, [\n                            _cache[4] || (_cache[4] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"span\", null, _toDisplayString(cleanValue(locationDetails.value.)), 1 /* TEXT */)\n                        ])\n                    ])\n                ]))\n                : (_openBlock(), _createElementBlock(\"div\", _hoisted_8, \"...\"));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./LocationInfoCard.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./LocationInfoCard.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./LocationInfoCard.vue?vue&type=style&index=0&id=d56cb894&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-d56cb894\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = { class: \"database-item-card\" };\nconst _hoisted_2 = { class: \"info-grid\" };\nconst _hoisted_3 = { class: \"info-item\" };\nconst _hoisted_4 = { class: \"info-item\" };\nconst _hoisted_5 = { class: \"info-item\" };\nconst _hoisted_6 = { class: \"info-item full-width\" };\nconst _hoisted_7 = {\n    key: 0,\n    class: \"info-item full-width\"\n};\nimport { computed } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'DatabaseItemCard',\n    props: {\n        item: {\n            type: Object,\n            required: true,\n        },\n    },\n    setup(__props) {\n        const props = __props;\n        const effects = computed(() => {\n            if (!props.item.effects)\n                return null;\n            const { attributes_bonus, percentage_bonus } = props.item.effects;\n            const parts = [];\n            if (attributes_bonus) {\n                for (const key in attributes_bonus) {\n                    if (key === '$meta')\n                        continue;\n                    parts.push(`${key} +${attributes_bonus[key]}`);\n                }\n            }\n            if (percentage_bonus) {\n                for (const key in percentage_bonus) {\n                    if (key === '$meta')\n                        continue;\n                    parts.push(`${key} +${percentage_bonus[key]}`);\n                }\n            }\n            return parts.join('');\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _cache[0] || (_cache[0] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.item. || ''), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_4, [\n                        _cache[1] || (_cache[1] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.item. || ''), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_5, [\n                        _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.item. ?? ''), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_6, [\n                        _cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.item. || ''), 1 /* TEXT */)\n                    ]),\n                    (effects.value)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [\n                            _cache[4] || (_cache[4] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"span\", null, _toDisplayString(effects.value), 1 /* TEXT */)\n                        ]))\n                        : _createCommentVNode(\"v-if\", true)\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./DatabaseItemCard.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DatabaseItemCard.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./DatabaseItemCard.vue?vue&type=style&index=0&id=7d2511ac&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7d2511ac\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"game-text-container\" };\nconst _hoisted_2 = [\"onClick\"];\nimport { computed } from 'vue';\nimport { npcService } from '../../services/NpcService';\nimport { detailModalService } from '../../services/DetailModalService';\nimport NpcInfoCard from './NpcInfoCard.vue';\nimport LocationInfoCard from './LocationInfoCard.vue';\nimport DatabaseItemCard from './DatabaseItemCard.vue';\nimport { store } from '../../store';\nimport { mainWorld, avatarWorld } from '../../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'FormattedTextRenderer',\n    props: {\n        text: {\n            type: String,\n            required: true,\n        },\n    },\n    setup(__props) {\n        const props = __props;\n        const npcNamesRegex = computed(() => {\n            const names = npcService.allNpcs.value.map(npc => (Array.isArray(npc.) ? npc.[0] : npc.)).filter(Boolean);\n            if (names.length === 0)\n                return null;\n            const escapedNames = names.map(name => name.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'));\n            return new RegExp(`(${escapedNames.join('|')})`, 'g');\n        });\n        const locationNamesRegex = computed(() => {\n            const names = Array.from(npcService.locationCache.values()).map(loc => loc.name);\n            if (names.length === 0)\n                return null;\n            const escapedNames = names.map(name => name.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'));\n            return new RegExp(`(${escapedNames.join('|')})`, 'g');\n        });\n        const activeWorld = computed(() => (store.activeView === 'mainWorld' ? mainWorld.value : avatarWorld.value));\n        const databaseItemNamesRegex = computed(() => {\n            const database = activeWorld.value?.;\n            if (!database)\n                return null;\n            const names = [];\n            for (const category in database) {\n                if (category === '$meta')\n                    continue;\n                const categoryStore = database[category];\n                if (categoryStore) {\n                    for (const itemId in categoryStore) {\n                        if (itemId === '$meta')\n                            continue;\n                        const item = categoryStore[itemId];\n                        if (item && item.) {\n                            names.push(item.);\n                        }\n                    }\n                }\n            }\n            if (names.length === 0)\n                return null;\n            const escapedNames = names.map(name => name.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'));\n            return new RegExp(`(${escapedNames.join('|')})`, 'g');\n        });\n        const segments = computed(() => {\n            if (!props.text)\n                return [];\n            const cleanText = props.text.replace(/<[^>]*>/g, '');\n            return parseText(cleanText);\n        });\n        function parseText(text) {\n            const segments = [];\n            const regex = /(.*?)|(.*?)|(.*?)|(\\*.*?\\*)/g;\n            let lastIndex = 0;\n            let match;\n            while ((match = regex.exec(text)) !== null) {\n                if (match.index > lastIndex) {\n                    segments.push(...parseEntities(text.substring(lastIndex, match.index)));\n                }\n                const matchedText = match[0];\n                let innerText = '';\n                let outerClass = '';\n                if (match[1]) {\n                    innerText = matchedText.slice(2, -2);\n                    outerClass = 'text-system-highlight';\n                }\n                else if (match[2]) {\n                    innerText = matchedText.slice(1, -1);\n                    outerClass = 'text-scenery';\n                }\n                else if (match[3]) {\n                    innerText = matchedText.slice(1, -1);\n                    outerClass = 'text-dialogue';\n                }\n                else if (match[4]) {\n                    innerText = matchedText.slice(1, -1);\n                    outerClass = 'text-psychology';\n                }\n                const innerSegments = parseEntities(innerText);\n                innerSegments.forEach(segment => {\n                    const combinedClass = Array.isArray(segment.class)\n                        ? [outerClass, ...segment.class]\n                        : [outerClass, segment.class].filter(Boolean);\n                    segments.push({ ...segment, class: combinedClass });\n                });\n                lastIndex = match.index + matchedText.length;\n            }\n            if (lastIndex < text.length) {\n                segments.push(...parseEntities(text.substring(lastIndex)));\n            }\n            return segments;\n        }\n        function parseEntities(text) {\n            const segments = [];\n            const entityRegexParts = [];\n            if (npcNamesRegex.value)\n                entityRegexParts.push(npcNamesRegex.value.source);\n            if (locationNamesRegex.value)\n                entityRegexParts.push(locationNamesRegex.value.source);\n            if (databaseItemNamesRegex.value)\n                entityRegexParts.push(databaseItemNamesRegex.value.source);\n            if (entityRegexParts.length === 0) {\n                return [{ text, class: '' }];\n            }\n            const entityRegex = new RegExp(entityRegexParts.join('|'), 'g');\n            let lastIndex = 0;\n            let match;\n            while ((match = entityRegex.exec(text)) !== null) {\n                if (match.index > lastIndex) {\n                    segments.push({ text: text.substring(lastIndex, match.index), class: '' });\n                }\n                const name = match[0];\n                const npc = npcService.allNpcs.value.find(n => (Array.isArray(n.) ? n.[0] : n.) === name);\n                const locId = [...npcService.locationCache.entries()].find(([id, loc]) => loc.name === name)?.[0];\n                const item = getItemFromDatabase(name);\n                if (npc) {\n                    const relationshipClass = getNpcRelationshipClass(npc);\n                    segments.push({ text: name, class: ['npc-name', relationshipClass], npc });\n                }\n                else if (locId) {\n                    segments.push({ text: name, class: 'location-name', locationId: locId });\n                }\n                else if (item) {\n                    segments.push({ text: name, class: 'database-item-name', item });\n                }\n                else {\n                    segments.push({ text: name, class: '' });\n                }\n                lastIndex = match.index + name.length;\n            }\n            if (lastIndex < text.length) {\n                segments.push({ text: text.substring(lastIndex), class: '' });\n            }\n            return segments;\n        }\n        const showNpcInfo = (npc) => {\n            if (!npc)\n                return;\n            const npcName = Array.isArray(npc.) ? npc.[0] : npc.;\n            detailModalService.show(npcName, NpcInfoCard, { npc });\n        };\n        const showLocationInfo = (locationId) => {\n            if (!locationId)\n                return;\n            const locationName = npcService.getLocationName(locationId);\n            detailModalService.show(locationName, LocationInfoCard, { locationId });\n        };\n        const showDatabaseItemInfo = (item) => {\n            if (!item)\n                return;\n            detailModalService.show(item., DatabaseItemCard, { item });\n        };\n        function getItemFromDatabase(name) {\n            const database = activeWorld.value?.;\n            if (!database)\n                return null;\n            for (const category in database) {\n                if (category === '$meta')\n                    continue;\n                const categoryStore = database[category];\n                if (categoryStore) {\n                    for (const itemId in categoryStore) {\n                        if (itemId === '$meta')\n                            continue;\n                        const item = categoryStore[itemId];\n                        if (item && item. === name) {\n                            return item;\n                        }\n                    }\n                }\n            }\n            return null;\n        }\n        function getNpcRelationshipClass(npc) {\n            const npcId = npcService.getNpcId(npc);\n            const causalNet = activeWorld.value?.;\n            if (!npcId || !causalNet || !causalNet[npcId]?.['']) {\n                return 'npc-unknown';\n            }\n            const relationship = causalNet[npcId][''];\n            const emotionalSum = (relationship.?. || 0) + (relationship.?. || 0);\n            if (emotionalSum <= -150)\n                return 'npc-hostile-intense';\n            if (emotionalSum <= -50)\n                return 'npc-hostile';\n            if (emotionalSum < 0)\n                return 'npc-unfriendly';\n            if (emotionalSum < 50)\n                return 'npc-neutral';\n            if (emotionalSum < 100)\n                return 'npc-friendly';\n            if (emotionalSum < 150)\n                return 'npc-devoted';\n            return 'npc-fanatical';\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(segments.value, (segment, index) => {\n                    return (_openBlock(), _createElementBlock(\"span\", {\n                        key: index,\n                        class: _normalizeClass(segment.class),\n                        onClick: ($event) => (segment.npc\n                            ? showNpcInfo(segment.npc)\n                            : segment.locationId\n                                ? showLocationInfo(segment.locationId)\n                                : segment.item\n                                    ? showDatabaseItemInfo(segment.item)\n                                    : null)\n                    }, _toDisplayString(segment.text), 11 /* TEXT, CLASS, PROPS */, _hoisted_2));\n                }), 128 /* KEYED_FRAGMENT */))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./FormattedTextRenderer.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./FormattedTextRenderer.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./FormattedTextRenderer.vue?vue&type=style&index=0&id=3a06b63d&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3a06b63d\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n    class: \"main-content-wrapper\",\n    ref: \"mainContentWrapper\"\n};\nimport { combinedNarrative } from './store/getters';\nimport FormattedTextRenderer from './components/common/FormattedTextRenderer.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'MainView',\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createVNode(FormattedTextRenderer, { text: _unref(combinedNarrative) }, null, 8 /* PROPS */, [\"text\"])\n            ], 512 /* NEED_PATCH */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./MainView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MainView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MainView.vue?vue&type=style&index=0&id=6c66b638&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeStyle as _normalizeStyle } from \"vue\";\nconst _hoisted_1 = { class: \"destiny-plate-container\" };\nconst _hoisted_2 = { class: \"destiny-plate\" };\nconst _hoisted_3 = { class: \"plate-center\" };\nconst _hoisted_4 = { class: \"plate-core\" };\nconst _hoisted_5 = { class: \"core-title\" };\nconst _hoisted_6 = { class: \"core-description\" };\nconst _hoisted_7 = { class: \"inner-ring\" };\nconst _hoisted_8 = [\"onMouseenter\"];\nconst _hoisted_9 = { class: \"node-name\" };\nconst _hoisted_10 = { class: \"node-value\" };\nconst _hoisted_11 = { class: \"middle-ring\" };\nconst _hoisted_12 = [\"onMouseenter\"];\nconst _hoisted_13 = { class: \"node-name\" };\nconst _hoisted_14 = { class: \"node-value\" };\nconst _hoisted_15 = { class: \"outer-ring\" };\nconst _hoisted_16 = {\n    class: \"orbit-svg\",\n    viewBox: \"0 0 100 100\"\n};\nconst _hoisted_17 = [\"onMouseenter\"];\nconst _hoisted_18 = [\"onMouseenter\"];\nconst _hoisted_19 = { class: \"node-name\" };\nconst _hoisted_20 = {\n    key: 0,\n    class: \"node-value\"\n};\nimport { computed, ref } from 'vue';\nimport { store } from '../../store';\nconst defaultTitle = '';\nconst defaultDescription = '';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'DestinyPlate',\n    props: {\n        character: {\n            type: Object,\n            default: null,\n        },\n    },\n    setup(__props) {\n        const props = __props;\n        const centerTitle = ref(defaultTitle);\n        const centerDescription = ref(defaultDescription);\n        const getDisplayValue = (value, defaultValue = 0) => {\n            if (value === null || value === undefined)\n                return defaultValue;\n            return value;\n        };\n        const formatComplexValue = (value) => {\n            if (value === null || value === undefined)\n                return null;\n            if (typeof value === 'object' && !Array.isArray(value)) {\n                const keys = Object.keys(value).filter(k => k !== '$meta' && k !== 'description');\n                if (keys.includes('value'))\n                    return getDisplayValue(value.value);\n                if (keys.length > 0 && keys.every(k => typeof value[k] === 'object' && value[k]?.)) {\n                    return value[keys[0]].; // \n                }\n                if (keys.length === 1)\n                    return formatComplexValue(value[keys[0]]);\n                return '...';\n            }\n            return value;\n        };\n        //  prop store\n        const characterData = computed(() => props.character || store.character);\n        // \n        const innerRingNodes = computed(() => {\n            const char = characterData.value;\n            return [\n                { id: 'name', name: '', value: getDisplayValue(char?., ''), description: '' },\n                { id: 'soul', name: '', value: getDisplayValue(char?., 0), description: '' },\n                { id: 'dao', name: '', value: getDisplayValue(char?., 0), description: '' },\n                {\n                    id: 'jing',\n                    name: '',\n                    value: getDisplayValue(char?.?.),\n                    description: '',\n                },\n                { id: 'qi', name: '', value: getDisplayValue(char?.?.), description: '' },\n                { id: 'shen', name: '', value: getDisplayValue(char?.?.), description: '' },\n                { id: 'yun', name: '', value: getDisplayValue(char?.?.), description: '' },\n            ];\n        });\n        // \n        const combatParams = computed(() => {\n            const char = characterData.value;\n            return [\n                {\n                    id: 'quanneng',\n                    name: '',\n                    value: getDisplayValue(char?.?.),\n                    description: '',\n                },\n                {\n                    id: 'genji',\n                    name: '',\n                    value: getDisplayValue(char?.?.),\n                    description: '',\n                },\n                {\n                    id: 'jibian',\n                    name: '',\n                    value: getDisplayValue(char?.?.),\n                    description: '',\n                },\n                {\n                    id: 'pofa',\n                    name: '',\n                    value: getDisplayValue(char?.?.),\n                    description: '',\n                },\n                {\n                    id: 'yufa',\n                    name: '',\n                    value: getDisplayValue(char?.?.),\n                    description: '',\n                },\n            ];\n        });\n        // \n        const orbitalNodes = computed(() => {\n            const char = characterData.value;\n            if (!char || !char.)\n                return [];\n            const attrs = char.;\n            const world = store.worldState?.?.[char.];\n            const currentEpochId = world?.?.?.ID;\n            const currentEpoch = currentEpochId ? world?..?.[currentEpochId] : null;\n            const attributeTemplates = currentEpoch?.?.;\n            const specialKeys = ['', ''];\n            return Object.entries(attrs)\n                .filter(([key]) => key !== '$meta')\n                .map(([key, attrValue]) => {\n                const template = attributeTemplates ? attributeTemplates[key] : null;\n                const name = template?. || key;\n                const isSpecial = specialKeys.includes(name);\n                let description = template?. || `: ${name}`;\n                let value = null;\n                let type = 'node';\n                let max = 'MAX';\n                if (typeof attrValue === 'object' && attrValue !== null) {\n                    description = attrValue.description || description;\n                    const valueKeys = Object.keys(attrValue).filter(k => k !== '$meta' && k !== 'description');\n                    if (('current' in attrValue || '' in attrValue) && ('max' in attrValue || '' in attrValue)) {\n                        type = 'orbit';\n                        value = getDisplayValue(attrValue. ?? attrValue.current, 0);\n                        max = getDisplayValue(attrValue. ?? attrValue.max, 100);\n                        description = `${name}: ${value} / ${max}`;\n                    }\n                    else if ('value' in attrValue) {\n                        value = getDisplayValue(attrValue.value, '-');\n                    }\n                    else if (valueKeys.length > 0 &&\n                        valueKeys.every(k => typeof attrValue[k] === 'object' && attrValue[k]?.)) {\n                        value = valueKeys.map(k => attrValue[k].).join('');\n                    }\n                    else if (valueKeys.length > 0) {\n                        value = '...';\n                        // ,\n                        const innerDescription = Object.keys(attrValue)\n                            .filter(k => k !== '$meta' && k !== 'description' && k !== '')\n                            .map(k => `${k}: ${getDisplayValue(attrValue[k])}`)\n                            .join(' | ');\n                        description = innerDescription;\n                    }\n                }\n                else {\n                    value = getDisplayValue(attrValue, '-');\n                }\n                return { id: key, name: name, value, max, type, description, isSpecial };\n            });\n        });\n        const setCenterContent = (item) => {\n            centerTitle.value = item.name;\n            centerDescription.value = item.description || '';\n        };\n        const resetCenterContent = () => {\n            centerTitle.value = defaultTitle;\n            centerDescription.value = defaultDescription;\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createCommentVNode(\"  \"),\n                    _cache[1] || (_cache[1] = _createElementVNode(\"div\", { class: \"static-orbit orbit-1\" }, null, -1 /* CACHED */)),\n                    _cache[2] || (_cache[2] = _createElementVNode(\"div\", { class: \"static-orbit orbit-2\" }, null, -1 /* CACHED */)),\n                    _cache[3] || (_cache[3] = _createElementVNode(\"div\", { class: \"static-orbit orbit-3\" }, null, -1 /* CACHED */)),\n                    _cache[4] || (_cache[4] = _createElementVNode(\"div\", { class: \"static-orbit orbit-4\" }, null, -1 /* CACHED */)),\n                    _createCommentVNode(\"  \"),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _createElementVNode(\"div\", _hoisted_4, [\n                            _createElementVNode(\"span\", _hoisted_5, _toDisplayString(centerTitle.value), 1 /* TEXT */),\n                            _createElementVNode(\"div\", _hoisted_6, _toDisplayString(centerDescription.value), 1 /* TEXT */)\n                        ])\n                    ]),\n                    _createCommentVNode(\" :  \"),\n                    _createElementVNode(\"div\", _hoisted_7, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(innerRingNodes.value, (node, index) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: node.id,\n                                class: \"node inner-node\",\n                                style: _normalizeStyle({ '--angle': (index / innerRingNodes.value.length) * 360 + 'deg' }),\n                                onMouseenter: ($event) => (setCenterContent(node)),\n                                onMouseleave: resetCenterContent\n                            }, [\n                                _createElementVNode(\"span\", _hoisted_9, _toDisplayString(node.name), 1 /* TEXT */),\n                                _createElementVNode(\"span\", _hoisted_10, _toDisplayString(node.value), 1 /* TEXT */)\n                            ], 44 /* STYLE, PROPS, NEED_HYDRATION */, _hoisted_8));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]),\n                    _createCommentVNode(\" :  \"),\n                    _createElementVNode(\"div\", _hoisted_11, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(combatParams.value, (param, index) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: param.id,\n                                class: \"node param-node\",\n                                style: _normalizeStyle({ '--angle': (index / combatParams.value.length) * 360 + 18 + 'deg' }),\n                                onMouseenter: ($event) => (setCenterContent(param)),\n                                onMouseleave: resetCenterContent\n                            }, [\n                                _createElementVNode(\"span\", _hoisted_13, _toDisplayString(param.name), 1 /* TEXT */),\n                                _createElementVNode(\"span\", _hoisted_14, _toDisplayString(param.value), 1 /* TEXT */)\n                            ], 44 /* STYLE, PROPS, NEED_HYDRATION */, _hoisted_12));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]),\n                    _createCommentVNode(\" :  \"),\n                    _createElementVNode(\"div\", _hoisted_15, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(orbitalNodes.value, (attr, index) => {\n                            return (_openBlock(), _createElementBlock(_Fragment, {\n                                key: attr.id\n                            }, [\n                                _createCommentVNode(\"  'orbit'  \"),\n                                (attr.type === 'orbit')\n                                    ? (_openBlock(), _createElementBlock(\"div\", {\n                                        key: 0,\n                                        class: \"orbit-track\",\n                                        style: _normalizeStyle({ '--angle': (index / orbitalNodes.value.length) * 360 + 'deg' })\n                                    }, [\n                                        (_openBlock(), _createElementBlock(\"svg\", _hoisted_16, [\n                                            _cache[0] || (_cache[0] = _createElementVNode(\"circle\", {\n                                                class: \"track\",\n                                                cx: \"50\",\n                                                cy: \"50\",\n                                                r: \"45\"\n                                            }, null, -1 /* CACHED */)),\n                                            _createElementVNode(\"circle\", {\n                                                class: \"progress\",\n                                                cx: \"50\",\n                                                cy: \"50\",\n                                                r: \"45\",\n                                                style: _normalizeStyle({\n                                                    'stroke-dashoffset': 283 *\n                                                        (1 -\n                                                            (typeof attr.value === 'number' && typeof attr.max === 'number' && attr.max > 0\n                                                                ? attr.value / attr.max\n                                                                : 0)),\n                                                })\n                                            }, null, 4 /* STYLE */)\n                                        ])),\n                                        _createElementVNode(\"div\", {\n                                            class: \"orbit-label\",\n                                            onMouseenter: ($event) => (setCenterContent(attr)),\n                                            onMouseleave: resetCenterContent\n                                        }, _toDisplayString(attr.name), 41 /* TEXT, PROPS, NEED_HYDRATION */, _hoisted_17)\n                                    ], 4 /* STYLE */))\n                                    : (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                                        _createCommentVNode(\"  'node'  \"),\n                                        _createElementVNode(\"div\", {\n                                            class: \"node world-node\",\n                                            style: _normalizeStyle({ '--angle': (index / orbitalNodes.value.length) * 360 + 'deg' }),\n                                            onMouseenter: ($event) => (setCenterContent(attr)),\n                                            onMouseleave: resetCenterContent\n                                        }, [\n                                            _createElementVNode(\"span\", _hoisted_19, _toDisplayString(attr.name), 1 /* TEXT */),\n                                            (attr.value !== null)\n                                                ? (_openBlock(), _createElementBlock(\"span\", _hoisted_20, _toDisplayString(attr.value), 1 /* TEXT */))\n                                                : _createCommentVNode(\"v-if\", true)\n                                        ], 44 /* STYLE, PROPS, NEED_HYDRATION */, _hoisted_18)\n                                    ], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */))\n                            ], 64 /* STABLE_FRAGMENT */));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./DestinyPlate.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DestinyPlate.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./DestinyPlate.vue?vue&type=style&index=0&id=9b407cc8&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-9b407cc8\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, createCommentVNode as _createCommentVNode, createVNode as _createVNode, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"panel-wrapper character-panel-container\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"character-sheet\"\n};\nconst _hoisted_3 = { class: \"drawer-content\" };\nconst _hoisted_4 = { class: \"world-attributes-section\" };\nconst _hoisted_5 = {\n    key: 0,\n    class: \"attributes-list\"\n};\nconst _hoisted_6 = { class: \"label\" };\nconst _hoisted_7 = { class: \"value\" };\nconst _hoisted_8 = {\n    key: 1,\n    class: \"empty-state\"\n};\nconst _hoisted_9 = { class: \"combat-attributes-section\" };\nconst _hoisted_10 = {\n    key: 0,\n    class: \"attributes-list\"\n};\nconst _hoisted_11 = { class: \"label\" };\nconst _hoisted_12 = { class: \"value\" };\nconst _hoisted_13 = {\n    key: 1,\n    class: \"empty-state\"\n};\nconst _hoisted_14 = {\n    key: 1,\n    class: \"loading-state\"\n};\nimport { computed, ref } from 'vue';\nimport { currentAvatar } from '../../../store/getters';\nimport DestinyPlate from '../DestinyPlate.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'AvatarCharacterPanel',\n    setup(__props) {\n        const getDisplayValue = (value, defaultValue = 0) => {\n            if (value === null || value === undefined)\n                return defaultValue;\n            return value;\n        };\n        const formatAttribute = (attr) => {\n            if (attr === null || attr === undefined)\n                return '-';\n            if (typeof attr === 'object' && !Array.isArray(attr)) {\n                if (attr. !== undefined && attr. !== undefined) {\n                    return `${attr.} / ${attr.}`;\n                }\n                const keys = Object.keys(attr).filter(k => k !== '$meta');\n                if (keys.length > 0) {\n                    return Object.entries(attr)\n                        .filter(([key]) => key !== '$meta')\n                        .map(([key, val]) => `${key}: ${getDisplayValue(val)}`)\n                        .join(', ');\n                }\n                return '';\n            }\n            return String(getDisplayValue(attr));\n        };\n        const worldSpecificAttributes = computed(() => currentAvatar.value?. || {});\n        const combatAttributes = computed(() => currentAvatar.value?. || {});\n        const isDrawerOpen = ref(false);\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (_unref(currentAvatar))\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _createCommentVNode(\"  \"),\n                        _createVNode(DestinyPlate, { character: _unref(currentAvatar) }, null, 8 /* PROPS */, [\"character\"]),\n                        _createCommentVNode(\"  \"),\n                        _createElementVNode(\"div\", {\n                            class: _normalizeClass([\"additional-info-drawer\", { 'is-open': isDrawerOpen.value }])\n                        }, [\n                            _createElementVNode(\"button\", {\n                                class: \"drawer-toggle\",\n                                onClick: _cache[0] || (_cache[0] = ($event) => (isDrawerOpen.value = !isDrawerOpen.value))\n                            }, [...(_cache[1] || (_cache[1] = [\n                                    _createElementVNode(\"i\", { class: \"drawer-icon\" }, null, -1 /* CACHED */),\n                                    _createElementVNode(\"span\", null, \"\", -1 /* CACHED */)\n                                ]))]),\n                            _createElementVNode(\"div\", _hoisted_3, [\n                                _createCommentVNode(\"  \"),\n                                _createElementVNode(\"div\", _hoisted_4, [\n                                    _cache[2] || (_cache[2] = _createElementVNode(\"h5\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                                    (worldSpecificAttributes.value && Object.keys(worldSpecificAttributes.value).length > 0)\n                                        ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_5, [\n                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(worldSpecificAttributes.value, (value, key) => {\n                                                return (_openBlock(), _createElementBlock(\"li\", {\n                                                    key: key,\n                                                    class: \"attribute-item\"\n                                                }, [\n                                                    _createElementVNode(\"span\", _hoisted_6, _toDisplayString(key), 1 /* TEXT */),\n                                                    _createElementVNode(\"span\", _hoisted_7, _toDisplayString(formatAttribute(value)), 1 /* TEXT */)\n                                                ]));\n                                            }), 128 /* KEYED_FRAGMENT */))\n                                        ]))\n                                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_8, \"\"))\n                                ]),\n                                _createCommentVNode(\"  \"),\n                                _createElementVNode(\"div\", _hoisted_9, [\n                                    _cache[3] || (_cache[3] = _createElementVNode(\"h5\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                                    (combatAttributes.value && Object.keys(combatAttributes.value).length > 0)\n                                        ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_10, [\n                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(combatAttributes.value, (value, key) => {\n                                                return (_openBlock(), _createElementBlock(\"li\", {\n                                                    key: key,\n                                                    class: \"attribute-item\"\n                                                }, [\n                                                    _createElementVNode(\"span\", _hoisted_11, _toDisplayString(key), 1 /* TEXT */),\n                                                    _createElementVNode(\"span\", _hoisted_12, _toDisplayString(formatAttribute(value)), 1 /* TEXT */)\n                                                ]));\n                                            }), 128 /* KEYED_FRAGMENT */))\n                                        ]))\n                                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_13, \"\"))\n                                ])\n                            ])\n                        ], 2 /* CLASS */)\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_14, \"...\"))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./AvatarCharacterPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AvatarCharacterPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./AvatarCharacterPanel.vue?vue&type=style&index=0&id=8e022938&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-8e022938\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, normalizeStyle as _normalizeStyle, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"panel-wrapper inventory-panel\" };\nconst _hoisted_2 = { class: \"main-content\" };\nconst _hoisted_3 = { class: \"item-grid-container\" };\nconst _hoisted_4 = { class: \"item-grid\" };\nconst _hoisted_5 = [\"onClick\"];\nconst _hoisted_6 = {\n    class: \"item-name-arc\",\n    viewBox: \"0 0 100 100\"\n};\nconst _hoisted_7 = [\"id\"];\nconst _hoisted_8 = [\"xlink:href\"];\nconst _hoisted_9 = { class: \"item-footer\" };\nconst _hoisted_10 = {\n    key: 0,\n    class: \"item-quantity\"\n};\nconst _hoisted_11 = {\n    key: 0,\n    class: \"empty-grid\"\n};\nconst _hoisted_12 = { class: \"scroll-detail-view\" };\nconst _hoisted_13 = {\n    key: 0,\n    class: \"scroll-content\"\n};\nconst _hoisted_14 = { class: \"detail-meta\" };\nconst _hoisted_15 = {\n    key: 0,\n    class: \"meta-tier\"\n};\nconst _hoisted_16 = {\n    key: 1,\n    class: \"meta-type\"\n};\nconst _hoisted_17 = { class: \"detail-desc\" };\nconst _hoisted_18 = {\n    key: 0,\n    class: \"detail-effects\"\n};\nconst _hoisted_19 = { key: 0 };\nconst _hoisted_20 = { key: 1 };\nconst _hoisted_21 = {\n    key: 1,\n    class: \"loading\"\n};\nimport { computed, ref } from 'vue';\nimport { currentAvatar, avatarInventory } from '../../../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'AvatarInventoryPanel',\n    setup(__props) {\n        const selectedItem = ref(null);\n        const selectItem = (item) => {\n            selectedItem.value = item;\n        };\n        const closeDetail = () => {\n            selectedItem.value = null;\n        };\n        const avatarItems = computed(() => {\n            return avatarInventory.value;\n        });\n        const tierColorMap = {\n            common: '128, 128, 128', // grey-stone\n            rare: '45, 200, 240', // cyan-tian\n            epic: '138, 43, 226', // purple-mystery\n            legendary: '218, 165, 32', // gold-liu\n        };\n        const getTierStyle = (item) => {\n            let tierKey = 'common';\n            if (item && item.) {\n                const tier = item.;\n                if (tier >= 9)\n                    tierKey = 'legendary';\n                else if (tier >= 6)\n                    tierKey = 'epic';\n                else if (tier >= 3)\n                    tierKey = 'rare';\n            }\n            return {\n                '--tier-color-rgb': tierColorMap[tierKey],\n            };\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (_unref(currentAvatar))\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 0,\n                        class: _normalizeClass([\"inventory-layout\", { 'detail-open': selectedItem.value }])\n                    }, [\n                        _createCommentVNode(\" Main Content: Categories and Grid \"),\n                        _createElementVNode(\"div\", _hoisted_2, [\n                            _createCommentVNode(\"  \"),\n                            _createElementVNode(\"div\", _hoisted_3, [\n                                _createElementVNode(\"div\", _hoisted_4, [\n                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(avatarItems.value, (item, index) => {\n                                        return (_openBlock(), _createElementBlock(_Fragment, {\n                                            key: item.ID || `item-${index}`\n                                        }, [\n                                            _createCommentVNode(\"  \"),\n                                            _createElementVNode(\"div\", {\n                                                class: \"item-cell\",\n                                                style: _normalizeStyle(getTierStyle(item)),\n                                                onClick: ($event) => (selectItem(item))\n                                            }, [\n                                                _createCommentVNode(\" SVG \"),\n                                                (_openBlock(), _createElementBlock(\"svg\", _hoisted_6, [\n                                                    _createElementVNode(\"defs\", null, [\n                                                        _createCommentVNode(\"  \"),\n                                                        _createElementVNode(\"path\", {\n                                                            id: `arc-path-${item.ID || index}`,\n                                                            d: \"M 12,52 a 38,38 0 1,1 76,0\",\n                                                            fill: \"none\"\n                                                        }, null, 8 /* PROPS */, _hoisted_7)\n                                                    ]),\n                                                    _createElementVNode(\"text\", null, [\n                                                        _createElementVNode(\"textPath\", {\n                                                            class: \"arc-text\",\n                                                            \"xlink:href\": `#arc-path-${item.ID || index}`,\n                                                            startOffset: \"50%\",\n                                                            \"text-anchor\": \"middle\"\n                                                        }, _toDisplayString(item.), 9 /* TEXT, PROPS */, _hoisted_8)\n                                                    ])\n                                                ])),\n                                                _createElementVNode(\"div\", _hoisted_9, [\n                                                    ('' in item && item.)\n                                                        ? (_openBlock(), _createElementBlock(\"span\", _hoisted_10, \"x\" + _toDisplayString(item.), 1 /* TEXT */))\n                                                        : _createCommentVNode(\"v-if\", true)\n                                                ])\n                                            ], 12 /* STYLE, PROPS */, _hoisted_5)\n                                        ], 64 /* STABLE_FRAGMENT */));\n                                    }), 128 /* KEYED_FRAGMENT */))\n                                ]),\n                                (avatarItems.value.length === 0)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [...(_cache[0] || (_cache[0] = [\n                                            _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                                        ]))]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ])\n                        ]),\n                        _createCommentVNode(\" Right: Item Detail Scroll \"),\n                        _createElementVNode(\"div\", _hoisted_12, [\n                            (selectedItem.value)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_13, [\n                                    _createElementVNode(\"button\", {\n                                        onClick: closeDetail,\n                                        class: \"close-button\"\n                                    }, \"\"),\n                                    _createElementVNode(\"h4\", {\n                                        class: \"detail-name\",\n                                        style: _normalizeStyle(getTierStyle(selectedItem.value))\n                                    }, _toDisplayString(selectedItem.value.), 5 /* TEXT, STYLE */),\n                                    _createElementVNode(\"div\", _hoisted_14, [\n                                        (selectedItem.value.)\n                                            ? (_openBlock(), _createElementBlock(\"span\", _hoisted_15, \" \" + _toDisplayString(selectedItem.value.), 1 /* TEXT */))\n                                            : _createCommentVNode(\"v-if\", true),\n                                        (selectedItem.value.)\n                                            ? (_openBlock(), _createElementBlock(\"span\", _hoisted_16, _toDisplayString(selectedItem.value.), 1 /* TEXT */))\n                                            : _createCommentVNode(\"v-if\", true)\n                                    ]),\n                                    _createElementVNode(\"p\", _hoisted_17, _toDisplayString(selectedItem.value.), 1 /* TEXT */),\n                                    (selectedItem.value.effects)\n                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_18, [\n                                            _cache[1] || (_cache[1] = _createElementVNode(\"h5\", null, \":\", -1 /* CACHED */)),\n                                            (selectedItem.value.effects.attributes_bonus && Object.keys(selectedItem.value.effects.attributes_bonus).length > 0)\n                                                ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_19, [\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(selectedItem.value.effects.attributes_bonus, (value, key) => {\n                                                        return (_openBlock(), _createElementBlock(\"li\", { key: key }, _toDisplayString(key) + \" +\" + _toDisplayString(value), 1 /* TEXT */));\n                                                    }), 128 /* KEYED_FRAGMENT */))\n                                                ]))\n                                                : _createCommentVNode(\"v-if\", true),\n                                            (selectedItem.value.effects.percentage_bonus && Object.keys(selectedItem.value.effects.percentage_bonus).length > 0)\n                                                ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_20, [\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(selectedItem.value.effects.percentage_bonus, (value, key) => {\n                                                        return (_openBlock(), _createElementBlock(\"li\", { key: key }, _toDisplayString(key) + \" \" + _toDisplayString(value), 1 /* TEXT */));\n                                                    }), 128 /* KEYED_FRAGMENT */))\n                                                ]))\n                                                : _createCommentVNode(\"v-if\", true)\n                                        ]))\n                                        : _createCommentVNode(\"v-if\", true)\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ])\n                    ], 2 /* CLASS */))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_21, \"...\"))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./AvatarInventoryPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AvatarInventoryPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./AvatarInventoryPanel.vue?vue&type=style&index=0&id=ca49a7a8&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-ca49a7a8\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeClass as _normalizeClass, normalizeStyle as _normalizeStyle, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, unref as _unref } from \"vue\";\nconst _hoisted_1 = { class: \"panel-wrapper tasks-panel-starmap\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"starmap-container\"\n};\nconst _hoisted_3 = { class: \"starmap-svg\" };\nconst _hoisted_4 = [\"d\"];\nconst _hoisted_5 = [\"onClick\"];\nconst _hoisted_6 = { class: \"star-label\" };\nconst _hoisted_7 = [\"onClick\"];\nconst _hoisted_8 = { class: \"detail-desc\" };\nconst _hoisted_9 = { class: \"detail-meta\" };\nconst _hoisted_10 = { key: 0 };\nconst _hoisted_11 = { key: 1 };\nconst _hoisted_12 = { key: 2 };\nconst _hoisted_13 = { key: 3 };\nconst _hoisted_14 = {\n    key: 1,\n    class: \"no-data\"\n};\nimport { get } from 'lodash';\nimport { computed, reactive, ref } from 'vue';\nimport { currentAvatar } from '../../../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'AvatarTasksPanel',\n    setup(__props) {\n        const destiny = computed(() => get(currentAvatar.value, '', null));\n        // [Roo-Fix]  getItemsArray \n        const getItemsArray = (data) => {\n            if (!Array.isArray(data)) {\n                return [];\n            }\n            //  [ [items], \"desc\" ]  [ [items] ]\n            if (Array.isArray(data[0])) {\n                return data[0];\n            }\n            //  [items] ()\n            return data;\n        };\n        const allTasks = computed(() => {\n            if (!destiny.value)\n                return [];\n            const taskObject = get(destiny.value, '', {});\n            return Object.values(taskObject);\n        });\n        const ultimateTask = computed(() => {\n            if (!destiny.value)\n                return null;\n            return get(destiny.value, '', null);\n        });\n        const destinyNodes = computed(() => {\n            return allTasks.value.filter(task => task. === '');\n        });\n        const derivedTasks = computed(() => {\n            return allTasks.value.filter(task => task. === '');\n        });\n        const selectedNode = ref(null);\n        const detailModalStyle = reactive({ top: '0px', left: '0px', transform: 'translate(-50%, -50%)' });\n        const getTaskNameById = (taskId) => {\n            if (!taskId)\n                return '';\n            const task = allTasks.value.find(t => t.ID === taskId);\n            return task ? task. : taskId;\n        };\n        const starPositions = computed(() => {\n            const positions = [];\n            const totalNodes = destinyNodes.value.length;\n            positions.push({ top: '15%', left: '50%' });\n            const startY = 85;\n            const endY = 30;\n            destinyNodes.value.forEach((_, i) => {\n                const progress = totalNodes > 1 ? i / (totalNodes - 1) : 0.5;\n                const y = startY - (startY - endY) * progress;\n                const x = 50 + 20 * Math.sin(progress * Math.PI * 2);\n                positions.push({ top: `${y}%`, left: `${x}%` });\n            });\n            return positions;\n        });\n        const starPaths = computed(() => {\n            if (starPositions.value.length <= 1)\n                return [];\n            const paths = [];\n            for (let i = 0; i < destinyNodes.value.length - 1; i++) {\n                const startPos = starPositions.value[i + 1];\n                const endPos = starPositions.value[i + 2];\n                const d = `M ${parseFloat(startPos.left)} ${parseFloat(startPos.top)} Q ${(parseFloat(startPos.left) + parseFloat(endPos.left)) / 2} ${(parseFloat(startPos.top) + parseFloat(endPos.top)) / 2} ${parseFloat(endPos.left)} ${parseFloat(endPos.top)}`;\n                paths.push({\n                    d,\n                    class: destinyNodes.value[i + 1]. === '' ? 'star-path triggered' : 'star-path',\n                });\n            }\n            if (destinyNodes.value.length > 0) {\n                const lastNodePos = starPositions.value[destinyNodes.value.length];\n                const ultimatePos = starPositions.value[0];\n                const d = `M ${parseFloat(lastNodePos.left)} ${parseFloat(lastNodePos.top)} Q ${(parseFloat(lastNodePos.left) + parseFloat(ultimatePos.left)) / 2} ${(parseFloat(lastNodePos.top) + parseFloat(ultimatePos.top)) / 2} ${parseFloat(ultimatePos.left)} ${parseFloat(ultimatePos.top)}`;\n                paths.push({\n                    d,\n                    class: destinyNodes.value[destinyNodes.value.length - 1]. === '' ? 'star-path triggered' : 'star-path',\n                });\n            }\n            derivedTasks.value.forEach((task, index) => {\n                const parentNode = destinyNodes.value.find(n => n.ID === task.ID);\n                if (parentNode) {\n                    const parentNodeIndex = destinyNodes.value.indexOf(parentNode);\n                    const parentPos = starPositions.value[parentNodeIndex + 1];\n                    const taskPos = getDerivedStarPosition(task, index);\n                    const d = `M ${parseFloat(parentPos.left)} ${parseFloat(parentPos.top)} L ${parseFloat(taskPos.left.replace('calc(', '').replace(')', ''))} ${parseFloat(taskPos.top.replace('calc(', '').replace(')', ''))}`;\n                    paths.push({\n                        d,\n                        class: 'star-path derived-path',\n                    });\n                }\n            });\n            return paths;\n        });\n        const getDerivedStarPosition = (task, index) => {\n            const parentNode = destinyNodes.value.find(n => n.ID === task.ID);\n            if (!parentNode)\n                return { top: '0%', left: '0%' };\n            const parentNodeIndex = destinyNodes.value.indexOf(parentNode);\n            const parentPos = starPositions.value[parentNodeIndex + 1];\n            const offsetX = (index % 2 === 0 ? 5 : -5) * (Math.floor(index / 2) + 1);\n            const offsetY = (index % 2 === 0 ? -5 : 5) * (Math.floor(index / 2) + 1);\n            return {\n                top: `calc(${parentPos.top} + ${offsetY}%)`,\n                left: `calc(${parentPos.left} + ${offsetX}%)`,\n            };\n        };\n        const selectNode = (nodeData, type, event) => {\n            selectedNode.value = { data: nodeData, type, el: event.currentTarget };\n            const starNode = event.currentTarget;\n            const top = `calc(${starNode.style.top} + 20px)`;\n            const left = `calc(${starNode.style.left} + 20px)`;\n            detailModalStyle.top = top;\n            detailModalStyle.left = left;\n        };\n        const startDrag = (event) => {\n            const modal = event.target.closest('.node-detail-modal');\n            if (!modal)\n                return;\n            const startX = event.clientX;\n            const startY = event.clientY;\n            const startTop = modal.offsetTop;\n            const startLeft = modal.offsetLeft;\n            const doDrag = (e) => {\n                detailModalStyle.top = `${startTop + e.clientY - startY}px`;\n                detailModalStyle.left = `${startLeft + e.clientX - startX}px`;\n            };\n            const stopDrag = () => {\n                document.removeEventListener('mousemove', doDrag);\n                document.removeEventListener('mouseup', stopDrag);\n            };\n            document.addEventListener('mousemove', doDrag);\n            document.addEventListener('mouseup', stopDrag);\n        };\n        const getStarPosition = (index) => {\n            return starPositions.value[index] || { top: '50%', left: '50%' };\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (destiny.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        (_openBlock(), _createElementBlock(\"svg\", _hoisted_3, [\n                            _cache[2] || (_cache[2] = _createElementVNode(\"defs\", null, [\n                                _createElementVNode(\"linearGradient\", {\n                                    id: \"grad-triggered\",\n                                    x1: \"0%\",\n                                    y1: \"0%\",\n                                    x2: \"0%\",\n                                    y2: \"100%\"\n                                }, [\n                                    _createElementVNode(\"stop\", {\n                                        offset: \"0%\",\n                                        style: { \"stop-color\": \"rgba(0, 255, 255, 0.8)\" }\n                                    }),\n                                    _createElementVNode(\"stop\", {\n                                        offset: \"100%\",\n                                        style: { \"stop-color\": \"rgba(138, 43, 226, 0.8)\" }\n                                    })\n                                ])\n                            ], -1 /* CACHED */)),\n                            _createCommentVNode(\"  \"),\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(starPaths.value, (path) => {\n                                return (_openBlock(), _createElementBlock(\"path\", {\n                                    key: path.d,\n                                    d: path.d,\n                                    class: _normalizeClass(path.class)\n                                }, null, 10 /* CLASS, PROPS */, _hoisted_4));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ])),\n                        _createCommentVNode(\"  () \"),\n                        (ultimateTask.value)\n                            ? (_openBlock(), _createElementBlock(\"div\", {\n                                key: 0,\n                                class: \"star-node ultimate-star\",\n                                style: _normalizeStyle(getStarPosition(0)),\n                                onClick: _cache[0] || (_cache[0] = ($event) => (selectNode(ultimateTask.value, 'ultimate', $event)))\n                            }, [...(_cache[3] || (_cache[3] = [\n                                    _createElementVNode(\"div\", { class: \"star-core\" }, null, -1 /* CACHED */),\n                                    _createElementVNode(\"div\", { class: \"star-label\" }, \"\", -1 /* CACHED */)\n                                ]))], 4 /* STYLE */))\n                            : _createCommentVNode(\"v-if\", true),\n                        _createCommentVNode(\"  () \"),\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(destinyNodes.value, (node, index) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: node.ID,\n                                class: _normalizeClass([\"star-node destiny-star\", { triggered: node. === '' }]),\n                                style: _normalizeStyle(getStarPosition(index + 1)),\n                                onClick: ($event) => (selectNode(node, 'destiny', $event))\n                            }, [\n                                _cache[4] || (_cache[4] = _createElementVNode(\"div\", { class: \"star-core\" }, null, -1 /* CACHED */)),\n                                _createElementVNode(\"div\", _hoisted_6, _toDisplayString(node.), 1 /* TEXT */)\n                            ], 14 /* CLASS, STYLE, PROPS */, _hoisted_5));\n                        }), 128 /* KEYED_FRAGMENT */)),\n                        _createCommentVNode(\"  () \"),\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(derivedTasks.value, (task, index) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: task.ID,\n                                class: \"star-node derived-star\",\n                                style: _normalizeStyle(getDerivedStarPosition(task, index)),\n                                onClick: ($event) => (selectNode(task, 'derived', $event))\n                            }, [...(_cache[5] || (_cache[5] = [\n                                    _createElementVNode(\"div\", { class: \"star-core\" }, null, -1 /* CACHED */)\n                                ]))], 12 /* STYLE, PROPS */, _hoisted_7));\n                        }), 128 /* KEYED_FRAGMENT */)),\n                        _createCommentVNode(\"  \"),\n                        (selectedNode.value)\n                            ? (_openBlock(), _createElementBlock(\"div\", {\n                                key: 1,\n                                class: \"node-detail-modal\",\n                                style: _normalizeStyle(detailModalStyle)\n                            }, [\n                                _createElementVNode(\"h4\", {\n                                    class: \"detail-title\",\n                                    onMousedown: startDrag\n                                }, _toDisplayString(selectedNode.value.data.), 33 /* TEXT, NEED_HYDRATION */),\n                                _createElementVNode(\"p\", _hoisted_8, _toDisplayString(selectedNode.value.data.), 1 /* TEXT */),\n                                _createElementVNode(\"div\", _hoisted_9, [\n                                    (selectedNode.value.data.)\n                                        ? (_openBlock(), _createElementBlock(\"p\", _hoisted_10, [\n                                            _cache[6] || (_cache[6] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                            _createTextVNode(\" \" + _toDisplayString(selectedNode.value.data.), 1 /* TEXT */)\n                                        ]))\n                                        : _createCommentVNode(\"v-if\", true),\n                                    (selectedNode.value.data.)\n                                        ? (_openBlock(), _createElementBlock(\"p\", _hoisted_11, [\n                                            _cache[7] || (_cache[7] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                            _createTextVNode(\" \" + _toDisplayString(selectedNode.value.data.), 1 /* TEXT */)\n                                        ]))\n                                        : _createCommentVNode(\"v-if\", true),\n                                    (selectedNode.value.data.ID)\n                                        ? (_openBlock(), _createElementBlock(\"p\", _hoisted_12, [\n                                            _cache[8] || (_cache[8] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                            _createTextVNode(\" \" + _toDisplayString(getTaskNameById(selectedNode.value.data.ID)), 1 /* TEXT */)\n                                        ]))\n                                        : _createCommentVNode(\"v-if\", true),\n                                    (selectedNode.value.type === 'ultimate' && selectedNode.value.data.)\n                                        ? (_openBlock(), _createElementBlock(\"p\", _hoisted_13, [\n                                            _cache[9] || (_cache[9] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                            _createTextVNode(\" \" + _toDisplayString(selectedNode.value.data..join(', ')), 1 /* TEXT */)\n                                        ]))\n                                        : _createCommentVNode(\"v-if\", true)\n                                ]),\n                                _createElementVNode(\"button\", {\n                                    class: \"close-button\",\n                                    onClick: _cache[1] || (_cache[1] = ($event) => (selectedNode.value = null))\n                                }, \"\")\n                            ], 4 /* STYLE */))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_14, [\n                        _createElementVNode(\"p\", null, _toDisplayString(_unref(currentAvatar) ? '' : ''), 1 /* TEXT */)\n                    ]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./AvatarTasksPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AvatarTasksPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./AvatarTasksPanel.vue?vue&type=style&index=0&id=1f7a99f8&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1f7a99f8\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createVNode as _createVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"panel-wrapper character-panel-container\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"character-sheet\"\n};\nconst _hoisted_3 = { class: \"drawer-content\" };\nconst _hoisted_4 = { class: \"info-item\" };\nconst _hoisted_5 = { class: \"value\" };\nconst _hoisted_6 = { class: \"info-item\" };\nconst _hoisted_7 = { class: \"value\" };\nconst _hoisted_8 = { class: \"world-attributes-section\" };\nconst _hoisted_9 = {\n    key: 0,\n    class: \"attributes-list\"\n};\nconst _hoisted_10 = { class: \"label\" };\nconst _hoisted_11 = { class: \"value\" };\nconst _hoisted_12 = {\n    key: 1,\n    class: \"empty-state\"\n};\nconst _hoisted_13 = {\n    key: 1,\n    class: \"loading-state\"\n};\nimport { computed, ref } from 'vue';\nimport { playerWorldAttributes } from '../../store/getters';\nimport { store } from '../../store';\nimport DestinyPlate from './DestinyPlate.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'CharacterPanel',\n    setup(__props) {\n        const getDisplayValue = (value, defaultValue = 0) => {\n            if (value === null || value === undefined)\n                return defaultValue;\n            return value;\n        };\n        const formatAttributeValue = (attrValue) => {\n            if (attrValue === null || attrValue === undefined)\n                return '-';\n            if (typeof attrValue === 'object' && !Array.isArray(attrValue)) {\n                //  ''  key\n                const { , ...rest } = attrValue;\n                const keys = Object.keys(rest).filter(k => k !== '$meta' && k !== 'description');\n                if (keys.length === 0)\n                    return ''; // \n                // Case 1: Progress bar\n                if (rest.current !== undefined && rest.max !== undefined) {\n                    return `${rest.current} / ${rest.max}`;\n                }\n                if (rest. !== undefined && rest. !== undefined) {\n                    return `${rest.} / ${rest.}`;\n                }\n                // Case 2: Simple value wrapper\n                if (rest.value !== undefined && keys.length === 1) {\n                    return String(getDisplayValue(rest.value));\n                }\n                // Case 3: List of named items\n                if (keys.length > 0 && keys.every(k => typeof rest[k] === 'object' && rest[k]?.)) {\n                    return keys.map(k => rest[k].).join('');\n                }\n                // Case 4: Composite structure\n                if (keys.length > 0) {\n                    return keys.map(key => `${key}: ${getDisplayValue(rest[key])}`).join(' | ');\n                }\n                return '...';\n            }\n            return String(getDisplayValue(attrValue));\n        };\n        const character = computed(() => store.character);\n        const soulOrigin = computed(() => getDisplayValue(character.value?., 0));\n        const daoHeart = computed(() => getDisplayValue(character.value?., 0));\n        const worldAttributes = playerWorldAttributes;\n        const isDrawerOpen = ref(false);\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (character.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _createCommentVNode(\"  \"),\n                        _createVNode(DestinyPlate, { character: character.value }, null, 8 /* PROPS */, [\"character\"]),\n                        _createCommentVNode(\"  \"),\n                        _createElementVNode(\"div\", {\n                            class: _normalizeClass([\"additional-info-drawer\", { 'is-open': isDrawerOpen.value }])\n                        }, [\n                            _createElementVNode(\"button\", {\n                                class: \"drawer-toggle\",\n                                onClick: _cache[0] || (_cache[0] = ($event) => (isDrawerOpen.value = !isDrawerOpen.value))\n                            }, [...(_cache[1] || (_cache[1] = [\n                                    _createElementVNode(\"i\", { class: \"drawer-icon\" }, null, -1 /* CACHED */),\n                                    _createElementVNode(\"span\", null, \"\", -1 /* CACHED */)\n                                ]))]),\n                            _createElementVNode(\"div\", _hoisted_3, [\n                                _createElementVNode(\"div\", _hoisted_4, [\n                                    _cache[2] || (_cache[2] = _createElementVNode(\"span\", { class: \"label\" }, \":\", -1 /* CACHED */)),\n                                    _createElementVNode(\"span\", _hoisted_5, _toDisplayString(getDisplayValue(character.value., '')), 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_6, [\n                                    _cache[3] || (_cache[3] = _createElementVNode(\"span\", { class: \"label\" }, \":\", -1 /* CACHED */)),\n                                    _createElementVNode(\"span\", _hoisted_7, _toDisplayString(daoHeart.value), 1 /* TEXT */)\n                                ]),\n                                _createCommentVNode(\"  \"),\n                                _createElementVNode(\"div\", _hoisted_8, [\n                                    _cache[4] || (_cache[4] = _createElementVNode(\"h5\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                                    (_unref(worldAttributes).length > 0)\n                                        ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_9, [\n                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(worldAttributes), (attr) => {\n                                                return (_openBlock(), _createElementBlock(\"li\", {\n                                                    key: attr.key,\n                                                    class: \"attribute-item\"\n                                                }, [\n                                                    _createElementVNode(\"span\", _hoisted_10, _toDisplayString(attr.key), 1 /* TEXT */),\n                                                    _createElementVNode(\"span\", _hoisted_11, _toDisplayString(formatAttributeValue(attr.value)), 1 /* TEXT */)\n                                                ]));\n                                            }), 128 /* KEYED_FRAGMENT */))\n                                        ]))\n                                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_12, \"\"))\n                                ])\n                            ])\n                        ], 2 /* CLASS */)\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_13, \"...\"))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./CharacterPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CharacterPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./CharacterPanel.vue?vue&type=style&index=0&id=1f5e6bd7&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1f5e6bd7\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n    key: 0,\n    class: \"imprint-detail-modal-content\"\n};\nconst _hoisted_2 = { class: \"imprint-header\" };\nconst _hoisted_3 = { class: \"imprint-name\" };\nconst _hoisted_4 = { class: \"imprint-tags\" };\nconst _hoisted_5 = { class: \"tag type-tag\" };\nconst _hoisted_6 = [\"data-level\"];\nconst _hoisted_7 = { class: \"imprint-body\" };\nconst _hoisted_8 = { class: \"imprint-main-display\" };\nconst _hoisted_9 = [\"data-level\"];\nconst _hoisted_10 = { class: \"imprint-description\" };\nconst _hoisted_11 = { class: \"imprint-effects\" };\nconst _hoisted_12 = {\n    key: 0,\n    class: \"effects-list\"\n};\nconst _hoisted_13 = { class: \"effect-type\" };\nconst _hoisted_14 = { class: \"effect-value\" };\nconst _hoisted_15 = { class: \"effect-type\" };\nconst _hoisted_16 = { class: \"effect-value\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ImprintDetailModal',\n    props: {\n        imprint: {}\n    },\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (__props.imprint)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                    _createElementVNode(\"div\", _hoisted_2, [\n                        _createElementVNode(\"h2\", _hoisted_3, _toDisplayString(__props.imprint.), 1 /* TEXT */),\n                        _createElementVNode(\"div\", _hoisted_4, [\n                            _createElementVNode(\"span\", _hoisted_5, _toDisplayString(__props.imprint.), 1 /* TEXT */),\n                            _createElementVNode(\"span\", {\n                                class: \"tag level-tag\",\n                                \"data-level\": __props.imprint.\n                            }, \" \" + _toDisplayString(__props.imprint.), 9 /* TEXT, PROPS */, _hoisted_6)\n                        ])\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_7, [\n                        _createElementVNode(\"div\", _hoisted_8, [\n                            _createElementVNode(\"div\", {\n                                class: \"imprint-mandala\",\n                                \"data-level\": __props.imprint.\n                            }, [\n                                _createCommentVNode(\" Central visual element, can be an icon or complex SVG \"),\n                                _cache[0] || (_cache[0] = _createElementVNode(\"span\", { class: \"mandala-icon\" }, \"\", -1 /* CACHED */))\n                            ], 8 /* PROPS */, _hoisted_9),\n                            _createElementVNode(\"p\", _hoisted_10, _toDisplayString(__props.imprint.), 1 /* TEXT */)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_11, [\n                            _cache[3] || (_cache[3] = _createElementVNode(\"h3\", { class: \"effects-title\" }, \"\", -1 /* CACHED */)),\n                            (__props.imprint.effects)\n                                ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_12, [\n                                    (__props.imprint.effects.attributes_bonus)\n                                        ? (_openBlock(true), _createElementBlock(_Fragment, { key: 0 }, _renderList(__props.imprint.effects.attributes_bonus, (value, key) => {\n                                            return (_openBlock(), _createElementBlock(\"li\", {\n                                                key: key,\n                                                class: \"effect-item\"\n                                            }, [\n                                                _createElementVNode(\"strong\", _hoisted_13, _toDisplayString(key) + \":\", 1 /* TEXT */),\n                                                _createElementVNode(\"span\", _hoisted_14, \"+\" + _toDisplayString(value), 1 /* TEXT */),\n                                                _cache[1] || (_cache[1] = _createElementVNode(\"p\", { class: \"effect-description\" }, \"\", -1 /* CACHED */))\n                                            ]));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                        : _createCommentVNode(\"v-if\", true),\n                                    (__props.imprint.effects.percentage_bonus)\n                                        ? (_openBlock(true), _createElementBlock(_Fragment, { key: 1 }, _renderList(__props.imprint.effects.percentage_bonus, (value, key) => {\n                                            return (_openBlock(), _createElementBlock(\"li\", {\n                                                key: key,\n                                                class: \"effect-item\"\n                                            }, [\n                                                _createElementVNode(\"strong\", _hoisted_15, _toDisplayString(key) + \":\", 1 /* TEXT */),\n                                                _createElementVNode(\"span\", _hoisted_16, _toDisplayString(value), 1 /* TEXT */),\n                                                _cache[2] || (_cache[2] = _createElementVNode(\"p\", { class: \"effect-description\" }, \"\", -1 /* CACHED */))\n                                            ]));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                        : _createCommentVNode(\"v-if\", true)\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ])\n                    ])\n                ]))\n                : _createCommentVNode(\"v-if\", true);\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ImprintDetailModal.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ImprintDetailModal.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"panel-wrapper imprints-panel-container\" };\nconst _hoisted_2 = { class: \"imprints-grid\" };\nconst _hoisted_3 = [\"data-level\", \"onClick\"];\nconst _hoisted_4 = { class: \"imprint-name\" };\nconst _hoisted_5 = { class: \"imprint-level\" };\nconst _hoisted_6 = {\n    key: 1,\n    class: \"empty-text\"\n};\nimport { computed } from 'vue';\nimport { reincarnationImprints } from '../../store/getters';\nimport { detailModalService } from '../../services/DetailModalService';\nimport ImprintDetailModal from '../modals/ImprintDetailModal.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ImprintsPanel',\n    setup(__props) {\n        const imprints = computed(() => reincarnationImprints.value);\n        const openImprintDetail = (imprint) => {\n            detailModalService.show(imprint., ImprintDetailModal, { imprint });\n        };\n        // Ensure there are always 9 items for the layout, and filter out placeholders\n        const paddedImprints = computed(() => {\n            const validImprints = imprints.value || [];\n            const result = [...validImprints];\n            while (result.length < 9) {\n                result.push(null);\n            }\n            return result.slice(0, 9);\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(paddedImprints.value, (imprint, index) => {\n                        return (_openBlock(), _createElementBlock(\"div\", {\n                            key: index,\n                            class: _normalizeClass([\"imprint-slot\", { empty: !imprint, clickable: !!imprint }]),\n                            \"data-level\": imprint?.,\n                            onClick: ($event) => (imprint && openImprintDetail(imprint))\n                        }, [\n                            imprint\n                                ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                                    _createElementVNode(\"div\", _hoisted_4, _toDisplayString(imprint.), 1 /* TEXT */),\n                                    _createElementVNode(\"div\", _hoisted_5, \": \" + _toDisplayString(imprint.), 1 /* TEXT */)\n                                ], 64 /* STABLE_FRAGMENT */))\n                                : (_openBlock(), _createElementBlock(\"div\", _hoisted_6, \"\"))\n                        ], 10 /* CLASS, PROPS */, _hoisted_3));\n                    }), 128 /* KEYED_FRAGMENT */))\n                ]),\n                _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"detail-placeholder\" }, [\n                    _createElementVNode(\"p\", null, \"\")\n                ], -1 /* CACHED */))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ImprintsPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ImprintsPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ImprintsPanel.vue?vue&type=style&index=0&id=dcca238c&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-dcca238c\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeStyle as _normalizeStyle, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n    key: 0,\n    class: \"item-detail-panel\"\n};\nconst _hoisted_2 = { class: \"detail-name\" };\nconst _hoisted_3 = { class: \"detail-meta\" };\nconst _hoisted_4 = { class: \"meta-type\" };\nconst _hoisted_5 = { class: \"detail-desc\" };\nconst _hoisted_6 = {\n    key: 0,\n    class: \"detail-effects\"\n};\nconst _hoisted_7 = { key: 0 };\nconst _hoisted_8 = { key: 0 };\nconst _hoisted_9 = { key: 1 };\nconst _hoisted_10 = { key: 0 };\nconst _hoisted_11 = {\n    key: 1,\n    class: \"empty-detail\"\n};\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ItemDetailPanel',\n    props: {\n        item: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const tierColorMap = {\n            common: '#a0a0a0',\n            rare: '#3a8f9d',\n            epic: '#8a5db5',\n            legendary: '#d4af37',\n        };\n        const getTierStyle = (item, isText = false) => {\n            let tierKey = 'common';\n            if (item && item.) {\n                const tier = item.;\n                if (tier >= 9)\n                    tierKey = 'legendary';\n                else if (tier >= 6)\n                    tierKey = 'epic';\n                else if (tier >= 3)\n                    tierKey = 'rare';\n            }\n            if (isText) {\n                return { color: tierColorMap[tierKey] };\n            }\n            return {\n                '--tier-border-color': tierColorMap[tierKey],\n            };\n        };\n        return (_ctx, _cache) => {\n            return (__props.item)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                    _createElementVNode(\"h4\", _hoisted_2, _toDisplayString(__props.item.), 1 /* TEXT */),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _createElementVNode(\"span\", {\n                            class: \"meta-tier\",\n                            style: _normalizeStyle(getTierStyle(__props.item, true))\n                        }, \" \" + _toDisplayString(__props.item.), 5 /* TEXT, STYLE */),\n                        _createElementVNode(\"span\", _hoisted_4, _toDisplayString(__props.item.), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"p\", _hoisted_5, _toDisplayString(__props.item.), 1 /* TEXT */),\n                    (__props.item.effects)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [\n                            _cache[0] || (_cache[0] = _createElementVNode(\"h5\", null, \":\", -1 /* CACHED */)),\n                            (__props.item.effects.attributes_bonus && Object.keys(__props.item.effects.attributes_bonus).length > 1)\n                                ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_7, [\n                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.item.effects.attributes_bonus, (value, key) => {\n                                        return (_openBlock(), _createElementBlock(\"li\", { key: key }, [\n                                            (key !== '$meta')\n                                                ? (_openBlock(), _createElementBlock(\"span\", _hoisted_8, _toDisplayString(key) + \": +\" + _toDisplayString(value), 1 /* TEXT */))\n                                                : _createCommentVNode(\"v-if\", true)\n                                        ]));\n                                    }), 128 /* KEYED_FRAGMENT */))\n                                ]))\n                                : _createCommentVNode(\"v-if\", true),\n                            (__props.item.effects.percentage_bonus && Object.keys(__props.item.effects.percentage_bonus).length > 1)\n                                ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_9, [\n                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.item.effects.percentage_bonus, (value, key) => {\n                                        return (_openBlock(), _createElementBlock(\"li\", { key: key }, [\n                                            (key !== '$meta')\n                                                ? (_openBlock(), _createElementBlock(\"span\", _hoisted_10, _toDisplayString(key) + \": \" + _toDisplayString(value), 1 /* TEXT */))\n                                                : _createCommentVNode(\"v-if\", true)\n                                        ]));\n                                    }), 128 /* KEYED_FRAGMENT */))\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ]))\n                        : _createCommentVNode(\"v-if\", true)\n                ]))\n                : (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [...(_cache[1] || (_cache[1] = [\n                        _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                    ]))]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ItemDetailPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ItemDetailPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ItemDetailPanel.vue?vue&type=style&index=0&id=11d93009&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-11d93009\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createElementVNode as _createElementVNode, normalizeStyle as _normalizeStyle, createVNode as _createVNode } from \"vue\";\nconst _hoisted_1 = { class: \"panel-wrapper inventory-panel\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"inventory-layout\"\n};\nconst _hoisted_3 = { class: \"category-header\" };\nconst _hoisted_4 = [\"onClick\"];\nconst _hoisted_5 = { class: \"main-content\" };\nconst _hoisted_6 = { class: \"item-grid-container\" };\nconst _hoisted_7 = {\n    key: 0,\n    class: \"item-grid\"\n};\nconst _hoisted_8 = [\"onClick\"];\nconst _hoisted_9 = { class: \"item-name\" };\nconst _hoisted_10 = {\n    key: 0,\n    class: \"item-quantity\"\n};\nconst _hoisted_11 = {\n    key: 1,\n    class: \"empty-grid\"\n};\nconst _hoisted_12 = {\n    key: 1,\n    class: \"loading\"\n};\nimport { computed, ref } from 'vue';\nimport { playerCharacter, playerInventory } from '../../store/getters';\nimport ItemDetailPanel from './inventory/ItemDetailPanel.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'InventoryPanel',\n    setup(__props) {\n        const selectedItem = ref(null);\n        const selectedCategory = ref(null);\n        const groupedItems = computed(() => {\n            const items = playerInventory.value;\n            const groups = {\n                : [],\n                : [],\n                : [],\n                : [],\n            };\n            if (!items)\n                return groups;\n            items.forEach(item => {\n                const category = item.;\n                if (groups[category]) {\n                    groups[category].push(item);\n                }\n            });\n            // Set initial category if not set\n            if (!selectedCategory.value) {\n                const firstCategoryWithItems = Object.keys(groups).find(k => groups[k].length > 0);\n                if (firstCategoryWithItems) {\n                    selectedCategory.value = firstCategoryWithItems;\n                }\n            }\n            return groups;\n        });\n        const itemsInSelectedCategory = computed(() => {\n            if (!selectedCategory.value || !groupedItems.value[selectedCategory.value]) {\n                return [];\n            }\n            return groupedItems.value[selectedCategory.value];\n        });\n        const selectItem = (item) => {\n            selectedItem.value = item;\n        };\n        const tierColorMap = {\n            common: '#a0a0a0',\n            rare: '#3a8f9d',\n            epic: '#8a5db5',\n            legendary: '#d4af37',\n        };\n        const getTierStyle = (item, isText = false) => {\n            let tierKey = 'common';\n            if (item && item.) {\n                const tier = item.;\n                if (tier >= 9)\n                    tierKey = 'legendary';\n                else if (tier >= 6)\n                    tierKey = 'epic';\n                else if (tier >= 3)\n                    tierKey = 'rare';\n            }\n            if (isText) {\n                return { color: tierColorMap[tierKey] };\n            }\n            return {\n                '--tier-border-color': tierColorMap[tierKey],\n            };\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (_unref(playerCharacter))\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _createCommentVNode(\" Top: Category List \"),\n                        _createElementVNode(\"div\", _hoisted_3, [\n                            _createElementVNode(\"ul\", null, [\n                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(Object.keys(groupedItems.value), (category) => {\n                                    return (_openBlock(), _createElementBlock(\"li\", {\n                                        key: category,\n                                        class: _normalizeClass({ active: selectedCategory.value === category }),\n                                        onClick: ($event) => (selectedCategory.value = category)\n                                    }, _toDisplayString(category) + \" (\" + _toDisplayString(groupedItems.value[category].length) + \") \", 11 /* TEXT, CLASS, PROPS */, _hoisted_4));\n                                }), 128 /* KEYED_FRAGMENT */))\n                            ])\n                        ]),\n                        _createCommentVNode(\" Bottom: Item Grid and Detail View \"),\n                        _createElementVNode(\"div\", _hoisted_5, [\n                            _createElementVNode(\"div\", _hoisted_6, [\n                                (itemsInSelectedCategory.value.length > 0)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [\n                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(itemsInSelectedCategory.value, (item) => {\n                                            return (_openBlock(), _createElementBlock(\"div\", {\n                                                key: item.ID,\n                                                class: _normalizeClass([\"item-cell\", { selected: selectedItem.value?.ID === item.ID }]),\n                                                style: _normalizeStyle(getTierStyle(item)),\n                                                onClick: ($event) => (selectItem(item))\n                                            }, [\n                                                _createElementVNode(\"div\", _hoisted_9, _toDisplayString(item.), 1 /* TEXT */),\n                                                (item.)\n                                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, \"x\" + _toDisplayString(item.), 1 /* TEXT */))\n                                                    : _createCommentVNode(\"v-if\", true)\n                                            ], 14 /* CLASS, STYLE, PROPS */, _hoisted_8));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                    ]))\n                                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [...(_cache[0] || (_cache[0] = [\n                                            _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                                        ]))]))\n                            ]),\n                            _createVNode(ItemDetailPanel, { item: selectedItem.value }, null, 8 /* PROPS */, [\"item\"])\n                        ])\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_12, \"...\"))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./InventoryPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./InventoryPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./InventoryPanel.vue?vue&type=style&index=0&id=484e88e6&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-484e88e6\"]])\n\nexport default __exports__","import { ref, watch } from 'vue';\n\nconst FOLLOWED_NPCS_STORAGE_KEY = 'reincarnation_followed_npcs';\n\nconst followedNpcs = ref(new Set<string>(JSON.parse(localStorage.getItem(FOLLOWED_NPCS_STORAGE_KEY) || '[]')));\n\nwatch(\n  followedNpcs,\n  newSet => {\n    localStorage.setItem(FOLLOWED_NPCS_STORAGE_KEY, JSON.stringify(Array.from(newSet)));\n  },\n  { deep: true },\n);\n\nexport function useFollowSystem() {\n  const follow = (npcId: string) => {\n    followedNpcs.value.add(npcId);\n  };\n\n  const unfollow = (npcId: string) => {\n    followedNpcs.value.delete(npcId);\n  };\n\n  const isFollowed = (npcId: string) => {\n    return followedNpcs.value.has(npcId);\n  };\n\n  const toggleFollow = (npcId: string) => {\n    if (isFollowed(npcId)) {\n      unfollow(npcId);\n    } else {\n      follow(npcId);\n    }\n  };\n\n  return { followedNpcs, toggleFollow, isFollowed };\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { withModifiers as _withModifiers, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nimport { ref, watchEffect } from 'vue';\nimport { useFollowSystem } from '../../services/useFollowSystem';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'FollowButton',\n    props: {\n        npcId: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const { toggleFollow, isFollowed } = useFollowSystem();\n        const isFollowedState = ref(false);\n        watchEffect(() => {\n            isFollowedState.value = isFollowed(props.npcId);\n        });\n        function toggle() {\n            toggleFollow(props.npcId);\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"button\", {\n                class: _normalizeClass([\"follow-btn\", { followed: isFollowedState.value }]),\n                onClick: _withModifiers(toggle, [\"stop\"])\n            }, \"\", 2 /* CLASS */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./FollowButton.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./FollowButton.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./FollowButton.vue?vue&type=style&index=0&id=9ca898fa&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-9ca898fa\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = { class: \"detail-tab-content grid-layout\" };\nconst _hoisted_2 = { class: \"detail-item\" };\nconst _hoisted_3 = { class: \"detail-value\" };\nconst _hoisted_4 = { class: \"detail-item\" };\nconst _hoisted_5 = { class: \"detail-value\" };\nconst _hoisted_6 = { class: \"detail-item\" };\nconst _hoisted_7 = { class: \"detail-value\" };\nconst _hoisted_8 = { class: \"tag\" };\nconst _hoisted_9 = { class: \"detail-item\" };\nconst _hoisted_10 = { class: \"detail-value\" };\nconst _hoisted_11 = { class: \"detail-item\" };\nconst _hoisted_12 = { class: \"detail-value\" };\nconst _hoisted_13 = { class: \"detail-item\" };\nconst _hoisted_14 = { class: \"detail-value\" };\nconst _hoisted_15 = { class: \"detail-item\" };\nconst _hoisted_16 = { class: \"detail-value\" };\nconst _hoisted_17 = { class: \"detail-item\" };\nconst _hoisted_18 = { class: \"detail-value\" };\nconst _hoisted_19 = { class: \"tag\" };\nconst _hoisted_20 = { class: \"detail-item\" };\nconst _hoisted_21 = { class: \"detail-value\" };\nconst _hoisted_22 = { class: \"detail-item full-width\" };\nconst _hoisted_23 = { class: \"detail-value\" };\nconst _hoisted_24 = { class: \"history-list\" };\nconst _hoisted_25 = { key: 0 };\nconst _hoisted_26 = {\n    key: 1,\n    class: \"influence-text\"\n};\nimport { computed } from 'vue';\nimport { calculateAge } from '../../../store/getters';\nimport { store } from '../../../store';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcArchiveTab',\n    props: {\n        npc: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const age = computed(() => {\n            const world = computed(() => {\n                if (!store.worldState?. || !props.npc.)\n                    return null;\n                return store.worldState.[props.npc.] || null;\n            });\n            const calculated = calculateAge(props.npc, world.value);\n            return calculated === null ? '' : calculated;\n        });\n        const formattedBirthDate = computed(() => {\n            const bd = props.npc.;\n            if (!bd)\n                return '';\n            return `${bd.}${bd.}${bd.}`;\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _createElementVNode(\"p\", null, _toDisplayString(__props.npc.), 1 /* TEXT */)\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    _cache[1] || (_cache[1] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_5, [\n                        _createElementVNode(\"p\", null, _toDisplayString(formattedBirthDate.value) + \" (\" + _toDisplayString(age.value) + \")\", 1 /* TEXT */)\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_6, [\n                    _cache[2] || (_cache[2] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_7, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(Object.values(__props.npc. || {}).filter(v => typeof v === 'string'), (item) => {\n                            return (_openBlock(), _createElementBlock(\"span\", _hoisted_8, _toDisplayString(item), 1 /* TEXT */));\n                        }), 256 /* UNKEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_9, [\n                    _cache[3] || (_cache[3] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_10, [\n                        _createElementVNode(\"p\", null, _toDisplayString(__props.npc.), 1 /* TEXT */)\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_11, [\n                    _cache[4] || (_cache[4] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_12, [\n                        _createElementVNode(\"p\", null, _toDisplayString(__props.npc.), 1 /* TEXT */)\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_13, [\n                    _cache[5] || (_cache[5] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_14, [\n                        _createElementVNode(\"p\", null, _toDisplayString(__props.npc.), 1 /* TEXT */)\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_15, [\n                    _cache[6] || (_cache[6] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_16, [\n                        _createElementVNode(\"p\", null, _toDisplayString(__props.npc.?.), 1 /* TEXT */)\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_17, [\n                    _cache[7] || (_cache[7] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_18, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(Object.values(__props.npc.?. || {}).filter(v => typeof v === 'string'), (item) => {\n                            return (_openBlock(), _createElementBlock(\"span\", _hoisted_19, _toDisplayString(item), 1 /* TEXT */));\n                        }), 256 /* UNKEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_20, [\n                    _cache[8] || (_cache[8] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_21, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.npc.?.?., (value, tendencyKey) => {\n                            return (_openBlock(), _createElementBlock(\"span\", {\n                                key: tendencyKey,\n                                class: \"tag\"\n                            }, _toDisplayString(tendencyKey) + \": \" + _toDisplayString(value), 1 /* TEXT */));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_22, [\n                    _cache[9] || (_cache[9] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_23, [\n                        _createElementVNode(\"ul\", _hoisted_24, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(Object.values(__props.npc.?. || {}).filter(v => typeof v === 'object'), (event, index) => {\n                                return (_openBlock(), _createElementBlock(\"li\", { key: index }, [\n                                    _createElementVNode(\"strong\", null, _toDisplayString(event.), 1 /* TEXT */),\n                                    (event.)\n                                        ? (_openBlock(), _createElementBlock(\"p\", _hoisted_25, _toDisplayString(event.), 1 /* TEXT */))\n                                        : _createCommentVNode(\"v-if\", true),\n                                    (event.)\n                                        ? (_openBlock(), _createElementBlock(\"p\", _hoisted_26, _toDisplayString(event.), 1 /* TEXT */))\n                                        : _createCommentVNode(\"v-if\", true)\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ])\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcArchiveTab.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcArchiveTab.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcArchiveTab.vue?vue&type=style&index=0&id=0ce99af7&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-0ce99af7\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode } from \"vue\";\nconst _hoisted_1 = { class: \"attribute-grid\" };\nconst _hoisted_2 = { class: \"attribute-key\" };\nconst _hoisted_3 = { class: \"attribute-value\" };\nimport { computed } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'AttributeGrid',\n    props: {\n        attributes: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const filteredAttributes = computed(() => {\n            if (!props.attributes)\n                return {};\n            const { $meta, ...rest } = props.attributes;\n            return rest;\n        });\n        function formatValue(value) {\n            if (typeof value === 'object' && value !== null) {\n                if ('' in value && '' in value) {\n                    let output = `${value['']}/${value['']}`;\n                    if ('' in value) {\n                        output += ` (+${value['']})`;\n                    }\n                    return output;\n                }\n                // For other complex objects, format them line by line\n                return Object.entries(value)\n                    .map(([key, val]) => `${key}: ${val}`)\n                    .join('\\n');\n            }\n            return String(value);\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(filteredAttributes.value, (value, key) => {\n                    return (_openBlock(), _createElementBlock(\"div\", {\n                        key: key,\n                        class: \"attribute-item\"\n                    }, [\n                        _createElementVNode(\"span\", _hoisted_2, _toDisplayString(key), 1 /* TEXT */),\n                        _createElementVNode(\"span\", _hoisted_3, _toDisplayString(formatValue(value)), 1 /* TEXT */)\n                    ]));\n                }), 128 /* KEYED_FRAGMENT */))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./AttributeGrid.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AttributeGrid.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./AttributeGrid.vue?vue&type=style&index=0&id=3cb45dc2&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3cb45dc2\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, normalizeStyle as _normalizeStyle, openBlock as _openBlock, createElementBlock as _createElementBlock, Fragment as _Fragment, renderList as _renderList, createBlock as _createBlock, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = [\"title\"];\nconst _hoisted_2 = { class: \"value-cell\" };\nconst _hoisted_3 = {\n    key: 0,\n    class: \"progress-bar-container\"\n};\nconst _hoisted_4 = { class: \"progress-text\" };\nconst _hoisted_5 = { class: \"object-value\" };\nconst _hoisted_6 = { class: \"data-item\" };\nconst _hoisted_7 = { class: \"data-item-key\" };\nconst _hoisted_8 = { class: \"data-item-value\" };\nconst _hoisted_9 = { class: \"object-value\" };\nimport ObjectRendererItem from './ObjectRendererItem.vue'; // Self-referencing\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ObjectRendererItem',\n    props: {\n        itemKey: {},\n        value: {}\n    },\n    setup(__props) {\n        const isObject = (value) => {\n            return typeof value === 'object' && value !== null && !Array.isArray(value);\n        };\n        const isProgressBar = (value) => {\n            return isObject(value) && 'current' in value && 'max' in value;\n        };\n        const isSimpleValue = (value) => {\n            return isObject(value) && 'value' in value && Object.keys(value).length <= 2;\n        };\n        const isDataItem = (value) => {\n            return isObject(value) && ('ID' in value || '' in value) && !('value' in value) && !('current' in value);\n        };\n        const filterMeta = (data) => {\n            if (!data)\n                return {};\n            const { $meta, ...rest } = data;\n            return rest;\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"li\", null, [\n                _createElementVNode(\"span\", {\n                    class: \"object-key\",\n                    title: __props.value?.description\n                }, _toDisplayString(__props.itemKey) + \":\", 9 /* TEXT, PROPS */, _hoisted_1),\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createCommentVNode(\" Case 1: Progress Bar (current/max) \"),\n                    (isProgressBar(__props.value))\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                            _createElementVNode(\"div\", {\n                                class: \"progress-bar\",\n                                style: _normalizeStyle({ width: `${(__props.value.current / __props.value.max) * 100}%` })\n                            }, null, 4 /* STYLE */),\n                            _createElementVNode(\"span\", _hoisted_4, _toDisplayString(__props.value.current) + \" / \" + _toDisplayString(__props.value.max), 1 /* TEXT */)\n                        ]))\n                        : (isSimpleValue(__props.value))\n                            ? (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                                _createCommentVNode(\" Case 2: Simple Value (value key) \"),\n                                _createElementVNode(\"span\", _hoisted_5, _toDisplayString(__props.value.value), 1 /* TEXT */)\n                            ], 64 /* STABLE_FRAGMENT */))\n                            : (isDataItem(__props.value))\n                                ? (_openBlock(), _createElementBlock(_Fragment, { key: 2 }, [\n                                    _createCommentVNode(\" Case 3: Data Item (ID, , ) \"),\n                                    _createElementVNode(\"div\", _hoisted_6, [\n                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.value, (dataValue, dataKey) => {\n                                            return (_openBlock(), _createElementBlock(\"div\", {\n                                                key: dataKey,\n                                                class: \"data-item-row\"\n                                            }, [\n                                                _createElementVNode(\"span\", _hoisted_7, _toDisplayString(dataKey) + \":\", 1 /* TEXT */),\n                                                _createElementVNode(\"span\", _hoisted_8, _toDisplayString(dataValue), 1 /* TEXT */)\n                                            ]));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                    ])\n                                ], 64 /* STABLE_FRAGMENT */))\n                                : (isObject(__props.value))\n                                    ? (_openBlock(), _createElementBlock(_Fragment, { key: 3 }, [\n                                        _createCommentVNode(\" Case 4: Recursive Object \"),\n                                        _createElementVNode(\"ul\", {\n                                            class: _normalizeClass({ 'multi-column': Object.keys(__props.value).length > 4 })\n                                        }, [\n                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(filterMeta(__props.value), (subValue, subKey) => {\n                                                return (_openBlock(), _createBlock(ObjectRendererItem, {\n                                                    key: subKey,\n                                                    \"item-key\": String(subKey),\n                                                    value: subValue\n                                                }, null, 8 /* PROPS */, [\"item-key\", \"value\"]));\n                                            }), 128 /* KEYED_FRAGMENT */))\n                                        ], 2 /* CLASS */)\n                                    ], 64 /* STABLE_FRAGMENT */))\n                                    : (_openBlock(), _createElementBlock(_Fragment, { key: 4 }, [\n                                        _createCommentVNode(\" Case 4: Primitive Value \"),\n                                        _createElementVNode(\"span\", _hoisted_9, _toDisplayString(__props.value), 1 /* TEXT */)\n                                    ], 64 /* STABLE_FRAGMENT */))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ObjectRendererItem.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ObjectRendererItem.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ObjectRendererItem.vue?vue&type=style&index=0&id=51c46ea8&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-51c46ea8\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createBlock as _createBlock, normalizeClass as _normalizeClass, createElementVNode as _createElementVNode } from \"vue\";\nimport { computed } from 'vue';\nimport ObjectRendererItem from './ObjectRendererItem.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ObjectRenderer',\n    props: {\n        data: {},\n        isNested: { type: Boolean },\n        context: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const filteredData = computed(() => {\n            if (!props.data)\n                return {};\n            const { $meta, ...rest } = props.data;\n            return rest;\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n                class: _normalizeClass([\"object-renderer\", { 'is-nested': __props.isNested }])\n            }, [\n                _createElementVNode(\"ul\", {\n                    class: _normalizeClass({ 'multi-column': Object.keys(filteredData.value).length > 4 })\n                }, [\n                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(filteredData.value, (value, key) => {\n                        return (_openBlock(), _createBlock(ObjectRendererItem, {\n                            key: key,\n                            \"item-key\": String(key),\n                            value: value,\n                            context: props.context\n                        }, null, 8 /* PROPS */, [\"item-key\", \"value\", \"context\"]));\n                    }), 128 /* KEYED_FRAGMENT */))\n                ], 2 /* CLASS */)\n            ], 2 /* CLASS */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ObjectRenderer.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ObjectRenderer.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ObjectRenderer.vue?vue&type=style&index=0&id=77f4f93a&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-77f4f93a\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = { class: \"art-detail\" };\nconst _hoisted_2 = { class: \"art-name\" };\nconst _hoisted_3 = { class: \"art-meta\" };\nconst _hoisted_4 = { class: \"art-description\" };\nconst _hoisted_5 = { class: \"effects\" };\nconst _hoisted_6 = {\n    key: 0,\n    class: \"skills-section\"\n};\nimport { computed } from 'vue';\nimport { store } from '../../../store';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ArtDetail',\n    props: {\n        art: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const skills = computed(() => {\n            const database = store.worldState?.;\n            if (!database || !('' in database))\n                return [];\n            const skillDb = database.;\n            return Object.values(skillDb).filter(skill => skill. === props.art.ID);\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"h4\", _hoisted_2, _toDisplayString(__props.art.), 1 /* TEXT */),\n                _createElementVNode(\"div\", _hoisted_3, [\n                    _createElementVNode(\"span\", null, [\n                        _cache[0] || (_cache[0] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                        _createTextVNode(\" \" + _toDisplayString(__props.art.), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"span\", null, [\n                        _cache[1] || (_cache[1] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                        _createTextVNode(\" \" + _toDisplayString(__props.art.), 1 /* TEXT */)\n                    ])\n                ]),\n                _createElementVNode(\"p\", _hoisted_4, _toDisplayString(__props.art.), 1 /* TEXT */),\n                _createElementVNode(\"div\", _hoisted_5, [\n                    _createElementVNode(\"p\", null, [\n                        _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                        _createTextVNode(\" \" + _toDisplayString(__props.art.), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"p\", null, [\n                        _cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                        _createTextVNode(\" \" + _toDisplayString(__props.art.), 1 /* TEXT */)\n                    ])\n                ]),\n                (skills.value.length > 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [\n                        _cache[4] || (_cache[4] = _createElementVNode(\"h5\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"ul\", null, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(skills.value, (skill) => {\n                                return (_openBlock(), _createElementBlock(\"li\", {\n                                    key: skill.ID\n                                }, [\n                                    _createElementVNode(\"strong\", null, _toDisplayString(skill.) + \" (\" + _toDisplayString(skill.) + \")\", 1 /* TEXT */),\n                                    _createElementVNode(\"p\", null, _toDisplayString(skill.), 1 /* TEXT */)\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ArtDetail.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ArtDetail.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ArtDetail.vue?vue&type=style&index=0&id=4b328335&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-4b328335\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"talent-detail\" };\nconst _hoisted_2 = { class: \"talent-name\" };\nconst _hoisted_3 = { class: \"talent-meta\" };\nconst _hoisted_4 = { class: \"meta-item\" };\nconst _hoisted_5 = { class: \"meta-item\" };\nconst _hoisted_6 = { class: \"talent-description\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'TalentDetail',\n    props: {\n        talent: {}\n    },\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"h4\", _hoisted_2, _toDisplayString(__props.talent.), 1 /* TEXT */),\n                _createElementVNode(\"div\", _hoisted_3, [\n                    _createElementVNode(\"span\", _hoisted_4, [\n                        _cache[0] || (_cache[0] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                        _createTextVNode(\" \" + _toDisplayString(__props.talent. || ''), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"span\", _hoisted_5, [\n                        _cache[1] || (_cache[1] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                        _createTextVNode(\" \" + _toDisplayString(__props.talent. || 'N/A'), 1 /* TEXT */)\n                    ])\n                ]),\n                _createElementVNode(\"p\", _hoisted_6, _toDisplayString(__props.talent.), 1 /* TEXT */)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./TalentDetail.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./TalentDetail.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./TalentDetail.vue?vue&type=style&index=0&id=7ee5fcf5&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7ee5fcf5\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = { class: \"detail-tab-content grid-layout\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"detail-item full-width\"\n};\nconst _hoisted_3 = {\n    key: 1,\n    class: \"detail-item full-width\"\n};\nconst _hoisted_4 = { class: \"detail-item full-width\" };\nconst _hoisted_5 = { class: \"detail-item full-width\" };\nconst _hoisted_6 = { class: \"detail-value\" };\nconst _hoisted_7 = {\n    key: 0,\n    class: \"tags-container\"\n};\nconst _hoisted_8 = [\"onClick\"];\nconst _hoisted_9 = {\n    key: 1,\n    class: \"placeholder\"\n};\nconst _hoisted_10 = { class: \"detail-item full-width\" };\nconst _hoisted_11 = {\n    key: 0,\n    class: \"skills-list\"\n};\nconst _hoisted_12 = [\"onClick\"];\nconst _hoisted_13 = { class: \"skill-header\" };\nconst _hoisted_14 = { class: \"skill-level\" };\nconst _hoisted_15 = {\n    key: 1,\n    class: \"placeholder\"\n};\nimport { computed } from 'vue';\nimport { detailModalService } from '../../../services/DetailModalService';\nimport { store } from '../../../store';\nimport AttributeGrid from '../AttributeGrid.vue';\nimport ObjectRenderer from '../ObjectRenderer.vue';\nimport ArtDetail from './ArtDetail.vue';\nimport TalentDetail from './TalentDetail.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcPowerTab',\n    props: {\n        npc: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const worldAttributes = computed(() => {\n            const world = store.worldState?.?.[props.npc.];\n            const npcAttributes = props.npc.;\n            if (!npcAttributes)\n                return {};\n            if (!world)\n                return npcAttributes;\n            const currentEpochId = world.?.?.ID;\n            if (!currentEpochId)\n                return npcAttributes;\n            const currentEpoch = world..?.[currentEpochId];\n            const attributeTemplates = currentEpoch?.?.;\n            const resolvedAttributes = {};\n            for (const attrId in npcAttributes) {\n                if (attrId === '$meta')\n                    continue;\n                const template = attributeTemplates ? attributeTemplates[attrId] : null;\n                const attributeName = template?. || attrId;\n                // \n                if (!template?. && typeof npcAttributes[attrId] === 'object' && npcAttributes[attrId] !== null) {\n                    resolvedAttributes[attrId] = npcAttributes[attrId];\n                }\n                else {\n                    resolvedAttributes[attributeName] = npcAttributes[attrId];\n                }\n            }\n            return resolvedAttributes;\n        });\n        const talents = computed(() => {\n            const world = store.worldState?.?.[props.npc.];\n            const database = world?.;\n            if (!props.npc. || !database || !('' in database))\n                return [];\n            const talentDb = database.;\n            if (!talentDb)\n                return [];\n            return Object.keys(props.npc.)\n                .map(talentId => {\n                const talentData = talentDb[talentId];\n                return talentData ? { ...talentData, ID: talentId } : null;\n            })\n                .filter(Boolean);\n        });\n        const skills = computed(() => {\n            const world = store.worldState?.?.[props.npc.];\n            const database = world?.;\n            if (!props.npc. || !database || !('' in database))\n                return [];\n            const npcArts = props.npc.;\n            const artDb = database.;\n            if (!artDb)\n                return [];\n            const skillsList = [];\n            for (const artId in npcArts) {\n                const artData = npcArts[artId];\n                const artTemplate = artDb[artId];\n                if (artTemplate && artTemplate.) {\n                    const levelKey = `level_${artData.}`;\n                    const currentLevelInfo = artTemplate.[levelKey];\n                    skillsList.push({\n                        id: artId,\n                        name: artTemplate.,\n                        level: artData.,\n                        title: currentLevelInfo ? currentLevelInfo. : '',\n                    });\n                }\n            }\n            return skillsList;\n        });\n        const showTalentDetail = (talent) => {\n            detailModalService.show(talent., TalentDetail, { talent });\n        };\n        const showArtDetail = (art) => {\n            const world = store.worldState?.?.[props.npc.];\n            const artTemplate = world?.?.?.[art.id];\n            if (artTemplate) {\n                detailModalService.show(art.name, ArtDetail, { art: artTemplate });\n            }\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (__props.npc.)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _cache[0] || (_cache[0] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \"\", -1 /* CACHED */)),\n                        _createVNode(AttributeGrid, {\n                            attributes: __props.npc.\n                        }, null, 8 /* PROPS */, [\"attributes\"])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                (__props.npc.)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                        _cache[1] || (_cache[1] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \"\", -1 /* CACHED */)),\n                        _createVNode(AttributeGrid, {\n                            attributes: __props.npc.\n                        }, null, 8 /* PROPS */, [\"attributes\"])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    _cache[2] || (_cache[2] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \"\", -1 /* CACHED */)),\n                    _createVNode(ObjectRenderer, { data: worldAttributes.value }, null, 8 /* PROPS */, [\"data\"])\n                ]),\n                _createElementVNode(\"div\", _hoisted_5, [\n                    _cache[3] || (_cache[3] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_6, [\n                        (talents.value.length > 0)\n                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [\n                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(talents.value, (talent) => {\n                                    return (_openBlock(), _createElementBlock(\"span\", {\n                                        key: talent.ID,\n                                        class: \"tag talent-tag\",\n                                        onClick: ($event) => (showTalentDetail(talent))\n                                    }, _toDisplayString(talent.), 9 /* TEXT, PROPS */, _hoisted_8));\n                                }), 128 /* KEYED_FRAGMENT */))\n                            ]))\n                            : (_openBlock(), _createElementBlock(\"div\", _hoisted_9, \"\"))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_10, [\n                    _cache[4] || (_cache[4] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \"\", -1 /* CACHED */)),\n                    (skills.value.length > 0)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(skills.value, (skill) => {\n                                return (_openBlock(), _createElementBlock(\"div\", {\n                                    key: skill.id,\n                                    class: \"skill-item\",\n                                    onClick: ($event) => (showArtDetail(skill))\n                                }, [\n                                    _createElementVNode(\"div\", _hoisted_13, [\n                                        _createElementVNode(\"h3\", null, _toDisplayString(skill.name), 1 /* TEXT */),\n                                        _createElementVNode(\"div\", _hoisted_14, \" \" + _toDisplayString(skill.level) + \" (\" + _toDisplayString(skill.title) + \")\", 1 /* TEXT */)\n                                    ])\n                                ], 8 /* PROPS */, _hoisted_12));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_15, \"\"))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcPowerTab.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcPowerTab.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcPowerTab.vue?vue&type=style&index=0&id=da89f9b0&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-da89f9b0\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, normalizeStyle as _normalizeStyle } from \"vue\";\nconst _hoisted_1 = { class: \"progress-bar-container\" };\nconst _hoisted_2 = { class: \"label\" };\nconst _hoisted_3 = { class: \"progress-track\" };\nconst _hoisted_4 = {\n    key: 0,\n    class: \"center-tick\"\n};\nconst _hoisted_5 = { class: \"value\" };\nimport { computed } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ProgressBar',\n    props: {\n        label: {},\n        value: {},\n        max: {},\n        min: {},\n        color: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const displayValue = computed(() => props.value);\n        const isBidirectional = computed(() => props.min !== undefined && props.min < 0);\n        const fillStyle = computed(() => {\n            const min = props.min || 0;\n            const max = props.max || 100;\n            const value = Math.max(min, Math.min(max, props.value));\n            if (isBidirectional.value) {\n                const totalRange = max - min;\n                if (value > 0) {\n                    return {\n                        left: '50%',\n                        right: 'auto',\n                        width: `${(value / max) * 50}%`,\n                        backgroundColor: props.color,\n                    };\n                }\n                else {\n                    return {\n                        left: 'auto',\n                        right: '50%',\n                        width: `${(Math.abs(value) / Math.abs(min)) * 50}%`,\n                        backgroundColor: '#e53935', // \n                    };\n                }\n            }\n            else {\n                const percentage = max === min ? 0 : ((value - min) / (max - min)) * 100;\n                return {\n                    left: '0',\n                    right: 'auto',\n                    width: `${percentage}%`,\n                    backgroundColor: props.color,\n                };\n            }\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"span\", _hoisted_2, _toDisplayString(__props.label), 1 /* TEXT */),\n                _createElementVNode(\"div\", _hoisted_3, [\n                    (isBidirectional.value)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4))\n                        : _createCommentVNode(\"v-if\", true),\n                    _createElementVNode(\"div\", {\n                        class: \"progress-fill\",\n                        style: _normalizeStyle(fillStyle.value)\n                    }, null, 4 /* STYLE */)\n                ]),\n                _createElementVNode(\"span\", _hoisted_5, _toDisplayString(displayValue.value), 1 /* TEXT */)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ProgressBar.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ProgressBar.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ProgressBar.vue?vue&type=style&index=0&id=780a870c&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-780a870c\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, unref as _unref, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createBlock as _createBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = { class: \"relations-display\" };\nconst _hoisted_2 = { class: \"relation-list\" };\nconst _hoisted_3 = [\"onClick\"];\nconst _hoisted_4 = { class: \"relation-name\" };\nconst _hoisted_5 = { class: \"relation-tags\" };\nconst _hoisted_6 = {\n    key: 0,\n    class: \"relation-details\"\n};\nconst _hoisted_7 = { class: \"group-title\" };\nimport { get } from 'lodash';\nimport { ref, watch } from 'vue';\nimport { npcService } from '../../services/NpcService';\nimport { store } from '../../store';\nimport ProgressBar from './ProgressBar.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'RelationsDisplay',\n    props: {\n        subjectId: {}\n    },\n    setup(__props) {\n        const vectorGroups = [\n            {\n                title: '',\n                vectors: [\n                    { label: '', path: '.', min: -100, max: 100, color: '#3a8f9d' },\n                    { label: '', path: '.', min: -100, max: 100, color: '#3a8f9d' },\n                    { label: '', path: '.', min: 0, max: 100, color: '#e53935' },\n                ],\n            },\n            {\n                title: '',\n                vectors: [\n                    { label: '', path: '.', min: -100, max: 100, color: '#c74343' },\n                    { label: '', path: '.', min: 0, max: 100, color: '#c74343' },\n                ],\n            },\n            {\n                title: '',\n                vectors: [\n                    { label: '', path: '.', min: 0, max: 100, color: '#d4af37' },\n                    { label: '', path: '.', min: 0, max: 100, color: '#d4af37' },\n                    { label: '', path: '.', min: 0, max: 100, color: '#e53935' },\n                ],\n            },\n        ];\n        const props = __props;\n        const relations = ref({});\n        watch(() => [props.subjectId, store.worldState?.], () => {\n            if (!props.subjectId || !store.worldState?.) {\n                relations.value = {};\n                return;\n            }\n            let worldId = null;\n            for (const id in store.worldState.) {\n                if (get(store.worldState.[id], `.${props.subjectId}`)) {\n                    worldId = id;\n                    break;\n                }\n            }\n            if (!worldId) {\n                relations.value = {};\n                return;\n            }\n            const causalNet = get(store.worldState.[worldId], '');\n            if (!causalNet) {\n                relations.value = {};\n                return;\n            }\n            relations.value = causalNet[props.subjectId] || {};\n        }, { immediate: true, deep: true });\n        const { getNpcNameById } = npcService;\n        const expandedRelation = ref(null);\n        function toggleExpand(name) {\n            const relationName = String(name);\n            if (expandedRelation.value === relationName) {\n                expandedRelation.value = null;\n            }\n            else {\n                expandedRelation.value = relationName;\n            }\n        }\n        function getFormattedTags(relation) {\n            const causeTags = get(relation, '', {});\n            return Object.values(causeTags)\n                .filter((tag) => typeof tag === 'object' && tag !== null && tag.)\n                .map((tag) => tag.);\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"ul\", _hoisted_2, [\n                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(relations.value, (relation, id) => {\n                        return (_openBlock(), _createElementBlock(\"li\", {\n                            key: id,\n                            class: \"relation-item\"\n                        }, [\n                            _createElementVNode(\"div\", {\n                                class: \"relation-header\",\n                                onClick: ($event) => (toggleExpand(id))\n                            }, [\n                                _createElementVNode(\"span\", _hoisted_4, _toDisplayString(_unref(getNpcNameById)(String(id))), 1 /* TEXT */),\n                                _createElementVNode(\"div\", _hoisted_5, [\n                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(getFormattedTags(relation), (tag) => {\n                                        return (_openBlock(), _createElementBlock(\"span\", {\n                                            key: tag,\n                                            class: \"tag\"\n                                        }, _toDisplayString(tag), 1 /* TEXT */));\n                                    }), 128 /* KEYED_FRAGMENT */))\n                                ])\n                            ], 8 /* PROPS */, _hoisted_3),\n                            (expandedRelation.value === id)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [\n                                    (_openBlock(), _createElementBlock(_Fragment, null, _renderList(vectorGroups, (group) => {\n                                        return _createElementVNode(\"div\", {\n                                            key: group.title,\n                                            class: \"vector-group\"\n                                        }, [\n                                            _createElementVNode(\"strong\", _hoisted_7, _toDisplayString(group.title), 1 /* TEXT */),\n                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(group.vectors, (vector) => {\n                                                return (_openBlock(), _createBlock(ProgressBar, {\n                                                    key: vector.label,\n                                                    label: vector.label,\n                                                    value: _unref(get)(relation, vector.path, 0),\n                                                    min: vector.min,\n                                                    max: vector.max,\n                                                    color: vector.color\n                                                }, null, 8 /* PROPS */, [\"label\", \"value\", \"min\", \"max\", \"color\"]));\n                                            }), 128 /* KEYED_FRAGMENT */))\n                                        ]);\n                                    }), 64 /* STABLE_FRAGMENT */))\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ]));\n                    }), 128 /* KEYED_FRAGMENT */))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./RelationsDisplay.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./RelationsDisplay.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./RelationsDisplay.vue?vue&type=style&index=0&id=7f588f84&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7f588f84\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = { class: \"inventory-grid\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"grid-container\"\n};\nconst _hoisted_3 = [\"onClick\"];\nconst _hoisted_4 = { class: \"item-name\" };\nconst _hoisted_5 = {\n    key: 0,\n    class: \"item-quantity\"\n};\nconst _hoisted_6 = {\n    key: 1,\n    class: \"empty-inventory\"\n};\nimport { detailModalService } from '../../services/DetailModalService';\nimport DatabaseItemCard from './DatabaseItemCard.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'InventoryGrid',\n    props: {\n        items: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const showItemDetail = (item) => {\n            if (!item)\n                return;\n            detailModalService.show(item., DatabaseItemCard, { item });\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (__props.items.length > 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.items, (item, index) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: index,\n                                class: \"item-cell\",\n                                onClick: ($event) => (showItemDetail(item))\n                            }, [\n                                _createElementVNode(\"span\", _hoisted_4, _toDisplayString(item.), 1 /* TEXT */),\n                                (item.)\n                                    ? (_openBlock(), _createElementBlock(\"span\", _hoisted_5, \"x\" + _toDisplayString(item.), 1 /* TEXT */))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ], 8 /* PROPS */, _hoisted_3));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [...(_cache[0] || (_cache[0] = [\n                            _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                        ]))]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./InventoryGrid.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./InventoryGrid.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./InventoryGrid.vue?vue&type=style&index=0&id=807b1656&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-807b1656\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = { class: \"detail-tab-content grid-layout\" };\nconst _hoisted_2 = { class: \"detail-item full-width\" };\nconst _hoisted_3 = { class: \"detail-item full-width\" };\nconst _hoisted_4 = { class: \"detail-item full-width\" };\nconst _hoisted_5 = {\n    key: 0,\n    class: \"memory-list\"\n};\nconst _hoisted_6 = { class: \"memory-event\" };\nconst _hoisted_7 = { class: \"memory-influence\" };\nconst _hoisted_8 = {\n    key: 1,\n    class: \"placeholder\"\n};\nimport { computed } from 'vue';\nimport { get } from 'lodash';\nimport { store } from '../../../store';\nimport RelationsDisplay from '../RelationsDisplay.vue';\nimport InventoryGrid from '../InventoryGrid.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcCauseTab',\n    props: {\n        npc: {},\n        npcId: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const inventoryItems = computed(() => {\n            const world = store.worldState?.?.[props.npc.];\n            const database = world?.;\n            if (!props.npc || !database)\n                return [];\n            const backpack = get(props.npc, '', {});\n            const items = [];\n            for (const itemId in backpack) {\n                const quantity = backpack[itemId];\n                if (quantity <= 0)\n                    continue;\n                let itemDetails = null;\n                for (const category in database) {\n                    const categoryStore = database[category];\n                    if (categoryStore && categoryStore[itemId]) {\n                        itemDetails = categoryStore[itemId];\n                        break;\n                    }\n                }\n                if (itemDetails) {\n                    items.push({\n                        ...itemDetails,\n                        ID: itemId,\n                        : quantity,\n                    });\n                }\n            }\n            return items;\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \"\", -1 /* CACHED */)),\n                    _createVNode(InventoryGrid, { items: inventoryItems.value }, null, 8 /* PROPS */, [\"items\"])\n                ]),\n                _createElementVNode(\"div\", _hoisted_3, [\n                    _cache[1] || (_cache[1] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \"\", -1 /* CACHED */)),\n                    (__props.npcId)\n                        ? (_openBlock(), _createBlock(RelationsDisplay, {\n                            key: 0,\n                            \"subject-id\": __props.npcId\n                        }, null, 8 /* PROPS */, [\"subject-id\"]))\n                        : _createCommentVNode(\"v-if\", true)\n                ]),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    _cache[4] || (_cache[4] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \"\", -1 /* CACHED */)),\n                    (Object.keys(__props.npc.?. || {}).length > 0)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.npc.., (memory, key) => {\n                                return (_openBlock(), _createElementBlock(\"div\", {\n                                    key: key,\n                                    class: \"memory-item\"\n                                }, [\n                                    _createElementVNode(\"p\", _hoisted_6, [\n                                        _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                        _createTextVNode(\" \" + _toDisplayString(memory.), 1 /* TEXT */)\n                                    ]),\n                                    _createElementVNode(\"p\", _hoisted_7, [\n                                        _cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                        _createTextVNode(\" \" + _toDisplayString(memory.), 1 /* TEXT */)\n                                    ])\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_8, \"\"))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcCauseTab.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcCauseTab.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcCauseTab.vue?vue&type=style&index=0&id=41584baf&lang=scss&scoped=true\"\nimport \"./NpcCauseTab.vue?vue&type=style&index=1&id=41584baf&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-41584baf\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createElementVNode as _createElementVNode, createBlock as _createBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = { class: \"npc-detail-display\" };\nconst _hoisted_2 = { class: \"tabs\" };\nconst _hoisted_3 = [\"onClick\"];\nconst _hoisted_4 = { class: \"tab-content\" };\nconst _hoisted_5 = {\n    key: 1,\n    class: \"placeholder\"\n};\nimport { ref } from 'vue';\nimport NpcArchiveTab from './npc-details/NpcArchiveTab.vue';\nimport NpcPowerTab from './npc-details/NpcPowerTab.vue';\nimport NpcCauseTab from './npc-details/NpcCauseTab.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcDetailDisplay',\n    props: {\n        npc: {},\n        npcId: {}\n    },\n    setup(__props) {\n        const activeTab = ref('archive');\n        const tabs = [\n            { id: 'archive', name: '' },\n            { id: 'power', name: '' },\n            { id: 'cause', name: '' },\n        ];\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    (_openBlock(), _createElementBlock(_Fragment, null, _renderList(tabs, (tab) => {\n                        return _createElementVNode(\"button\", {\n                            key: tab.id,\n                            class: _normalizeClass({ active: activeTab.value === tab.id }),\n                            onClick: ($event) => (activeTab.value = tab.id)\n                        }, _toDisplayString(tab.name), 11 /* TEXT, CLASS, PROPS */, _hoisted_3);\n                    }), 64 /* STABLE_FRAGMENT */))\n                ]),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    (__props.npc)\n                        ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                            (activeTab.value === 'archive')\n                                ? (_openBlock(), _createBlock(NpcArchiveTab, {\n                                    key: 0,\n                                    npc: __props.npc\n                                }, null, 8 /* PROPS */, [\"npc\"]))\n                                : _createCommentVNode(\"v-if\", true),\n                            (activeTab.value === 'power')\n                                ? (_openBlock(), _createBlock(NpcPowerTab, {\n                                    key: 1,\n                                    npc: __props.npc\n                                }, null, 8 /* PROPS */, [\"npc\"]))\n                                : _createCommentVNode(\"v-if\", true),\n                            (activeTab.value === 'cause')\n                                ? (_openBlock(), _createBlock(NpcCauseTab, {\n                                    key: 2,\n                                    npc: __props.npc,\n                                    \"npc-id\": __props.npcId\n                                }, null, 8 /* PROPS */, [\"npc\", \"npc-id\"]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ], 64 /* STABLE_FRAGMENT */))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [...(_cache[0] || (_cache[0] = [\n                                _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                            ]))]))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcDetailDisplay.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcDetailDisplay.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcDetailDisplay.vue?vue&type=style&index=0&id=7a2f4260&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7a2f4260\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, vModelText as _vModelText, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, withModifiers as _withModifiers, createBlock as _createBlock, createVNode as _createVNode } from \"vue\";\nconst _hoisted_1 = { class: \"npc-directory-panel\" };\nconst _hoisted_2 = { class: \"world-list-column\" };\nconst _hoisted_3 = [\"onClick\"];\nconst _hoisted_4 = { class: \"npc-list-column\" };\nconst _hoisted_5 = {\n    key: 0,\n    class: \"npc-list\"\n};\nconst _hoisted_6 = [\"onClick\"];\nconst _hoisted_7 = { class: \"npc-info\" };\nconst _hoisted_8 = { class: \"npc-name\" };\nconst _hoisted_9 = { class: \"npc-location\" };\nconst _hoisted_10 = {\n    key: 1,\n    class: \"placeholder\"\n};\nconst _hoisted_11 = { class: \"npc-detail-column\" };\nconst _hoisted_12 = { key: 0 };\nconst _hoisted_13 = {\n    key: 1,\n    class: \"placeholder\"\n};\nimport { computed, onMounted, ref, watch } from 'vue';\nimport { npcService } from '../../services/NpcService';\nimport { useFollowSystem } from '../../services/useFollowSystem';\nimport FollowButton from '../common/FollowButton.vue';\nimport NpcDetailDisplay from '../common/NpcDetailDisplay.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcDirectoryPanel',\n    setup(__props) {\n        const worlds = ref([]);\n        const selectedWorldId = ref(null);\n        const selectedNpc = ref(null);\n        const selectedNpcId = ref(null);\n        const isWorldListVisible = ref(false);\n        const worldSearchTerm = ref('');\n        const npcSearchTerm = ref('');\n        const { isFollowed } = useFollowSystem();\n        const filteredWorlds = computed(() => {\n            if (!worldSearchTerm.value)\n                return worlds.value;\n            return worlds.value.filter(w => w.name.includes(worldSearchTerm.value));\n        });\n        const selectedWorldNpcs = computed(() => {\n            if (!selectedWorldId.value)\n                return [];\n            const npcs = npcService.getNpcsByWorld(selectedWorldId.value).filter(npc => npcService.getNpcId(npc) !== '');\n            // NPC locationName \n            return npcs.map(npc => {\n                const npcId = npcService.getNpcId(npc);\n                return {\n                    ...npc,\n                    id: npcId,\n                    locationName: npcService.getLocationName(npc.),\n                };\n            });\n        });\n        const filteredNpcs = computed(() => {\n            let npcs = [...selectedWorldNpcs.value];\n            // Sort by followed status first\n            npcs.sort((a, b) => {\n                const aFollowed = a.id ? isFollowed(a.id) : false;\n                const bFollowed = b.id ? isFollowed(b.id) : false;\n                if (aFollowed && !bFollowed)\n                    return -1;\n                if (!aFollowed && bFollowed)\n                    return 1;\n                return 0;\n            });\n            if (!npcSearchTerm.value) {\n                return npcs;\n            }\n            return npcs.filter(n => n. && n..includes(npcSearchTerm.value));\n        });\n        const loadWorlds = async () => {\n            const allWorlds = await npcService.initializeWorldAndLocationData();\n            //  \"...\" \n            worlds.value = allWorlds.filter(w => w.name !== '...');\n            if (worlds.value.length > 0 && !selectedWorldId.value) {\n                selectedWorldId.value = worlds.value[0].id;\n            }\n        };\n        function selectWorld(worldId) {\n            selectedWorldId.value = worldId;\n            isWorldListVisible.value = false;\n        }\n        function selectNpc(npc) {\n            //  any  id  npc \n            selectedNpc.value = npc;\n            selectedNpcId.value = npc.id;\n        }\n        onMounted(loadWorlds);\n        watch(selectedWorldId, () => {\n            selectedNpc.value = null;\n            selectedNpcId.value = null;\n        });\n        watch(() => npcService.allNpcs.value, () => {\n            if (worlds.value.length === 0) {\n                loadWorlds();\n            }\n        }, { deep: true });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"button\", {\n                    class: \"toggle-world-list\",\n                    onClick: _cache[0] || (_cache[0] = ($event) => (isWorldListVisible.value = !isWorldListVisible.value))\n                }, \"\"),\n                _createCommentVNode(\" World List (Overlay) \"),\n                (isWorldListVisible.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 0,\n                        class: \"world-list-overlay\",\n                        onClick: _cache[2] || (_cache[2] = _withModifiers(($event) => (isWorldListVisible.value = false), [\"self\"]))\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_2, [\n                            _cache[4] || (_cache[4] = _createElementVNode(\"h4\", null, \"\", -1 /* CACHED */)),\n                            _withDirectives(_createElementVNode(\"input\", {\n                                type: \"text\",\n                                \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event) => ((worldSearchTerm).value = $event)),\n                                placeholder: \"...\",\n                                class: \"search-input\"\n                            }, null, 512 /* NEED_PATCH */), [\n                                [_vModelText, worldSearchTerm.value]\n                            ]),\n                            _createElementVNode(\"ul\", null, [\n                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(filteredWorlds.value, (world) => {\n                                    return (_openBlock(), _createElementBlock(\"li\", {\n                                        key: world.id,\n                                        class: _normalizeClass({ active: selectedWorldId.value === world.id }),\n                                        onClick: ($event) => (selectWorld(world.id))\n                                    }, _toDisplayString(world.name), 11 /* TEXT, CLASS, PROPS */, _hoisted_3));\n                                }), 128 /* KEYED_FRAGMENT */))\n                            ])\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\" NPC List \"),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    _cache[5] || (_cache[5] = _createElementVNode(\"h4\", null, \"NPC\", -1 /* CACHED */)),\n                    _withDirectives(_createElementVNode(\"input\", {\n                        type: \"text\",\n                        \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event) => ((npcSearchTerm).value = $event)),\n                        placeholder: \"NPC...\",\n                        class: \"search-input\"\n                    }, null, 512 /* NEED_PATCH */), [\n                        [_vModelText, npcSearchTerm.value]\n                    ]),\n                    (filteredNpcs.value.length > 0)\n                        ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_5, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(filteredNpcs.value, (npc) => {\n                                return (_openBlock(), _createElementBlock(\"li\", {\n                                    key: npc.,\n                                    class: _normalizeClass({ active: selectedNpc.value === npc }),\n                                    onClick: ($event) => (selectNpc(npc))\n                                }, [\n                                    _createElementVNode(\"div\", _hoisted_7, [\n                                        _createElementVNode(\"span\", _hoisted_8, _toDisplayString(npc.), 1 /* TEXT */),\n                                        _createElementVNode(\"span\", _hoisted_9, _toDisplayString(npc.locationName), 1 /* TEXT */)\n                                    ]),\n                                    (npc.id)\n                                        ? (_openBlock(), _createBlock(FollowButton, {\n                                            key: 0,\n                                            \"npc-id\": npc.id\n                                        }, null, 8 /* PROPS */, [\"npc-id\"]))\n                                        : _createCommentVNode(\"v-if\", true)\n                                ], 10 /* CLASS, PROPS */, _hoisted_6));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_10, \"NPC\"))\n                ]),\n                _createCommentVNode(\" NPC Details \"),\n                _createElementVNode(\"div\", _hoisted_11, [\n                    _cache[6] || (_cache[6] = _createElementVNode(\"h4\", null, \"NPC\", -1 /* CACHED */)),\n                    (selectedNpc.value)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_12, [\n                            _createVNode(NpcDetailDisplay, {\n                                npc: selectedNpc.value,\n                                \"npc-id\": selectedNpcId.value\n                            }, null, 8 /* PROPS */, [\"npc\", \"npc-id\"])\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_13, \"NPC\"))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcDirectoryPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcDirectoryPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcDirectoryPanel.vue?vue&type=style&index=0&id=3eff5428&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3eff5428\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = { class: \"log-panel-container\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"timeline\"\n};\nconst _hoisted_3 = [\"onClick\"];\nconst _hoisted_4 = { class: \"log-header\" };\nconst _hoisted_5 = { class: \"log-title\" };\nconst _hoisted_6 = { class: \"log-date\" };\nconst _hoisted_7 = { class: \"log-meta\" };\nconst _hoisted_8 = { class: \"log-description\" };\nconst _hoisted_9 = {\n    key: 0,\n    class: \"log-details\"\n};\nconst _hoisted_10 = { class: \"detail-section\" };\nconst _hoisted_11 = { class: \"detail-section\" };\nconst _hoisted_12 = { class: \"detail-section\" };\nconst _hoisted_13 = { class: \"detail-section automation-system\" };\nconst _hoisted_14 = {\n    key: 0,\n    class: \"log-tags\"\n};\nconst _hoisted_15 = {\n    key: 1,\n    class: \"empty-state\"\n};\nimport { computed, ref } from 'vue';\nimport { store } from '../../store';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'LogPanel',\n    setup(__props) {\n        const logs = computed(() => [...store.worldLog].sort((a, b) => b. - a.));\n        const expandedLog = ref(null);\n        function toggleDetails(logId) {\n            if (expandedLog.value === logId) {\n                expandedLog.value = null;\n            }\n            else {\n                expandedLog.value = logId;\n            }\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (logs.value.length > 0)\n                    ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_2, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(logs.value, (log) => {\n                            return (_openBlock(), _createElementBlock(\"li\", {\n                                key: log.,\n                                class: \"timeline-item\"\n                            }, [\n                                _cache[6] || (_cache[6] = _createElementVNode(\"div\", { class: \"timeline-marker\" }, null, -1 /* CACHED */)),\n                                _createElementVNode(\"div\", {\n                                    class: \"timeline-content\",\n                                    onClick: ($event) => (toggleDetails(log.))\n                                }, [\n                                    _createElementVNode(\"div\", _hoisted_4, [\n                                        _createElementVNode(\"span\", _hoisted_5, _toDisplayString(log.), 1 /* TEXT */),\n                                        _createElementVNode(\"span\", _hoisted_6, _toDisplayString(log.), 1 /* TEXT */)\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_7, [\n                                        _createElementVNode(\"span\", null, [\n                                            _cache[0] || (_cache[0] = _createElementVNode(\"i\", { class: \"fas fa-map-marker-alt icon\" }, null, -1 /* CACHED */)),\n                                            _createTextVNode(\" \" + _toDisplayString(log.), 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"span\", null, [\n                                            _cache[1] || (_cache[1] = _createElementVNode(\"i\", { class: \"fas fa-users icon\" }, null, -1 /* CACHED */)),\n                                            _createTextVNode(\" \" + _toDisplayString(log.), 1 /* TEXT */)\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"p\", _hoisted_8, _toDisplayString(log.), 1 /* TEXT */),\n                                    (expandedLog.value === log.)\n                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [\n                                            _createElementVNode(\"div\", _hoisted_10, [\n                                                _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                _createElementVNode(\"p\", null, _toDisplayString(log.), 1 /* TEXT */)\n                                            ]),\n                                            _createElementVNode(\"div\", _hoisted_11, [\n                                                _cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                _createElementVNode(\"p\", null, _toDisplayString(log.), 1 /* TEXT */)\n                                            ]),\n                                            _createElementVNode(\"div\", _hoisted_12, [\n                                                _cache[4] || (_cache[4] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                _createElementVNode(\"p\", null, _toDisplayString(log.), 1 /* TEXT */)\n                                            ]),\n                                            _createElementVNode(\"div\", _hoisted_13, [\n                                                _cache[5] || (_cache[5] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                _createElementVNode(\"pre\", null, _toDisplayString(log.), 1 /* TEXT */)\n                                            ]),\n                                            (log. && log..length > 0)\n                                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_14, [\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(log., (tag) => {\n                                                        return (_openBlock(), _createElementBlock(\"span\", {\n                                                            key: tag,\n                                                            class: \"tag\"\n                                                        }, _toDisplayString(tag), 1 /* TEXT */));\n                                                    }), 128 /* KEYED_FRAGMENT */))\n                                                ]))\n                                                : _createCommentVNode(\"v-if\", true)\n                                        ]))\n                                        : _createCommentVNode(\"v-if\", true)\n                                ], 8 /* PROPS */, _hoisted_3)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_15, [...(_cache[7] || (_cache[7] = [\n                            _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                        ]))]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./LogPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./LogPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./LogPanel.vue?vue&type=style&index=0&id=03bc3d58&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-03bc3d58\"]])\n\nexport default __exports__","import { reactive } from 'vue';\nimport { lorebookService } from './LorebookService';\n\nexport interface Ripple {\n  id: number;\n  title: string;\n  rawContent: string;\n  [key: string]: any;\n}\n\n//  actions.ts \nfunction parseBlock(block: string): { [key: string]: string } {\n  const data: { [key: string]: string } = {};\n  const lines = block.trim().split('\\n');\n  let currentKey = '';\n  for (const line of lines) {\n    const separatorIndex = line.indexOf('|');\n    if (separatorIndex !== -1) {\n      const key = line.substring(0, separatorIndex).trim();\n      const value = line.substring(separatorIndex + 1).trim();\n      data[key] = value;\n      currentKey = key;\n    } else if (currentKey && line.trim()) {\n      data[currentKey] += '\\n' + line;\n    }\n  }\n  for (const key in data) {\n    data[key] = data[key].trim();\n  }\n  return data;\n}\n\nclass RipplesService {\n  public ripples = reactive<Ripple[]>([]);\n\n  async initialize() {\n    await this.loadRipples();\n  }\n\n  async loadRipples() {\n    try {\n      const rippleContent = await lorebookService.readFromLorebook('');\n      if (!rippleContent || !rippleContent.trim()) {\n        this.ripples.splice(0, this.ripples.length); // \n        return;\n      }\n\n      const rippleBlocks = rippleContent.split('\\n\\n---\\n\\n');\n      const parsedRipples: Ripple[] = [];\n\n      for (const blockContent of rippleBlocks) {\n        if (!blockContent.trim()) continue;\n        const blockData = parseBlock(blockContent);\n        const rippleId = parseInt(blockData['x'], 10);\n\n        if (!isNaN(rippleId)) {\n          parsedRipples.push({\n            id: rippleId,\n            title: ` ${rippleId} `,\n            rawContent: blockContent,\n            ...blockData,\n          });\n        }\n      }\n\n      // \n      this.ripples.splice(0, this.ripples.length, ...parsedRipples.sort((a, b) => a.id - b.id));\n      console.log(`[RipplesService] Loaded ${this.ripples.length} ripples.`);\n    } catch (error) {\n      console.error('[RipplesService] Error loading ripples:', error);\n      this.ripples.splice(0, this.ripples.length); // \n    }\n  }\n\n  getRippleById(id: number): Ripple | undefined {\n    return this.ripples.find(r => r.id === id);\n  }\n}\n\nexport const ripplesService = new RipplesService();\n","import { defineComponent as _defineComponent } from 'vue';\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode } from \"vue\";\nconst _hoisted_1 = { class: \"ripples-panel\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"ripples-list\"\n};\nconst _hoisted_3 = {\n    key: 0,\n    class: \"empty-state\"\n};\nconst _hoisted_4 = { key: 1 };\nconst _hoisted_5 = [\"onClick\"];\nconst _hoisted_6 = { class: \"ripple-title\" };\nconst _hoisted_7 = { class: \"ripple-summary\" };\nconst _hoisted_8 = {\n    key: 1,\n    class: \"ripple-detail\"\n};\nconst _hoisted_9 = { class: \"detail-content\" };\nconst _hoisted_10 = { class: \"detail-key\" };\nconst _hoisted_11 = { class: \"detail-value\" };\nimport { ref, computed, onMounted } from 'vue';\nimport { ripplesService } from '../../services/RipplesService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'RipplesPanel',\n    setup(__props) {\n        const ripples = computed(() => ripplesService.ripples);\n        const selectedRipple = ref(null);\n        const selectRipple = (ripple) => {\n            selectedRipple.value = ripple;\n        };\n        onMounted(() => {\n            ripplesService.loadRipples();\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (!selectedRipple.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        (ripples.value.length === 0)\n                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, \"\"))\n                            : (_openBlock(), _createElementBlock(\"ul\", _hoisted_4, [\n                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(ripples.value, (ripple) => {\n                                    return (_openBlock(), _createElementBlock(\"li\", {\n                                        key: ripple.id,\n                                        onClick: ($event) => (selectRipple(ripple))\n                                    }, [\n                                        _createElementVNode(\"span\", _hoisted_6, _toDisplayString(ripple.title), 1 /* TEXT */),\n                                        _createElementVNode(\"span\", _hoisted_7, _toDisplayString(ripple['']?.substring(0, 50)) + \"...\", 1 /* TEXT */)\n                                    ], 8 /* PROPS */, _hoisted_5));\n                                }), 128 /* KEYED_FRAGMENT */))\n                            ]))\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [\n                        _createElementVNode(\"button\", {\n                            onClick: _cache[0] || (_cache[0] = ($event) => (selectedRipple.value = null)),\n                            class: \"back-button\"\n                        }, \"< \"),\n                        _createElementVNode(\"div\", _hoisted_9, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(selectedRipple.value, (value, key) => {\n                                return (_openBlock(), _createElementBlock(\"div\", {\n                                    key: key,\n                                    class: \"detail-item\"\n                                }, [\n                                    _createElementVNode(\"strong\", _hoisted_10, _toDisplayString(key) + \":\", 1 /* TEXT */),\n                                    _createElementVNode(\"pre\", _hoisted_11, _toDisplayString(value), 1 /* TEXT */)\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ])\n                    ]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./RipplesPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./RipplesPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./RipplesPanel.vue?vue&type=style&index=0&id=c8ad07aa&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-c8ad07aa\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = { class: \"avatar-selection\" };\nconst _hoisted_2 = { key: 0 };\nconst _hoisted_3 = [\"onClick\"];\nimport { computed } from 'vue';\nimport { actions, store } from '../../../store';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'AvatarSelection',\n    setup(__props) {\n        const avatars = computed(() => store.reincarnationAvatarOptions);\n        const selectAvatar = (avatar) => {\n            //  action\n            actions.selectAvatarAndStart(avatar.);\n            // \n            // \n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (avatars.value.length === 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, \"AI...\"))\n                    : (_openBlock(true), _createElementBlock(_Fragment, { key: 1 }, _renderList(avatars.value, (avatar, index) => {\n                        return (_openBlock(), _createElementBlock(\"div\", {\n                            key: index,\n                            class: \"avatar-card\",\n                            onClick: ($event) => (selectAvatar(avatar))\n                        }, [\n                            _createElementVNode(\"h4\", null, _toDisplayString(avatar.), 1 /* TEXT */),\n                            _createElementVNode(\"p\", null, [\n                                _cache[0] || (_cache[0] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                _createTextVNode(\" \" + _toDisplayString(avatar.), 1 /* TEXT */)\n                            ]),\n                            _createElementVNode(\"p\", null, [\n                                _cache[1] || (_cache[1] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                _createTextVNode(\" \" + _toDisplayString(avatar.), 1 /* TEXT */)\n                            ])\n                        ], 8 /* PROPS */, _hoisted_3));\n                    }), 128 /* KEYED_FRAGMENT */))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./AvatarSelection.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AvatarSelection.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./AvatarSelection.vue?vue&type=style&index=0&id=375c1c96&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-375c1c96\"]])\n\nexport default __exports__","const __WEBPACK_NAMESPACE_OBJECT__ = toastr;","import { reactive } from 'vue';\n\ninterface ConfirmationState {\n  isVisible: boolean;\n  title: string;\n  message: string;\n  onConfirm: (() => void) | null;\n  onCancel: (() => void) | null;\n  hideCancel: boolean;\n}\n\nconst state = reactive<ConfirmationState>({\n  isVisible: false,\n  title: '',\n  message: '',\n  onConfirm: null,\n  onCancel: null,\n  hideCancel: false,\n});\n\nexport const confirmationService = {\n  get state() {\n    return state;\n  },\n\n  show(title: string, message: string, onConfirm: () => void, hideCancel = false) {\n    return new Promise<boolean>(resolve => {\n      state.title = title;\n      state.message = message;\n      state.onConfirm = () => {\n        onConfirm();\n        resolve(true);\n      };\n      state.onCancel = () => {\n        this.hide();\n        resolve(false);\n      };\n      state.hideCancel = hideCancel;\n      state.isVisible = true;\n    });\n  },\n\n  hide() {\n    state.isVisible = false;\n    state.title = '';\n    state.message = '';\n    state.onConfirm = null;\n    state.onCancel = null;\n    state.hideCancel = false;\n  },\n\n  confirm() {\n    if (state.onConfirm) {\n      state.onConfirm(); // This will now also resolve the promise\n    }\n    // Hiding is handled within onConfirm/onCancel now\n  },\n  cancel() {\n    if (state.onCancel) {\n      state.onCancel();\n    }\n  },\n};\n","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"card-header\" };\nconst _hoisted_2 = { class: \"choice-type\" };\nconst _hoisted_3 = { class: \"card-body\" };\nconst _hoisted_4 = { class: \"description\" };\nconst _hoisted_5 = {\n    key: 0,\n    class: \"data-details\"\n};\nconst _hoisted_6 = { class: \"data-name\" };\nconst _hoisted_7 = { class: \"data-description\" };\nconst _hoisted_8 = { class: \"card-footer\" };\nconst _hoisted_9 = { class: \"cost\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'SettlementChoiceCard',\n    props: {\n        choice: {\n            type: Object,\n            required: true,\n        },\n        isSelected: {\n            type: Boolean,\n            default: false,\n        },\n    },\n    emits: ['select'],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emits = __emit;\n        const selectCard = () => {\n            emits('select', props.choice);\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n                class: _normalizeClass([\"settlement-choice-card\", { 'is-selected': __props.isSelected }]),\n                onClick: selectCard\n            }, [\n                _createElementVNode(\"div\", _hoisted_1, [\n                    _createElementVNode(\"span\", _hoisted_2, _toDisplayString(__props.choice.), 1 /* TEXT */)\n                ]),\n                _createElementVNode(\"div\", _hoisted_3, [\n                    _createElementVNode(\"p\", _hoisted_4, _toDisplayString(__props.choice.), 1 /* TEXT */),\n                    (__props.choice.)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n                            _createElementVNode(\"strong\", _hoisted_6, _toDisplayString(__props.choice..), 1 /* TEXT */),\n                            _createElementVNode(\"p\", _hoisted_7, _toDisplayString(__props.choice..), 1 /* TEXT */)\n                        ]))\n                        : _createCommentVNode(\"v-if\", true)\n                ]),\n                _createElementVNode(\"div\", _hoisted_8, [\n                    _createElementVNode(\"span\", _hoisted_9, \": \" + _toDisplayString(__props.choice.), 1 /* TEXT */)\n                ])\n            ], 2 /* CLASS */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./SettlementChoiceCard.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SettlementChoiceCard.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode } from \"vue\";\nconst _hoisted_1 = { class: \"settlement-view\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"choices-grid\"\n};\nconst _hoisted_3 = {\n    key: 1,\n    class: \"no-choices\"\n};\nconst _hoisted_4 = {\n    key: 2,\n    class: \"actions-footer\"\n};\nconst _hoisted_5 = [\"disabled\"];\nimport { get } from 'lodash';\nimport * as toastr from 'toastr';\nimport { computed, ref } from 'vue';\nimport { commandService } from '../../../services/CommandService';\nimport { confirmationService } from '../../../services/ConfirmationService';\nimport { store } from '../../../store';\nimport SettlementChoiceCard from './SettlementChoiceCard.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'SettlementView',\n    setup(__props) {\n        const selectedChoice = ref(null);\n        const choices = computed(() => {\n            const choicesObj = get(store.worldState, '...', {});\n            if (typeof choicesObj === 'object' && choicesObj !== null) {\n                return Object.values(choicesObj).filter((c) => c && c. && c. && !c..includes(''));\n            }\n            return [];\n        });\n        const confirmChoice = async () => {\n            if (!selectedChoice.value)\n                return;\n            const choice = selectedChoice.value;\n            // Robustly find the main character by looking for the '' property\n            const characters = get(store.worldState, '', {});\n            const mainCharacter = Object.values(characters).find((char) => char && char.hasOwnProperty(''));\n            if (!mainCharacter) {\n                toastr.error('');\n                console.error('Could not find the main character in the world state.');\n                return;\n            }\n            const soulEssence = get(mainCharacter, '', 0);\n            if (soulEssence < choice.) {\n                await confirmationService.show('', ` ${choice.}  ${soulEssence}`, () => { }, true);\n                return;\n            }\n            const confirmed = await confirmationService.show('?', ` ${choice.} ${choice..}`, () => { });\n            if (confirmed) {\n                // This is a placeholder for the action to confirm the choice.\n                // You would typically call a store action here.\n                console.log('Confirmed choice:', choice);\n                const command = `< ${JSON.stringify(choice.)}>`;\n                commandService.addCommand(command);\n                confirmationService.hide();\n                toastr.success(`: ${choice..}`);\n            }\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (choices.value.length > 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(choices.value, (choice, index) => {\n                            return (_openBlock(), _createBlock(SettlementChoiceCard, {\n                                key: index,\n                                choice: choice,\n                                \"is-selected\": selectedChoice.value === choice,\n                                onSelect: _cache[0] || (_cache[0] = ($event) => (selectedChoice.value = $event))\n                            }, null, 8 /* PROPS */, [\"choice\", \"is-selected\"]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [...(_cache[1] || (_cache[1] = [\n                            _createElementVNode(\"p\", null, \"\", -1 /* CACHED */),\n                            _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                        ]))])),\n                (choices.value.length > 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [\n                        _createElementVNode(\"button\", {\n                            class: \"confirm-button\",\n                            onClick: confirmChoice,\n                            disabled: !selectedChoice.value\n                        }, \"\", 8 /* PROPS */, _hoisted_5)\n                    ]))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./SettlementView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SettlementView.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import * as THREE from 'three';\nimport { OrbitControls } from 'three/addons/controls/OrbitControls.js';\n\ninterface WorldData {\n  id: number;\n  name: string;\n  [key: string]: any;\n}\n\ninterface StarObject extends THREE.Group {\n  orbitSpeed?: number;\n  orbitRadius?: number;\n  orbitAngle?: number;\n}\n\nexport class StarMapService {\n  private scene: THREE.Scene;\n  private camera: THREE.PerspectiveCamera;\n  private renderer: THREE.WebGLRenderer;\n  private controls: OrbitControls;\n  private container: HTMLElement;\n  private stars: THREE.Group;\n  private skybox: THREE.Mesh | null = null;\n  private starObjects: StarObject[] = [];\n  private speedMultiplier: number = 0.2; // Add a speed multiplier\n\n  constructor(container: HTMLElement) {\n    console.log('[StarMapService] Constructor called.');\n    this.container = container;\n    this.scene = new THREE.Scene();\n    this.camera = new THREE.PerspectiveCamera(75, this.container.clientWidth / this.container.clientHeight, 0.1, 1000);\n    this.renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });\n    this.stars = new THREE.Group();\n\n    this.init();\n\n    this.controls = new OrbitControls(this.camera, this.renderer.domElement);\n    this.controls.enableDamping = true; // Smooths out the camera movement\n    this.controls.dampingFactor = 0.05;\n    this.controls.autoRotate = true;\n    this.controls.autoRotateSpeed = 0.1;\n    this.controls.minDistance = 5; // Allow zooming in closer\n    this.controls.maxDistance = 200; // Allow zooming out further\n    this.controls.enablePan = true; // Enable panning with right-click\n    this.controls.panSpeed = 0.5;\n\n    this.animate();\n  }\n\n  private init() {\n    console.log('[StarMapService] Init started.');\n    // Renderer\n    this.renderer.setSize(this.container.clientWidth, this.container.clientHeight);\n    this.renderer.setPixelRatio(window.devicePixelRatio);\n    this.container.appendChild(this.renderer.domElement);\n\n    // Camera\n    this.camera.position.z = 50;\n    this.scene.add(this.camera);\n\n    // Stars group\n    this.scene.add(this.stars);\n\n    // Handle window resize\n    window.addEventListener('resize', this.onWindowResize.bind(this));\n    this.createSkybox();\n  }\n\n  private createSkybox() {\n    const shaderMaterial = new THREE.ShaderMaterial({\n      vertexShader: `\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      `,\n      fragmentShader: `\n        varying vec2 vUv;\n        uniform float u_time;\n\n        float random(vec2 st) {\n          return fract(sin(dot(st.xy, vec2(12.9898, 78.233))) * 43758.5453123);\n        }\n\n        float noise(vec2 st) {\n          vec2 i = floor(st);\n          vec2 f = fract(st);\n          vec2 u = f * f * (3.0 - 2.0 * f);\n          return mix(mix(random(i + vec2(0.0, 0.0)), random(i + vec2(1.0, 0.0)), u.x),\n                     mix(random(i + vec2(0.0, 1.0)), random(i + vec2(1.0, 1.0)), u.x), u.y);\n        }\n\n        mat2 rotate(float a) {\n          float s = sin(a);\n          float c = cos(a);\n          return mat2(c, -s, s, c);\n        }\n\n        float fbm(vec2 st) {\n          float value = 0.0;\n          float amplitude = 0.5;\n          for (int i = 0; i < 6; i++) {\n            value += amplitude * noise(st);\n            st *= 2.0;\n            amplitude *= 0.5;\n          }\n          return value;\n        }\n\n        void main() {\n          vec2 st = vUv * 5.0;\n          st.x *= 1.5;\n          st *= rotate(u_time * 0.005);\n          \n          float f = fbm(st + u_time * 0.01);\n          f *= fbm(st * 0.5 + u_time * 0.005);\n\n          vec3 color1 = vec3(0.05, 0.0, 0.15);   // Deep Space Blue\n          vec3 color2 = vec3(0.2, 0.1, 0.5);    // Nebula Purple\n          vec3 color3 = vec3(0.8, 0.3, 0.3);    // Distant Star Red\n\n          float t = smoothstep(0.3, 0.6, f);\n          vec3 finalColor = mix(color1, color2, t);\n          finalColor = mix(finalColor, color3, smoothstep(0.5, 0.7, f));\n\n          gl_FragColor = vec4(finalColor, 1.0);\n        }\n      `,\n      uniforms: {\n        u_time: { value: 0.0 },\n      },\n      side: THREE.BackSide,\n    });\n\n    const skyboxGeometry = new THREE.SphereGeometry(500, 60, 40);\n    this.skybox = new THREE.Mesh(skyboxGeometry, shaderMaterial);\n    this.scene.add(this.skybox);\n  }\n\n  private getColorForEnergyLevel(level: number): THREE.Color {\n    if (level <= 5) return new THREE.Color(0x00ffff); // Cyan\n    if (level <= 10) return new THREE.Color(0x00ff00); // Green\n    if (level <= 15) return new THREE.Color(0xffff00); // Yellow\n    if (level <= 20) return new THREE.Color(0xffa500); // Orange\n    return new THREE.Color(0x800080); // Purple\n  }\n\n  public createStars(worlds: WorldData[], selectableIds: Set<number>) {\n    console.log(`[StarMapService] Updating stars with ${worlds.length} worlds.`);\n\n    const existingStarIds = new Set(this.starObjects.map(s => s.userData.world.id));\n    const newWorldIds = new Set(worlds.map(w => w.id));\n\n    // --- Exit ---\n    this.starObjects = this.starObjects.filter(star => {\n      if (!newWorldIds.has(star.userData.world.id)) {\n        // Animate out and remove\n        this.stars.remove(star);\n        return false;\n      }\n      return true;\n    });\n\n    // --- Enter ---\n    worlds.forEach(world => {\n      if (!existingStarIds.has(world.id)) {\n        this.createSingleStar(world, selectableIds);\n      }\n    });\n\n    // --- Update ---\n    this.starObjects.forEach(star => {\n      const world = star.userData.world;\n      const isSelectable = selectableIds.has(world.id);\n      const energyLevel = world.energyLevel || 1;\n      const baseColor = this.getColorForEnergyLevel(energyLevel);\n      const newColor = isSelectable ? baseColor : new THREE.Color(0x444444);\n\n      const core = star.children[0] as THREE.Mesh<THREE.SphereGeometry, THREE.MeshBasicMaterial>;\n      const halo = star.children[1] as THREE.Mesh<THREE.SphereGeometry, THREE.MeshBasicMaterial>;\n\n      if (core && halo) {\n        core.material.color.lerp(newColor, 0.1);\n        halo.material.color.lerp(newColor, 0.1);\n      }\n    });\n  }\n\n  private createSingleStar(world: WorldData, selectableIds: Set<number>) {\n    const coreGeometry = new THREE.SphereGeometry(0.3, 16, 16);\n    const haloGeometry = new THREE.SphereGeometry(0.5, 16, 16);\n\n    const phi = Math.acos(-1 + 2 * Math.random());\n    const theta = Math.sqrt(this.starObjects.length * Math.PI) * phi;\n    const radius = 30;\n\n    const x = radius * Math.cos(theta) * Math.sin(phi);\n    const y = radius * Math.sin(theta) * Math.sin(phi);\n    const z = radius * Math.cos(phi);\n\n    const isSelectable = selectableIds.has(world.id);\n    const energyLevel = world.energyLevel || 1;\n    const timeFlow = world.timeFlow || 1;\n\n    const baseColor = this.getColorForEnergyLevel(energyLevel);\n    const starColor = isSelectable ? baseColor : new THREE.Color(0x444444);\n\n    // Star Core\n    const coreMaterial = new THREE.MeshBasicMaterial({ color: starColor });\n    const core = new THREE.Mesh(coreGeometry, coreMaterial);\n\n    // Star Halo\n    const haloMaterial = new THREE.MeshBasicMaterial({\n      color: starColor,\n      transparent: true,\n      opacity: 0.4,\n      blending: THREE.AdditiveBlending,\n    });\n    const halo = new THREE.Mesh(haloGeometry, haloMaterial);\n\n    const haloScale = 1.5;\n    halo.scale.set(haloScale, haloScale, haloScale);\n\n    const starGroup: StarObject = new THREE.Group();\n    starGroup.add(core);\n    starGroup.add(halo);\n\n    starGroup.position.set(x, y, z);\n\n    // Store world data in the group for picking\n    starGroup.userData = { world }; // Store data on the group itself\n    core.userData = { world }; // Also on core for raycasting\n    halo.userData = { world };\n\n    // Store orbit data\n    starGroup.orbitSpeed = Math.log1p(timeFlow) * 0.015; // Directly tie speed to timeFlow\n    starGroup.orbitRadius = Math.sqrt(x * x + z * z);\n    starGroup.orbitAngle = Math.atan2(z, x);\n\n    this.stars.add(starGroup);\n    this.starObjects.push(starGroup);\n  }\n\n  private animate() {\n    requestAnimationFrame(this.animate.bind(this));\n\n    // Update shader time uniform\n    if (this.skybox && this.skybox.material instanceof THREE.ShaderMaterial) {\n      this.skybox.material.uniforms.u_time.value += 0.01;\n    }\n\n    // Update star orbits\n    this.starObjects.forEach(star => {\n      if (star.orbitSpeed && star.orbitRadius && star.orbitAngle !== undefined) {\n        star.orbitAngle += star.orbitSpeed * this.speedMultiplier;\n        star.position.x = star.orbitRadius * Math.cos(star.orbitAngle);\n        star.position.z = star.orbitRadius * Math.sin(star.orbitAngle);\n      }\n    });\n\n    this.controls.update();\n    this.renderer.render(this.scene, this.camera);\n  }\n\n  private onWindowResize() {\n    this.camera.aspect = this.container.clientWidth / this.container.clientHeight;\n    this.camera.updateProjectionMatrix();\n    this.renderer.setSize(this.container.clientWidth, this.container.clientHeight);\n  }\n\n  public destroy() {\n    window.removeEventListener('resize', this.onWindowResize.bind(this));\n    this.renderer.dispose();\n    if (this.container && this.renderer.domElement) {\n      this.container.removeChild(this.renderer.domElement);\n    }\n  }\n\n  // Placeholder for click detection\n  public pickStar(event: MouseEvent): WorldData | null {\n    const raycaster = new THREE.Raycaster();\n    const mouse = new THREE.Vector2();\n    const rect = this.renderer.domElement.getBoundingClientRect();\n\n    // Calculate mouse position in normalized device coordinates\n    mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;\n    mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;\n\n    raycaster.setFromCamera(mouse, this.camera);\n    const intersects = raycaster.intersectObjects(this.stars.children);\n\n    if (intersects.length > 0) {\n      return intersects[0].object.userData.world as WorldData;\n    }\n    return null;\n  }\n\n  public setSpeedMultiplier(multiplier: number) {\n    this.speedMultiplier = Math.max(0, multiplier); // Ensure multiplier is not negative\n  }\n\n  public getSpeedMultiplier(): number {\n    return this.speedMultiplier;\n  }\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { normalizeStyle as _normalizeStyle, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, renderList as _renderList, Fragment as _Fragment, normalizeClass as _normalizeClass, unref as _unref } from \"vue\";\nconst _hoisted_1 = { class: \"world-selection-container\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"loading-state\"\n};\nconst _hoisted_3 = { class: \"progress-bar-container\" };\nconst _hoisted_4 = { class: \"detail-item\" };\nconst _hoisted_5 = { class: \"detail-item\" };\nconst _hoisted_6 = { class: \"epoch-tabs\" };\nconst _hoisted_7 = [\"onClick\"];\nconst _hoisted_8 = { class: \"detail-item\" };\nconst _hoisted_9 = { class: \"detail-item\" };\nconst _hoisted_10 = {\n    key: 0,\n    class: \"detail-item\"\n};\nconst _hoisted_11 = { class: \"world-description\" };\nconst _hoisted_12 = { class: \"panel-footer\" };\nconst _hoisted_13 = [\"disabled\"];\nconst _hoisted_14 = {\n    key: 1,\n    class: \"unselectable-notice\"\n};\nconst _hoisted_15 = { class: \"map-controls\" };\nconst _hoisted_16 = { class: \"speed-controls-overlay\" };\nconst _hoisted_17 = { class: \"speed-bar-container\" };\nconst _hoisted_18 = {\n    key: 2,\n    class: \"evolving-overlay\"\n};\nimport { computed, onMounted, onUnmounted, ref, watch } from 'vue';\nimport { get } from 'lodash';\n// import { lorebookService } from '../../../services/LorebookService'; // \nimport { StarMapService } from '../../../services/StarMapService';\nimport { actions, store } from '../../../store';\nimport { isSimulationRunning, simulatorCooldown } from '../../../store/getters';\nimport './WorldSelection.scss';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'WorldSelection',\n    setup(__props) {\n        const starmapContainer = ref(null);\n        let starMapService = null;\n        const isLoading = ref(true);\n        const detailedWorld = ref(null);\n        const selectableWorldIds = ref(new Set());\n        const progress = ref(0);\n        let progressInterval = null;\n        const activeEpochId = ref(null);\n        // 5-speed level control\n        const speedLevels = [0, 0.2, 0.5, 1.0, 2.0];\n        const speedLevel = ref(2); // Default to level 2 (1.0x speed)\n        const parsedWorlds = computed(() => {\n            const worlds = get(store.worldState, '', {});\n            let idCounter = 0;\n            return Object.entries(worlds)\n                .filter(([worldId]) => worldId !== '$meta' && !worldId.includes('template'))\n                .map(([worldId, worldData]) => {\n                const historicalEpochs = get(worldData, '.', {});\n                const epochs = Object.entries(historicalEpochs).map(([epochId, epochData]) => {\n                    const coreLaws = get(epochData, '.', {});\n                    return {\n                        id: epochId,\n                        name: epochData. || '',\n                        energyLevel: get(epochData, '.', 1),\n                        timeFlow: get(epochData, '.', 1),\n                        description: epochData. || '',\n                        coreLaws: Object.values(coreLaws)\n                            .map((law) => law.)\n                            .filter(Boolean),\n                    };\n                });\n                return {\n                    id: ++idCounter,\n                    name: worldData. || '',\n                    raw: { ...worldData, originalId: worldId },\n                    cosmologicalBlueprint: get(worldData, '..', ''),\n                    physicalScale: get(worldData, '..', ''),\n                    currentEpochId: get(worldData, '..ID', ''),\n                    epochs: epochs,\n                };\n            });\n        });\n        const cooldown = computed(() => simulatorCooldown.value);\n        const isDetailedWorldActive = computed(() => {\n            // 1.  2. \n            return !isSimulationRunning.value && cooldown.value.status !== '';\n        });\n        const selectRandomWorlds = () => {\n            //  `isSimulationRunning` getter \n            // \n            if (isSimulationRunning.value) {\n                selectableWorldIds.value = new Set();\n                return;\n            }\n            // \n            const worlds = parsedWorlds.value;\n            if (worlds.length === 0)\n                return;\n            const ids = worlds.map(w => w.id);\n            if (worlds.length <= 3) {\n                selectableWorldIds.value = new Set(ids);\n            }\n            else {\n                const shuffled = [...ids].sort(() => 0.5 - Math.random());\n                selectableWorldIds.value = new Set(shuffled.slice(0, 3));\n            }\n        };\n        const rescanWorlds = () => {\n            isLoading.value = true;\n            detailedWorld.value = null;\n            progress.value = 0;\n            if (progressInterval) {\n                clearInterval(progressInterval);\n            }\n            progressInterval = window.setInterval(() => {\n                if (progress.value < 99) {\n                    progress.value++;\n                }\n                else {\n                    if (progressInterval)\n                        clearInterval(progressInterval);\n                }\n            }, 960); // 135 (95000ms / 99 ~= 960ms)\n            // \n            actions.resetReincarnationSelection();\n            // UI\n            actions.triggerCreationWorkflow();\n        };\n        // const syncNewWorlds = () => {\n        //   store.newWorldsAvailable = false;\n        //   // \n        //   window.location.reload();\n        // };\n        const handleCanvasClick = (event) => {\n            if (!starMapService)\n                return;\n            const pickedWorld = starMapService.pickStar(event);\n            if (pickedWorld) {\n                detailedWorld.value = pickedWorld;\n            }\n            else {\n                detailedWorld.value = null;\n            }\n        };\n        const activeEpoch = computed(() => {\n            if (!detailedWorld.value || !activeEpochId.value)\n                return null;\n            return detailedWorld.value.epochs.find(e => e.id === activeEpochId.value);\n        });\n        watch(detailedWorld, newWorld => {\n            if (newWorld) {\n                activeEpochId.value = newWorld.currentEpochId;\n            }\n            else {\n                activeEpochId.value = null;\n            }\n        });\n        watch(starmapContainer, newContainer => {\n            if (newContainer && !starMapService) {\n                console.log('[WorldSelection] starmapContainer is now available. Initializing StarMapService.');\n                starMapService = new StarMapService(newContainer);\n                // If worlds are already loaded, create stars immediately\n                if (parsedWorlds.value.length > 0) {\n                    console.log('[WorldSelection] Worlds already present, calling createStars from container watch.');\n                    starMapService.createStars(parsedWorlds.value, selectableWorldIds.value);\n                }\n            }\n        });\n        onMounted(async () => {\n            console.log('[WorldSelection] Component Mounted.');\n            // isLoading.value = true; // \n            await actions.fetchReincarnationWorlds();\n            selectRandomWorlds();\n            if (starMapService) {\n                starMapService.createStars(parsedWorlds.value, selectableWorldIds.value);\n            }\n            isLoading.value = false; // \n        });\n        onUnmounted(() => {\n            starMapService?.destroy();\n        });\n        watch(parsedWorlds, newWorlds => {\n            console.log(`[WorldSelection] Parsed worlds watcher triggered: ${newWorlds.length} worlds.`);\n            if (newWorlds.length > 0) {\n                // if (isLoading.value) { // \n                //   isLoading.value = false;\n                // }\n                //  await\n                selectRandomWorlds();\n                // The service might not be ready yet, the starmapContainer watcher will handle creation\n                if (starMapService) {\n                    console.log('[WorldSelection] Service exists, calling createStars from worlds watch.');\n                    starMapService.createStars(newWorlds, selectableWorldIds.value);\n                }\n            }\n        }, { deep: true });\n        // \n        watch(isSimulationRunning, (isRunning, wasRunning) => {\n            // \n            if (wasRunning && !isRunning) {\n                console.log('[WorldSelection] Simulation has ended. Re-selecting random worlds.');\n                selectRandomWorlds();\n            }\n        });\n        const prepareReincarnation = (world) => {\n            if (!isSimulationRunning.value) {\n                actions.triggerIdentityWorkflow(world.originalId);\n                detailedWorld.value = null;\n            }\n        };\n        const adjustSpeed = (delta) => {\n            const newLevel = speedLevel.value + delta;\n            if (newLevel >= 0 && newLevel < speedLevels.length) {\n                speedLevel.value = newLevel;\n                if (starMapService) {\n                    starMapService.setSpeedMultiplier(speedLevels[speedLevel.value]);\n                }\n            }\n        };\n        watch(speedLevel, newLevel => {\n            if (starMapService) {\n                starMapService.setSpeedMultiplier(speedLevels[newLevel]);\n            }\n        }, { immediate: true });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (isLoading.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _createElementVNode(\"div\", _hoisted_3, [\n                            _createElementVNode(\"div\", {\n                                class: \"progress-bar\",\n                                style: _normalizeStyle({ width: progress.value + '%' })\n                            }, null, 4 /* STYLE */)\n                        ]),\n                        _createElementVNode(\"span\", null, \"... \" + _toDisplayString(progress.value) + \"%\", 1 /* TEXT */)\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                (!isLoading.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 1,\n                        ref_key: \"starmapContainer\",\n                        ref: starmapContainer,\n                        class: \"star-map-canvas\",\n                        onClick: handleCanvasClick\n                    }, null, 512 /* NEED_PATCH */))\n                    : _createCommentVNode(\"v-if\", true),\n                _createElementVNode(\"div\", {\n                    class: _normalizeClass([\"world-detail-panel\", { visible: !!detailedWorld.value }])\n                }, [\n                    (detailedWorld.value && activeEpoch.value)\n                        ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                            _createElementVNode(\"h4\", null, _toDisplayString(detailedWorld.value.name), 1 /* TEXT */),\n                            _createElementVNode(\"div\", _hoisted_4, [\n                                _createElementVNode(\"p\", null, [\n                                    _cache[4] || (_cache[4] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                    _createTextVNode(\" \" + _toDisplayString(detailedWorld.value.cosmologicalBlueprint), 1 /* TEXT */)\n                                ])\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_5, [\n                                _createElementVNode(\"p\", null, [\n                                    _cache[5] || (_cache[5] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                    _createTextVNode(\" \" + _toDisplayString(detailedWorld.value.physicalScale), 1 /* TEXT */)\n                                ])\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_6, [\n                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(detailedWorld.value.epochs, (epoch) => {\n                                    return (_openBlock(), _createElementBlock(\"button\", {\n                                        key: epoch.id,\n                                        class: _normalizeClass({ active: activeEpochId.value === epoch.id }),\n                                        onClick: ($event) => (activeEpochId.value = epoch.id)\n                                    }, _toDisplayString(epoch.name), 11 /* TEXT, CLASS, PROPS */, _hoisted_7));\n                                }), 128 /* KEYED_FRAGMENT */))\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_8, [\n                                _createElementVNode(\"p\", null, [\n                                    _cache[6] || (_cache[6] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                    _createTextVNode(\" \" + _toDisplayString(activeEpoch.value.energyLevel), 1 /* TEXT */)\n                                ])\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_9, [\n                                _createElementVNode(\"p\", null, [\n                                    _cache[7] || (_cache[7] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                    _createTextVNode(\" \" + _toDisplayString(activeEpoch.value.timeFlow) + \"x\", 1 /* TEXT */)\n                                ])\n                            ]),\n                            (activeEpoch.value.coreLaws && activeEpoch.value.coreLaws.length > 0)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [\n                                    _cache[8] || (_cache[8] = _createElementVNode(\"p\", null, [\n                                        _createElementVNode(\"strong\", null, \":\")\n                                    ], -1 /* CACHED */)),\n                                    _createElementVNode(\"ul\", null, [\n                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(activeEpoch.value.coreLaws, (law, index) => {\n                                            return (_openBlock(), _createElementBlock(\"li\", { key: index }, _toDisplayString(law), 1 /* TEXT */));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                    ])\n                                ]))\n                                : _createCommentVNode(\"v-if\", true),\n                            _createElementVNode(\"div\", _hoisted_11, [\n                                _createElementVNode(\"p\", null, _toDisplayString(activeEpoch.value.description), 1 /* TEXT */)\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_12, [\n                                (isDetailedWorldActive.value)\n                                    ? (_openBlock(), _createElementBlock(\"button\", {\n                                        key: 0,\n                                        onClick: _cache[0] || (_cache[0] = ($event) => (prepareReincarnation(detailedWorld.value.raw))),\n                                        disabled: !isDetailedWorldActive.value\n                                    }, \"  \", 8 /* PROPS */, _hoisted_13))\n                                    : (_openBlock(), _createElementBlock(\"p\", _hoisted_14, \"\"))\n                            ])\n                        ], 64 /* STABLE_FRAGMENT */))\n                        : _createCommentVNode(\"v-if\", true)\n                ], 2 /* CLASS */),\n                _createElementVNode(\"div\", _hoisted_15, [\n                    _createElementVNode(\"button\", {\n                        onClick: _cache[1] || (_cache[1] = ($event) => (rescanWorlds())),\n                        class: \"rescan-btn\"\n                    }, \"\")\n                ]),\n                _createElementVNode(\"div\", _hoisted_16, [\n                    _createElementVNode(\"button\", {\n                        onClick: _cache[2] || (_cache[2] = ($event) => (adjustSpeed(1))),\n                        title: \"\",\n                        class: \"control-btn\"\n                    }, \"+\"),\n                    _createElementVNode(\"div\", _hoisted_17, [\n                        _cache[9] || (_cache[9] = _createElementVNode(\"div\", { class: \"speed-bar-track\" }, null, -1 /* CACHED */)),\n                        _createElementVNode(\"div\", {\n                            class: \"speed-bar-fill\",\n                            style: _normalizeStyle({ height: `${speedLevel.value * 25}%` })\n                        }, null, 4 /* STYLE */)\n                    ]),\n                    _createElementVNode(\"button\", {\n                        onClick: _cache[3] || (_cache[3] = ($event) => (adjustSpeed(-1))),\n                        title: \"\",\n                        class: \"control-btn\"\n                    }, \"-\")\n                ]),\n                (_unref(isSimulationRunning))\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_18, [...(_cache[10] || (_cache[10] = [\n                            _createElementVNode(\"p\", null, \"...\", -1 /* CACHED */),\n                            _createElementVNode(\"div\", { class: \"spinner\" }, null, -1 /* CACHED */)\n                        ]))]))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./WorldSelection.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./WorldSelection.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./WorldSelection.vue?vue&type=style&index=0&id=c5638424&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-c5638424\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createElementVNode as _createElementVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"reincarnation-panel\" };\nconst _hoisted_2 = { class: \"tabs\" };\nconst _hoisted_3 = [\"disabled\"];\nconst _hoisted_4 = [\"disabled\"];\nconst _hoisted_5 = [\"disabled\"];\nconst _hoisted_6 = { class: \"tab-content\" };\nconst _hoisted_7 = {\n    key: 5,\n    class: \"status-placeholder\"\n};\nimport { computed, ref, watch } from 'vue';\nimport LogPanel from './LogPanel.vue';\nimport RipplesPanel from './RipplesPanel.vue';\nimport AvatarSelection from './reincarnation/AvatarSelection.vue';\nimport SettlementView from './reincarnation/SettlementView.vue';\nimport WorldSelection from './reincarnation/WorldSelection.vue';\nimport { simulatorStatus, simulatorCooldown } from '../../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ReincarnationPanel',\n    setup(__props) {\n        const activeTab = ref('worldSelection');\n        const reincarnationStatus = computed(() => simulatorStatus.value);\n        const cooldown = computed(() => simulatorCooldown.value);\n        const statusText = computed(() => {\n            switch (reincarnationStatus.value) {\n                case 'world-selection':\n                    return '';\n                case 'avatar-selection':\n                    return '';\n                case 'simulating':\n                    return '';\n                case 'settlement':\n                    return '';\n                case 'cooldown':\n                    return `: ${cooldown.value.remainingTime}`;\n                default:\n                    return '';\n            }\n        });\n        watch(reincarnationStatus, newStatus => {\n            if (newStatus === 'world-selection') {\n                activeTab.value = 'worldSelection';\n            }\n            else if (newStatus === 'avatar-selection') {\n                activeTab.value = 'avatarSelection';\n            }\n            else if (newStatus === 'settlement') {\n                activeTab.value = 'settlementView';\n            }\n        }, { immediate: true });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass({ active: activeTab.value === 'worldSelection' }),\n                        onClick: _cache[0] || (_cache[0] = ($event) => (activeTab.value = 'worldSelection')),\n                        disabled: reincarnationStatus.value !== 'world-selection' && reincarnationStatus.value !== 'cooldown'\n                    }, \"  (\" + _toDisplayString(statusText.value) + \") \", 11 /* TEXT, CLASS, PROPS */, _hoisted_3),\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass({ active: activeTab.value === 'avatarSelection' }),\n                        onClick: _cache[1] || (_cache[1] = ($event) => (activeTab.value = 'avatarSelection')),\n                        disabled: reincarnationStatus.value !== 'avatar-selection'\n                    }, \"  \", 10 /* CLASS, PROPS */, _hoisted_4),\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass({ active: activeTab.value === 'settlementView' }),\n                        onClick: _cache[2] || (_cache[2] = ($event) => (activeTab.value = 'settlementView')),\n                        disabled: reincarnationStatus.value !== 'settlement'\n                    }, \"  \", 10 /* CLASS, PROPS */, _hoisted_5),\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass({ active: activeTab.value === 'log' }),\n                        onClick: _cache[3] || (_cache[3] = ($event) => (activeTab.value = 'log'))\n                    }, \"\", 2 /* CLASS */),\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass({ active: activeTab.value === 'ripples' }),\n                        onClick: _cache[4] || (_cache[4] = ($event) => (activeTab.value = 'ripples'))\n                    }, \"\", 2 /* CLASS */)\n                ]),\n                _createElementVNode(\"div\", _hoisted_6, [\n                    (activeTab.value === 'worldSelection')\n                        ? (_openBlock(), _createBlock(WorldSelection, { key: 0 }))\n                        : _createCommentVNode(\"v-if\", true),\n                    (activeTab.value === 'avatarSelection')\n                        ? (_openBlock(), _createBlock(AvatarSelection, { key: 1 }))\n                        : _createCommentVNode(\"v-if\", true),\n                    (activeTab.value === 'settlementView')\n                        ? (_openBlock(), _createBlock(SettlementView, { key: 2 }))\n                        : _createCommentVNode(\"v-if\", true),\n                    (activeTab.value === 'log')\n                        ? (_openBlock(), _createBlock(LogPanel, { key: 3 }))\n                        : _createCommentVNode(\"v-if\", true),\n                    (activeTab.value === 'ripples')\n                        ? (_openBlock(), _createBlock(RipplesPanel, { key: 4 }))\n                        : _createCommentVNode(\"v-if\", true),\n                    (reincarnationStatus.value === 'simulating')\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, \"...\"))\n                        : _createCommentVNode(\"v-if\", true)\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ReincarnationPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ReincarnationPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ReincarnationPanel.vue?vue&type=style&index=0&id=2c57bd16&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-2c57bd16\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode } from \"vue\";\nconst _hoisted_1 = { class: \"ripple-detail-panel\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"ripple-content\"\n};\nconst _hoisted_3 = { class: \"detail-key\" };\nconst _hoisted_4 = { class: \"detail-value\" };\nconst _hoisted_5 = {\n    key: 1,\n    class: \"loading-message\"\n};\nimport { ref, onMounted, toRefs } from 'vue';\nimport { ripplesService } from '../../services/RipplesService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'RippleDetailPanel',\n    props: {\n        rippleId: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const { rippleId } = toRefs(props);\n        const ripple = ref(undefined);\n        onMounted(() => {\n            ripple.value = ripplesService.getRippleById(rippleId.value);\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (ripple.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(ripple.value, (value, key) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: key,\n                                class: \"detail-item\"\n                            }, [\n                                _createElementVNode(\"strong\", _hoisted_3, _toDisplayString(key) + \":\", 1 /* TEXT */),\n                                _createElementVNode(\"span\", _hoisted_4, _toDisplayString(value), 1 /* TEXT */)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_5, \"...\"))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./RippleDetailPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./RippleDetailPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./RippleDetailPanel.vue?vue&type=style&index=0&id=4e32e506&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-4e32e506\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = { class: \"skills-panel\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"empty-state\"\n};\nconst _hoisted_3 = {\n    key: 1,\n    class: \"skills-list\"\n};\nconst _hoisted_4 = { class: \"skill-header\" };\nconst _hoisted_5 = { class: \"skill-level\" };\nconst _hoisted_6 = { class: \"skill-description\" };\nconst _hoisted_7 = { class: \"skill-progress\" };\nconst _hoisted_8 = { class: \"progress-bar-wrapper\" };\nconst _hoisted_9 = [\"value\", \"max\"];\nconst _hoisted_10 = { class: \"progress-text\" };\nconst _hoisted_11 = {\n    key: 0,\n    class: \"associated-skills\"\n};\nconst _hoisted_12 = [\"onClick\"];\nconst _hoisted_13 = {\n    key: 0,\n    class: \"associated-skills-list\"\n};\nconst _hoisted_14 = { class: \"skill-name\" };\nconst _hoisted_15 = { class: \"skill-detail skill-description-detail\" };\nconst _hoisted_16 = { class: \"skill-detail\" };\nconst _hoisted_17 = { class: \"skill-detail\" };\nimport { computed, ref } from 'vue';\nimport { playerSkills } from '../../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'SkillsPanel',\n    setup(__props) {\n        const skills = computed(() => playerSkills.value);\n        const expandedSkills = ref({});\n        const toggleSkills = (skillId) => {\n            expandedSkills.value[skillId] = !expandedSkills.value[skillId];\n        };\n        const isExpanded = (skillId) => {\n            return !!expandedSkills.value[skillId];\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _cache[4] || (_cache[4] = _createElementVNode(\"h2\", null, \"\", -1 /* CACHED */)),\n                (skills.value.length === 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [...(_cache[0] || (_cache[0] = [\n                            _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                        ]))]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(skills.value, (skill) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: skill.id,\n                                class: \"skill-item\"\n                            }, [\n                                _createElementVNode(\"div\", _hoisted_4, [\n                                    _createElementVNode(\"h3\", null, _toDisplayString(skill.name), 1 /* TEXT */),\n                                    _createElementVNode(\"div\", _hoisted_5, \" \" + _toDisplayString(skill.level), 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"p\", _hoisted_6, _toDisplayString(skill.description), 1 /* TEXT */),\n                                _createElementVNode(\"div\", _hoisted_7, [\n                                    _createElementVNode(\"div\", _hoisted_8, [\n                                        _createElementVNode(\"progress\", {\n                                            value: skill.exp,\n                                            max: skill.expToNextLevel === 'MAX' ? skill.exp : skill.expToNextLevel\n                                        }, null, 8 /* PROPS */, _hoisted_9),\n                                        _createElementVNode(\"span\", _hoisted_10, _toDisplayString(skill.exp) + \" / \" + _toDisplayString(skill.expToNextLevel), 1 /* TEXT */)\n                                    ])\n                                ]),\n                                (skill.associatedSkills && skill.associatedSkills.length > 0)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [\n                                        _createElementVNode(\"button\", {\n                                            onClick: ($event) => (toggleSkills(skill.id)),\n                                            class: \"associated-skills-title\"\n                                        }, [\n                                            _cache[1] || (_cache[1] = _createTextVNode(\"  \", -1 /* CACHED */)),\n                                            _createElementVNode(\"span\", {\n                                                class: _normalizeClass(['arrow', { expanded: isExpanded(skill.id) }])\n                                            }, null, 2 /* CLASS */)\n                                        ], 8 /* PROPS */, _hoisted_12),\n                                        (isExpanded(skill.id))\n                                            ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_13, [\n                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(skill.associatedSkills, (activeSkill) => {\n                                                    return (_openBlock(), _createElementBlock(\"li\", {\n                                                        key: activeSkill.ID,\n                                                        class: \"associated-skill-item\"\n                                                    }, [\n                                                        _createElementVNode(\"div\", _hoisted_14, [\n                                                            _createElementVNode(\"strong\", null, _toDisplayString(activeSkill.), 1 /* TEXT */),\n                                                            _createTextVNode(\" (\" + _toDisplayString(activeSkill.) + \") \", 1 /* TEXT */)\n                                                        ]),\n                                                        _createElementVNode(\"div\", _hoisted_15, _toDisplayString(activeSkill.), 1 /* TEXT */),\n                                                        _createElementVNode(\"div\", _hoisted_16, [\n                                                            _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                            _createTextVNode(\" \" + _toDisplayString(activeSkill.), 1 /* TEXT */)\n                                                        ]),\n                                                        _createElementVNode(\"div\", _hoisted_17, [\n                                                            _cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                            _createTextVNode(\" \" + _toDisplayString(activeSkill.), 1 /* TEXT */)\n                                                        ])\n                                                    ]));\n                                                }), 128 /* KEYED_FRAGMENT */))\n                                            ]))\n                                            : _createCommentVNode(\"v-if\", true)\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./SkillsPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SkillsPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./SkillsPanel.vue?vue&type=style&index=0&id=385af6cc&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-385af6cc\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, vModelCheckbox as _vModelCheckbox, withDirectives as _withDirectives, vModelText as _vModelText, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"panel-wrapper memory-panel-container\" };\nconst _hoisted_2 = { class: \"panel-content\" };\nconst _hoisted_3 = { class: \"section\" };\nconst _hoisted_4 = { class: \"setting-item\" };\nconst _hoisted_5 = { class: \"section\" };\nconst _hoisted_6 = { class: \"setting-item\" };\nconst _hoisted_7 = { class: \"setting-item\" };\nconst _hoisted_8 = { class: \"setting-item\" };\nconst _hoisted_9 = { class: \"section\" };\nconst _hoisted_10 = { class: \"tabs\" };\nconst _hoisted_11 = { class: \"memory-content\" };\nconst _hoisted_12 = [\"value\"];\nimport * as toastr from 'toastr';\nimport { computed, onMounted, onUnmounted, ref } from 'vue';\nimport { eventBus } from '../../services/EventBus';\nimport { lorebookService } from '../../services/LorebookService';\nimport { memoryService } from '../../services/MemoryService';\nimport { store } from '../../store';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'MemoryPanel',\n    setup(__props) {\n        const isAutoMemoryEnabled = ref(true); // Default to enabled\n        const config = ref({\n            instantMemoryCount: 3,\n            shortTermMemoryCount: 25,\n            longTermMemoryCount: 200,\n        });\n        const activeTab = ref('instant');\n        const memoryContent = ref({\n            instant: '...',\n            short: '...',\n            long: '...',\n        });\n        const activeMemoryContent = computed(() => {\n            return memoryContent.value[activeTab.value];\n        });\n        async function fetchMemoryContent(forceRefresh = false) {\n            try {\n                const [instant, short, long] = await Promise.all([\n                    lorebookService.readFromLorebook('[]', forceRefresh),\n                    lorebookService.readFromLorebook('[]', forceRefresh),\n                    lorebookService.readFromLorebook('[]', forceRefresh),\n                ]);\n                memoryContent.value.instant = instant || '';\n                memoryContent.value.short = short || '';\n                memoryContent.value.long = long || '';\n            }\n            catch (error) {\n                console.error('[MemoryPanel] Failed to fetch memory content:', error);\n                toastr.error('');\n            }\n        }\n        function updateConfig() {\n            memoryService.setConfig(config.value);\n            toastr.success('');\n        }\n        async function forceUpdate() {\n            toastr.info('...');\n            console.log('[MemoryPanel] Forcing update with worldLog:', JSON.stringify(store.worldLog, null, 2));\n            await memoryService.updateMemory(store.worldLog);\n            await fetchMemoryContent(true); // Force refresh after manual update\n            toastr.success('');\n        }\n        onMounted(() => {\n            config.value = memoryService.getConfig();\n            fetchMemoryContent();\n            // \n            const handleMemoryUpdate = () => {\n                console.log('[MemoryPanel] Received memory-updated event. Refreshing content...');\n                fetchMemoryContent(true);\n            };\n            eventBus.on('memory-updated', handleMemoryUpdate);\n            onUnmounted(() => {\n                eventBus.off('memory-updated', handleMemoryUpdate);\n            });\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[14] || (_cache[14] = _createElementVNode(\"h3\", { class: \"panel-title\" }, \"\", -1 /* CACHED */)),\n                    _createCommentVNode(\" Automation Control \"),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _createElementVNode(\"div\", _hoisted_4, [\n                            _cache[7] || (_cache[7] = _createElementVNode(\"label\", { for: \"auto-memory-switch\" }, \"\", -1 /* CACHED */)),\n                            _withDirectives(_createElementVNode(\"input\", {\n                                type: \"checkbox\",\n                                id: \"auto-memory-switch\",\n                                \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((isAutoMemoryEnabled).value = $event))\n                            }, null, 512 /* NEED_PATCH */), [\n                                [_vModelCheckbox, isAutoMemoryEnabled.value]\n                            ])\n                        ]),\n                        _cache[8] || (_cache[8] = _createElementVNode(\"p\", { class: \"description\" }, \"AI\", -1 /* CACHED */))\n                    ]),\n                    _createCommentVNode(\" Configuration \"),\n                    _createElementVNode(\"div\", _hoisted_5, [\n                        _cache[12] || (_cache[12] = _createElementVNode(\"h4\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"div\", _hoisted_6, [\n                            _cache[9] || (_cache[9] = _createElementVNode(\"label\", { for: \"instant-memory-count\" }, \"\", -1 /* CACHED */)),\n                            _withDirectives(_createElementVNode(\"input\", {\n                                type: \"number\",\n                                id: \"instant-memory-count\",\n                                \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event) => ((config.value.instantMemoryCount) = $event))\n                            }, null, 512 /* NEED_PATCH */), [\n                                [\n                                    _vModelText,\n                                    config.value.instantMemoryCount,\n                                    void 0,\n                                    { number: true }\n                                ]\n                            ])\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_7, [\n                            _cache[10] || (_cache[10] = _createElementVNode(\"label\", { for: \"short-term-count\" }, \"\", -1 /* CACHED */)),\n                            _withDirectives(_createElementVNode(\"input\", {\n                                type: \"number\",\n                                id: \"short-term-count\",\n                                \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event) => ((config.value.shortTermMemoryCount) = $event))\n                            }, null, 512 /* NEED_PATCH */), [\n                                [\n                                    _vModelText,\n                                    config.value.shortTermMemoryCount,\n                                    void 0,\n                                    { number: true }\n                                ]\n                            ])\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_8, [\n                            _cache[11] || (_cache[11] = _createElementVNode(\"label\", { for: \"long-term-count\" }, \"\", -1 /* CACHED */)),\n                            _withDirectives(_createElementVNode(\"input\", {\n                                type: \"number\",\n                                id: \"long-term-count\",\n                                \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event) => ((config.value.longTermMemoryCount) = $event))\n                            }, null, 512 /* NEED_PATCH */), [\n                                [\n                                    _vModelText,\n                                    config.value.longTermMemoryCount,\n                                    void 0,\n                                    { number: true }\n                                ]\n                            ])\n                        ]),\n                        _createElementVNode(\"button\", { onClick: updateConfig }, \"\"),\n                        _createElementVNode(\"button\", { onClick: forceUpdate }, \"\")\n                    ]),\n                    _createCommentVNode(\" Memory Review \"),\n                    _createElementVNode(\"div\", _hoisted_9, [\n                        _cache[13] || (_cache[13] = _createElementVNode(\"h4\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"div\", _hoisted_10, [\n                            _createElementVNode(\"button\", {\n                                class: _normalizeClass({ active: activeTab.value === 'instant' }),\n                                onClick: _cache[4] || (_cache[4] = ($event) => (activeTab.value = 'instant'))\n                            }, \"\", 2 /* CLASS */),\n                            _createElementVNode(\"button\", {\n                                class: _normalizeClass({ active: activeTab.value === 'short' }),\n                                onClick: _cache[5] || (_cache[5] = ($event) => (activeTab.value = 'short'))\n                            }, \"\", 2 /* CLASS */),\n                            _createElementVNode(\"button\", {\n                                class: _normalizeClass({ active: activeTab.value === 'long' }),\n                                onClick: _cache[6] || (_cache[6] = ($event) => (activeTab.value = 'long'))\n                            }, \"\", 2 /* CLASS */)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_11, [\n                            _createElementVNode(\"textarea\", {\n                                readonly: \"\",\n                                value: activeMemoryContent.value\n                            }, null, 8 /* PROPS */, _hoisted_12)\n                        ])\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./MemoryPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MemoryPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MemoryPanel.vue?vue&type=style&index=0&id=c775fcf2&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-c775fcf2\"]])\n\nexport default __exports__","import { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, vModelCheckbox as _vModelCheckbox, withDirectives as _withDirectives, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = { class: \"save-load-panel\" };\nconst _hoisted_2 = { class: \"panel-header\" };\nconst _hoisted_3 = { class: \"header-actions\" };\nconst _hoisted_4 = { class: \"save-slots-container\" };\nconst _hoisted_5 = { class: \"slot-group\" };\nconst _hoisted_6 = { class: \"slot-info\" };\nconst _hoisted_7 = { class: \"slot-name\" };\nconst _hoisted_8 = { class: \"slot-timestamp\" };\nconst _hoisted_9 = {\n    key: 0,\n    class: \"slot-world-log\"\n};\nconst _hoisted_10 = { class: \"log-date\" };\nconst _hoisted_11 = { class: \"log-title\" };\nconst _hoisted_12 = { class: \"slot-actions\" };\nconst _hoisted_13 = [\"onClick\"];\nconst _hoisted_14 = [\"onClick\", \"disabled\"];\nconst _hoisted_15 = [\"onClick\", \"disabled\"];\nconst _hoisted_16 = { class: \"slot-group\" };\nconst _hoisted_17 = { class: \"slot-info\" };\nconst _hoisted_18 = { class: \"slot-name\" };\nconst _hoisted_19 = { class: \"slot-timestamp\" };\nconst _hoisted_20 = {\n    key: 0,\n    class: \"slot-world-log\"\n};\nconst _hoisted_21 = { class: \"log-date\" };\nconst _hoisted_22 = { class: \"log-title\" };\nconst _hoisted_23 = { class: \"slot-actions\" };\nconst _hoisted_24 = [\"onClick\", \"disabled\"];\nconst _hoisted_25 = { class: \"auto-save-toggle\" };\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n    return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n        _createElementVNode(\"div\", _hoisted_2, [\n            _cache[5] || (_cache[5] = _createElementVNode(\"h2\", { class: \"panel-title\" }, \"\", -1 /* CACHED */)),\n            _createElementVNode(\"div\", _hoisted_3, [\n                _createElementVNode(\"button\", {\n                    onClick: _cache[0] || (_cache[0] =\n                        //@ts-ignore\n                        (...args) => (_ctx.importSave && _ctx.importSave(...args))),\n                    class: \"header-btn\"\n                }, \"\"),\n                _createElementVNode(\"button\", {\n                    onClick: _cache[1] || (_cache[1] =\n                        //@ts-ignore\n                        (...args) => (_ctx.exportSave && _ctx.exportSave(...args))),\n                    class: \"header-btn\"\n                }, \"\")\n            ])\n        ]),\n        _createElementVNode(\"div\", _hoisted_4, [\n            _createElementVNode(\"div\", _hoisted_5, [\n                _cache[6] || (_cache[6] = _createElementVNode(\"h3\", { class: \"group-title\" }, \"\", -1 /* CACHED */)),\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.manualSlots, (slot) => {\n                    return (_openBlock(), _createElementBlock(\"div\", {\n                        key: slot.id,\n                        class: \"save-slot\"\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_6, [\n                            _createElementVNode(\"span\", _hoisted_7, _toDisplayString(slot.name), 1 /* TEXT */),\n                            _createElementVNode(\"span\", _hoisted_8, _toDisplayString(slot.timestamp ? _ctx.formatTimestamp(slot.timestamp) : ''), 1 /* TEXT */),\n                            (slot.worldLogDate || slot.worldLogTitle)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [\n                                    _createElementVNode(\"span\", _hoisted_10, _toDisplayString(slot.worldLogDate), 1 /* TEXT */),\n                                    _createElementVNode(\"span\", _hoisted_11, _toDisplayString(slot.worldLogTitle), 1 /* TEXT */)\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_12, [\n                            _createElementVNode(\"button\", {\n                                onClick: ($event) => (_ctx.saveGame(slot.id)),\n                                class: \"action-btn save-btn\"\n                            }, \"\", 8 /* PROPS */, _hoisted_13),\n                            _createElementVNode(\"button\", {\n                                onClick: ($event) => (_ctx.loadGame(slot)),\n                                disabled: !slot.data,\n                                class: \"action-btn load-btn\"\n                            }, \"\", 8 /* PROPS */, _hoisted_14),\n                            _createElementVNode(\"button\", {\n                                onClick: ($event) => (_ctx.deleteSave(slot)),\n                                disabled: !slot.data,\n                                class: \"action-btn delete-btn\"\n                            }, \"\", 8 /* PROPS */, _hoisted_15)\n                        ])\n                    ]));\n                }), 128 /* KEYED_FRAGMENT */))\n            ]),\n            _createElementVNode(\"div\", _hoisted_16, [\n                _cache[7] || (_cache[7] = _createElementVNode(\"h3\", { class: \"group-title\" }, \"\", -1 /* CACHED */)),\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.autoSlots, (slot) => {\n                    return (_openBlock(), _createElementBlock(\"div\", {\n                        key: slot.id,\n                        class: \"save-slot auto-slot\"\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_17, [\n                            _createElementVNode(\"span\", _hoisted_18, _toDisplayString(slot.name), 1 /* TEXT */),\n                            _createElementVNode(\"span\", _hoisted_19, _toDisplayString(slot.timestamp ? _ctx.formatTimestamp(slot.timestamp) : ''), 1 /* TEXT */),\n                            (slot.worldLogDate || slot.worldLogTitle)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_20, [\n                                    _createElementVNode(\"span\", _hoisted_21, _toDisplayString(slot.worldLogDate), 1 /* TEXT */),\n                                    _createElementVNode(\"span\", _hoisted_22, _toDisplayString(slot.worldLogTitle), 1 /* TEXT */)\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_23, [\n                            _createElementVNode(\"button\", {\n                                onClick: ($event) => (_ctx.loadGame(slot)),\n                                disabled: !slot.data,\n                                class: \"action-btn load-btn\"\n                            }, \"\", 8 /* PROPS */, _hoisted_24)\n                        ])\n                    ]));\n                }), 128 /* KEYED_FRAGMENT */))\n            ]),\n            _createElementVNode(\"div\", _hoisted_25, [\n                _createElementVNode(\"label\", null, [\n                    _withDirectives(_createElementVNode(\"input\", {\n                        type: \"checkbox\",\n                        \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event) => ((_ctx.isAutoSaveEnabled) = $event)),\n                        onChange: _cache[3] || (_cache[3] =\n                            //@ts-ignore\n                            (...args) => (_ctx.toggleAutoSave && _ctx.toggleAutoSave(...args)))\n                    }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                        [_vModelCheckbox, _ctx.isAutoSaveEnabled]\n                    ]),\n                    _cache[8] || (_cache[8] = _createTextVNode(\"  \", -1 /* CACHED */))\n                ])\n            ])\n        ]),\n        _createElementVNode(\"input\", {\n            type: \"file\",\n            ref: \"fileInput\",\n            onChange: _cache[4] || (_cache[4] =\n                //@ts-ignore\n                (...args) => (_ctx.handleFileImport && _ctx.handleFileImport(...args))),\n            style: { \"display\": \"none\" },\n            accept: \".json\"\n        }, null, 544 /* NEED_HYDRATION, NEED_PATCH */)\n    ]));\n}\n","import * as toastr from 'toastr';\nimport { lorebookService } from './LorebookService';\nimport { serviceLocator } from './service-locator';\n\nconst LOREBOOK_NAME = '-';\nconst SAVE_SLOT_PREFIX = '-';\nconst MAX_MANUAL_SAVES = 5;\nconst AUTO_SAVE_SLOTS = ['-A', '-B'];\nconst REROLL_SAVE_SLOT_ID = '-';\nconst LOREBOOK_KEYS_TO_BACKUP: string[] = [\n  '',\n  '',\n  '',\n  '',\n  '[]',\n  '[]',\n  '[]',\n  '',\n  '',\n];\n\nexport interface SaveSlot {\n  id: string;\n  name: string;\n  timestamp: string | null;\n  data: any | null;\n  entryUid?: number;\n  worldLogDate?: string | null;\n  worldLogTitle?: string | null;\n}\n\nclass SaveLoadService {\n  public manualSlots: SaveSlot[] = [];\n  public autoSlots: SaveSlot[] = [];\n  public rerollSlot: SaveSlot | null = null;\n  public turnCounter: number = 0;\n  public isAutoSaveEnabled: boolean = true;\n  private autoSaveInterval: any;\n  private areSlotsLoaded = false;\n\n  constructor() {\n    this.initializeSlots();\n    this.loadAutoSaveState();\n    this.loadTurnCounter();\n    // \n  }\n\n  private async ensureSlotsLoaded() {\n    if (!this.areSlotsLoaded) {\n      await this.loadAllSaveSlots();\n      this.areSlotsLoaded = true;\n    }\n  }\n\n  private initializeSlots() {\n    for (let i = 1; i <= MAX_MANUAL_SAVES; i++) {\n      this.manualSlots.push({ id: `-${i}`, name: ` ${i}`, timestamp: null, data: null });\n    }\n    for (const id of AUTO_SAVE_SLOTS) {\n      this.autoSlots.push({ id, name: ` ${id.split('-')[1]}`, timestamp: null, data: null });\n    }\n    this.rerollSlot = { id: REROLL_SAVE_SLOT_ID, name: '', timestamp: null, data: null };\n  }\n\n  async loadAllSaveSlots() {\n    try {\n      const allEntries = await TavernHelper.getLorebookEntries(LOREBOOK_NAME);\n      if (!allEntries) return;\n\n      const updateSlot = (slot: SaveSlot) => {\n        const entry = allEntries.find((e: any) => e.comment === `${SAVE_SLOT_PREFIX}${slot.id}`);\n        if (entry && entry.content) {\n          try {\n            slot.data = JSON.parse(entry.content);\n            slot.timestamp = slot.data.timestamp;\n            slot.worldLogDate = slot.data.worldLogDate;\n            slot.worldLogTitle = slot.data.worldLogTitle;\n            slot.entryUid = entry.uid;\n          } catch (e) {\n            console.error(` ${slot.id} :`, e);\n            slot.timestamp = '';\n            slot.data = null;\n          }\n        } else {\n          slot.timestamp = null;\n          slot.data = null;\n          slot.entryUid = undefined;\n        }\n      };\n\n      this.manualSlots.forEach(updateSlot);\n      this.autoSlots.forEach(updateSlot);\n      if (this.rerollSlot) {\n        updateSlot(this.rerollSlot);\n      }\n    } catch (error) {\n      console.error(':', error);\n      toastr.error('');\n    }\n  }\n\n  async saveGame(slotId: string, isAutoSave = false) {\n    await this.ensureSlotsLoaded(); // \n    if (!isAutoSave) {\n      toastr.info(` [${slotId}]...`);\n    }\n\n    try {\n      const messages = await TavernHelper.getChatMessages('0');\n      if (!messages || messages.length === 0) {\n        throw new Error('');\n      }\n      const messageZero = messages[0];\n      const timestamp = new Date().toISOString();\n\n      const lorebookBackup: { [key: string]: string } = {};\n      for (const key of LOREBOOK_KEYS_TO_BACKUP) {\n        const content = await lorebookService.readFromLorebook(key);\n        lorebookBackup[key] = content ?? '';\n      }\n\n      const store = serviceLocator.get('store');\n      const lastLogEntry = store.worldLog.length > 0 ? store.worldLog[store.worldLog.length - 1] : null;\n\n      const saveData = {\n        timestamp,\n        mvu_data: messageZero.data,\n        message_content: messageZero.message,\n        lorebook_backup: lorebookBackup,\n        worldLogDate: lastLogEntry?.,\n        worldLogTitle: lastLogEntry?.,\n      };\n\n      const comment = `${SAVE_SLOT_PREFIX}${slotId}`;\n      const allEntries = await TavernHelper.getLorebookEntries(LOREBOOK_NAME);\n      const existingEntry = allEntries.find((e: any) => e.comment === comment);\n\n      if (existingEntry) {\n        await TavernHelper.setLorebookEntries(LOREBOOK_NAME, [\n          { uid: existingEntry.uid, content: JSON.stringify(saveData, null, 2) },\n        ]);\n      } else {\n        await TavernHelper.createLorebookEntries(LOREBOOK_NAME, [\n          {\n            comment: comment,\n            content: JSON.stringify(saveData, null, 2),\n            keys: [comment],\n            position: 'after_character_definition',\n            order: 200,\n          },\n        ]);\n      }\n\n      await this.loadAllSaveSlots();\n      if (!isAutoSave) {\n        toastr.success(` [${slotId}]`);\n      } else {\n        console.log(`[AutoSave]  ${slotId}`);\n      }\n    } catch (error) {\n      const errorMessage = `: ${error instanceof Error ? error.message : String(error)}`;\n      console.error(` ${slotId} :`, error);\n      if (!isAutoSave) {\n        toastr.error(errorMessage);\n      }\n    }\n  }\n\n  private async _internalLoadGame(slot: SaveSlot) {\n    if (!slot.data || !slot.data.mvu_data) {\n      throw new Error('');\n    }\n    if (slot.data.lorebook_backup) {\n      for (const key in slot.data.lorebook_backup) {\n        await lorebookService.writeToLorebook(key, slot.data.lorebook_backup[key]);\n      }\n    }\n    const messages = await TavernHelper.getChatMessages('0');\n    const messageZero = messages[0] || {};\n    messageZero.data = slot.data.mvu_data;\n    messageZero.message = slot.data.message_content;\n    await TavernHelper.setChatMessages([messageZero], { refresh: 'all' });\n  }\n\n  async loadGame(slot: SaveSlot) {\n    if (!confirm(` [${slot.name}] `)) {\n      return;\n    }\n    toastr.info(` [${slot.name}] ...`);\n    try {\n      await this._internalLoadGame(slot);\n      toastr.success(` [${slot.name}] ...`);\n    } catch (error) {\n      const errorMessage = `: ${error instanceof Error ? error.message : String(error)}`;\n      console.error(` ${slot.name} :`, error);\n      toastr.error(errorMessage);\n    }\n  }\n\n  async deleteSave(slot: SaveSlot) {\n    if (!slot.entryUid) {\n      toastr.warning('');\n      return;\n    }\n    if (!confirm(` [${slot.name}] \\n`)) {\n      return;\n    }\n    toastr.info(` [${slot.name}]...`);\n    try {\n      await TavernHelper.deleteLorebookEntries(LOREBOOK_NAME, [slot.entryUid]);\n      await this.loadAllSaveSlots();\n      toastr.success(` [${slot.name}] `);\n    } catch (error) {\n      console.error(` ${slot.name} :`, error);\n      toastr.error(`: ${error instanceof Error ? error.message : String(error)}`);\n    }\n  }\n\n  async performAutoSave() {\n    if (!this.isAutoSaveEnabled) return;\n\n    this.turnCounter++;\n    localStorage.setItem('tianhua_turn_counter', this.turnCounter.toString());\n    const slotId = this.turnCounter % 2 === 1 ? AUTO_SAVE_SLOTS[0] : AUTO_SAVE_SLOTS[1];\n    await this.saveGame(slotId, true);\n  }\n\n  async saveStateForReroll() {\n    console.log('[Reroll] Saving state for potential reroll...');\n    await this.saveGame(REROLL_SAVE_SLOT_ID, true);\n  }\n\n  async loadRerollState() {\n    await this.ensureSlotsLoaded(); // \n\n    if (!this.rerollSlot || !this.rerollSlot.data) {\n      toastr.error('');\n      throw new Error('No reroll save state found.');\n    }\n    console.log('[Reroll] Loading state for reroll and setting restore flag...');\n\n    // \n    localStorage.setItem('reincarnation-simulator-restore-input', 'true');\n\n    // \n    await this._internalLoadGame(this.rerollSlot);\n    // \n    setTimeout(() => window.location.reload(), 500);\n  }\n\n  exportSave(slot: SaveSlot) {\n    if (!slot.data) {\n      toastr.warning('');\n      return;\n    }\n    const dataStr = JSON.stringify(slot.data, null, 2);\n    const dataBlob = new Blob([dataStr], { type: 'application/json' });\n    const url = URL.createObjectURL(dataBlob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = `[]-${slot.name}-${new Date().toISOString()}.json`;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    URL.revokeObjectURL(url);\n    toastr.success(` [${slot.name}] `);\n  }\n\n  async importSave(jsonContent: string) {\n    try {\n      const saveData = JSON.parse(jsonContent);\n      if (!saveData.timestamp || !saveData.mvu_data) {\n        throw new Error('');\n      }\n\n      const emptySlot = this.manualSlots.find(slot => !slot.data);\n      if (!emptySlot) {\n        toastr.error('');\n        return;\n      }\n\n      toastr.info(` [${emptySlot.name}]...`);\n\n      const comment = `${SAVE_SLOT_PREFIX}${emptySlot.id}`;\n      const allEntries = await TavernHelper.getLorebookEntries(LOREBOOK_NAME);\n      const existingEntry = allEntries.find((e: any) => e.comment === comment);\n\n      if (existingEntry) {\n        await TavernHelper.setLorebookEntries(LOREBOOK_NAME, [\n          { uid: existingEntry.uid, content: JSON.stringify(saveData, null, 2) },\n        ]);\n      } else {\n        await TavernHelper.createLorebookEntries(LOREBOOK_NAME, [\n          {\n            comment: comment,\n            content: JSON.stringify(saveData, null, 2),\n            keys: [comment],\n            position: 'after_character_definition',\n            order: 200,\n            enabled: false, // \n          },\n        ]);\n      }\n\n      await this.loadAllSaveSlots();\n      toastr.success(` [${emptySlot.name}]`);\n    } catch (error) {\n      const errorMessage = `: ${error instanceof Error ? error.message : String(error)}`;\n      console.error(':', error);\n      toastr.error(errorMessage);\n    }\n  }\n\n  toggleAutoSave(enabled: boolean) {\n    this.isAutoSaveEnabled = enabled;\n    localStorage.setItem('tianhua_auto_save_enabled', JSON.stringify(enabled));\n    toastr.info(`${enabled ? '' : ''}`);\n  }\n\n  private loadAutoSaveState() {\n    const savedState = localStorage.getItem('tianhua_auto_save_enabled');\n    if (savedState !== null) {\n      this.isAutoSaveEnabled = JSON.parse(savedState);\n    }\n  }\n\n  private loadTurnCounter() {\n    const savedCounter = localStorage.getItem('tianhua_turn_counter');\n    if (savedCounter !== null) {\n      this.turnCounter = parseInt(savedCounter, 10) || 0;\n    }\n  }\n}\n\nexport const saveLoadService = new SaveLoadService();\n","import { defineComponent, ref, onMounted } from 'vue';\nimport { saveLoadService } from '../../services/saveLoadService';\nimport * as toastr from 'toastr';\nexport default defineComponent({\n    name: 'SaveLoadPanel',\n    setup() {\n        const manualSlots = ref([]);\n        const autoSlots = ref([]);\n        const isAutoSaveEnabled = ref(true);\n        const fileInput = ref(null);\n        const loadSlots = async () => {\n            await saveLoadService.loadAllSaveSlots();\n            manualSlots.value = [...saveLoadService.manualSlots];\n            autoSlots.value = [...saveLoadService.autoSlots];\n        };\n        onMounted(() => {\n            loadSlots();\n            isAutoSaveEnabled.value = saveLoadService.isAutoSaveEnabled;\n        });\n        const formatTimestamp = (timestamp) => {\n            return new Date(timestamp).toLocaleString('zh-CN', { hour12: false });\n        };\n        const saveGame = async (slotId) => {\n            await saveLoadService.saveGame(slotId);\n            await loadSlots();\n        };\n        const loadGame = async (slot) => {\n            await saveLoadService.loadGame(slot);\n        };\n        const deleteSave = async (slot) => {\n            await saveLoadService.deleteSave(slot);\n            await loadSlots();\n        };\n        const toggleAutoSave = () => {\n            saveLoadService.toggleAutoSave(isAutoSaveEnabled.value);\n        };\n        const importSave = () => {\n            fileInput.value?.click();\n        };\n        const handleFileImport = (event) => {\n            const target = event.target;\n            if (target.files && target.files[0]) {\n                const file = target.files[0];\n                const reader = new FileReader();\n                reader.onload = async (e) => {\n                    try {\n                        const content = e.target?.result;\n                        await saveLoadService.importSave(content);\n                        await loadSlots();\n                    }\n                    catch (error) {\n                        toastr.error('');\n                        console.error(error);\n                    }\n                };\n                reader.readAsText(file);\n                target.value = ''; // Reset input\n            }\n        };\n        const exportSave = async () => {\n            // For simplicity, we'll export the first manual save slot with data\n            const slotToExport = manualSlots.value.find(slot => slot.data);\n            if (!slotToExport) {\n                toastr.warning('');\n                return;\n            }\n            saveLoadService.exportSave(slotToExport);\n        };\n        return {\n            manualSlots,\n            autoSlots,\n            isAutoSaveEnabled,\n            fileInput,\n            formatTimestamp,\n            saveGame,\n            loadGame,\n            deleteSave,\n            toggleAutoSave,\n            importSave,\n            handleFileImport,\n            exportSave,\n        };\n    },\n});\n","/* unplugin-vue-components disabled */import { render } from \"./SaveLoadPanel.vue?vue&type=template&id=1dbb5532&scoped=true&ts=true\"\nimport script from \"./SaveLoadPanel.vue?vue&type=script&lang=ts\"\nexport * from \"./SaveLoadPanel.vue?vue&type=script&lang=ts\"\n\nimport \"./SaveLoadPanel.vue?vue&type=style&index=0&id=1dbb5532&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-1dbb5532\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { normalizeClass as _normalizeClass, createElementVNode as _createElementVNode, vShow as _vShow, createVNode as _createVNode, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"system-panel\" };\nconst _hoisted_2 = { class: \"panel-tabs\" };\nconst _hoisted_3 = { class: \"panel-content\" };\nimport { ref } from 'vue';\nimport MemoryPanel from './MemoryPanel.vue';\nimport SaveLoadPanel from './SaveLoadPanel.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'SystemPanel',\n    setup(__props) {\n        const activeTab = ref('saveLoad');\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass({ active: activeTab.value === 'saveLoad' }),\n                        onClick: _cache[0] || (_cache[0] = ($event) => (activeTab.value = 'saveLoad'))\n                    }, \"\", 2 /* CLASS */),\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass({ active: activeTab.value === 'memory' }),\n                        onClick: _cache[1] || (_cache[1] = ($event) => (activeTab.value = 'memory'))\n                    }, \"\", 2 /* CLASS */)\n                ]),\n                _createElementVNode(\"div\", _hoisted_3, [\n                    _withDirectives(_createVNode(SaveLoadPanel, null, null, 512 /* NEED_PATCH */), [\n                        [_vShow, activeTab.value === 'saveLoad']\n                    ]),\n                    _withDirectives(_createVNode(MemoryPanel, null, null, 512 /* NEED_PATCH */), [\n                        [_vShow, activeTab.value === 'memory']\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./SystemPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SystemPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./SystemPanel.vue?vue&type=style&index=0&id=238307c0&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-238307c0\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n    key: 0,\n    class: \"realm-detail-card\"\n};\nconst _hoisted_2 = { class: \"info-item\" };\nconst _hoisted_3 = { class: \"info-item\" };\nconst _hoisted_4 = { class: \"info-item full-width\" };\nconst _hoisted_5 = { class: \"info-item full-width\" };\nconst _hoisted_6 = { class: \"info-item full-width\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'RealmDetailCard',\n    props: {\n        realm: {\n            type: Object,\n            required: true,\n        },\n    },\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (__props.realm)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                    _createElementVNode(\"div\", _hoisted_2, [\n                        _cache[0] || (_cache[0] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.realm.), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _cache[1] || (_cache[1] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.realm.), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_4, [\n                        _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.realm.), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_5, [\n                        _cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.realm.?. && __props.realm.?. !== '' ? `${__props.realm..} - ${__props.realm..}` : ''), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_6, [\n                        _cache[4] || (_cache[4] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"ul\", null, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.realm., (req, key) => {\n                                return (_openBlock(), _createElementBlock(\"li\", { key: key }, _toDisplayString(req.), 1 /* TEXT */));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ])\n                    ])\n                ]))\n                : _createCommentVNode(\"v-if\", true);\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./RealmDetailCard.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./RealmDetailCard.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./RealmDetailCard.vue?vue&type=style&index=0&id=58d5ab2b&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-58d5ab2b\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment } from \"vue\";\nconst _hoisted_1 = {\n    key: 0,\n    class: \"panel-wrapper world-detail-panel-content\"\n};\nconst _hoisted_2 = { class: \"scroll-container\" };\nconst _hoisted_3 = { class: \"world-section\" };\nconst _hoisted_4 = { class: \"rules-grid\" };\nconst _hoisted_5 = { class: \"rule-item\" };\nconst _hoisted_6 = { class: \"rule-value\" };\nconst _hoisted_7 = { class: \"rule-item\" };\nconst _hoisted_8 = { class: \"rule-value\" };\nconst _hoisted_9 = { class: \"world-section epoch-selection\" };\nconst _hoisted_10 = { class: \"tabs-container main-tabs\" };\nconst _hoisted_11 = [\"innerHTML\"];\nconst _hoisted_12 = { class: \"world-section\" };\nconst _hoisted_13 = { class: \"epoch-header\" };\nconst _hoisted_14 = { class: \"section-title\" };\nconst _hoisted_15 = { class: \"epoch-overview\" };\nconst _hoisted_16 = { class: \"rules-grid\" };\nconst _hoisted_17 = { class: \"rule-item\" };\nconst _hoisted_18 = { class: \"rule-value\" };\nconst _hoisted_19 = { class: \"rule-item\" };\nconst _hoisted_20 = { class: \"rule-value\" };\nconst _hoisted_21 = { class: \"rule-item\" };\nconst _hoisted_22 = { class: \"rule-value\" };\nconst _hoisted_23 = { class: \"rule-item\" };\nconst _hoisted_24 = { class: \"rule-value\" };\nconst _hoisted_25 = { class: \"world-section\" };\nconst _hoisted_26 = { class: \"system-overview\" };\nconst _hoisted_27 = { class: \"subsection\" };\nconst _hoisted_28 = { class: \"ladder-container\" };\nconst _hoisted_29 = { class: \"-ladder\" };\nconst _hoisted_30 = [\"onClick\"];\nconst _hoisted_31 = { class: \"level-energy\" };\nconst _hoisted_32 = { class: \"level-name\" };\nconst _hoisted_33 = {\n    key: 1,\n    class: \"panel-wrapper loading-state\"\n};\nimport { computed, onMounted, ref, watch } from 'vue';\nimport { detailModalService } from '../../services/DetailModalService';\nimport { lorebookService } from '../../services/LorebookService';\nimport { avatarWorld, mainWorld } from '../../store/getters';\nimport RealmDetailCard from '../common/RealmDetailCard.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'WorldDetailsPanel',\n    props: {\n        worldType: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const activeTab = ref('details');\n        const worldSummary = ref('...');\n        const world = computed(() => {\n            return props.worldType === 'mainWorld' ? mainWorld.value : avatarWorld.value;\n        });\n        const availableEpochs = computed(() => {\n            if (!world.value || !world.value..)\n                return [];\n            return Object.values(world.value..).filter(epoch => typeof epoch === 'object' && epoch.ID);\n        });\n        const selectedEpochId = ref(null);\n        onMounted(async () => {\n            const entry = await lorebookService.readFromLorebook('[]');\n            if (entry) {\n                // HTML\n                worldSummary.value = entry\n                    .split('\\n\\n---\\n\\n')\n                    .map(block => `<p>${block.replace(/\\n/g, '<br>')}</p>`)\n                    .join('');\n            }\n            else {\n                worldSummary.value = '';\n            }\n        });\n        watch(world, newWorld => {\n            if (newWorld) {\n                selectedEpochId.value = newWorld...ID || availableEpochs.value[0]?.ID || null;\n            }\n        }, { immediate: true });\n        const activeEpoch = computed(() => {\n            if (!world.value || !selectedEpochId.value)\n                return null;\n            return world.value..[selectedEpochId.value] || null;\n        });\n        const Array = computed(() => {\n            if (!activeEpoch.value?.?.)\n                return [];\n            const definitions = activeEpoch.value..;\n            return Object.keys(definitions)\n                .filter(key => key !== '$meta')\n                .map(key => definitions[key])\n                .sort((a, b) => a. - b.);\n        });\n        const showRealmDetails = (realm) => {\n            if (!realm)\n                return;\n            detailModalService.show(realm., RealmDetailCard, { realm });\n        };\n        return (_ctx, _cache) => {\n            return (world.value && activeEpoch.value)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                    _createElementVNode(\"div\", _hoisted_2, [\n                        _createCommentVNode(\"  \"),\n                        _createElementVNode(\"section\", _hoisted_3, [\n                            _cache[4] || (_cache[4] = _createElementVNode(\"h3\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"div\", _hoisted_4, [\n                                _createElementVNode(\"div\", _hoisted_5, [\n                                    _cache[2] || (_cache[2] = _createElementVNode(\"div\", { class: \"rule-name\" }, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"div\", _hoisted_6, _toDisplayString(world.value...), 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_7, [\n                                    _cache[3] || (_cache[3] = _createElementVNode(\"div\", { class: \"rule-name\" }, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"div\", _hoisted_8, _toDisplayString(world.value...), 1 /* TEXT */)\n                                ])\n                            ])\n                        ]),\n                        _createCommentVNode(\"  \"),\n                        _createElementVNode(\"section\", _hoisted_9, [\n                            _cache[5] || (_cache[5] = _createElementVNode(\"h3\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"div\", _hoisted_10, [\n                                _createElementVNode(\"button\", {\n                                    class: _normalizeClass([\"epoch-tab\", { active: activeTab.value === 'details' }]),\n                                    onClick: _cache[0] || (_cache[0] = ($event) => (activeTab.value = 'details'))\n                                }, \"  \", 2 /* CLASS */),\n                                _createElementVNode(\"button\", {\n                                    class: _normalizeClass([\"epoch-tab\", { active: activeTab.value === 'summary' }]),\n                                    onClick: _cache[1] || (_cache[1] = ($event) => (activeTab.value = 'summary'))\n                                }, \"  \", 2 /* CLASS */)\n                            ])\n                        ]),\n                        (activeTab.value === 'summary')\n                            ? (_openBlock(), _createElementBlock(\"div\", {\n                                key: 0,\n                                class: \"summary-content\",\n                                innerHTML: worldSummary.value\n                            }, null, 8 /* PROPS */, _hoisted_11))\n                            : _createCommentVNode(\"v-if\", true),\n                        (activeTab.value === 'details' && activeEpoch.value)\n                            ? (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                                _createCommentVNode(\"  \"),\n                                _createElementVNode(\"section\", _hoisted_12, [\n                                    _createElementVNode(\"div\", _hoisted_13, [\n                                        _createElementVNode(\"h3\", _hoisted_14, \": \" + _toDisplayString(activeEpoch.value.), 1 /* TEXT */),\n                                        _createElementVNode(\"p\", _hoisted_15, _toDisplayString(activeEpoch.value.), 1 /* TEXT */)\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_16, [\n                                        _createElementVNode(\"div\", _hoisted_17, [\n                                            _cache[6] || (_cache[6] = _createElementVNode(\"div\", { class: \"rule-name\" }, \"\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_18, _toDisplayString(activeEpoch.value..), 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_19, [\n                                            _cache[7] || (_cache[7] = _createElementVNode(\"div\", { class: \"rule-name\" }, \"\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_20, _toDisplayString(activeEpoch.value..) + \"x\", 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_21, [\n                                            _cache[8] || (_cache[8] = _createElementVNode(\"div\", { class: \"rule-name\" }, \"\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_22, _toDisplayString(activeEpoch.value..) + \"%\", 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_23, [\n                                            _cache[9] || (_cache[9] = _createElementVNode(\"div\", { class: \"rule-name\" }, \"\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_24, _toDisplayString(activeEpoch.value...), 1 /* TEXT */)\n                                        ])\n                                    ])\n                                ]),\n                                _createCommentVNode(\"  \"),\n                                _createElementVNode(\"section\", _hoisted_25, [\n                                    _cache[11] || (_cache[11] = _createElementVNode(\"h3\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"p\", _hoisted_26, _toDisplayString(activeEpoch.value..), 1 /* TEXT */),\n                                    _createElementVNode(\"div\", _hoisted_27, [\n                                        _cache[10] || (_cache[10] = _createElementVNode(\"h4\", { class: \"subsection-title\" }, \"\", -1 /* CACHED */)),\n                                        _createElementVNode(\"div\", _hoisted_28, [\n                                            _createElementVNode(\"ul\", _hoisted_29, [\n                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(Array.value, (level) => {\n                                                    return (_openBlock(), _createElementBlock(\"li\", {\n                                                        key: level.,\n                                                        class: \"ladder-step\",\n                                                        onClick: ($event) => (showRealmDetails(level))\n                                                    }, [\n                                                        _createElementVNode(\"span\", _hoisted_31, \" \" + _toDisplayString(level.), 1 /* TEXT */),\n                                                        _createElementVNode(\"span\", _hoisted_32, _toDisplayString(level.), 1 /* TEXT */)\n                                                    ], 8 /* PROPS */, _hoisted_30));\n                                                }), 128 /* KEYED_FRAGMENT */))\n                                            ])\n                                        ])\n                                    ])\n                                ])\n                            ], 64 /* STABLE_FRAGMENT */))\n                            : _createCommentVNode(\"v-if\", true)\n                    ])\n                ]))\n                : (_openBlock(), _createElementBlock(\"div\", _hoisted_33, \"...\"));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./WorldDetailsPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./WorldDetailsPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./WorldDetailsPanel.vue?vue&type=style&index=0&id=329f628f&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-329f628f\"]])\n\nexport default __exports__","import * as d3 from 'd3';\n\n/**\n * @file ColorService.ts\n * @description \n */\nclass ColorService {\n  private colorCache: Map<string, string> = new Map();\n  private colorScale = d3.scaleOrdinal(d3.schemeCategory10);\n\n  /**\n   * \n   * @param str - \n   * @returns - \n   */\n  private simpleHash(str: string): number {\n    let hash = 0;\n    for (let i = 0; i < str.length; i++) {\n      const char = str.charCodeAt(i);\n      hash = (hash << 5) - hash + char;\n      hash |= 0; // Convert to 32bit integer\n    }\n    return Math.abs(hash);\n  }\n\n  /**\n   * \n   * @param type - \n   * @returns - \n   */\n  public getColor(type: string): string {\n    if (this.colorCache.has(type)) {\n      return this.colorCache.get(type)!;\n    }\n\n    // \n    // d3.schemeCategory10  10 \n    // \n    const hash = this.simpleHash(type);\n    const color = this.colorScale(String(hash % 10));\n\n    this.colorCache.set(type, color);\n    return color;\n  }\n}\n\nexport const colorService = new ColorService();\n","import * as d3 from 'd3';\nimport type { MapNode, RelativeCoordinate } from '../types';\n\n/**\n * @file CoordinateService.ts\n * @description V7.2 - 2D\n *\n * @:\n * 1.  \"['', 15]\"\n * 2. km, AU, \n * 3.  (x, y)\n */\nclass CoordinateService {\n  private baseAngleMap: Map<string, number>;\n\n  constructor() {\n    //  (Y, X)\n    // SVG/Canvas : X, Y\n    // 0(0) -> \n    // 90(PI/2) -> \n    // 180(PI) -> \n    // 270(-PI/2) -> \n    this.baseAngleMap = new Map([\n      ['', 0],\n      ['E', 0],\n      ['', Math.PI / 4],\n      ['SE', Math.PI / 4],\n      ['', Math.PI / 2],\n      ['S', Math.PI / 2],\n      ['', (Math.PI * 3) / 4],\n      ['SW', (Math.PI * 3) / 4],\n      ['', Math.PI],\n      ['W', Math.PI],\n      ['', (Math.PI * 5) / 4],\n      ['NW', (Math.PI * 5) / 4],\n      ['', (Math.PI * 3) / 2],\n      ['N', (Math.PI * 3) / 2],\n      ['', (Math.PI * 7) / 4],\n      ['NE', (Math.PI * 7) / 4],\n      ['', 0],\n      ['C', 0],\n      ['', -Math.PI / 2],\n      ['Up', -Math.PI / 2],\n      ['', Math.PI / 2],\n      ['Down', Math.PI / 2],\n    ]);\n  }\n\n  /**\n   * \n   * @param -  \"['', 15]\"  \"['', -10]\"\n   * @returns \n   */\n  private parseAzimuth(azimuthValue: string | (string | number)[]): number | null {\n    try {\n      let parts: (string | number)[] = [];\n\n      if (Array.isArray(azimuthValue)) {\n        parts = azimuthValue;\n      } else if (typeof azimuthValue === 'string') {\n        const content = azimuthValue.trim().slice(1, -1);\n        const matches = content.match(/'[^']*'|\"[^\"]*\"|[^,\\s]+/g);\n        if (matches) {\n          parts = matches.map(part => part.replace(/['\"]/g, ''));\n        }\n      }\n\n      if (parts.length === 0) {\n        console.warn(`[CoordinateService] :`, azimuthValue);\n        return null;\n      }\n\n      // \n      const baseDirection = String(parts[0])\n        .replace(/[[\\]'\"]/g, '')\n        .trim();\n      //  0\n      const offsetDegrees = parts.length > 1 ? Number(parts[1]) : 0;\n\n      if (isNaN(offsetDegrees)) {\n        console.warn(`[CoordinateService] :`, parts[1]);\n        // \n        const baseAngle = this.baseAngleMap.get(baseDirection);\n        return baseAngle !== undefined ? baseAngle : null;\n      }\n\n      const baseAngle = this.baseAngleMap.get(baseDirection);\n\n      if (baseAngle === undefined) {\n        console.warn(`[CoordinateService] : '${baseDirection}'`);\n        return null;\n      }\n\n      const offsetRadians = (offsetDegrees * Math.PI) / 180;\n      return baseAngle + offsetRadians;\n    } catch (error) {\n      console.error(`[CoordinateService] :`, { value: azimuthValue, error });\n      return null;\n    }\n  }\n\n  /**\n   * \n   * \n   * @param distance -  [100, \"km\"]\n   * @returns \n   */\n  private normalizeDistance(distance: [number | string, string]): number {\n    // \n    const value = Number(distance[0]);\n    const unit = distance[1];\n\n    if (isNaN(value)) {\n      return 0;\n    }\n\n    switch (unit.toLowerCase()) {\n      case 'km':\n        return value;\n      case 'au': // \n        return value * 149597870.7; // km\n      case '':\n        return value * 9460730472580.8; // km\n      default:\n        return value; // km\n    }\n  }\n\n  /**\n   * \n   * @param parentNode -  x, y \n   * @param relativeCoord - \n   * @param scaleFactor - \n   * @returns  { x, y }  null\n   */\n  public getCartesianCoordinates(\n    parentNode: MapNode,\n    relativeCoord: RelativeCoordinate,\n  ): { x: number; y: number } | null {\n    if (parentNode.x === undefined || parentNode.y === undefined || !relativeCoord) {\n      return null;\n    }\n\n    const azimuth = this.parseAzimuth(relativeCoord. as string | [string, number]);\n    if (azimuth === null) {\n      return null;\n    }\n\n    // \n    // \n    let baseDirection = '';\n    if (Array.isArray(relativeCoord.)) {\n      baseDirection = String(relativeCoord.[0]);\n    } else if (typeof relativeCoord. === 'string') {\n      const matches = relativeCoord..match(/'[^']*'|\"[^\"]*\"|[^,\\s]+/g);\n      if (matches && matches.length > 0) {\n        baseDirection = matches[0].replace(/['\"[\\]]/g, '').trim();\n      }\n    }\n\n    if (baseDirection === '' || baseDirection.toUpperCase() === 'C') {\n      return { x: parentNode.x, y: parentNode.y };\n    }\n\n    const theoreticalDistance = this.normalizeDistance(relativeCoord.);\n\n    const childX = parentNode.x + theoreticalDistance * Math.cos(azimuth);\n    const childY = parentNode.y + theoreticalDistance * Math.sin(azimuth);\n\n    return { x: childX, y: childY };\n  }\n  /**\n   * \n   * \n   * @param parent - \n   * @param children - \n   */\n  public calculateRelativePositions(parent: MapNode, children: MapNode[]): void {\n    if (!children || children.length === 0) {\n      return;\n    }\n\n    const allDistances = children\n      .map(child => (child.data. ? this.normalizeDistance(child.data..) : 0))\n      .filter(d => d > 0);\n\n    let distanceScale: d3.ScaleLinear<number, number>;\n    const visualMin = 150;\n    const visualMax = 400;\n\n    if (allDistances.length > 0) {\n      const min = Math.min(...allDistances);\n      const max = Math.max(...allDistances);\n      distanceScale = d3.scaleLinear().domain([min, max]).range([visualMin, visualMax]).clamp(true);\n    } else {\n      // \n      distanceScale = d3.scaleLinear().domain([0, 1]).range([visualMin, visualMin]);\n    }\n\n    children.forEach(child => {\n      const coord = child.data.;\n      if (!coord) {\n        child.x = parent.x;\n        child.y = parent.y;\n        return;\n      }\n\n      const isOverlapping = coord..includes('') && this.normalizeDistance(coord.) === 0;\n      const isVertical = coord..includes('') || coord..includes('');\n\n      if (isOverlapping || isVertical) {\n        child.x = parent.x;\n        child.y = parent.y;\n        if (isVertical) {\n          const azimuth = this.parseAzimuth(coord. as string | [string, number]);\n          if (azimuth !== null) {\n            const visualDistance = distanceScale(this.normalizeDistance(coord.));\n            child.y = (child.y ?? 0) + visualDistance * Math.sin(azimuth);\n          }\n        }\n        return;\n      }\n\n      const azimuth = this.parseAzimuth(coord. as string | [string, number]);\n      if (azimuth === null) {\n        child.x = parent.x;\n        child.y = parent.y;\n        return;\n      }\n\n      const theoreticalDistance = this.normalizeDistance(coord.);\n      const visualDistance = distanceScale(theoreticalDistance);\n\n      child.x = parent.x! + visualDistance * Math.cos(azimuth);\n      child.y = parent.y! + visualDistance * Math.sin(azimuth);\n    });\n  }\n}\n\nexport const coordinateService = new CoordinateService();\n","import type { SpatialEntity, WorldDefinition, Epoch } from '../../../types/world';\nimport type { MapHierarchy, MapNode } from '../types';\n\n/**\n * @file WorldMapDataService.ts\n * @description V8.0 - \n *\n * @:\n * 1.  ``  ``\n * 2.  ``  \"WORLD_ORIGIN\"  (`MapHierarchy`)\n * 3.  (`childCount`)\n * 4. UI\n */\nclass WorldMapDataService {\n  private hierarchyCache: MapHierarchy | null = null;\n\n  /**\n   * \n   * @param worldData -  lorebook \n   * @param epochId - ID\n   * @returns -  \"WORLD_ORIGIN\" \n   */\n  public getMapHierarchy(epoch: Epoch | null): MapHierarchy | null {\n    if (!epoch) return null;\n\n    const cacheKey = epoch.ID;\n    if (this.hierarchyCache && (this.hierarchyCache as any).cacheKey === cacheKey) {\n      return this.hierarchyCache;\n    }\n\n    const spatialEntities = epoch.?.;\n\n    if (!spatialEntities || Object.keys(spatialEntities).length === 0) {\n      console.warn(`WorldMapDataService:  \"${epoch.}\"  \"\" `);\n      return null;\n    }\n\n    const hierarchy = this.buildHierarchy(Object.values(spatialEntities));\n    (hierarchy as any).cacheKey = cacheKey; // Attach cache key\n    this.hierarchyCache = hierarchy;\n    return this.hierarchyCache;\n  }\n\n  /**\n   * \n   */\n  public clearCache(): void {\n    this.hierarchyCache = null;\n  }\n\n  /**\n   * \n   * @param entities - \n   * @returns - \n   */\n  private buildHierarchy(entities: SpatialEntity[]): MapHierarchy {\n    const nodeMap = new Map<string, MapNode>();\n    const rootNodes: MapNode[] = [];\n\n    // 1. \n    entities.forEach(entity => {\n      nodeMap.set(entity.ID, {\n        id: entity.ID,\n        name: entity.,\n        type: entity.,\n        parentId: entity.?.ID,\n        children: [],\n        childCount: 0, // \n        radius: 10,\n        data: entity,\n      });\n    });\n\n    // 2. \n    for (const node of nodeMap.values()) {\n      const parent = node.parentId ? nodeMap.get(node.parentId) : null;\n      if (parent) {\n        parent.children.push(node);\n      } else {\n        //  'WORLD_ORIGIN'\n        rootNodes.push(node);\n      }\n    }\n\n    // 3. \n    for (const node of nodeMap.values()) {\n      node.childCount = node.children.length;\n    }\n\n    // 4. \n    const worldOrigin: MapNode = {\n      id: 'WORLD_ORIGIN',\n      name: '',\n      type: 'Origin',\n      parentId: null,\n      children: rootNodes,\n      childCount: rootNodes.length,\n      radius: 0,\n      data: {} as any,\n    };\n\n    return worldOrigin;\n  }\n}\n\nexport const worldMapDataService = new WorldMapDataService();\n","import { reactive, readonly } from 'vue';\nimport type { WorldDefinition } from '../../../types/world';\nimport type { MapNode } from '../types';\n\ninterface NavigationCrumb {\n  id: string;\n  name: string;\n}\n\ninterface MapState {\n  currentRootId: string;\n  navigationPath: NavigationCrumb[];\n  selectedNode: MapNode | null;\n  isDetailPanelVisible: boolean;\n  worldData: WorldDefinition | null;\n  userLocationId: string | null;\n  avatarLocationId: string | null;\n}\n\nconst state = reactive<MapState>({\n  currentRootId: 'WORLD_ORIGIN',\n  navigationPath: [{ id: 'WORLD_ORIGIN', name: '' }],\n  selectedNode: null,\n  isDetailPanelVisible: false,\n  worldData: null,\n  userLocationId: null,\n  avatarLocationId: null,\n});\n\nconst actions = {\n  /**\n   * \n   * @param node - \n   */\n  navigateToNode(node: MapNode): void {\n    state.currentRootId = node.id;\n    // \n    if (!state.navigationPath.find(crumb => crumb.id === node.id)) {\n      state.navigationPath.push({ id: node.id, name: node.name });\n    }\n  },\n\n  /**\n   * \n   * @param targetId - ID\n   */\n  navigateBack(targetId: string): void {\n    const targetIndex = state.navigationPath.findIndex(crumb => crumb.id === targetId);\n    if (targetIndex > -1) {\n      state.currentRootId = targetId;\n      state.navigationPath.splice(targetIndex + 1);\n    }\n  },\n\n  /**\n   * \n   * @param node - \n   */\n  selectNode(node: MapNode): void {\n    state.selectedNode = node;\n    state.isDetailPanelVisible = true;\n  },\n\n  /**\n   * \n   */\n  hideDetail(): void {\n    state.selectedNode = null;\n    state.isDetailPanelVisible = false;\n  },\n\n  /**\n   * \n   * @param path - \n   */\n  setNavigationPath(path: NavigationCrumb[]): void {\n    state.navigationPath = path;\n  },\n\n  /**\n   * \n   * @param data -  Lorebook \n   */\n  setWorldData(data: WorldDefinition): void {\n    state.worldData = data;\n  },\n\n  /**\n   * ID\n   * @param locations -  user  avatar ID\n   */\n  setPlayerLocations(locations: { user: string | null; avatar: string | null }): void {\n    state.userLocationId = locations.user;\n    state.avatarLocationId = locations.avatar;\n  },\n};\n\nexport const mapState = readonly(state);\nexport const mapActions = actions;\n","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = { class: \"map-navigator\" };\nconst _hoisted_2 = [\"onClick\"];\nconst _hoisted_3 = {\n    key: 0,\n    class: \"separator\"\n};\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'MapNavigator',\n    props: {\n        path: {\n            type: Array,\n            required: true,\n        },\n    },\n    emits: ['navigate'],\n    setup(__props, { emit: __emit }) {\n        const emit = __emit;\n        const onCrumbClick = (nodeId) => {\n            emit('navigate', nodeId);\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.path, (crumb, index) => {\n                    return (_openBlock(), _createElementBlock(\"span\", {\n                        key: crumb.id,\n                        class: \"crumb\",\n                        onClick: ($event) => (onCrumbClick(crumb.id))\n                    }, [\n                        _createTextVNode(_toDisplayString(crumb.name) + \" \", 1 /* TEXT */),\n                        (index < __props.path.length - 1)\n                            ? (_openBlock(), _createElementBlock(\"span\", _hoisted_3, \" > \"))\n                            : _createCommentVNode(\"v-if\", true)\n                    ], 8 /* PROPS */, _hoisted_2));\n                }), 128 /* KEYED_FRAGMENT */))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./MapNavigator.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MapNavigator.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MapNavigator.vue?vue&type=style&index=0&id=41303afe&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-41303afe\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment, normalizeClass as _normalizeClass, createStaticVNode as _createStaticVNode } from \"vue\";\nconst _hoisted_1 = { class: \"panel-header\" };\nconst _hoisted_2 = { class: \"panel-content\" };\nconst _hoisted_3 = { key: 0 };\nconst _hoisted_4 = { class: \"section\" };\nconst _hoisted_5 = { key: 0 };\nconst _hoisted_6 = {\n    key: 0,\n    class: \"section\"\n};\nconst _hoisted_7 = {\n    key: 1,\n    class: \"section\"\n};\nconst _hoisted_8 = { class: \"section-title\" };\nconst _hoisted_9 = { class: \"item-list\" };\nconst _hoisted_10 = [\"onClick\"];\nconst _hoisted_11 = {\n    key: 2,\n    class: \"section\"\n};\nconst _hoisted_12 = { class: \"item-list\" };\nconst _hoisted_13 = {\n    key: 3,\n    class: \"section\"\n};\nconst _hoisted_14 = { class: \"item-list\" };\nconst _hoisted_15 = { key: 1 };\nimport { computed, onMounted, ref } from 'vue';\nimport { mapActions, mapState } from '../store/mapState';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NodeDetailPanel',\n    props: {\n        node: {\n            type: Object,\n            default: null,\n        },\n    },\n    emits: ['close'],\n    setup(__props) {\n        const props = __props;\n        const onNavigate = (node) => {\n            if (node.childCount > 0) {\n                mapActions.navigateToNode(node);\n            }\n        };\n        const children = computed(() => {\n            return props.node?.children || [];\n        });\n        const associatedResources = computed(() => {\n            if (!props.node || !mapState.worldData?.?.) {\n                return [];\n            }\n            const resources = mapState.worldData..;\n            // \n            const resourcesArray = Array.isArray(resources) ? resources : [];\n            return resourcesArray.filter((resource) => resource.ID === props.node?.id);\n        });\n        const associatedFactions = computed(() => {\n            // @TODO: \n            if (!props.node || !mapState.worldData?.?.?.) {\n                return [];\n            }\n            const factionsSource = mapState.worldData...;\n            // \n            const factionsArray = Array.isArray(factionsSource) ? factionsSource : Object.values(factionsSource);\n            // \n            const filtered = factionsArray.filter(faction => {\n                // faction\n                if (!faction || typeof faction !== 'object')\n                    return false;\n                const factionDataString = JSON.stringify(faction);\n                return factionDataString.includes(props.node.name);\n            });\n            return filtered;\n        });\n        const panelRef = ref(null);\n        onMounted(() => {\n            const panel = panelRef.value;\n            if (!panel)\n                return;\n            const header = panel.querySelector('.panel-header');\n            // ---  ---\n            header.addEventListener('mousedown', (e) => {\n                let isDragging = true;\n                const startX = e.clientX;\n                const startY = e.clientY;\n                const startLeft = panel.offsetLeft;\n                const startTop = panel.offsetTop;\n                const onDragMove = (moveEvent) => {\n                    if (!isDragging)\n                        return;\n                    const dx = moveEvent.clientX - startX;\n                    const dy = moveEvent.clientY - startY;\n                    panel.style.left = `${startLeft + dx}px`;\n                    panel.style.top = `${startTop + dy}px`;\n                };\n                const onDragEnd = () => {\n                    isDragging = false;\n                    document.removeEventListener('mousemove', onDragMove);\n                    document.removeEventListener('mouseup', onDragEnd);\n                };\n                document.addEventListener('mousemove', onDragMove);\n                document.addEventListener('mouseup', onDragEnd);\n            });\n            // ---  ---\n            const handles = panel.querySelectorAll('.resize-handle');\n            handles.forEach(handle => {\n                handle.addEventListener('mousedown', (e) => {\n                    e.stopPropagation();\n                    const direction = handle.dataset.direction;\n                    if (!direction)\n                        return;\n                    let isResizing = true;\n                    const startX = e.clientX;\n                    const startY = e.clientY;\n                    const startWidth = panel.offsetWidth;\n                    const startHeight = panel.offsetHeight;\n                    const startLeft = panel.offsetLeft;\n                    const startTop = panel.offsetTop;\n                    const onResizeMove = (moveEvent) => {\n                        if (!isResizing)\n                            return;\n                        const dx = moveEvent.clientX - startX;\n                        const dy = moveEvent.clientY - startY;\n                        if (direction.includes('right')) {\n                            panel.style.width = `${startWidth + dx}px`;\n                        }\n                        if (direction.includes('bottom')) {\n                            panel.style.height = `${startHeight + dy}px`;\n                        }\n                        if (direction.includes('left')) {\n                            panel.style.width = `${startWidth - dx}px`;\n                            panel.style.left = `${startLeft + dx}px`;\n                        }\n                        if (direction.includes('top')) {\n                            panel.style.height = `${startHeight - dy}px`;\n                            panel.style.top = `${startTop + dy}px`;\n                        }\n                    };\n                    const onResizeEnd = () => {\n                        isResizing = false;\n                        document.removeEventListener('mousemove', onResizeMove);\n                        document.removeEventListener('mouseup', onResizeEnd);\n                    };\n                    document.addEventListener('mousemove', onResizeMove);\n                    document.addEventListener('mouseup', onResizeEnd);\n                });\n            });\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n                class: \"node-detail-panel\",\n                ref_key: \"panelRef\",\n                ref: panelRef\n            }, [\n                _createElementVNode(\"div\", _hoisted_1, [\n                    _createElementVNode(\"h3\", null, _toDisplayString(__props.node?.name || ''), 1 /* TEXT */),\n                    _createElementVNode(\"button\", {\n                        class: \"close-btn\",\n                        onClick: _cache[0] || (_cache[0] = ($event) => (_ctx.$emit('close')))\n                    }, \"\")\n                ]),\n                _createElementVNode(\"div\", _hoisted_2, [\n                    (__props.node)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                            _createCommentVNode(\"  \"),\n                            _createElementVNode(\"div\", _hoisted_4, [\n                                _createElementVNode(\"p\", null, [\n                                    _cache[1] || (_cache[1] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                    _createTextVNode(\" \" + _toDisplayString(__props.node.type), 1 /* TEXT */)\n                                ]),\n                                (__props.node.data.)\n                                    ? (_openBlock(), _createElementBlock(\"p\", _hoisted_5, [\n                                        _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                        _createTextVNode(\" \" + _toDisplayString(__props.node.data.[0]) + \" \" + _toDisplayString(__props.node.data.[1]), 1 /* TEXT */)\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ]),\n                            _createCommentVNode(\"  \"),\n                            (__props.node.data.)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [\n                                    _cache[3] || (_cache[3] = _createElementVNode(\"h4\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"pre\", null, _toDisplayString(__props.node.data.), 1 /* TEXT */)\n                                ]))\n                                : _createCommentVNode(\"v-if\", true),\n                            _createCommentVNode(\"  \"),\n                            (children.value.length > 0)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [\n                                    _createElementVNode(\"h4\", _hoisted_8, \" (\" + _toDisplayString(children.value.length) + \")\", 1 /* TEXT */),\n                                    _createElementVNode(\"ul\", _hoisted_9, [\n                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(children.value, (child) => {\n                                            return (_openBlock(), _createElementBlock(\"li\", {\n                                                key: child.id,\n                                                class: \"interactive list-item\",\n                                                onClick: ($event) => (onNavigate(child))\n                                            }, _toDisplayString(child.name) + \" (\" + _toDisplayString(child.type) + \") \", 9 /* TEXT, PROPS */, _hoisted_10));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                    ])\n                                ]))\n                                : _createCommentVNode(\"v-if\", true),\n                            _createCommentVNode(\"  \"),\n                            (associatedResources.value.length > 0)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [\n                                    _cache[4] || (_cache[4] = _createElementVNode(\"h4\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"ul\", _hoisted_12, [\n                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(associatedResources.value, (resource) => {\n                                            return (_openBlock(), _createElementBlock(\"li\", {\n                                                key: resource.ID,\n                                                class: \"list-item\"\n                                            }, [\n                                                _createTextVNode(_toDisplayString(resource.) + \" \", 1 /* TEXT */),\n                                                _createElementVNode(\"span\", {\n                                                    class: _normalizeClass([\"rarity\", `rarity-${resource.}`])\n                                                }, \"[\" + _toDisplayString(resource.) + \"]\", 3 /* TEXT, CLASS */)\n                                            ]));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                    ])\n                                ]))\n                                : _createCommentVNode(\"v-if\", true),\n                            _createCommentVNode(\"  () \"),\n                            (associatedFactions.value.length > 0)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_13, [\n                                    _cache[5] || (_cache[5] = _createElementVNode(\"h4\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"ul\", _hoisted_14, [\n                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(associatedFactions.value, (faction) => {\n                                            return (_openBlock(), _createElementBlock(\"li\", {\n                                                key: faction.ID,\n                                                class: \"list-item\"\n                                            }, _toDisplayString(faction.) + \" (\" + _toDisplayString(faction.) + \") \", 1 /* TEXT */));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                    ])\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_15, [...(_cache[6] || (_cache[6] = [\n                                _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                            ]))]))\n                ]),\n                _cache[7] || (_cache[7] = _createStaticVNode(\"<div class=\\\"resize-handle top\\\" data-direction=\\\"top\\\" data-v-22e5bfcd></div><div class=\\\"resize-handle right\\\" data-direction=\\\"right\\\" data-v-22e5bfcd></div><div class=\\\"resize-handle bottom\\\" data-direction=\\\"bottom\\\" data-v-22e5bfcd></div><div class=\\\"resize-handle left\\\" data-direction=\\\"left\\\" data-v-22e5bfcd></div><div class=\\\"resize-handle top-left\\\" data-direction=\\\"top-left\\\" data-v-22e5bfcd></div><div class=\\\"resize-handle top-right\\\" data-direction=\\\"top-right\\\" data-v-22e5bfcd></div><div class=\\\"resize-handle bottom-left\\\" data-direction=\\\"bottom-left\\\" data-v-22e5bfcd></div><div class=\\\"resize-handle bottom-right\\\" data-direction=\\\"bottom-right\\\" data-v-22e5bfcd></div>\", 8))\n            ], 512 /* NEED_PATCH */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NodeDetailPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NodeDetailPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NodeDetailPanel.vue?vue&type=style&index=0&id=22e5bfcd&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-22e5bfcd\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createVNode as _createVNode, createElementVNode as _createElementVNode, vModelText as _vModelText, withKeys as _withKeys, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, unref as _unref, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = { class: \"world-map-view\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"search-panel\"\n};\nconst _hoisted_3 = {\n    key: 0,\n    class: \"search-results\"\n};\nconst _hoisted_4 = [\"onClick\"];\nimport * as d3 from 'd3';\nimport { computed, nextTick, onActivated, onMounted, onUnmounted, ref, watch } from 'vue';\nimport { lorebookService } from '../../../services/LorebookService';\nimport { store } from '../../../store';\nimport { colorService } from '../services/ColorService';\nimport { coordinateService } from '../services/CoordinateService';\nimport { worldMapDataService } from '../services/WorldMapDataService';\nimport { mapActions, mapState } from '../store/mapState';\nimport MapNavigator from './MapNavigator.vue';\nimport NodeDetailPanel from './NodeDetailPanel.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'AvatarWorldMapView',\n    setup(__props) {\n        const svgRef = ref(null);\n        const fullHierarchy = ref(null);\n        const layoutNodes = ref([]);\n        const layoutLinks = ref([]);\n        const searchText = ref('');\n        const stars = ref([]);\n        const isSearchPanelVisible = ref(false);\n        //  store \n        const navigationPath = computed(() => mapState.navigationPath);\n        const isDetailPanelVisible = computed(() => mapState.isDetailPanelVisible);\n        const selectedNode = computed(() => mapState.selectedNode);\n        const currentRootId = computed(() => mapState.currentRootId);\n        // \n        const findNode = (node, id) => {\n            if (node.id === id)\n                return node;\n            for (const child of node.children) {\n                const found = findNode(child, id);\n                if (found)\n                    return found;\n            }\n            return null;\n        };\n        const currentRootNode = computed(() => {\n            if (!fullHierarchy.value)\n                return null;\n            return findNode(fullHierarchy.value, currentRootId.value);\n        });\n        const allNodes = computed(() => {\n            const nodes = [];\n            function traverse(node) {\n                nodes.push(node);\n                node.children.forEach(traverse);\n            }\n            if (fullHierarchy.value) {\n                traverse(fullHierarchy.value);\n            }\n            return nodes;\n        });\n        const searchResults = computed(() => {\n            if (!searchText.value)\n                return [];\n            return allNodes.value.filter(node => node.name.toLowerCase().includes(searchText.value.toLowerCase())).slice(0, 10); // 10\n        });\n        const getFullPath = (node) => {\n            const path = [];\n            let current = node;\n            while (current && current.id !== 'WORLD_ORIGIN') {\n                path.unshift(current.name);\n                current = allNodes.value.find(n => n.id === current.parentId);\n            }\n            return path.join(' > ');\n        };\n        const jumpToNode = (node) => {\n            const path = [];\n            let current = node;\n            while (current && current.parentId && current.id !== 'WORLD_ORIGIN') {\n                path.unshift(current);\n                current = allNodes.value.find(n => n.id === current.parentId);\n            }\n            if (current) {\n                path.unshift(current);\n            }\n            const newNavPath = path.map(p => ({ id: p.id, name: p.name }));\n            mapActions.setNavigationPath(newNavPath);\n            if (node.parentId) {\n                mapActions.navigateBack(node.parentId);\n            }\n            else {\n                mapActions.navigateBack('WORLD_ORIGIN');\n            }\n            searchText.value = '';\n        };\n        const jumpToFirstResult = () => {\n            if (searchResults.value.length > 0) {\n                jumpToNode(searchResults.value[0]);\n            }\n        };\n        const searchBtnRef = ref(null);\n        const initDraggableSearchBtn = () => {\n            const btn = searchBtnRef.value;\n            if (!btn)\n                return;\n            let isDragging = false;\n            let offsetX = 0, offsetY = 0;\n            const onMouseMove = (e) => {\n                if (!isDragging)\n                    return;\n                const container = btn.parentElement;\n                if (!container)\n                    return;\n                let x = e.clientX - offsetX;\n                let y = e.clientY - offsetY;\n                // \n                const containerRect = container.getBoundingClientRect();\n                x = Math.max(0, Math.min(x, containerRect.width - btn.offsetWidth));\n                y = Math.max(0, Math.min(y, containerRect.height - btn.offsetHeight));\n                btn.style.left = `${x}px`;\n                btn.style.top = `${y}px`;\n            };\n            const onMouseUp = () => {\n                if (!isDragging)\n                    return;\n                isDragging = false;\n                document.removeEventListener('mousemove', onMouseMove);\n                document.removeEventListener('mouseup', onMouseUp);\n                const containerRect = btn.parentElement.getBoundingClientRect();\n                const rect = btn.getBoundingClientRect();\n                const threshold = 50;\n                if (rect.left - containerRect.left < threshold) {\n                    btn.style.left = '10px';\n                }\n                else if (containerRect.right - rect.right < threshold) {\n                    btn.style.left = `${containerRect.width - rect.width - 10}px`;\n                }\n                if (rect.top - containerRect.top < threshold) {\n                    btn.style.top = '10px';\n                }\n                else if (containerRect.bottom - rect.bottom < threshold) {\n                    btn.style.top = `${containerRect.height - rect.height - 10}px`;\n                }\n            };\n            btn.onmousedown = e => {\n                isDragging = true;\n                offsetX = e.clientX - btn.offsetLeft;\n                offsetY = e.clientY - btn.offsetTop;\n                document.addEventListener('mousemove', onMouseMove);\n                document.addEventListener('mouseup', onMouseUp);\n            };\n        };\n        const visibleNodes = computed(() => {\n            return currentRootNode.value ? currentRootNode.value.children : [];\n        });\n        // \n        watch(currentRootNode, newRoot => {\n            if (newRoot && svgRef.value) {\n                // \n                const rootCopy = JSON.parse(JSON.stringify(newRoot));\n                const { width, height } = svgRef.value.getBoundingClientRect();\n                let nodesToRender = [];\n                let links = [];\n                let visualCenterNode = null;\n                if (rootCopy.id === 'WORLD_ORIGIN') {\n                    visualCenterNode = rootCopy.children[0];\n                    if (visualCenterNode) {\n                        visualCenterNode.x = width / 2;\n                        visualCenterNode.y = height / 2;\n                        coordinateService.calculateRelativePositions(visualCenterNode, rootCopy.children);\n                    }\n                    nodesToRender = rootCopy.children;\n                    links = rootCopy.children\n                        .slice(1)\n                        .map((child) => ({ source: visualCenterNode, target: child }));\n                }\n                else {\n                    visualCenterNode = rootCopy;\n                    rootCopy.x = width / 2;\n                    rootCopy.y = height / 2;\n                    coordinateService.calculateRelativePositions(rootCopy, rootCopy.children);\n                    nodesToRender = [rootCopy, ...rootCopy.children];\n                    links = rootCopy.children.map((child) => ({\n                        source: rootCopy,\n                        target: child,\n                    }));\n                }\n                const transform = d3.zoomIdentity;\n                layoutNodes.value = nodesToRender.filter(n => n.id !== 'WORLD_ORIGIN');\n                layoutLinks.value = links;\n                nextTick(() => {\n                    renderD3(layoutNodes.value, layoutLinks.value, transform);\n                });\n            }\n            else {\n                layoutNodes.value = [];\n                layoutLinks.value = [];\n                renderD3([], [], d3.zoomIdentity);\n            }\n        }, { immediate: true });\n        onMounted(async () => {\n            const worldData = (await lorebookService.loadAndParseWorldData(''));\n            if (worldData) {\n                mapActions.setWorldData(worldData);\n                fullHierarchy.value = worldMapDataService.getMapHierarchy(worldData);\n            }\n            // \n            if (store.worldState) {\n                const avatarId = store.worldState.?.?.ID?.[0];\n                const userLocation = store.worldState.?.[store.userId]?.?.[0] || null;\n                const avatarLocation = avatarId && store.worldState.?.[avatarId] ? store.worldState.[avatarId].?.[0] || null : null;\n                mapActions.setPlayerLocations({ user: userLocation, avatar: avatarLocation });\n            }\n            if (svgRef.value) {\n                const { width, height } = svgRef.value.getBoundingClientRect();\n                const starFieldSize = Math.max(width, height) * 4;\n                stars.value = Array.from({ length: 1000 }, (_, i) => ({\n                    id: i,\n                    x: (Math.random() - 0.5) * starFieldSize + width / 2,\n                    y: (Math.random() - 0.5) * starFieldSize + height / 2,\n                    r: Math.random() * 1.2,\n                    o: Math.random() * 0.8 + 0.2,\n                }));\n                const svg = d3.select(svgRef.value);\n                const zoom = d3\n                    .zoom()\n                    .scaleExtent([0.01, 10])\n                    .on('zoom', event => {\n                    d3.select(svgRef.value).select('g.zoom-container').attr('transform', event.transform);\n                });\n                svg.call(zoom).on('dblclick.zoom', null); // \n            }\n            initDraggableSearchBtn();\n            // \n            const handleClickOutside = (event) => {\n                const searchPanel = document.querySelector('.search-panel');\n                if (searchPanel &&\n                    !searchPanel.contains(event.target) &&\n                    !searchBtnRef.value?.contains(event.target)) {\n                    isSearchPanelVisible.value = false;\n                }\n            };\n            document.addEventListener('click', handleClickOutside, true);\n            onUnmounted(() => {\n                document.removeEventListener('click', handleClickOutside, true);\n            });\n        });\n        onActivated(() => {\n            // \n            if (currentRootNode.value?.id === 'WORLD_ORIGIN') {\n                mapActions.setNavigationPath([]);\n            }\n        });\n        function renderD3(nodes, links, transform) {\n            const clickTimers = new Map();\n            if (!svgRef.value)\n                return;\n            const svg = d3.select(svgRef.value);\n            const zoomContainer = svg.selectAll('g.zoom-container').data([null]);\n            const zoomContainerEnter = zoomContainer.enter().append('g').attr('class', 'zoom-container');\n            const g = zoomContainer.merge(zoomContainerEnter);\n            //  (enter)\n            zoomContainerEnter\n                .append('g')\n                .selectAll('circle.star')\n                .data(stars.value)\n                .join('circle')\n                .attr('class', 'star')\n                .attr('cx', d => d.x)\n                .attr('cy', d => d.y)\n                .attr('r', d => d.r)\n                .attr('fill', 'white')\n                .attr('opacity', d => d.o);\n            const zoom = d3\n                .zoom()\n                .scaleExtent([0.01, 10])\n                .on('zoom', event => {\n                g.attr('transform', event.transform);\n            });\n            svg.call(zoom).on('dblclick.zoom', null);\n            svg\n                .transition()\n                .duration(750)\n                .call(zoom.transform, transform);\n            // ---  ---\n            const t = d3.transition().duration(750);\n            // \n            const visualCenterNode = nodes.find(n => n.id === currentRootId.value) || nodes[0];\n            if (visualCenterNode) {\n                const distances = nodes\n                    .filter(n => n.id !== visualCenterNode.id)\n                    .map(n => {\n                    const dx = (n.x ?? 0) - (visualCenterNode.x ?? 0);\n                    const dy = (n.y ?? 0) - (visualCenterNode.y ?? 0);\n                    return Math.sqrt(dx * dx + dy * dy);\n                })\n                    .filter(d => d > 0);\n                g.selectAll('circle.orbit-line')\n                    .data(distances)\n                    .join(enter => enter\n                    .append('circle')\n                    .attr('class', 'orbit-line')\n                    .attr('cx', visualCenterNode.x ?? 0)\n                    .attr('cy', visualCenterNode.y ?? 0)\n                    .attr('r', 0)\n                    .attr('fill', 'none')\n                    .attr('stroke', 'rgba(255, 255, 255, 0.1)')\n                    .call(enter => enter.transition(t).attr('r', d => d)), update => update.call(update => update\n                    .transition(t)\n                    .attr('cx', visualCenterNode.x ?? 0)\n                    .attr('cy', visualCenterNode.y ?? 0)\n                    .attr('r', d => d)), exit => exit.call(exit => exit.transition(t).attr('r', 0).remove()));\n            }\n            // \n            g.selectAll('line.link')\n                .data(links, (d) => `${d.source.id}-${d.target.id}`)\n                .join(enter => enter\n                .append('line')\n                .attr('class', 'link')\n                .attr('stroke', '#999')\n                .attr('stroke-opacity', 0)\n                .attr('x1', d => d.source.x || 0)\n                .attr('y1', d => d.source.y || 0)\n                .attr('x2', d => d.target.x || 0)\n                .attr('y2', d => d.target.y || 0)\n                .call(enter => enter.transition(t).attr('stroke-opacity', 0.4)), update => update.call(update => update\n                .transition(t)\n                .attr('x1', d => d.source.x || 0)\n                .attr('y1', d => d.source.y || 0)\n                .attr('x2', d => d.target.x || 0)\n                .attr('y2', d => d.target.y || 0)), exit => exit.call(exit => exit.transition(t).attr('stroke-opacity', 0).remove()));\n            // \n            const nodeGroups = g.selectAll('g.node-group').data(nodes, d => d.id);\n            const nodeEnter = nodeGroups\n                .enter()\n                .append('g')\n                .attr('class', 'node-group')\n                .attr('transform', (d) => `translate(${d.x || 0},${d.y || 0})`)\n                .attr('opacity', 0);\n            nodeEnter\n                .append('circle')\n                .attr('r', d => d.radius)\n                .attr('fill', d => colorService.getColor(d.type))\n                .attr('stroke', d => d3.color(colorService.getColor(d.type))?.brighter(1.5).toString() ?? '#fff')\n                .attr('stroke-width', 2);\n            nodeEnter\n                .append('text')\n                .text(d => d.name)\n                .attr('text-anchor', 'middle')\n                .attr('dy', d => d.radius + 15)\n                .attr('fill', 'white')\n                .style('font-size', '12px');\n            nodeGroups\n                .merge(nodeEnter)\n                .on('click', function (event, d) {\n                const existingTimeout = clickTimers.get(d.id);\n                if (existingTimeout) {\n                    clearTimeout(existingTimeout);\n                    clickTimers.delete(d.id);\n                    mapActions.selectNode(d);\n                }\n                else {\n                    const newTimeout = window.setTimeout(() => {\n                        if (d.childCount > 0) {\n                            mapActions.navigateToNode(d);\n                        }\n                        else {\n                            mapActions.selectNode(d);\n                        }\n                        clickTimers.delete(d.id);\n                    }, 250);\n                    clickTimers.set(d.id, newTimeout);\n                }\n            })\n                .transition(t)\n                .attr('transform', (d) => `translate(${d.x || 0},${d.y || 0})`)\n                .attr('opacity', 1);\n            nodeGroups.exit().transition(t).attr('opacity', 0).remove();\n        }\n        const onNavigateBack = (nodeId) => {\n            mapActions.navigateBack(nodeId);\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createVNode(MapNavigator, {\n                    path: navigationPath.value,\n                    onNavigate: onNavigateBack\n                }, null, 8 /* PROPS */, [\"path\"]),\n                _createElementVNode(\"button\", {\n                    ref_key: \"searchBtnRef\",\n                    ref: searchBtnRef,\n                    class: \"search-toggle-btn\",\n                    onClick: _cache[0] || (_cache[0] = ($event) => (isSearchPanelVisible.value = !isSearchPanelVisible.value))\n                }, \"  \", 512 /* NEED_PATCH */),\n                (isSearchPanelVisible.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _withDirectives(_createElementVNode(\"input\", {\n                            type: \"text\",\n                            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event) => ((searchText).value = $event)),\n                            placeholder: \"...\",\n                            onKeyup: _withKeys(jumpToFirstResult, [\"enter\"])\n                        }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                            [_vModelText, searchText.value]\n                        ]),\n                        (searchResults.value.length && searchText.value)\n                            ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_3, [\n                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(searchResults.value, (node) => {\n                                    return (_openBlock(), _createElementBlock(\"li\", {\n                                        key: node.id,\n                                        onClick: ($event) => (jumpToNode(node))\n                                    }, _toDisplayString(getFullPath(node)), 9 /* TEXT, PROPS */, _hoisted_4));\n                                }), 128 /* KEYED_FRAGMENT */))\n                            ]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                (_openBlock(), _createElementBlock(\"svg\", {\n                    ref_key: \"svgRef\",\n                    ref: svgRef,\n                    class: \"map-svg\"\n                }, null, 512 /* NEED_PATCH */)),\n                (isDetailPanelVisible.value)\n                    ? (_openBlock(), _createBlock(NodeDetailPanel, {\n                        key: 1,\n                        node: selectedNode.value,\n                        onClose: _unref(mapActions).hideDetail\n                    }, null, 8 /* PROPS */, [\"node\", \"onClose\"]))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./AvatarWorldMapView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AvatarWorldMapView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./AvatarWorldMapView.vue?vue&type=style&index=0&id=8e6ae08a&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createVNode as _createVNode, createElementVNode as _createElementVNode, vModelText as _vModelText, withKeys as _withKeys, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, unref as _unref, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = { class: \"world-map-view\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"search-panel\"\n};\nconst _hoisted_3 = {\n    key: 0,\n    class: \"search-results\"\n};\nconst _hoisted_4 = [\"onClick\"];\nimport * as d3 from 'd3';\nimport { computed, nextTick, onMounted, onUnmounted, ref, watch, onActivated } from 'vue';\nimport { lorebookService } from '../../../services/LorebookService';\nimport { store } from '../../../store';\nimport { coordinateService } from '../services/CoordinateService';\nimport { worldMapDataService } from '../services/WorldMapDataService';\nimport { colorService } from '../services/ColorService';\nimport { mapActions, mapState } from '../store/mapState';\nimport MapNavigator from './MapNavigator.vue';\nimport NodeDetailPanel from './NodeDetailPanel.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'WorldMapView',\n    setup(__props) {\n        const svgRef = ref(null);\n        const fullHierarchy = ref(null);\n        const layoutNodes = ref([]);\n        const layoutLinks = ref([]);\n        const searchText = ref('');\n        const stars = ref([]);\n        const isSearchPanelVisible = ref(false);\n        //  store \n        const navigationPath = computed(() => mapState.navigationPath);\n        const isDetailPanelVisible = computed(() => mapState.isDetailPanelVisible);\n        const selectedNode = computed(() => mapState.selectedNode);\n        const currentRootId = computed(() => mapState.currentRootId);\n        // \n        const findNode = (node, id) => {\n            if (node.id === id)\n                return node;\n            for (const child of node.children) {\n                const found = findNode(child, id);\n                if (found)\n                    return found;\n            }\n            return null;\n        };\n        const currentRootNode = computed(() => {\n            if (!fullHierarchy.value)\n                return null;\n            return findNode(fullHierarchy.value, currentRootId.value);\n        });\n        const allNodes = computed(() => {\n            const nodes = [];\n            function traverse(node) {\n                nodes.push(node);\n                node.children.forEach(traverse);\n            }\n            if (fullHierarchy.value) {\n                traverse(fullHierarchy.value);\n            }\n            return nodes;\n        });\n        const searchResults = computed(() => {\n            if (!searchText.value)\n                return [];\n            return allNodes.value.filter(node => node.name.toLowerCase().includes(searchText.value.toLowerCase())).slice(0, 10); // 10\n        });\n        const getFullPath = (node) => {\n            const path = [];\n            let current = node;\n            while (current && current.id !== 'WORLD_ORIGIN') {\n                path.unshift(current.name);\n                current = allNodes.value.find(n => n.id === current.parentId);\n            }\n            return path.join(' > ');\n        };\n        const jumpToNode = (node) => {\n            const path = [];\n            let current = node;\n            while (current && current.parentId && current.id !== 'WORLD_ORIGIN') {\n                path.unshift(current);\n                current = allNodes.value.find(n => n.id === current.parentId);\n            }\n            if (current) {\n                path.unshift(current);\n            }\n            const newNavPath = path.map(p => ({ id: p.id, name: p.name }));\n            mapActions.setNavigationPath(newNavPath);\n            if (node.parentId) {\n                mapActions.navigateBack(node.parentId);\n            }\n            else {\n                mapActions.navigateBack('WORLD_ORIGIN');\n            }\n            searchText.value = '';\n        };\n        const jumpToFirstResult = () => {\n            if (searchResults.value.length > 0) {\n                jumpToNode(searchResults.value[0]);\n            }\n        };\n        const searchBtnRef = ref(null);\n        const initDraggableSearchBtn = () => {\n            const btn = searchBtnRef.value;\n            if (!btn)\n                return;\n            let isDragging = false;\n            let offsetX = 0, offsetY = 0;\n            const onMouseMove = (e) => {\n                if (!isDragging)\n                    return;\n                const container = btn.parentElement;\n                if (!container)\n                    return;\n                let x = e.clientX - offsetX;\n                let y = e.clientY - offsetY;\n                // \n                const containerRect = container.getBoundingClientRect();\n                x = Math.max(0, Math.min(x, containerRect.width - btn.offsetWidth));\n                y = Math.max(0, Math.min(y, containerRect.height - btn.offsetHeight));\n                btn.style.left = `${x}px`;\n                btn.style.top = `${y}px`;\n            };\n            const onMouseUp = () => {\n                if (!isDragging)\n                    return;\n                isDragging = false;\n                document.removeEventListener('mousemove', onMouseMove);\n                document.removeEventListener('mouseup', onMouseUp);\n                const containerRect = btn.parentElement.getBoundingClientRect();\n                const rect = btn.getBoundingClientRect();\n                const threshold = 50;\n                if (rect.left - containerRect.left < threshold) {\n                    btn.style.left = '10px';\n                }\n                else if (containerRect.right - rect.right < threshold) {\n                    btn.style.left = `${containerRect.width - rect.width - 10}px`;\n                }\n                if (rect.top - containerRect.top < threshold) {\n                    btn.style.top = '10px';\n                }\n                else if (containerRect.bottom - rect.bottom < threshold) {\n                    btn.style.top = `${containerRect.height - rect.height - 10}px`;\n                }\n            };\n            btn.onmousedown = e => {\n                isDragging = true;\n                offsetX = e.clientX - btn.offsetLeft;\n                offsetY = e.clientY - btn.offsetTop;\n                document.addEventListener('mousemove', onMouseMove);\n                document.addEventListener('mouseup', onMouseUp);\n            };\n        };\n        const visibleNodes = computed(() => {\n            return currentRootNode.value ? currentRootNode.value.children : [];\n        });\n        // \n        watch(currentRootNode, newRoot => {\n            if (newRoot && svgRef.value) {\n                // \n                const rootCopy = JSON.parse(JSON.stringify(newRoot));\n                const { width, height } = svgRef.value.getBoundingClientRect();\n                let nodesToRender = [];\n                let links = [];\n                if (rootCopy.id === 'WORLD_ORIGIN') {\n                    const mainNode = rootCopy.children[0];\n                    if (mainNode) {\n                        mainNode.x = width / 2;\n                        mainNode.y = height / 2;\n                        coordinateService.calculateRelativePositions(mainNode, rootCopy.children.slice(1));\n                    }\n                    nodesToRender = rootCopy.children;\n                    links = rootCopy.children\n                        .slice(1)\n                        .map((child) => ({ source: mainNode, target: child }));\n                }\n                else {\n                    rootCopy.x = width / 2;\n                    rootCopy.y = height / 2;\n                    coordinateService.calculateRelativePositions(rootCopy, rootCopy.children);\n                    nodesToRender = [rootCopy, ...rootCopy.children];\n                    links = rootCopy.children.map((child) => ({\n                        source: rootCopy,\n                        target: child,\n                    }));\n                }\n                const transform = d3.zoomIdentity;\n                layoutNodes.value = nodesToRender.filter(n => n.id !== 'WORLD_ORIGIN');\n                layoutLinks.value = links;\n                nextTick(() => {\n                    renderD3(layoutNodes.value, layoutLinks.value, transform);\n                });\n            }\n            else {\n                layoutNodes.value = [];\n                layoutLinks.value = [];\n                renderD3([], [], d3.zoomIdentity);\n            }\n        }, { immediate: true });\n        onMounted(async () => {\n            const worldData = (await lorebookService.loadAndParseWorldData());\n            if (worldData) {\n                mapActions.setWorldData(worldData);\n                fullHierarchy.value = worldMapDataService.getMapHierarchy(worldData);\n            }\n            // \n            if (store.worldState) {\n                const avatarId = store.worldState.?.?.ID?.[0];\n                const userLocation = store.worldState.?.[store.userId]?.?.[0] || null;\n                const avatarLocation = avatarId && store.worldState.?.[avatarId] ? store.worldState.[avatarId].?.[0] || null : null;\n                mapActions.setPlayerLocations({ user: userLocation, avatar: avatarLocation });\n            }\n            if (svgRef.value) {\n                const { width, height } = svgRef.value.getBoundingClientRect();\n                const starFieldSize = Math.max(width, height) * 4;\n                stars.value = Array.from({ length: 1000 }, (_, i) => ({\n                    id: i,\n                    x: (Math.random() - 0.5) * starFieldSize + width / 2,\n                    y: (Math.random() - 0.5) * starFieldSize + height / 2,\n                    r: Math.random() * 1.2,\n                    o: Math.random() * 0.8 + 0.2,\n                }));\n                const svg = d3.select(svgRef.value);\n                const zoom = d3\n                    .zoom()\n                    .scaleExtent([0.01, 10])\n                    .on('zoom', event => {\n                    d3.select(svgRef.value).select('g.zoom-container').attr('transform', event.transform);\n                });\n                svg.call(zoom).on('dblclick.zoom', null); // \n            }\n            initDraggableSearchBtn();\n            // \n            const handleClickOutside = (event) => {\n                const searchPanel = document.querySelector('.search-panel');\n                if (searchPanel &&\n                    !searchPanel.contains(event.target) &&\n                    !searchBtnRef.value?.contains(event.target)) {\n                    isSearchPanelVisible.value = false;\n                }\n            };\n            document.addEventListener('click', handleClickOutside, true);\n            onUnmounted(() => {\n                document.removeEventListener('click', handleClickOutside, true);\n            });\n        });\n        onActivated(() => {\n            // \n            if (currentRootNode.value?.id === 'WORLD_ORIGIN') {\n                mapActions.setNavigationPath([]);\n            }\n        });\n        function renderD3(nodes, links, transform) {\n            const clickTimers = new Map();\n            if (!svgRef.value)\n                return;\n            const svg = d3.select(svgRef.value);\n            const zoomContainer = svg.selectAll('g.zoom-container').data([null]);\n            const zoomContainerEnter = zoomContainer.enter().append('g').attr('class', 'zoom-container');\n            const g = zoomContainer.merge(zoomContainerEnter);\n            //  (enter)\n            zoomContainerEnter\n                .append('g')\n                .selectAll('circle.star')\n                .data(stars.value)\n                .join('circle')\n                .attr('class', 'star')\n                .attr('cx', d => d.x)\n                .attr('cy', d => d.y)\n                .attr('r', d => d.r)\n                .attr('fill', 'white')\n                .attr('opacity', d => d.o);\n            const zoom = d3\n                .zoom()\n                .scaleExtent([0.01, 10])\n                .on('zoom', event => {\n                g.attr('transform', event.transform);\n            });\n            svg.call(zoom).on('dblclick.zoom', null);\n            svg\n                .transition()\n                .duration(750)\n                .call(zoom.transform, transform);\n            // ---  ---\n            const t = d3.transition().duration(750);\n            // \n            const visualCenterNode = nodes.find(n => n.id === currentRootId.value) || nodes[0];\n            if (visualCenterNode) {\n                const distances = nodes\n                    .filter(n => n.id !== visualCenterNode.id)\n                    .map(n => {\n                    const dx = (n.x ?? 0) - (visualCenterNode.x ?? 0);\n                    const dy = (n.y ?? 0) - (visualCenterNode.y ?? 0);\n                    return Math.sqrt(dx * dx + dy * dy);\n                })\n                    .filter(d => d > 0);\n                g.selectAll('circle.orbit-line')\n                    .data(distances)\n                    .join(enter => enter\n                    .append('circle')\n                    .attr('class', 'orbit-line')\n                    .attr('cx', visualCenterNode.x ?? 0)\n                    .attr('cy', visualCenterNode.y ?? 0)\n                    .attr('r', 0)\n                    .attr('fill', 'none')\n                    .attr('stroke', 'rgba(255, 255, 255, 0.1)')\n                    .call(enter => enter.transition(t).attr('r', d => d)), update => update.call(update => update\n                    .transition(t)\n                    .attr('cx', visualCenterNode.x ?? 0)\n                    .attr('cy', visualCenterNode.y ?? 0)\n                    .attr('r', d => d)), exit => exit.call(exit => exit.transition(t).attr('r', 0).remove()));\n            }\n            // \n            g.selectAll('line.link')\n                .data(links, (d) => `${d.source.id}-${d.target.id}`)\n                .join(enter => enter\n                .append('line')\n                .attr('class', 'link')\n                .attr('stroke', '#999')\n                .attr('stroke-opacity', 0)\n                .attr('x1', d => d.source.x || 0)\n                .attr('y1', d => d.source.y || 0)\n                .attr('x2', d => d.target.x || 0)\n                .attr('y2', d => d.target.y || 0)\n                .call(enter => enter.transition(t).attr('stroke-opacity', 0.4)), update => update.call(update => update\n                .transition(t)\n                .attr('x1', d => d.source.x || 0)\n                .attr('y1', d => d.source.y || 0)\n                .attr('x2', d => d.target.x || 0)\n                .attr('y2', d => d.target.y || 0)), exit => exit.call(exit => exit.transition(t).attr('stroke-opacity', 0).remove()));\n            // \n            const nodeGroups = g.selectAll('g.node-group').data(nodes, d => d.id);\n            const nodeEnter = nodeGroups\n                .enter()\n                .append('g')\n                .attr('class', 'node-group')\n                .classed('player-location', d => d.id === mapState.userLocationId)\n                .classed('avatar-location', d => d.id === mapState.avatarLocationId)\n                .attr('transform', (d) => `translate(${d.x || 0},${d.y || 0})`)\n                .attr('opacity', 0);\n            nodeEnter\n                .append('circle')\n                .attr('r', d => d.radius)\n                .attr('fill', d => colorService.getColor(d.type))\n                .attr('stroke', d => d3.color(colorService.getColor(d.type))?.brighter(1.5).toString() ?? '#fff')\n                .attr('stroke-width', 2);\n            nodeEnter\n                .append('text')\n                .text(d => d.name)\n                .attr('text-anchor', 'middle')\n                .attr('dy', d => d.radius + 15)\n                .attr('fill', 'white')\n                .style('font-size', '12px');\n            nodeGroups\n                .merge(nodeEnter)\n                .on('click', function (event, d) {\n                const existingTimeout = clickTimers.get(d.id);\n                if (existingTimeout) {\n                    clearTimeout(existingTimeout);\n                    clickTimers.delete(d.id);\n                    mapActions.selectNode(d);\n                }\n                else {\n                    const newTimeout = window.setTimeout(() => {\n                        if (d.childCount > 0) {\n                            mapActions.navigateToNode(d);\n                        }\n                        else {\n                            mapActions.selectNode(d);\n                        }\n                        clickTimers.delete(d.id);\n                    }, 250);\n                    clickTimers.set(d.id, newTimeout);\n                }\n            })\n                .transition(t)\n                .attr('transform', (d) => `translate(${d.x || 0},${d.y || 0})`)\n                .attr('opacity', 1);\n            nodeGroups.exit().transition(t).attr('opacity', 0).remove();\n        }\n        const onNavigateBack = (nodeId) => {\n            mapActions.navigateBack(nodeId);\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createVNode(MapNavigator, {\n                    path: navigationPath.value,\n                    onNavigate: onNavigateBack\n                }, null, 8 /* PROPS */, [\"path\"]),\n                _createElementVNode(\"button\", {\n                    ref_key: \"searchBtnRef\",\n                    ref: searchBtnRef,\n                    class: \"search-toggle-btn\",\n                    onClick: _cache[0] || (_cache[0] = ($event) => (isSearchPanelVisible.value = !isSearchPanelVisible.value))\n                }, \"  \", 512 /* NEED_PATCH */),\n                (isSearchPanelVisible.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _withDirectives(_createElementVNode(\"input\", {\n                            type: \"text\",\n                            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event) => ((searchText).value = $event)),\n                            placeholder: \"...\",\n                            onKeyup: _withKeys(jumpToFirstResult, [\"enter\"])\n                        }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                            [_vModelText, searchText.value]\n                        ]),\n                        (searchResults.value.length && searchText.value)\n                            ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_3, [\n                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(searchResults.value, (node) => {\n                                    return (_openBlock(), _createElementBlock(\"li\", {\n                                        key: node.id,\n                                        onClick: ($event) => (jumpToNode(node))\n                                    }, _toDisplayString(getFullPath(node)), 9 /* TEXT, PROPS */, _hoisted_4));\n                                }), 128 /* KEYED_FRAGMENT */))\n                            ]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                (_openBlock(), _createElementBlock(\"svg\", {\n                    ref_key: \"svgRef\",\n                    ref: svgRef,\n                    class: \"map-svg\"\n                }, null, 512 /* NEED_PATCH */)),\n                (isDetailPanelVisible.value)\n                    ? (_openBlock(), _createBlock(NodeDetailPanel, {\n                        key: 1,\n                        node: selectedNode.value,\n                        onClose: _unref(mapActions).hideDetail\n                    }, null, 8 /* PROPS */, [\"node\", \"onClose\"]))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","import type { Component } from 'vue';\nimport AvatarCharacterPanel from '../components/panels/avatar/AvatarCharacterPanel.vue';\nimport AvatarInventoryPanel from '../components/panels/avatar/AvatarInventoryPanel.vue';\nimport AvatarTasksPanel from '../components/panels/avatar/AvatarTasksPanel.vue';\nimport CharacterPanel from '../components/panels/CharacterPanel.vue';\nimport ImprintsPanel from '../components/panels/ImprintsPanel.vue';\nimport InventoryPanel from '../components/panels/InventoryPanel.vue';\nimport NpcDirectoryPanel from '../components/panels/NpcDirectoryPanel.vue';\nimport ReincarnationPanel from '../components/panels/ReincarnationPanel.vue';\nimport RippleDetailPanel from '../components/panels/RippleDetailPanel.vue';\nimport SkillsPanel from '../components/panels/SkillsPanel.vue';\nimport SystemPanel from '../components/panels/SystemPanel.vue';\nimport WorldDetailsPanel from '../components/panels/WorldDetailsPanel.vue';\nimport AvatarWorldMapView from '../modules/world-map/components/AvatarWorldMapView.vue';\nimport WorldMapView from '../modules/world-map/components/WorldMapView.vue';\n\nexport interface PanelInfo {\n  component: Component;\n  title: string;\n}\n\ntype PanelRegistry = Record<string, Record<string, PanelInfo>>;\n\nexport const panelRegistry: PanelRegistry = {\n  mainWorld: {\n    character: { component: CharacterPanel, title: '' },\n    inventory: { component: InventoryPanel, title: '' },\n    skills: { component: SkillsPanel, title: '' },\n    imprints: { component: ImprintsPanel, title: '' },\n    worldDetails: { component: WorldDetailsPanel, title: '' },\n    sandbox: { component: WorldMapView, title: '' },\n  },\n  avatarWorld: {\n    character: { component: AvatarCharacterPanel, title: '' },\n    inventory: { component: AvatarInventoryPanel, title: '' },\n    tasks: { component: AvatarTasksPanel, title: '' },\n    worldDetails: { component: WorldDetailsPanel, title: '' },\n    sandbox: { component: AvatarWorldMapView, title: '' },\n  },\n  reincarnation: {\n    main: { component: ReincarnationPanel, title: '' },\n  },\n  allWorlds: {\n    npcDirectory: { component: NpcDirectoryPanel, title: '' },\n  },\n  ripples: {\n    detail: { component: RippleDetailPanel, title: '' },\n  },\n  system: {\n    saveLoad: { component: SystemPanel, title: '' },\n  },\n};\n","import { ComponentContainer, GoldenLayout, LayoutConfig } from 'golden-layout';\nimport { Component, defineComponent, h, render } from 'vue';\nimport MainView from '../MainView.vue';\nimport { panelRegistry } from './panelRegistry';\nimport { eventBus } from './EventBus';\n\nclass DockManagerService {\n  private goldenLayout: GoldenLayout | null = null;\n  private hostElement: HTMLElement | null = null;\n  private componentMap: Map<string, Component> = new Map();\n  public onAction: ((action: string) => void) | null = null;\n  initialize(hostElement: HTMLElement) {\n    if (this.goldenLayout || !hostElement) return;\n\n    this.hostElement = hostElement;\n    this.goldenLayout = new GoldenLayout(this.hostElement);\n\n    // Pre-register all possible panel components\n    this.registerComponent('main-view', MainView);\n    for (const world in panelRegistry) {\n      for (const panel in panelRegistry[world]) {\n        const componentName = `${world}-${panel}`.toLowerCase();\n        const panelInfo = panelRegistry[world][panel];\n        this.registerComponent(componentName, panelInfo.component);\n      }\n    }\n\n    window.addEventListener('resize', () => this.updateLayout());\n\n    // Layout loading is now handled by LayoutService restoring panels\n    // this.loadSavedLayout();\n  }\n\n  public loadLayout(config: LayoutConfig) {\n    if (!this.goldenLayout) return;\n    try {\n      this.goldenLayout.loadLayout(config);\n    } catch (e) {\n      console.error('Failed to load layout:', e);\n      // Attempt to load default as a fallback\n      try {\n        this.goldenLayout.loadLayout(this.getDefaultLayout());\n      } catch (e2) {\n        console.error('Failed to load default layout on fallback:', e2);\n      }\n    }\n  }\n\n  // This method is no longer needed as LayoutService handles restoration logic.\n  // We keep the method stub in case it's called elsewhere, but it does nothing.\n  loadSavedLayout() {\n    if (!this.goldenLayout) return;\n    // Load a minimal default layout, LayoutService will populate it.\n    this.goldenLayout.loadLayout(this.getDefaultLayout());\n  }\n\n  registerComponent(componentName: string, component: Component) {\n    if (this.componentMap.has(componentName)) {\n      return;\n    }\n    this.componentMap.set(componentName, component);\n\n    this.goldenLayout?.registerComponent(componentName, (container: ComponentContainer, componentState: any) => {\n      const vueComponent = defineComponent({\n        setup: () => () => h(component, componentState?.props || {}),\n      });\n      const vnode = h(vueComponent);\n      render(vnode, container.getElement() as HTMLElement);\n\n      // Directly set the title from the component state\n      if ((componentState as any)?.title) {\n        container.setTitle((componentState as any).title);\n      }\n\n      // Add a destroy listener to notify LayoutService\n      (container as any).on('destroy', () => {\n        const panelId = (componentState as any)?.panelId;\n        if (panelId) {\n          eventBus.emit('panelClosed', panelId);\n        }\n      });\n    });\n  }\n\n  openPanel(panelId: string, title: string, componentName: string, props: Record<string, any> = {}) {\n    if (!this.goldenLayout) {\n      console.error('Golden Layout not initialized.');\n      return;\n    }\n\n    const component = this.componentMap.get(componentName);\n    if (!component) {\n      console.error(`Component \"${componentName}\" is not registered.`);\n      return;\n    }\n\n    this.goldenLayout.addComponent(componentName, { title, props, panelId }, panelId);\n  }\n\n  updateLayout() {\n    if (this.goldenLayout && this.hostElement) {\n      this.goldenLayout.updateSize(this.hostElement.clientWidth, this.hostElement.clientHeight);\n    }\n  }\n\n  closeAllPanels() {\n    if (!this.goldenLayout?.rootItem) return;\n\n    // Create a copy of the array to avoid issues while iterating and removing\n    const closableItems = this.goldenLayout.rootItem.contentItems.filter((item: any) => item.isClosable);\n\n    closableItems.forEach((item: any) => {\n      try {\n        item.remove();\n      } catch (e) {\n        console.error('Failed to remove panel item:', item, e);\n      }\n    });\n  }\n\n  destroy() {\n    if (this.goldenLayout) {\n      this.goldenLayout.destroy();\n      this.goldenLayout = null;\n    }\n    this.componentMap.clear();\n    window.removeEventListener('resize', () => {});\n  }\n\n  unpinAllPanels() {\n    if (!this.goldenLayout) return;\n    // \n    this.goldenLayout.loadLayout(this.getDefaultLayout());\n    //  item  isPinned = false\n  }\n\n  private getDefaultLayout(): LayoutConfig {\n    return {\n      root: {\n        type: 'row',\n        content: [\n          {\n            type: 'component',\n            componentType: 'main-view',\n            title: '',\n            isClosable: false,\n          },\n        ],\n      },\n    };\n  }\n\n  public getFullscreenLayout(): LayoutConfig {\n    return {\n      root: {\n        type: 'row',\n        content: [\n          {\n            type: 'component',\n            componentType: 'main-view',\n            title: '',\n            isClosable: false,\n            width: 100,\n          },\n        ],\n      },\n    };\n  }\n}\n\nexport const dockManagerService = new DockManagerService();\n","import { isSimulationRunning } from '../store/getters';\nimport { dockManagerService } from './DockManagerService';\nimport { eventBus } from './EventBus';\nimport { panelRegistry } from './panelRegistry';\n\nexport function usePanelManager() {\n  const openPanel = (world: keyof typeof panelRegistry, panel: string, props: Record<string, any> = {}) => {\n    if (world === 'avatarWorld' && !isSimulationRunning.value) {\n      return;\n    }\n\n    const panelInfo = panelRegistry[world]?.[panel];\n    if (panelInfo) {\n      const panelId = `${world}-${panel}-${props.rippleId || ''}`.toLowerCase();\n      const componentName = `${world}-${panel}`.toLowerCase();\n\n      // Ensure the component is registered before trying to open it\n      dockManagerService.registerComponent(componentName, panelInfo.component);\n\n      const finalProps = { worldType: world, ...props };\n      dockManagerService.openPanel(panelId, panelInfo.title, componentName, finalProps);\n\n      eventBus.emit('panelOpened', { world, panel, props, panelId });\n    }\n  };\n\n  return { openPanel };\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nimport { onMounted, onBeforeUnmount, ref } from 'vue';\nimport { dockManagerService } from '../services/DockManagerService';\nimport { panelRegistry } from '../services/usePanelManager';\nimport MainView from '../MainView.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'DockManager',\n    setup(__props) {\n        const dockHost = ref(null);\n        onMounted(() => {\n            if (dockHost.value) {\n                dockManagerService.initialize(dockHost.value);\n                // Register all components from the panel registry\n                for (const world in panelRegistry) {\n                    for (const panel in panelRegistry[world]) {\n                        const panelInfo = panelRegistry[world][panel];\n                        const componentName = `${world}-${panel}`;\n                        dockManagerService.registerComponent(componentName, panelInfo.component);\n                    }\n                }\n                // Register the main view separately\n                dockManagerService.registerComponent('main-view', MainView);\n                // Load layout (now that all components are registered)\n                dockManagerService.loadSavedLayout();\n            }\n        });\n        onBeforeUnmount(() => {\n            dockManagerService.destroy();\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n                ref_key: \"dockHost\",\n                ref: dockHost,\n                class: \"dock-manager-host\"\n            }, null, 512 /* NEED_PATCH */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./DockManager.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DockManager.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./DockManager.vue?vue&type=style&index=0&id=e1139430&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeStyle as _normalizeStyle, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = { class: \"loading-overlay\" };\nconst _hoisted_2 = { class: \"loading-content\" };\nconst _hoisted_3 = {\n    key: 0,\n    class: \"error-container\"\n};\nconst _hoisted_4 = { class: \"error-message\" };\nconst _hoisted_5 = { key: 1 };\nconst _hoisted_6 = { class: \"tip\" };\nconst _hoisted_7 = { class: \"progress-bar-container\" };\nconst _hoisted_8 = { class: \"progress-text\" };\nimport { onMounted, onUnmounted, ref, watch } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'LoadingIndicator',\n    props: {\n        error: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const tips = [\n            '',\n            '',\n            '',\n            '',\n            'NPC',\n            '',\n            '',\n            '',\n        ];\n        const randomTip = ref('');\n        const progress = ref(0);\n        let progressInterval = null;\n        onMounted(() => {\n            if (!props.error) {\n                startProgress();\n            }\n        });\n        onUnmounted(() => {\n            stopProgress();\n        });\n        watch(() => props.error, newError => {\n            if (newError) {\n                stopProgress();\n            }\n        });\n        function startProgress() {\n            // \n            randomTip.value = tips[Math.floor(Math.random() * tips.length)];\n            // \n            progress.value = 0;\n            progressInterval = window.setInterval(() => {\n                if (progress.value < 99) {\n                    progress.value += 1;\n                }\n                else {\n                    stopProgress();\n                }\n            }, 90000 / 99); // 90 seconds for 99%\n        }\n        function stopProgress() {\n            if (progressInterval) {\n                clearInterval(progressInterval);\n                progressInterval = null;\n            }\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    (__props.error)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                            _cache[0] || (_cache[0] = _createElementVNode(\"h3\", { class: \"error-title\" }, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"p\", _hoisted_4, _toDisplayString(__props.error), 1 /* TEXT */),\n                            _cache[1] || (_cache[1] = _createElementVNode(\"p\", { class: \"error-tip\" }, \"\", -1 /* CACHED */))\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n                            _createElementVNode(\"p\", _hoisted_6, _toDisplayString(randomTip.value), 1 /* TEXT */),\n                            _createElementVNode(\"div\", _hoisted_7, [\n                                _createElementVNode(\"div\", {\n                                    class: \"progress-bar\",\n                                    style: _normalizeStyle({ width: progress.value + '%' })\n                                }, null, 4 /* STYLE */)\n                            ]),\n                            _createElementVNode(\"span\", _hoisted_8, [\n                                _cache[2] || (_cache[2] = _createElementVNode(\"span\", { class: \"highlight\" }, \"\", -1 /* CACHED */)),\n                                _createTextVNode(\"... \" + _toDisplayString(Math.floor(progress.value)) + \"%\", 1 /* TEXT */)\n                            ])\n                        ]))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./LoadingIndicator.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./LoadingIndicator.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./LoadingIndicator.vue?vue&type=style&index=0&id=6ae2bf70&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-6ae2bf70\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode } from \"vue\";\nconst _hoisted_1 = { class: \"npc-list-modal-content\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"npc-list-container\"\n};\nconst _hoisted_3 = { class: \"npc-list\" };\nconst _hoisted_4 = { class: \"npc-header\" };\nconst _hoisted_5 = { class: \"npc-name\" };\nconst _hoisted_6 = { class: \"npc-identity\" };\nconst _hoisted_7 = { class: \"npc-description\" };\nconst _hoisted_8 = {\n    key: 1,\n    class: \"no-npcs\"\n};\nimport { computed } from 'vue';\nimport { npcService } from '../../services/NpcService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcListModal',\n    props: {\n        worldId: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const npcs = computed(() => {\n            return npcService.getNpcsByWorld(props.worldId);\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (npcs.value.length > 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _createElementVNode(\"ul\", _hoisted_3, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(npcs.value, (npc) => {\n                                return (_openBlock(), _createElementBlock(\"li\", {\n                                    key: npc.[0],\n                                    class: \"npc-item\"\n                                }, [\n                                    _createElementVNode(\"div\", _hoisted_4, [\n                                        _createElementVNode(\"span\", _hoisted_5, _toDisplayString(npc.[0]), 1 /* TEXT */),\n                                        _createElementVNode(\"span\", _hoisted_6, _toDisplayString(npc..join(', ')), 1 /* TEXT */)\n                                    ]),\n                                    _createElementVNode(\"p\", _hoisted_7, _toDisplayString(npc.), 1 /* TEXT */)\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ])\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [...(_cache[0] || (_cache[0] = [\n                            _createElementVNode(\"p\", null, \"NPC\", -1 /* CACHED */)\n                        ]))]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcListModal.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcListModal.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcListModal.vue?vue&type=style&index=0&id=ff267540&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-ff267540\"]])\n\nexport default __exports__","const __WEBPACK_NAMESPACE_OBJECT__ = $;","import $ from 'jquery';\nimport screenfull from 'screenfull';\n\nlet originalStyles: { [selector: string]: { [key: string]: string } } = {};\n\n// ---  (Browser Fullscreen) ---\n\nfunction toggleBrowserFullscreen() {\n  if (screenfull.isEnabled) {\n    screenfull.toggle();\n  } else {\n    console.warn('');\n  }\n}\n\nfunction onBrowserFullscreenChange(callback: (isFullscreen: boolean) => void) {\n  if (screenfull.isEnabled) {\n    screenfull.on('change', () => {\n      callback(screenfull.isFullscreen);\n    });\n  }\n}\n\n// ---  (Web Fullscreen) ---\n\nfunction getIframeSelector(): string | null {\n  const iframes = parent.document.getElementsByTagName('iframe');\n  for (let i = 0; i < iframes.length; i++) {\n    if (iframes[i].contentWindow === window) {\n      const iframe = iframes[i];\n      if (iframe.id) {\n        return `#${iframe.id}`;\n      }\n      const src = iframe.getAttribute('src');\n      if (src) {\n        const srcFileName = src.split('/').pop();\n        if (srcFileName) {\n          return `iframe[src*=\"${srcFileName}\"]`;\n        }\n      }\n      return null;\n    }\n  }\n  return null;\n}\n\nfunction enterWebFullscreen() {\n  const iframeSelector = getIframeSelector();\n  if (!iframeSelector) {\n    console.warn(' iframe');\n    return;\n  }\n\n  const elementsToModify: { [key: string]: JQuery.PlainObject } = {\n    [iframeSelector]: {\n      position: 'fixed',\n      top: '0',\n      left: '0',\n      width: '100vw',\n      height: '100vh',\n      zIndex: '99999',\n      border: 'none',\n      borderRadius: '0',\n    },\n    '#top-settings-holder': { display: 'none' },\n    '#form_sheld > :not(#chat)': { display: 'none' },\n    '#top-bar': { display: 'none' },\n    '#chat': { height: '100vh', maxHeight: '100vh' },\n    '#chat_fullscreen_button': { display: 'none' },\n  };\n\n  originalStyles = {};\n  for (const selector in elementsToModify) {\n    const $element = $(selector, parent.document);\n    if ($element.length > 0) {\n      originalStyles[selector] = {};\n      const newStyles = elementsToModify[selector as keyof typeof elementsToModify];\n      for (const prop in newStyles) {\n        originalStyles[selector][prop] = $element.css(prop);\n      }\n      $element.css(newStyles);\n    }\n  }\n  $(parent.document.documentElement).addClass('web-fullscreen-active');\n  $(parent.document.body).addClass('web-fullscreen-active');\n}\n\nfunction exitWebFullscreen() {\n  for (const selector in originalStyles) {\n    const $element = $(selector, parent.document);\n    if ($element.length > 0) {\n      $element.css(originalStyles[selector]);\n    }\n  }\n  originalStyles = {};\n  $(parent.document.documentElement).removeClass('web-fullscreen-active');\n  $(parent.document.body).removeClass('web-fullscreen-active');\n}\n\nexport const fullscreenService = {\n  // \n  enterWeb: enterWebFullscreen,\n  exitWeb: exitWebFullscreen,\n  // \n  toggleBrowser: toggleBrowserFullscreen,\n  onBrowserChange: onBrowserFullscreenChange,\n  get isBrowserFullscreen() {\n    return screenfull.isEnabled && screenfull.isFullscreen;\n  },\n};\n","import { reactive, markRaw } from 'vue';\nimport NpcListModal from '../components/modals/NpcListModal.vue';\n\ninterface NpcModalState {\n  isVisible: boolean;\n  title: string;\n  props: { worldId: string };\n}\n\nconst state = reactive<NpcModalState>({\n  isVisible: false,\n  title: '',\n  props: { worldId: '' },\n});\n\nconst show = (worldId: string) => {\n  state.title = 'NPC ';\n  state.props = { worldId };\n  //  DetailModalService \n  // state.component = markRaw(NpcListModal);\n  state.isVisible = true;\n};\n\nconst hide = () => {\n  state.isVisible = false;\n};\n\nexport const npcModalService = {\n  state,\n  show,\n  hide,\n};\n","import { reactive, readonly } from 'vue';\nimport { confirmationService } from '../services/ConfirmationService';\nimport { detailModalService } from '../services/DetailModalService';\nimport { dockManagerService } from '../services/DockManagerService';\nimport { eventBus } from '../services/EventBus';\nimport { fullscreenService } from '../services/fullscreenService';\nimport { inputModalActions } from '../services/InputModalService';\nimport { npcModalService } from '../services/NpcModalService';\n\n//  UI \ninterface UiState {\n  isWebFullscreen: boolean;\n  isBrowserFullscreen: boolean;\n}\n\n// \nconst state = reactive<UiState>({\n  isWebFullscreen: false,\n  isBrowserFullscreen: false,\n});\n\n// \nfullscreenService.onBrowserChange(isFullscreen => {\n  // Check if we are transitioning from fullscreen to not-fullscreen\n  if (state.isBrowserFullscreen && !isFullscreen) {\n    // Use Tavern's built-in refresh mechanism instead of a hard reload\n    TavernHelper.setChatMessages([], { refresh: 'all' });\n  }\n  state.isBrowserFullscreen = isFullscreen;\n});\n\n//  actions\nconst actions = {\n  /**\n   * \n   */\n  toggleBrowserFullscreen(): void {\n    // \n    dockManagerService.closeAllPanels();\n    confirmationService.hide();\n    detailModalService.hide();\n    npcModalService.hide();\n    inputModalActions.hide();\n\n    fullscreenService.toggleBrowser();\n  },\n\n  /**\n   * \n   */\n  toggleWebFullscreen(): void {\n    const newFullscreenState = !state.isWebFullscreen;\n    state.isWebFullscreen = newFullscreenState;\n\n    if (newFullscreenState) {\n      fullscreenService.enterWeb();\n    } else {\n      fullscreenService.exitWeb();\n    }\n    // Notify the layout service about the change\n    eventBus.emit('fullscreenChanged', newFullscreenState);\n  },\n\n  /**\n   * \n   */\n  unpinAllPanels(): void {\n    dockManagerService.unpinAllPanels();\n  },\n};\n\n//  actions\nexport const uiState = readonly(state);\nexport const uiActions = actions;\n","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"world-time-display\" };\nconst _hoisted_2 = { class: \"world-name\" };\nconst _hoisted_3 = { class: \"time-string\" };\nimport { computed, toRefs } from 'vue';\nimport { timeStr as avatarTimeStr, mainWorldTimeStr } from '../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'WorldTimeDisplay',\n    props: {\n        worldType: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const { worldType } = toRefs(props);\n        const worldName = computed(() => {\n            return worldType.value === 'main' ? '' : '';\n        });\n        const timeString = computed(() => {\n            return worldType.value === 'main' ? mainWorldTimeStr.value : avatarTimeStr.value;\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"span\", _hoisted_2, _toDisplayString(worldName.value), 1 /* TEXT */),\n                _createElementVNode(\"span\", _hoisted_3, _toDisplayString(timeString.value), 1 /* TEXT */)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./WorldTimeDisplay.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./WorldTimeDisplay.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./WorldTimeDisplay.vue?vue&type=style&index=0&id=668f333f&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-668f333f\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createVNode as _createVNode, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, unref as _unref, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"top-status\" };\nconst _hoisted_2 = { class: \"status-left\" };\nconst _hoisted_3 = { class: \"status-center\" };\nconst _hoisted_4 = [\"title\"];\nconst _hoisted_5 = { class: \"status-right\" };\nimport { computed } from 'vue';\nimport { uiState, uiActions } from '../store/ui';\nimport { usePanelManager } from '../services/usePanelManager';\nimport WorldTimeDisplay from './WorldTimeDisplay.vue';\nimport { actions } from '../store';\nimport { inputModalActions, inputModalState } from '../services/InputModalService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'TopStatusBar',\n    setup(__props) {\n        const isBrowserFullscreen = computed(() => uiState.isBrowserFullscreen);\n        const { openPanel } = usePanelManager();\n        const toggleFullscreen = () => {\n            uiActions.toggleBrowserFullscreen();\n            uiActions.toggleWebFullscreen(); // \n        };\n        const openSaveLoadPanel = () => {\n            openPanel('system', 'saveLoad');\n        };\n        const openInputModal = () => {\n            if (inputModalState.isVisible) {\n                inputModalActions.hide();\n            }\n            else {\n                inputModalActions.show();\n            }\n        };\n        const fullscreenTitle = computed(() => {\n            return isBrowserFullscreen.value ? '' : '';\n        });\n        const fullscreenIcon = computed(() => {\n            return isBrowserFullscreen.value ? 'fas fa-compress' : 'fas fa-expand';\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createVNode(WorldTimeDisplay, { \"world-type\": \"main\" })\n                ]),\n                _createElementVNode(\"div\", _hoisted_3, [\n                    _createElementVNode(\"button\", {\n                        onClick: openSaveLoadPanel,\n                        class: \"view-toggle-btn\",\n                        title: \"\"\n                    }, [...(_cache[1] || (_cache[1] = [\n                            _createElementVNode(\"i\", { class: \"fas fa-cog\" }, null, -1 /* CACHED */)\n                        ]))]),\n                    _createElementVNode(\"button\", {\n                        onClick: openInputModal,\n                        class: \"view-toggle-btn\",\n                        title: \"\"\n                    }, [...(_cache[2] || (_cache[2] = [\n                            _createElementVNode(\"i\", { class: \"fas fa-keyboard\" }, null, -1 /* CACHED */)\n                        ]))]),\n                    _createElementVNode(\"button\", {\n                        onClick: toggleFullscreen,\n                        class: \"view-toggle-btn\",\n                        title: fullscreenTitle.value\n                    }, [\n                        _createElementVNode(\"i\", {\n                            class: _normalizeClass(fullscreenIcon.value)\n                        }, null, 2 /* CLASS */)\n                    ], 8 /* PROPS */, _hoisted_4),\n                    _createElementVNode(\"button\", {\n                        onClick: _cache[0] || (_cache[0] =\n                            //@ts-ignore\n                            (...args) => (_unref(actions).rerollLastAction && _unref(actions).rerollLastAction(...args))),\n                        class: \"view-toggle-btn\",\n                        title: \"\"\n                    }, [...(_cache[3] || (_cache[3] = [\n                            _createElementVNode(\"i\", { class: \"fas fa-undo\" }, null, -1 /* CACHED */)\n                        ]))])\n                ]),\n                _createElementVNode(\"div\", _hoisted_5, [\n                    _createVNode(WorldTimeDisplay, { \"world-type\": \"avatar\" })\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./TopStatusBar.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./TopStatusBar.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./TopStatusBar.vue?vue&type=style&index=0&id=466718ea&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-466718ea\"]])\n\nexport default __exports__","import { eventBus } from './EventBus';\n\nconst NORMAL_LAYOUT_KEY = 'reincarnation-simulator-layout-state-v3-normal';\nconst FULLSCREEN_LAYOUT_KEY = 'reincarnation-simulator-layout-state-v3-fullscreen';\n\nexport interface PanelState {\n  world: string;\n  panel: string;\n  props?: Record<string, any>;\n  panelId: string;\n}\n\nclass LayoutService {\n  private activePanels: Map<string, PanelState> = new Map();\n  private fullscreenPanels: Map<string, PanelState> = new Map();\n  private isFullscreen = false;\n\n  constructor() {\n    this.loadAllLayouts();\n    eventBus.on('panelOpened', (state: PanelState) => this.addPanel(state));\n    eventBus.on('panelClosed', (panelId: string) => this.removePanel(panelId));\n    eventBus.on('fullscreenChanged', (isFullscreen: boolean) => this.handleFullscreenChange(isFullscreen));\n  }\n\n  private loadAllLayouts() {\n    try {\n      const normalState = localStorage.getItem(NORMAL_LAYOUT_KEY);\n      if (normalState) this.activePanels = new Map(JSON.parse(normalState));\n\n      const fullscreenState = localStorage.getItem(FULLSCREEN_LAYOUT_KEY);\n      if (fullscreenState) this.fullscreenPanels = new Map(JSON.parse(fullscreenState));\n    } catch (e) {\n      console.error('Failed to load layout states:', e);\n    }\n  }\n\n  private saveLayoutState() {\n    if (this.isFullscreen) {\n      localStorage.setItem(FULLSCREEN_LAYOUT_KEY, JSON.stringify(Array.from(this.fullscreenPanels.entries())));\n    } else {\n      localStorage.setItem(NORMAL_LAYOUT_KEY, JSON.stringify(Array.from(this.activePanels.entries())));\n    }\n  }\n\n  public addPanel(state: PanelState) {\n    const currentMap = this.isFullscreen ? this.fullscreenPanels : this.activePanels;\n    if (!currentMap.has(state.panelId)) {\n      currentMap.set(state.panelId, state);\n      this.saveLayoutState();\n    }\n  }\n\n  public removePanel(panelId: string) {\n    const currentMap = this.isFullscreen ? this.fullscreenPanels : this.activePanels;\n    if (currentMap.has(panelId)) {\n      currentMap.delete(panelId);\n      this.saveLayoutState();\n    }\n  }\n\n  private handleFullscreenChange(isFullscreen: boolean) {\n    this.isFullscreen = isFullscreen;\n    this.restoreLayout();\n  }\n\n  public restoreLayout() {\n    const panelsToRestore = this.isFullscreen ? this.fullscreenPanels : this.activePanels;\n    console.log(`[LayoutService] Broadcasting restore ${this.isFullscreen ? 'fullscreen' : 'normal'} layout event...`);\n    eventBus.emit('restoreLayout', Array.from(panelsToRestore.values()));\n  }\n\n  public setCurrentFullscreenState(isFullscreen: boolean) {\n    this.isFullscreen = isFullscreen;\n  }\n}\n\nexport const layoutService = new LayoutService();\n","import { computed, defineComponent, onMounted, ref } from 'vue';\nimport ActionPanel from './components/common/ActionPanel.vue';\nimport EnhancedInputBox from './components/common/EnhancedInputBox.vue';\nimport InputHistoryPopup from './components/common/InputHistoryPopup.vue';\nimport NotificationContainer from './components/common/NotificationContainer.vue';\nimport SideMenuButton from './components/controls/SideMenuButton.vue';\nimport DockManager from './components/DockManager.vue';\nimport LoadingIndicator from './components/LoadingIndicator.vue';\nimport NpcListModal from './components/modals/NpcListModal.vue';\nimport TopStatusBar from './components/TopStatusBar.vue';\nimport WorldTimeDisplay from './components/WorldTimeDisplay.vue';\nimport { commandService } from './services/CommandService';\nimport { confirmationService } from './services/ConfirmationService';\nimport { detailModalService } from './services/DetailModalService';\nimport { dockManagerService } from './services/DockManagerService';\nimport { eventBus } from './services/EventBus';\nimport { inputModalActions, inputModalState } from './services/InputModalService';\nimport { layoutService } from './services/LayoutService';\nimport { npcModalService } from './services/NpcModalService';\nimport { saveLoadService } from './services/saveLoadService';\nimport { usePanelManager } from './services/usePanelManager';\nimport { actions, store } from './store';\nimport { isSimulationRunning } from './store/getters';\nimport { uiState } from './store/ui';\nexport default defineComponent({\n    name: 'App',\n    components: {\n        DockManager,\n        EnhancedInputBox,\n        LoadingIndicator,\n        NpcListModal,\n        TopStatusBar,\n        WorldTimeDisplay,\n        SideMenuButton,\n        NotificationContainer,\n        ActionPanel,\n        InputHistoryPopup,\n    },\n    setup() {\n        const { openPanel } = usePanelManager();\n        const confirmation = computed(() => confirmationService.state);\n        const detailModal = computed(() => detailModalService.state);\n        const npcModal = computed(() => npcModalService.state);\n        const isWebFullscreen = computed(() => uiState.isWebFullscreen);\n        const inputModal = computed(() => inputModalState);\n        const isActionPanelVisible = ref(false);\n        const isHistoryVisible = ref(false);\n        const isQueueVisible = ref(false);\n        const commands = ref([]);\n        const commandCount = computed(() => commands.value.length);\n        const menuOptions = {\n            main: [\n                { id: 'character', icon: '', text: '', action: () => openPanel('mainWorld', 'character') },\n                { id: 'inventory', icon: '', text: '', action: () => openPanel('mainWorld', 'inventory') },\n                { id: 'skills', icon: '', text: '', action: () => openPanel('mainWorld', 'skills') },\n                { id: 'worldDetails', icon: '', text: '', action: () => openPanel('mainWorld', 'worldDetails') },\n                { id: 'sandbox', icon: '', text: '', action: () => openPanel('mainWorld', 'sandbox') },\n            ],\n            avatar: [\n                {\n                    id: 'avatar-character',\n                    icon: '',\n                    text: '',\n                    action: () => openPanel('avatarWorld', 'character'),\n                    disabled: () => !isSimulationRunning.value,\n                },\n                {\n                    id: 'avatar-inventory',\n                    icon: '',\n                    text: '',\n                    action: () => openPanel('avatarWorld', 'inventory'),\n                    disabled: () => !isSimulationRunning.value,\n                },\n                {\n                    id: 'avatar-tasks',\n                    icon: '',\n                    text: '',\n                    action: () => openPanel('avatarWorld', 'tasks'),\n                    disabled: () => !isSimulationRunning.value,\n                },\n                {\n                    id: 'avatar-worldDetails',\n                    icon: '',\n                    text: '',\n                    action: () => openPanel('avatarWorld', 'worldDetails'),\n                    disabled: () => !isSimulationRunning.value,\n                },\n                {\n                    id: 'avatar-sandbox',\n                    icon: '',\n                    text: '',\n                    action: () => openPanel('avatarWorld', 'sandbox'),\n                    disabled: () => !isSimulationRunning.value,\n                },\n            ],\n            common: [\n                { id: 'imprints', icon: '', text: '', action: () => openPanel('mainWorld', 'imprints') },\n                { id: 'reincarnation', icon: '', text: '', action: () => openPanel('reincarnation', 'main') },\n                { id: 'npcDirectory', icon: '', text: '', action: () => openPanel('allWorlds', 'npcDirectory') },\n            ],\n        };\n        const handleOverlayClick = () => {\n            if (inputModal.value.isVisible) {\n                inputModalActions.hide();\n                return;\n            }\n        };\n        const handleAction = async (actionContent) => {\n            console.log('Submitting to AI:', actionContent);\n            await actions.handleAction(actionContent);\n            await saveLoadService.performAutoSave();\n        };\n        const handleSubmit = async (actionContent) => {\n            // Correctly save the raw input value before it gets cleared.\n            const rawInput = inputModal.value.inputValue;\n            inputModalActions.setLastSubmittedValue(rawInput);\n            await handleAction(actionContent);\n            inputModalActions.hide();\n            inputModalActions.clearValue();\n        };\n        const toggleActionPanel = () => {\n            isActionPanelVisible.value = !isActionPanelVisible.value;\n        };\n        const updateCommands = () => {\n            commands.value = commandService.getCommands();\n        };\n        const clearCommands = () => {\n            commandService.clearCommands();\n        };\n        const toggleHistory = () => {\n            isHistoryVisible.value = !isHistoryVisible.value;\n            if (isHistoryVisible.value)\n                isQueueVisible.value = false;\n        };\n        const toggleCommandQueue = () => {\n            isQueueVisible.value = !isQueueVisible.value;\n            if (isQueueVisible.value)\n                isHistoryVisible.value = false;\n        };\n        const selectHistoryEntry = (entry) => {\n            inputModalActions.setValue(entry);\n            isHistoryVisible.value = false;\n        };\n        onMounted(() => {\n            const dockHost = document.getElementById('app');\n            if (dockHost) {\n                dockManagerService.initialize(dockHost);\n            }\n            else {\n                console.error('Dock host element not found.');\n            }\n            actions.loadAllData();\n            actions.initializeEventListeners();\n            dockManagerService.onAction = handleAction;\n            commandService.subscribe(updateCommands);\n            updateCommands();\n            // Setup layout restoration listener\n            eventBus.on('restoreLayout', (panels) => {\n                const { openPanel } = usePanelManager();\n                dockManagerService.closeAllPanels(); // Ensure a clean slate before restoring\n                panels.forEach(panelState => {\n                    try {\n                        openPanel(panelState.world, panelState.panel, panelState.props || {});\n                    }\n                    catch (e) {\n                        console.error(`Failed to restore panel: ${panelState.world}-${panelState.panel}`, e);\n                    }\n                });\n            });\n            // Initialize layout service with current fullscreen state and restore layout\n            layoutService.setCurrentFullscreenState(uiState.isWebFullscreen);\n            layoutService.restoreLayout();\n        });\n        return {\n            confirmation,\n            detailModal,\n            npcModal,\n            isWebFullscreen,\n            inputModal,\n            inputModalActions,\n            menuOptions,\n            handleAction,\n            handleSubmit,\n            handleOverlayClick,\n            store,\n            confirmationService,\n            detailModalService,\n            npcModalService,\n            isActionPanelVisible,\n            toggleActionPanel,\n            isHistoryVisible,\n            toggleHistory,\n            selectHistoryEntry,\n            isQueueVisible,\n            toggleCommandQueue,\n            commands,\n            commandCount,\n            clearCommands,\n        };\n    },\n});\n","/* unplugin-vue-components disabled */import { render } from \"./app.vue?vue&type=template&id=9d8cbf56&ts=true\"\nimport script from \"./app.vue?vue&type=script&lang=ts\"\nexport * from \"./app.vue?vue&type=script&lang=ts\"\n\nimport \"./app.vue?vue&type=style&index=0&id=9d8cbf56&lang=scss\"\n\nimport exportComponent from \"../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"attribute-item\" };\nconst _hoisted_2 = { class: \"attribute-name\" };\nconst _hoisted_3 = { class: \"attribute-value\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'AttributeDisplay',\n    props: {\n        name: {},\n        value: {}\n    },\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"span\", _hoisted_2, _toDisplayString(__props.name), 1 /* TEXT */),\n                _createElementVNode(\"span\", _hoisted_3, _toDisplayString(__props.value), 1 /* TEXT */)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./AttributeDisplay.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AttributeDisplay.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./AttributeDisplay.vue?vue&type=style&index=0&id=490ee3ff&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-490ee3ff\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createBlock as _createBlock, createVNode as _createVNode, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = { class: \"character-panel\" };\nconst _hoisted_2 = { class: \"panel-section\" };\nconst _hoisted_3 = {\n    id: \"base-attributes-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_4 = { class: \"panel-section\" };\nconst _hoisted_5 = {\n    id: \"secondary-attributes-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_6 = { class: \"panel-section\" };\nconst _hoisted_7 = {\n    id: \"grades-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_8 = { class: \"panel-section\" };\nconst _hoisted_9 = {\n    id: \"skills-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_10 = { class: \"panel-section\" };\nconst _hoisted_11 = {\n    id: \"talents-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_12 = { class: \"panel-section\" };\nconst _hoisted_13 = {\n    id: \"schedule-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_14 = { class: \"panel-section\" };\nconst _hoisted_15 = {\n    id: \"relations-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_16 = { class: \"attribute-name\" };\nconst _hoisted_17 = { class: \"attribute-value\" };\nimport { getters } from '../store';\nimport AttributeDisplay from '../components/AttributeDisplay.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'CharacterView',\n    setup(__props) {\n        const { character, secondaryAttributes, todayCourses, getBaseAttributes, getSubjects, getSkills, getTalents, getRelationships, } = getters;\n        const baseAttributes = getBaseAttributes(character);\n        const subjects = getSubjects(character);\n        const skills = getSkills(character);\n        const talents = getters.getTalents(character);\n        const relationships = getRelationships(character);\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(baseAttributes).value, (attr, key) => {\n                            return (_openBlock(), _createBlock(AttributeDisplay, {\n                                key: key,\n                                name: String(key),\n                                value: `${attr.} / ${attr.}`\n                            }, null, 8 /* PROPS */, [\"name\", \"value\"]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    _cache[1] || (_cache[1] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_5, [\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: ` ${_unref(secondaryAttributes).}`\n                        }, null, 8 /* PROPS */, [\"value\"]),\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: _unref(secondaryAttributes).\n                        }, null, 8 /* PROPS */, [\"value\"])\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_6, [\n                    _cache[2] || (_cache[2] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_7, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(subjects).value, (subject, key) => {\n                            return (_openBlock(), _createBlock(AttributeDisplay, {\n                                key: key,\n                                name: String(key),\n                                value: `${subject.} (${subject.})`\n                            }, null, 8 /* PROPS */, [\"name\", \"value\"]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_8, [\n                    _cache[3] || (_cache[3] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_9, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(skills).value, (skill, key) => {\n                            return (_openBlock(), _createBlock(AttributeDisplay, {\n                                key: key,\n                                name: String(key),\n                                value: `Lv.${skill.} / ${skill.}`\n                            }, null, 8 /* PROPS */, [\"name\", \"value\"]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_10, [\n                    _cache[4] || (_cache[4] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_11, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(talents), (talent, index) => {\n                            return (_openBlock(), _createBlock(AttributeDisplay, {\n                                key: index,\n                                name: talent.,\n                                value: talent.\n                            }, null, 8 /* PROPS */, [\"name\", \"value\"]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_12, [\n                    _cache[5] || (_cache[5] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_13, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(todayCourses), (course, index) => {\n                            return (_openBlock(), _createBlock(AttributeDisplay, {\n                                key: index,\n                                name: course.,\n                                value: course.\n                            }, null, 8 /* PROPS */, [\"name\", \"value\"]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_14, [\n                    _cache[6] || (_cache[6] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_15, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(relationships).value, (rel, name) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: name,\n                                class: \"attribute-item\"\n                            }, [\n                                _createElementVNode(\"span\", _hoisted_16, _toDisplayString(name), 1 /* TEXT */),\n                                _createElementVNode(\"span\", _hoisted_17, \" :\" + _toDisplayString(rel.) + \" :\" + _toDisplayString(rel.), 1 /* TEXT */)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./CharacterView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CharacterView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./CharacterView.vue?vue&type=style&index=0&id=3e931026&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3e931026\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = { class: \"inventory-panel\" };\nconst _hoisted_2 = { class: \"panel-section\" };\nconst _hoisted_3 = { class: \"inventory-grid\" };\nconst _hoisted_4 = { class: \"item-name\" };\nconst _hoisted_5 = { class: \"item-quantity\" };\nimport { ref, onMounted } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'InventoryView',\n    setup(__props) {\n        const inventory = ref([]);\n        onMounted(() => {\n            // Mock data for display purposes\n            inventory.value = [\n                { id: 'food001', name: 'A', quantity: 1 },\n                { id: 'snack002', name: 'Pocky', quantity: 3 },\n                { id: 'study001', name: '', quantity: 1 },\n            ];\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(inventory.value, (item) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: item.id,\n                                class: \"inventory-item\"\n                            }, [\n                                _createElementVNode(\"div\", _hoisted_4, _toDisplayString(item.name), 1 /* TEXT */),\n                                _createElementVNode(\"div\", _hoisted_5, \"x\" + _toDisplayString(item.quantity), 1 /* TEXT */)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./InventoryView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./InventoryView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./InventoryView.vue?vue&type=style&index=0&id=fbf176e0&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-fbf176e0\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createVNode as _createVNode, createCommentVNode as _createCommentVNode, normalizeStyle as _normalizeStyle, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"main-content-view\" };\nconst _hoisted_2 = [\"innerHTML\"];\nconst _hoisted_3 = [\"innerHTML\"];\nimport { computed, reactive } from 'vue';\nimport EnhancedInputBox from '../components/common/EnhancedInputBox.vue';\nimport { combinedNarrative, getItemByName, getNpcByName } from '../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'MainContentView',\n    emits: ['submit-action'],\n    setup(__props, { emit: __emit }) {\n        const emit = __emit;\n        const tooltip = reactive({\n            visible: false,\n            content: '',\n            style: {\n                top: '0px',\n                left: '0px',\n            },\n        });\n        const processedNarrative = computed(() => {\n            let text = combinedNarrative.value;\n            // Regex to find <item name=\"...\">...</item> and <npc name=\"...\">...</npc>\n            const itemRegex = /<item name=\"([^\"]+)\">(.+?)<\\/item>/g;\n            const npcRegex = /<npc name=\"([^\"]+)\">(.+?)<\\/npc>/g;\n            text = text.replace(itemRegex, (match, name, content) => {\n                return `<span class=\"highlighted-item\" data-type=\"item\" data-name=\"${name}\">${content}</span>`;\n            });\n            text = text.replace(npcRegex, (match, name, content) => {\n                return `<span class=\"highlighted-npc\" data-type=\"npc\" data-name=\"${name}\">${content}</span>`;\n            });\n            return text;\n        });\n        const handleMouseOver = (event) => {\n            const target = event.target;\n            const dataType = target.dataset.type;\n            const dataName = target.dataset.name;\n            if (!dataType || !dataName)\n                return;\n            let entity;\n            if (dataType === 'item') {\n                entity = getItemByName(dataName);\n            }\n            else if (dataType === 'npc') {\n                entity = getNpcByName(dataName);\n            }\n            if (entity) {\n                tooltip.content = formatTooltipContent(entity, dataType);\n                tooltip.style.top = `${event.clientY + 15}px`;\n                tooltip.style.left = `${event.clientX + 15}px`;\n                tooltip.visible = true;\n            }\n        };\n        const handleMouseOut = () => {\n            tooltip.visible = false;\n        };\n        const formatTooltipContent = (entity, type) => {\n            if (type === 'item') {\n                return `\n      <div class=\"tooltip-title\">${entity.} [${entity.}]</div>\n      <div class=\"tooltip-description\">${entity.}</div>\n      <div class=\"tooltip-level\">: ${entity.}</div>\n    `;\n            }\n            if (type === 'npc') {\n                return `\n      <div class=\"tooltip-title\">${entity.}</div>\n      <div class=\"tooltip-description\">${entity.}</div>\n      <div class=\"tooltip-identity\">: ${entity..join(', ')}</div>\n    `;\n            }\n            return '';\n        };\n        const handleSubmit = (action) => {\n            emit('submit-action', action);\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", {\n                    class: \"narrative-container\",\n                    innerHTML: processedNarrative.value,\n                    onMouseover: handleMouseOver,\n                    onMouseout: handleMouseOut\n                }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_2),\n                _createVNode(EnhancedInputBox, {\n                    placeholder: \"...\",\n                    onSubmitAction: handleSubmit\n                }),\n                _createCommentVNode(\" Tooltip \"),\n                (tooltip.visible)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 0,\n                        class: \"narrative-tooltip\",\n                        style: _normalizeStyle(tooltip.style),\n                        innerHTML: tooltip.content\n                    }, null, 12 /* STYLE, PROPS */, _hoisted_3))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./MainContentView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MainContentView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MainContentView.vue?vue&type=style&index=0&id=2caac21f&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-2caac21f\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = { class: \"npc-list-panel\" };\nconst _hoisted_2 = { class: \"panel-section\" };\nconst _hoisted_3 = { class: \"npc-list\" };\nconst _hoisted_4 = { class: \"npc-name\" };\nconst _hoisted_5 = { class: \"npc-relationship\" };\nimport { ref, onMounted } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcListView',\n    setup(__props) {\n        const npcs = ref([]);\n        onMounted(() => {\n            // Mock data for display purposes\n            // In a real scenario, you would fetch this from the game state\n            npcs.value = [\n                { id: 'yukinoshita_yukino', name: '', favorability: 55 },\n                { id: 'yuigahama_yui', name: '', favorability: 60 },\n            ];\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"section-title\" }, \"NPC \", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(npcs.value, (npc) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: npc.id,\n                                class: \"npc-item\"\n                            }, [\n                                _createElementVNode(\"div\", _hoisted_4, _toDisplayString(npc.name), 1 /* TEXT */),\n                                _createElementVNode(\"div\", _hoisted_5, \": \" + _toDisplayString(npc.favorability), 1 /* TEXT */)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcListView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcListView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcListView.vue?vue&type=style&index=0&id=cbe78d66&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-cbe78d66\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"world-state-panel\" };\nconst _hoisted_2 = { class: \"panel-section\" };\nconst _hoisted_3 = { class: \"state-list\" };\nimport { ref, onMounted, computed } from 'vue';\nimport AttributeDisplay from '../components/AttributeDisplay.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'WorldStateView',\n    setup(__props) {\n        const worldState = ref(null);\n        const currentTime = computed(() => {\n            if (!worldState.value)\n                return '';\n            const time = worldState.value.;\n            return `${time.}-${time.}-${time.} ${time.}:${time.} (${time.})`;\n        });\n        onMounted(() => {\n            // Mock data for display purposes\n            worldState.value = {\n                : {\n                    : 2024,\n                    : 9,\n                    : 1,\n                    : 8,\n                    : 0,\n                    : '',\n                },\n                : '',\n                : '',\n                : 22,\n                : 100,\n                : 'Y2K',\n            };\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: currentTime.value\n                        }, null, 8 /* PROPS */, [\"value\"]),\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: worldState.value?. || 'N/A'\n                        }, null, 8 /* PROPS */, [\"value\"]),\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: worldState.value?. || 'N/A'\n                        }, null, 8 /* PROPS */, [\"value\"]),\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: `${worldState.value?. || 'N/A'}C`\n                        }, null, 8 /* PROPS */, [\"value\"]),\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: worldState.value?. || 0\n                        }, null, 8 /* PROPS */, [\"value\"]),\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: worldState.value?. || 'N/A'\n                        }, null, 8 /* PROPS */, [\"value\"])\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","import { createApp } from 'vue';\nimport { createMemoryHistory, createRouter, RouteRecordRaw } from 'vue-router';\nimport App from '../app.vue';\nimport CharacterView from '../views/CharacterView.vue';\nimport InventoryView from '../views/InventoryView.vue';\nimport MainContentView from '../views/MainContentView.vue';\nimport NpcListView from '../views/NpcListView.vue';\nimport WorldStateView from '../views/WorldStateView.vue';\n\n// \nconst routes: RouteRecordRaw[] = [\n  { path: '/', component: MainContentView },\n  { path: '/character', component: CharacterView },\n  { path: '/npc-list', component: NpcListView },\n  { path: '/inventory', component: InventoryView },\n  { path: '/world-state', component: WorldStateView },\n];\n\nconst router = createRouter({\n  history: createMemoryHistory(),\n  routes,\n});\n\n// \nrouter.replace('/');\n\n$(() => {\n  createApp(App).use(router).mount('#app');\n});\n","/* unplugin-vue-components disabled */import script from \"./WorldStateView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./WorldStateView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./WorldStateView.vue?vue&type=style&index=0&id=1b7ec95a&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.26_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1b7ec95a\"]])\n\nexport default __exports__","import { store } from '../store';\nimport type { WorldLogEntry } from '../types';\nimport { lorebookService } from './LorebookService';\nimport { memoryService } from './MemoryService';\nimport { notificationService } from './NotificationService';\nimport { tavernService } from './tavern';\n\n/**\n * \n * ( actions.ts )\n */\nfunction parseBlock(block: string): { [key: string]: string } {\n  const data: { [key: string]: string } = {};\n  const lines = block.trim().split('\\n');\n  let currentKey = '';\n  for (const line of lines) {\n    const separatorIndex = line.indexOf('|');\n    if (separatorIndex !== -1) {\n      const key = line.substring(0, separatorIndex).trim();\n      const value = line.substring(separatorIndex + 1).trim();\n      data[key] = value;\n      currentKey = key;\n    } else if (currentKey && line.trim()) {\n      data[currentKey] += '\\n' + line;\n    }\n  }\n  for (const key in data) {\n    data[key] = data[key].trim();\n  }\n  return data;\n}\n\nclass LogSyncService {\n  private pollingInterval: any | null = null;\n  private isSyncing = false;\n\n  public startPolling(interval = 15000) {\n    if (this.pollingInterval) {\n      this.stopPolling();\n    }\n    console.log(`[LogSyncService] Starting to poll chat history every ${interval}ms.`);\n    this.pollingInterval = setInterval(() => this.syncLogsFromChat(), interval);\n    this.syncLogsFromChat(); // \n  }\n\n  public stopPolling() {\n    if (this.pollingInterval) {\n      clearInterval(this.pollingInterval);\n      this.pollingInterval = null;\n      console.log('[LogSyncService] Stopped polling chat history.');\n    }\n  }\n\n  public async syncLogsFromChat() {\n    if (this.isSyncing) {\n      console.log('[LogSyncService] Sync is already in progress. Skipping.');\n      return;\n    }\n    this.isSyncing = true;\n    console.log('[LogSyncService] Starting log sync from chat history...');\n\n    try {\n      const messages = await tavernService.fetchTavernData();\n      if (!messages) {\n        this.isSyncing = false;\n        return;\n      }\n\n      const allParsedLogs: WorldLogEntry[] = [];\n      const logBlockRegex = /<>([\\s\\S]+?)<\\/>/g;\n\n      for (const message of messages) {\n        if (message.is_user) continue; // AI\n\n        let match;\n        while ((match = logBlockRegex.exec(message.message)) !== null) {\n          try {\n            const block = parseBlock(match[1]);\n            if (block && block['']) {\n              allParsedLogs.push({\n                : parseInt(block[''], 10),\n                : block[''] || '',\n                : block[''] || '',\n                : block[''] || '',\n                : block[''] || '',\n                : block[''] || '',\n                : block[''] || '',\n                : block['']\n                  ? block['']\n                      .replace(/[[\\]\"]/g, '')\n                      .split(',')\n                      .map(t => t.trim())\n                      .filter(Boolean)\n                  : [],\n                : block[''] || '',\n                : block[''] || '',\n                : block[''] || '',\n                : block[''] || '',\n              });\n            }\n          } catch (e) {\n            console.error('[LogSyncService] Failed to parse a log block:', e);\n          }\n        }\n      }\n\n      if (allParsedLogs.length === 0) {\n        console.log('[LogSyncService] No new log entries found in recent chat history.');\n        this.isSyncing = false;\n        return;\n      }\n\n      const existingLogIds = new Set(store.worldLog.map(log => log.));\n      const newLogs = allParsedLogs.filter(log => !existingLogIds.has(log.) && !isNaN(log.));\n\n      if (newLogs.length > 0) {\n        // \n        newLogs.sort((a, b) => a. - b.);\n\n        // \n        store.worldLog = [...store.worldLog, ...newLogs].sort((a, b) => a. - b.);\n\n        // \n        const contentToAppend = newLogs\n          .map(log => {\n            return Object.entries(log)\n              .map(([key, value]) => `${key}|${Array.isArray(value) ? value.join(', ') : value}`)\n              .join('\\n');\n          })\n          .join('\\n\\n---\\n\\n');\n\n        const existingContent = await lorebookService.readFromLorebook('');\n        const finalContentToAppend = newLogs\n          .map(log => {\n            const logBlock = Object.entries(log)\n              .map(([key, value]) => `${key}|${Array.isArray(value) ? value.join(', ') : value}`)\n              .join('\\n');\n            // \n            return existingContent && existingContent.includes(`|${log.}`) ? null : logBlock;\n          })\n          .filter(Boolean) //  null\n          .join('\\n\\n---\\n\\n');\n\n        if (finalContentToAppend) {\n          await lorebookService.appendToEntry('', finalContentToAppend, '\\n\\n---\\n\\n');\n          notificationService.success('', ` ${newLogs.length} `);\n          console.log(`[LogSyncService] Appended ${newLogs.length} new log entries to Lorebook.`);\n        } else {\n          console.log('[LogSyncService] All new logs were already present in the Lorebook entry. No changes made.');\n        }\n        notificationService.success('', ` ${newLogs.length} `);\n        console.log(`[LogSyncService] Synced ${newLogs.length} new log entries.`);\n      } else {\n        console.log('[LogSyncService] All found logs are already present in the store.');\n      }\n    } catch (error) {\n      console.error('[LogSyncService] Error during log sync:', error);\n    } finally {\n      // \n      try {\n        await memoryService.updateInstantMemory(store.worldLog);\n        await memoryService.updateShortTermMemory(store.worldLog);\n        await memoryService.updateLongTermMemory(store.worldLog);\n        console.log('[LogSyncService] Silently updated all memory tiers after sync.');\n      } catch (memError) {\n        console.error('[LogSyncService] Failed to silently update memory tiers after sync:', memError);\n      }\n      this.isSyncing = false;\n    }\n  }\n}\n\nexport const logSyncService = new LogSyncService();\n","import './core/vue-loader';\nimport 'golden-layout/dist/css/goldenlayout-base.css';\nimport 'golden-layout/dist/css/themes/goldenlayout-dark-theme.css';\nimport './styles/main.scss';\nimport { saveLoadService } from './services/saveLoadService';\nimport { commandService } from './services/CommandService';\nimport { tavernService } from './services/tavern';\nimport { npcService } from './services/NpcService';\nimport { entityIndexService } from './services/EntityIndexService';\nimport { store, actions } from './store';\nimport { watch } from 'vue';\nimport { serviceLocator } from './services/service-locator';\nimport { inputModalActions, inputModalState } from './services/InputModalService';\nimport { logSyncService } from './services/LogSyncService';\nimport { memoryService } from './services/MemoryService';\n\n// \nasync function initializeServices() {\n  // \n  serviceLocator.register('saveLoadService', saveLoadService);\n  serviceLocator.register('inputModalState', inputModalState);\n  serviceLocator.register('inputModalActions', inputModalActions);\n  serviceLocator.register('store', store);\n  serviceLocator.register('actions', actions);\n\n  await npcService.initializeWorldAndLocationData();\n  //  worldState \n  if (!store.worldState) {\n    await new Promise(resolve => {\n      const unwatch = watch(\n        () => store.worldState,\n        newValue => {\n          if (newValue) {\n            unwatch();\n            resolve(true);\n          }\n        },\n      );\n    });\n  }\n  await entityIndexService.buildIndex(store.worldState);\n  // \n}\n\nfunction handleRerollRestore() {\n  const shouldRestore = localStorage.getItem('reincarnation-simulator-restore-input');\n  if (shouldRestore === 'true') {\n    console.log('[Startup] Restore flag found, restoring last input.');\n    const lastInput = localStorage.getItem('reincarnation-simulator-last-submitted');\n    if (lastInput) {\n      inputModalActions.setValue(lastInput);\n      inputModalActions.show();\n    }\n    localStorage.removeItem('reincarnation-simulator-restore-input');\n  }\n}\n\n// \ninitializeServices().then(() => {\n  console.log('All services initialized.');\n  handleRerollRestore();\n\n  // \n  logSyncService.startPolling(15000);\n\n  //  worldLog \n  watch(\n    () => store.worldLog,\n    (newLog, oldLog) => {\n      if (newLog.length > (oldLog?.length || 0)) {\n        console.log('[Auto-Memory] World log updated, triggering memory update.');\n        memoryService.updateMemory(newLog);\n      }\n    },\n    { deep: true }, // \n  );\n});\n\n// \nsaveLoadService;\ncommandService;\ntavernService;\n"],"names":["exports","sfc","props","target","__vccOpts","key","val","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","module","__webpack_modules__","n","getter","__esModule","d","a","definition","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","Vue","VueRouter","_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","style","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","__name","commandCount","mainOptions","avatarOptions","commonOptions","emits","setup","__props","_ctx","_cache","option","id","disabled","onClick","action","text","$event","$emit","commandService","commands","listeners","subscribe","listener","this","push","unsubscribe","filter","l","notify","forEach","addCommand","command","getCommands","clearCommands","STORAGE_KEY_RECENT","STORAGE_KEY_SAVED","inputHistoryService","state","reactive","recent","saved","constructor","loadHistory","recentData","localStorage","getItem","savedData","JSON","parse","saveHistory","setItem","stringify","add","input","trim","existingIndex","indexOf","splice","unshift","length","pop","save","entry","includes","deleteRecent","index","deleteSaved","clearAll","_","z","entityIndexService","indexByName","Map","indexById","isInitialized","buildIndex","worldState","console","log","clear","indexPlayerData","worldId","world","indexWorldData","size","findByName","name","findById","addEntity","entity","existingByName","set","has","playerState","imprints","imprint","type","source","characters","startsWith","char","database","category","items","item","epochs","epochId","epoch","content","locations","loc","path","parentId","ID","resources","res","factions","fac","contextService","analyzeUserIntent","userInput","availableRipples","intent","actionType","explicitEntities","dbItems","triggeredRipples","activeWorld","values","find","w","avatarId","currentPlayer","currentLocationId","worldChars","charId","intentScores","combat","inventory","social","exploration","creation","default","regex","weight","test","maxScore","bestIntent","score","entries","potentialNames","match","results","meta","loadFullPlayerData","activeWorldId","keys","wId","crossContextQuery","ripple","influence","sphereOfInfluence","isTriggered","locationIds","rippleEntities","extractEntitiesFromText","entities","identifyCoreEntities","currentCharacterId","Set","Array","from","allCharacters","currentUser","causalNet","playerRelations","sortedRelations","map","rel","intimacy","conflict","sort","b","mostHostile","character","buildLeanContext","userId","stat_data","leanState","playerFullData","playerLeanData","simplifyIdMap","coreEntities","activeWorldEntry","activeEpoch","leanEpoch","allLocations","leanLocations","locId","parent","leanChars","sceneEntities","allActiveCharIds","fullCausalNet","activeCharIds","subjectId","relations","objectId","referencedDbIds","fullDatabase","categoryStore","itemId","targetWorld","targetDb","store","simple","processKeyValue","line","indent","stack","separatorIndex","substring","valueStr","newChild","level","endsWith","newObj","pairs","slice","split","p","pair","parseValue","trimmed","inner","parts","buffer","inQuotes","bracketLevel","i","part","e","toLowerCase","isNaN","Number","LOREBOOK_NAME","entriesCache","async","getEntries","forceRefresh","TavernHelper","getLorebookEntries","error","readFromLorebook","entryName","comment","writeToLorebook","options","isEnabled","allEntries","targetEntry","setLorebookEntries","uid","enabled","baseKey","replace","baseEntryTemplate","newEntryData","position","order","assign","selective","constant","case_sensitive","createLorebookEntries","appendToEntry","newContent","separator","existingContent","findEntryByComment","warn","setEntryEnabled","updatedEntry","loadAndParseWorldData","worldName","worldData","startIndex","lines","root","indentMatch","trimmedLine","parentObj","listItemContent","isArray","grandParent","lastKey","newListItem","parseWorldLoreForMap","currentEpochId","firstPlayableEpoch","eventBus","events","on","event","callback","off","cb","emit","args","memoryService","INSTANT_MEMORY_KEY","SHORT_TERM_MEMORY_KEY","LONG_TERM_MEMORY_KEY","config","instantMemoryCount","shortTermMemoryCount","longTermMemoryCount","updateMemory","worldLog","updateInstantMemory","updateShortTermMemory","updateLongTermMemory","logs","writeMemory","join","getConfig","setConfig","newConfig","notifications","nextId","actions","show","title","message","duration","setTimeout","hide","findIndex","success","info","notificationState","registry","serviceLocator","register","instance","Error","tavernService","fetchTavernData","debug","messages","getChatMessages","getCurrentMessageId","generateAiResponse","prompt","variables","generateConfig","injects","role","should_scan","should_stream","aiResponse","generate","invokeMvuScript","script","oldVariables","inputData","old_variables","eventEmit","new_variables","COT_FILES","NORMAL","CREATION","IDENTITY","workflowService","currentState","narrativeCache","updateScriptCache","preserveMode","switchTo","getCurrentState","newState","force","allCots","flat","cotsToEnable","cotName","shouldBeEnabled","cacheNarrative","narrative","popNarrative","cacheUpdateScript","popUpdateScript","setPreserveMode","mode","popPreservedContent","worldEvolutionService","informationDelayQueue","applyPressure","pressures","desire","powerLevel","spirit","isAmbitious","some","g","isPowerful","firstGoal","intensity","description","simulateReactions","reactions","pressure","sourceChar","newEvent","Date","now","timestamp","locationId","participants","sourcePressure","propagateRipples","Math","random","toString","sourceEventId","factionIds","decayRate","distortion","delayDays","medium","baseSpeed","delayMilliseconds","arrivalTimestamp","newRipple","toFixed","getAvailableRipples","currentTime","remainingRipples","calculateDistance","locationIdA","locationIdB","locationA","locationB","locAData","locBData","initialState","isReady","mainWorldNarrative","avatarWorldNarrative","activeView","selectedWorldForReincarnation","reincarnationWorldOptions","reincarnationAvatarOptions","settlementData","newWorldsAvailable","isGenerating","generationError","lastSubmittedAction","lastGeneratedPatch","getItemNameById","watch","oldState","deep","playerCharacter","computed","currentAvatar","simulator","reincarnationImprints","mainWorld","unlockedImprints","imprintId","playerSkills","playerArts","skills","artId","artData","artTemplate","levelSystem","currentLevelInfo","nextLevelInfo","associatedSkills","skillId","skillTemplate","exp","expToNextLevel","createInventoryGetter","characterRef","avatarWorld","backpack","quantity","itemDetails","playerInventory","avatarInventory","playerWorldAttributes","currentEpoch","attributeTemplates","result","attributesData","template","isSimulationRunning","simulatorCooldown","status","remainingTime","prep","simulatorStatus","sim","worlds","formatTime","time","defaultString","era","year","month","String","padStart","day","hour","minuteValue","parseInt","mainWorldTimeStr","timeStr","calculateAge","birthDate","age","combinedNarrative","nodes","edges","loreEntry","label","group","player","potentials","potentialText","to","arrows","subjectRelations","relationship","totalFavor","color","dashes","silentUpdater","timerId","isRunning","isUpdating","updateCallback","start","updateFn","interval","window","setInterval","runUpdate","stop","clearInterval","reset","__interval","sanitizeStateData","data","cleanState","stateKeys","lastProcessedMessageId","isLogHistoryLoaded","ZOD_ERROR_NOTIFIED_KEY","isZodErrorNotified","sessionStorage","checkForChangesAndNotify","oldWorlds","newWorlds","oldNpcIds","newNpcIds","npcId","npcName","oldEpochs","newEpochs","oldEvents","newEvents","newEventKeys","oldInventory","newInventory","allItemIds","oldQty","diff","itemName","abs","oldUser","newUser","compareAndNotify","oldVal","newVal","loadAllData","logContent","allLogs","block","parsed","parseBlock","t","uniqueLogs","seenIds","loadWorldLogFromLorebook","rawStateData","fullMessageContent","currentMessageId","removeItem","fixedData","cloneDeep","ZodError","issue","issues","code","received","defaultValue","expected","finalError","firstIssue","errorMessage","gameTextContent","summaryRegex","mainWorldSummaryRegex","avatarWorldSummaryRegex","formatWorldTime","toLocaleString","hour12","processAndWriteSummary","toastrTitle","existingSummaries","targetWorldLocation","formattedSummary","exec","summaryContent","avatarOptionsMatch","xmlDoc","DOMParser","parseFromString","avatars","getElementsByTagName","el","textContent","fetchCoreData","handleAction","actionText","isReroll","saveLoadService","saveStateForReroll","lastAiMessage","reverse","m","is_user","lastMessage","updateScriptMatch","updateScript","jsonPatchMatch","patchContent","updateLastPatchFromHistory","leanContextVariables","aiInput","aiResponseString","processedText","thinkingOpenIndex","thinkingCloseIndex","gametxtOpenIndex","newThinkingCloseIndex","gametxtOpenIndexAgain","gametxtCloseIndex","nextTagIndex","processTags","finalResponseString","response","prefixedInput","gameTextMatch","cachedNarrative","summaryMatch","patchedScript","cmd","Boolean","creationCommands","relationCommands","otherCommands","sortedScript","latestState","newVariables","sanitizedVars","processAiResponse","messageZero","newData","setChatMessages","refresh","performAutoSave","actionAsPressure","actionReactions","prepareReincarnation","worldIdMatch","rerollLastAction","loadRerollState","initializeEventListeners","eventOn","tavern_events","GENERATION_ENDED","latestMessage","failedPath","correctionCommand","fetchReincarnationWorlds","allWorlds","randomWorlds","clearSettlementData","triggerCreationWorkflow","currentNarrative","triggerIdentityWorkflow","sourceEntryName","selectAvatarAndStart","avatarName","setActiveView","view","switchFocus","targetName","addActionToQueue","resetReincarnationSelection","currentKey","STORAGE_KEY","LAST_SUBMITTED_STORAGE_KEY","isVisible","inputValue","lastSubmittedValue","setValue","setLastSubmittedValue","clearValue","inputModalState","readonly","inputModalActions","placeholder","__emit","onInput","submitAction","trimmedInput","hasCommands","combinedContent","onKeypress","historyState","useEntry","isSaved","notification","hideNotification","Notification","icon","handleClick","x","clientX","y","clientY","locationCache","allNpcs","excludeIds","npcService","getNpcsByWorld","npc","initializeWorldAndLocationData","worldInfoList","historicalEpochs","spatialEntities","entityId","getLocationName","getNpcNameById","getNpcId","getParentLocationName","cacheLocationData","component","detailModalService","markRaw","required","identities","calculated","mood","emotions","emotionMapping","getDesc","sortedKeys","k","sortedEmotions","primary","primaryDesc","secondary","getMoodDescription","tryParseObject","str","properties","parseSimpleYaml","nextLineIndex","newList","locationDetails","ref","parentLocationName","cleanValue","formatArea","area","formatCoordinates","coords","refId","refName","bearingParts","direction","angle","distanceParts","onMounted","allEntities","found","effects","attributes_bonus","percentage_bonus","npcNamesRegex","names","escapedNames","RegExp","locationNamesRegex","databaseItemNamesRegex","segments","lastIndex","parseEntities","matchedText","innerText","outerClass","segment","combinedClass","parseText","entityRegexParts","entityRegex","getItemFromDatabase","relationshipClass","getNpcRelationshipClass","emotionalSum","NpcInfoCard","showNpcInfo","locationName","LocationInfoCard","showLocationInfo","DatabaseItemCard","FormattedTextRenderer","viewBox","defaultDescription","centerTitle","centerDescription","getDisplayValue","characterData","innerRingNodes","combatParams","orbitalNodes","attrs","specialKeys","attrValue","isSpecial","max","valueKeys","current","every","setCenterContent","resetCenterContent","node","onMouseenter","onMouseleave","param","attr","cx","cy","formatAttribute","worldSpecificAttributes","combatAttributes","isDrawerOpen","DestinyPlate","selectedItem","closeDetail","avatarItems","tierColorMap","common","rare","epic","legendary","getTierStyle","tierKey","tier","fill","startOffset","destiny","allTasks","taskObject","ultimateTask","destinyNodes","task","derivedTasks","selectedNode","detailModalStyle","top","left","transform","getTaskNameById","taskId","starPositions","positions","totalNodes","progress","sin","PI","starPaths","paths","startPos","endPos","parseFloat","lastNodePos","ultimatePos","parentNode","parentNodeIndex","parentPos","taskPos","getDerivedStarPosition","offsetX","floor","offsetY","selectNode","nodeData","currentTarget","starNode","startDrag","modal","closest","startX","startY","startTop","offsetTop","startLeft","offsetLeft","doDrag","stopDrag","document","removeEventListener","addEventListener","getStarPosition","x1","y1","x2","y2","offset","triggered","onMousedown","formatAttributeValue","rest","daoHeart","worldAttributes","paddedImprints","empty","clickable","ImprintDetailModal","openImprintDetail","isText","selectedCategory","groupedItems","groups","firstCategoryWithItems","itemsInSelectedCategory","active","selected","ItemDetailPanel","FOLLOWED_NPCS_STORAGE_KEY","followedNpcs","useFollowSystem","isFollowed","toggleFollow","delete","unfollow","follow","newSet","isFollowedState","toggle","watchEffect","followed","_hoisted_24","_hoisted_25","_hoisted_26","formattedBirthDate","bd","v","tendencyKey","attributes","filteredAttributes","$meta","formatValue","output","itemKey","isObject","isSimpleValue","isDataItem","filterMeta","width","dataValue","dataKey","subValue","subKey","ObjectRendererItem","isNested","context","filteredData","art","skillDb","skill","talent","npcAttributes","resolvedAttributes","attrId","attributeName","talents","talentDb","talentId","talentData","npcArts","artDb","skillsList","levelKey","AttributeGrid","ObjectRenderer","TalentDetail","ArtDetail","min","displayValue","isBidirectional","fillStyle","right","backgroundColor","vectorGroups","vectors","immediate","expandedRelation","getFormattedTags","relation","causeTags","tag","relationName","vector","ProgressBar","inventoryItems","InventoryGrid","RelationsDisplay","memory","activeTab","tabs","tab","NpcArchiveTab","NpcPowerTab","NpcCauseTab","selectedWorldId","selectedNpc","selectedNpcId","isWorldListVisible","worldSearchTerm","npcSearchTerm","filteredWorlds","selectedWorldNpcs","filteredNpcs","npcs","aFollowed","bFollowed","loadWorlds","FollowButton","NpcDetailDisplay","expandedLog","logId","ripplesService","ripples","initialize","loadRipples","rippleContent","rippleBlocks","parsedRipples","blockContent","blockData","rippleId","rawContent","getRippleById","selectedRipple","avatar","toastr","onConfirm","onCancel","hideCancel","confirmationService","Promise","resolve","confirm","cancel","choice","isSelected","selectCard","selectedChoice","choices","choicesObj","c","confirmChoice","mainCharacter","soulEssence","SettlementChoiceCard","onSelect","StarMapService","scene","camera","renderer","controls","container","stars","skybox","starObjects","speedMultiplier","clientWidth","clientHeight","antialias","alpha","init","domElement","enableDamping","dampingFactor","autoRotate","autoRotateSpeed","minDistance","maxDistance","enablePan","panSpeed","animate","setSize","setPixelRatio","devicePixelRatio","appendChild","onWindowResize","bind","createSkybox","shaderMaterial","vertexShader","fragmentShader","uniforms","u_time","side","skyboxGeometry","getColorForEnergyLevel","createStars","selectableIds","existingStarIds","s","userData","newWorldIds","star","remove","createSingleStar","isSelectable","energyLevel","baseColor","newColor","core","children","halo","material","lerp","coreGeometry","haloGeometry","phi","acos","theta","sqrt","cos","timeFlow","starColor","coreMaterial","haloMaterial","transparent","opacity","blending","scale","starGroup","orbitSpeed","log1p","orbitRadius","orbitAngle","atan2","requestAnimationFrame","update","render","aspect","updateProjectionMatrix","destroy","dispose","removeChild","pickStar","raycaster","mouse","rect","getBoundingClientRect","height","setFromCamera","intersects","intersectObjects","object","setSpeedMultiplier","multiplier","getSpeedMultiplier","starmapContainer","starMapService","isLoading","detailedWorld","selectableWorldIds","progressInterval","activeEpochId","speedLevels","speedLevel","parsedWorlds","idCounter","epochData","coreLaws","law","raw","originalId","cosmologicalBlueprint","physicalScale","cooldown","isDetailedWorldActive","selectRandomWorlds","ids","shuffled","handleCanvasClick","pickedWorld","newWorld","newContainer","onUnmounted","wasRunning","adjustSpeed","delta","newLevel","ref_key","visible","reincarnationStatus","statusText","newStatus","WorldSelection","AvatarSelection","SettlementView","LogPanel","RipplesPanel","toRefs","expandedSkills","isExpanded","expanded","activeSkill","isAutoMemoryEnabled","memoryContent","instant","short","long","activeMemoryContent","fetchMemoryContent","all","updateConfig","forceUpdate","handleMemoryUpdate","for","number","SAVE_SLOT_PREFIX","AUTO_SAVE_SLOTS","REROLL_SAVE_SLOT_ID","LOREBOOK_KEYS_TO_BACKUP","manualSlots","autoSlots","rerollSlot","turnCounter","isAutoSaveEnabled","autoSaveInterval","areSlotsLoaded","initializeSlots","loadAutoSaveState","loadTurnCounter","ensureSlotsLoaded","loadAllSaveSlots","updateSlot","slot","worldLogDate","worldLogTitle","entryUid","saveGame","slotId","isAutoSave","toISOString","lorebookBackup","lastLogEntry","saveData","mvu_data","message_content","lorebook_backup","existingEntry","_internalLoadGame","loadGame","deleteSave","deleteLorebookEntries","location","reload","exportSave","dataStr","dataBlob","Blob","url","URL","createObjectURL","link","createElement","href","download","body","click","revokeObjectURL","importSave","jsonContent","emptySlot","toggleAutoSave","savedState","savedCounter","defineComponent","fileInput","loadSlots","formatTimestamp","handleFileImport","files","file","reader","FileReader","onload","readAsText","slotToExport","$props","$setup","$data","$options","onChange","accept","SaveLoadPanel","MemoryPanel","realm","req","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","worldType","worldSummary","availableEpochs","selectedEpochId","definitions","innerHTML","RealmDetailCard","colorService","colorCache","colorScale","simpleHash","hash","charCodeAt","getColor","coordinateService","baseAngleMap","parseAzimuth","azimuthValue","matches","baseDirection","offsetDegrees","baseAngle","normalizeDistance","distance","unit","getCartesianCoordinates","relativeCoord","azimuth","toUpperCase","theoreticalDistance","calculateRelativePositions","allDistances","child","distanceScale","domain","range","clamp","coord","isOverlapping","isVertical","visualDistance","worldMapDataService","hierarchyCache","getMapHierarchy","cacheKey","hierarchy","buildHierarchy","clearCache","nodeMap","rootNodes","childCount","radius","currentRootId","navigationPath","isDetailPanelVisible","userLocationId","avatarLocationId","navigateToNode","crumb","navigateBack","targetId","targetIndex","hideDetail","setNavigationPath","setWorldData","setPlayerLocations","user","mapState","mapActions","nodeId","associatedResources","resource","associatedFactions","factionsSource","faction","panelRef","panel","querySelector","isDragging","onDragMove","moveEvent","dx","dy","onDragEnd","querySelectorAll","handle","stopPropagation","dataset","isResizing","startWidth","offsetWidth","startHeight","offsetHeight","onResizeMove","onResizeEnd","svgRef","fullHierarchy","layoutNodes","layoutLinks","searchText","isSearchPanelVisible","findNode","currentRootNode","allNodes","traverse","searchResults","jumpToNode","newNavPath","jumpToFirstResult","searchBtnRef","renderD3","links","clickTimers","svg","zoomContainer","selectAll","zoomContainerEnter","enter","append","merge","zoom","scaleExtent","transition","visualCenterNode","distances","exit","nodeGroups","nodeEnter","brighter","existingTimeout","clearTimeout","newTimeout","newRoot","rootCopy","nodesToRender","nextTick","userLocation","avatarLocation","starFieldSize","select","btn","onMouseMove","parentElement","containerRect","onMouseUp","bottom","onmousedown","initDraggableSearchBtn","handleClickOutside","searchPanel","contains","onActivated","onNavigateBack","MapNavigator","onNavigate","onKeyup","getFullPath","NodeDetailPanel","onClose","panelRegistry","CharacterPanel","InventoryPanel","SkillsPanel","ImprintsPanel","worldDetails","WorldDetailsPanel","sandbox","classed","mainNode","AvatarCharacterPanel","AvatarInventoryPanel","tasks","AvatarTasksPanel","AvatarWorldMapView","reincarnation","main","ReincarnationPanel","npcDirectory","NpcDirectoryPanel","detail","RippleDetailPanel","system","saveLoad","SystemPanel","dockManagerService","goldenLayout","hostElement","componentMap","onAction","registerComponent","MainView","componentName","panelInfo","updateLayout","loadLayout","getDefaultLayout","e2","loadSavedLayout","componentState","vueComponent","h","vnode","getElement","setTitle","panelId","openPanel","addComponent","updateSize","closeAllPanels","rootItem","contentItems","isClosable","unpinAllPanels","componentType","getFullscreenLayout","usePanelManager","finalProps","dockHost","onBeforeUnmount","tips","randomTip","stopProgress","newError","$","originalStyles","fullscreenService","enterWeb","iframeSelector","iframes","contentWindow","iframe","src","getAttribute","srcFileName","getIframeSelector","elementsToModify","zIndex","border","borderRadius","display","maxHeight","selector","$element","newStyles","css","documentElement","addClass","exitWeb","removeClass","toggleBrowser","onBrowserChange","isBrowserFullscreen","npcModalService","isWebFullscreen","isFullscreen","toggleBrowserFullscreen","toggleWebFullscreen","newFullscreenState","uiState","uiActions","timeString","toggleFullscreen","openSaveLoadPanel","openInputModal","fullscreenTitle","fullscreenIcon","WorldTimeDisplay","NORMAL_LAYOUT_KEY","FULLSCREEN_LAYOUT_KEY","layoutService","activePanels","fullscreenPanels","loadAllLayouts","addPanel","removePanel","handleFullscreenChange","normalState","fullscreenState","saveLayoutState","currentMap","restoreLayout","panelsToRestore","setCurrentFullscreenState","components","DockManager","EnhancedInputBox","LoadingIndicator","NpcListModal","TopStatusBar","SideMenuButton","NotificationContainer","ActionPanel","InputHistoryPopup","confirmation","detailModal","npcModal","inputModal","isActionPanelVisible","isHistoryVisible","isQueueVisible","menuOptions","actionContent","updateCommands","getElementById","panels","panelState","handleSubmit","rawInput","handleOverlayClick","toggleActionPanel","toggleHistory","selectHistoryEntry","toggleCommandQueue","_component_TopStatusBar","_component_DockManager","_component_LoadingIndicator","_component_NpcListModal","_component_ActionPanel","_component_EnhancedInputBox","_component_InputHistoryPopup","_component_NotificationContainer","onToggleHistory","onToggleCommands","onSubmitAction","onToggleActionPanel","onSelectEntry","secondaryAttributes","todayCourses","getBaseAttributes","getSubjects","getSkills","getTalents","getRelationships","getters","baseAttributes","subjects","relationships","AttributeDisplay","subject","course","tooltip","processedNarrative","handleMouseOver","dataType","dataName","getItemByName","getNpcByName","formatTooltipContent","handleMouseOut","onMouseover","onMouseout","favorability","routes","MainContentView","CharacterView","NpcListView","InventoryView","router","createRouter","history","createMemoryHistory","createApp","use","mount","logSyncService","pollingInterval","isSyncing","startPolling","stopPolling","syncLogsFromChat","allParsedLogs","logBlockRegex","existingLogIds","newLogs","finalContentToAppend","logBlock","memError","unwatch","newValue","initializeServices","then","lastInput","handleRerollRestore","newLog","oldLog"],"ignoreList":[],"sourceRoot":""}