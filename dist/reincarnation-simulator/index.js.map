{"version":3,"file":"index.js","mappings":"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","sources":["src://tavern_helper_template/node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js","src://tavern_helper_template/webpack/bootstrap","src://tavern_helper_template/webpack/runtime/compat get default export","src://tavern_helper_template/webpack/runtime/define property getters","src://tavern_helper_template/webpack/runtime/hasOwnProperty shorthand","src://tavern_helper_template/webpack/runtime/make namespace object","src://tavern_helper_template/external var \"Vue\"","src://tavern_helper_template/external var \"VueRouter\"","webpack://tavern_helper_template/./src/reincarnation-simulator/app.vue?7916","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/ActionPanel.vue?9e2d","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/ActionPanel.vue?46db","src://tavern_helper_template/src/reincarnation-simulator/services/CommandService.ts","src://tavern_helper_template/src/reincarnation-simulator/services/InputHistoryService.ts","src://tavern_helper_template/external var \"_\"","src://tavern_helper_template/src/reincarnation-simulator/modules/world-map/services/WorldMapParser.ts","src://tavern_helper_template/src/reincarnation-simulator/services/LorebookService.ts","src://tavern_helper_template/src/reincarnation-simulator/services/MemoryService.ts","src://tavern_helper_template/src/reincarnation-simulator/services/NotificationService.ts","src://tavern_helper_template/src/reincarnation-simulator/services/tavern.ts","src://tavern_helper_template/src/reincarnation-simulator/services/WorkflowService.ts","src://tavern_helper_template/src/reincarnation-simulator/services/WorldUpdateService.ts","src://tavern_helper_template/external var \"z\"","src://tavern_helper_template/src/reincarnation-simulator/types/schema.ts","src://tavern_helper_template/src/reincarnation-simulator/utils/yamlParser.ts","src://tavern_helper_template/src/reincarnation-simulator/store/state.ts","src://tavern_helper_template/src/reincarnation-simulator/store/getters.ts","src://tavern_helper_template/src/reincarnation-simulator/services/updater.ts","src://tavern_helper_template/src/reincarnation-simulator/store/actions.ts","src://tavern_helper_template/src/reincarnation-simulator/services/InputModalService.ts","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/EnhancedInputBox.vue?61f3","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/EnhancedInputBox.vue?2f25","src://tavern_helper_template/src/reincarnation-simulator/components/common/InputHistoryPopup.vue","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/InputHistoryPopup.vue?dbe5","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/Notification.vue?719a","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/Notification.vue?f203","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/NotificationContainer.vue?4cc4","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/NotificationContainer.vue?7871","webpack://tavern_helper_template/./src/reincarnation-simulator/components/controls/RadialMenu.vue?6c71","webpack://tavern_helper_template/src/reincarnation-simulator/components/controls/RadialMenu.vue?d1d0","webpack://tavern_helper_template/./src/reincarnation-simulator/components/controls/SideMenuButton.vue?2518","webpack://tavern_helper_template/src/reincarnation-simulator/components/controls/SideMenuButton.vue?840c","src://tavern_helper_template/src/reincarnation-simulator/services/DockManagerService.ts","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/DestinyPlate.vue?6cc2","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/DestinyPlate.vue?2f73","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/avatar/AvatarCharacterPanel.vue?ba4b","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/avatar/AvatarCharacterPanel.vue?9a34","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/avatar/AvatarInventoryPanel.vue?218f","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/avatar/AvatarInventoryPanel.vue?9b99","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/avatar/AvatarTasksPanel.vue?6c7d","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/avatar/AvatarTasksPanel.vue?bb18","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/CharacterPanel.vue?ac72","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/CharacterPanel.vue?bf6e","src://tavern_helper_template/src/reincarnation-simulator/services/DetailModalService.ts","src://tavern_helper_template/src/reincarnation-simulator/components/modals/ImprintDetailModal.vue","webpack://tavern_helper_template/src/reincarnation-simulator/components/modals/ImprintDetailModal.vue?02d6","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/ImprintsPanel.vue?0006","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/ImprintsPanel.vue?8448","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/InventoryPanel.vue?ba4d","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/InventoryPanel.vue?0bd5","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/SkillsPanel.vue?36ad","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/SkillsPanel.vue?4342","src://tavern_helper_template/src/reincarnation-simulator/services/NpcService.ts","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/npc-details/NpcArchiveTab.vue?8b78","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/npc-details/NpcArchiveTab.vue?fdce","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/AttributeGrid.vue?bfc1","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/AttributeGrid.vue?53be","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/npc-details/NpcPowerTab.vue?a64c","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/npc-details/NpcPowerTab.vue?f68c","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/ProgressBar.vue?5d59","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/ProgressBar.vue?c5ec","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/RelationsDisplay.vue?e891","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/RelationsDisplay.vue?6ae5","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/InventoryGrid.vue?32b1","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/InventoryGrid.vue?6bcf","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/npc-details/NpcCauseTab.vue?8eb4","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/npc-details/NpcCauseTab.vue?9c77","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/NpcDetailDisplay.vue?86cd","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/NpcDetailDisplay.vue?77b9","src://tavern_helper_template/src/reincarnation-simulator/services/useFollowSystem.ts","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/FollowButton.vue?8dc4","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/FollowButton.vue?a9d1","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/NpcDirectoryPanel.vue?6dca","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/NpcDirectoryPanel.vue?d047","src://tavern_helper_template/src/reincarnation-simulator/services/CooldownService.ts","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/LogPanel.vue?e6b8","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/LogPanel.vue?5735","src://tavern_helper_template/src/reincarnation-simulator/services/RipplesService.ts","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/RipplesPanel.vue?ab45","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/RipplesPanel.vue?0bb5","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/reincarnation/AvatarSelection.vue?6917","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/reincarnation/AvatarSelection.vue?b9aa","src://tavern_helper_template/src/reincarnation-simulator/services/ConfirmationService.ts","src://tavern_helper_template/src/reincarnation-simulator/components/panels/reincarnation/SettlementChoiceCard.vue","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/reincarnation/SettlementChoiceCard.vue?97df","src://tavern_helper_template/external var \"toastr\"","src://tavern_helper_template/src/reincarnation-simulator/components/panels/reincarnation/SettlementView.vue","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/reincarnation/SettlementView.vue?43d6","src://tavern_helper_template/src/reincarnation-simulator/services/StarMapService.ts","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/reincarnation/WorldSelection.vue?9945","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/reincarnation/WorldSelection.vue?a90c","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/SettlementPanel.vue?ae17","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/SettlementPanel.vue?9393","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/ReincarnationPanel.vue?b826","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/ReincarnationPanel.vue?44f1","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/RippleDetailPanel.vue?86bc","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/RippleDetailPanel.vue?380d","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/MemoryPanel.vue?47fd","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/MemoryPanel.vue?256d","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/SaveLoadPanel.vue?c834","src://tavern_helper_template/src/reincarnation-simulator/services/saveLoadService.ts","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/SaveLoadPanel.vue?65a4","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/SaveLoadPanel.vue?aa11","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/SystemPanel.vue?6d64","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/SystemPanel.vue?59e6","webpack://tavern_helper_template/./src/reincarnation-simulator/components/panels/WorldDetailsPanel.vue?8a00","webpack://tavern_helper_template/src/reincarnation-simulator/components/panels/WorldDetailsPanel.vue?d659","src://tavern_helper_template/src/reincarnation-simulator/modules/world-map/services/ColorService.ts","src://tavern_helper_template/src/reincarnation-simulator/modules/world-map/services/CoordinateService.ts","src://tavern_helper_template/src/reincarnation-simulator/modules/world-map/services/WorldMapDataService.ts","src://tavern_helper_template/src/reincarnation-simulator/modules/world-map/store/mapState.ts","webpack://tavern_helper_template/./src/reincarnation-simulator/modules/world-map/components/MapNavigator.vue?9756","webpack://tavern_helper_template/src/reincarnation-simulator/modules/world-map/components/MapNavigator.vue?b975","webpack://tavern_helper_template/./src/reincarnation-simulator/modules/world-map/components/NodeDetailPanel.vue?b48a","webpack://tavern_helper_template/src/reincarnation-simulator/modules/world-map/components/NodeDetailPanel.vue?c623","webpack://tavern_helper_template/./src/reincarnation-simulator/modules/world-map/components/AvatarWorldMapView.vue?a4ff","webpack://tavern_helper_template/src/reincarnation-simulator/modules/world-map/components/AvatarWorldMapView.vue?7dd3","webpack://tavern_helper_template/./src/reincarnation-simulator/modules/world-map/components/WorldMapView.vue?ff1f","src://tavern_helper_template/src/reincarnation-simulator/services/usePanelManager.ts","webpack://tavern_helper_template/./src/reincarnation-simulator/components/common/FormattedTextRenderer.vue?9990","webpack://tavern_helper_template/src/reincarnation-simulator/components/common/FormattedTextRenderer.vue?2543","webpack://tavern_helper_template/./src/reincarnation-simulator/MainView.vue?d048","webpack://tavern_helper_template/src/reincarnation-simulator/MainView.vue?9598","webpack://tavern_helper_template/src/reincarnation-simulator/components/DockManager.vue?dc7e","webpack://tavern_helper_template/./src/reincarnation-simulator/components/DockManager.vue?a6d2","webpack://tavern_helper_template/./src/reincarnation-simulator/components/LoadingIndicator.vue?6cac","webpack://tavern_helper_template/src/reincarnation-simulator/components/LoadingIndicator.vue?a895","webpack://tavern_helper_template/./src/reincarnation-simulator/components/modals/NpcListModal.vue?ff1a","webpack://tavern_helper_template/src/reincarnation-simulator/components/modals/NpcListModal.vue?e89a","src://tavern_helper_template/external var \"$\"","src://tavern_helper_template/src/reincarnation-simulator/services/fullscreenService.ts","src://tavern_helper_template/src/reincarnation-simulator/services/NpcModalService.ts","src://tavern_helper_template/src/reincarnation-simulator/store/ui.ts","webpack://tavern_helper_template/./src/reincarnation-simulator/components/WorldTimeDisplay.vue?e0b6","webpack://tavern_helper_template/src/reincarnation-simulator/components/WorldTimeDisplay.vue?e8f8","webpack://tavern_helper_template/./src/reincarnation-simulator/components/TopStatusBar.vue?d514","webpack://tavern_helper_template/src/reincarnation-simulator/components/TopStatusBar.vue?2ef5","webpack://tavern_helper_template/./src/reincarnation-simulator/app.vue?39ea","webpack://tavern_helper_template/src/reincarnation-simulator/app.vue?4f7b","webpack://tavern_helper_template/./src/reincarnation-simulator/components/AttributeDisplay.vue?8028","webpack://tavern_helper_template/src/reincarnation-simulator/components/AttributeDisplay.vue?49c3","webpack://tavern_helper_template/./src/reincarnation-simulator/views/CharacterView.vue?353a","webpack://tavern_helper_template/src/reincarnation-simulator/views/CharacterView.vue?7e95","webpack://tavern_helper_template/./src/reincarnation-simulator/views/InventoryView.vue?1dd1","webpack://tavern_helper_template/src/reincarnation-simulator/views/InventoryView.vue?e30b","webpack://tavern_helper_template/./src/reincarnation-simulator/views/MainContentView.vue?3170","webpack://tavern_helper_template/src/reincarnation-simulator/views/MainContentView.vue?f249","webpack://tavern_helper_template/./src/reincarnation-simulator/views/NpcListView.vue?574d","webpack://tavern_helper_template/src/reincarnation-simulator/views/NpcListView.vue?61be","webpack://tavern_helper_template/./src/reincarnation-simulator/views/WorldStateView.vue?b8c7","src://tavern_helper_template/src/reincarnation-simulator/core/vue-loader.ts","webpack://tavern_helper_template/src/reincarnation-simulator/views/WorldStateView.vue?424e","src://tavern_helper_template/src/reincarnation-simulator/index.ts"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = Vue;","const __WEBPACK_NAMESPACE_OBJECT__ = VueRouter;","import { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, withModifiers as _withModifiers, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, resolveDynamicComponent as _resolveDynamicComponent, normalizeProps as _normalizeProps, guardReactiveProps as _guardReactiveProps, createBlock as _createBlock, renderList as _renderList, Fragment as _Fragment, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"main-layout\" };\nconst _hoisted_2 = { class: \"modal-content confirmation-modal\" };\nconst _hoisted_3 = { class: \"confirmation-title\" };\nconst _hoisted_4 = { class: \"confirmation-message\" };\nconst _hoisted_5 = { class: \"confirmation-buttons\" };\nconst _hoisted_6 = { class: \"modal-content detail-modal\" };\nconst _hoisted_7 = { class: \"modal-header\" };\nconst _hoisted_8 = { class: \"modal-title\" };\nconst _hoisted_9 = { class: \"modal-body\" };\nconst _hoisted_10 = { class: \"modal-content detail-modal\" };\nconst _hoisted_11 = { class: \"modal-header\" };\nconst _hoisted_12 = { class: \"modal-title\" };\nconst _hoisted_13 = { class: \"modal-body\" };\nconst _hoisted_14 = { class: \"modal-content input-modal-content\" };\nconst _hoisted_15 = { class: \"input-area-container\" };\nconst _hoisted_16 = { class: \"input-area-with-buttons\" };\nconst _hoisted_17 = {\n    key: 2,\n    class: \"command-queue-popup\"\n};\nconst _hoisted_18 = {\n    key: 0,\n    class: \"command-list\"\n};\nconst _hoisted_19 = {\n    key: 1,\n    class: \"empty-queue\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n    const _component_TopStatusBar = _resolveComponent(\"TopStatusBar\");\n    const _component_MainView = _resolveComponent(\"MainView\");\n    const _component_DockManager = _resolveComponent(\"DockManager\");\n    const _component_RadialMenu = _resolveComponent(\"RadialMenu\");\n    const _component_LoadingIndicator = _resolveComponent(\"LoadingIndicator\");\n    const _component_NpcListModal = _resolveComponent(\"NpcListModal\");\n    const _component_ActionPanel = _resolveComponent(\"ActionPanel\");\n    const _component_EnhancedInputBox = _resolveComponent(\"EnhancedInputBox\");\n    const _component_InputHistoryPopup = _resolveComponent(\"InputHistoryPopup\");\n    const _component_NotificationContainer = _resolveComponent(\"NotificationContainer\");\n    return (_openBlock(), _createElementBlock(\"div\", {\n        class: _normalizeClass([\"guixu-root-container\", { 'web-fullscreen': _ctx.isWebFullscreen }])\n    }, [\n        _createVNode(_component_TopStatusBar),\n        _createElementVNode(\"div\", _hoisted_1, [\n            _createVNode(_component_MainView),\n            _createVNode(_component_DockManager)\n        ]),\n        _createCommentVNode(\" Radial Menu Modal \"),\n        (_ctx.radialMenu.isVisible)\n            ? (_openBlock(), _createElementBlock(\"div\", {\n                key: 0,\n                class: \"modal-overlay\",\n                onClick: _cache[0] || (_cache[0] = _withModifiers(\n                //@ts-ignore\n                (...args) => (_ctx.closeRadialMenu && _ctx.closeRadialMenu(...args)), [\"self\"]))\n            }, [\n                _createVNode(_component_RadialMenu, {\n                    options: _ctx.radialMenu.options,\n                    onClose: _ctx.closeRadialMenu\n                }, null, 8 /* PROPS */, [\"options\", \"onClose\"])\n            ]))\n            : _createCommentVNode(\"v-if\", true),\n        _createCommentVNode(\" Global Confirmation Modal \"),\n        (_ctx.confirmation.isVisible)\n            ? (_openBlock(), _createElementBlock(\"div\", {\n                key: 1,\n                class: \"modal-overlay\",\n                onClick: _cache[3] || (_cache[3] = _withModifiers(($event) => (_ctx.confirmationService.hide()), [\"self\"]))\n            }, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"h3\", _hoisted_3, _toDisplayString(_ctx.confirmation.title), 1 /* TEXT */),\n                    _createElementVNode(\"p\", _hoisted_4, _toDisplayString(_ctx.confirmation.message), 1 /* TEXT */),\n                    _createElementVNode(\"div\", _hoisted_5, [\n                        _createElementVNode(\"button\", {\n                            onClick: _cache[1] || (_cache[1] = ($event) => (_ctx.confirmationService.hide()))\n                        }, \"\"),\n                        _createElementVNode(\"button\", {\n                            class: \"primary\",\n                            onClick: _cache[2] || (_cache[2] = ($event) => (_ctx.confirmationService.confirm()))\n                        }, \"\")\n                    ])\n                ])\n            ]))\n            : _createCommentVNode(\"v-if\", true),\n        _createCommentVNode(\" Global Detail Modal \"),\n        (_ctx.detailModal.isVisible)\n            ? (_openBlock(), _createElementBlock(\"div\", {\n                key: 2,\n                class: \"modal-overlay\",\n                onClick: _cache[5] || (_cache[5] = _withModifiers(($event) => (_ctx.detailModalService.hide()), [\"self\"]))\n            }, [\n                _createElementVNode(\"div\", _hoisted_6, [\n                    _createElementVNode(\"div\", _hoisted_7, [\n                        _createElementVNode(\"h3\", _hoisted_8, _toDisplayString(_ctx.detailModal.title), 1 /* TEXT */),\n                        _createElementVNode(\"button\", {\n                            class: \"close-button\",\n                            onClick: _cache[4] || (_cache[4] = ($event) => (_ctx.detailModalService.hide()))\n                        }, \"\")\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_9, [\n                        (_openBlock(), _createBlock(_resolveDynamicComponent(_ctx.detailModal.component), _normalizeProps(_guardReactiveProps(_ctx.detailModal.props)), null, 16 /* FULL_PROPS */))\n                    ])\n                ])\n            ]))\n            : _createCommentVNode(\"v-if\", true),\n        (_ctx.store.isGenerating)\n            ? (_openBlock(), _createBlock(_component_LoadingIndicator, {\n                key: 3,\n                error: _ctx.store.generationError\n            }, null, 8 /* PROPS */, [\"error\"]))\n            : _createCommentVNode(\"v-if\", true),\n        _createCommentVNode(\" Global NPC List Modal \"),\n        (_ctx.npcModal.isVisible)\n            ? (_openBlock(), _createElementBlock(\"div\", {\n                key: 4,\n                class: \"modal-overlay\",\n                onClick: _cache[7] || (_cache[7] = _withModifiers(($event) => (_ctx.npcModalService.hide()), [\"self\"]))\n            }, [\n                _createElementVNode(\"div\", _hoisted_10, [\n                    _createElementVNode(\"div\", _hoisted_11, [\n                        _createElementVNode(\"h3\", _hoisted_12, _toDisplayString(_ctx.npcModal.title), 1 /* TEXT */),\n                        _createElementVNode(\"button\", {\n                            class: \"close-button\",\n                            onClick: _cache[6] || (_cache[6] = ($event) => (_ctx.npcModalService.hide()))\n                        }, \"\")\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_13, [\n                        _createVNode(_component_NpcListModal, _normalizeProps(_guardReactiveProps(_ctx.npcModal.props)), null, 16 /* FULL_PROPS */)\n                    ])\n                ])\n            ]))\n            : _createCommentVNode(\"v-if\", true),\n        _createCommentVNode(\" Global Input Modal \"),\n        (_ctx.inputModal.isVisible)\n            ? (_openBlock(), _createElementBlock(\"div\", {\n                key: 5,\n                class: \"modal-overlay input-modal-overlay\",\n                onClick: _cache[11] || (_cache[11] = _withModifiers(($event) => (_ctx.inputModalActions.hide()), [\"self\"]))\n            }, [\n                _createElementVNode(\"div\", _hoisted_14, [\n                    _createElementVNode(\"div\", _hoisted_15, [\n                        (_ctx.isActionPanelVisible)\n                            ? (_openBlock(), _createBlock(_component_ActionPanel, {\n                                key: 0,\n                                \"command-count\": _ctx.commandCount,\n                                onOpenMainMenu: _cache[8] || (_cache[8] = ($event) => (_ctx.openRadialMenu('left'))),\n                                onOpenAvatarMenu: _cache[9] || (_cache[9] = ($event) => (_ctx.openRadialMenu('right'))),\n                                onToggleHistory: _ctx.toggleHistory,\n                                onToggleCommands: _ctx.toggleCommandQueue\n                            }, null, 8 /* PROPS */, [\"command-count\", \"onToggleHistory\", \"onToggleCommands\"]))\n                            : _createCommentVNode(\"v-if\", true),\n                        _createElementVNode(\"div\", _hoisted_16, [\n                            _createVNode(_component_EnhancedInputBox, {\n                                onSubmitAction: _ctx.handleSubmit,\n                                onToggleActionPanel: _ctx.toggleActionPanel\n                            }, null, 8 /* PROPS */, [\"onSubmitAction\", \"onToggleActionPanel\"])\n                        ]),\n                        (_ctx.isHistoryVisible)\n                            ? (_openBlock(), _createBlock(_component_InputHistoryPopup, {\n                                key: 1,\n                                onClose: _ctx.toggleHistory,\n                                onSelectEntry: _ctx.selectHistoryEntry\n                            }, null, 8 /* PROPS */, [\"onClose\", \"onSelectEntry\"]))\n                            : _createCommentVNode(\"v-if\", true),\n                        (_ctx.isQueueVisible)\n                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_17, [\n                                (_ctx.commandCount > 0)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_18, [\n                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.commands, (cmd, index) => {\n                                            return (_openBlock(), _createElementBlock(\"div\", {\n                                                key: index,\n                                                class: \"command-item\"\n                                            }, _toDisplayString(cmd), 1 /* TEXT */));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                    ]))\n                                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_19, \"\")),\n                                (_ctx.commandCount > 0)\n                                    ? (_openBlock(), _createElementBlock(\"button\", {\n                                        key: 2,\n                                        class: \"clear-button\",\n                                        onClick: _cache[10] || (_cache[10] =\n                                            //@ts-ignore\n                                            (...args) => (_ctx.clearCommands && _ctx.clearCommands(...args)))\n                                    }, \"\"))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ])\n                ])\n            ]))\n            : _createCommentVNode(\"v-if\", true),\n        _createVNode(_component_NotificationContainer)\n    ], 2 /* CLASS */));\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"action-panel\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ActionPanel',\n    props: {\n        commandCount: {}\n    },\n    emits: ['open-main-menu', 'open-avatar-menu', 'toggle-history', 'toggle-commands'],\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"button\", {\n                    class: \"action-button\",\n                    onClick: _cache[0] || (_cache[0] = ($event) => (_ctx.$emit('open-main-menu')))\n                }, \"\"),\n                _createElementVNode(\"button\", {\n                    class: \"action-button\",\n                    onClick: _cache[1] || (_cache[1] = ($event) => (_ctx.$emit('open-avatar-menu')))\n                }, \"\"),\n                _createElementVNode(\"button\", {\n                    class: \"action-button\",\n                    onClick: _cache[2] || (_cache[2] = ($event) => (_ctx.$emit('toggle-history')))\n                }, \"\"),\n                _createElementVNode(\"button\", {\n                    class: \"action-button\",\n                    onClick: _cache[3] || (_cache[3] = ($event) => (_ctx.$emit('toggle-commands')))\n                }, \" (\" + _toDisplayString(__props.commandCount) + \")\", 1 /* TEXT */)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ActionPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ActionPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ActionPanel.vue?vue&type=style&index=0&id=1d38e3f0&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1d38e3f0\"]])\n\nexport default __exports__","type CommandListener = (commands: string[]) => void;\n\nclass CommandService {\n  private commands: string[] = [];\n  private listeners: CommandListener[] = [];\n\n  subscribe(listener: CommandListener) {\n    this.listeners.push(listener);\n  }\n\n  unsubscribe(listener: CommandListener) {\n    this.listeners = this.listeners.filter(l => l !== listener);\n  }\n\n  private notify() {\n    this.listeners.forEach(listener => listener([...this.commands]));\n  }\n\n  addCommand(command: string) {\n    this.commands.push(command);\n    this.notify();\n  }\n\n  getCommands(): string[] {\n    return [...this.commands];\n  }\n\n  clearCommands() {\n    this.commands = [];\n    this.notify();\n  }\n}\n\nexport const commandService = new CommandService();\n","import { reactive } from 'vue';\n\nconst MAX_RECENT_HISTORY = 5;\nconst MAX_SAVED_HISTORY = 5;\nconst STORAGE_KEY_RECENT = 'reincarnation_input_history_recent';\nconst STORAGE_KEY_SAVED = 'reincarnation_input_history_saved';\n\nclass InputHistoryService {\n  public state = reactive({\n    recent: [] as string[],\n    saved: [] as string[],\n  });\n\n  constructor() {\n    this.loadHistory();\n  }\n\n  private loadHistory() {\n    const recentData = localStorage.getItem(STORAGE_KEY_RECENT);\n    const savedData = localStorage.getItem(STORAGE_KEY_SAVED);\n    if (recentData) {\n      this.state.recent = JSON.parse(recentData);\n    }\n    if (savedData) {\n      this.state.saved = JSON.parse(savedData);\n    }\n  }\n\n  private saveHistory() {\n    localStorage.setItem(STORAGE_KEY_RECENT, JSON.stringify(this.state.recent));\n    localStorage.setItem(STORAGE_KEY_SAVED, JSON.stringify(this.state.saved));\n  }\n\n  add(input: string) {\n    if (!input || input.trim() === '') {\n      return;\n    }\n    // Avoid duplicates\n    const existingIndex = this.state.recent.indexOf(input);\n    if (existingIndex > -1) {\n      this.state.recent.splice(existingIndex, 1);\n    }\n\n    this.state.recent.unshift(input);\n    if (this.state.recent.length > MAX_RECENT_HISTORY) {\n      this.state.recent.pop();\n    }\n    this.saveHistory();\n  }\n\n  save(entry: string) {\n    if (this.state.saved.includes(entry)) {\n      return;\n    }\n\n    this.state.saved.unshift(entry);\n    if (this.state.saved.length > MAX_SAVED_HISTORY) {\n      this.state.saved.pop();\n    }\n    this.saveHistory();\n  }\n\n  deleteRecent(index: number) {\n    this.state.recent.splice(index, 1);\n    this.saveHistory();\n  }\n\n  deleteSaved(index: number) {\n    this.state.saved.splice(index, 1);\n    this.saveHistory();\n  }\n\n  clearAll() {\n    this.state.recent = [];\n    this.state.saved = [];\n    this.saveHistory();\n  }\n}\n\nexport const inputHistoryService = new InputHistoryService();\n","const __WEBPACK_NAMESPACE_OBJECT__ = _;","import type { WorldDefinition } from '../../../types/world';\n\n/**\n * A robust, non-regex based parser for the custom YAML-like format.\n */\nexport function parseWorldLoreForMap(text: string): WorldDefinition | null {\n  if (!text) {\n    console.warn('[WorldMapParser] Received empty or null lore content.');\n    return null;\n  }\n\n  const automationRuleMarker = ':';\n  const startIndex = text.indexOf(automationRuleMarker);\n  if (startIndex === -1) {\n    console.error('[WorldMapParser] \":\" block not found in the lorebook entry.');\n    return null;\n  }\n\n  const yamlText = text.substring(startIndex);\n  const lines = yamlText.split('\\n').slice(1); // Skip the \":\" line\n\n  const root = {};\n  const stack: { level: number; obj: any }[] = [{ level: -1, obj: root }];\n\n  for (const line of lines) {\n    if (line.trim() === '') continue;\n\n    const indentMatch = line.match(/^\\s*/);\n    const indent = indentMatch ? indentMatch[0].length : 0;\n    const trimmedLine = line.trim();\n\n    while (stack.length > 1 && indent <= stack[stack.length - 1].level) {\n      stack.pop();\n    }\n\n    let parentObj = stack[stack.length - 1].obj;\n\n    if (trimmedLine.startsWith('- ')) {\n      const listItemContent = trimmedLine.substring(2).trim();\n\n      if (!Array.isArray(parentObj)) {\n        const grandParent = stack[stack.length - 2].obj;\n        const lastKey = Object.keys(grandParent).pop();\n        if (lastKey && grandParent[lastKey] === parentObj) {\n          parentObj = [];\n          grandParent[lastKey] = parentObj;\n          stack[stack.length - 1].obj = parentObj;\n        } else {\n          continue;\n        }\n      }\n\n      const separatorIndex = listItemContent.indexOf(':');\n      if (separatorIndex === -1) {\n        parentObj.push(parseValue(listItemContent));\n      } else {\n        const newListItem = {};\n        parentObj.push(newListItem);\n        stack.push({ level: indent, obj: newListItem });\n        processKeyValue(listItemContent, newListItem, indent, stack);\n      }\n    } else {\n      processKeyValue(trimmedLine, parentObj, indent, stack);\n    }\n  }\n\n  return root as WorldDefinition;\n}\n\nfunction processKeyValue(line: string, parent: any, indent: number, stack: any[]) {\n  const separatorIndex = line.indexOf(':');\n  if (separatorIndex > -1) {\n    const key = line.substring(0, separatorIndex).trim();\n    const valueStr = line.substring(separatorIndex + 1).trim();\n\n    if (valueStr === '') {\n      const newChild = {};\n      parent[key] = newChild;\n      stack.push({ level: indent, obj: newChild });\n    } else if (valueStr.startsWith('{') && valueStr.endsWith('}')) {\n      const newObj = {};\n      parent[key] = newObj;\n      const objContent = valueStr.slice(1, -1).trim();\n      const pairs = objContent.split(',').map(p => p.trim());\n      for (const pair of pairs) {\n        processKeyValue(pair, newObj, indent + 2, stack);\n      }\n    } else {\n      parent[key] = parseValue(valueStr);\n    }\n  }\n}\n\nfunction parseValue(value: string): any {\n  const trimmed = value.trim();\n\n  if (trimmed.startsWith('\"') && trimmed.endsWith('\"')) {\n    const inner = trimmed.slice(1, -1);\n    if (inner.startsWith('[') && inner.endsWith(']')) {\n      return parseValue(inner);\n    }\n    return inner;\n  }\n\n  if (trimmed.startsWith('[') && trimmed.endsWith(']')) {\n    try {\n      const content = trimmed.slice(1, -1).trim();\n      const parts = [];\n      let buffer = '';\n      let inQuotes = false;\n      let bracketLevel = 0;\n\n      for (let i = 0; i < content.length; i++) {\n        const char = content[i];\n        if (char === \"'\" || char === '\"') {\n          inQuotes = !inQuotes;\n        }\n        if (!inQuotes) {\n          if (char === '[') bracketLevel++;\n          if (char === ']') bracketLevel--;\n          if (char === ',' && bracketLevel === 0) {\n            parts.push(buffer.trim());\n            buffer = '';\n            continue;\n          }\n        }\n        buffer += char;\n      }\n      if (buffer) {\n        parts.push(buffer.trim());\n      }\n\n      return parts.map(part => parseValue(part));\n    } catch (e) {\n      // Fallback\n    }\n  }\n\n  if (trimmed.toLowerCase() === 'true') return true;\n  if (trimmed.toLowerCase() === 'false') return false;\n  if (trimmed === 'null') return null;\n  if (trimmed !== '' && !isNaN(Number(trimmed)) && !trimmed.includes('x')) {\n    return Number(trimmed);\n  }\n\n  return trimmed;\n}\n","//  TavernHelper API\ndeclare const TavernHelper: any;\n\nconst LOREBOOK_NAME = '-';\nlet entriesCache: any[] | null = null;\n\nasync function getEntries(forceRefresh = false) {\n  if (entriesCache && !forceRefresh) {\n    return entriesCache;\n  }\n  try {\n    const entries = await TavernHelper.getLorebookEntries(LOREBOOK_NAME);\n    if (!entries) {\n      console.error(`[LorebookService]  \"${LOREBOOK_NAME}\" `);\n      entriesCache = null;\n      return null;\n    }\n    entriesCache = entries;\n    return entries;\n  } catch (error) {\n    console.error(`[LorebookService]  getLorebookEntries :`, error);\n    return null;\n  }\n}\n\nfunction findEntryByComment(comment: string): any | null {\n  if (!entriesCache) {\n    console.warn('[LorebookService] findEntryByComment called before cache was populated.');\n    return null;\n  }\n  return entriesCache.find((e: any) => e.comment === comment) || null;\n}\n\nasync function readFromLorebook(entryName: string, forceRefresh = false): Promise<string | null> {\n  const entries = await getEntries(forceRefresh);\n  if (!entries) return null;\n  const entry = entries.find((e: any) => e.comment === entryName || e.name === entryName);\n  return entry ? entry.content : null;\n}\n\nasync function writeToLorebook(\n  entryName: string,\n  content: string,\n  options: { isEnabled: boolean; keys: string[] } = { isEnabled: true, keys: [] },\n) {\n  console.log(`[Roo Debug] Lorebook: Preparing to write/create entry: \"${entryName}\".`);\n  const allEntries = await getEntries();\n  if (!allEntries) return;\n\n  const targetEntry = allEntries.find((e: any) => e.comment === entryName || e.name === entryName);\n\n  try {\n    if (targetEntry) {\n      // ---  ---\n      console.log(`[Roo Debug] Lorebook: Entry \"${entryName}\" exists. Updating with setLorebookEntries.`);\n      await TavernHelper.setLorebookEntries(LOREBOOK_NAME, [\n        { uid: targetEntry.uid, content: content, enabled: options.isEnabled },\n      ]);\n    } else {\n      // ---  ( UpdateVariable5.html) ---\n      console.log(`[Roo Debug] Lorebook: Entry \"${entryName}\" does not exist. Creating with createLorebookEntries.`);\n\n      const baseKey = entryName.replace(/\\(\\d+\\)$/, '');\n      const baseEntryTemplate = allEntries.find((entry: any) => entry.comment === baseKey || entry.name === baseKey);\n\n      // \n      const newEntryData: any = {\n        comment: entryName,\n        content: content,\n        keys: [entryName],\n        enabled: options.isEnabled,\n        position: 'before_character_definition',\n        order: 100,\n      };\n\n      // \n      if (baseEntryTemplate) {\n        Object.assign(newEntryData, {\n          keys: [...(baseEntryTemplate.keys || []), entryName],\n          selective: baseEntryTemplate.selective,\n          constant: baseEntryTemplate.constant,\n          position: baseEntryTemplate.position,\n          order: baseEntryTemplate.order,\n          case_sensitive: baseEntryTemplate.case_sensitive,\n        });\n      }\n\n      console.log(\n        `[Roo Debug] Lorebook: Calling createLorebookEntries for \"${entryName}\" with payload:`,\n        JSON.stringify(newEntryData),\n      );\n      await TavernHelper.createLorebookEntries(LOREBOOK_NAME, [newEntryData]);\n    }\n    console.log(`[LorebookService] API call for \"${entryName}\" completed successfully.`);\n    entriesCache = null; // \n  } catch (error) {\n    console.error(`[LorebookService]  \"${entryName}\" :`, error);\n  }\n}\n\nasync function appendToEntry(entryName: string, newContent: string, separator = '\\n\\n---\\n\\n'): Promise<void> {\n  console.log(`[Roo Debug] Lorebook: Appending to entry \"${entryName}\".`);\n  try {\n    const existingContent = await readFromLorebook(entryName);\n    const content = existingContent ? `${existingContent}${separator}${newContent}` : newContent;\n    // `writeToLorebook` \n    await writeToLorebook(entryName, content);\n  } catch (error) {\n    console.error(`[LorebookService]  \"${entryName}\" :`, error);\n  }\n}\n\nimport { parseWorldLoreForMap } from '../modules/world-map/services/WorldMapParser';\nimport type { WorldDefinition, Epoch } from '../types/world';\n\nasync function loadAndParseWorldData(worldName = ''): Promise<Epoch | null> {\n  try {\n    const content = await readFromLorebook(worldName);\n    if (!content) {\n      console.warn(`[LorebookService]  \"${worldName}\" `);\n      return null;\n    }\n\n    const worldData = parseWorldLoreForMap(content) as WorldDefinition | null;\n\n    if (worldData && worldData. && worldData.) {\n      // ID\n      const currentEpochId = worldData..ID;\n      if (currentEpochId && worldData.[currentEpochId]) {\n        return worldData.[currentEpochId];\n      }\n      // \n      const firstPlayableEpoch = Object.values(worldData.).find(epoch => epoch.);\n      if (firstPlayableEpoch) {\n        return firstPlayableEpoch;\n      }\n    }\n\n    console.warn(`[LorebookService]  \"${worldName}\" `);\n    return null;\n  } catch (error) {\n    console.error(`[LorebookService]  \"${worldName}\" :`, error);\n    return null;\n  }\n}\n\nexport const lorebookService = {\n  getEntries,\n  readFromLorebook,\n  writeToLorebook,\n  appendToEntry,\n  findEntryByComment,\n  setEntryEnabled,\n  loadAndParseWorldData, // \n};\n\nasync function setEntryEnabled(entryName: string, isEnabled: boolean): Promise<void> {\n  console.log(`[LorebookService] Setting entry \"${entryName}\" enabled status to: ${isEnabled}`);\n  try {\n    const allEntries = await getEntries();\n    if (!allEntries) return;\n\n    const targetEntry = allEntries.find((e: any) => e.comment === entryName || e.name === entryName);\n\n    if (targetEntry) {\n      // [PATCH] \n      const updatedEntry = { ...targetEntry, enabled: isEnabled };\n      await TavernHelper.setLorebookEntries(LOREBOOK_NAME, [updatedEntry]);\n      console.log(`[LorebookService] Successfully set \"${entryName}\" enabled=${isEnabled}.`);\n    } else {\n      // \n      console.warn(`[LorebookService] setEntryEnabled: Entry \"${entryName}\" not found. Skipping.`);\n    }\n  } catch (error) {\n    console.error(`[LorebookService]  \"${entryName}\" :`, error);\n  }\n}\n","import { lorebookService } from './LorebookService';\nimport type { WorldLogEntry } from '../types';\n\nclass MemoryService {\n  private readonly INSTANT_MEMORY_KEY = '[]';\n  private readonly SHORT_TERM_MEMORY_KEY = '[]';\n  private readonly LONG_TERM_MEMORY_KEY = '[]';\n\n  // \n  private config = {\n    instantMemoryCount: 15,\n    shortTermMemoryCount: 30, // \n    longTermMemoryCount: 60, // \n  };\n\n  /**\n   * \n   */\n  public async updateMemory(worldLog: WorldLogEntry[]): Promise<void> {\n    console.log('[MemoryService] Updating all memory tiers...');\n    try {\n      // \n      await this.updateInstantMemory(worldLog);\n      await this.updateShortTermMemory(worldLog);\n      await this.updateLongTermMemory(worldLog);\n      console.log('[MemoryService] All memory tiers updated successfully.');\n    } catch (error) {\n      console.error('[MemoryService] Failed to update memory tiers:', error);\n    }\n  }\n\n  /**\n   *  ()\n   */\n  private async updateInstantMemory(worldLog: WorldLogEntry[]): Promise<void> {\n    const logs = worldLog.slice(-this.config.instantMemoryCount);\n    if (logs.length === 0) {\n      await this.writeMemory(this.INSTANT_MEMORY_KEY, '');\n      return;\n    }\n\n    const content = logs\n      .map(log => {\n        //  key|value \n        return [\n          `|${log.}`,\n          `|${log.}`,\n          `|${log.}`,\n          `|${log.}`,\n          `|${log.}`,\n          `|${log.}`,\n          `|${log.}`,\n          `|${Array.isArray(log.) ? log..join(', ') : log.}`,\n          `|${log.}`,\n          `|${log.}`,\n          `|${log.}`,\n        ].join('\\n');\n      })\n      .join('\\n\\n---\\n\\n');\n\n    await this.writeMemory(this.INSTANT_MEMORY_KEY, content.trim());\n  }\n\n  /**\n   *  ()\n   */\n  private async updateShortTermMemory(worldLog: WorldLogEntry[]): Promise<void> {\n    const logs = worldLog.slice(-this.config.shortTermMemoryCount);\n    if (logs.length === 0) {\n      await this.writeMemory(this.SHORT_TERM_MEMORY_KEY, '');\n      return;\n    }\n\n    const content = logs\n      .map(log => {\n        // key|value\n        return [\n          `|${log.}`,\n          `|${log.}`,\n          `|${log.}`,\n          `|${log.}`,\n          `|${log.}`,\n        ].join('\\n');\n      })\n      .join('\\n\\n---\\n\\n');\n\n    await this.writeMemory(this.SHORT_TERM_MEMORY_KEY, content.trim());\n  }\n\n  /**\n   *  ()\n   */\n  private async updateLongTermMemory(worldLog: WorldLogEntry[]): Promise<void> {\n    const logs = worldLog.slice(-this.config.longTermMemoryCount);\n    if (logs.length === 0) {\n      await this.writeMemory(this.LONG_TERM_MEMORY_KEY, '');\n      return;\n    }\n\n    const content = logs.map(log => `[${log.}] ${log.}: ${log.}`).join('\\n');\n\n    await this.writeMemory(this.LONG_TERM_MEMORY_KEY, content);\n  }\n\n  /**\n   * \n   * @param key \n   * @param content \n   */\n  private async writeMemory(key: string, content: string): Promise<void> {\n    await lorebookService.writeToLorebook(key, content, {\n      isEnabled: true,\n      keys: [key],\n    });\n  }\n\n  public getConfig() {\n    return this.config;\n  }\n\n  public setConfig(newConfig: Partial<typeof this.config>) {\n    this.config = { ...this.config, ...newConfig };\n    // localStorage\n    console.log('[MemoryService] Config updated:', this.config);\n  }\n}\n\nexport const memoryService = new MemoryService();\n","import { reactive } from 'vue';\n\nexport type NotificationType = 'info' | 'success' | 'warning' | 'error';\n\nexport interface Notification {\n  id: number;\n  title: string;\n  message: string;\n  type: NotificationType;\n}\n\nconst state = reactive({\n  notifications: [] as Notification[],\n});\n\nlet nextId = 0;\n\nconst actions = {\n  show(title: string, message: string, type: NotificationType = 'info', duration: number = 4000) {\n    const id = nextId++;\n    state.notifications.push({ id, title, message, type });\n\n    if (duration > 0) {\n      setTimeout(() => {\n        this.hide(id);\n      }, duration);\n    }\n  },\n\n  hide(id: number) {\n    const index = state.notifications.findIndex(n => n.id === id);\n    if (index !== -1) {\n      state.notifications.splice(index, 1);\n    }\n  },\n\n  success(title: string, message: string, duration: number = 4000) {\n    this.show(title, message, 'success', duration);\n  },\n\n  info(title: string, message: string, duration: number = 4000) {\n    this.show(title, message, 'info', duration);\n  },\n\n  warn(title: string, message: string, duration: number = 5000) {\n    this.show(title, message, 'warning', duration);\n  },\n\n  error(title: string, message: string, duration: number = 7000) {\n    this.show(title, message, 'error', duration);\n  },\n};\n\nexport const notificationState = state;\nexport const notificationService = actions;\n","// API\ndeclare const TavernHelper: any;\ndeclare const eventEmit: any;\ndeclare const getChatMessages: (id: string) => Promise<any[]>;\ndeclare const getCurrentMessageId: () => string;\n\nclass TavernService {\n  /**\n   * Tavern\n   */\n  async fetchTavernData() {\n    console.log('Fetching data from Tavern...');\n    const messages = await getChatMessages(getCurrentMessageId());\n    console.log('Messages received:', messages);\n    return messages;\n  }\n\n  /**\n   * AI\n   * @param prompt - AI\n   */\n  async generateAiResponse(prompt: string): Promise<string> {\n    const generateConfig = {\n      injects: [{ role: 'user', content: prompt, position: 'in_chat', should_scan: true }],\n      should_stream: false,\n    };\n    const aiResponse = await TavernHelper.generate(generateConfig);\n    if (typeof aiResponse !== 'string') {\n      throw new Error('AI');\n    }\n    return aiResponse;\n  }\n\n  /**\n   * MVU\n   * @param script - MVU\n   * @param oldVariables - \n   */\n  async invokeMvuScript(script: string, oldVariables: any): Promise<any> {\n    const inputData: any = { old_variables: oldVariables };\n\n    // --- Start of AI Script Fix ---\n    let processedScript = script.replace(/|/g, \"'\"); // Fix invalid quotes\n\n    const creationLine = /_.assign\\('', '(.+?)', {}\\);/g;\n    const match = creationLine.exec(processedScript);\n\n    if (match) {\n      const charName = match[1];\n      const setLines = new RegExp(`_.set\\\\('\\\\\\\\.${charName}\\\\\\\\.([^']*)', (.*?)\\\\);`, 'g');\n\n      let userObjectString = `let user = {};\\n`;\n      let lineMatch;\n      while ((lineMatch = setLines.exec(processedScript)) !== null) {\n        const prop = lineMatch[1];\n        const value = lineMatch[2];\n        userObjectString += `user['${prop}'] = ${value};\\n`;\n      }\n      userObjectString += `_.assign('', '${charName}', user);`;\n\n      processedScript = processedScript.replace(creationLine, '');\n      processedScript = processedScript.replace(setLines, '');\n      processedScript += `\\n${userObjectString}`;\n    }\n    // --- End of AI Script Fix ---\n\n    await eventEmit('mag_invoke_mvu', processedScript, inputData);\n    return inputData.new_variables;\n  }\n}\n\nexport const tavernService = new TavernService();\n","import { lorebookService } from './LorebookService';\n\n// \nexport type WorkflowState = 'NORMAL' | 'CREATION' | 'IDENTITY';\n\n// CoT\n// \nconst COT_FILES: Record<WorkflowState, string[]> = {\n  NORMAL: ['cotcot'],\n  CREATION: ['cotcot'],\n  IDENTITY: ['cotcot'],\n};\n\nclass WorkflowService {\n  private currentState: WorkflowState = 'NORMAL';\n  private narrativeCache: string | null = null; //  <gametxt>\n  private updateScriptCache: string | null = null; //  <UpdateVariable>\n  private preserveMode: 'none' | 'gametxt' | 'full' = 'none';\n\n  constructor() {\n    // CoT\n    this.switchTo('NORMAL');\n  }\n\n  /**\n   * \n   */\n  public getCurrentState(): WorkflowState {\n    return this.currentState;\n  }\n\n  /**\n   * CoT/\n   * @param newState \n   */\n  public async switchTo(newState: WorkflowState, force: boolean = false) {\n    if (this.currentState === newState && !force) {\n      return; // \n    }\n\n    console.log(`[WorkflowService] Switching from ${this.currentState} to ${newState} (Forced: ${force})`);\n\n    const allCots = Object.values(COT_FILES).flat();\n    const cotsToEnable = COT_FILES[newState];\n\n    // CoT\n    for (const cotName of allCots) {\n      const shouldBeEnabled = cotsToEnable.includes(cotName);\n      await lorebookService.setEntryEnabled(cotName, shouldBeEnabled);\n    }\n\n    this.currentState = newState;\n    console.log(`[WorkflowService] Switched to ${newState}. Enabled CoTs: ${cotsToEnable.join(', ')}`);\n  }\n\n  /**\n   * \n   * @param narrative  <gametxt> \n   */\n  public cacheNarrative(narrative: string) {\n    this.narrativeCache = narrative;\n    console.log('[WorkflowService] Narrative cached.');\n  }\n\n  /**\n   * \n   * @returns  <gametxt>  null\n   */\n  public popNarrative(): string | null {\n    const narrative = this.narrativeCache;\n    this.narrativeCache = null;\n    if (narrative) {\n      console.log('[WorkflowService] Popped cached narrative.');\n    }\n    return narrative;\n  }\n\n  /**\n   * \n   */\n  public cacheUpdateScript(script: string) {\n    this.updateScriptCache = script;\n    console.log('[WorkflowService] Update script cached.');\n  }\n\n  /**\n   * \n   */\n  public popUpdateScript(): string | null {\n    const script = this.updateScriptCache;\n    this.updateScriptCache = null;\n    if (script) {\n      console.log('[WorkflowService] Popped cached update script.');\n    }\n    return script;\n  }\n\n  /**\n   * AI\n   * @param mode 'gametxt' , 'full' \n   */\n  public setPreserveMode(mode: 'none' | 'gametxt' | 'full') {\n    this.preserveMode = mode;\n    console.log(`[WorkflowService] Preserve mode set to: ${mode}`);\n  }\n\n  /**\n   * \n   * @returns \n   */\n  public popPreservedContent(): string {\n    let content = '';\n\n    if (this.preserveMode === 'gametxt' || this.preserveMode === 'full') {\n      if (this.narrativeCache) {\n        content += `\\n<gametxt>${this.narrativeCache}</gametxt>`;\n        console.log('[WorkflowService] Popped cached narrative for appending.');\n      }\n    }\n\n    if (this.preserveMode === 'full') {\n      if (this.updateScriptCache) {\n        content += `\\n<UpdateVariable>${this.updateScriptCache}</UpdateVariable>`;\n        console.log('[WorkflowService] Popped cached update script for appending.');\n      }\n    }\n\n    // \n    this.narrativeCache = null;\n    this.updateScriptCache = null;\n    this.preserveMode = 'none';\n\n    if (content) {\n      console.log('[WorkflowService] Final content to append length:', content.length);\n    }\n\n    return content;\n  }\n}\n\nexport const workflowService = new WorkflowService();\n","import { lorebookService } from './LorebookService';\n\n/**\n * @file worldbookUpdater.ts\n * @description (V3 - Smart Indent Text-based) AI\n * 100%AI\n */\n\n/**\n * \n */\nfunction getIndent(line: string): number {\n  const match = line.match(/^\\s*/);\n  return match ? match[0].length : 0;\n}\n\n/**\n * \n */\nfunction findBlockEnd(lines: string[], startIndex: number, indent: number): number {\n  for (let i = startIndex + 1; i < lines.length; i++) {\n    const line = lines[i];\n    if (line.trim() !== '' && getIndent(line) <= indent) {\n      return i;\n    }\n  }\n  return lines.length;\n}\n\n/**\n * \n * YAML\n */\nfunction findPathRange(\n  lines: string[],\n  path: string,\n): { startIndex: number; endIndex: number; parentIndent: number } | null {\n  const pathParts = path.split('.');\n  let searchLines = lines;\n  let overallOffset = 0;\n  let lastFoundIndex = -1;\n  let lastIndent = -1;\n\n  for (const part of pathParts) {\n    // FIX: Use /([^\\[]+)/ to support Unicode characters in array names.\n    const arrayMatch = part.match(/([^[]+)\\[(.+?)=(.+?)\\]/);\n    let foundInContext = false;\n\n    if (arrayMatch) {\n      const [, arrayName, key, value] = arrayMatch;\n\n      // 1. Find the array's parent block (e.g., ':')\n      const arrayNameRegex = new RegExp(`^\\\\s*${arrayName.trim()}:`);\n      let arrayNameFound = false;\n      for (let i = 0; i < searchLines.length; i++) {\n        const line = searchLines[i];\n        const currentIndent = getIndent(line);\n        if (currentIndent > lastIndent && arrayNameRegex.test(line)) {\n          lastIndent = currentIndent;\n          lastFoundIndex = overallOffset + i;\n          const blockEndIndex = findBlockEnd(lines, lastFoundIndex, lastIndent);\n          overallOffset = lastFoundIndex + 1;\n          searchLines = lines.slice(overallOffset, blockEndIndex);\n          arrayNameFound = true;\n          break;\n        }\n      }\n      if (!arrayNameFound) return null;\n\n      // 2. Now, within this block, find the correct list item\n      let itemFound = false;\n      for (let j = 0; j < searchLines.length; j++) {\n        const line = searchLines[j];\n        if (line.trim().startsWith('-')) {\n          const itemStartIndex = overallOffset + j;\n          const itemIndent = getIndent(line);\n          const itemEndIndex = findBlockEnd(lines, itemStartIndex, itemIndent);\n\n          // Search for the key-value pair within this specific item's block\n          for (let k = itemStartIndex; k < itemEndIndex; k++) {\n            const lineInItem = lines[k];\n            // Handle key on same line as '-' or on subsequent lines\n            const testLine = k === itemStartIndex ? lineInItem.replace(/^\\s*-\\s*/, '  ') : lineInItem;\n            const keyRegex = new RegExp(`^\\\\s*${key.trim()}:\\\\s*['\"]?${value.trim()}['\"]?`);\n\n            if (keyRegex.test(testLine)) {\n              // Found the matching item, update context for the next path part\n              lastFoundIndex = itemStartIndex;\n              lastIndent = itemIndent;\n              overallOffset = itemStartIndex + 1;\n              searchLines = lines.slice(overallOffset, itemEndIndex);\n              itemFound = true;\n              break;\n            }\n          }\n        }\n        if (itemFound) break;\n      }\n      foundInContext = itemFound;\n      if (!foundInContext) return null;\n    } else {\n      const partRegex = new RegExp(`^\\\\s*${part.trim()}:`);\n      for (let i = 0; i < searchLines.length; i++) {\n        const line = searchLines[i];\n        const currentIndent = getIndent(line);\n\n        if (currentIndent > lastIndent && partRegex.test(line)) {\n          lastIndent = currentIndent;\n          lastFoundIndex = overallOffset + i;\n          const blockEndIndex = findBlockEnd(lines, lastFoundIndex, lastIndent);\n          overallOffset = lastFoundIndex + 1;\n          searchLines = lines.slice(overallOffset, blockEndIndex);\n          foundInContext = true;\n          break;\n        }\n      }\n      if (!foundInContext) return null;\n    }\n  }\n\n  if (lastFoundIndex !== -1) {\n    const endIndex = findBlockEnd(lines, lastFoundIndex, lastIndent);\n    return { startIndex: lastFoundIndex, endIndex, parentIndent: lastIndent };\n  }\n\n  return null;\n}\n\n/**\n * () \n */\nfunction applyAdd(lines: string[], path: string, contentToAdd: string): string[] {\n  const range = findPathRange(lines, path);\n\n  if (!range) {\n    console.error(`[WorldUpdateService] ADD: : ${path}`);\n    return lines;\n  }\n\n  const { endIndex, parentIndent } = range;\n  const contentLines = contentToAdd.split('\\n');\n  if (contentLines.length === 0) return lines;\n\n  // \n  //  `-` +2\n  const targetItemIndent = parentIndent + 2;\n\n  // \n  const firstLineIndex = contentLines.findIndex(l => l.trim() !== '');\n  if (firstLineIndex === -1) return lines; // \n  const contentBaseIndent = getIndent(contentLines[firstLineIndex]);\n\n  // \n  const indentShift = targetItemIndent - contentBaseIndent;\n\n  // \n  const newLines = contentLines.map(line => {\n    if (line.trim() === '') return line; // \n    const originalIndent = getIndent(line);\n    const newIndent = Math.max(0, originalIndent + indentShift);\n    return ' '.repeat(newIndent) + line.trimStart();\n  });\n\n  // \n  lines.splice(endIndex, 0, ...newLines);\n  console.log(`[WorldUpdateService] : ${path}`);\n  return lines;\n}\n\nfunction applyReplace(lines: string[], path: string, newContent: string): string[] {\n  const range = findPathRange(lines, path);\n  if (!range) {\n    console.error(`[WorldUpdateService] REPLACE: : ${path}`);\n    return lines;\n  }\n  const { startIndex, endIndex, parentIndent } = range;\n  const contentIndent = parentIndent + 2;\n\n  const contentLines = newContent.split('\\n').map(line => ' '.repeat(contentIndent) + line);\n\n  lines.splice(startIndex + 1, endIndex - (startIndex + 1), ...contentLines);\n  console.log(`[WorldUpdateService] : ${path}`);\n  return lines;\n}\n\nfunction applyRemove(lines: string[], path: string, contentToRemove: string): string[] {\n  const range = findPathRange(lines, path);\n  if (!range) {\n    console.error(`[WorldUpdateService] REMOVE: : ${path}`);\n    return lines;\n  }\n  const { startIndex, endIndex } = range;\n\n  const contentToRemoveLines = contentToRemove\n    .trim()\n    .split('\\n')\n    .map(l => l.trim());\n  const blockToSearchIn = lines.slice(startIndex + 1, endIndex);\n\n  let foundIndexInBlock = -1;\n\n  for (let i = 0; i <= blockToSearchIn.length - contentToRemoveLines.length; i++) {\n    let isMatch = true;\n    for (let j = 0; j < contentToRemoveLines.length; j++) {\n      if (blockToSearchIn[i + j].trim() !== contentToRemoveLines[j]) {\n        isMatch = false;\n        break;\n      }\n    }\n    if (isMatch) {\n      foundIndexInBlock = i;\n      break;\n    }\n  }\n\n  if (foundIndexInBlock !== -1) {\n    const removeStartIndex = startIndex + 1 + foundIndexInBlock;\n    lines.splice(removeStartIndex, contentToRemoveLines.length);\n    console.log(`[WorldUpdateService] : ${path}`);\n  } else {\n    console.warn(`[WorldUpdateService] REMOVE:  \"${path}\" `);\n  }\n  return lines;\n}\n\nclass WorldUpdateService {\n  public async applyModifications(modificationBlock: string, targetEntryName: string): Promise<void> {\n    if (!modificationBlock || !targetEntryName) {\n      return;\n    }\n\n    const currentContent = await lorebookService.readFromLorebook(targetEntryName);\n    if (currentContent === null) {\n      console.error(`[WorldUpdateService] : \"${targetEntryName}\"`);\n      return;\n    }\n\n    let lines = currentContent.split('\\n');\n    const originalContent = currentContent;\n\n    const instructions = modificationBlock\n      .split(/(?=\\n(?: ')|(?=\\n(?:  '))|(?=\\n(?: '))|^ '|^  '|^ ')/g)\n      .filter(s => s.trim());\n\n    for (const instruction of instructions) {\n      const trimmedInstruction = instruction.trim();\n      const addMatch = trimmedInstruction.match(/^  '([^']*)' :\\s*([\\s\\S]*)/);\n      const replaceMatch = trimmedInstruction.match(/^ '([^']*)' :\\s*([\\s\\S]*)/);\n      const removeMatch = trimmedInstruction.match(/^ '([^']*)' :\\s*([\\s\\S]*)/);\n\n      if (addMatch) {\n        const [, path, content] = addMatch;\n        const idMatch = content.match(/ID:\\s*(\\S+)/);\n        if (idMatch) {\n          const id = idMatch[1];\n          const idCheckPattern = new RegExp(`ID:\\\\s*${id}`);\n          if (idCheckPattern.test(originalContent)) {\n            console.warn(`[WorldUpdateService] ID \"${id}\"  ADD `);\n            continue;\n          }\n        }\n        lines = applyAdd(lines, path, content);\n      } else if (replaceMatch) {\n        const [, path, content] = replaceMatch;\n        lines = applyReplace(lines, path, content);\n      } else if (removeMatch) {\n        const [, path, content] = removeMatch;\n        lines = applyRemove(lines, path, content);\n      }\n    }\n\n    const updatedContent = lines.join('\\n');\n\n    if (updatedContent.trim() !== originalContent.trim()) {\n      console.log(`[WorldUpdateService] : \"${targetEntryName}\"`);\n      await lorebookService.writeToLorebook(targetEntryName, updatedContent);\n    } else {\n      console.log(`[WorldUpdateService] `);\n    }\n  }\n}\n\nexport const worldUpdateService = new WorldUpdateService();\n","const __WEBPACK_NAMESPACE_OBJECT__ = z;","import { z } from 'zod';\n\n/**\n * @file  Zod  Schema\n * \n * @version 1.0 -  [InitVar].txt V8.0  .yaml v4.x\n */\n\n// ---  Schema ---\n\nconst nonEmptyString = z.string().min(1);\n\nconst MetaSchema = z.object({\n  description: z.string().optional(),\n  extensible: z.boolean().optional(),\n});\n\nconst EffectBonusSchema = z.record(z.string(), z.union([z.coerce.number(), z.string()]));\n\nconst EffectsSchema = z.object({\n  attributes_bonus: EffectBonusSchema.optional(),\n  percentage_bonus: EffectBonusSchema.optional(),\n});\n\nconst TimeDurationSchema = z.object({\n  : z.coerce.number().prefault(0),\n  : z.coerce.number().prefault(0),\n  : z.coerce.number().prefault(0),\n  : z.coerce.number().prefault(0),\n  : z.coerce.number().prefault(0),\n});\n\nconst DatabaseItemSchema = z.object({\n  : nonEmptyString,\n  : nonEmptyString,\n  : z.coerce.number().prefault(0),\n  : z.string(),\n  : z.string().optional(),\n  : TimeDurationSchema.optional(),\n  effects: EffectsSchema.optional(),\n  : z.array(z.string()).optional(),\n  ID: z.string().optional(),\n});\n\nconst ActiveSkillSchema = z.object({\n  ID: nonEmptyString,\n  : nonEmptyString,\n  : z.string(),\n  : z.string(),\n  : z.string(),\n  : z.string(),\n  : z.string(),\n});\n\nconst ArtisanSkillSchema = z.object({\n  ID: nonEmptyString,\n  : nonEmptyString,\n  : z.string(),\n  : z.string(),\n  : z.coerce.number().prefault(0),\n  : z.string().optional(),\n  : z.string().optional(),\n  : z.array(\n    z.object({\n      : z.coerce.number().prefault(0),\n      : z.string(),\n      : z.coerce.number().prefault(0),\n    }),\n  ),\n});\n\nconst RelationLayerSchema = z.object({\n  : z\n    .object({\n      : z.coerce.number().prefault(0),\n      : z.coerce.number().prefault(0),\n      : z.coerce.number().prefault(0),\n    })\n    .prefault({ : 0, : 0, : 0 }),\n  : z\n    .object({\n      : z.coerce.number().prefault(0),\n      : z.coerce.number().prefault(0),\n    })\n    .prefault({ : 0, : 0 }),\n  : z\n    .object({\n      : z.coerce.number().prefault(0),\n      : z.coerce.number().prefault(0),\n      : z.coerce.number().prefault(0),\n    })\n    .prefault({ : 0, : 0, : 0 }),\n  : z\n    .object({\n      : z\n        .record(z.string(), z.object({ : z.string(), : z.string().optional() }))\n        .optional()\n        .prefault({}),\n      : z.coerce.number().prefault(0),\n      : z.string().prefault(''),\n    })\n    .prefault({ : {}, : 0, : '' }),\n  : z\n    .object({\n      : z.string().prefault(''),\n      : z.string().prefault(''),\n      : z.string().prefault(''),\n      : z.string().prefault(''),\n      : z.string().prefault(''),\n    })\n    .prefault({ : '', : '', : '', : '', : '' }),\n  : z\n    .record(z.string(), z.object({ : z.string(), : z.string() }))\n    .optional()\n    .prefault({}),\n});\n\nconst GoalSchema = z.object({\n  : z.string(),\n  : z.string(),\n  : z.string(),\n});\n\nconst CharacterSchema = z\n  .object({\n    $meta: MetaSchema.optional(),\n    : z.string().optional(), // Only for player\n    : z.string().optional(), // Only for NPCs\n    : z.coerce.number().optional(), // Player only\n    : z.coerce.number().optional(), // Player only\n    : z.object({\n      ID: z.string(),\n      : z.coerce.number(),\n      : z.coerce.number(),\n      : z.coerce.number(),\n    }),\n    : z.record(z.string(), z.string()).optional(),\n    : z.string(),\n    : z.string(),\n    : z.string(),\n    : z.object({\n      : z.record(z.string(), z.object({ : z.string(), : z.string() })).optional(),\n      : z.record(z.string(), z.string()).optional(),\n    }),\n    : z\n      .object({\n        : z.object({\n          : z.coerce.number().prefault(0),\n          : z.coerce.number().prefault(0),\n          : z.coerce.number().prefault(0),\n          : z.coerce.number().prefault(0),\n        }),\n        : z.string(),\n        : z.record(z.string(), z.object({ : z.string(), : z.string() })).optional(),\n        : z.record(z.string(), z.any()).optional(),\n        : z.object({\n          : z.record(z.string(), GoalSchema).optional(),\n          : z.record(z.string(), GoalSchema).optional(),\n          : z.object({\n            : z.string(),\n            : z.string(),\n            : z.string(),\n            : z.string(),\n          }),\n        }),\n      })\n      .optional(),\n    : z.object({}).passthrough().optional(),\n    : z\n      .record(z.string(), z.object({ : z.coerce.number().prefault(0), : z.coerce.number().prefault(0) }))\n      .optional(),\n    : z.record(z.string(), z.boolean()).optional(),\n    : z.object({\n      : z.coerce.number().prefault(0),\n      : z.coerce.number().prefault(0),\n      : z.coerce.number().prefault(0),\n      : z.coerce.number().prefault(0),\n    }),\n    : z.object({\n      : z.coerce.number().prefault(0),\n      : z.coerce.number().prefault(0),\n      : z.coerce.number().prefault(0),\n      : z.coerce.number().prefault(0),\n      : z.coerce.number().prefault(0),\n    }),\n    : z\n      .record(z.string(), z.any())\n      .and(z.object({ $meta: MetaSchema.optional() }))\n      .prefault({ $meta: {} }), // Allow flexible status objects\n    : z\n      .record(z.string(), z.coerce.number())\n      .and(z.object({ $meta: MetaSchema.optional() }))\n      .prefault({ $meta: {} }),\n    : z.object({ $meta: MetaSchema.optional() }).catchall(z.boolean()).prefault({}),\n    : z.array(z.string().nullable()).optional(),\n    : z.object({ $meta: MetaSchema.optional() }).catchall(z.any()).prefault({}),\n  })\n  .passthrough();\n\nconst WorldEpochSchema = z.object({\n  : z.string(),\n  : z.boolean(),\n  : z.string(),\n  : z\n    .union([\n      TimeDurationSchema.extend({ : z.string().prefault(''), : z.coerce.number().prefault(1) }),\n      z.string(),\n    ])\n    .transform(val => {\n      if (typeof val === 'string') {\n        // TimeDuration\n        return { : '', : 1, : 0, : 0, : 0, : 0, : 0 };\n      }\n      return val;\n    }),\n  : z\n    .object({\n      : z.coerce.number().prefault(0),\n      : z\n        .union([z.string(), z.coerce.number()])\n        .transform(val => {\n          if (typeof val === 'number') {\n            return val;\n          }\n          if (typeof val === 'string') {\n            const num = parseInt(val, 10);\n            return isNaN(num) ? 1 : num;\n          }\n          return 1;\n        })\n        .pipe(z.coerce.number())\n        .prefault(1),\n      : z.coerce.number(),\n      : z\n        .union([z.object({ : z.coerce.number(), : z.string() }), z.coerce.number()])\n        .transform(val => {\n          if (typeof val === 'number') {\n            return { : val, : '' };\n          }\n          return val;\n        }),\n      : z\n        .object({ $meta: MetaSchema.optional() })\n        .catchall(z.object({ : z.string(), : z.string(), : z.string() }))\n        .prefault({}),\n      : z\n        .object({ $meta: MetaSchema.optional() })\n        .catchall(\n          z.object({\n            : z.string(),\n            : z.string(),\n            : z.string(),\n            : z.object({ : z.coerce.number(), : z.coerce.number(), : z.string() }),\n          }),\n        )\n        .prefault({}),\n    })\n    .passthrough(),\n  : z.object({ $meta: MetaSchema.optional() }).catchall(z.any()).prefault({}),\n  : z.object({}).passthrough(), // Keeping it flexible for now\n});\n\nconst WorldSchema = z.object({\n  $meta: MetaSchema.optional(),\n  : z.object({\n    : z.string(),\n    : z.string(),\n    : z.boolean(),\n    : z.string().optional(),\n    ID: z.string(),\n  }),\n  : z.object({ $meta: MetaSchema.optional() }).catchall(WorldEpochSchema).prefault({}),\n});\n\nexport const WorldStateSchema = z\n  .object({\n    $meta: MetaSchema.optional(),\n    : z\n      .object({\n        $meta: MetaSchema.optional(),\n        : z.record(z.string(), DatabaseItemSchema).optional(),\n        : z.record(z.string(), DatabaseItemSchema).optional(),\n        : z.record(z.string(), DatabaseItemSchema).optional(),\n        : z.record(z.string(), DatabaseItemSchema).optional(),\n        : z.record(z.string(), DatabaseItemSchema).optional(),\n        : z.record(z.string(), DatabaseItemSchema).optional(),\n        : z.record(z.string(), DatabaseItemSchema).optional(),\n        : z.record(z.string(), ArtisanSkillSchema).optional(),\n        : z.record(z.string(), ActiveSkillSchema).optional(),\n      })\n      .passthrough()\n      .prefault({}),\n    : z\n      .object({ $meta: MetaSchema.optional() })\n      .catchall(z.record(z.string().describe('ID'), RelationLayerSchema))\n      .prefault({}),\n    : z\n      .object({ $meta: MetaSchema.optional() })\n      .catchall(z.record(z.string().describe('ID'), z.object({}).passthrough()))\n      .prefault({}),\n    : z.object({ $meta: MetaSchema.optional() }).catchall(CharacterSchema).prefault({}),\n    : z.object({ $meta: MetaSchema.optional() }).catchall(WorldSchema).prefault({}),\n    : z.object({\n      : z.object({\n        : z.string(),\n        : z.string(),\n        ID: z.string().nullable(),\n        : z.string().nullable(),\n      }),\n      : z.object({\n        : z.boolean(),\n        ID: z.string().nullable(),\n        : z.object({ $meta: MetaSchema.optional() }).catchall(z.any()).prefault({}),\n      }),\n      : z.object({\n        : z.boolean(),\n        : z.object({ : z.string(), : z.array(z.any()) }),\n        : z\n          .object({ $meta: MetaSchema.optional() })\n          .catchall(\n            z.object({\n              : z.string(),\n              : z.string(),\n              : z.coerce.number(),\n              : z.object({ ID: z.string(), : z.string() }),\n              : z.string(),\n            }),\n          )\n          .prefault({}),\n      }),\n    }),\n  })\n  .passthrough()\n  .describe('');\n\n//  TavernHelper ,  Schema\n// import { registerMvuSchema } from '@SillyTavern/TavernHelper';\n// $(() => {\n//   if (window.registerMvuSchema) {\n//     window.registerMvuSchema(WorldStateSchema);\n//     console.log('Tavern Helper MVU Schema registered successfully.');\n//   } else {\n//     console.error('registerMvuSchema function not found. Schema registration failed.');\n//   }\n// });\n","/**\n * YAMLJavaScript\n * @param text - \n * @returns \n */\nexport function parseSimpleYaml(text: string): any {\n  if (!text) return null;\n\n  const lines = text.split('\\n');\n  const result: any = {};\n  const stack: { obj: any; indent: number }[] = [{ obj: result, indent: -1 }];\n\n  for (const line of lines) {\n    if (line.trim() === '') continue;\n\n    const indent = (line.match(/^\\s*/) || [''])[0].length;\n    const trimmedLine = line.trim();\n\n    while (indent <= stack[stack.length - 1].indent) {\n      stack.pop();\n    }\n\n    const parent = stack[stack.length - 1].obj;\n\n    if (trimmedLine.startsWith('- ')) {\n      const value = trimmedLine.substring(2).trim();\n      // \n      if (Array.isArray(parent)) {\n        //  \"key: value\"\n        const separatorIndex = value.indexOf(':');\n        if (separatorIndex > -1) {\n          const key = value.substring(0, separatorIndex).trim();\n          const val = value.substring(separatorIndex + 1).trim();\n          const newObj: any = {};\n          newObj[key] = val;\n          parent.push(newObj);\n          stack.push({ obj: newObj, indent });\n        } else {\n          parent.push(value);\n        }\n      }\n    } else {\n      const separatorIndex = trimmedLine.indexOf(':');\n      if (separatorIndex > -1) {\n        const key = trimmedLine.substring(0, separatorIndex).trim();\n        const value = trimmedLine.substring(separatorIndex + 1).trim();\n\n        if (value) {\n          parent[key] = value;\n        } else {\n          // /\n          const nextLineIndex = lines.indexOf(line) + 1;\n          if (nextLineIndex < lines.length && lines[nextLineIndex].trim().startsWith('-')) {\n            const newList: any[] = [];\n            parent[key] = newList;\n            stack.push({ obj: newList, indent });\n          } else {\n            const newObj = {};\n            parent[key] = newObj;\n            stack.push({ obj: newObj, indent });\n          }\n        }\n      }\n    }\n  }\n\n  // ''\n  if (Object.keys(result).length === 1 && result['']) {\n    return result[''];\n  }\n\n  return result;\n}\n","import { reactive, watch } from 'vue';\nimport type { AppState, Character } from '../types';\n\nexport const USER_ID = '{{user}}';\n\n//  AppState \nconst initialState: AppState = {\n  isReady: false,\n  character: null,\n  worldState: null,\n  userId: USER_ID,\n  mainWorldNarrative: '...',\n  avatarWorldNarrative: '',\n  activeView: 'mainWorld',\n  selectedWorldForReincarnation: null,\n  reincarnationWorldOptions: [],\n  reincarnationAvatarOptions: [],\n  worldLog: [],\n  settlementData: null,\n  newWorldsAvailable: false, // \n  isGenerating: false,\n  generationError: null as string | null,\n};\n\n//  reactive  store\nexport const store = reactive<AppState & { getItemNameById: (id: string) => string | null }>({\n  ...initialState,\n  getItemNameById(id: string): string | null {\n    const database = this.worldState?.;\n    if (!database) return null;\n\n    for (const category in database) {\n      const categoryStore = (database as any)[category];\n      if (categoryStore && categoryStore[id]) {\n        return categoryStore[id]. || null;\n      }\n    }\n    return null;\n  },\n});\n\n//  watch \nwatch(\n  () => store.character,\n  (newChar: Character | null, oldChar: Character | null) => {\n    console.log('[State Watch] Character changed:', newChar);\n  },\n  { deep: true },\n);\n\nwatch(\n  () => store.isReady,\n  (isReady: boolean) => {\n    console.log(`[State Watch] Store is now ${isReady ? 'ready' : 'not ready'}.`);\n  },\n);\n","import { get } from 'lodash';\nimport { computed, ComputedRef } from 'vue';\nimport { lorebookService } from '../services/LorebookService';\nimport { Character } from '../types';\nimport { store } from './state';\n\n// --- Core Getters ---\n\n/**\n * \n */\nexport const playerCharacter: ComputedRef<Character | null> = computed(() => {\n  if (!store.worldState) return null;\n  return get(store.worldState., store.userId, null);\n});\n\n/**\n * \n */\nexport const currentAvatar: ComputedRef<Character | null> = computed(() => {\n  if (!store.worldState?. || !store.worldState?.) return null;\n\n  // 1. ID\n  const avatarId = get(store.worldState., '.ID');\n\n  // 2. ID\n  if (!avatarId) {\n    return null;\n  }\n\n  // 3. ID\n  return get(store.worldState., avatarId, null);\n});\n\n/**\n * \n */\nexport const simulator: ComputedRef<any> = computed(() => {\n  return store.worldState?.;\n});\n\n/**\n * \n */\nexport const mainWorldNarrative = computed(() => store.mainWorldNarrative);\n\n/**\n * \n */\nexport const avatarWorldNarrative = computed(() => store.avatarWorldNarrative);\n\n/**\n * \n * @param path - lodash get-style path to the variable\n */\nexport const getVariable = (path: string, defaultValue: any = null) => {\n  return computed(() => get(store.worldState, path, defaultValue));\n};\n\n// --- Player Character Getters ---\n\nexport const soulEssence = computed(() => {\n  if (!playerCharacter.value) return 0;\n  return get(playerCharacter.value, '', 0);\n});\n\nexport const daoHeart = computed(() => {\n  if (!playerCharacter.value) return 0;\n  return get(playerCharacter.value, '', 0);\n});\n\nexport const reincarnationImprints = computed(() => {\n  const character = playerCharacter.value;\n  const database = store.worldState?.;\n\n  if (!character || !database?.) {\n    return [];\n  }\n\n  const unlockedImprints = get(character, '', {}) as Record<string, boolean>;\n  const imprints = [];\n\n  for (const imprintId in unlockedImprints) {\n    if (unlockedImprints[imprintId] && database.[imprintId]) {\n      imprints.push({\n        ...(database. as any)[imprintId],\n        ID: imprintId,\n      });\n    }\n  }\n  return imprints;\n});\n\nexport const playerSkills = computed(() => {\n  const character = playerCharacter.value;\n  const database = store.worldState?. as any;\n\n  if (!character || !database?.) {\n    return [];\n  }\n\n  const playerArts = get(character, '', {}) as Record<string, { : number; : number }>;\n  const skills = [];\n\n  for (const artId in playerArts) {\n    const artData = playerArts[artId];\n    const artTemplate = (database. as any)[artId];\n\n    if (artTemplate && artTemplate.) {\n      // Convert  object to array, filtering out metadata\n      const levelSystem = Object.values(artTemplate.).filter(\n        (l: any) => typeof l === 'object' && l !== null && '' in l,\n      );\n\n      const currentLevelInfo = levelSystem.find((l: any) => l. === artData.) as\n        | { : number; : string }\n        | undefined;\n      const nextLevelInfo = levelSystem.find((l: any) => l. === artData. + 1) as\n        | { : number }\n        | undefined;\n\n      // Find associated active skills\n      const associatedSkills = [];\n      if (database.) {\n        for (const skillId in database.) {\n          const skillTemplate = (database. as any)[skillId];\n          if (skillTemplate. === artId) {\n            associatedSkills.push(skillTemplate);\n          }\n        }\n      }\n\n      skills.push({\n        id: artId,\n        name: artTemplate.,\n        description: artTemplate.,\n        level: artData.,\n        exp: artData.,\n        expToNextLevel: nextLevelInfo ? nextLevelInfo. : currentLevelInfo?. || 'MAX',\n        title: currentLevelInfo ? currentLevelInfo. : '',\n        associatedSkills,\n      });\n    }\n  }\n\n  return skills;\n});\n\n// ---  Getter ---\n\nconst createInventoryGetter = (characterRef: ComputedRef<Character | null>) => {\n  return computed(() => {\n    const character = characterRef.value;\n    const database = store.worldState?. as any;\n\n    if (!character || !database) {\n      return [];\n    }\n\n    const backpack = get(character, '', {});\n    const items = [];\n\n    for (const itemId in backpack) {\n      const quantity = (backpack as any)[itemId];\n      if (quantity <= 0) continue;\n\n      // \n      let itemDetails = null;\n      for (const category in database) {\n        const categoryStore = (database as any)[category];\n        if (categoryStore && categoryStore[itemId]) {\n          itemDetails = categoryStore[itemId];\n          break;\n        }\n      }\n\n      if (itemDetails) {\n        items.push({\n          ...itemDetails,\n          ID: itemId, // ID\n          : quantity,\n        });\n      }\n    }\n    return items;\n  });\n};\n\nexport const playerInventory = createInventoryGetter(playerCharacter);\nexport const avatarInventory = createInventoryGetter(currentAvatar);\n\nexport const basePotentials = computed(() => {\n  if (!playerCharacter.value) return {};\n  return get(playerCharacter.value, '', {});\n});\n\nexport const playerWorldAttributes = computed(() => {\n  const character = playerCharacter.value;\n  const epoch = activeEpoch.value;\n\n  if (!character || !character.) {\n    return [];\n  }\n\n  const attributesData = character.;\n  const templates = epoch?.?. || {};\n\n  const result: { key: string; value: any; description: string | null }[] = [];\n\n  for (const key in attributesData) {\n    if (key === '$meta') continue;\n\n    const value = (attributesData as any)[key];\n    const template = (templates as any)[key];\n\n    result.push({\n      key: key,\n      value: value,\n      description: template?. || null,\n    });\n  }\n\n  return result;\n});\n\n// --- Simulator Getters ---\n\nexport const isSimulationRunning = computed(() => {\n  if (!simulator.value) return false;\n\n  // \n  const isRunningValue = get(simulator.value, '.', false);\n\n  // \n  return !!isRunningValue;\n});\n\nexport const simulatorCooldown = computed(() => {\n  if (!simulator.value) return { status: '', time: 'N/A' };\n  const prep = get(simulator.value, '', {});\n  const status = get(prep, '', '');\n  const time = get(prep, '', 'N/A');\n\n  return { status, time };\n});\n\n/**\n * \n */\nexport const mainWorld = computed(() => {\n  if (!store.worldState?.) return null;\n  const worlds = store.worldState.;\n  for (const worldId in worlds) {\n    if (worldId === '$meta' || worldId.includes('template')) continue;\n    if (get(worlds[worldId], '.') === '') {\n      return worlds[worldId];\n    }\n  }\n  return null;\n});\n\n/**\n * \n */\nexport const avatarWorld = computed(() => {\n  if (!store.worldState?.) return null;\n  const worlds = store.worldState.;\n  for (const worldId in worlds) {\n    if (worldId === '$meta' || worldId.includes('template')) continue;\n    if (get(worlds[worldId], '.') === '') {\n      return worlds[worldId];\n    }\n  }\n  return null;\n});\n\n/**\n * \n */\nexport const activeEpoch = computed(() => {\n  const world = avatarWorld.value || mainWorld.value;\n  if (!world) return null;\n\n  const currentEpochId = get(world, '.ID');\n  if (!currentEpochId) return null;\n\n  return get(world, `.${currentEpochId}`, null);\n});\n\n/**\n * \n */\nconst formatTime = (time: any, defaultString: string): string => {\n  if (!time) return defaultString;\n\n  const era = get(time, '', '');\n  const year = get(time, '', '----');\n  const month = String(get(time, '', '--')).padStart(2, '0');\n  const day = String(get(time, '', '--')).padStart(2, '0');\n  const hour = String(get(time, '', '--')).padStart(2, '0');\n  const minuteValue = get(time, '');\n  // null\n  const minute =\n    minuteValue !== null && minuteValue !== undefined && !isNaN(parseInt(String(minuteValue), 10))\n      ? String(parseInt(String(minuteValue), 10)).padStart(2, '0')\n      : '--';\n\n  return `${era} ${year}${month}${day} ${hour}:${minute}`;\n};\n\n/**\n * \n */\nexport const mainWorldTimeStr = computed(() => {\n  const world = mainWorld.value;\n  if (!world) return '';\n  const epochId = get(world, '.ID');\n  if (!epochId) return '';\n  const epoch = get(world, `.${epochId}`);\n  return formatTime(get(epoch, ''), '');\n});\n\n/**\n * \n */\nexport const timeStr = computed(() => {\n  const world = avatarWorld.value;\n  if (!world) return '';\n  const epochId = get(world, '.ID');\n  if (!epochId) return '';\n  const epoch = get(world, `.${epochId}`);\n  return formatTime(get(epoch, ''), '');\n});\n\n/**\n * \n */\nexport const calculateAge = (character: Character | null, world: any | null): number | null => {\n  if (!character || !world) return null;\n\n  const birthDate = get(character, '');\n  const epochId = get(world, '.ID');\n  const epoch = get(world, `.${epochId}`);\n  const currentTime = get(epoch, '');\n\n  if (!birthDate || !currentTime || birthDate.ID !== epochId) {\n    // \n    return null;\n  }\n\n  let age = currentTime. - birthDate.;\n  if (currentTime. < birthDate. || (currentTime. === birthDate. && currentTime. < birthDate.)) {\n    age--;\n  }\n  return age >= 0 ? age : null;\n};\n\n/**\n * \n */\nexport const playerAge = computed(() => {\n  return calculateAge(playerCharacter.value, mainWorld.value);\n});\n\n/**\n * \n */\nexport const combinedNarrative = computed(() => {\n  //  activeView \n  if (store.activeView === 'mainWorld') {\n    const narrative = store.mainWorldNarrative || '...';\n    //  HTML\n    return `<div class=\"narrative-block main-world-narrative\">${narrative}</div>`;\n  }\n\n  if (store.activeView === 'avatarWorld') {\n    if (isSimulationRunning.value) {\n      const narrative = store.avatarWorldNarrative || '...';\n      //  HTML\n      return `<div class=\"narrative-block avatar-world-narrative\">${narrative}</div>`;\n    }\n    return '<div class=\"narrative-block narrative-placeholder\"></div>';\n  }\n\n  // \n  return '<div class=\"narrative-block narrative-placeholder\">...</div>';\n});\n\n// --- Entity Getters for Tooltips ---\n\n/**\n * Finds an item across all known item lists by its name.\n * @param name The name of the item to find.\n */\nexport const getItemByName = (name: string): any | null => {\n  const database = store.worldState?.;\n  if (!database) return null;\n\n  for (const category in database) {\n    const categoryStore = (database as any)[category];\n    if (categoryStore) {\n      for (const itemId in categoryStore) {\n        const item = categoryStore[itemId];\n        if (item. === name) {\n          return item;\n        }\n      }\n    }\n  }\n  return null;\n};\n\n/**\n * Finds an NPC from the world state by their name.\n * @param name The name of the NPC to find.\n */\nexport const getNpcByName = (name: string): Character | null => {\n  const characters = store.worldState?.;\n  if (!characters) return null;\n\n  for (const charId in characters) {\n    // Skip metadata and the player character\n    if (charId === '$meta' || charId === store.userId) continue;\n\n    const character = characters[charId];\n    if (character && character. && character. === name) {\n      return character;\n    }\n  }\n\n  return null;\n};\n\nexport const worldSandboxData = computed(() => {\n  const nodes: any[] = [];\n  const edges: any[] = [];\n  const worldState = store.worldState;\n\n  if (!worldState) {\n    return { nodes, edges };\n  }\n\n  // Add worlds as nodes\n  if (worldState.) {\n    for (const worldId in worldState.) {\n      // ID\n      if (worldId === '$meta' || worldId === 'ID') continue;\n      const world = worldState.[worldId];\n      // world\n      const epochId = get(world, '.ID');\n      if (!epochId) continue;\n\n      const activeEpoch = get(world, `.${epochId}`);\n      if (!activeEpoch || !activeEpoch.) continue;\n\n      const loreEntry = lorebookService.findEntryByComment(worldId);\n      const worldName = loreEntry?.comment || get(world, '.') || worldId;\n\n      const title = `\n        : ${activeEpoch.?. || ''}<br>\n        : ${activeEpoch.?. || ''}x<br>\n        : ${activeEpoch.?. || ''}\n      `.trim();\n\n      nodes.push({\n        id: worldId,\n        label: worldName,\n        group: 'world',\n        title: title,\n      });\n    }\n  }\n\n  // Add characters as nodes\n  if (worldState.) {\n    for (const charId in worldState.) {\n      // NPC\n      if (charId === '$meta' || charId === 'sample_npc_id') continue;\n      const character = worldState.[charId];\n      // \n      if (!character. && !character.) continue;\n\n      const isPlayer = charId === store.userId;\n      const potentials = character.;\n      const potentialText = potentials\n        ? `: ${potentials.} | : ${potentials.} | : ${potentials.} | : ${potentials.}`\n        : '';\n      // \n      const identities = character.\n        ? Object.values(character.)\n            .filter(item => typeof item === 'string')\n            .join(', ')\n        : '';\n      const title = `\n        ${identities}<br>\n        ${potentialText}\n      `.trim();\n\n      nodes.push({\n        id: charId,\n        label: character. || character. || charId,\n        group: isPlayer ? 'player' : 'npc',\n        title: title,\n      });\n\n      // Add edge from character to their world\n      if (character. && worldState.?.[character.]) {\n        edges.push({\n          from: charId,\n          to: character.,\n          arrows: 'to',\n        });\n      }\n    }\n  }\n\n  // Add edges for relationships from \n  if (worldState.) {\n    for (const subjectId in worldState.) {\n      if (!worldState.[subjectId]) continue; // Ensure subject exists\n\n      const subjectRelations = worldState.[subjectId];\n      for (const objectId in subjectRelations) {\n        if (!worldState.[objectId]) continue; // Ensure object exists\n\n        const relationship = subjectRelations[objectId];\n        const totalFavor = (get(relationship, '.', 0) || 0) + (get(relationship, '.', 0) || 0);\n        const conflict = get(relationship, '.', 0) || 0;\n\n        edges.push({\n          from: subjectId,\n          to: objectId,\n          label: get(relationship, '.', ''),\n          color: totalFavor > 50 ? '#4caf50' : totalFavor < -50 ? '#f44336' : '#9e9e9e',\n          dashes: conflict > 50, // Dashed line for high conflict\n          arrows: 'to',\n        });\n      }\n    }\n  }\n\n  return { nodes, edges };\n});\n\nexport const ripples = computed(() => {\n  if (!store.worldState?.?.) return null;\n  return store.worldState..;\n});\n","class SilentUpdater {\n  private timerId: number | null = null;\n  private isRunning: boolean = false;\n  private isUpdating: boolean = false;\n  private updateCallback: (() => Promise<void>) | null = null;\n\n  /**\n   * Starts the silent update polling.\n   * @param updateFn The function to call to fetch data.\n   * @param interval The interval in milliseconds. Defaults to 5 seconds for faster feedback.\n   */\n  public start(updateFn: () => Promise<void>, interval: number = 5000) {\n    if (this.isRunning) {\n      console.log('[SilentUpdater] Updater is already running.');\n      return;\n    }\n    this.updateCallback = updateFn;\n    this.timerId = window.setInterval(() => this.runUpdate(), interval);\n    this.isRunning = true;\n    console.log(`[SilentUpdater] Started with an interval of ${interval / 1000} seconds.`);\n  }\n\n  /**\n   * Stops the silent update polling.\n   */\n  public stop() {\n    if (this.timerId) {\n      window.clearInterval(this.timerId);\n      this.timerId = null;\n    }\n    this.isRunning = false;\n    this.updateCallback = null;\n    console.log('[SilentUpdater] Stopped.');\n  }\n\n  /**\n   * Runs a single update cycle.\n   */\n  private async runUpdate() {\n    if (this.isUpdating || !this.updateCallback) {\n      console.log('[SilentUpdater] Update in progress or callback not set. Skipping.');\n      return;\n    }\n\n    this.isUpdating = true;\n    try {\n      await this.updateCallback();\n      console.log('[SilentUpdater] Silent update check completed.');\n    } catch (error) {\n      console.error('[SilentUpdater] Error during silent update:', error);\n    } finally {\n      this.isUpdating = false;\n    }\n  }\n}\n\nexport const silentUpdater = new SilentUpdater();\n","import { get } from 'lodash';\nimport { commandService } from '../services/CommandService';\nimport { lorebookService } from '../services/LorebookService';\nimport { memoryService } from '../services/MemoryService';\nimport { notificationService } from '../services/NotificationService';\nimport { tavernService } from '../services/tavern';\nimport { workflowService } from '../services/WorkflowService';\nimport { worldUpdateService } from '../services/WorldUpdateService';\nimport type { WorldbookEntry } from '../types';\nimport { WorldStateSchema } from '../types/schema';\nimport { parseSimpleYaml } from '../utils/yamlParser';\nimport { isSimulationRunning } from './getters';\nimport { store } from './state';\n\nlet lastProcessedMessageId: string | null = null; // ID\nlet isLogHistoryLoaded = false; // Flag to ensure history is loaded only once\n\n/**\n * Compares old and new game states and triggers notifications for changes.\n * @param oldState The game state before the update.\n * @param newState The game state after the update.\n */\nfunction checkForChangesAndNotify(oldState: any, newState: any) {\n  if (!oldState || !newState) return;\n\n  // 1. Inventory Change Notification\n  const oldInventory = get(oldState, `.${store.userId}.`, {});\n  const newInventory = get(newState, `.${store.userId}.`, {});\n  const allItemIds = new Set([...Object.keys(oldInventory), ...Object.keys(newInventory)].filter(id => id !== '$meta'));\n\n  for (const itemId of allItemIds) {\n    const oldQty = oldInventory[itemId] || 0;\n    const newQty = newInventory[itemId] || 0;\n    const diff = newQty - oldQty;\n    if (diff !== 0) {\n      const itemName = store.getItemNameById(itemId) || itemId;\n      const action = diff > 0 ? '' : '';\n      notificationService.success('', `${action} ${itemName} x${Math.abs(diff)}`);\n    }\n  }\n\n  // 2. Relationship Change Notification\n  const oldWeb = get(oldState, '', {});\n  const newWeb = get(newState, '', {});\n  const allSubjects = new Set([...Object.keys(oldWeb), ...Object.keys(newWeb)]);\n\n  for (const subjectId of allSubjects) {\n    const oldRelations = oldWeb[subjectId] || {};\n    const newRelations = newWeb[subjectId] || {};\n    const allObjects = new Set([...Object.keys(oldRelations), ...Object.keys(newRelations)]);\n\n    for (const objectId of allObjects) {\n      const oldCloseness = get(oldRelations, `${objectId}..[0]`, 0);\n      const newCloseness = get(newRelations, `${objectId}..[0]`, 0);\n      const closenessDiff = newCloseness - oldCloseness;\n\n      if (closenessDiff !== 0) {\n        const subjectName = get(newState, `.${subjectId}.[0]`, subjectId);\n        const objectName = get(newState, `.${objectId}.[0]`, objectId);\n        const action = closenessDiff > 0 ? '' : '';\n        notificationService.info(\n          '',\n          `${subjectName}  ${objectName} ${action} ${Math.abs(closenessDiff)}`,\n        );\n      }\n    }\n  }\n}\n\nasync function loadWorldLogFromLorebook() {\n  try {\n    const logContent = await lorebookService.readFromLorebook('');\n    if (!logContent || !logContent.trim()) {\n      console.log('[Store] \"\" lorebook is empty. Skipping log population.');\n      store.worldLog = []; // Ensure log is cleared if entry is empty\n      return;\n    }\n\n    const logBlocks = logContent.split('\\n\\n---\\n\\n');\n    const allLogs = logBlocks\n      .map(block => {\n        if (!block.trim()) return null;\n        try {\n          const parsed = parseBlock(block);\n          if (!parsed || !parsed['']) return null;\n          // Ensure all properties of WorldLogEntry are present\n          return {\n            : parseInt(parsed[''], 10),\n            : parsed[''] || '',\n            : parsed[''] || '',\n            : parsed[''] || '',\n            : parsed[''] || '',\n            : parsed[''] || '',\n            : parsed[''] || '',\n            : parsed['']\n              ? parsed['']\n                  .replace(/[[\\]\"]/g, '')\n                  .split(',')\n                  .map(t => t.trim())\n                  .filter(t => t)\n              : [],\n            : parsed[''] || '',\n            : parsed[''] || '',\n            : parsed[''] || '',\n          };\n        } catch (e) {\n          console.error('Failed to parse log block:', block, e);\n          return null;\n        }\n      })\n      .filter(log => log && !isNaN(log.));\n\n    // De-duplication\n    const uniqueLogs = [];\n    const seenIds = new Set();\n    for (const log of allLogs) {\n      if (log && !seenIds.has(log.)) {\n        seenIds.add(log.);\n        uniqueLogs.push(log);\n      }\n    }\n\n    store.worldLog = uniqueLogs.sort((a, b) => a. - b.);\n    console.log(`[Store] Loaded ${store.worldLog.length} entries from \"\" lorebook.`);\n  } catch (error) {\n    console.error('Error loading world log from lorebook:', error);\n    store.worldLog = []; // Reset on error\n  }\n}\n\nasync function fetchCoreData() {\n  try {\n    const messages = await tavernService.fetchTavernData();\n    if (messages && messages.length > 0 && messages[0].data) {\n      const rawStateData = messages[0].data.stat_data || messages[0].data;\n      const fullMessageContent = messages[0].message;\n      const currentMessageId = messages[0].id;\n      const oldState = JSON.parse(JSON.stringify(store.worldState)); // Capture state before update\n\n      //  userId\n      const characters = get(rawStateData, '');\n      if (characters) {\n        const characterIds = Object.keys(characters).filter(id => id && id !== '$meta' && id !== 'sample_npc_id');\n        if (characterIds.length > 0) {\n          store.userId = characterIds[0];\n        }\n      }\n\n      try {\n        store.worldState = WorldStateSchema.parse(rawStateData) as any;\n      } catch (error) {\n        console.error('Zod validation failed for rawStateData:', error);\n        notificationService.error('', '');\n        // \n        store.worldState = rawStateData as any;\n      }\n\n      store.character = get(store.worldState, ['', store.userId]) || null;\n\n      // After updating the state, compare with the old state for notifications\n      checkForChangesAndNotify(oldState, store.worldState);\n\n      const gameTextContent = fullMessageContent?.match(/<gametxt>([\\s\\S]*?)<\\/gametxt>/i)?.[1].trim();\n\n      // \n      if (gameTextContent) {\n        if (store.activeView === 'mainWorld') {\n          store.mainWorldNarrative = gameTextContent;\n        } else if (store.activeView === 'avatarWorld') {\n          store.avatarWorldNarrative = gameTextContent;\n        } else {\n          // \n          store.mainWorldNarrative = gameTextContent;\n        }\n      }\n\n      // \n      // ID\n      if (fullMessageContent && currentMessageId !== lastProcessedMessageId) {\n        // \n        // ---  () ---\n        const summaryRegex = /< a_id=\"(.+?)\">([\\s\\S]+?)<\\/>/g;\n        const mainWorldSummaryRegex = /<>([\\s\\S]+?)<\\/>/g;\n        const avatarWorldSummaryRegex = /<>([\\s\\S]+?)<\\/>/g;\n        let match;\n\n        const formatWorldTime = (time: any): string => {\n          if (!time) return new Date().toLocaleString('zh-CN', { hour12: false }); // Fallback\n\n          const era = get(time, '', '');\n          const year = get(time, '', '----');\n          const month = String(get(time, '', '--')).padStart(2, '0');\n          const day = String(get(time, '', '--')).padStart(2, '0');\n          const hour = String(get(time, '', '--')).padStart(2, '0');\n          const minute = String(get(time, '', '--')).padStart(2, '0');\n\n          return `${era} ${year}${month}${day} ${hour}:${minute}`;\n        };\n\n        const processAndWriteSummary = async (\n          content: string,\n          entryName: string,\n          toastrTitle: string,\n          timestamp: string,\n        ) => {\n          // \n          const existingSummaries = await lorebookService.readFromLorebook(entryName);\n          if (existingSummaries && existingSummaries.includes(content)) {\n            console.log(`[Actions] Summary content already exists in \"${entryName}\". Skipping.`);\n            return;\n          }\n          notificationService.info(toastrTitle, content);\n          const formattedSummary = `${timestamp}\\n${content}`;\n          await lorebookService.appendToEntry(entryName, formattedSummary, '\\n\\n---\\n\\n');\n        };\n\n        // : < a_id=\"...\">\n        while ((match = summaryRegex.exec(fullMessageContent)) !== null) {\n          const worldId = match[1];\n          const summaryContent = match[2].trim();\n          const world = get(store.worldState, `.${worldId}`);\n          if (world) {\n            const worldName = get(world, '', '');\n            const location = get(world, '.[0]');\n            const entryName = location === '' ? '[]' : '[]';\n            const worldTime = formatWorldTime(get(world, '.'));\n            await processAndWriteSummary(summaryContent, entryName, `${worldName} `, worldTime);\n          }\n        }\n\n        // : <> / <>\n        if ((match = mainWorldSummaryRegex.exec(fullMessageContent)) !== null) {\n          const mainWorld = Object.values(get(store.worldState, '', {})).find(\n            (w: any) => get(w, '.[0]') === '',\n          );\n          const worldTime = formatWorldTime(get(mainWorld, '.'));\n          await processAndWriteSummary(match[1].trim(), '[]', '', worldTime);\n        }\n        if ((match = avatarWorldSummaryRegex.exec(fullMessageContent)) !== null) {\n          const avatarWorld = Object.values(get(store.worldState, '', {})).find(\n            (w: any) => get(w, '.[0]') === '',\n          );\n          const worldTime = formatWorldTime(get(avatarWorld, '.'));\n          await processAndWriteSummary(match[1].trim(), '[]', '', worldTime);\n        }\n\n        // 3. \n        const avatarOptionsMatch = fullMessageContent.match(/<>([\\s\\S]+?)<\\/>/i);\n        if (avatarOptionsMatch) {\n          const parser = new DOMParser();\n          const xmlDoc = parser.parseFromString(`<root>${avatarOptionsMatch[1]}</root>`, 'application/xml');\n          const avatars = Array.from(xmlDoc.getElementsByTagName('')).map(el => {\n            return {\n              : el.getElementsByTagName('')[0]?.textContent || '',\n              : el.getElementsByTagName('')[0]?.textContent || '',\n              : el.getElementsByTagName('')[0]?.textContent || '',\n            };\n          });\n          store.reincarnationAvatarOptions = avatars;\n        }\n\n        console.log('[Roo Debug] fetchCoreData: New message content detected. Processing world tags...');\n        console.log('[Roo Debug] fetchCoreData: New message content detected. Processing world tags...');\n\n        const mainWorldRegex = /<>([\\s\\S]*?)<\\/>/g;\n        const newWorldRegex = /<>([\\s\\S]*?)<\\/>/g;\n        const worldLogRegex = /<>([\\s\\S]+?)<\\/>/g;\n        const processLogRegex = /<>([\\s\\S]+?)<\\/>/g;\n        const settlementRegex = /<>([\\s\\S]+?)<\\/>/g;\n        const mainWorldUpdateRegex = /<>([\\s\\S]+?)<\\/>/g;\n        const avatarWorldUpdateRegex = /<>([\\s\\S]+?)<\\/>/g;\n\n        const parseAndCreateWorldEntry = async (blockContent: string) => {\n          const content = blockContent.trim();\n          let worldName: string | null = null;\n          let worldId: string | null = null;\n          let worldScale = '';\n          let worldComplexity = '';\n\n          try {\n            // YAML\n            const parsedData = parseSimpleYaml(content);\n            if (parsedData && parsedData['']) {\n              worldName = parsedData[''][''] || null;\n              worldId = parsedData['']['ID'] || null;\n            }\n            if (parsedData && parsedData['']) {\n              worldScale = parsedData[''][''] || '';\n              worldComplexity = parsedData[''][''] || '';\n            }\n          } catch (e) {\n            console.warn('[Actions] YAML parsing failed, falling back to regex.', e);\n          }\n\n          // YAML\n          if (!worldName || !worldId) {\n            const nameMatch = content.match(/(?:\\||:\\s)(.*?)\\n/);\n            const idMatch = content.match(/(?:ID\\||ID:\\s)(.*?)\\n/);\n            const scaleMatch = content.match(/(?:\\||:\\s)(.*?)\\n/);\n            const complexityMatch = content.match(/(?:\\||:\\s)(.*?)\\n/);\n\n            worldName = nameMatch ? nameMatch[1].trim() : worldName;\n            worldId = idMatch ? idMatch[1].trim() : worldId;\n            worldScale = scaleMatch ? scaleMatch[1].trim() : worldScale;\n            worldComplexity = complexityMatch ? complexityMatch[1].trim() : worldComplexity;\n          }\n\n          const entryName = `${worldName || worldId || ''}`;\n\n          console.log(\n            `[Actions] Parsing world entry: ID=${worldId}, Name=${worldName}, Scale=${worldScale}, Complexity=${worldComplexity}`,\n          );\n\n          const existingEntry = await lorebookService.readFromLorebook(entryName);\n          if (!existingEntry) {\n            console.log(`[Actions] Creating new worldbook entry: \"${entryName}\"`);\n            // \n            await lorebookService.writeToLorebook(entryName, content, { isEnabled: false, keys: [entryName] });\n          }\n        };\n\n        if ((match = mainWorldRegex.exec(fullMessageContent)) !== null) {\n          const mainWorldContent = match[1].trim();\n          console.log('[Actions] Found <> tag. Overwriting \"\" lorebook entry.');\n          await lorebookService.writeToLorebook('', mainWorldContent, { isEnabled: true, keys: [''] });\n        }\n\n        if ((match = newWorldRegex.exec(fullMessageContent)) !== null) {\n          const allWorldsContent = match[1].trim();\n          const worldBlocks = allWorldsContent.split(/(?=ID\\|)/g).filter(b => b.trim());\n\n          for (const block of worldBlocks) {\n            const nameMatch = block.match(/\\|(.*?)\\n/);\n            const idMatch = block.match(/ID\\|(.*?)\\n/);\n            const worldName = nameMatch ? nameMatch[1].trim() : null;\n            const worldId = idMatch ? idMatch[1].trim() : null;\n            const entryName = `${worldName || worldId || ''}`;\n\n            // ``\n            const automationRuleMatch = block.match(/:([\\s\\S]*)/);\n            let contentToWrite = block; // \n            if (automationRuleMatch && automationRuleMatch[1]) {\n              contentToWrite = `:${automationRuleMatch[1]}`;\n            }\n\n            const allEntries = await lorebookService.getEntries(true);\n            const existingEntry = allEntries.find((e: any) => e.name === entryName || e.comment === entryName);\n\n            if (existingEntry) {\n              await lorebookService.writeToLorebook(entryName, contentToWrite, {\n                isEnabled: existingEntry.enabled,\n                keys: existingEntry.keys,\n              });\n            } else {\n              await lorebookService.writeToLorebook(entryName, contentToWrite, { isEnabled: false, keys: [entryName] });\n            }\n          }\n        }\n\n        if ((match = worldLogRegex.exec(fullMessageContent)) !== null) {\n          const newLog = match[1].trim();\n          const existingLogs = await lorebookService.readFromLorebook('');\n          if (!existingLogs || !existingLogs.includes(newLog)) {\n            await lorebookService.appendToEntry('', newLog);\n          }\n        }\n\n        //  <>\n        while ((match = processLogRegex.exec(fullMessageContent)) !== null) {\n          const block = parseBlock(match[1]);\n          const newLogEntry: any = {\n            ...block,\n            : parseInt(block[''], 10),\n            : block['']\n              ? block['']\n                  .replace(/[[\\]\"]/g, '')\n                  .split(',')\n                  .map(t => t.trim())\n                  .filter(t => t)\n              : [],\n          };\n\n          // \n          const isDuplicate = store.worldLog.some(log => log. === newLogEntry.);\n          if (!isDuplicate) {\n            store.worldLog.push(newLogEntry);\n          }\n        }\n        // \n        store.worldLog.sort((a, b) => a. - b.);\n\n        // \n        const latestLog = store.worldLog.length > 0 ? store.worldLog[store.worldLog.length - 1] : null;\n        if (latestLog) {\n          const existingLogs = await lorebookService.readFromLorebook('');\n          const newLogContent = Object.entries(latestLog)\n            .map(([key, value]) => {\n              if (typeof value === 'object' && value !== null) {\n                return `${key}|${JSON.stringify(value, null, 2)}`;\n              }\n              return `${key}|${value}`;\n            })\n            .join('\\n');\n\n          if (!existingLogs || !existingLogs.includes(`|${latestLog.}`)) {\n            console.log(`[Actions] Appending new log (: ${latestLog.}) to \"\".`);\n            await lorebookService.appendToEntry('', newLogContent, '\\n\\n---\\n\\n');\n          }\n        }\n\n        //  <>\n        if ((match = settlementRegex.exec(fullMessageContent)) !== null) {\n          const block = parseBlock(match[1]);\n          const settlementData = {\n            x: parseInt(block['x'], 10) || 0,\n            : block[''] || '',\n            : block[''] || '',\n            : block[''] || '',\n            : block[''] || '',\n            : block[''] || '',\n            : block[''] || '',\n            : block[''] || '',\n            : block[''] || '',\n          };\n          store.settlementData = settlementData;\n\n          // \n          const settlementContent = Object.entries(settlementData)\n            .map(([key, value]) => `${key}|${value}`)\n            .join('\\n');\n          await lorebookService.writeToLorebook('', settlementContent, { isEnabled: true, keys: [''] });\n\n          // \n          await lorebookService.writeToLorebook('', '', { isEnabled: true, keys: [''] });\n          store.worldLog = []; // \n        }\n\n        // ---  ---\n        if ((match = mainWorldUpdateRegex.exec(fullMessageContent)) !== null) {\n          console.log('[Actions] Found <> tag. Applying modifications...');\n          await worldUpdateService.applyModifications(match[1].trim(), '');\n        }\n        if ((match = avatarWorldUpdateRegex.exec(fullMessageContent)) !== null) {\n          console.log('[Actions] Found <> tag. Applying modifications...');\n          await worldUpdateService.applyModifications(match[1].trim(), '');\n        }\n\n        await syncWorldEntries();\n\n        // ID\n        lastProcessedMessageId = currentMessageId;\n\n        // \n        await memoryService.updateMemory(store.worldLog);\n      }\n    }\n  } catch (error) {\n    console.error(':', error);\n  }\n}\n\nasync function syncWorldEntries() {\n  console.log('[Roo Debug] Syncing world entries based on World ID...');\n  const worlds = get(store.worldState, '', {}) as { [id: string]: any };\n  const allEntries = await lorebookService.getEntries(true); // Force refresh cache\n  if (!allEntries) return;\n\n  // \n  const avatarWorldEntry = allEntries.find((e: any) => e.name === '');\n  if (avatarWorldEntry && avatarWorldEntry.content && avatarWorldEntry.content.trim() !== '') {\n    const idMatch = avatarWorldEntry.content.match(/ID:\\s*(\\S+)/);\n    const nameMatch = avatarWorldEntry.content.match(/:\\s*(.*)/);\n    if (idMatch && nameMatch) {\n      const worldId = idMatch[1].trim();\n      const worldName = nameMatch[1].trim();\n      const targetEntryName = `${worldName || worldId}`;\n\n      console.log(`[Actions] Archiving '' to '${targetEntryName}'...`);\n\n      // \n      await lorebookService.writeToLorebook(targetEntryName, avatarWorldEntry.content, {\n        isEnabled: false, // \n        keys: [targetEntryName],\n      });\n\n      // \n      await lorebookService.writeToLorebook('', '', { isEnabled: true, keys: [''] });\n      console.log(`[Actions] '' has been cleared and archived.`);\n    }\n  }\n\n  // ---  ---\n  const worldIdToLocation: { [id: string]: string } = {};\n  for (const worldId in worlds) {\n    if (worldId === '$meta') continue;\n    const location = get(worlds[worldId], '.[0]');\n    if (location === '' || location === '') {\n      worldIdToLocation[worldId] = location;\n    }\n  }\n\n  for (const sourceEntry of allEntries) {\n    const entryIdentifier = (sourceEntry as any).comment || sourceEntry.name;\n    if (!entryIdentifier || typeof entryIdentifier !== 'string' || !entryIdentifier.startsWith('')) {\n      continue;\n    }\n    if (!sourceEntry.content) continue;\n\n    const match = sourceEntry.content.match(/ID:\\s*(\\S+)/);\n    if (match && match[1]) {\n      const entryWorldId = match[1].trim();\n      const location = worldIdToLocation[entryWorldId];\n\n      if (location) {\n        const targetEntryName = location === '' ? '' : '';\n        if (entryIdentifier !== targetEntryName) {\n          console.log(`[Roo Debug] Found match: Moving content from \"${entryIdentifier}\" to \"${targetEntryName}\"`);\n          await lorebookService.writeToLorebook(targetEntryName, sourceEntry.content, {\n            isEnabled: true,\n            keys: [targetEntryName],\n          });\n          await lorebookService.writeToLorebook(entryIdentifier, '', { isEnabled: false, keys: [entryIdentifier] });\n          delete worldIdToLocation[entryWorldId];\n        }\n      }\n    }\n  }\n}\n\nasync function loadAllData() {\n  // Load the full log history only on the first run\n  if (!isLogHistoryLoaded) {\n    await loadWorldLogFromLorebook();\n    isLogHistoryLoaded = true;\n  }\n\n  await fetchCoreData();\n  // Force a refresh of the lorebook cache after fetching new data\n  await lorebookService.getEntries(true);\n  store.isReady = true;\n  console.log('[Store] Core data loaded and lorebook cache refreshed.');\n}\n\n/**\n * \n * @param prefixedInput \n */\nasync function processAiResponse(response: string, prefixedInput: string) {\n  if (!response) return;\n\n  // 1. \n  const gameTextMatch = response.match(/<gametxt>([\\s\\S]+?)<\\/gametxt>/i);\n  const narrative = gameTextMatch ? gameTextMatch[1].trim() : null;\n\n  if (narrative) {\n    if (prefixedInput.startsWith('')) {\n      store.mainWorldNarrative = narrative;\n    } else if (prefixedInput.startsWith('')) {\n      store.avatarWorldNarrative = narrative;\n    } else {\n      store.mainWorldNarrative = narrative;\n    }\n  } else {\n    // AIgametxt\n    const cachedNarrative = workflowService.popNarrative();\n    if (cachedNarrative) {\n      if (store.activeView === 'mainWorld') {\n        store.mainWorldNarrative = cachedNarrative;\n      } else {\n        store.avatarWorldNarrative = cachedNarrative;\n      }\n    }\n  }\n\n  // 2. \n  const summaryRegex = /< a_id=\"(.+?)\">([\\s\\S]+?)<\\/>/g;\n  let summaryMatch;\n  while ((summaryMatch = summaryRegex.exec(response)) !== null) {\n    const worldId = summaryMatch[1];\n    const summaryContent = summaryMatch[2];\n    const worldName = get(store.worldState, `.${worldId}.`, '');\n    notificationService.info(`${worldName} `, summaryContent);\n  }\n\n  // 3. \n  const avatarOptionsMatch = response.match(/<>([\\s\\S]+?)<\\/>/i);\n  if (avatarOptionsMatch) {\n    const parser = new DOMParser();\n    const xmlDoc = parser.parseFromString(`<root>${avatarOptionsMatch[1]}</root>`, 'application/xml');\n    const avatars = Array.from(xmlDoc.getElementsByTagName('')).map(el => {\n      return {\n        : el.getElementsByTagName('')[0]?.textContent || '',\n        : el.getElementsByTagName('')[0]?.textContent || '',\n        : el.getElementsByTagName('')[0]?.textContent || '',\n      };\n    });\n    store.reincarnationAvatarOptions = avatars;\n\n    // \n    // \n  }\n\n  //  fetchCoreData\n  // \n\n  // 4. \n  const updateScriptMatch = response.match(/<UpdateVariable>([\\s\\S]+?)<\\/UpdateVariable>/i);\n  let updateScript = updateScriptMatch ? updateScriptMatch[1].trim() : null;\n\n  //  gametxt  updateScript\n  if (narrative) {\n    workflowService.cacheNarrative(narrative);\n  }\n  if (updateScript) {\n    workflowService.cacheUpdateScript(updateScript);\n  }\n\n  // [Roo-Fix]  handleAction\n  // //  gametxt\n  // if (!narrative) {\n  //   const cachedNarrative = workflowService.popNarrative();\n  //   if (cachedNarrative) {\n  //     if (store.activeView === 'mainWorld') {\n  //       store.mainWorldNarrative = cachedNarrative;\n  //     } else {\n  //       store.avatarWorldNarrative = cachedNarrative;\n  //     }\n  //   }\n  // }\n\n  //  processAiResponse \n  if (updateScript) {\n    // [PATCH] AI''[0]\n    // \n    const scriptLines = updateScript.split('\\n');\n    const patchedLines = scriptLines.map(line => {\n      if (line.includes('..') && line.includes('[0]')) {\n        return line.replace('[0]', '');\n      }\n      return line;\n    });\n    const patchedScript = patchedLines.join('\\n');\n    if (patchedScript !== updateScript) {\n      console.log('[PATCH] Corrected invalid [0] access in UpdateVariable script for .');\n      updateScript = patchedScript;\n    }\n\n    // [PATCH]  \"Cannot assign into path\" \n    const commands = updateScript\n      .split(';')\n      .map(cmd => cmd.trim())\n      .filter(Boolean);\n    const creationCommands = commands.filter(cmd => cmd.startsWith(\"_.assign('',\"));\n    const relationCommands = commands.filter(cmd => cmd.startsWith(\"_.assign('.\") && cmd.includes(\".'\"));\n    const otherCommands = commands.filter(cmd => !creationCommands.includes(cmd) && !relationCommands.includes(cmd));\n\n    const sortedScript = [...creationCommands, ...relationCommands, ...otherCommands].join(';\\n') + ';';\n\n    if (sortedScript !== updateScript) {\n      console.log('[PATCH] Reordered UpdateVariable script to ensure correct execution order.');\n      updateScript = sortedScript;\n    }\n\n    const latestState = (await tavernService.fetchTavernData())?.[0]?.data ?? store.worldState;\n    const oldState = JSON.parse(JSON.stringify(store.worldState)); // Deep copy for comparison\n    const newVariables = await tavernService.invokeMvuScript(updateScript, latestState);\n    if (newVariables) {\n      try {\n        store.worldState = WorldStateSchema.parse(newVariables) as any;\n      } catch (error) {\n        console.error('Zod validation failed for newVariables from MVU script:', error);\n        notificationService.error('', '');\n        // \n        store.worldState = newVariables as any;\n      }\n      store.character = get(store.worldState, ['', store.userId]) || null;\n      checkForChangesAndNotify(oldState, store.worldState);\n    }\n  }\n}\n\nasync function handleAction(actionText: string) {\n  if (!actionText.trim()) return;\n  if (!store.isReady) await loadAllData();\n\n  store.isGenerating = true;\n  try {\n    const currentState = workflowService.getCurrentState();\n\n    // 1. AI\n    const aiResponseString = await tavernService.generateAiResponse(actionText);\n\n    // 2. \n    const preservedContent = workflowService.popPreservedContent();\n    const finalResponseString = aiResponseString + preservedContent;\n\n    // 3. \n    await processAiResponse(finalResponseString, actionText);\n\n    // 5. \n    await memoryService.updateMemory(store.worldLog);\n\n    // 6. \n    const messages = await tavernService.fetchTavernData();\n    if (messages && messages.length > 0) {\n      const messageZero = messages[0];\n      messageZero.message = finalResponseString; // \n      messageZero.data = JSON.parse(JSON.stringify(store.worldState));\n      await TavernHelper.setChatMessages([messageZero], { refresh: 'none' });\n    }\n\n    // \n    // \n    if (currentState === 'CREATION' || currentState === 'NORMAL') {\n      window.location.reload();\n    }\n  } catch (error) {\n    console.error(':', error);\n    const errorMessage = error instanceof Error ? error.message : String(error);\n    store.generationError = `AI: ${errorMessage}`;\n    notificationService.error('', 'AI');\n  } finally {\n    // \n    if (store.generationError) {\n      setTimeout(() => {\n        store.isGenerating = false;\n        store.generationError = null; // \n      }, 5000);\n    } else {\n      store.isGenerating = false;\n    }\n  }\n}\n\nlet isInitialized = false;\n\nimport { silentUpdater } from '../services/updater';\n\nfunction initializeEventListeners() {\n  if (isInitialized) return;\n  console.log('[Store] Initializing data synchronization...');\n\n  // AI\n  eventOn(tavern_events.GENERATION_ENDED, async () => {\n    console.log('[Store] Generation ended. Fetching all data.');\n    await loadAllData();\n  });\n\n  // \n  silentUpdater.start(loadAllData, 5000); // 5\n\n  isInitialized = true;\n  console.log('[Store] Data synchronization listeners and polling are active.');\n}\n\nasync function fetchReincarnationWorlds() {\n  // \n  if (isSimulationRunning.value || store.reincarnationWorldOptions.length > 0) {\n    return;\n  }\n\n  const allWorlds = await lorebookService.getEntries();\n  if (!allWorlds) {\n    return;\n  }\n\n  const zhutianWorlds = allWorlds.filter((w: WorldbookEntry) => {\n    const name = w.name || (w as any).comment || '';\n    return name.startsWith('') && w.content && w.content.trim() !== '';\n  });\n  const randomWorlds = zhutianWorlds.sort(() => 0.5 - Math.random()).slice(0, 3);\n\n  const parseJson = (jsonString: string) => {\n    try {\n      const cleanedString = jsonString.trim().replace(/,$/, '');\n      return JSON.parse(cleanedString);\n    } catch {\n      return null;\n    }\n  };\n\n  // \n  store.reincarnationWorldOptions = randomWorlds;\n}\n\nfunction resetReincarnationSelection() {\n  store.reincarnationWorldOptions = [];\n  store.selectedWorldForReincarnation = null;\n  console.log('[Actions] Reincarnation selection has been reset.');\n}\n\nasync function prepareReincarnation(world: WorldbookEntry) {\n  if (world) {\n    const worldIdMatch = world.content.match(/ID:\\s*(.*)/);\n    if (worldIdMatch && worldIdMatch[1]) {\n      const worldId = worldIdMatch[1].trim();\n      const command = `< ID=\"${worldId}\">`;\n      // \n      handleAction(command);\n      store.selectedWorldForReincarnation = world; // \n      notificationService.success('', `${world.name || worldId}`);\n    } else {\n      notificationService.error('', 'ID');\n    }\n  }\n}\n\nasync function clearSettlementData() {\n  const script = `\n    _.set('..', false);\n    _.set('..', {});\n  `;\n  try {\n    const latestState = (await tavernService.fetchTavernData())?.[0]?.data ?? store.worldState;\n    const newVariables = await tavernService.invokeMvuScript(script, latestState);\n    if (newVariables) {\n      store.worldState = newVariables;\n      notificationService.success('', '');\n    }\n  } catch (error) {\n    console.error('Failed to clear settlement data:', error);\n    notificationService.error('', '');\n  }\n}\n\nexport const actions = {\n  loadAllData,\n  handleAction,\n  initializeEventListeners,\n  fetchReincarnationWorlds,\n  prepareReincarnation,\n  clearSettlementData,\n  triggerCreationWorkflow: async () => {\n    console.log('[Actions] Triggering CREATION workflow...');\n    // 1.  gametxt\n    const currentNarrative = store.activeView === 'mainWorld' ? store.mainWorldNarrative : store.avatarWorldNarrative;\n    if (currentNarrative) {\n      workflowService.cacheNarrative(currentNarrative);\n    }\n    // 2. CoT\n    await workflowService.switchTo('CREATION');\n    workflowService.setPreserveMode('gametxt'); //  gametxt\n    // CoTCoT\n    await lorebookService.getEntries(true);\n    // 3. \n    notificationService.info('', 'AI...');\n    await handleAction('<>');\n  },\n  triggerIdentityWorkflow: async (world: WorldbookEntry) => {\n    console.log('[Actions] Triggering IDENTITY workflow...');\n    // 1.  gametxt\n    const currentNarrative = store.activeView === 'mainWorld' ? store.mainWorldNarrative : store.avatarWorldNarrative;\n    if (currentNarrative) {\n      workflowService.cacheNarrative(currentNarrative);\n    }\n    // 2. CoT\n    await workflowService.switchTo('IDENTITY');\n    workflowService.setPreserveMode('full'); //  gametxt  UpdateVariable\n    // CoT\n    if (world && world.content) {\n      await lorebookService.writeToLorebook('', world.content, { isEnabled: true, keys: [''] });\n      // \n      const sourceEntryName = world.name || world.comment || '';\n      if (sourceEntryName) {\n        await lorebookService.writeToLorebook(sourceEntryName, '', { isEnabled: false, keys: [sourceEntryName] });\n      }\n    }\n    // 3.  prepareReincarnation \n    await prepareReincarnation(world);\n  },\n  selectAvatarAndStart: async (avatarName: string) => {\n    console.log(`[Actions] Avatar \"${avatarName}\" selected. Switching to NORMAL workflow and sending action...`);\n\n    // 1.  gametxt ()\n    const currentNarrative = store.activeView === 'mainWorld' ? store.mainWorldNarrative : store.avatarWorldNarrative;\n    if (currentNarrative) {\n      workflowService.cacheNarrative(currentNarrative);\n    }\n\n    // 2. CoT\n    await workflowService.switchTo('NORMAL');\n\n    // CoTCoT\n    await lorebookService.getEntries(true);\n\n    // 3. \n    const command = `< ${avatarName}>`;\n    notificationService.info('', `${avatarName}...`);\n\n    // 4.  handleAction\n    await handleAction(command);\n\n    // 5. \n    store.reincarnationAvatarOptions = [];\n  },\n  setActiveView(view: 'mainWorld' | 'avatarWorld') {\n    store.activeView = view;\n  },\n  switchFocus(targetWorld: 'mainWorld' | 'avatarWorld') {\n    // \n    store.activeView = targetWorld;\n\n    const targetName = targetWorld === 'mainWorld' ? '' : '';\n    const command = `< ${targetName}>`;\n    commandService.addCommand(command);\n    notificationService.info('', `${targetName}`);\n  },\n  // \n  addActionToQueue(action: any) {\n    console.warn('[Actions] addActionToQueue is not implemented yet.', action);\n  },\n  resetReincarnationSelection,\n};\n\n/**\n * \n */\nfunction parseBlock(block: string): { [key: string]: string } {\n  const data: { [key: string]: string } = {};\n  const lines = block.trim().split('\\n');\n  let currentKey = '';\n  for (const line of lines) {\n    const separatorIndex = line.indexOf('|');\n    if (separatorIndex !== -1) {\n      // This line defines a new key-value pair\n      const key = line.substring(0, separatorIndex).trim();\n      const value = line.substring(separatorIndex + 1).trim();\n      data[key] = value;\n      currentKey = key;\n    } else if (currentKey && line.trim()) {\n      // This is a continuation of the previous key's value. Append with a newline.\n      // The `.trim()` check prevents adding empty lines.\n      data[currentKey] += '\\n' + line;\n    }\n  }\n  // Trim the final value for each key to remove leading/trailing whitespace from multi-line content\n  for (const key in data) {\n    data[key] = data[key].trim();\n  }\n  return data;\n}\n","import { reactive, readonly } from 'vue';\nimport { store } from '../store';\n\ninterface InputModalState {\n  isVisible: boolean;\n  inputValue: string;\n  lastSubmittedValue: string;\n}\n\nconst STORAGE_KEY = 'reincarnation-simulator-input-value';\nconst LAST_SUBMITTED_STORAGE_KEY = 'reincarnation-simulator-last-submitted';\n\nconst state = reactive<InputModalState>({\n  isVisible: false,\n  inputValue: localStorage.getItem(STORAGE_KEY) || '',\n  lastSubmittedValue: localStorage.getItem(LAST_SUBMITTED_STORAGE_KEY) || '',\n});\n\nconst actions = {\n  show(): void {\n    if (store.generationError) {\n      // \n      state.inputValue = state.lastSubmittedValue;\n    }\n    state.isVisible = true;\n  },\n\n  hide(): void {\n    state.isVisible = false;\n  },\n\n  setValue(value: string): void {\n    state.inputValue = value;\n    localStorage.setItem(STORAGE_KEY, value);\n  },\n\n  setLastSubmittedValue(value: string): void {\n    state.lastSubmittedValue = value;\n    localStorage.setItem(LAST_SUBMITTED_STORAGE_KEY, value);\n  },\n\n  clearValue(): void {\n    state.inputValue = '';\n    localStorage.removeItem(STORAGE_KEY);\n  },\n};\n\nexport const inputModalState = readonly(state);\nexport const inputModalActions = actions;\n","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, withModifiers as _withModifiers, withKeys as _withKeys, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"enhanced-input-box-container\" };\nconst _hoisted_2 = { class: \"input-wrapper\" };\nconst _hoisted_3 = [\"value\", \"placeholder\", \"onKeypress\"];\nimport { computed } from 'vue';\nimport { commandService } from '../../services/CommandService';\nimport { inputHistoryService } from '../../services/InputHistoryService';\nimport { inputModalActions, inputModalState } from '../../services/InputModalService';\nimport { workflowService } from '../../services/WorkflowService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'EnhancedInputBox',\n    props: {\n        placeholder: {\n            type: String,\n            default: '...',\n        },\n    },\n    emits: ['submit-action', 'toggle-action-panel'],\n    setup(__props, { emit: __emit }) {\n        const emit = __emit;\n        const inputValue = computed(() => inputModalState.inputValue);\n        const commands = computed(() => commandService.getCommands());\n        const onInput = (event) => {\n            const target = event.target;\n            inputModalActions.setValue(target.value);\n        };\n        const submitAction = () => {\n            const trimmedInput = inputValue.value.trim();\n            const hasCommands = commands.value.length > 0;\n            if (!trimmedInput && !hasCommands) {\n                return;\n            }\n            if (trimmedInput) {\n                inputHistoryService.add(trimmedInput);\n            }\n            let combinedContent = '';\n            if (hasCommands) {\n                combinedContent += '[]\\n' + commands.value.map(cmd => `- ${cmd}`).join('\\n');\n            }\n            if (trimmedInput) {\n                if (hasCommands) {\n                    combinedContent += '\\n';\n                }\n                combinedContent += `<>\\n${trimmedInput}\\n</>`;\n            }\n            workflowService.switchTo('NORMAL', true);\n            emit('submit-action', combinedContent);\n            commandService.clearCommands();\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"button\", {\n                        class: \"action-button activator\",\n                        onClick: _cache[0] || (_cache[0] = ($event) => (_ctx.$emit('toggle-action-panel')))\n                    }, \"\"),\n                    _createElementVNode(\"textarea\", {\n                        value: inputValue.value,\n                        onInput: onInput,\n                        placeholder: __props.placeholder,\n                        onKeypress: _withKeys(_withModifiers(submitAction, [\"exact\", \"prevent\"]), [\"enter\"])\n                    }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_3),\n                    _createElementVNode(\"button\", {\n                        class: \"action-button primary\",\n                        onClick: submitAction\n                    }, \"\")\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./EnhancedInputBox.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./EnhancedInputBox.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./EnhancedInputBox.vue?vue&type=style&index=0&id=1eccedfd&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1eccedfd\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = { class: \"input-history-popup\" };\nconst _hoisted_2 = { class: \"history-section\" };\nconst _hoisted_3 = { key: 0 };\nconst _hoisted_4 = [\"onClick\"];\nconst _hoisted_5 = { class: \"actions\" };\nconst _hoisted_6 = [\"onClick\", \"disabled\"];\nconst _hoisted_7 = [\"onClick\"];\nconst _hoisted_8 = {\n    key: 1,\n    class: \"empty-text\"\n};\nconst _hoisted_9 = { class: \"history-section\" };\nconst _hoisted_10 = { key: 0 };\nconst _hoisted_11 = [\"onClick\"];\nconst _hoisted_12 = { class: \"actions\" };\nconst _hoisted_13 = [\"onClick\"];\nconst _hoisted_14 = {\n    key: 1,\n    class: \"empty-text\"\n};\nimport { inputHistoryService } from '../../services/InputHistoryService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'InputHistoryPopup',\n    emits: ['select-entry', 'close'],\n    setup(__props, { emit: __emit }) {\n        const historyState = inputHistoryService.state;\n        const emit = __emit;\n        const useEntry = (entry) => {\n            emit('select-entry', entry);\n        };\n        const saveEntry = (entry) => {\n            inputHistoryService.save(entry);\n        };\n        const deleteRecentEntry = (index) => {\n            inputHistoryService.deleteRecent(index);\n        };\n        const deleteSavedEntry = (index) => {\n            inputHistoryService.deleteSaved(index);\n        };\n        const isSaved = (entry) => {\n            return historyState.saved.includes(entry);\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[1] || (_cache[1] = _createElementVNode(\"h4\", null, \"\", -1 /* CACHED */)),\n                    (_unref(historyState).recent.length > 0)\n                        ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_3, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(historyState).recent, (entry, index) => {\n                                return (_openBlock(), _createElementBlock(\"li\", {\n                                    key: `recent-${index}`\n                                }, [\n                                    _createElementVNode(\"span\", {\n                                        class: \"entry-text\",\n                                        onClick: ($event) => (useEntry(entry))\n                                    }, _toDisplayString(entry), 9 /* TEXT, PROPS */, _hoisted_4),\n                                    _createElementVNode(\"div\", _hoisted_5, [\n                                        _createElementVNode(\"button\", {\n                                            onClick: ($event) => (saveEntry(entry)),\n                                            disabled: isSaved(entry)\n                                        }, \"\", 8 /* PROPS */, _hoisted_6),\n                                        _createElementVNode(\"button\", {\n                                            onClick: ($event) => (deleteRecentEntry(index))\n                                        }, \"\", 8 /* PROPS */, _hoisted_7)\n                                    ])\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"p\", _hoisted_8, \"\"))\n                ]),\n                _createElementVNode(\"div\", _hoisted_9, [\n                    _cache[2] || (_cache[2] = _createElementVNode(\"h4\", null, \"\", -1 /* CACHED */)),\n                    (_unref(historyState).saved.length > 0)\n                        ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_10, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(historyState).saved, (entry, index) => {\n                                return (_openBlock(), _createElementBlock(\"li\", {\n                                    key: `saved-${index}`\n                                }, [\n                                    _createElementVNode(\"span\", {\n                                        class: \"entry-text\",\n                                        onClick: ($event) => (useEntry(entry))\n                                    }, _toDisplayString(entry), 9 /* TEXT, PROPS */, _hoisted_11),\n                                    _createElementVNode(\"div\", _hoisted_12, [\n                                        _createElementVNode(\"button\", {\n                                            onClick: ($event) => (deleteSavedEntry(index))\n                                        }, \"\", 8 /* PROPS */, _hoisted_13)\n                                    ])\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"p\", _hoisted_14, \"\"))\n                ]),\n                _createElementVNode(\"button\", {\n                    onClick: _cache[0] || (_cache[0] = ($event) => (_ctx.$emit('close'))),\n                    class: \"close-button-popup\"\n                }, \"\")\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./InputHistoryPopup.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./InputHistoryPopup.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./InputHistoryPopup.vue?vue&type=style&index=0&id=4ad5c044&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-4ad5c044\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, Transition as _Transition, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = { class: \"notification__content\" };\nconst _hoisted_2 = { class: \"notification__title\" };\nconst _hoisted_3 = { class: \"notification__message\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'Notification',\n    props: {\n        notification: {}\n    },\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createBlock(_Transition, { name: \"notification-fade\" }, {\n                default: _withCtx(() => [\n                    _createElementVNode(\"div\", {\n                        class: _normalizeClass(['notification', `notification--${__props.notification.type}`])\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_1, [\n                            _createElementVNode(\"h4\", _hoisted_2, _toDisplayString(__props.notification.title), 1 /* TEXT */),\n                            _createElementVNode(\"p\", _hoisted_3, _toDisplayString(__props.notification.message), 1 /* TEXT */)\n                        ]),\n                        _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"notification__arrow\" }, null, -1 /* CACHED */))\n                    ], 2 /* CLASS */)\n                ]),\n                _: 1 /* STABLE */\n            }));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./Notification.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./Notification.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./Notification.vue?vue&type=style&index=0&id=1c1a0898&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = { class: \"notification-container\" };\nimport { notificationState } from '../../services/NotificationService';\nimport Notification from './Notification.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NotificationContainer',\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(notificationState).notifications, (notification) => {\n                    return (_openBlock(), _createBlock(Notification, {\n                        key: notification.id,\n                        notification: notification\n                    }, null, 8 /* PROPS */, [\"notification\"]));\n                }), 128 /* KEYED_FRAGMENT */))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NotificationContainer.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NotificationContainer.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NotificationContainer.vue?vue&type=style&index=0&id=fa029a0a&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, normalizeStyle as _normalizeStyle } from \"vue\";\nconst _hoisted_1 = { class: \"radial-menu-container\" };\nconst _hoisted_2 = [\"onClick\"];\nconst _hoisted_3 = { class: \"item-content\" };\nconst _hoisted_4 = { class: \"icon\" };\nconst _hoisted_5 = { class: \"text\" };\nconst _hoisted_6 = { class: \"item-content\" };\nconst _hoisted_7 = { class: \"icon\" };\nconst _hoisted_8 = { class: \"text\" };\nconst _hoisted_9 = {\n    key: 1,\n    class: \"icon\"\n};\nimport { computed, toRefs } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'RadialMenu',\n    props: {\n        options: {}\n    },\n    emits: ['close'],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emit = __emit;\n        const { options } = toRefs(props);\n        const centerOption = computed(() => options.value.find(opt => opt.id === 'unpin'));\n        const regularOptions = computed(() => options.value.filter(opt => opt.id !== 'unpin'));\n        const menuStyle = computed(() => ({}));\n        const getItemStyle = (index) => {\n            if (regularOptions.value.length === 0)\n                return {};\n            const angle = (index / regularOptions.value.length) * 2 * Math.PI - Math.PI / 2;\n            const radius = 120; // px\n            const x = radius * Math.cos(angle);\n            const y = radius * Math.sin(angle);\n            return {\n                transform: `translate(${x}px, ${y}px)`,\n            };\n        };\n        const closeMenu = () => {\n            emit('close');\n        };\n        const selectOption = (option) => {\n            if (option.disabled && option.disabled()) {\n                return;\n            }\n            option.action();\n            closeMenu();\n        };\n        const handleCenterClick = () => {\n            if (centerOption.value) {\n                selectOption(centerOption.value);\n            }\n            else {\n                closeMenu();\n            }\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", {\n                    class: \"radial-menu\",\n                    style: _normalizeStyle(menuStyle.value)\n                }, [\n                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(regularOptions.value, (option, index) => {\n                        return (_openBlock(), _createElementBlock(\"div\", {\n                            key: option.id,\n                            class: _normalizeClass([\"menu-item\", { 'is-disabled': option.disabled && option.disabled() }]),\n                            style: _normalizeStyle(getItemStyle(index)),\n                            onClick: ($event) => (selectOption(option))\n                        }, [\n                            _createElementVNode(\"div\", _hoisted_3, [\n                                _createElementVNode(\"span\", _hoisted_4, _toDisplayString(option.icon), 1 /* TEXT */),\n                                _createElementVNode(\"span\", _hoisted_5, _toDisplayString(option.text), 1 /* TEXT */)\n                            ])\n                        ], 14 /* CLASS, STYLE, PROPS */, _hoisted_2));\n                    }), 128 /* KEYED_FRAGMENT */)),\n                    _createElementVNode(\"div\", {\n                        class: \"menu-item center-button\",\n                        onClick: handleCenterClick\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_6, [\n                            (centerOption.value)\n                                ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                                    _createElementVNode(\"span\", _hoisted_7, _toDisplayString(centerOption.value.icon), 1 /* TEXT */),\n                                    _createElementVNode(\"span\", _hoisted_8, _toDisplayString(centerOption.value.text), 1 /* TEXT */)\n                                ], 64 /* STABLE_FRAGMENT */))\n                                : (_openBlock(), _createElementBlock(\"span\", _hoisted_9, \"\"))\n                        ])\n                    ])\n                ], 4 /* STYLE */)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./RadialMenu.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./RadialMenu.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./RadialMenu.vue?vue&type=style&index=0&id=7cbd0274&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7cbd0274\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"icon\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'SideMenuButton',\n    props: {\n        icon: {}\n    },\n    emits: ['open'],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emit = __emit;\n        const handleClick = (event) => {\n            emit('open', { x: event.clientX, y: event.clientY });\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"button\", {\n                class: \"side-menu-button\",\n                onClick: handleClick\n            }, [\n                _createElementVNode(\"span\", _hoisted_1, _toDisplayString(__props.icon), 1 /* TEXT */)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./SideMenuButton.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SideMenuButton.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./SideMenuButton.vue?vue&type=style&index=0&id=5fd70906&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-5fd70906\"]])\n\nexport default __exports__","// @ts-ignore\nimport { DockManager, PanelContainer } from 'https://esm.sh/dock-spawn-ts';\nimport { h, render } from 'vue';\n\n/**\n * A service to manage the dock layout and panels.\n * It encapsulates the logic for creating, showing, and managing dockable panels.\n */\nclass DockManagerService {\n  private dockManager: DockManager | null = null;\n  private hostElement: HTMLElement | null = null;\n  private panelMap: Map<string, any> = new Map(); // Store dialogs to handle floating panels\n  private pinnedPanelState: Map<string, { x: number; y: number; width: number; height: number }> = new Map();\n  public onAction: ((action: string) => void) | null = null;\n  private readonly DOCK_LAYOUT_STORAGE_KEY = 'reincarnation-simulator-dock-layout';\n  private readonly PINNED_STATE_STORAGE_KEY = 'reincarnation-simulator-pinned-panels';\n\n  /**\n   * Initializes the DockManager with a host element.\n   * @param hostElement The HTML element that will contain the dock layout.\n   */\n  initialize(hostElement: HTMLElement) {\n    if (this.dockManager || !hostElement) return;\n\n    this.loadPinnedState(); // Load pinned state first\n\n    this.hostElement = hostElement;\n    this.dockManager = new DockManager(this.hostElement);\n    this.dockManager.initialize();\n\n    // Load layout from localStorage if it exists\n    const savedLayout = localStorage.getItem(this.DOCK_LAYOUT_STORAGE_KEY);\n    if (savedLayout) {\n      try {\n        this.dockManager.loadState(savedLayout);\n      } catch (error) {\n        console.error('Failed to load saved dock layout:', error);\n        localStorage.removeItem(this.DOCK_LAYOUT_STORAGE_KEY);\n      }\n    }\n\n    // Save layout whenever it changes\n    this.dockManager.addLayoutListener('layoutChanged', this.saveLayout.bind(this));\n\n    window.addEventListener('resize', () =>\n      this.dockManager?.resize(this.hostElement!.clientWidth, this.hostElement!.clientHeight),\n    );\n\n    this.dockManager.resize(this.hostElement.clientWidth, this.hostElement.clientHeight);\n  }\n\n  /**\n   * Opens or focuses a panel with the given Vue component.\n   */\n  openPanel(panelId: string, title: string, component: any, props: Record<string, any> = {}) {\n    if (!this.dockManager || !this.hostElement) {\n      console.error('DockManager not initialized.');\n      return;\n    }\n\n    if (this.panelMap.has(panelId)) {\n      const existingDialog = this.panelMap.get(panelId)!;\n      if (document.body.contains(existingDialog.element)) {\n        existingDialog.bringToFront();\n        return;\n      } else {\n        this.panelMap.delete(panelId);\n      }\n    }\n\n    const panelHostDiv = document.createElement('div');\n    panelHostDiv.style.width = '100%';\n    panelHostDiv.style.height = '100%';\n    panelHostDiv.style.overflow = 'auto';\n\n    const vnode = h(component, props);\n    render(vnode, panelHostDiv);\n\n    const newPanel = new PanelContainer(panelHostDiv, this.dockManager);\n    newPanel.setTitle(title);\n\n    const dragListener = (e: MouseEvent) => {\n      if (this.pinnedPanelState.has(panelId)) {\n        const target = e.target as HTMLElement;\n        if (!target.closest('div[class*=\"panel-titlebar-button\"]')) {\n          e.stopPropagation();\n        }\n      }\n    };\n\n    newPanel.onClose = () => {\n      this.panelMap.delete(panelId);\n      render(null, panelHostDiv);\n      if (newPanel.elementTitle) {\n        newPanel.elementTitle.removeEventListener('mousedown', dragListener, true);\n      }\n    };\n\n    const pinnedState = this.pinnedPanelState.get(panelId);\n    const dialogWidth = pinnedState ? pinnedState.width : 600;\n    const dialogHeight = pinnedState ? pinnedState.height : 500;\n    const hostWidth = this.hostElement.clientWidth;\n    const hostHeight = this.hostElement.clientHeight;\n    const x = pinnedState ? pinnedState.x : Math.max(0, (hostWidth - dialogWidth) / 2);\n    const y = pinnedState ? pinnedState.y : Math.max(0, (hostHeight - dialogHeight) / 2);\n\n    const dialog = this.dockManager.floatDialog(newPanel, x, y);\n    dialog.resize(dialogWidth, dialogHeight);\n\n    if (pinnedState) {\n      newPanel.resize(pinnedState.width, pinnedState.height);\n    }\n\n    setTimeout(() => {\n      this.addPinButton(panelId, newPanel, dialog, dragListener);\n    }, 0);\n\n    this.panelMap.set(panelId, dialog);\n  }\n\n  /**\n   * Forces the dock manager to recalculate its layout.\n   * This is useful when the container size changes without a window resize event.\n   */\n  updateLayout() {\n    if (this.dockManager && this.hostElement) {\n      this.dockManager.resize(this.hostElement.clientWidth, this.hostElement.clientHeight);\n    }\n  }\n\n  /**\n   * Adds a pin button to the panel's title bar.\n   */\n  private addPinButton(panelId: string, panel: PanelContainer, dialog: any, dragListener: (e: MouseEvent) => void) {\n    if (!panel.elementTitle || panel.elementTitle.querySelector('.panel-titlebar-button-pin')) {\n      return;\n    }\n\n    const pinButtonHTML = `<div class=\"panel-titlebar-button-pin\" title=\"/\"></div>`;\n    panel.elementTitle.insertAdjacentHTML('afterbegin', pinButtonHTML);\n\n    const pinButton = panel.elementTitle.querySelector<HTMLElement>('.panel-titlebar-button-pin');\n    if (!pinButton) return;\n\n    panel.elementTitle.addEventListener('mousedown', dragListener, true);\n\n    const isLocked = this.pinnedPanelState.has(panelId);\n    this.applyPinState(pinButton, dialog, isLocked);\n\n    pinButton.addEventListener('click', (e: MouseEvent) => {\n      e.stopPropagation();\n      const currentlyLocked = this.pinnedPanelState.has(panelId);\n      if (currentlyLocked) {\n        this.pinnedPanelState.delete(panelId);\n      } else if (this.hostElement) {\n        const hostRect = this.hostElement.getBoundingClientRect();\n        const panelRect = panel.elementPanel.getBoundingClientRect();\n        const state = {\n          x: panelRect.left - hostRect.left,\n          y: panelRect.top - hostRect.top,\n          width: panel.width,\n          height: panel.height,\n        };\n        this.pinnedPanelState.set(panelId, state);\n      }\n      this.savePinnedState(); // Save the state whenever it's changed\n      this.applyPinState(pinButton, dialog, !currentlyLocked);\n    });\n  }\n\n  private applyPinState(pinButton: HTMLElement, dialog: any, isLocked: boolean) {\n    pinButton.classList.toggle('locked', isLocked);\n    if (dialog) {\n      dialog.noDocking = isLocked;\n      if (dialog.resizable) {\n        dialog.resizable.enabled = !isLocked;\n      }\n    }\n  }\n\n  private saveLayout() {\n    if (this.dockManager) {\n      const layoutState = this.dockManager.saveState();\n      localStorage.setItem(this.DOCK_LAYOUT_STORAGE_KEY, layoutState);\n    }\n  }\n\n  private savePinnedState() {\n    const stateToSave = Array.from(this.pinnedPanelState.entries());\n    localStorage.setItem(this.PINNED_STATE_STORAGE_KEY, JSON.stringify(stateToSave));\n  }\n\n  private loadPinnedState() {\n    const savedState = localStorage.getItem(this.PINNED_STATE_STORAGE_KEY);\n    if (savedState) {\n      try {\n        const parsedState = JSON.parse(savedState);\n        this.pinnedPanelState = new Map(parsedState);\n      } catch (error) {\n        console.error('Failed to load pinned panel state:', error);\n        this.pinnedPanelState = new Map();\n      }\n    }\n  }\n\n  /**\n   * Closes all currently open panels.\n   */\n  closeAllPanels() {\n    if (!this.dockManager) return;\n    // Create a copy of the keys to avoid issues with modifying the map while iterating\n    const panelIds = Array.from(this.panelMap.keys());\n    panelIds.forEach(panelId => {\n      const dialog = this.panelMap.get(panelId);\n      if (dialog && dialog.panel) {\n        const panel = dialog.panel as PanelContainer;\n        // 1. Unmount the Vue component\n        if (panel.elementContent) {\n          render(null, panel.elementContent);\n        }\n        // 2. Close the panel container itself to remove it from the layout\n        panel.close();\n      }\n    });\n    // After closing all, clear the map\n    this.panelMap.clear();\n  }\n\n  /**\n   * Unpins all currently pinned panels.\n   */\n  unpinAllPanels() {\n    this.pinnedPanelState.clear();\n    this.savePinnedState(); // Clear from localStorage as well\n\n    if (!this.dockManager) return;\n\n    // Iterate over all active panels and visually unlock them\n    this.panelMap.forEach((dialog, panelId) => {\n      const panel = dialog.panel;\n      if (panel && panel.elementTitle) {\n        const pinButton = panel.elementTitle.querySelector('.panel-titlebar-button-pin') as HTMLElement;\n        if (pinButton) {\n          this.applyPinState(pinButton, dialog, false);\n        }\n      }\n    });\n  }\n\n  /**\n   * Destroys the DockManager instance.\n   */\n  destroy() {\n    if (this.dockManager) {\n      this.dockManager.on('layoutChanged', () => {}); // Remove listener\n      this.dockManager.dispose();\n      this.dockManager = null;\n    }\n    this.panelMap.clear();\n    window.removeEventListener('resize', () => {});\n  }\n}\n\nexport const dockManagerService = new DockManagerService();\n","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeStyle as _normalizeStyle } from \"vue\";\nconst _hoisted_1 = { class: \"destiny-plate-container\" };\nconst _hoisted_2 = { class: \"destiny-plate\" };\nconst _hoisted_3 = { class: \"plate-center\" };\nconst _hoisted_4 = { class: \"plate-core\" };\nconst _hoisted_5 = { class: \"core-title\" };\nconst _hoisted_6 = { class: \"core-description\" };\nconst _hoisted_7 = { class: \"inner-ring\" };\nconst _hoisted_8 = [\"onMouseenter\"];\nconst _hoisted_9 = { class: \"node-name\" };\nconst _hoisted_10 = { class: \"node-value\" };\nconst _hoisted_11 = { class: \"middle-ring\" };\nconst _hoisted_12 = [\"onMouseenter\"];\nconst _hoisted_13 = { class: \"node-name\" };\nconst _hoisted_14 = { class: \"node-value\" };\nconst _hoisted_15 = { class: \"outer-ring\" };\nconst _hoisted_16 = {\n    class: \"orbit-svg\",\n    viewBox: \"0 0 100 100\"\n};\nconst _hoisted_17 = [\"onMouseenter\"];\nconst _hoisted_18 = [\"onMouseenter\"];\nconst _hoisted_19 = { class: \"node-name\" };\nconst _hoisted_20 = {\n    key: 0,\n    class: \"node-value\"\n};\nimport { computed, ref } from 'vue';\nimport { store } from '../../store';\nconst defaultTitle = '';\nconst defaultDescription = '';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'DestinyPlate',\n    props: {\n        character: {\n            type: Object,\n            default: null,\n        },\n    },\n    setup(__props) {\n        const props = __props;\n        const centerTitle = ref(defaultTitle);\n        const centerDescription = ref(defaultDescription);\n        const getDisplayValue = (value, defaultValue = 0) => {\n            if (value === null || value === undefined)\n                return defaultValue;\n            return value;\n        };\n        const formatComplexValue = (value) => {\n            if (value === null || value === undefined)\n                return null;\n            if (typeof value === 'object' && !Array.isArray(value)) {\n                const keys = Object.keys(value).filter(k => k !== '$meta' && k !== 'description');\n                if (keys.includes('value'))\n                    return getDisplayValue(value.value);\n                if (keys.length > 0 && keys.every(k => typeof value[k] === 'object' && value[k]?.)) {\n                    return value[keys[0]].; // \n                }\n                if (keys.length === 1)\n                    return formatComplexValue(value[keys[0]]);\n                return '...';\n            }\n            return value;\n        };\n        //  prop store\n        const characterData = computed(() => props.character || store.character);\n        // \n        const innerRingNodes = computed(() => {\n            const char = characterData.value;\n            return [\n                { id: 'name', name: '', value: getDisplayValue(char?., ''), description: '' },\n                { id: 'soul', name: '', value: getDisplayValue(char?., 0), description: '' },\n                { id: 'dao', name: '', value: getDisplayValue(char?., 0), description: '' },\n                {\n                    id: 'jing',\n                    name: '',\n                    value: getDisplayValue(char?.?.),\n                    description: '',\n                },\n                { id: 'qi', name: '', value: getDisplayValue(char?.?.), description: '' },\n                { id: 'shen', name: '', value: getDisplayValue(char?.?.), description: '' },\n                { id: 'yun', name: '', value: getDisplayValue(char?.?.), description: '' },\n            ];\n        });\n        // \n        const combatParams = computed(() => {\n            const char = characterData.value;\n            return [\n                {\n                    id: 'quanneng',\n                    name: '',\n                    value: getDisplayValue(char?.?.),\n                    description: '',\n                },\n                {\n                    id: 'genji',\n                    name: '',\n                    value: getDisplayValue(char?.?.),\n                    description: '',\n                },\n                {\n                    id: 'jibian',\n                    name: '',\n                    value: getDisplayValue(char?.?.),\n                    description: '',\n                },\n                {\n                    id: 'pofa',\n                    name: '',\n                    value: getDisplayValue(char?.?.),\n                    description: '',\n                },\n                {\n                    id: 'yufa',\n                    name: '',\n                    value: getDisplayValue(char?.?.),\n                    description: '',\n                },\n            ];\n        });\n        // \n        const orbitalNodes = computed(() => {\n            const attrs = characterData.value?. || {};\n            const specialKeys = ['', ''];\n            return Object.entries(attrs)\n                .filter(([key]) => key !== '$meta')\n                .map(([key, attrValue]) => {\n                const isSpecial = specialKeys.includes(key);\n                let description = `: ${key}`;\n                let value = null;\n                let type = 'node';\n                let max = 'MAX';\n                if (typeof attrValue === 'object' && attrValue !== null) {\n                    description = attrValue.description || description;\n                    const valueKeys = Object.keys(attrValue).filter(k => k !== '$meta' && k !== 'description');\n                    if (('current' in attrValue || '' in attrValue) && ('max' in attrValue || '' in attrValue)) {\n                        type = 'orbit';\n                        value = getDisplayValue(attrValue. ?? attrValue.current, 0);\n                        max = getDisplayValue(attrValue. ?? attrValue.max, 100);\n                        description = `${key}: ${value} / ${max}`;\n                    }\n                    else if ('value' in attrValue) {\n                        value = getDisplayValue(attrValue.value, '-');\n                    }\n                    else if (valueKeys.length > 0 &&\n                        valueKeys.every(k => typeof attrValue[k] === 'object' && attrValue[k]?.)) {\n                        value = valueKeys.map(k => attrValue[k].).join('');\n                    }\n                    else if (valueKeys.length > 0) {\n                        value = '...';\n                        description = valueKeys.map(k => `${k}: ${getDisplayValue(attrValue[k])}`).join(' | ');\n                    }\n                }\n                else {\n                    value = getDisplayValue(attrValue, '-');\n                }\n                return { id: key, name: key, value, max, type, description, isSpecial };\n            });\n        });\n        const setCenterContent = (item) => {\n            centerTitle.value = item.name;\n            centerDescription.value = item.description || '';\n        };\n        const resetCenterContent = () => {\n            centerTitle.value = defaultTitle;\n            centerDescription.value = defaultDescription;\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createCommentVNode(\"  \"),\n                    _cache[1] || (_cache[1] = _createElementVNode(\"div\", { class: \"static-orbit orbit-1\" }, null, -1 /* CACHED */)),\n                    _cache[2] || (_cache[2] = _createElementVNode(\"div\", { class: \"static-orbit orbit-2\" }, null, -1 /* CACHED */)),\n                    _cache[3] || (_cache[3] = _createElementVNode(\"div\", { class: \"static-orbit orbit-3\" }, null, -1 /* CACHED */)),\n                    _cache[4] || (_cache[4] = _createElementVNode(\"div\", { class: \"static-orbit orbit-4\" }, null, -1 /* CACHED */)),\n                    _createCommentVNode(\"  \"),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _createElementVNode(\"div\", _hoisted_4, [\n                            _createElementVNode(\"span\", _hoisted_5, _toDisplayString(centerTitle.value), 1 /* TEXT */),\n                            _createElementVNode(\"div\", _hoisted_6, _toDisplayString(centerDescription.value), 1 /* TEXT */)\n                        ])\n                    ]),\n                    _createCommentVNode(\" :  \"),\n                    _createElementVNode(\"div\", _hoisted_7, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(innerRingNodes.value, (node, index) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: node.id,\n                                class: \"node inner-node\",\n                                style: _normalizeStyle({ '--angle': (index / innerRingNodes.value.length) * 360 + 'deg' }),\n                                onMouseenter: ($event) => (setCenterContent(node)),\n                                onMouseleave: resetCenterContent\n                            }, [\n                                _createElementVNode(\"span\", _hoisted_9, _toDisplayString(node.name), 1 /* TEXT */),\n                                _createElementVNode(\"span\", _hoisted_10, _toDisplayString(node.value), 1 /* TEXT */)\n                            ], 44 /* STYLE, PROPS, NEED_HYDRATION */, _hoisted_8));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]),\n                    _createCommentVNode(\" :  \"),\n                    _createElementVNode(\"div\", _hoisted_11, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(combatParams.value, (param, index) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: param.id,\n                                class: \"node param-node\",\n                                style: _normalizeStyle({ '--angle': (index / combatParams.value.length) * 360 + 18 + 'deg' }),\n                                onMouseenter: ($event) => (setCenterContent(param)),\n                                onMouseleave: resetCenterContent\n                            }, [\n                                _createElementVNode(\"span\", _hoisted_13, _toDisplayString(param.name), 1 /* TEXT */),\n                                _createElementVNode(\"span\", _hoisted_14, _toDisplayString(param.value), 1 /* TEXT */)\n                            ], 44 /* STYLE, PROPS, NEED_HYDRATION */, _hoisted_12));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]),\n                    _createCommentVNode(\" :  \"),\n                    _createElementVNode(\"div\", _hoisted_15, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(orbitalNodes.value, (attr, index) => {\n                            return (_openBlock(), _createElementBlock(_Fragment, {\n                                key: attr.id\n                            }, [\n                                _createCommentVNode(\"  'orbit'  \"),\n                                (attr.type === 'orbit')\n                                    ? (_openBlock(), _createElementBlock(\"div\", {\n                                        key: 0,\n                                        class: \"orbit-track\",\n                                        style: _normalizeStyle({ '--angle': (index / orbitalNodes.value.length) * 360 + 'deg' })\n                                    }, [\n                                        (_openBlock(), _createElementBlock(\"svg\", _hoisted_16, [\n                                            _cache[0] || (_cache[0] = _createElementVNode(\"circle\", {\n                                                class: \"track\",\n                                                cx: \"50\",\n                                                cy: \"50\",\n                                                r: \"45\"\n                                            }, null, -1 /* CACHED */)),\n                                            _createElementVNode(\"circle\", {\n                                                class: \"progress\",\n                                                cx: \"50\",\n                                                cy: \"50\",\n                                                r: \"45\",\n                                                style: _normalizeStyle({\n                                                    'stroke-dashoffset': 283 *\n                                                        (1 -\n                                                            (typeof attr.value === 'number' && typeof attr.max === 'number' && attr.max > 0\n                                                                ? attr.value / attr.max\n                                                                : 0)),\n                                                })\n                                            }, null, 4 /* STYLE */)\n                                        ])),\n                                        _createElementVNode(\"div\", {\n                                            class: \"orbit-label\",\n                                            onMouseenter: ($event) => (setCenterContent(attr)),\n                                            onMouseleave: resetCenterContent\n                                        }, _toDisplayString(attr.name), 41 /* TEXT, PROPS, NEED_HYDRATION */, _hoisted_17)\n                                    ], 4 /* STYLE */))\n                                    : (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                                        _createCommentVNode(\"  'node'  \"),\n                                        _createElementVNode(\"div\", {\n                                            class: \"node world-node\",\n                                            style: _normalizeStyle({ '--angle': (index / orbitalNodes.value.length) * 360 + 'deg' }),\n                                            onMouseenter: ($event) => (setCenterContent(attr)),\n                                            onMouseleave: resetCenterContent\n                                        }, [\n                                            _createElementVNode(\"span\", _hoisted_19, _toDisplayString(attr.name), 1 /* TEXT */),\n                                            (attr.value !== null)\n                                                ? (_openBlock(), _createElementBlock(\"span\", _hoisted_20, _toDisplayString(attr.value), 1 /* TEXT */))\n                                                : _createCommentVNode(\"v-if\", true)\n                                        ], 44 /* STYLE, PROPS, NEED_HYDRATION */, _hoisted_18)\n                                    ], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */))\n                            ], 64 /* STABLE_FRAGMENT */));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./DestinyPlate.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DestinyPlate.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./DestinyPlate.vue?vue&type=style&index=0&id=0f9cb796&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-0f9cb796\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, createCommentVNode as _createCommentVNode, createVNode as _createVNode, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"panel-wrapper character-panel-container\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"character-sheet\"\n};\nconst _hoisted_3 = { class: \"drawer-content\" };\nconst _hoisted_4 = { class: \"world-attributes-section\" };\nconst _hoisted_5 = {\n    key: 0,\n    class: \"attributes-list\"\n};\nconst _hoisted_6 = { class: \"label\" };\nconst _hoisted_7 = { class: \"value\" };\nconst _hoisted_8 = {\n    key: 1,\n    class: \"empty-state\"\n};\nconst _hoisted_9 = { class: \"combat-attributes-section\" };\nconst _hoisted_10 = {\n    key: 0,\n    class: \"attributes-list\"\n};\nconst _hoisted_11 = { class: \"label\" };\nconst _hoisted_12 = { class: \"value\" };\nconst _hoisted_13 = {\n    key: 1,\n    class: \"empty-state\"\n};\nconst _hoisted_14 = {\n    key: 1,\n    class: \"loading-state\"\n};\nimport { computed, ref } from 'vue';\nimport { currentAvatar } from '../../../store/getters';\nimport DestinyPlate from '../DestinyPlate.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'AvatarCharacterPanel',\n    setup(__props) {\n        const getDisplayValue = (value, defaultValue = 0) => {\n            if (value === null || value === undefined)\n                return defaultValue;\n            return value;\n        };\n        const formatAttribute = (attr) => {\n            if (attr === null || attr === undefined)\n                return '-';\n            if (typeof attr === 'object' && !Array.isArray(attr)) {\n                if (attr. !== undefined && attr. !== undefined) {\n                    return `${attr.} / ${attr.}`;\n                }\n                const keys = Object.keys(attr).filter(k => k !== '$meta');\n                if (keys.length > 0) {\n                    return Object.entries(attr)\n                        .filter(([key]) => key !== '$meta')\n                        .map(([key, val]) => `${key}: ${getDisplayValue(val)}`)\n                        .join(', ');\n                }\n                return '';\n            }\n            return String(getDisplayValue(attr));\n        };\n        const worldSpecificAttributes = computed(() => currentAvatar.value?. || {});\n        const combatAttributes = computed(() => currentAvatar.value?. || {});\n        const isDrawerOpen = ref(false);\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (_unref(currentAvatar))\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _createCommentVNode(\"  \"),\n                        _createVNode(DestinyPlate, { character: _unref(currentAvatar) }, null, 8 /* PROPS */, [\"character\"]),\n                        _createCommentVNode(\"  \"),\n                        _createElementVNode(\"div\", {\n                            class: _normalizeClass([\"additional-info-drawer\", { 'is-open': isDrawerOpen.value }])\n                        }, [\n                            _createElementVNode(\"button\", {\n                                class: \"drawer-toggle\",\n                                onClick: _cache[0] || (_cache[0] = ($event) => (isDrawerOpen.value = !isDrawerOpen.value))\n                            }, [...(_cache[1] || (_cache[1] = [\n                                    _createElementVNode(\"i\", { class: \"drawer-icon\" }, null, -1 /* CACHED */),\n                                    _createElementVNode(\"span\", null, \"\", -1 /* CACHED */)\n                                ]))]),\n                            _createElementVNode(\"div\", _hoisted_3, [\n                                _createCommentVNode(\"  \"),\n                                _createElementVNode(\"div\", _hoisted_4, [\n                                    _cache[2] || (_cache[2] = _createElementVNode(\"h5\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                                    (worldSpecificAttributes.value && Object.keys(worldSpecificAttributes.value).length > 0)\n                                        ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_5, [\n                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(worldSpecificAttributes.value, (value, key) => {\n                                                return (_openBlock(), _createElementBlock(\"li\", {\n                                                    key: key,\n                                                    class: \"attribute-item\"\n                                                }, [\n                                                    _createElementVNode(\"span\", _hoisted_6, _toDisplayString(key), 1 /* TEXT */),\n                                                    _createElementVNode(\"span\", _hoisted_7, _toDisplayString(formatAttribute(value)), 1 /* TEXT */)\n                                                ]));\n                                            }), 128 /* KEYED_FRAGMENT */))\n                                        ]))\n                                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_8, \"\"))\n                                ]),\n                                _createCommentVNode(\"  \"),\n                                _createElementVNode(\"div\", _hoisted_9, [\n                                    _cache[3] || (_cache[3] = _createElementVNode(\"h5\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                                    (combatAttributes.value && Object.keys(combatAttributes.value).length > 0)\n                                        ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_10, [\n                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(combatAttributes.value, (value, key) => {\n                                                return (_openBlock(), _createElementBlock(\"li\", {\n                                                    key: key,\n                                                    class: \"attribute-item\"\n                                                }, [\n                                                    _createElementVNode(\"span\", _hoisted_11, _toDisplayString(key), 1 /* TEXT */),\n                                                    _createElementVNode(\"span\", _hoisted_12, _toDisplayString(formatAttribute(value)), 1 /* TEXT */)\n                                                ]));\n                                            }), 128 /* KEYED_FRAGMENT */))\n                                        ]))\n                                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_13, \"\"))\n                                ])\n                            ])\n                        ], 2 /* CLASS */)\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_14, \"...\"))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./AvatarCharacterPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AvatarCharacterPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./AvatarCharacterPanel.vue?vue&type=style&index=0&id=8e022938&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-8e022938\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, normalizeStyle as _normalizeStyle, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"panel-wrapper inventory-panel\" };\nconst _hoisted_2 = { class: \"main-content\" };\nconst _hoisted_3 = { class: \"item-grid-container\" };\nconst _hoisted_4 = { class: \"item-grid\" };\nconst _hoisted_5 = [\"onClick\"];\nconst _hoisted_6 = {\n    class: \"item-name-arc\",\n    viewBox: \"0 0 100 100\"\n};\nconst _hoisted_7 = [\"id\"];\nconst _hoisted_8 = [\"xlink:href\"];\nconst _hoisted_9 = { class: \"item-footer\" };\nconst _hoisted_10 = {\n    key: 0,\n    class: \"item-quantity\"\n};\nconst _hoisted_11 = {\n    key: 0,\n    class: \"empty-grid\"\n};\nconst _hoisted_12 = { class: \"scroll-detail-view\" };\nconst _hoisted_13 = {\n    key: 0,\n    class: \"scroll-content\"\n};\nconst _hoisted_14 = { class: \"detail-meta\" };\nconst _hoisted_15 = {\n    key: 0,\n    class: \"meta-tier\"\n};\nconst _hoisted_16 = {\n    key: 1,\n    class: \"meta-type\"\n};\nconst _hoisted_17 = { class: \"detail-desc\" };\nconst _hoisted_18 = {\n    key: 0,\n    class: \"detail-effects\"\n};\nconst _hoisted_19 = { key: 0 };\nconst _hoisted_20 = { key: 1 };\nconst _hoisted_21 = {\n    key: 1,\n    class: \"loading\"\n};\nimport { computed, ref } from 'vue';\nimport { currentAvatar, avatarInventory } from '../../../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'AvatarInventoryPanel',\n    setup(__props) {\n        const selectedItem = ref(null);\n        const selectItem = (item) => {\n            selectedItem.value = item;\n        };\n        const closeDetail = () => {\n            selectedItem.value = null;\n        };\n        const avatarItems = computed(() => {\n            return avatarInventory.value;\n        });\n        const tierColorMap = {\n            common: '128, 128, 128', // grey-stone\n            rare: '45, 200, 240', // cyan-tian\n            epic: '138, 43, 226', // purple-mystery\n            legendary: '218, 165, 32', // gold-liu\n        };\n        const getTierStyle = (item) => {\n            let tierKey = 'common';\n            if (item && item.) {\n                const tier = item.;\n                if (tier >= 9)\n                    tierKey = 'legendary';\n                else if (tier >= 6)\n                    tierKey = 'epic';\n                else if (tier >= 3)\n                    tierKey = 'rare';\n            }\n            return {\n                '--tier-color-rgb': tierColorMap[tierKey],\n            };\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (_unref(currentAvatar))\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 0,\n                        class: _normalizeClass([\"inventory-layout\", { 'detail-open': selectedItem.value }])\n                    }, [\n                        _createCommentVNode(\" Main Content: Categories and Grid \"),\n                        _createElementVNode(\"div\", _hoisted_2, [\n                            _createCommentVNode(\"  \"),\n                            _createElementVNode(\"div\", _hoisted_3, [\n                                _createElementVNode(\"div\", _hoisted_4, [\n                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(avatarItems.value, (item, index) => {\n                                        return (_openBlock(), _createElementBlock(_Fragment, {\n                                            key: item.ID || `item-${index}`\n                                        }, [\n                                            _createCommentVNode(\"  \"),\n                                            _createElementVNode(\"div\", {\n                                                class: \"item-cell\",\n                                                style: _normalizeStyle(getTierStyle(item)),\n                                                onClick: ($event) => (selectItem(item))\n                                            }, [\n                                                _createCommentVNode(\" SVG \"),\n                                                (_openBlock(), _createElementBlock(\"svg\", _hoisted_6, [\n                                                    _createElementVNode(\"defs\", null, [\n                                                        _createCommentVNode(\"  \"),\n                                                        _createElementVNode(\"path\", {\n                                                            id: `arc-path-${item.ID || index}`,\n                                                            d: \"M 12,52 a 38,38 0 1,1 76,0\",\n                                                            fill: \"none\"\n                                                        }, null, 8 /* PROPS */, _hoisted_7)\n                                                    ]),\n                                                    _createElementVNode(\"text\", null, [\n                                                        _createElementVNode(\"textPath\", {\n                                                            class: \"arc-text\",\n                                                            \"xlink:href\": `#arc-path-${item.ID || index}`,\n                                                            startOffset: \"50%\",\n                                                            \"text-anchor\": \"middle\"\n                                                        }, _toDisplayString(item.), 9 /* TEXT, PROPS */, _hoisted_8)\n                                                    ])\n                                                ])),\n                                                _createElementVNode(\"div\", _hoisted_9, [\n                                                    ('' in item && item.)\n                                                        ? (_openBlock(), _createElementBlock(\"span\", _hoisted_10, \"x\" + _toDisplayString(item.), 1 /* TEXT */))\n                                                        : _createCommentVNode(\"v-if\", true)\n                                                ])\n                                            ], 12 /* STYLE, PROPS */, _hoisted_5)\n                                        ], 64 /* STABLE_FRAGMENT */));\n                                    }), 128 /* KEYED_FRAGMENT */))\n                                ]),\n                                (avatarItems.value.length === 0)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [...(_cache[0] || (_cache[0] = [\n                                            _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                                        ]))]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ])\n                        ]),\n                        _createCommentVNode(\" Right: Item Detail Scroll \"),\n                        _createElementVNode(\"div\", _hoisted_12, [\n                            (selectedItem.value)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_13, [\n                                    _createElementVNode(\"button\", {\n                                        onClick: closeDetail,\n                                        class: \"close-button\"\n                                    }, \"\"),\n                                    _createElementVNode(\"h4\", {\n                                        class: \"detail-name\",\n                                        style: _normalizeStyle(getTierStyle(selectedItem.value))\n                                    }, _toDisplayString(selectedItem.value.), 5 /* TEXT, STYLE */),\n                                    _createElementVNode(\"div\", _hoisted_14, [\n                                        (selectedItem.value.)\n                                            ? (_openBlock(), _createElementBlock(\"span\", _hoisted_15, \" \" + _toDisplayString(selectedItem.value.), 1 /* TEXT */))\n                                            : _createCommentVNode(\"v-if\", true),\n                                        (selectedItem.value.)\n                                            ? (_openBlock(), _createElementBlock(\"span\", _hoisted_16, _toDisplayString(selectedItem.value.), 1 /* TEXT */))\n                                            : _createCommentVNode(\"v-if\", true)\n                                    ]),\n                                    _createElementVNode(\"p\", _hoisted_17, _toDisplayString(selectedItem.value.), 1 /* TEXT */),\n                                    (selectedItem.value.effects)\n                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_18, [\n                                            _cache[1] || (_cache[1] = _createElementVNode(\"h5\", null, \":\", -1 /* CACHED */)),\n                                            (selectedItem.value.effects.attributes_bonus && Object.keys(selectedItem.value.effects.attributes_bonus).length > 0)\n                                                ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_19, [\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(selectedItem.value.effects.attributes_bonus, (value, key) => {\n                                                        return (_openBlock(), _createElementBlock(\"li\", { key: key }, _toDisplayString(key) + \" +\" + _toDisplayString(value), 1 /* TEXT */));\n                                                    }), 128 /* KEYED_FRAGMENT */))\n                                                ]))\n                                                : _createCommentVNode(\"v-if\", true),\n                                            (selectedItem.value.effects.percentage_bonus && Object.keys(selectedItem.value.effects.percentage_bonus).length > 0)\n                                                ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_20, [\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(selectedItem.value.effects.percentage_bonus, (value, key) => {\n                                                        return (_openBlock(), _createElementBlock(\"li\", { key: key }, _toDisplayString(key) + \" \" + _toDisplayString(value), 1 /* TEXT */));\n                                                    }), 128 /* KEYED_FRAGMENT */))\n                                                ]))\n                                                : _createCommentVNode(\"v-if\", true)\n                                        ]))\n                                        : _createCommentVNode(\"v-if\", true)\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ])\n                    ], 2 /* CLASS */))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_21, \"...\"))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./AvatarInventoryPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AvatarInventoryPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./AvatarInventoryPanel.vue?vue&type=style&index=0&id=ca49a7a8&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-ca49a7a8\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeClass as _normalizeClass, normalizeStyle as _normalizeStyle, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, unref as _unref } from \"vue\";\nconst _hoisted_1 = { class: \"panel-wrapper tasks-panel-starmap\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"starmap-container\"\n};\nconst _hoisted_3 = { class: \"starmap-svg\" };\nconst _hoisted_4 = [\"d\"];\nconst _hoisted_5 = [\"onClick\"];\nconst _hoisted_6 = { class: \"star-label\" };\nconst _hoisted_7 = [\"onClick\"];\nconst _hoisted_8 = { class: \"detail-desc\" };\nconst _hoisted_9 = { class: \"detail-meta\" };\nconst _hoisted_10 = { key: 0 };\nconst _hoisted_11 = { key: 1 };\nconst _hoisted_12 = { key: 2 };\nconst _hoisted_13 = { key: 3 };\nconst _hoisted_14 = {\n    key: 1,\n    class: \"no-data\"\n};\nimport { get } from 'lodash';\nimport { computed, reactive, ref } from 'vue';\nimport { currentAvatar } from '../../../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'AvatarTasksPanel',\n    setup(__props) {\n        const destiny = computed(() => get(currentAvatar.value, '', null));\n        // [Roo-Fix]  getItemsArray \n        const getItemsArray = (data) => {\n            if (!Array.isArray(data)) {\n                return [];\n            }\n            //  [ [items], \"desc\" ]  [ [items] ]\n            if (Array.isArray(data[0])) {\n                return data[0];\n            }\n            //  [items] ()\n            return data;\n        };\n        const allTasks = computed(() => {\n            if (!destiny.value)\n                return [];\n            const taskObject = get(destiny.value, '', {});\n            return Object.values(taskObject);\n        });\n        const ultimateTask = computed(() => {\n            if (!destiny.value)\n                return null;\n            return get(destiny.value, '', null);\n        });\n        const destinyNodes = computed(() => {\n            return allTasks.value.filter(task => task. === '');\n        });\n        const derivedTasks = computed(() => {\n            return allTasks.value.filter(task => task. === '');\n        });\n        const selectedNode = ref(null);\n        const detailModalStyle = reactive({ top: '0px', left: '0px', transform: 'translate(-50%, -50%)' });\n        const getTaskNameById = (taskId) => {\n            if (!taskId)\n                return '';\n            const task = allTasks.value.find(t => t.ID === taskId);\n            return task ? task. : taskId;\n        };\n        const starPositions = computed(() => {\n            const positions = [];\n            const totalNodes = destinyNodes.value.length;\n            positions.push({ top: '15%', left: '50%' });\n            const startY = 85;\n            const endY = 30;\n            destinyNodes.value.forEach((_, i) => {\n                const progress = totalNodes > 1 ? i / (totalNodes - 1) : 0.5;\n                const y = startY - (startY - endY) * progress;\n                const x = 50 + 20 * Math.sin(progress * Math.PI * 2);\n                positions.push({ top: `${y}%`, left: `${x}%` });\n            });\n            return positions;\n        });\n        const starPaths = computed(() => {\n            if (starPositions.value.length <= 1)\n                return [];\n            const paths = [];\n            for (let i = 0; i < destinyNodes.value.length - 1; i++) {\n                const startPos = starPositions.value[i + 1];\n                const endPos = starPositions.value[i + 2];\n                const d = `M ${parseFloat(startPos.left)} ${parseFloat(startPos.top)} Q ${(parseFloat(startPos.left) + parseFloat(endPos.left)) / 2} ${(parseFloat(startPos.top) + parseFloat(endPos.top)) / 2} ${parseFloat(endPos.left)} ${parseFloat(endPos.top)}`;\n                paths.push({\n                    d,\n                    class: destinyNodes.value[i + 1]. === '' ? 'star-path triggered' : 'star-path',\n                });\n            }\n            if (destinyNodes.value.length > 0) {\n                const lastNodePos = starPositions.value[destinyNodes.value.length];\n                const ultimatePos = starPositions.value[0];\n                const d = `M ${parseFloat(lastNodePos.left)} ${parseFloat(lastNodePos.top)} Q ${(parseFloat(lastNodePos.left) + parseFloat(ultimatePos.left)) / 2} ${(parseFloat(lastNodePos.top) + parseFloat(ultimatePos.top)) / 2} ${parseFloat(ultimatePos.left)} ${parseFloat(ultimatePos.top)}`;\n                paths.push({\n                    d,\n                    class: destinyNodes.value[destinyNodes.value.length - 1]. === '' ? 'star-path triggered' : 'star-path',\n                });\n            }\n            derivedTasks.value.forEach((task, index) => {\n                const parentNode = destinyNodes.value.find(n => n.ID === task.ID);\n                if (parentNode) {\n                    const parentNodeIndex = destinyNodes.value.indexOf(parentNode);\n                    const parentPos = starPositions.value[parentNodeIndex + 1];\n                    const taskPos = getDerivedStarPosition(task, index);\n                    const d = `M ${parseFloat(parentPos.left)} ${parseFloat(parentPos.top)} L ${parseFloat(taskPos.left.replace('calc(', '').replace(')', ''))} ${parseFloat(taskPos.top.replace('calc(', '').replace(')', ''))}`;\n                    paths.push({\n                        d,\n                        class: 'star-path derived-path',\n                    });\n                }\n            });\n            return paths;\n        });\n        const getDerivedStarPosition = (task, index) => {\n            const parentNode = destinyNodes.value.find(n => n.ID === task.ID);\n            if (!parentNode)\n                return { top: '0%', left: '0%' };\n            const parentNodeIndex = destinyNodes.value.indexOf(parentNode);\n            const parentPos = starPositions.value[parentNodeIndex + 1];\n            const offsetX = (index % 2 === 0 ? 5 : -5) * (Math.floor(index / 2) + 1);\n            const offsetY = (index % 2 === 0 ? -5 : 5) * (Math.floor(index / 2) + 1);\n            return {\n                top: `calc(${parentPos.top} + ${offsetY}%)`,\n                left: `calc(${parentPos.left} + ${offsetX}%)`,\n            };\n        };\n        const selectNode = (nodeData, type, event) => {\n            selectedNode.value = { data: nodeData, type, el: event.currentTarget };\n            const starNode = event.currentTarget;\n            const top = `calc(${starNode.style.top} + 20px)`;\n            const left = `calc(${starNode.style.left} + 20px)`;\n            detailModalStyle.top = top;\n            detailModalStyle.left = left;\n        };\n        const startDrag = (event) => {\n            const modal = event.target.closest('.node-detail-modal');\n            if (!modal)\n                return;\n            const startX = event.clientX;\n            const startY = event.clientY;\n            const startTop = modal.offsetTop;\n            const startLeft = modal.offsetLeft;\n            const doDrag = (e) => {\n                detailModalStyle.top = `${startTop + e.clientY - startY}px`;\n                detailModalStyle.left = `${startLeft + e.clientX - startX}px`;\n            };\n            const stopDrag = () => {\n                document.removeEventListener('mousemove', doDrag);\n                document.removeEventListener('mouseup', stopDrag);\n            };\n            document.addEventListener('mousemove', doDrag);\n            document.addEventListener('mouseup', stopDrag);\n        };\n        const getStarPosition = (index) => {\n            return starPositions.value[index] || { top: '50%', left: '50%' };\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (destiny.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        (_openBlock(), _createElementBlock(\"svg\", _hoisted_3, [\n                            _cache[2] || (_cache[2] = _createElementVNode(\"defs\", null, [\n                                _createElementVNode(\"linearGradient\", {\n                                    id: \"grad-triggered\",\n                                    x1: \"0%\",\n                                    y1: \"0%\",\n                                    x2: \"0%\",\n                                    y2: \"100%\"\n                                }, [\n                                    _createElementVNode(\"stop\", {\n                                        offset: \"0%\",\n                                        style: { \"stop-color\": \"rgba(0, 255, 255, 0.8)\" }\n                                    }),\n                                    _createElementVNode(\"stop\", {\n                                        offset: \"100%\",\n                                        style: { \"stop-color\": \"rgba(138, 43, 226, 0.8)\" }\n                                    })\n                                ])\n                            ], -1 /* CACHED */)),\n                            _createCommentVNode(\"  \"),\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(starPaths.value, (path) => {\n                                return (_openBlock(), _createElementBlock(\"path\", {\n                                    key: path.d,\n                                    d: path.d,\n                                    class: _normalizeClass(path.class)\n                                }, null, 10 /* CLASS, PROPS */, _hoisted_4));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ])),\n                        _createCommentVNode(\"  () \"),\n                        (ultimateTask.value)\n                            ? (_openBlock(), _createElementBlock(\"div\", {\n                                key: 0,\n                                class: \"star-node ultimate-star\",\n                                style: _normalizeStyle(getStarPosition(0)),\n                                onClick: _cache[0] || (_cache[0] = ($event) => (selectNode(ultimateTask.value, 'ultimate', $event)))\n                            }, [...(_cache[3] || (_cache[3] = [\n                                    _createElementVNode(\"div\", { class: \"star-core\" }, null, -1 /* CACHED */),\n                                    _createElementVNode(\"div\", { class: \"star-label\" }, \"\", -1 /* CACHED */)\n                                ]))], 4 /* STYLE */))\n                            : _createCommentVNode(\"v-if\", true),\n                        _createCommentVNode(\"  () \"),\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(destinyNodes.value, (node, index) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: node.ID,\n                                class: _normalizeClass([\"star-node destiny-star\", { triggered: node. === '' }]),\n                                style: _normalizeStyle(getStarPosition(index + 1)),\n                                onClick: ($event) => (selectNode(node, 'destiny', $event))\n                            }, [\n                                _cache[4] || (_cache[4] = _createElementVNode(\"div\", { class: \"star-core\" }, null, -1 /* CACHED */)),\n                                _createElementVNode(\"div\", _hoisted_6, _toDisplayString(node.), 1 /* TEXT */)\n                            ], 14 /* CLASS, STYLE, PROPS */, _hoisted_5));\n                        }), 128 /* KEYED_FRAGMENT */)),\n                        _createCommentVNode(\"  () \"),\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(derivedTasks.value, (task, index) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: task.ID,\n                                class: \"star-node derived-star\",\n                                style: _normalizeStyle(getDerivedStarPosition(task, index)),\n                                onClick: ($event) => (selectNode(task, 'derived', $event))\n                            }, [...(_cache[5] || (_cache[5] = [\n                                    _createElementVNode(\"div\", { class: \"star-core\" }, null, -1 /* CACHED */)\n                                ]))], 12 /* STYLE, PROPS */, _hoisted_7));\n                        }), 128 /* KEYED_FRAGMENT */)),\n                        _createCommentVNode(\"  \"),\n                        (selectedNode.value)\n                            ? (_openBlock(), _createElementBlock(\"div\", {\n                                key: 1,\n                                class: \"node-detail-modal\",\n                                style: _normalizeStyle(detailModalStyle)\n                            }, [\n                                _createElementVNode(\"h4\", {\n                                    class: \"detail-title\",\n                                    onMousedown: startDrag\n                                }, _toDisplayString(selectedNode.value.data.), 33 /* TEXT, NEED_HYDRATION */),\n                                _createElementVNode(\"p\", _hoisted_8, _toDisplayString(selectedNode.value.data.), 1 /* TEXT */),\n                                _createElementVNode(\"div\", _hoisted_9, [\n                                    (selectedNode.value.data.)\n                                        ? (_openBlock(), _createElementBlock(\"p\", _hoisted_10, [\n                                            _cache[6] || (_cache[6] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                            _createTextVNode(\" \" + _toDisplayString(selectedNode.value.data.), 1 /* TEXT */)\n                                        ]))\n                                        : _createCommentVNode(\"v-if\", true),\n                                    (selectedNode.value.data.)\n                                        ? (_openBlock(), _createElementBlock(\"p\", _hoisted_11, [\n                                            _cache[7] || (_cache[7] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                            _createTextVNode(\" \" + _toDisplayString(selectedNode.value.data.), 1 /* TEXT */)\n                                        ]))\n                                        : _createCommentVNode(\"v-if\", true),\n                                    (selectedNode.value.data.ID)\n                                        ? (_openBlock(), _createElementBlock(\"p\", _hoisted_12, [\n                                            _cache[8] || (_cache[8] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                            _createTextVNode(\" \" + _toDisplayString(getTaskNameById(selectedNode.value.data.ID)), 1 /* TEXT */)\n                                        ]))\n                                        : _createCommentVNode(\"v-if\", true),\n                                    (selectedNode.value.type === 'ultimate' && selectedNode.value.data.)\n                                        ? (_openBlock(), _createElementBlock(\"p\", _hoisted_13, [\n                                            _cache[9] || (_cache[9] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                            _createTextVNode(\" \" + _toDisplayString(selectedNode.value.data..join(', ')), 1 /* TEXT */)\n                                        ]))\n                                        : _createCommentVNode(\"v-if\", true)\n                                ]),\n                                _createElementVNode(\"button\", {\n                                    class: \"close-button\",\n                                    onClick: _cache[1] || (_cache[1] = ($event) => (selectedNode.value = null))\n                                }, \"\")\n                            ], 4 /* STYLE */))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_14, [\n                        _createElementVNode(\"p\", null, _toDisplayString(_unref(currentAvatar) ? '' : ''), 1 /* TEXT */)\n                    ]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./AvatarTasksPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AvatarTasksPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./AvatarTasksPanel.vue?vue&type=style&index=0&id=1f7a99f8&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1f7a99f8\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createVNode as _createVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveDirective as _resolveDirective, withDirectives as _withDirectives, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"panel-wrapper character-panel-container\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"character-sheet\"\n};\nconst _hoisted_3 = { class: \"drawer-content\" };\nconst _hoisted_4 = { class: \"info-item\" };\nconst _hoisted_5 = { class: \"value\" };\nconst _hoisted_6 = { class: \"info-item\" };\nconst _hoisted_7 = { class: \"value\" };\nconst _hoisted_8 = { class: \"world-attributes-section\" };\nconst _hoisted_9 = {\n    key: 0,\n    class: \"attributes-list\"\n};\nconst _hoisted_10 = { class: \"label\" };\nconst _hoisted_11 = { class: \"value\" };\nconst _hoisted_12 = {\n    key: 1,\n    class: \"empty-state\"\n};\nconst _hoisted_13 = {\n    key: 1,\n    class: \"loading-state\"\n};\nimport { computed, ref } from 'vue';\nimport { playerWorldAttributes } from '../../store/getters';\nimport { store } from '../../store';\nimport DestinyPlate from './DestinyPlate.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'CharacterPanel',\n    setup(__props) {\n        const getDisplayValue = (value, defaultValue = 0) => {\n            if (value === null || value === undefined)\n                return defaultValue;\n            return value;\n        };\n        const formatAttributeValue = (attrValue) => {\n            if (attrValue === null || attrValue === undefined)\n                return '-';\n            if (typeof attrValue === 'object' && !Array.isArray(attrValue)) {\n                const keys = Object.keys(attrValue).filter(k => k !== '$meta' && k !== 'description');\n                // Case 1: Progress bar ({ current: X, max: Y } or { : X, : Y })\n                if (attrValue.current !== undefined && attrValue.max !== undefined) {\n                    return `${attrValue.current} / ${attrValue.max}`;\n                }\n                if (attrValue. !== undefined && attrValue. !== undefined) {\n                    return `${attrValue.} / ${attrValue.}`;\n                }\n                // Case 2: Simple value wrapper ({ value: X })\n                if (attrValue.value !== undefined && keys.length === 1) {\n                    return String(getDisplayValue(attrValue.value));\n                }\n                // Case 3: List of named items ({ spell_01: { : '' } })\n                if (keys.length > 0 && keys.every(k => typeof attrValue[k] === 'object' && attrValue[k]?.)) {\n                    return keys.map(k => attrValue[k].).join('');\n                }\n                // Case 4: Composite structure ({ : 10, : 5 })\n                if (keys.length > 0) {\n                    return keys.map(key => `${key}: ${getDisplayValue(attrValue[key])}`).join(' | ');\n                }\n                return '...';\n            }\n            return String(getDisplayValue(attrValue));\n        };\n        const character = computed(() => store.character);\n        const soulOrigin = computed(() => getDisplayValue(character.value?., 0));\n        const daoHeart = computed(() => getDisplayValue(character.value?., 0));\n        const worldAttributes = playerWorldAttributes;\n        const isDrawerOpen = ref(false);\n        return (_ctx, _cache) => {\n            const _directive_tooltip = _resolveDirective(\"tooltip\");\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (character.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _createCommentVNode(\"  \"),\n                        _createVNode(DestinyPlate, { character: character.value }, null, 8 /* PROPS */, [\"character\"]),\n                        _createCommentVNode(\"  \"),\n                        _createElementVNode(\"div\", {\n                            class: _normalizeClass([\"additional-info-drawer\", { 'is-open': isDrawerOpen.value }])\n                        }, [\n                            _createElementVNode(\"button\", {\n                                class: \"drawer-toggle\",\n                                onClick: _cache[0] || (_cache[0] = ($event) => (isDrawerOpen.value = !isDrawerOpen.value))\n                            }, [...(_cache[1] || (_cache[1] = [\n                                    _createElementVNode(\"i\", { class: \"drawer-icon\" }, null, -1 /* CACHED */),\n                                    _createElementVNode(\"span\", null, \"\", -1 /* CACHED */)\n                                ]))]),\n                            _createElementVNode(\"div\", _hoisted_3, [\n                                _createElementVNode(\"div\", _hoisted_4, [\n                                    _cache[2] || (_cache[2] = _createElementVNode(\"span\", { class: \"label\" }, \":\", -1 /* CACHED */)),\n                                    _createElementVNode(\"span\", _hoisted_5, _toDisplayString(getDisplayValue(character.value., '')), 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_6, [\n                                    _cache[3] || (_cache[3] = _createElementVNode(\"span\", { class: \"label\" }, \":\", -1 /* CACHED */)),\n                                    _createElementVNode(\"span\", _hoisted_7, _toDisplayString(daoHeart.value), 1 /* TEXT */)\n                                ]),\n                                _createCommentVNode(\"  \"),\n                                _createElementVNode(\"div\", _hoisted_8, [\n                                    _cache[4] || (_cache[4] = _createElementVNode(\"h5\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                                    (_unref(worldAttributes).length > 0)\n                                        ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_9, [\n                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(worldAttributes), (attr) => {\n                                                return _withDirectives((_openBlock(), _createElementBlock(\"li\", {\n                                                    key: attr.key,\n                                                    class: \"attribute-item\"\n                                                }, [\n                                                    _createElementVNode(\"span\", _hoisted_10, _toDisplayString(attr.key), 1 /* TEXT */),\n                                                    _createElementVNode(\"span\", _hoisted_11, _toDisplayString(formatAttributeValue(attr.value)), 1 /* TEXT */)\n                                                ])), [\n                                                    [_directive_tooltip, attr.description]\n                                                ]);\n                                            }), 128 /* KEYED_FRAGMENT */))\n                                        ]))\n                                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_12, \"\"))\n                                ])\n                            ])\n                        ], 2 /* CLASS */)\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_13, \"...\"))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./CharacterPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CharacterPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./CharacterPanel.vue?vue&type=style&index=0&id=75993348&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-75993348\"]])\n\nexport default __exports__","import { reactive, markRaw, readonly } from 'vue';\nimport type { Component } from 'vue';\n\ninterface DetailModalState {\n  isVisible: boolean;\n  component: Component | null;\n  props: Record<string, any>;\n  title: string;\n}\n\nconst state = reactive<DetailModalState>({\n  isVisible: false,\n  component: null,\n  props: {},\n  title: '',\n});\n\nexport const detailModalService = {\n  /**\n   * The reactive state of the detail modal.\n   */\n  state: readonly(state),\n\n  /**\n   * Shows a modal with a specified component and props.\n   * @param title The title to display in the modal header.\n   * @param component The Vue component to render inside the modal.\n   * @param props The props to pass to the component.\n   */\n  show(title: string, component: Component, props: Record<string, any> = {}) {\n    state.title = title;\n    state.component = markRaw(component);\n    state.props = props;\n    state.isVisible = true;\n  },\n\n  /**\n   * Hides the currently visible modal.\n   */\n  hide() {\n    state.isVisible = false;\n    // Delay clearing to allow for fade-out animations\n    setTimeout(() => {\n      state.component = null;\n      state.props = {};\n      state.title = '';\n    }, 300);\n  },\n};\n","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n    key: 0,\n    class: \"imprint-detail-modal-content\"\n};\nconst _hoisted_2 = { class: \"imprint-header\" };\nconst _hoisted_3 = { class: \"imprint-name\" };\nconst _hoisted_4 = { class: \"imprint-tags\" };\nconst _hoisted_5 = { class: \"tag type-tag\" };\nconst _hoisted_6 = [\"data-level\"];\nconst _hoisted_7 = { class: \"imprint-body\" };\nconst _hoisted_8 = { class: \"imprint-main-display\" };\nconst _hoisted_9 = [\"data-level\"];\nconst _hoisted_10 = { class: \"imprint-description\" };\nconst _hoisted_11 = { class: \"imprint-effects\" };\nconst _hoisted_12 = {\n    key: 0,\n    class: \"effects-list\"\n};\nconst _hoisted_13 = { class: \"effect-type\" };\nconst _hoisted_14 = { class: \"effect-value\" };\nconst _hoisted_15 = { class: \"effect-type\" };\nconst _hoisted_16 = { class: \"effect-value\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ImprintDetailModal',\n    props: {\n        imprint: {}\n    },\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (__props.imprint)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                    _createElementVNode(\"div\", _hoisted_2, [\n                        _createElementVNode(\"h2\", _hoisted_3, _toDisplayString(__props.imprint.), 1 /* TEXT */),\n                        _createElementVNode(\"div\", _hoisted_4, [\n                            _createElementVNode(\"span\", _hoisted_5, _toDisplayString(__props.imprint.), 1 /* TEXT */),\n                            _createElementVNode(\"span\", {\n                                class: \"tag level-tag\",\n                                \"data-level\": __props.imprint.\n                            }, \" \" + _toDisplayString(__props.imprint.), 9 /* TEXT, PROPS */, _hoisted_6)\n                        ])\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_7, [\n                        _createElementVNode(\"div\", _hoisted_8, [\n                            _createElementVNode(\"div\", {\n                                class: \"imprint-mandala\",\n                                \"data-level\": __props.imprint.\n                            }, [\n                                _createCommentVNode(\" Central visual element, can be an icon or complex SVG \"),\n                                _cache[0] || (_cache[0] = _createElementVNode(\"span\", { class: \"mandala-icon\" }, \"\", -1 /* CACHED */))\n                            ], 8 /* PROPS */, _hoisted_9),\n                            _createElementVNode(\"p\", _hoisted_10, _toDisplayString(__props.imprint.), 1 /* TEXT */)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_11, [\n                            _cache[3] || (_cache[3] = _createElementVNode(\"h3\", { class: \"effects-title\" }, \"\", -1 /* CACHED */)),\n                            (__props.imprint.effects)\n                                ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_12, [\n                                    (__props.imprint.effects.attributes_bonus)\n                                        ? (_openBlock(true), _createElementBlock(_Fragment, { key: 0 }, _renderList(__props.imprint.effects.attributes_bonus, (value, key) => {\n                                            return (_openBlock(), _createElementBlock(\"li\", {\n                                                key: key,\n                                                class: \"effect-item\"\n                                            }, [\n                                                _createElementVNode(\"strong\", _hoisted_13, _toDisplayString(key) + \":\", 1 /* TEXT */),\n                                                _createElementVNode(\"span\", _hoisted_14, \"+\" + _toDisplayString(value), 1 /* TEXT */),\n                                                _cache[1] || (_cache[1] = _createElementVNode(\"p\", { class: \"effect-description\" }, \"\", -1 /* CACHED */))\n                                            ]));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                        : _createCommentVNode(\"v-if\", true),\n                                    (__props.imprint.effects.percentage_bonus)\n                                        ? (_openBlock(true), _createElementBlock(_Fragment, { key: 1 }, _renderList(__props.imprint.effects.percentage_bonus, (value, key) => {\n                                            return (_openBlock(), _createElementBlock(\"li\", {\n                                                key: key,\n                                                class: \"effect-item\"\n                                            }, [\n                                                _createElementVNode(\"strong\", _hoisted_15, _toDisplayString(key) + \":\", 1 /* TEXT */),\n                                                _createElementVNode(\"span\", _hoisted_16, _toDisplayString(value), 1 /* TEXT */),\n                                                _cache[2] || (_cache[2] = _createElementVNode(\"p\", { class: \"effect-description\" }, \"\", -1 /* CACHED */))\n                                            ]));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                        : _createCommentVNode(\"v-if\", true)\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ])\n                    ])\n                ]))\n                : _createCommentVNode(\"v-if\", true);\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ImprintDetailModal.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ImprintDetailModal.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"panel-wrapper imprints-panel-container\" };\nconst _hoisted_2 = { class: \"imprints-grid\" };\nconst _hoisted_3 = [\"data-level\", \"onClick\"];\nconst _hoisted_4 = { class: \"imprint-name\" };\nconst _hoisted_5 = { class: \"imprint-level\" };\nconst _hoisted_6 = {\n    key: 1,\n    class: \"empty-text\"\n};\nimport { computed } from 'vue';\nimport { reincarnationImprints } from '../../store/getters';\nimport { detailModalService } from '../../services/DetailModalService';\nimport ImprintDetailModal from '../modals/ImprintDetailModal.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ImprintsPanel',\n    setup(__props) {\n        const imprints = computed(() => reincarnationImprints.value);\n        const openImprintDetail = (imprint) => {\n            detailModalService.show(imprint., ImprintDetailModal, { imprint });\n        };\n        // Ensure there are always 9 items for the layout, and filter out placeholders\n        const paddedImprints = computed(() => {\n            const validImprints = imprints.value || [];\n            const result = [...validImprints];\n            while (result.length < 9) {\n                result.push(null);\n            }\n            return result.slice(0, 9);\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(paddedImprints.value, (imprint, index) => {\n                        return (_openBlock(), _createElementBlock(\"div\", {\n                            key: index,\n                            class: _normalizeClass([\"imprint-slot\", { empty: !imprint, clickable: !!imprint }]),\n                            \"data-level\": imprint?.,\n                            onClick: ($event) => (imprint && openImprintDetail(imprint))\n                        }, [\n                            imprint\n                                ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                                    _createElementVNode(\"div\", _hoisted_4, _toDisplayString(imprint.), 1 /* TEXT */),\n                                    _createElementVNode(\"div\", _hoisted_5, \": \" + _toDisplayString(imprint.), 1 /* TEXT */)\n                                ], 64 /* STABLE_FRAGMENT */))\n                                : (_openBlock(), _createElementBlock(\"div\", _hoisted_6, \"\"))\n                        ], 10 /* CLASS, PROPS */, _hoisted_3));\n                    }), 128 /* KEYED_FRAGMENT */))\n                ]),\n                _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"detail-placeholder\" }, [\n                    _createElementVNode(\"p\", null, \"\")\n                ], -1 /* CACHED */))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ImprintsPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ImprintsPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ImprintsPanel.vue?vue&type=style&index=0&id=dcca238c&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-dcca238c\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeStyle as _normalizeStyle, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"panel-wrapper inventory-panel\" };\nconst _hoisted_2 = { class: \"main-content\" };\nconst _hoisted_3 = { class: \"item-grid-container\" };\nconst _hoisted_4 = { class: \"item-grid\" };\nconst _hoisted_5 = {\n    key: 0,\n    class: \"chapter-separator\"\n};\nconst _hoisted_6 = { class: \"text\" };\nconst _hoisted_7 = [\"onClick\"];\nconst _hoisted_8 = {\n    class: \"item-name-arc\",\n    viewBox: \"0 0 100 100\"\n};\nconst _hoisted_9 = [\"id\"];\nconst _hoisted_10 = [\"xlink:href\"];\nconst _hoisted_11 = { class: \"item-footer\" };\nconst _hoisted_12 = {\n    key: 0,\n    class: \"item-quantity\"\n};\nconst _hoisted_13 = {\n    key: 0,\n    class: \"empty-grid\"\n};\nconst _hoisted_14 = { class: \"scroll-detail-view\" };\nconst _hoisted_15 = {\n    key: 0,\n    class: \"scroll-content\"\n};\nconst _hoisted_16 = { class: \"detail-meta\" };\nconst _hoisted_17 = {\n    key: 0,\n    class: \"meta-tier\"\n};\nconst _hoisted_18 = {\n    key: 1,\n    class: \"meta-type\"\n};\nconst _hoisted_19 = { class: \"detail-desc\" };\nconst _hoisted_20 = {\n    key: 0,\n    class: \"detail-effects\"\n};\nconst _hoisted_21 = { key: 0 };\nconst _hoisted_22 = { key: 1 };\nconst _hoisted_23 = {\n    key: 1,\n    class: \"loading\"\n};\nimport { computed, ref } from 'vue';\nimport { playerCharacter, playerInventory } from '../../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'InventoryPanel',\n    setup(__props) {\n        const selectedItem = ref(null);\n        const selectItem = (item) => {\n            selectedItem.value = item;\n        };\n        const closeDetail = () => {\n            selectedItem.value = null;\n        };\n        const allItemsWithSeparators = computed(() => {\n            const result = [];\n            const items = playerInventory.value;\n            if (!items)\n                return [];\n            const sortedItems = [...items].sort((a, b) => {\n                const typeOrder = { : 1, : 2, : 3, : 4 };\n                return typeOrder[a.] - typeOrder[b.];\n            });\n            let lastType = '';\n            sortedItems.forEach(item => {\n                if (item. !== lastType) {\n                    result.push({ isSeparator: true, categoryName: item. });\n                    lastType = item.;\n                }\n                result.push(item);\n            });\n            return result;\n        });\n        const tierColorMap = {\n            common: '128, 128, 128', // grey-stone\n            rare: '45, 200, 240', // cyan-tian\n            epic: '138, 43, 226', // purple-mystery\n            legendary: '218, 165, 32', // gold-liu\n        };\n        const getTierStyle = (item) => {\n            let tierKey = 'common';\n            if (item && item.) {\n                const tier = item.;\n                if (tier >= 9)\n                    tierKey = 'legendary';\n                else if (tier >= 6)\n                    tierKey = 'epic';\n                else if (tier >= 3)\n                    tierKey = 'rare';\n            }\n            return {\n                '--tier-color-rgb': tierColorMap[tierKey],\n            };\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (_unref(playerCharacter))\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 0,\n                        class: _normalizeClass([\"inventory-layout\", { 'detail-open': selectedItem.value }])\n                    }, [\n                        _createCommentVNode(\" Main Content: Categories and Grid \"),\n                        _createElementVNode(\"div\", _hoisted_2, [\n                            _createCommentVNode(\"  \"),\n                            _createElementVNode(\"div\", _hoisted_3, [\n                                _createElementVNode(\"div\", _hoisted_4, [\n                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(allItemsWithSeparators.value, (item, index) => {\n                                        return (_openBlock(), _createElementBlock(_Fragment, {\n                                            key: item.ID || `sep-${index}`\n                                        }, [\n                                            _createCommentVNode(\"  \"),\n                                            (item.isSeparator)\n                                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n                                                    _createElementVNode(\"span\", _hoisted_6, _toDisplayString(item.categoryName), 1 /* TEXT */)\n                                                ]))\n                                                : (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                                                    _createCommentVNode(\"  \"),\n                                                    _createElementVNode(\"div\", {\n                                                        class: \"item-cell\",\n                                                        style: _normalizeStyle(getTierStyle(item)),\n                                                        onClick: ($event) => (selectItem(item))\n                                                    }, [\n                                                        _createCommentVNode(\" SVG \"),\n                                                        (_openBlock(), _createElementBlock(\"svg\", _hoisted_8, [\n                                                            _createElementVNode(\"defs\", null, [\n                                                                _createCommentVNode(\"  \"),\n                                                                _createElementVNode(\"path\", {\n                                                                    id: `arc-path-${item.ID || index}`,\n                                                                    d: \"M 12,52 a 38,38 0 1,1 76,0\",\n                                                                    fill: \"none\"\n                                                                }, null, 8 /* PROPS */, _hoisted_9)\n                                                            ]),\n                                                            _createElementVNode(\"text\", null, [\n                                                                _createElementVNode(\"textPath\", {\n                                                                    class: \"arc-text\",\n                                                                    \"xlink:href\": `#arc-path-${item.ID || index}`,\n                                                                    startOffset: \"50%\",\n                                                                    \"text-anchor\": \"middle\"\n                                                                }, _toDisplayString(item.), 9 /* TEXT, PROPS */, _hoisted_10)\n                                                            ])\n                                                        ])),\n                                                        _createElementVNode(\"div\", _hoisted_11, [\n                                                            ('' in item && item.)\n                                                                ? (_openBlock(), _createElementBlock(\"span\", _hoisted_12, \"x\" + _toDisplayString(item.), 1 /* TEXT */))\n                                                                : _createCommentVNode(\"v-if\", true)\n                                                        ])\n                                                    ], 12 /* STYLE, PROPS */, _hoisted_7)\n                                                ], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */))\n                                        ], 64 /* STABLE_FRAGMENT */));\n                                    }), 128 /* KEYED_FRAGMENT */))\n                                ]),\n                                (allItemsWithSeparators.value.length === 0)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_13, [...(_cache[0] || (_cache[0] = [\n                                            _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                                        ]))]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ])\n                        ]),\n                        _createCommentVNode(\" Right: Item Detail Scroll \"),\n                        _createElementVNode(\"div\", _hoisted_14, [\n                            (selectedItem.value)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_15, [\n                                    _createElementVNode(\"button\", {\n                                        onClick: closeDetail,\n                                        class: \"close-button\"\n                                    }, \"\"),\n                                    _createElementVNode(\"h4\", {\n                                        class: \"detail-name\",\n                                        style: _normalizeStyle(getTierStyle(selectedItem.value))\n                                    }, _toDisplayString(selectedItem.value.), 5 /* TEXT, STYLE */),\n                                    _createElementVNode(\"div\", _hoisted_16, [\n                                        (selectedItem.value.)\n                                            ? (_openBlock(), _createElementBlock(\"span\", _hoisted_17, \" \" + _toDisplayString(selectedItem.value.), 1 /* TEXT */))\n                                            : _createCommentVNode(\"v-if\", true),\n                                        (selectedItem.value.)\n                                            ? (_openBlock(), _createElementBlock(\"span\", _hoisted_18, _toDisplayString(selectedItem.value.), 1 /* TEXT */))\n                                            : _createCommentVNode(\"v-if\", true)\n                                    ]),\n                                    _createElementVNode(\"p\", _hoisted_19, _toDisplayString(selectedItem.value.), 1 /* TEXT */),\n                                    (selectedItem.value.effects)\n                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_20, [\n                                            _cache[1] || (_cache[1] = _createElementVNode(\"h5\", null, \":\", -1 /* CACHED */)),\n                                            (selectedItem.value.effects.attributes_bonus && Object.keys(selectedItem.value.effects.attributes_bonus).length > 0)\n                                                ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_21, [\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(selectedItem.value.effects.attributes_bonus, (value, key) => {\n                                                        return (_openBlock(), _createElementBlock(\"li\", { key: key }, _toDisplayString(key) + \" +\" + _toDisplayString(value), 1 /* TEXT */));\n                                                    }), 128 /* KEYED_FRAGMENT */))\n                                                ]))\n                                                : _createCommentVNode(\"v-if\", true),\n                                            (selectedItem.value.effects.percentage_bonus && Object.keys(selectedItem.value.effects.percentage_bonus).length > 0)\n                                                ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_22, [\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(selectedItem.value.effects.percentage_bonus, (value, key) => {\n                                                        return (_openBlock(), _createElementBlock(\"li\", { key: key }, _toDisplayString(key) + \" \" + _toDisplayString(value), 1 /* TEXT */));\n                                                    }), 128 /* KEYED_FRAGMENT */))\n                                                ]))\n                                                : _createCommentVNode(\"v-if\", true)\n                                        ]))\n                                        : _createCommentVNode(\"v-if\", true)\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ])\n                    ], 2 /* CLASS */))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_23, \"...\"))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./InventoryPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./InventoryPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./InventoryPanel.vue?vue&type=style&index=0&id=7c9350f4&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7c9350f4\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = { class: \"skills-panel\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"empty-state\"\n};\nconst _hoisted_3 = {\n    key: 1,\n    class: \"skills-list\"\n};\nconst _hoisted_4 = { class: \"skill-header\" };\nconst _hoisted_5 = { class: \"skill-level\" };\nconst _hoisted_6 = { class: \"skill-description\" };\nconst _hoisted_7 = { class: \"skill-progress\" };\nconst _hoisted_8 = { class: \"progress-bar-wrapper\" };\nconst _hoisted_9 = [\"value\", \"max\"];\nconst _hoisted_10 = { class: \"progress-text\" };\nconst _hoisted_11 = {\n    key: 0,\n    class: \"associated-skills\"\n};\nconst _hoisted_12 = [\"onClick\"];\nconst _hoisted_13 = {\n    key: 0,\n    class: \"associated-skills-list\"\n};\nconst _hoisted_14 = { class: \"skill-name\" };\nconst _hoisted_15 = { class: \"skill-detail skill-description-detail\" };\nconst _hoisted_16 = { class: \"skill-detail\" };\nconst _hoisted_17 = { class: \"skill-detail\" };\nimport { computed, ref } from 'vue';\nimport { playerSkills } from '../../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'SkillsPanel',\n    setup(__props) {\n        const skills = computed(() => playerSkills.value);\n        const expandedSkills = ref({});\n        const toggleSkills = (skillId) => {\n            expandedSkills.value[skillId] = !expandedSkills.value[skillId];\n        };\n        const isExpanded = (skillId) => {\n            return !!expandedSkills.value[skillId];\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _cache[4] || (_cache[4] = _createElementVNode(\"h2\", null, \"\", -1 /* CACHED */)),\n                (skills.value.length === 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [...(_cache[0] || (_cache[0] = [\n                            _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                        ]))]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(skills.value, (skill) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: skill.id,\n                                class: \"skill-item\"\n                            }, [\n                                _createElementVNode(\"div\", _hoisted_4, [\n                                    _createElementVNode(\"h3\", null, _toDisplayString(skill.name), 1 /* TEXT */),\n                                    _createElementVNode(\"div\", _hoisted_5, \" \" + _toDisplayString(skill.level), 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"p\", _hoisted_6, _toDisplayString(skill.description), 1 /* TEXT */),\n                                _createElementVNode(\"div\", _hoisted_7, [\n                                    _createElementVNode(\"div\", _hoisted_8, [\n                                        _createElementVNode(\"progress\", {\n                                            value: skill.exp,\n                                            max: skill.expToNextLevel\n                                        }, null, 8 /* PROPS */, _hoisted_9),\n                                        _createElementVNode(\"span\", _hoisted_10, _toDisplayString(skill.exp) + \" / \" + _toDisplayString(skill.expToNextLevel), 1 /* TEXT */)\n                                    ])\n                                ]),\n                                (skill.associatedSkills && skill.associatedSkills.length > 0)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [\n                                        _createElementVNode(\"button\", {\n                                            onClick: ($event) => (toggleSkills(skill.id)),\n                                            class: \"associated-skills-title\"\n                                        }, [\n                                            _cache[1] || (_cache[1] = _createTextVNode(\"  \", -1 /* CACHED */)),\n                                            _createElementVNode(\"span\", {\n                                                class: _normalizeClass(['arrow', { expanded: isExpanded(skill.id) }])\n                                            }, null, 2 /* CLASS */)\n                                        ], 8 /* PROPS */, _hoisted_12),\n                                        (isExpanded(skill.id))\n                                            ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_13, [\n                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(skill.associatedSkills, (activeSkill) => {\n                                                    return (_openBlock(), _createElementBlock(\"li\", {\n                                                        key: activeSkill.ID,\n                                                        class: \"associated-skill-item\"\n                                                    }, [\n                                                        _createElementVNode(\"div\", _hoisted_14, [\n                                                            _createElementVNode(\"strong\", null, _toDisplayString(activeSkill.), 1 /* TEXT */),\n                                                            _createTextVNode(\" (\" + _toDisplayString(activeSkill.) + \") \", 1 /* TEXT */)\n                                                        ]),\n                                                        _createElementVNode(\"div\", _hoisted_15, _toDisplayString(activeSkill.), 1 /* TEXT */),\n                                                        _createElementVNode(\"div\", _hoisted_16, [\n                                                            _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                            _createTextVNode(\" \" + _toDisplayString(activeSkill.), 1 /* TEXT */)\n                                                        ]),\n                                                        _createElementVNode(\"div\", _hoisted_17, [\n                                                            _cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                            _createTextVNode(\" \" + _toDisplayString(activeSkill.), 1 /* TEXT */)\n                                                        ])\n                                                    ]));\n                                                }), 128 /* KEYED_FRAGMENT */))\n                                            ]))\n                                            : _createCommentVNode(\"v-if\", true)\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./SkillsPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SkillsPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./SkillsPanel.vue?vue&type=style&index=0&id=36b9d730&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-36b9d730\"]])\n\nexport default __exports__","import { computed, reactive } from 'vue';\nimport { store } from '../store';\nimport type { Character } from '../types';\nimport { parseSimpleYaml } from '../utils/yamlParser';\nimport { lorebookService } from './LorebookService';\n\n// ID\nconst locationNameCache = reactive(new Map<string, string>());\n\n/**\n * NPC\n */\nconst allNpcs = computed(() => {\n  const worldState = store.worldState;\n  if (!worldState?.) return [];\n\n  const userAndAvatarIds = [worldState.[store.userId]?.?.[0], worldState.?..ID?.[0]].filter(\n    Boolean,\n  );\n\n  const characters = Object.values(worldState.) as Character[];\n  return characters.filter((char: Character) => {\n    const charName = char.?.[0];\n    // \n    return charName && !userAndAvatarIds.includes(charName);\n  });\n});\n\n/**\n * IDNPC\n */\nfunction getNpcsByWorld(worldId: string): Character[] {\n  if (!worldId) return [];\n  return allNpcs.value.filter((npc: Character) => {\n    //  Described<string> \n    const npcWorldId = Array.isArray(npc.) ? npc.[0] : npc.;\n    return npcWorldId === worldId;\n  });\n}\n\n/**\n * \n */\nasync function initializeWorldAndLocationData(): Promise<{ id: string; name: string }[]> {\n  const entries = await lorebookService.getEntries();\n  if (!entries) return [];\n\n  const worldInfoPromises = entries.map(async (entry: any) => {\n    try {\n      if (entry.content) {\n        const parsed = parseSimpleYaml(entry.content);\n        const id = parsed?.?.ID;\n        const name = parsed?.?.;\n\n        //  - V8.0 \n        const currentEpochId = parsed?.?.ID;\n        if (currentEpochId && parsed?.?.[currentEpochId]) {\n          const activeEpoch = parsed.[currentEpochId];\n          const spatialEntities = activeEpoch?.?.;\n          if (Array.isArray(spatialEntities)) {\n            for (const entity of spatialEntities) {\n              if (entity.ID && entity.) {\n                locationNameCache.set(entity.ID, entity.);\n              }\n            }\n          }\n        }\n\n        if (id && name) {\n          return { id, name };\n        }\n      }\n    } catch (e) {\n      console.error(`Error parsing lorebook entry ${entry.name}:`, e);\n    }\n    return null;\n  });\n\n  const results = await Promise.all(worldInfoPromises);\n  const uniqueWorlds = new Map<string, { id: string; name: string }>();\n  (results.filter(Boolean) as { id: string; name: string }[]).forEach(world => {\n    if (!uniqueWorlds.has(world.id)) {\n      uniqueWorlds.set(world.id, world);\n    }\n  });\n\n  return Array.from(uniqueWorlds.values());\n}\n\nfunction getLocationName(id: string): string {\n  return locationNameCache.get(id) || id;\n}\n\nfunction getNpcNameById(id: string): string {\n  const character = store.worldState?.?.[id];\n  if (character && character. && Array.isArray(character.)) {\n    return character.[0] || id;\n  }\n  return id;\n}\n\nfunction getNpcId(npc: Character): string | null {\n  const worldState = store.worldState;\n  if (!worldState?.) return null;\n\n  for (const id in worldState.) {\n    if (worldState.[id] === npc) {\n      return id;\n    }\n  }\n  return null;\n}\n\nexport const npcService = {\n  getNpcsByWorld,\n  allNpcs,\n  initializeWorldAndLocationData,\n  getLocationName,\n  getNpcNameById,\n  getNpcId,\n};\n","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = { class: \"detail-tab-content grid-layout\" };\nconst _hoisted_2 = { class: \"detail-item\" };\nconst _hoisted_3 = { class: \"detail-value\" };\nconst _hoisted_4 = { class: \"detail-item\" };\nconst _hoisted_5 = { class: \"detail-value\" };\nconst _hoisted_6 = { class: \"detail-item\" };\nconst _hoisted_7 = { class: \"detail-value\" };\nconst _hoisted_8 = { class: \"tag\" };\nconst _hoisted_9 = { class: \"detail-item\" };\nconst _hoisted_10 = { class: \"detail-value\" };\nconst _hoisted_11 = { class: \"detail-item\" };\nconst _hoisted_12 = { class: \"detail-value\" };\nconst _hoisted_13 = { class: \"detail-item\" };\nconst _hoisted_14 = { class: \"detail-value\" };\nconst _hoisted_15 = { class: \"tag\" };\nconst _hoisted_16 = { class: \"detail-item\" };\nconst _hoisted_17 = { class: \"detail-value\" };\nconst _hoisted_18 = { class: \"detail-item full-width\" };\nconst _hoisted_19 = { class: \"detail-value\" };\nconst _hoisted_20 = { class: \"history-list\" };\nconst _hoisted_21 = { key: 0 };\nconst _hoisted_22 = {\n    key: 1,\n    class: \"influence-text\"\n};\nimport { computed } from 'vue';\nimport { calculateAge, mainWorld } from '../../../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcArchiveTab',\n    props: {\n        npc: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const age = computed(() => {\n            const calculated = calculateAge(props.npc, mainWorld.value);\n            return calculated === null ? '' : calculated;\n        });\n        const formattedBirthDate = computed(() => {\n            const bd = props.npc.;\n            if (!bd)\n                return '';\n            return `${bd.}${bd.}${bd.}`;\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _createElementVNode(\"p\", null, _toDisplayString(__props.npc.), 1 /* TEXT */)\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    _cache[1] || (_cache[1] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_5, [\n                        _createElementVNode(\"p\", null, _toDisplayString(formattedBirthDate.value) + \" (\" + _toDisplayString(age.value) + \")\", 1 /* TEXT */)\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_6, [\n                    _cache[2] || (_cache[2] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_7, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(Object.values(__props.npc. || {}).filter(v => typeof v === 'string'), (item) => {\n                            return (_openBlock(), _createElementBlock(\"span\", _hoisted_8, _toDisplayString(item), 1 /* TEXT */));\n                        }), 256 /* UNKEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_9, [\n                    _cache[3] || (_cache[3] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_10, [\n                        _createElementVNode(\"p\", null, _toDisplayString(__props.npc.), 1 /* TEXT */)\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_11, [\n                    _cache[4] || (_cache[4] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_12, [\n                        _createElementVNode(\"p\", null, _toDisplayString(__props.npc.?.), 1 /* TEXT */)\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_13, [\n                    _cache[5] || (_cache[5] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_14, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(Object.values(__props.npc.?. || {}).filter(v => typeof v === 'string'), (item) => {\n                            return (_openBlock(), _createElementBlock(\"span\", _hoisted_15, _toDisplayString(item), 1 /* TEXT */));\n                        }), 256 /* UNKEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_16, [\n                    _cache[6] || (_cache[6] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_17, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.npc.?.?., (value, tendencyKey) => {\n                            return (_openBlock(), _createElementBlock(\"span\", {\n                                key: tendencyKey,\n                                class: \"tag\"\n                            }, _toDisplayString(tendencyKey) + \": \" + _toDisplayString(value), 1 /* TEXT */));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_18, [\n                    _cache[7] || (_cache[7] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_19, [\n                        _createElementVNode(\"ul\", _hoisted_20, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(Object.values(__props.npc.?. || {}).filter(v => typeof v === 'object'), (event, index) => {\n                                return (_openBlock(), _createElementBlock(\"li\", { key: index }, [\n                                    _createElementVNode(\"strong\", null, _toDisplayString(event.), 1 /* TEXT */),\n                                    (event.)\n                                        ? (_openBlock(), _createElementBlock(\"p\", _hoisted_21, _toDisplayString(event.), 1 /* TEXT */))\n                                        : _createCommentVNode(\"v-if\", true),\n                                    (event.)\n                                        ? (_openBlock(), _createElementBlock(\"p\", _hoisted_22, _toDisplayString(event.), 1 /* TEXT */))\n                                        : _createCommentVNode(\"v-if\", true)\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ])\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcArchiveTab.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcArchiveTab.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcArchiveTab.vue?vue&type=style&index=0&id=b51f5894&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-b51f5894\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode } from \"vue\";\nconst _hoisted_1 = { class: \"attribute-grid\" };\nconst _hoisted_2 = { class: \"attribute-key\" };\nconst _hoisted_3 = { class: \"attribute-value\" };\nimport { computed } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'AttributeGrid',\n    props: {\n        attributes: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const filteredAttributes = computed(() => {\n            if (!props.attributes)\n                return {};\n            const { $meta, ...rest } = props.attributes;\n            return rest;\n        });\n        function formatValue(value) {\n            if (typeof value === 'object' && value !== null) {\n                if ('' in value && '' in value) {\n                    let output = `${value['']}/${value['']}`;\n                    if ('' in value) {\n                        output += ` (+${value['']})`;\n                    }\n                    return output;\n                }\n                // For other complex objects, format them line by line\n                return Object.entries(value)\n                    .map(([key, val]) => `${key}: ${val}`)\n                    .join('\\n');\n            }\n            return String(value);\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(filteredAttributes.value, (value, key) => {\n                    return (_openBlock(), _createElementBlock(\"div\", {\n                        key: key,\n                        class: \"attribute-item\"\n                    }, [\n                        _createElementVNode(\"span\", _hoisted_2, _toDisplayString(key), 1 /* TEXT */),\n                        _createElementVNode(\"span\", _hoisted_3, _toDisplayString(formatValue(value)), 1 /* TEXT */)\n                    ]));\n                }), 128 /* KEYED_FRAGMENT */))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./AttributeGrid.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AttributeGrid.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./AttributeGrid.vue?vue&type=style&index=0&id=3cb45dc2&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3cb45dc2\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveDirective as _resolveDirective, withDirectives as _withDirectives } from \"vue\";\nconst _hoisted_1 = { class: \"detail-tab-content grid-layout\" };\nconst _hoisted_2 = { class: \"detail-item full-width\" };\nconst _hoisted_3 = { class: \"detail-item full-width\" };\nconst _hoisted_4 = { class: \"detail-item full-width\" };\nconst _hoisted_5 = { class: \"detail-item full-width\" };\nconst _hoisted_6 = { class: \"detail-value\" };\nconst _hoisted_7 = {\n    key: 0,\n    class: \"tags-container\"\n};\nconst _hoisted_8 = {\n    key: 1,\n    class: \"placeholder\"\n};\nconst _hoisted_9 = { class: \"detail-item full-width\" };\nconst _hoisted_10 = {\n    key: 0,\n    class: \"skills-list\"\n};\nconst _hoisted_11 = { class: \"skill-header\" };\nconst _hoisted_12 = { class: \"skill-level\" };\nconst _hoisted_13 = {\n    key: 1,\n    class: \"placeholder\"\n};\nimport { computed } from 'vue';\nimport { store } from '../../../store';\nimport AttributeGrid from '../AttributeGrid.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcPowerTab',\n    props: {\n        npc: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const talents = computed(() => {\n            const database = store.worldState?.;\n            if (!props.npc. || !database || !('' in database))\n                return [];\n            const talentDb = database.;\n            if (!talentDb)\n                return [];\n            return Object.keys(props.npc.)\n                .map(talentId => {\n                const talentData = talentDb[talentId];\n                return talentData ? { ...talentData, ID: talentId } : null;\n            })\n                .filter(Boolean);\n        });\n        const skills = computed(() => {\n            const database = store.worldState?.;\n            if (!props.npc. || !database || !('' in database))\n                return [];\n            const npcArts = props.npc.;\n            const artDb = database.;\n            if (!artDb)\n                return [];\n            const skillsList = [];\n            for (const artId in npcArts) {\n                const artData = npcArts[artId];\n                const artTemplate = artDb[artId];\n                if (artTemplate && artTemplate.) {\n                    const currentLevelInfo = artTemplate..find((l) => l. === artData.);\n                    skillsList.push({\n                        id: artId,\n                        name: artTemplate.,\n                        level: artData.,\n                        title: currentLevelInfo ? currentLevelInfo. : '',\n                    });\n                }\n            }\n            return skillsList;\n        });\n        return (_ctx, _cache) => {\n            const _directive_tooltip = _resolveDirective(\"tooltip\");\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \"\", -1 /* CACHED */)),\n                    _createVNode(AttributeGrid, {\n                        attributes: __props.npc.\n                    }, null, 8 /* PROPS */, [\"attributes\"])\n                ]),\n                _createElementVNode(\"div\", _hoisted_3, [\n                    _cache[1] || (_cache[1] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \"\", -1 /* CACHED */)),\n                    _createVNode(AttributeGrid, {\n                        attributes: __props.npc.\n                    }, null, 8 /* PROPS */, [\"attributes\"])\n                ]),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    _cache[2] || (_cache[2] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \"\", -1 /* CACHED */)),\n                    _createVNode(AttributeGrid, {\n                        attributes: __props.npc.\n                    }, null, 8 /* PROPS */, [\"attributes\"])\n                ]),\n                _createElementVNode(\"div\", _hoisted_5, [\n                    _cache[3] || (_cache[3] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_6, [\n                        (talents.value.length > 0)\n                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [\n                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(talents.value, (talent) => {\n                                    return _withDirectives((_openBlock(), _createElementBlock(\"span\", {\n                                        key: talent.ID,\n                                        class: \"tag talent-tag\"\n                                    }, [\n                                        _createTextVNode(_toDisplayString(talent.), 1 /* TEXT */)\n                                    ])), [\n                                        [_directive_tooltip, talent.]\n                                    ]);\n                                }), 128 /* KEYED_FRAGMENT */))\n                            ]))\n                            : (_openBlock(), _createElementBlock(\"div\", _hoisted_8, \"\"))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_9, [\n                    _cache[4] || (_cache[4] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \"\", -1 /* CACHED */)),\n                    (skills.value.length > 0)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(skills.value, (skill) => {\n                                return (_openBlock(), _createElementBlock(\"div\", {\n                                    key: skill.id,\n                                    class: \"skill-item\"\n                                }, [\n                                    _createElementVNode(\"div\", _hoisted_11, [\n                                        _createElementVNode(\"h3\", null, _toDisplayString(skill.name), 1 /* TEXT */),\n                                        _createElementVNode(\"div\", _hoisted_12, \" \" + _toDisplayString(skill.level) + \" (\" + _toDisplayString(skill.title) + \")\", 1 /* TEXT */)\n                                    ])\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_13, \"\"))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcPowerTab.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcPowerTab.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcPowerTab.vue?vue&type=style&index=0&id=7f42cacb&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7f42cacb\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, normalizeStyle as _normalizeStyle } from \"vue\";\nconst _hoisted_1 = { class: \"progress-bar-container\" };\nconst _hoisted_2 = { class: \"label\" };\nconst _hoisted_3 = { class: \"progress-track\" };\nconst _hoisted_4 = {\n    key: 0,\n    class: \"center-tick\"\n};\nconst _hoisted_5 = { class: \"value\" };\nimport { computed } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ProgressBar',\n    props: {\n        label: {},\n        value: {},\n        max: {},\n        min: {},\n        color: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const displayValue = computed(() => props.value);\n        const isBidirectional = computed(() => props.min !== undefined && props.min < 0);\n        const fillStyle = computed(() => {\n            const min = props.min || 0;\n            const max = props.max || 100;\n            const value = Math.max(min, Math.min(max, props.value));\n            if (isBidirectional.value) {\n                const totalRange = max - min;\n                if (value > 0) {\n                    return {\n                        left: '50%',\n                        right: 'auto',\n                        width: `${(value / max) * 50}%`,\n                        backgroundColor: props.color,\n                    };\n                }\n                else {\n                    return {\n                        left: 'auto',\n                        right: '50%',\n                        width: `${(Math.abs(value) / Math.abs(min)) * 50}%`,\n                        backgroundColor: '#e53935', // \n                    };\n                }\n            }\n            else {\n                const percentage = max === min ? 0 : ((value - min) / (max - min)) * 100;\n                return {\n                    left: '0',\n                    right: 'auto',\n                    width: `${percentage}%`,\n                    backgroundColor: props.color,\n                };\n            }\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"span\", _hoisted_2, _toDisplayString(__props.label), 1 /* TEXT */),\n                _createElementVNode(\"div\", _hoisted_3, [\n                    (isBidirectional.value)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4))\n                        : _createCommentVNode(\"v-if\", true),\n                    _createElementVNode(\"div\", {\n                        class: \"progress-fill\",\n                        style: _normalizeStyle(fillStyle.value)\n                    }, null, 4 /* STYLE */)\n                ]),\n                _createElementVNode(\"span\", _hoisted_5, _toDisplayString(displayValue.value), 1 /* TEXT */)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ProgressBar.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ProgressBar.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ProgressBar.vue?vue&type=style&index=0&id=780a870c&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-780a870c\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, unref as _unref, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createBlock as _createBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = { class: \"relations-display\" };\nconst _hoisted_2 = { class: \"relation-list\" };\nconst _hoisted_3 = [\"onClick\"];\nconst _hoisted_4 = { class: \"relation-name\" };\nconst _hoisted_5 = { class: \"relation-tags\" };\nconst _hoisted_6 = {\n    key: 0,\n    class: \"relation-details\"\n};\nconst _hoisted_7 = { class: \"group-title\" };\nimport { computed, ref } from 'vue';\nimport { get } from 'lodash';\nimport { npcService } from '../../services/NpcService';\nimport ProgressBar from './ProgressBar.vue';\nimport { store } from '../../store';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'RelationsDisplay',\n    props: {\n        subjectId: {}\n    },\n    setup(__props) {\n        const vectorGroups = [\n            {\n                title: '',\n                vectors: [\n                    { label: '', path: '.', min: -100, max: 100, color: '#3a8f9d' },\n                    { label: '', path: '.', min: -100, max: 100, color: '#3a8f9d' },\n                    { label: '', path: '.', min: 0, max: 100, color: '#e53935' },\n                ],\n            },\n            {\n                title: '',\n                vectors: [\n                    { label: '', path: '.', min: -100, max: 100, color: '#c74343' },\n                    { label: '', path: '.', min: 0, max: 100, color: '#c74343' },\n                ],\n            },\n            {\n                title: '',\n                vectors: [\n                    { label: '', path: '.', min: 0, max: 100, color: '#d4af37' },\n                    { label: '', path: '.', min: 0, max: 100, color: '#d4af37' },\n                    { label: '', path: '.', min: 0, max: 100, color: '#e53935' },\n                ],\n            },\n        ];\n        const props = __props;\n        const relations = computed(() => {\n            if (!props.subjectId || !store.worldState?.) {\n                return {};\n            }\n            return store.worldState.[props.subjectId] || {};\n        });\n        const { getNpcNameById } = npcService;\n        const expandedRelation = ref(null);\n        function toggleExpand(name) {\n            const relationName = String(name);\n            if (expandedRelation.value === relationName) {\n                expandedRelation.value = null;\n            }\n            else {\n                expandedRelation.value = relationName;\n            }\n        }\n        function getFormattedTags(relation) {\n            const causeTags = get(relation, '', {});\n            return Object.values(causeTags)\n                .filter((tag) => typeof tag === 'object' && tag !== null && tag.)\n                .map((tag) => tag.);\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"ul\", _hoisted_2, [\n                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(relations.value, (relation, id) => {\n                        return (_openBlock(), _createElementBlock(\"li\", {\n                            key: id,\n                            class: \"relation-item\"\n                        }, [\n                            _createElementVNode(\"div\", {\n                                class: \"relation-header\",\n                                onClick: ($event) => (toggleExpand(id))\n                            }, [\n                                _createElementVNode(\"span\", _hoisted_4, _toDisplayString(_unref(getNpcNameById)(String(id))), 1 /* TEXT */),\n                                _createElementVNode(\"div\", _hoisted_5, [\n                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(getFormattedTags(relation), (tag) => {\n                                        return (_openBlock(), _createElementBlock(\"span\", {\n                                            key: tag,\n                                            class: \"tag\"\n                                        }, _toDisplayString(tag), 1 /* TEXT */));\n                                    }), 128 /* KEYED_FRAGMENT */))\n                                ])\n                            ], 8 /* PROPS */, _hoisted_3),\n                            (expandedRelation.value === id)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [\n                                    (_openBlock(), _createElementBlock(_Fragment, null, _renderList(vectorGroups, (group) => {\n                                        return _createElementVNode(\"div\", {\n                                            key: group.title,\n                                            class: \"vector-group\"\n                                        }, [\n                                            _createElementVNode(\"strong\", _hoisted_7, _toDisplayString(group.title), 1 /* TEXT */),\n                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(group.vectors, (vector) => {\n                                                return (_openBlock(), _createBlock(ProgressBar, {\n                                                    key: vector.label,\n                                                    label: vector.label,\n                                                    value: _unref(get)(relation, vector.path, 0),\n                                                    min: vector.min,\n                                                    max: vector.max,\n                                                    color: vector.color\n                                                }, null, 8 /* PROPS */, [\"label\", \"value\", \"min\", \"max\", \"color\"]));\n                                            }), 128 /* KEYED_FRAGMENT */))\n                                        ]);\n                                    }), 64 /* STABLE_FRAGMENT */))\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ]));\n                    }), 128 /* KEYED_FRAGMENT */))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./RelationsDisplay.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./RelationsDisplay.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./RelationsDisplay.vue?vue&type=style&index=0&id=763d7aea&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-763d7aea\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = { class: \"inventory-grid\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"grid-container\"\n};\nconst _hoisted_3 = { class: \"item-name\" };\nconst _hoisted_4 = {\n    key: 0,\n    class: \"item-quantity\"\n};\nconst _hoisted_5 = {\n    key: 1,\n    class: \"empty-inventory\"\n};\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'InventoryGrid',\n    props: {\n        items: {}\n    },\n    setup(__props) {\n        const props = __props;\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (__props.items.length > 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.items, (item, index) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: index,\n                                class: \"item-cell\"\n                            }, [\n                                _createElementVNode(\"span\", _hoisted_3, _toDisplayString(item.), 1 /* TEXT */),\n                                (item.)\n                                    ? (_openBlock(), _createElementBlock(\"span\", _hoisted_4, \"x\" + _toDisplayString(item.), 1 /* TEXT */))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [...(_cache[0] || (_cache[0] = [\n                            _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                        ]))]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./InventoryGrid.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./InventoryGrid.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./InventoryGrid.vue?vue&type=style&index=0&id=289f38ac&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-289f38ac\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = { class: \"detail-tab-content grid-layout\" };\nconst _hoisted_2 = { class: \"detail-item full-width\" };\nconst _hoisted_3 = { class: \"detail-item full-width\" };\nconst _hoisted_4 = { class: \"detail-item full-width\" };\nconst _hoisted_5 = {\n    key: 0,\n    class: \"memory-list\"\n};\nconst _hoisted_6 = { class: \"memory-event\" };\nconst _hoisted_7 = { class: \"memory-influence\" };\nconst _hoisted_8 = {\n    key: 1,\n    class: \"placeholder\"\n};\nimport { computed } from 'vue';\nimport { get } from 'lodash';\nimport { store } from '../../../store';\nimport RelationsDisplay from '../RelationsDisplay.vue';\nimport InventoryGrid from '../InventoryGrid.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcCauseTab',\n    props: {\n        npc: {},\n        npcId: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const inventoryItems = computed(() => {\n            const database = store.worldState?.;\n            if (!props.npc || !database)\n                return [];\n            const backpack = get(props.npc, '', {});\n            const items = [];\n            for (const itemId in backpack) {\n                const quantity = backpack[itemId];\n                if (quantity <= 0)\n                    continue;\n                let itemDetails = null;\n                for (const category in database) {\n                    const categoryStore = database[category];\n                    if (categoryStore && categoryStore[itemId]) {\n                        itemDetails = categoryStore[itemId];\n                        break;\n                    }\n                }\n                if (itemDetails) {\n                    items.push({\n                        ...itemDetails,\n                        ID: itemId,\n                        : quantity,\n                    });\n                }\n            }\n            return items;\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \"\", -1 /* CACHED */)),\n                    _createVNode(InventoryGrid, { items: inventoryItems.value }, null, 8 /* PROPS */, [\"items\"])\n                ]),\n                _createElementVNode(\"div\", _hoisted_3, [\n                    _cache[1] || (_cache[1] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \"\", -1 /* CACHED */)),\n                    (__props.npcId)\n                        ? (_openBlock(), _createBlock(RelationsDisplay, {\n                            key: 0,\n                            \"subject-id\": __props.npcId\n                        }, null, 8 /* PROPS */, [\"subject-id\"]))\n                        : _createCommentVNode(\"v-if\", true)\n                ]),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    _cache[4] || (_cache[4] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \"\", -1 /* CACHED */)),\n                    (Object.keys(__props.npc.?. || {}).length > 0)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.npc.., (memory, key) => {\n                                return (_openBlock(), _createElementBlock(\"div\", {\n                                    key: key,\n                                    class: \"memory-item\"\n                                }, [\n                                    _createElementVNode(\"p\", _hoisted_6, [\n                                        _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                        _createTextVNode(\" \" + _toDisplayString(memory.), 1 /* TEXT */)\n                                    ]),\n                                    _createElementVNode(\"p\", _hoisted_7, [\n                                        _cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                        _createTextVNode(\" \" + _toDisplayString(memory.), 1 /* TEXT */)\n                                    ])\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_8, \"\"))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcCauseTab.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcCauseTab.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcCauseTab.vue?vue&type=style&index=0&id=06bf308e&lang=scss&scoped=true\"\nimport \"./NpcCauseTab.vue?vue&type=style&index=1&id=06bf308e&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-06bf308e\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createElementVNode as _createElementVNode, createBlock as _createBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = { class: \"npc-detail-display\" };\nconst _hoisted_2 = { class: \"tabs\" };\nconst _hoisted_3 = [\"onClick\"];\nconst _hoisted_4 = { class: \"tab-content\" };\nconst _hoisted_5 = {\n    key: 1,\n    class: \"placeholder\"\n};\nimport { ref } from 'vue';\nimport NpcArchiveTab from './npc-details/NpcArchiveTab.vue';\nimport NpcPowerTab from './npc-details/NpcPowerTab.vue';\nimport NpcCauseTab from './npc-details/NpcCauseTab.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcDetailDisplay',\n    props: {\n        npc: {},\n        npcId: {}\n    },\n    setup(__props) {\n        const activeTab = ref('archive');\n        const tabs = [\n            { id: 'archive', name: '' },\n            { id: 'power', name: '' },\n            { id: 'cause', name: '' },\n        ];\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    (_openBlock(), _createElementBlock(_Fragment, null, _renderList(tabs, (tab) => {\n                        return _createElementVNode(\"button\", {\n                            key: tab.id,\n                            class: _normalizeClass({ active: activeTab.value === tab.id }),\n                            onClick: ($event) => (activeTab.value = tab.id)\n                        }, _toDisplayString(tab.name), 11 /* TEXT, CLASS, PROPS */, _hoisted_3);\n                    }), 64 /* STABLE_FRAGMENT */))\n                ]),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    (__props.npc)\n                        ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                            (activeTab.value === 'archive')\n                                ? (_openBlock(), _createBlock(NpcArchiveTab, {\n                                    key: 0,\n                                    npc: __props.npc\n                                }, null, 8 /* PROPS */, [\"npc\"]))\n                                : _createCommentVNode(\"v-if\", true),\n                            (activeTab.value === 'power')\n                                ? (_openBlock(), _createBlock(NpcPowerTab, {\n                                    key: 1,\n                                    npc: __props.npc\n                                }, null, 8 /* PROPS */, [\"npc\"]))\n                                : _createCommentVNode(\"v-if\", true),\n                            (activeTab.value === 'cause')\n                                ? (_openBlock(), _createBlock(NpcCauseTab, {\n                                    key: 2,\n                                    npc: __props.npc,\n                                    \"npc-id\": __props.npcId\n                                }, null, 8 /* PROPS */, [\"npc\", \"npc-id\"]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ], 64 /* STABLE_FRAGMENT */))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [...(_cache[0] || (_cache[0] = [\n                                _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                            ]))]))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcDetailDisplay.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcDetailDisplay.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcDetailDisplay.vue?vue&type=style&index=0&id=7a2f4260&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7a2f4260\"]])\n\nexport default __exports__","import { ref, watch } from 'vue';\n\nconst FOLLOWED_NPCS_STORAGE_KEY = 'reincarnation_followed_npcs';\n\nconst followedNpcs = ref(new Set<string>(JSON.parse(localStorage.getItem(FOLLOWED_NPCS_STORAGE_KEY) || '[]')));\n\nwatch(\n  followedNpcs,\n  newSet => {\n    localStorage.setItem(FOLLOWED_NPCS_STORAGE_KEY, JSON.stringify(Array.from(newSet)));\n  },\n  { deep: true },\n);\n\nexport function useFollowSystem() {\n  const follow = (npcId: string) => {\n    followedNpcs.value.add(npcId);\n  };\n\n  const unfollow = (npcId: string) => {\n    followedNpcs.value.delete(npcId);\n  };\n\n  const isFollowed = (npcId: string) => {\n    return followedNpcs.value.has(npcId);\n  };\n\n  const toggleFollow = (npcId: string) => {\n    if (isFollowed(npcId)) {\n      unfollow(npcId);\n    } else {\n      follow(npcId);\n    }\n  };\n\n  return { followedNpcs, toggleFollow, isFollowed };\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { withModifiers as _withModifiers, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nimport { ref, watchEffect } from 'vue';\nimport { useFollowSystem } from '../../services/useFollowSystem';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'FollowButton',\n    props: {\n        npcId: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const { toggleFollow, isFollowed } = useFollowSystem();\n        const isFollowedState = ref(false);\n        watchEffect(() => {\n            isFollowedState.value = isFollowed(props.npcId);\n        });\n        function toggle() {\n            toggleFollow(props.npcId);\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"button\", {\n                class: _normalizeClass([\"follow-btn\", { followed: isFollowedState.value }]),\n                onClick: _withModifiers(toggle, [\"stop\"])\n            }, \"\", 2 /* CLASS */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./FollowButton.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./FollowButton.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./FollowButton.vue?vue&type=style&index=0&id=9ca898fa&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-9ca898fa\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, vModelText as _vModelText, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, withModifiers as _withModifiers, createBlock as _createBlock, createVNode as _createVNode } from \"vue\";\nconst _hoisted_1 = { class: \"npc-directory-panel\" };\nconst _hoisted_2 = { class: \"world-list-column\" };\nconst _hoisted_3 = [\"onClick\"];\nconst _hoisted_4 = { class: \"npc-list-column\" };\nconst _hoisted_5 = {\n    key: 0,\n    class: \"npc-list\"\n};\nconst _hoisted_6 = [\"onClick\"];\nconst _hoisted_7 = { class: \"npc-info\" };\nconst _hoisted_8 = { class: \"npc-name\" };\nconst _hoisted_9 = { class: \"npc-location\" };\nconst _hoisted_10 = {\n    key: 1,\n    class: \"placeholder\"\n};\nconst _hoisted_11 = { class: \"npc-detail-column\" };\nconst _hoisted_12 = { key: 0 };\nconst _hoisted_13 = {\n    key: 1,\n    class: \"placeholder\"\n};\nimport { ref, onMounted, computed, watch } from 'vue';\nimport { npcService } from '../../services/NpcService';\nimport NpcDetailDisplay from '../common/NpcDetailDisplay.vue';\nimport FollowButton from '../common/FollowButton.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcDirectoryPanel',\n    setup(__props) {\n        const worlds = ref([]);\n        const selectedWorldId = ref(null);\n        const selectedNpc = ref(null);\n        const selectedNpcId = ref(null);\n        const isWorldListVisible = ref(false);\n        const worldSearchTerm = ref('');\n        const npcSearchTerm = ref('');\n        const filteredWorlds = computed(() => {\n            if (!worldSearchTerm.value)\n                return worlds.value;\n            return worlds.value.filter(w => w.name.includes(worldSearchTerm.value));\n        });\n        const selectedWorldNpcs = computed(() => {\n            if (!selectedWorldId.value)\n                return [];\n            const npcs = npcService.getNpcsByWorld(selectedWorldId.value);\n            // NPC locationName \n            npcs.forEach(npc => {\n                const locationId = npc.;\n                npc.locationName = npcService.getLocationName(locationId);\n            });\n            return npcs;\n        });\n        const filteredNpcs = computed(() => {\n            if (!npcSearchTerm.value)\n                return selectedWorldNpcs.value;\n            return selectedWorldNpcs.value.filter(n => n. && n..includes(npcSearchTerm.value));\n        });\n        const loadWorlds = async () => {\n            worlds.value = await npcService.initializeWorldAndLocationData();\n            if (worlds.value.length > 0 && !selectedWorldId.value) {\n                selectedWorldId.value = worlds.value[0].id;\n            }\n        };\n        function selectWorld(worldId) {\n            selectedWorldId.value = worldId;\n            isWorldListVisible.value = false;\n        }\n        function selectNpc(npc) {\n            selectedNpc.value = npc;\n            selectedNpcId.value = npcService.getNpcId(npc);\n        }\n        onMounted(loadWorlds);\n        watch(selectedWorldId, () => {\n            selectedNpc.value = null;\n            selectedNpcId.value = null;\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"button\", {\n                    class: \"toggle-world-list\",\n                    onClick: _cache[0] || (_cache[0] = ($event) => (isWorldListVisible.value = !isWorldListVisible.value))\n                }, \"\"),\n                _createCommentVNode(\" World List (Overlay) \"),\n                (isWorldListVisible.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 0,\n                        class: \"world-list-overlay\",\n                        onClick: _cache[2] || (_cache[2] = _withModifiers(($event) => (isWorldListVisible.value = false), [\"self\"]))\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_2, [\n                            _cache[4] || (_cache[4] = _createElementVNode(\"h4\", null, \"\", -1 /* CACHED */)),\n                            _withDirectives(_createElementVNode(\"input\", {\n                                type: \"text\",\n                                \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event) => ((worldSearchTerm).value = $event)),\n                                placeholder: \"...\",\n                                class: \"search-input\"\n                            }, null, 512 /* NEED_PATCH */), [\n                                [_vModelText, worldSearchTerm.value]\n                            ]),\n                            _createElementVNode(\"ul\", null, [\n                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(filteredWorlds.value, (world) => {\n                                    return (_openBlock(), _createElementBlock(\"li\", {\n                                        key: world.id,\n                                        class: _normalizeClass({ active: selectedWorldId.value === world.id }),\n                                        onClick: ($event) => (selectWorld(world.id))\n                                    }, _toDisplayString(world.name), 11 /* TEXT, CLASS, PROPS */, _hoisted_3));\n                                }), 128 /* KEYED_FRAGMENT */))\n                            ])\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\" NPC List \"),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    _cache[5] || (_cache[5] = _createElementVNode(\"h4\", null, \"NPC\", -1 /* CACHED */)),\n                    _withDirectives(_createElementVNode(\"input\", {\n                        type: \"text\",\n                        \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event) => ((npcSearchTerm).value = $event)),\n                        placeholder: \"NPC...\",\n                        class: \"search-input\"\n                    }, null, 512 /* NEED_PATCH */), [\n                        [_vModelText, npcSearchTerm.value]\n                    ]),\n                    (filteredNpcs.value.length > 0)\n                        ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_5, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(filteredNpcs.value, (npc) => {\n                                return (_openBlock(), _createElementBlock(\"li\", {\n                                    key: npc.,\n                                    class: _normalizeClass({ active: selectedNpc.value === npc }),\n                                    onClick: ($event) => (selectNpc(npc))\n                                }, [\n                                    _createElementVNode(\"div\", _hoisted_7, [\n                                        _createElementVNode(\"span\", _hoisted_8, _toDisplayString(npc.), 1 /* TEXT */),\n                                        _createElementVNode(\"span\", _hoisted_9, _toDisplayString(npc.locationName), 1 /* TEXT */)\n                                    ]),\n                                    (npc.)\n                                        ? (_openBlock(), _createBlock(FollowButton, {\n                                            key: 0,\n                                            \"npc-id\": npc.\n                                        }, null, 8 /* PROPS */, [\"npc-id\"]))\n                                        : _createCommentVNode(\"v-if\", true)\n                                ], 10 /* CLASS, PROPS */, _hoisted_6));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_10, \"NPC\"))\n                ]),\n                _createCommentVNode(\" NPC Details \"),\n                _createElementVNode(\"div\", _hoisted_11, [\n                    _cache[6] || (_cache[6] = _createElementVNode(\"h4\", null, \"NPC\", -1 /* CACHED */)),\n                    (selectedNpc.value)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_12, [\n                            _createVNode(NpcDetailDisplay, {\n                                npc: selectedNpc.value,\n                                \"npc-id\": selectedNpcId.value\n                            }, null, 8 /* PROPS */, [\"npc\", \"npc-id\"])\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_13, \"NPC\"))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcDirectoryPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcDirectoryPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcDirectoryPanel.vue?vue&type=style&index=0&id=ac9ae7ac&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-ac9ae7ac\"]])\n\nexport default __exports__","import { reactive, computed, watch } from 'vue';\nimport { simulatorCooldown } from '../store/getters';\n\ninterface CooldownState {\n  remainingSeconds: number;\n  intervalId: number | null;\n}\n\nconst state = reactive<CooldownState>({\n  remainingSeconds: 0,\n  intervalId: null,\n});\n\nfunction parseCooldownTime(timeData: string | any[]): number {\n  if (!timeData) return 0;\n\n  let days = 0,\n    hours = 0,\n    minutes = 0;\n  let dataToParse: any = timeData;\n\n  // \n  if (typeof dataToParse === 'string' && dataToParse.startsWith('[') && dataToParse.endsWith(']')) {\n    try {\n      // JSON\n      dataToParse = JSON.parse(dataToParse.replace(/|/g, '\"'));\n    } catch (e) {\n      console.error('Failed to parse cooldown time string as JSON:', timeData, e);\n      dataToParse = []; // \n    }\n  }\n\n  if (Array.isArray(dataToParse)) {\n    // : [6, \"\", 23, \"\", 35, \"\"]\n    const dayIndex = dataToParse.indexOf('');\n    if (dayIndex > 0) days = Number(dataToParse[dayIndex - 1]) || 0;\n\n    const hourIndex = dataToParse.indexOf('');\n    if (hourIndex > 0) hours = Number(dataToParse[hourIndex - 1]) || 0;\n\n    const minIndex = dataToParse.indexOf('');\n    if (minIndex > 0) minutes = Number(dataToParse[minIndex - 1]) || 0;\n  } else if (typeof dataToParse === 'string') {\n    // : \"700\"\n    const daysMatch = dataToParse.match(/(\\d+)/);\n    const hoursMatch = dataToParse.match(/(\\d+)/);\n    const minutesMatch = dataToParse.match(/(\\d+)/);\n    days = daysMatch ? parseInt(daysMatch[1], 10) : 0;\n    hours = hoursMatch ? parseInt(hoursMatch[1], 10) : 0;\n    minutes = minutesMatch ? parseInt(minutesMatch[1], 10) : 0;\n  }\n\n  return days * 24 * 60 * 60 + hours * 60 * 60 + minutes * 60;\n}\n\nfunction formatRemainingTime(seconds: number): string {\n  if (seconds <= 0) return '';\n\n  const days = Math.floor(seconds / (24 * 60 * 60));\n  seconds -= days * 24 * 60 * 60;\n  const hours = Math.floor(seconds / (60 * 60));\n  seconds -= hours * 60 * 60;\n  const minutes = Math.floor(seconds / 60);\n\n  return `${days}${hours}${minutes}`;\n}\n\nfunction startCountdown() {\n  if (state.intervalId) {\n    clearInterval(state.intervalId);\n  }\n  state.intervalId = window.setInterval(() => {\n    if (state.remainingSeconds > 0) {\n      state.remainingSeconds--;\n    } else {\n      stopCountdown();\n    }\n  }, 1000); // Update every second\n}\n\nfunction stopCountdown() {\n  if (state.intervalId) {\n    clearInterval(state.intervalId);\n    state.intervalId = null;\n  }\n}\n\nwatch(\n  simulatorCooldown,\n  newCooldown => {\n    if (newCooldown.status === '') {\n      const totalSeconds = parseCooldownTime(newCooldown.time);\n      if (state.remainingSeconds <= 0 || Math.abs(state.remainingSeconds - totalSeconds) > 5) {\n        state.remainingSeconds = totalSeconds;\n      }\n      if (!state.intervalId) {\n        startCountdown();\n      }\n    } else {\n      state.remainingSeconds = 0;\n      stopCountdown();\n    }\n  },\n  { immediate: true, deep: true },\n);\n\nexport const cooldownService = {\n  remainingTime: computed(() => formatRemainingTime(state.remainingSeconds)),\n  isCoolingDown: computed(() => state.remainingSeconds > 0 && simulatorCooldown.value.status === ''),\n};\n","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = { class: \"log-panel-container\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"timeline\"\n};\nconst _hoisted_3 = [\"onClick\"];\nconst _hoisted_4 = { class: \"log-header\" };\nconst _hoisted_5 = { class: \"log-title\" };\nconst _hoisted_6 = { class: \"log-date\" };\nconst _hoisted_7 = { class: \"log-meta\" };\nconst _hoisted_8 = { class: \"log-description\" };\nconst _hoisted_9 = {\n    key: 0,\n    class: \"log-details\"\n};\nconst _hoisted_10 = { class: \"detail-section\" };\nconst _hoisted_11 = { class: \"detail-section\" };\nconst _hoisted_12 = { class: \"detail-section\" };\nconst _hoisted_13 = { class: \"detail-section automation-system\" };\nconst _hoisted_14 = {\n    key: 0,\n    class: \"log-tags\"\n};\nconst _hoisted_15 = {\n    key: 1,\n    class: \"empty-state\"\n};\nimport { computed, ref } from 'vue';\nimport { store } from '../../store';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'LogPanel',\n    setup(__props) {\n        const logs = computed(() => [...store.worldLog].sort((a, b) => b. - a.));\n        const expandedLog = ref(null);\n        function toggleDetails(logId) {\n            if (expandedLog.value === logId) {\n                expandedLog.value = null;\n            }\n            else {\n                expandedLog.value = logId;\n            }\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (logs.value.length > 0)\n                    ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_2, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(logs.value, (log) => {\n                            return (_openBlock(), _createElementBlock(\"li\", {\n                                key: log.,\n                                class: \"timeline-item\"\n                            }, [\n                                _cache[6] || (_cache[6] = _createElementVNode(\"div\", { class: \"timeline-marker\" }, null, -1 /* CACHED */)),\n                                _createElementVNode(\"div\", {\n                                    class: \"timeline-content\",\n                                    onClick: ($event) => (toggleDetails(log.))\n                                }, [\n                                    _createElementVNode(\"div\", _hoisted_4, [\n                                        _createElementVNode(\"span\", _hoisted_5, _toDisplayString(log.), 1 /* TEXT */),\n                                        _createElementVNode(\"span\", _hoisted_6, _toDisplayString(log.), 1 /* TEXT */)\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_7, [\n                                        _createElementVNode(\"span\", null, [\n                                            _cache[0] || (_cache[0] = _createElementVNode(\"i\", { class: \"fas fa-map-marker-alt icon\" }, null, -1 /* CACHED */)),\n                                            _createTextVNode(\" \" + _toDisplayString(log.), 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"span\", null, [\n                                            _cache[1] || (_cache[1] = _createElementVNode(\"i\", { class: \"fas fa-users icon\" }, null, -1 /* CACHED */)),\n                                            _createTextVNode(\" \" + _toDisplayString(log.), 1 /* TEXT */)\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"p\", _hoisted_8, _toDisplayString(log.), 1 /* TEXT */),\n                                    (expandedLog.value === log.)\n                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [\n                                            _createElementVNode(\"div\", _hoisted_10, [\n                                                _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                _createElementVNode(\"p\", null, _toDisplayString(log.), 1 /* TEXT */)\n                                            ]),\n                                            _createElementVNode(\"div\", _hoisted_11, [\n                                                _cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                _createElementVNode(\"p\", null, _toDisplayString(log.), 1 /* TEXT */)\n                                            ]),\n                                            _createElementVNode(\"div\", _hoisted_12, [\n                                                _cache[4] || (_cache[4] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                _createElementVNode(\"p\", null, _toDisplayString(log.), 1 /* TEXT */)\n                                            ]),\n                                            _createElementVNode(\"div\", _hoisted_13, [\n                                                _cache[5] || (_cache[5] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                _createElementVNode(\"pre\", null, _toDisplayString(log.), 1 /* TEXT */)\n                                            ]),\n                                            (log. && log..length > 0)\n                                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_14, [\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(log., (tag) => {\n                                                        return (_openBlock(), _createElementBlock(\"span\", {\n                                                            key: tag,\n                                                            class: \"tag\"\n                                                        }, _toDisplayString(tag), 1 /* TEXT */));\n                                                    }), 128 /* KEYED_FRAGMENT */))\n                                                ]))\n                                                : _createCommentVNode(\"v-if\", true)\n                                        ]))\n                                        : _createCommentVNode(\"v-if\", true)\n                                ], 8 /* PROPS */, _hoisted_3)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_15, [...(_cache[7] || (_cache[7] = [\n                            _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                        ]))]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./LogPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./LogPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./LogPanel.vue?vue&type=style&index=0&id=03bc3d58&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-03bc3d58\"]])\n\nexport default __exports__","import { reactive } from 'vue';\nimport { lorebookService } from './LorebookService';\n\nexport interface Ripple {\n  id: number;\n  title: string;\n  rawContent: string;\n  [key: string]: any;\n}\n\n//  actions.ts \nfunction parseBlock(block: string): { [key: string]: string } {\n  const data: { [key: string]: string } = {};\n  const lines = block.trim().split('\\n');\n  let currentKey = '';\n  for (const line of lines) {\n    const separatorIndex = line.indexOf('|');\n    if (separatorIndex !== -1) {\n      const key = line.substring(0, separatorIndex).trim();\n      const value = line.substring(separatorIndex + 1).trim();\n      data[key] = value;\n      currentKey = key;\n    } else if (currentKey && line.trim()) {\n      data[currentKey] += '\\n' + line;\n    }\n  }\n  for (const key in data) {\n    data[key] = data[key].trim();\n  }\n  return data;\n}\n\nclass RipplesService {\n  public ripples = reactive<Ripple[]>([]);\n\n  async initialize() {\n    await this.loadRipples();\n  }\n\n  async loadRipples() {\n    try {\n      const rippleContent = await lorebookService.readFromLorebook('');\n      if (!rippleContent || !rippleContent.trim()) {\n        this.ripples.splice(0, this.ripples.length); // \n        return;\n      }\n\n      const rippleBlocks = rippleContent.split('\\n\\n---\\n\\n');\n      const parsedRipples: Ripple[] = [];\n\n      for (const blockContent of rippleBlocks) {\n        if (!blockContent.trim()) continue;\n        const blockData = parseBlock(blockContent);\n        const rippleId = parseInt(blockData['x'], 10);\n\n        if (!isNaN(rippleId)) {\n          parsedRipples.push({\n            id: rippleId,\n            title: ` ${rippleId} `,\n            rawContent: blockContent,\n            ...blockData,\n          });\n        }\n      }\n\n      // \n      this.ripples.splice(0, this.ripples.length, ...parsedRipples.sort((a, b) => a.id - b.id));\n      console.log(`[RipplesService] Loaded ${this.ripples.length} ripples.`);\n    } catch (error) {\n      console.error('[RipplesService] Error loading ripples:', error);\n      this.ripples.splice(0, this.ripples.length); // \n    }\n  }\n\n  getRippleById(id: number): Ripple | undefined {\n    return this.ripples.find(r => r.id === id);\n  }\n}\n\nexport const ripplesService = new RipplesService();\n","import { defineComponent as _defineComponent } from 'vue';\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode } from \"vue\";\nconst _hoisted_1 = { class: \"ripples-panel\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"ripples-list\"\n};\nconst _hoisted_3 = {\n    key: 0,\n    class: \"empty-state\"\n};\nconst _hoisted_4 = { key: 1 };\nconst _hoisted_5 = [\"onClick\"];\nconst _hoisted_6 = { class: \"ripple-title\" };\nconst _hoisted_7 = { class: \"ripple-summary\" };\nconst _hoisted_8 = {\n    key: 1,\n    class: \"ripple-detail\"\n};\nconst _hoisted_9 = { class: \"detail-content\" };\nconst _hoisted_10 = { class: \"detail-key\" };\nconst _hoisted_11 = { class: \"detail-value\" };\nimport { ref, computed, onMounted } from 'vue';\nimport { ripplesService } from '../../services/RipplesService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'RipplesPanel',\n    setup(__props) {\n        const ripples = computed(() => ripplesService.ripples);\n        const selectedRipple = ref(null);\n        const selectRipple = (ripple) => {\n            selectedRipple.value = ripple;\n        };\n        onMounted(() => {\n            ripplesService.loadRipples();\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (!selectedRipple.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        (ripples.value.length === 0)\n                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, \"\"))\n                            : (_openBlock(), _createElementBlock(\"ul\", _hoisted_4, [\n                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(ripples.value, (ripple) => {\n                                    return (_openBlock(), _createElementBlock(\"li\", {\n                                        key: ripple.id,\n                                        onClick: ($event) => (selectRipple(ripple))\n                                    }, [\n                                        _createElementVNode(\"span\", _hoisted_6, _toDisplayString(ripple.title), 1 /* TEXT */),\n                                        _createElementVNode(\"span\", _hoisted_7, _toDisplayString(ripple['']?.substring(0, 50)) + \"...\", 1 /* TEXT */)\n                                    ], 8 /* PROPS */, _hoisted_5));\n                                }), 128 /* KEYED_FRAGMENT */))\n                            ]))\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [\n                        _createElementVNode(\"button\", {\n                            onClick: _cache[0] || (_cache[0] = ($event) => (selectedRipple.value = null)),\n                            class: \"back-button\"\n                        }, \"< \"),\n                        _createElementVNode(\"div\", _hoisted_9, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(selectedRipple.value, (value, key) => {\n                                return (_openBlock(), _createElementBlock(\"div\", {\n                                    key: key,\n                                    class: \"detail-item\"\n                                }, [\n                                    _createElementVNode(\"strong\", _hoisted_10, _toDisplayString(key) + \":\", 1 /* TEXT */),\n                                    _createElementVNode(\"pre\", _hoisted_11, _toDisplayString(value), 1 /* TEXT */)\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ])\n                    ]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./RipplesPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./RipplesPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./RipplesPanel.vue?vue&type=style&index=0&id=c8ad07aa&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-c8ad07aa\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = { class: \"avatar-selection\" };\nconst _hoisted_2 = { key: 0 };\nconst _hoisted_3 = [\"onClick\"];\nimport { computed } from 'vue';\nimport { actions, store } from '../../../store';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'AvatarSelection',\n    setup(__props) {\n        const avatars = computed(() => store.reincarnationAvatarOptions);\n        const selectAvatar = (avatar) => {\n            //  action\n            actions.selectAvatarAndStart(avatar.);\n            // \n            // \n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (avatars.value.length === 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, \"AI...\"))\n                    : (_openBlock(true), _createElementBlock(_Fragment, { key: 1 }, _renderList(avatars.value, (avatar, index) => {\n                        return (_openBlock(), _createElementBlock(\"div\", {\n                            key: index,\n                            class: \"avatar-card\",\n                            onClick: ($event) => (selectAvatar(avatar))\n                        }, [\n                            _createElementVNode(\"h4\", null, _toDisplayString(avatar.), 1 /* TEXT */),\n                            _createElementVNode(\"p\", null, [\n                                _cache[0] || (_cache[0] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                _createTextVNode(\" \" + _toDisplayString(avatar.), 1 /* TEXT */)\n                            ]),\n                            _createElementVNode(\"p\", null, [\n                                _cache[1] || (_cache[1] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                _createTextVNode(\" \" + _toDisplayString(avatar.), 1 /* TEXT */)\n                            ])\n                        ], 8 /* PROPS */, _hoisted_3));\n                    }), 128 /* KEYED_FRAGMENT */))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./AvatarSelection.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AvatarSelection.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./AvatarSelection.vue?vue&type=style&index=0&id=375c1c96&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-375c1c96\"]])\n\nexport default __exports__","import { reactive } from 'vue';\n\ninterface ConfirmationState {\n  isVisible: boolean;\n  title: string;\n  message: string;\n  onConfirm: (() => void) | null;\n  onCancel: (() => void) | null;\n  hideCancel: boolean;\n}\n\nconst state = reactive<ConfirmationState>({\n  isVisible: false,\n  title: '',\n  message: '',\n  onConfirm: null,\n  onCancel: null,\n  hideCancel: false,\n});\n\nexport const confirmationService = {\n  get state() {\n    return state;\n  },\n\n  show(title: string, message: string, onConfirm: () => void, hideCancel = false) {\n    return new Promise<boolean>(resolve => {\n      state.title = title;\n      state.message = message;\n      state.onConfirm = () => {\n        onConfirm();\n        resolve(true);\n      };\n      state.onCancel = () => {\n        this.hide();\n        resolve(false);\n      };\n      state.hideCancel = hideCancel;\n      state.isVisible = true;\n    });\n  },\n\n  hide() {\n    state.isVisible = false;\n    state.title = '';\n    state.message = '';\n    state.onConfirm = null;\n    state.onCancel = null;\n    state.hideCancel = false;\n  },\n\n  confirm() {\n    if (state.onConfirm) {\n      state.onConfirm(); // This will now also resolve the promise\n    }\n    // Hiding is handled within onConfirm/onCancel now\n  },\n  cancel() {\n    if (state.onCancel) {\n      state.onCancel();\n    }\n  },\n};\n","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"card-header\" };\nconst _hoisted_2 = { class: \"choice-type\" };\nconst _hoisted_3 = { class: \"card-body\" };\nconst _hoisted_4 = { class: \"description\" };\nconst _hoisted_5 = {\n    key: 0,\n    class: \"data-details\"\n};\nconst _hoisted_6 = { class: \"data-name\" };\nconst _hoisted_7 = { class: \"data-description\" };\nconst _hoisted_8 = { class: \"card-footer\" };\nconst _hoisted_9 = { class: \"cost\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'SettlementChoiceCard',\n    props: {\n        choice: {\n            type: Object,\n            required: true,\n        },\n        isSelected: {\n            type: Boolean,\n            default: false,\n        },\n    },\n    emits: ['select'],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emits = __emit;\n        const selectCard = () => {\n            emits('select', props.choice);\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n                class: _normalizeClass([\"settlement-choice-card\", { 'is-selected': __props.isSelected }]),\n                onClick: selectCard\n            }, [\n                _createElementVNode(\"div\", _hoisted_1, [\n                    _createElementVNode(\"span\", _hoisted_2, _toDisplayString(__props.choice.), 1 /* TEXT */)\n                ]),\n                _createElementVNode(\"div\", _hoisted_3, [\n                    _createElementVNode(\"p\", _hoisted_4, _toDisplayString(__props.choice.), 1 /* TEXT */),\n                    (__props.choice.)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n                            _createElementVNode(\"strong\", _hoisted_6, _toDisplayString(__props.choice..), 1 /* TEXT */),\n                            _createElementVNode(\"p\", _hoisted_7, _toDisplayString(__props.choice..), 1 /* TEXT */)\n                        ]))\n                        : _createCommentVNode(\"v-if\", true)\n                ]),\n                _createElementVNode(\"div\", _hoisted_8, [\n                    _createElementVNode(\"span\", _hoisted_9, \": \" + _toDisplayString(__props.choice.), 1 /* TEXT */)\n                ])\n            ], 2 /* CLASS */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./SettlementChoiceCard.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SettlementChoiceCard.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","const __WEBPACK_NAMESPACE_OBJECT__ = toastr;","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode } from \"vue\";\nconst _hoisted_1 = { class: \"settlement-view\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"choices-grid\"\n};\nconst _hoisted_3 = {\n    key: 1,\n    class: \"no-choices\"\n};\nconst _hoisted_4 = {\n    key: 2,\n    class: \"actions-footer\"\n};\nconst _hoisted_5 = [\"disabled\"];\nimport { get } from 'lodash';\nimport { computed, ref } from 'vue';\nimport { confirmationService } from '../../../services/ConfirmationService';\nimport { commandService } from '../../../services/CommandService';\nimport { store } from '../../../store';\nimport SettlementChoiceCard from './SettlementChoiceCard.vue';\nimport * as toastr from 'toastr';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'SettlementView',\n    setup(__props) {\n        const selectedChoice = ref(null);\n        const choices = computed(() => {\n            const choicesObj = get(store.worldState, '..', {});\n            if (typeof choicesObj === 'object' && choicesObj !== null) {\n                return Object.values(choicesObj).filter((c) => c && c. && c. && !c..includes(''));\n            }\n            return [];\n        });\n        const confirmChoice = async () => {\n            if (!selectedChoice.value)\n                return;\n            const choice = selectedChoice.value;\n            // Robustly find the main character by looking for the '' property\n            const characters = get(store.worldState, '', {});\n            const mainCharacter = Object.values(characters).find((char) => char && char.hasOwnProperty(''));\n            if (!mainCharacter) {\n                toastr.error('');\n                console.error('Could not find the main character in the world state.');\n                return;\n            }\n            const soulEssence = get(mainCharacter, '[0]', 0);\n            if (soulEssence < choice.) {\n                await confirmationService.show('', ` ${choice.}  ${soulEssence}`, () => { }, true);\n                return;\n            }\n            const confirmed = await confirmationService.show('?', ` ${choice.} ${choice..}`, () => { });\n            if (confirmed) {\n                // This is a placeholder for the action to confirm the choice.\n                // You would typically call a store action here.\n                console.log('Confirmed choice:', choice);\n                const command = `< ${JSON.stringify(choice.)}>`;\n                commandService.addCommand(command);\n                confirmationService.hide();\n                toastr.success(`: ${choice..}`);\n            }\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (choices.value.length > 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(choices.value, (choice, index) => {\n                            return (_openBlock(), _createBlock(SettlementChoiceCard, {\n                                key: index,\n                                choice: choice,\n                                \"is-selected\": selectedChoice.value === choice,\n                                onSelect: _cache[0] || (_cache[0] = ($event) => (selectedChoice.value = $event))\n                            }, null, 8 /* PROPS */, [\"choice\", \"is-selected\"]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [...(_cache[1] || (_cache[1] = [\n                            _createElementVNode(\"p\", null, \"\", -1 /* CACHED */),\n                            _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                        ]))])),\n                (choices.value.length > 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [\n                        _createElementVNode(\"button\", {\n                            class: \"confirm-button\",\n                            onClick: confirmChoice,\n                            disabled: !selectedChoice.value\n                        }, \"\", 8 /* PROPS */, _hoisted_5)\n                    ]))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./SettlementView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SettlementView.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import * as THREE from 'three';\nimport { OrbitControls } from 'three/addons/controls/OrbitControls.js';\n\ninterface WorldData {\n  id: number;\n  name: string;\n  [key: string]: any;\n}\n\ninterface StarObject extends THREE.Group {\n  orbitSpeed?: number;\n  orbitRadius?: number;\n  orbitAngle?: number;\n}\n\nexport class StarMapService {\n  private scene: THREE.Scene;\n  private camera: THREE.PerspectiveCamera;\n  private renderer: THREE.WebGLRenderer;\n  private controls: OrbitControls;\n  private container: HTMLElement;\n  private stars: THREE.Group;\n  private skybox: THREE.Mesh | null = null;\n  private starObjects: StarObject[] = [];\n  private speedMultiplier: number = 0.2; // Add a speed multiplier\n\n  constructor(container: HTMLElement) {\n    console.log('[StarMapService] Constructor called.');\n    this.container = container;\n    this.scene = new THREE.Scene();\n    this.camera = new THREE.PerspectiveCamera(75, this.container.clientWidth / this.container.clientHeight, 0.1, 1000);\n    this.renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });\n    this.stars = new THREE.Group();\n\n    this.init();\n\n    this.controls = new OrbitControls(this.camera, this.renderer.domElement);\n    this.controls.enableDamping = true; // Smooths out the camera movement\n    this.controls.dampingFactor = 0.05;\n    this.controls.autoRotate = true;\n    this.controls.autoRotateSpeed = 0.1;\n    this.controls.minDistance = 5; // Allow zooming in closer\n    this.controls.maxDistance = 200; // Allow zooming out further\n    this.controls.enablePan = true; // Enable panning with right-click\n    this.controls.panSpeed = 0.5;\n\n    this.animate();\n  }\n\n  private init() {\n    console.log('[StarMapService] Init started.');\n    // Renderer\n    this.renderer.setSize(this.container.clientWidth, this.container.clientHeight);\n    this.renderer.setPixelRatio(window.devicePixelRatio);\n    this.container.appendChild(this.renderer.domElement);\n\n    // Camera\n    this.camera.position.z = 50;\n    this.scene.add(this.camera);\n\n    // Stars group\n    this.scene.add(this.stars);\n\n    // Handle window resize\n    window.addEventListener('resize', this.onWindowResize.bind(this));\n    this.createSkybox();\n  }\n\n  private createSkybox() {\n    const shaderMaterial = new THREE.ShaderMaterial({\n      vertexShader: `\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      `,\n      fragmentShader: `\n        varying vec2 vUv;\n        uniform float u_time;\n\n        float random(vec2 st) {\n          return fract(sin(dot(st.xy, vec2(12.9898, 78.233))) * 43758.5453123);\n        }\n\n        float noise(vec2 st) {\n          vec2 i = floor(st);\n          vec2 f = fract(st);\n          vec2 u = f * f * (3.0 - 2.0 * f);\n          return mix(mix(random(i + vec2(0.0, 0.0)), random(i + vec2(1.0, 0.0)), u.x),\n                     mix(random(i + vec2(0.0, 1.0)), random(i + vec2(1.0, 1.0)), u.x), u.y);\n        }\n\n        mat2 rotate(float a) {\n          float s = sin(a);\n          float c = cos(a);\n          return mat2(c, -s, s, c);\n        }\n\n        float fbm(vec2 st) {\n          float value = 0.0;\n          float amplitude = 0.5;\n          for (int i = 0; i < 6; i++) {\n            value += amplitude * noise(st);\n            st *= 2.0;\n            amplitude *= 0.5;\n          }\n          return value;\n        }\n\n        void main() {\n          vec2 st = vUv * 5.0;\n          st.x *= 1.5;\n          st *= rotate(u_time * 0.005);\n          \n          float f = fbm(st + u_time * 0.01);\n          f *= fbm(st * 0.5 + u_time * 0.005);\n\n          vec3 color1 = vec3(0.05, 0.0, 0.15);   // Deep Space Blue\n          vec3 color2 = vec3(0.2, 0.1, 0.5);    // Nebula Purple\n          vec3 color3 = vec3(0.8, 0.3, 0.3);    // Distant Star Red\n\n          float t = smoothstep(0.3, 0.6, f);\n          vec3 finalColor = mix(color1, color2, t);\n          finalColor = mix(finalColor, color3, smoothstep(0.5, 0.7, f));\n\n          gl_FragColor = vec4(finalColor, 1.0);\n        }\n      `,\n      uniforms: {\n        u_time: { value: 0.0 },\n      },\n      side: THREE.BackSide,\n    });\n\n    const skyboxGeometry = new THREE.SphereGeometry(500, 60, 40);\n    this.skybox = new THREE.Mesh(skyboxGeometry, shaderMaterial);\n    this.scene.add(this.skybox);\n  }\n\n  private getColorForEnergyLevel(level: number): THREE.Color {\n    if (level <= 5) return new THREE.Color(0x00ffff); // Cyan\n    if (level <= 10) return new THREE.Color(0x00ff00); // Green\n    if (level <= 15) return new THREE.Color(0xffff00); // Yellow\n    if (level <= 20) return new THREE.Color(0xffa500); // Orange\n    return new THREE.Color(0x800080); // Purple\n  }\n\n  public createStars(worlds: WorldData[], selectableIds: Set<number>) {\n    console.log(`[StarMapService] createStars called with ${worlds.length} worlds.`);\n    this.stars.clear();\n\n    if (worlds.length === 0) {\n      console.warn('[StarMapService] createStars called with empty array.');\n      return;\n    }\n\n    const coreGeometry = new THREE.SphereGeometry(0.3, 16, 16);\n    const haloGeometry = new THREE.SphereGeometry(0.5, 16, 16);\n\n    worlds.forEach(world => {\n      const phi = Math.acos(-1 + 2 * Math.random());\n      const theta = Math.sqrt(worlds.length * Math.PI) * phi;\n      const radius = 30;\n\n      const x = radius * Math.cos(theta) * Math.sin(phi);\n      const y = radius * Math.sin(theta) * Math.sin(phi);\n      const z = radius * Math.cos(phi);\n\n      const isSelectable = selectableIds.has(world.id);\n      const energyLevel = world.energyLevel || 1;\n      const timeFlow = world.timeFlow || 1;\n\n      const baseColor = this.getColorForEnergyLevel(energyLevel);\n      const starColor = isSelectable ? baseColor : new THREE.Color(0x444444);\n\n      // Star Core\n      const coreMaterial = new THREE.MeshBasicMaterial({ color: starColor });\n      const core = new THREE.Mesh(coreGeometry, coreMaterial);\n\n      // Star Halo\n      const haloMaterial = new THREE.MeshBasicMaterial({\n        color: starColor,\n        transparent: true,\n        opacity: 0.4,\n        blending: THREE.AdditiveBlending,\n      });\n      const halo = new THREE.Mesh(haloGeometry, haloMaterial);\n\n      // Scale halo based on time flow\n      const haloScale = 1.5; // Fixed small halo\n      halo.scale.set(haloScale, haloScale, haloScale);\n\n      const starGroup: StarObject = new THREE.Group();\n      starGroup.add(core);\n      starGroup.add(halo);\n\n      starGroup.position.set(x, y, z);\n\n      // Store world data in the group for picking\n      halo.userData = { world };\n\n      // Store orbit data\n      starGroup.orbitSpeed = 0.0005 + Math.log1p(timeFlow) * 0.001; // Lower base speed\n      starGroup.orbitRadius = Math.sqrt(x * x + z * z); // Orbit in XZ plane\n      starGroup.orbitAngle = Math.atan2(z, x);\n\n      this.stars.add(starGroup);\n      this.starObjects.push(starGroup);\n    });\n  }\n\n  private animate() {\n    requestAnimationFrame(this.animate.bind(this));\n\n    // Update shader time uniform\n    if (this.skybox && this.skybox.material instanceof THREE.ShaderMaterial) {\n      this.skybox.material.uniforms.u_time.value += 0.01;\n    }\n\n    // Update star orbits\n    this.starObjects.forEach(star => {\n      if (star.orbitSpeed && star.orbitRadius && star.orbitAngle !== undefined) {\n        star.orbitAngle += star.orbitSpeed * this.speedMultiplier;\n        star.position.x = star.orbitRadius * Math.cos(star.orbitAngle);\n        star.position.z = star.orbitRadius * Math.sin(star.orbitAngle);\n      }\n    });\n\n    this.controls.update();\n    this.renderer.render(this.scene, this.camera);\n  }\n\n  private onWindowResize() {\n    this.camera.aspect = this.container.clientWidth / this.container.clientHeight;\n    this.camera.updateProjectionMatrix();\n    this.renderer.setSize(this.container.clientWidth, this.container.clientHeight);\n  }\n\n  public destroy() {\n    window.removeEventListener('resize', this.onWindowResize.bind(this));\n    this.renderer.dispose();\n    if (this.container && this.renderer.domElement) {\n      this.container.removeChild(this.renderer.domElement);\n    }\n  }\n\n  // Placeholder for click detection\n  public pickStar(event: MouseEvent): WorldData | null {\n    const raycaster = new THREE.Raycaster();\n    const mouse = new THREE.Vector2();\n    const rect = this.renderer.domElement.getBoundingClientRect();\n\n    // Calculate mouse position in normalized device coordinates\n    mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;\n    mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;\n\n    raycaster.setFromCamera(mouse, this.camera);\n    const intersects = raycaster.intersectObjects(this.stars.children);\n\n    if (intersects.length > 0) {\n      return intersects[0].object.userData.world as WorldData;\n    }\n    return null;\n  }\n\n  public setSpeedMultiplier(multiplier: number) {\n    this.speedMultiplier = Math.max(0, multiplier); // Ensure multiplier is not negative\n  }\n\n  public getSpeedMultiplier(): number {\n    return this.speedMultiplier;\n  }\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { normalizeStyle as _normalizeStyle, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, Fragment as _Fragment, normalizeClass as _normalizeClass, unref as _unref } from \"vue\";\nconst _hoisted_1 = { class: \"world-selection-container\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"loading-state\"\n};\nconst _hoisted_3 = { class: \"progress-bar-container\" };\nconst _hoisted_4 = { class: \"detail-item\" };\nconst _hoisted_5 = { class: \"detail-item\" };\nconst _hoisted_6 = { class: \"world-description\" };\nconst _hoisted_7 = { class: \"panel-footer\" };\nconst _hoisted_8 = [\"disabled\"];\nconst _hoisted_9 = {\n    key: 1,\n    class: \"unselectable-notice\"\n};\nconst _hoisted_10 = { class: \"map-controls\" };\nconst _hoisted_11 = { class: \"speed-controls-overlay\" };\nconst _hoisted_12 = { class: \"speed-bar-container\" };\nconst _hoisted_13 = {\n    key: 2,\n    class: \"evolving-overlay\"\n};\nimport { computed, onMounted, onUnmounted, ref, watch } from 'vue';\n// import { lorebookService } from '../../../services/LorebookService'; // \nimport { StarMapService } from '../../../services/StarMapService';\nimport { actions, store } from '../../../store';\nimport { isSimulationRunning, simulatorCooldown } from '../../../store/getters';\nimport './WorldSelection.scss';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'WorldSelection',\n    setup(__props) {\n        const starmapContainer = ref(null);\n        let starMapService = null;\n        const isLoading = ref(true);\n        const detailedWorld = ref(null);\n        const selectableWorldIds = ref(new Set());\n        const progress = ref(0);\n        let progressInterval = null;\n        // 5-speed level control\n        const speedLevels = [0, 0.2, 0.5, 1.0, 2.0];\n        const speedLevel = ref(2); // Default to level 2 (1.0x speed)\n        const parsedWorlds = computed(() => {\n            return store.reincarnationWorldOptions.map((w) => {\n                const content = w.content || '';\n                const energyLevelMatch = content.match(/:\\s*(\\d+)/);\n                const timeFlowMatch = content.match(/:\\s*([\\d.]+)x/);\n                const descriptionMatch = content.match(/:\\s*([^\\n]+)/);\n                return {\n                    id: w.uid,\n                    name: (w.name || w.comment).replace(/.*?/g, '').trim(),\n                    energyLevel: energyLevelMatch ? parseInt(energyLevelMatch[1], 10) : 1,\n                    timeFlow: timeFlowMatch ? parseFloat(timeFlowMatch[1]) : 1,\n                    description: descriptionMatch ? descriptionMatch[1] : '',\n                    raw: w,\n                };\n            });\n        });\n        const cooldown = computed(() => simulatorCooldown.value);\n        const isDetailedWorldActive = computed(() => {\n            // 1.  2. \n            return !isSimulationRunning.value && cooldown.value.status !== '';\n        });\n        const selectRandomWorlds = () => {\n            //  `isSimulationRunning` getter \n            // \n            if (isSimulationRunning.value) {\n                selectableWorldIds.value = new Set();\n                return;\n            }\n            // \n            const worlds = parsedWorlds.value;\n            if (worlds.length === 0)\n                return;\n            const ids = worlds.map(w => w.id);\n            if (worlds.length <= 3) {\n                selectableWorldIds.value = new Set(ids);\n            }\n            else {\n                const shuffled = [...ids].sort(() => 0.5 - Math.random());\n                selectableWorldIds.value = new Set(shuffled.slice(0, 3));\n            }\n        };\n        const rescanWorlds = () => {\n            isLoading.value = true;\n            detailedWorld.value = null;\n            progress.value = 0;\n            if (progressInterval) {\n                clearInterval(progressInterval);\n            }\n            progressInterval = window.setInterval(() => {\n                if (progress.value < 99) {\n                    progress.value++;\n                }\n                else {\n                    if (progressInterval)\n                        clearInterval(progressInterval);\n                }\n            }, 960); // 135 (95000ms / 99 ~= 960ms)\n            // \n            actions.resetReincarnationSelection();\n            // UI\n            actions.triggerCreationWorkflow();\n        };\n        // const syncNewWorlds = () => {\n        //   store.newWorldsAvailable = false;\n        //   // \n        //   window.location.reload();\n        // };\n        const handleCanvasClick = (event) => {\n            if (!starMapService)\n                return;\n            const pickedWorld = starMapService.pickStar(event);\n            if (pickedWorld) {\n                detailedWorld.value = pickedWorld;\n            }\n            else {\n                detailedWorld.value = null; // Close panel if clicking on empty space\n            }\n        };\n        watch(starmapContainer, newContainer => {\n            if (newContainer && !starMapService) {\n                console.log('[WorldSelection] starmapContainer is now available. Initializing StarMapService.');\n                starMapService = new StarMapService(newContainer);\n                // If worlds are already loaded, create stars immediately\n                if (parsedWorlds.value.length > 0) {\n                    console.log('[WorldSelection] Worlds already present, calling createStars from container watch.');\n                    starMapService.createStars(parsedWorlds.value, selectableWorldIds.value);\n                }\n            }\n        });\n        onMounted(async () => {\n            console.log('[WorldSelection] Component Mounted.');\n            // isLoading.value = true; // \n            await actions.fetchReincarnationWorlds();\n            selectRandomWorlds();\n            if (starMapService) {\n                starMapService.createStars(parsedWorlds.value, selectableWorldIds.value);\n            }\n            isLoading.value = false; // \n        });\n        onUnmounted(() => {\n            starMapService?.destroy();\n        });\n        watch(parsedWorlds, newWorlds => {\n            console.log(`[WorldSelection] Parsed worlds watcher triggered: ${newWorlds.length} worlds.`);\n            if (newWorlds.length > 0) {\n                // if (isLoading.value) { // \n                //   isLoading.value = false;\n                // }\n                //  await\n                selectRandomWorlds();\n                // The service might not be ready yet, the starmapContainer watcher will handle creation\n                if (starMapService) {\n                    console.log('[WorldSelection] Service exists, calling createStars from worlds watch.');\n                    starMapService.createStars(newWorlds, selectableWorldIds.value);\n                }\n            }\n        }, { deep: true });\n        // \n        watch(isSimulationRunning, (isRunning, wasRunning) => {\n            // \n            if (wasRunning && !isRunning) {\n                console.log('[WorldSelection] Simulation has ended. Re-selecting random worlds.');\n                selectRandomWorlds();\n            }\n        });\n        const prepareReincarnation = (world) => {\n            if (!isSimulationRunning.value) {\n                actions.triggerIdentityWorkflow(world);\n                detailedWorld.value = null;\n            }\n        };\n        const adjustSpeed = (delta) => {\n            const newLevel = speedLevel.value + delta;\n            if (newLevel >= 0 && newLevel < speedLevels.length) {\n                speedLevel.value = newLevel;\n                if (starMapService) {\n                    starMapService.setSpeedMultiplier(speedLevels[speedLevel.value]);\n                }\n            }\n        };\n        watch(speedLevel, newLevel => {\n            if (starMapService) {\n                starMapService.setSpeedMultiplier(speedLevels[newLevel]);\n            }\n        }, { immediate: true });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (isLoading.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _createElementVNode(\"div\", _hoisted_3, [\n                            _createElementVNode(\"div\", {\n                                class: \"progress-bar\",\n                                style: _normalizeStyle({ width: progress.value + '%' })\n                            }, null, 4 /* STYLE */)\n                        ]),\n                        _createElementVNode(\"span\", null, \"... \" + _toDisplayString(progress.value) + \"%\", 1 /* TEXT */)\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                (!isLoading.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 1,\n                        ref_key: \"starmapContainer\",\n                        ref: starmapContainer,\n                        class: \"star-map-canvas\",\n                        onClick: handleCanvasClick\n                    }, null, 512 /* NEED_PATCH */))\n                    : _createCommentVNode(\"v-if\", true),\n                _createElementVNode(\"div\", {\n                    class: _normalizeClass([\"world-detail-panel\", { visible: !!detailedWorld.value }])\n                }, [\n                    (detailedWorld.value)\n                        ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                            _createElementVNode(\"h4\", null, _toDisplayString(detailedWorld.value.name), 1 /* TEXT */),\n                            _createElementVNode(\"div\", _hoisted_4, [\n                                _createElementVNode(\"p\", null, [\n                                    _cache[4] || (_cache[4] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                    _createTextVNode(\" \" + _toDisplayString(detailedWorld.value.energyLevel), 1 /* TEXT */)\n                                ])\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_5, [\n                                _createElementVNode(\"p\", null, [\n                                    _cache[5] || (_cache[5] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                    _createTextVNode(\" \" + _toDisplayString(detailedWorld.value.timeFlow) + \"x\", 1 /* TEXT */)\n                                ])\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_6, [\n                                _createElementVNode(\"p\", null, _toDisplayString(detailedWorld.value.description), 1 /* TEXT */)\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_7, [\n                                (isDetailedWorldActive.value)\n                                    ? (_openBlock(), _createElementBlock(\"button\", {\n                                        key: 0,\n                                        onClick: _cache[0] || (_cache[0] = ($event) => (prepareReincarnation(detailedWorld.value.raw))),\n                                        disabled: !isDetailedWorldActive.value\n                                    }, \"  \", 8 /* PROPS */, _hoisted_8))\n                                    : (_openBlock(), _createElementBlock(\"p\", _hoisted_9, \"\"))\n                            ])\n                        ], 64 /* STABLE_FRAGMENT */))\n                        : _createCommentVNode(\"v-if\", true)\n                ], 2 /* CLASS */),\n                _createElementVNode(\"div\", _hoisted_10, [\n                    _createElementVNode(\"button\", {\n                        onClick: _cache[1] || (_cache[1] = ($event) => (rescanWorlds())),\n                        class: \"rescan-btn\"\n                    }, \"\")\n                ]),\n                _createElementVNode(\"div\", _hoisted_11, [\n                    _createElementVNode(\"button\", {\n                        onClick: _cache[2] || (_cache[2] = ($event) => (adjustSpeed(1))),\n                        title: \"\",\n                        class: \"control-btn\"\n                    }, \"+\"),\n                    _createElementVNode(\"div\", _hoisted_12, [\n                        _cache[6] || (_cache[6] = _createElementVNode(\"div\", { class: \"speed-bar-track\" }, null, -1 /* CACHED */)),\n                        _createElementVNode(\"div\", {\n                            class: \"speed-bar-fill\",\n                            style: _normalizeStyle({ height: `${speedLevel.value * 25}%` })\n                        }, null, 4 /* STYLE */)\n                    ]),\n                    _createElementVNode(\"button\", {\n                        onClick: _cache[3] || (_cache[3] = ($event) => (adjustSpeed(-1))),\n                        title: \"\",\n                        class: \"control-btn\"\n                    }, \"-\")\n                ]),\n                (_unref(isSimulationRunning))\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_13, [...(_cache[7] || (_cache[7] = [\n                            _createElementVNode(\"p\", null, \"...\", -1 /* CACHED */),\n                            _createElementVNode(\"div\", { class: \"spinner\" }, null, -1 /* CACHED */)\n                        ]))]))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./WorldSelection.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./WorldSelection.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./WorldSelection.vue?vue&type=style&index=0&id=189e8ce4&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-189e8ce4\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n    key: 0,\n    class: \"settlement-overlay\"\n};\nconst _hoisted_2 = { class: \"settlement-panel\" };\nconst _hoisted_3 = { class: \"settlement-header\" };\nconst _hoisted_4 = { class: \"settlement-content\" };\nconst _hoisted_5 = { class: \"content-grid\" };\nconst _hoisted_6 = { class: \"grid-item full-width\" };\nconst _hoisted_7 = { class: \"grid-item\" };\nconst _hoisted_8 = { class: \"grid-item\" };\nconst _hoisted_9 = { class: \"grid-item\" };\nconst _hoisted_10 = { class: \"grid-item\" };\nconst _hoisted_11 = { class: \"grid-item full-width\" };\nconst _hoisted_12 = { class: \"cause-of-death\" };\nconst _hoisted_13 = { class: \"grid-item full-width\" };\nconst _hoisted_14 = { class: \"grid-item full-width\" };\nconst _hoisted_15 = { class: \"evaluation\" };\nimport { actions } from '../../store';\nimport { ripples as ripplesData } from '../../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'SettlementPanel',\n    setup(__props) {\n        function closeSettlement() {\n            actions.clearSettlementData();\n        }\n        return (_ctx, _cache) => {\n            return (_unref(ripplesData))\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                    _createElementVNode(\"div\", _hoisted_2, [\n                        _createElementVNode(\"div\", _hoisted_3, [\n                            _createElementVNode(\"h2\", null, \" \" + _toDisplayString(_unref(ripplesData).x) + \"  - \", 1 /* TEXT */)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_4, [\n                            _createElementVNode(\"div\", _hoisted_5, [\n                                _createElementVNode(\"div\", _hoisted_6, [\n                                    _cache[0] || (_cache[0] = _createElementVNode(\"h3\", null, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"p\", null, _toDisplayString(_unref(ripplesData).), 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_7, [\n                                    _cache[1] || (_cache[1] = _createElementVNode(\"h3\", null, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"p\", null, _toDisplayString(_unref(ripplesData).), 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_8, [\n                                    _cache[2] || (_cache[2] = _createElementVNode(\"h3\", null, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"p\", null, _toDisplayString(_unref(ripplesData).), 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_9, [\n                                    _cache[3] || (_cache[3] = _createElementVNode(\"h3\", null, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"p\", null, _toDisplayString(_unref(ripplesData).), 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_10, [\n                                    _cache[4] || (_cache[4] = _createElementVNode(\"h3\", null, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"p\", null, _toDisplayString(_unref(ripplesData).), 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_11, [\n                                    _cache[5] || (_cache[5] = _createElementVNode(\"h3\", null, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"p\", _hoisted_12, _toDisplayString(_unref(ripplesData).), 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_13, [\n                                    _cache[6] || (_cache[6] = _createElementVNode(\"h3\", null, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"p\", null, _toDisplayString(_unref(ripplesData).), 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_14, [\n                                    _cache[7] || (_cache[7] = _createElementVNode(\"h3\", null, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"p\", _hoisted_15, _toDisplayString(_unref(ripplesData).), 1 /* TEXT */)\n                                ])\n                            ])\n                        ]),\n                        _createElementVNode(\"div\", { class: \"settlement-footer\" }, [\n                            _createElementVNode(\"button\", { onClick: closeSettlement }, \"\")\n                        ])\n                    ])\n                ]))\n                : _createCommentVNode(\"v-if\", true);\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./SettlementPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SettlementPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./SettlementPanel.vue?vue&type=style&index=0&id=fd6b92fa&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-fd6b92fa\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, toDisplayString as _toDisplayString, normalizeStyle as _normalizeStyle, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = { class: \"reincarnation-panel\" };\nconst _hoisted_2 = { class: \"tabs\" };\nconst _hoisted_3 = [\"disabled\"];\nconst _hoisted_4 = { class: \"tab-content\" };\nimport { computed, ref, watch } from 'vue';\nimport { store } from '../../store';\nimport { isSimulationRunning } from '../../store/getters';\nimport { cooldownService } from '../../services/CooldownService';\nimport LogPanel from './LogPanel.vue';\nimport RipplesPanel from './RipplesPanel.vue';\nimport AvatarSelection from './reincarnation/AvatarSelection.vue';\nimport SettlementView from './reincarnation/SettlementView.vue';\nimport WorldSelection from './reincarnation/WorldSelection.vue';\nimport SettlementPanel from './SettlementPanel.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ReincarnationPanel',\n    setup(__props) {\n        const activeTab = ref('worldSelection');\n        const canSelectAvatar = computed(() => Object.keys(store.reincarnationAvatarOptions || {}).length > 0);\n        const hasSettlementData = computed(() => store.worldState?.?.?. === true);\n        // \n        watch(hasSettlementData, newValue => {\n            if (newValue) {\n                activeTab.value = 'settlementView';\n            }\n        }, { immediate: true });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass({ active: activeTab.value === 'worldSelection' }),\n                        onClick: _cache[0] || (_cache[0] = ($event) => (activeTab.value = 'worldSelection'))\n                    }, [\n                        _cache[6] || (_cache[6] = _createTextVNode(\"  \", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", {\n                            style: _normalizeStyle({\n                                color: _unref(cooldownService).isCoolingDown.value ? '#ffb74d' : _unref(isSimulationRunning) ? '#e57373' : '#81c784',\n                            })\n                        }, _toDisplayString(_unref(cooldownService).isCoolingDown.value\n                            ? `: ${_unref(cooldownService).remainingTime.value}`\n                            : _unref(isSimulationRunning)\n                                ? ''\n                                : ''), 5 /* TEXT, STYLE */)\n                    ], 2 /* CLASS */),\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass({ active: activeTab.value === 'avatarSelection' }),\n                        onClick: _cache[1] || (_cache[1] = ($event) => (activeTab.value = 'avatarSelection')),\n                        disabled: !canSelectAvatar.value\n                    }, \"  \", 10 /* CLASS, PROPS */, _hoisted_3),\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass({ active: activeTab.value === 'settlementView' }),\n                        onClick: _cache[2] || (_cache[2] = ($event) => (activeTab.value = 'settlementView'))\n                    }, \"  \", 2 /* CLASS */),\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass({ active: activeTab.value === 'log' }),\n                        onClick: _cache[3] || (_cache[3] = ($event) => (activeTab.value = 'log'))\n                    }, \"\", 2 /* CLASS */),\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass({ active: activeTab.value === 'ripples' }),\n                        onClick: _cache[4] || (_cache[4] = ($event) => (activeTab.value = 'ripples'))\n                    }, \"\", 2 /* CLASS */),\n                    (hasSettlementData.value)\n                        ? (_openBlock(), _createElementBlock(\"button\", {\n                            key: 0,\n                            class: _normalizeClass({ active: activeTab.value === 'settlement' }),\n                            onClick: _cache[5] || (_cache[5] = ($event) => (activeTab.value = 'settlement'))\n                        }, \"  \", 2 /* CLASS */))\n                        : _createCommentVNode(\"v-if\", true)\n                ]),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    (activeTab.value === 'worldSelection')\n                        ? (_openBlock(), _createBlock(WorldSelection, { key: 0 }))\n                        : _createCommentVNode(\"v-if\", true),\n                    (activeTab.value === 'avatarSelection')\n                        ? (_openBlock(), _createBlock(AvatarSelection, { key: 1 }))\n                        : _createCommentVNode(\"v-if\", true),\n                    (activeTab.value === 'settlementView')\n                        ? (_openBlock(), _createBlock(SettlementView, { key: 2 }))\n                        : _createCommentVNode(\"v-if\", true),\n                    (activeTab.value === 'log')\n                        ? (_openBlock(), _createBlock(LogPanel, { key: 3 }))\n                        : _createCommentVNode(\"v-if\", true),\n                    (activeTab.value === 'ripples')\n                        ? (_openBlock(), _createBlock(RipplesPanel, { key: 4 }))\n                        : _createCommentVNode(\"v-if\", true),\n                    (activeTab.value === 'settlement')\n                        ? (_openBlock(), _createBlock(SettlementPanel, { key: 5 }))\n                        : _createCommentVNode(\"v-if\", true)\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ReincarnationPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ReincarnationPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ReincarnationPanel.vue?vue&type=style&index=0&id=e142f334&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-e142f334\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode } from \"vue\";\nconst _hoisted_1 = { class: \"ripple-detail-panel\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"ripple-content\"\n};\nconst _hoisted_3 = { class: \"detail-key\" };\nconst _hoisted_4 = { class: \"detail-value\" };\nconst _hoisted_5 = {\n    key: 1,\n    class: \"loading-message\"\n};\nimport { ref, onMounted, toRefs } from 'vue';\nimport { ripplesService } from '../../services/RipplesService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'RippleDetailPanel',\n    props: {\n        rippleId: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const { rippleId } = toRefs(props);\n        const ripple = ref(undefined);\n        onMounted(() => {\n            ripple.value = ripplesService.getRippleById(rippleId.value);\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (ripple.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(ripple.value, (value, key) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: key,\n                                class: \"detail-item\"\n                            }, [\n                                _createElementVNode(\"strong\", _hoisted_3, _toDisplayString(key) + \":\", 1 /* TEXT */),\n                                _createElementVNode(\"span\", _hoisted_4, _toDisplayString(value), 1 /* TEXT */)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_5, \"...\"))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./RippleDetailPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./RippleDetailPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./RippleDetailPanel.vue?vue&type=style&index=0&id=4e32e506&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-4e32e506\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, vModelCheckbox as _vModelCheckbox, withDirectives as _withDirectives, vModelText as _vModelText, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"panel-wrapper memory-panel-container\" };\nconst _hoisted_2 = { class: \"panel-content\" };\nconst _hoisted_3 = { class: \"section\" };\nconst _hoisted_4 = { class: \"setting-item\" };\nconst _hoisted_5 = { class: \"section\" };\nconst _hoisted_6 = { class: \"setting-item\" };\nconst _hoisted_7 = { class: \"setting-item\" };\nconst _hoisted_8 = { class: \"setting-item\" };\nconst _hoisted_9 = { class: \"section\" };\nconst _hoisted_10 = { class: \"tabs\" };\nconst _hoisted_11 = { class: \"memory-content\" };\nconst _hoisted_12 = [\"value\"];\nimport * as toastr from 'toastr';\nimport { computed, onMounted, ref } from 'vue';\nimport { lorebookService } from '../../services/LorebookService';\nimport { memoryService } from '../../services/MemoryService';\nimport { store } from '../../store';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'MemoryPanel',\n    setup(__props) {\n        const isAutoMemoryEnabled = ref(true); // Default to enabled\n        const config = ref({\n            instantMemoryCount: 3,\n            shortTermMemoryCount: 25,\n            longTermMemoryCount: 200,\n        });\n        const activeTab = ref('instant');\n        const memoryContent = ref({\n            instant: '...',\n            short: '...',\n            long: '...',\n        });\n        const activeMemoryContent = computed(() => {\n            return memoryContent.value[activeTab.value];\n        });\n        async function fetchMemoryContent(forceRefresh = false) {\n            try {\n                const [instant, short, long] = await Promise.all([\n                    lorebookService.readFromLorebook('[]', forceRefresh),\n                    lorebookService.readFromLorebook('[]', forceRefresh),\n                    lorebookService.readFromLorebook('[]', forceRefresh),\n                ]);\n                memoryContent.value.instant = instant || '';\n                memoryContent.value.short = short || '';\n                memoryContent.value.long = long || '';\n            }\n            catch (error) {\n                console.error('[MemoryPanel] Failed to fetch memory content:', error);\n                toastr.error('');\n            }\n        }\n        function updateConfig() {\n            memoryService.setConfig(config.value);\n            toastr.success('');\n        }\n        async function forceUpdate() {\n            toastr.info('...');\n            console.log('[MemoryPanel] Forcing update with worldLog:', JSON.stringify(store.worldLog, null, 2));\n            await memoryService.updateMemory(store.worldLog);\n            await fetchMemoryContent(true); // Force refresh after manual update\n            toastr.success('');\n        }\n        onMounted(() => {\n            config.value = memoryService.getConfig();\n            fetchMemoryContent();\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[14] || (_cache[14] = _createElementVNode(\"h3\", { class: \"panel-title\" }, \"\", -1 /* CACHED */)),\n                    _createCommentVNode(\" Automation Control \"),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _createElementVNode(\"div\", _hoisted_4, [\n                            _cache[7] || (_cache[7] = _createElementVNode(\"label\", { for: \"auto-memory-switch\" }, \"\", -1 /* CACHED */)),\n                            _withDirectives(_createElementVNode(\"input\", {\n                                type: \"checkbox\",\n                                id: \"auto-memory-switch\",\n                                \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((isAutoMemoryEnabled).value = $event))\n                            }, null, 512 /* NEED_PATCH */), [\n                                [_vModelCheckbox, isAutoMemoryEnabled.value]\n                            ])\n                        ]),\n                        _cache[8] || (_cache[8] = _createElementVNode(\"p\", { class: \"description\" }, \"AI\", -1 /* CACHED */))\n                    ]),\n                    _createCommentVNode(\" Configuration \"),\n                    _createElementVNode(\"div\", _hoisted_5, [\n                        _cache[12] || (_cache[12] = _createElementVNode(\"h4\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"div\", _hoisted_6, [\n                            _cache[9] || (_cache[9] = _createElementVNode(\"label\", { for: \"instant-memory-count\" }, \"\", -1 /* CACHED */)),\n                            _withDirectives(_createElementVNode(\"input\", {\n                                type: \"number\",\n                                id: \"instant-memory-count\",\n                                \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event) => ((config.value.instantMemoryCount) = $event))\n                            }, null, 512 /* NEED_PATCH */), [\n                                [\n                                    _vModelText,\n                                    config.value.instantMemoryCount,\n                                    void 0,\n                                    { number: true }\n                                ]\n                            ])\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_7, [\n                            _cache[10] || (_cache[10] = _createElementVNode(\"label\", { for: \"short-term-count\" }, \"\", -1 /* CACHED */)),\n                            _withDirectives(_createElementVNode(\"input\", {\n                                type: \"number\",\n                                id: \"short-term-count\",\n                                \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event) => ((config.value.shortTermMemoryCount) = $event))\n                            }, null, 512 /* NEED_PATCH */), [\n                                [\n                                    _vModelText,\n                                    config.value.shortTermMemoryCount,\n                                    void 0,\n                                    { number: true }\n                                ]\n                            ])\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_8, [\n                            _cache[11] || (_cache[11] = _createElementVNode(\"label\", { for: \"long-term-count\" }, \"\", -1 /* CACHED */)),\n                            _withDirectives(_createElementVNode(\"input\", {\n                                type: \"number\",\n                                id: \"long-term-count\",\n                                \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event) => ((config.value.longTermMemoryCount) = $event))\n                            }, null, 512 /* NEED_PATCH */), [\n                                [\n                                    _vModelText,\n                                    config.value.longTermMemoryCount,\n                                    void 0,\n                                    { number: true }\n                                ]\n                            ])\n                        ]),\n                        _createElementVNode(\"button\", { onClick: updateConfig }, \"\"),\n                        _createElementVNode(\"button\", { onClick: forceUpdate }, \"\")\n                    ]),\n                    _createCommentVNode(\" Memory Review \"),\n                    _createElementVNode(\"div\", _hoisted_9, [\n                        _cache[13] || (_cache[13] = _createElementVNode(\"h4\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"div\", _hoisted_10, [\n                            _createElementVNode(\"button\", {\n                                class: _normalizeClass({ active: activeTab.value === 'instant' }),\n                                onClick: _cache[4] || (_cache[4] = ($event) => (activeTab.value = 'instant'))\n                            }, \"\", 2 /* CLASS */),\n                            _createElementVNode(\"button\", {\n                                class: _normalizeClass({ active: activeTab.value === 'short' }),\n                                onClick: _cache[5] || (_cache[5] = ($event) => (activeTab.value = 'short'))\n                            }, \"\", 2 /* CLASS */),\n                            _createElementVNode(\"button\", {\n                                class: _normalizeClass({ active: activeTab.value === 'long' }),\n                                onClick: _cache[6] || (_cache[6] = ($event) => (activeTab.value = 'long'))\n                            }, \"\", 2 /* CLASS */)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_11, [\n                            _createElementVNode(\"textarea\", {\n                                readonly: \"\",\n                                value: activeMemoryContent.value\n                            }, null, 8 /* PROPS */, _hoisted_12)\n                        ])\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./MemoryPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MemoryPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MemoryPanel.vue?vue&type=style&index=0&id=5351f233&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-5351f233\"]])\n\nexport default __exports__","import { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, vModelCheckbox as _vModelCheckbox, withDirectives as _withDirectives, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = { class: \"save-load-panel\" };\nconst _hoisted_2 = { class: \"panel-header\" };\nconst _hoisted_3 = { class: \"header-actions\" };\nconst _hoisted_4 = { class: \"save-slots-container\" };\nconst _hoisted_5 = { class: \"slot-group\" };\nconst _hoisted_6 = { class: \"slot-info\" };\nconst _hoisted_7 = { class: \"slot-name\" };\nconst _hoisted_8 = { class: \"slot-timestamp\" };\nconst _hoisted_9 = {\n    key: 0,\n    class: \"slot-world-log\"\n};\nconst _hoisted_10 = { class: \"log-date\" };\nconst _hoisted_11 = { class: \"log-title\" };\nconst _hoisted_12 = { class: \"slot-actions\" };\nconst _hoisted_13 = [\"onClick\"];\nconst _hoisted_14 = [\"onClick\", \"disabled\"];\nconst _hoisted_15 = [\"onClick\", \"disabled\"];\nconst _hoisted_16 = { class: \"slot-group\" };\nconst _hoisted_17 = { class: \"slot-info\" };\nconst _hoisted_18 = { class: \"slot-name\" };\nconst _hoisted_19 = { class: \"slot-timestamp\" };\nconst _hoisted_20 = {\n    key: 0,\n    class: \"slot-world-log\"\n};\nconst _hoisted_21 = { class: \"log-date\" };\nconst _hoisted_22 = { class: \"log-title\" };\nconst _hoisted_23 = { class: \"slot-actions\" };\nconst _hoisted_24 = [\"onClick\", \"disabled\"];\nconst _hoisted_25 = { class: \"auto-save-toggle\" };\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n    return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n        _createElementVNode(\"div\", _hoisted_2, [\n            _cache[5] || (_cache[5] = _createElementVNode(\"h2\", { class: \"panel-title\" }, \"\", -1 /* CACHED */)),\n            _createElementVNode(\"div\", _hoisted_3, [\n                _createElementVNode(\"button\", {\n                    onClick: _cache[0] || (_cache[0] =\n                        //@ts-ignore\n                        (...args) => (_ctx.importSave && _ctx.importSave(...args))),\n                    class: \"header-btn\"\n                }, \"\"),\n                _createElementVNode(\"button\", {\n                    onClick: _cache[1] || (_cache[1] =\n                        //@ts-ignore\n                        (...args) => (_ctx.exportSave && _ctx.exportSave(...args))),\n                    class: \"header-btn\"\n                }, \"\")\n            ])\n        ]),\n        _createElementVNode(\"div\", _hoisted_4, [\n            _createElementVNode(\"div\", _hoisted_5, [\n                _cache[6] || (_cache[6] = _createElementVNode(\"h3\", { class: \"group-title\" }, \"\", -1 /* CACHED */)),\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.manualSlots, (slot) => {\n                    return (_openBlock(), _createElementBlock(\"div\", {\n                        key: slot.id,\n                        class: \"save-slot\"\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_6, [\n                            _createElementVNode(\"span\", _hoisted_7, _toDisplayString(slot.name), 1 /* TEXT */),\n                            _createElementVNode(\"span\", _hoisted_8, _toDisplayString(slot.timestamp ? _ctx.formatTimestamp(slot.timestamp) : ''), 1 /* TEXT */),\n                            (slot.worldLogDate || slot.worldLogTitle)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [\n                                    _createElementVNode(\"span\", _hoisted_10, _toDisplayString(slot.worldLogDate), 1 /* TEXT */),\n                                    _createElementVNode(\"span\", _hoisted_11, _toDisplayString(slot.worldLogTitle), 1 /* TEXT */)\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_12, [\n                            _createElementVNode(\"button\", {\n                                onClick: ($event) => (_ctx.saveGame(slot.id)),\n                                class: \"action-btn save-btn\"\n                            }, \"\", 8 /* PROPS */, _hoisted_13),\n                            _createElementVNode(\"button\", {\n                                onClick: ($event) => (_ctx.loadGame(slot)),\n                                disabled: !slot.data,\n                                class: \"action-btn load-btn\"\n                            }, \"\", 8 /* PROPS */, _hoisted_14),\n                            _createElementVNode(\"button\", {\n                                onClick: ($event) => (_ctx.deleteSave(slot)),\n                                disabled: !slot.data,\n                                class: \"action-btn delete-btn\"\n                            }, \"\", 8 /* PROPS */, _hoisted_15)\n                        ])\n                    ]));\n                }), 128 /* KEYED_FRAGMENT */))\n            ]),\n            _createElementVNode(\"div\", _hoisted_16, [\n                _cache[8] || (_cache[8] = _createElementVNode(\"h3\", { class: \"group-title\" }, \"\", -1 /* CACHED */)),\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.autoSlots, (slot) => {\n                    return (_openBlock(), _createElementBlock(\"div\", {\n                        key: slot.id,\n                        class: \"save-slot auto-slot\"\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_17, [\n                            _createElementVNode(\"span\", _hoisted_18, _toDisplayString(slot.name), 1 /* TEXT */),\n                            _createElementVNode(\"span\", _hoisted_19, _toDisplayString(slot.timestamp ? _ctx.formatTimestamp(slot.timestamp) : ''), 1 /* TEXT */),\n                            (slot.worldLogDate || slot.worldLogTitle)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_20, [\n                                    _createElementVNode(\"span\", _hoisted_21, _toDisplayString(slot.worldLogDate), 1 /* TEXT */),\n                                    _createElementVNode(\"span\", _hoisted_22, _toDisplayString(slot.worldLogTitle), 1 /* TEXT */)\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_23, [\n                            _createElementVNode(\"button\", {\n                                onClick: ($event) => (_ctx.loadGame(slot)),\n                                disabled: !slot.data,\n                                class: \"action-btn load-btn\"\n                            }, \"\", 8 /* PROPS */, _hoisted_24)\n                        ])\n                    ]));\n                }), 128 /* KEYED_FRAGMENT */)),\n                _createElementVNode(\"div\", _hoisted_25, [\n                    _createElementVNode(\"label\", null, [\n                        _withDirectives(_createElementVNode(\"input\", {\n                            type: \"checkbox\",\n                            \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event) => ((_ctx.isAutoSaveEnabled) = $event)),\n                            onChange: _cache[3] || (_cache[3] =\n                                //@ts-ignore\n                                (...args) => (_ctx.toggleAutoSave && _ctx.toggleAutoSave(...args)))\n                        }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                            [_vModelCheckbox, _ctx.isAutoSaveEnabled]\n                        ]),\n                        _cache[7] || (_cache[7] = _createTextVNode(\"  \", -1 /* CACHED */))\n                    ])\n                ])\n            ])\n        ]),\n        _createElementVNode(\"input\", {\n            type: \"file\",\n            ref: \"fileInput\",\n            onChange: _cache[4] || (_cache[4] =\n                //@ts-ignore\n                (...args) => (_ctx.handleFileImport && _ctx.handleFileImport(...args))),\n            style: { \"display\": \"none\" },\n            accept: \".json\"\n        }, null, 544 /* NEED_HYDRATION, NEED_PATCH */)\n    ]));\n}\n","import * as toastr from 'toastr';\nimport { lorebookService } from './LorebookService';\nimport { store } from '../store';\n\nconst LOREBOOK_NAME = '-';\nconst SAVE_SLOT_PREFIX = '-';\nconst MAX_MANUAL_SAVES = 5;\nconst AUTO_SAVE_SLOTS = ['-A', '-B'];\nconst LOREBOOK_KEYS_TO_BACKUP: string[] = [\n  '',\n  '',\n  '',\n  '',\n  '[]',\n  '[]',\n  '[]',\n  '',\n  '',\n];\n\nexport interface SaveSlot {\n  id: string;\n  name: string;\n  timestamp: string | null;\n  data: any | null;\n  entryUid?: number;\n  worldLogDate?: string | null;\n  worldLogTitle?: string | null;\n}\n\nclass SaveLoadService {\n  public manualSlots: SaveSlot[] = [];\n  public autoSlots: SaveSlot[] = [];\n  public turnCounter: number = 0;\n  public isAutoSaveEnabled: boolean = true;\n  private autoSaveInterval: any;\n\n  constructor() {\n    this.initializeSlots();\n    this.loadAutoSaveState();\n    this.loadTurnCounter();\n  }\n\n  private initializeSlots() {\n    for (let i = 1; i <= MAX_MANUAL_SAVES; i++) {\n      this.manualSlots.push({ id: `-${i}`, name: ` ${i}`, timestamp: null, data: null });\n    }\n    for (const id of AUTO_SAVE_SLOTS) {\n      this.autoSlots.push({ id, name: ` ${id.split('-')[1]}`, timestamp: null, data: null });\n    }\n  }\n\n  async loadAllSaveSlots() {\n    try {\n      const allEntries = await TavernHelper.getLorebookEntries(LOREBOOK_NAME);\n      if (!allEntries) return;\n\n      const updateSlot = (slot: SaveSlot) => {\n        const entry = allEntries.find((e: any) => e.comment === `${SAVE_SLOT_PREFIX}${slot.id}`);\n        if (entry && entry.content) {\n          try {\n            slot.data = JSON.parse(entry.content);\n            slot.timestamp = slot.data.timestamp;\n            slot.worldLogDate = slot.data.worldLogDate;\n            slot.worldLogTitle = slot.data.worldLogTitle;\n            slot.entryUid = entry.uid;\n          } catch (e) {\n            console.error(` ${slot.id} :`, e);\n            slot.timestamp = '';\n            slot.data = null;\n          }\n        } else {\n          slot.timestamp = null;\n          slot.data = null;\n          slot.entryUid = undefined;\n        }\n      };\n\n      this.manualSlots.forEach(updateSlot);\n      this.autoSlots.forEach(updateSlot);\n    } catch (error) {\n      console.error(':', error);\n      toastr.error('');\n    }\n  }\n\n  async saveGame(slotId: string, isAutoSave = false) {\n    if (!isAutoSave) {\n      toastr.info(` [${slotId}]...`);\n    }\n\n    try {\n      const messages = await TavernHelper.getChatMessages('0');\n      if (!messages || messages.length === 0) {\n        throw new Error('');\n      }\n      const messageZero = messages[0];\n      const timestamp = new Date().toISOString();\n\n      const lorebookBackup: { [key: string]: string } = {};\n      for (const key of LOREBOOK_KEYS_TO_BACKUP) {\n        const content = await lorebookService.readFromLorebook(key);\n        lorebookBackup[key] = content ?? '';\n      }\n\n      const lastLogEntry = store.worldLog.length > 0 ? store.worldLog[store.worldLog.length - 1] : null;\n\n      const saveData = {\n        timestamp,\n        mvu_data: messageZero.data,\n        message_content: messageZero.message,\n        lorebook_backup: lorebookBackup,\n        worldLogDate: lastLogEntry?.,\n        worldLogTitle: lastLogEntry?.,\n      };\n\n      const comment = `${SAVE_SLOT_PREFIX}${slotId}`;\n      const allEntries = await TavernHelper.getLorebookEntries(LOREBOOK_NAME);\n      const existingEntry = allEntries.find((e: any) => e.comment === comment);\n\n      if (existingEntry) {\n        await TavernHelper.setLorebookEntries(LOREBOOK_NAME, [\n          { uid: existingEntry.uid, content: JSON.stringify(saveData, null, 2) },\n        ]);\n      } else {\n        await TavernHelper.createLorebookEntries(LOREBOOK_NAME, [\n          {\n            comment: comment,\n            content: JSON.stringify(saveData, null, 2),\n            keys: [comment],\n            position: 'after_character_definition',\n            order: 200,\n          },\n        ]);\n      }\n\n      await this.loadAllSaveSlots();\n      if (!isAutoSave) {\n        toastr.success(` [${slotId}]`);\n      } else {\n        console.log(`[AutoSave]  ${slotId}`);\n      }\n    } catch (error) {\n      const errorMessage = `: ${error instanceof Error ? error.message : String(error)}`;\n      console.error(` ${slotId} :`, error);\n      if (!isAutoSave) {\n        toastr.error(errorMessage);\n      }\n    }\n  }\n\n  async loadGame(slot: SaveSlot) {\n    if (!slot.data || !slot.data.mvu_data) {\n      toastr.error('');\n      return;\n    }\n    if (!confirm(` [${slot.name}] `)) {\n      return;\n    }\n    toastr.info(` [${slot.name}] ...`);\n    try {\n      if (slot.data.lorebook_backup) {\n        for (const key in slot.data.lorebook_backup) {\n          await lorebookService.writeToLorebook(key, slot.data.lorebook_backup[key]);\n        }\n      }\n\n      const messages = await TavernHelper.getChatMessages('0');\n      const messageZero = messages[0] || {};\n      messageZero.data = slot.data.mvu_data;\n      messageZero.message = slot.data.message_content;\n\n      await TavernHelper.setChatMessages([messageZero], { refresh: 'all' });\n\n      toastr.success(` [${slot.name}] ...`);\n    } catch (error) {\n      const errorMessage = `: ${error instanceof Error ? error.message : String(error)}`;\n      console.error(` ${slot.name} :`, error);\n      toastr.error(errorMessage);\n    }\n  }\n\n  async deleteSave(slot: SaveSlot) {\n    if (!slot.entryUid) {\n      toastr.warning('');\n      return;\n    }\n    if (!confirm(` [${slot.name}] \\n`)) {\n      return;\n    }\n    toastr.info(` [${slot.name}]...`);\n    try {\n      await TavernHelper.deleteLorebookEntries(LOREBOOK_NAME, [slot.entryUid]);\n      await this.loadAllSaveSlots();\n      toastr.success(` [${slot.name}] `);\n    } catch (error) {\n      console.error(` ${slot.name} :`, error);\n      toastr.error(`: ${error instanceof Error ? error.message : String(error)}`);\n    }\n  }\n\n  async performAutoSave() {\n    if (!this.isAutoSaveEnabled) return;\n\n    this.turnCounter++;\n    localStorage.setItem('tianhua_turn_counter', this.turnCounter.toString());\n    const slotId = this.turnCounter % 2 === 1 ? AUTO_SAVE_SLOTS[0] : AUTO_SAVE_SLOTS[1];\n    await this.saveGame(slotId, true);\n  }\n\n  exportSave(slot: SaveSlot) {\n    if (!slot.data) {\n      toastr.warning('');\n      return;\n    }\n    const dataStr = JSON.stringify(slot.data, null, 2);\n    const dataBlob = new Blob([dataStr], { type: 'application/json' });\n    const url = URL.createObjectURL(dataBlob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = `[]-${slot.name}-${new Date().toISOString()}.json`;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    URL.revokeObjectURL(url);\n    toastr.success(` [${slot.name}] `);\n  }\n\n  async importSave(jsonContent: string) {\n    try {\n      const saveData = JSON.parse(jsonContent);\n      if (!saveData.timestamp || !saveData.mvu_data) {\n        throw new Error('');\n      }\n\n      const emptySlot = this.manualSlots.find(slot => !slot.data);\n      if (!emptySlot) {\n        toastr.error('');\n        return;\n      }\n\n      toastr.info(` [${emptySlot.name}]...`);\n\n      const comment = `${SAVE_SLOT_PREFIX}${emptySlot.id}`;\n      const allEntries = await TavernHelper.getLorebookEntries(LOREBOOK_NAME);\n      const existingEntry = allEntries.find((e: any) => e.comment === comment);\n\n      if (existingEntry) {\n        await TavernHelper.setLorebookEntries(LOREBOOK_NAME, [\n          { uid: existingEntry.uid, content: JSON.stringify(saveData, null, 2) },\n        ]);\n      } else {\n        await TavernHelper.createLorebookEntries(LOREBOOK_NAME, [\n          {\n            comment: comment,\n            content: JSON.stringify(saveData, null, 2),\n            keys: [comment],\n            position: 'after_character_definition',\n            order: 200,\n            enabled: false, // \n          },\n        ]);\n      }\n\n      await this.loadAllSaveSlots();\n      toastr.success(` [${emptySlot.name}]`);\n    } catch (error) {\n      const errorMessage = `: ${error instanceof Error ? error.message : String(error)}`;\n      console.error(':', error);\n      toastr.error(errorMessage);\n    }\n  }\n\n  toggleAutoSave(enabled: boolean) {\n    this.isAutoSaveEnabled = enabled;\n    localStorage.setItem('tianhua_auto_save_enabled', JSON.stringify(enabled));\n    toastr.info(`${enabled ? '' : ''}`);\n  }\n\n  private loadAutoSaveState() {\n    const savedState = localStorage.getItem('tianhua_auto_save_enabled');\n    if (savedState !== null) {\n      this.isAutoSaveEnabled = JSON.parse(savedState);\n    }\n  }\n\n  private loadTurnCounter() {\n    const savedCounter = localStorage.getItem('tianhua_turn_counter');\n    if (savedCounter !== null) {\n      this.turnCounter = parseInt(savedCounter, 10) || 0;\n    }\n  }\n}\n\nexport const saveLoadService = new SaveLoadService();\n","import { defineComponent, ref, onMounted } from 'vue';\nimport { saveLoadService } from '../../services/saveLoadService';\nimport * as toastr from 'toastr';\nexport default defineComponent({\n    name: 'SaveLoadPanel',\n    setup() {\n        const manualSlots = ref([]);\n        const autoSlots = ref([]);\n        const isAutoSaveEnabled = ref(true);\n        const fileInput = ref(null);\n        const loadSlots = async () => {\n            await saveLoadService.loadAllSaveSlots();\n            manualSlots.value = [...saveLoadService.manualSlots];\n            autoSlots.value = [...saveLoadService.autoSlots];\n        };\n        onMounted(() => {\n            loadSlots();\n            isAutoSaveEnabled.value = saveLoadService.isAutoSaveEnabled;\n        });\n        const formatTimestamp = (timestamp) => {\n            return new Date(timestamp).toLocaleString('zh-CN', { hour12: false });\n        };\n        const saveGame = async (slotId) => {\n            await saveLoadService.saveGame(slotId);\n            await loadSlots();\n        };\n        const loadGame = async (slot) => {\n            await saveLoadService.loadGame(slot);\n        };\n        const deleteSave = async (slot) => {\n            await saveLoadService.deleteSave(slot);\n            await loadSlots();\n        };\n        const toggleAutoSave = () => {\n            saveLoadService.toggleAutoSave(isAutoSaveEnabled.value);\n        };\n        const importSave = () => {\n            fileInput.value?.click();\n        };\n        const handleFileImport = (event) => {\n            const target = event.target;\n            if (target.files && target.files[0]) {\n                const file = target.files[0];\n                const reader = new FileReader();\n                reader.onload = async (e) => {\n                    try {\n                        const content = e.target?.result;\n                        await saveLoadService.importSave(content);\n                        await loadSlots();\n                    }\n                    catch (error) {\n                        toastr.error('');\n                        console.error(error);\n                    }\n                };\n                reader.readAsText(file);\n                target.value = ''; // Reset input\n            }\n        };\n        const exportSave = async () => {\n            // For simplicity, we'll export the first manual save slot with data\n            const slotToExport = manualSlots.value.find(slot => slot.data);\n            if (!slotToExport) {\n                toastr.warning('');\n                return;\n            }\n            saveLoadService.exportSave(slotToExport);\n        };\n        return {\n            manualSlots,\n            autoSlots,\n            isAutoSaveEnabled,\n            fileInput,\n            formatTimestamp,\n            saveGame,\n            loadGame,\n            deleteSave,\n            toggleAutoSave,\n            importSave,\n            handleFileImport,\n            exportSave,\n        };\n    },\n});\n","/* unplugin-vue-components disabled */import { render } from \"./SaveLoadPanel.vue?vue&type=template&id=54f145be&scoped=true&ts=true\"\nimport script from \"./SaveLoadPanel.vue?vue&type=script&lang=ts\"\nexport * from \"./SaveLoadPanel.vue?vue&type=script&lang=ts\"\n\nimport \"./SaveLoadPanel.vue?vue&type=style&index=0&id=54f145be&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-54f145be\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { normalizeClass as _normalizeClass, createElementVNode as _createElementVNode, vShow as _vShow, createVNode as _createVNode, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"system-panel\" };\nconst _hoisted_2 = { class: \"panel-tabs\" };\nconst _hoisted_3 = { class: \"panel-content\" };\nimport { ref } from 'vue';\nimport MemoryPanel from './MemoryPanel.vue';\nimport SaveLoadPanel from './SaveLoadPanel.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'SystemPanel',\n    setup(__props) {\n        const activeTab = ref('saveLoad');\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass({ active: activeTab.value === 'saveLoad' }),\n                        onClick: _cache[0] || (_cache[0] = ($event) => (activeTab.value = 'saveLoad'))\n                    }, \"\", 2 /* CLASS */),\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass({ active: activeTab.value === 'memory' }),\n                        onClick: _cache[1] || (_cache[1] = ($event) => (activeTab.value = 'memory'))\n                    }, \"\", 2 /* CLASS */)\n                ]),\n                _createElementVNode(\"div\", _hoisted_3, [\n                    _withDirectives(_createVNode(SaveLoadPanel, null, null, 512 /* NEED_PATCH */), [\n                        [_vShow, activeTab.value === 'saveLoad']\n                    ]),\n                    _withDirectives(_createVNode(MemoryPanel, null, null, 512 /* NEED_PATCH */), [\n                        [_vShow, activeTab.value === 'memory']\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./SystemPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SystemPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./SystemPanel.vue?vue&type=style&index=0&id=238307c0&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-238307c0\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment, resolveDirective as _resolveDirective, withDirectives as _withDirectives } from \"vue\";\nconst _hoisted_1 = {\n    key: 0,\n    class: \"panel-wrapper world-detail-panel-content\"\n};\nconst _hoisted_2 = { class: \"scroll-container\" };\nconst _hoisted_3 = { class: \"world-section\" };\nconst _hoisted_4 = { class: \"rules-grid\" };\nconst _hoisted_5 = { class: \"rule-item\" };\nconst _hoisted_6 = { class: \"rule-value\" };\nconst _hoisted_7 = { class: \"rule-item\" };\nconst _hoisted_8 = { class: \"rule-value\" };\nconst _hoisted_9 = { class: \"world-section epoch-selection\" };\nconst _hoisted_10 = { class: \"tabs-container main-tabs\" };\nconst _hoisted_11 = [\"innerHTML\"];\nconst _hoisted_12 = { class: \"world-section\" };\nconst _hoisted_13 = { class: \"epoch-header\" };\nconst _hoisted_14 = { class: \"section-title\" };\nconst _hoisted_15 = { class: \"epoch-overview\" };\nconst _hoisted_16 = { class: \"rules-grid\" };\nconst _hoisted_17 = { class: \"rule-item\" };\nconst _hoisted_18 = { class: \"rule-value\" };\nconst _hoisted_19 = { class: \"rule-item\" };\nconst _hoisted_20 = { class: \"rule-value\" };\nconst _hoisted_21 = { class: \"rule-item\" };\nconst _hoisted_22 = { class: \"rule-value\" };\nconst _hoisted_23 = { class: \"rule-item\" };\nconst _hoisted_24 = { class: \"rule-value\" };\nconst _hoisted_25 = { class: \"world-section\" };\nconst _hoisted_26 = { class: \"system-overview\" };\nconst _hoisted_27 = { class: \"subsection\" };\nconst _hoisted_28 = { class: \"tags-container\" };\nconst _hoisted_29 = { class: \"subsection\" };\nconst _hoisted_30 = { class: \"ladder-container\" };\nconst _hoisted_31 = { class: \"-ladder\" };\nconst _hoisted_32 = { class: \"level-energy\" };\nconst _hoisted_33 = { class: \"level-name\" };\nconst _hoisted_34 = {\n    key: 1,\n    class: \"panel-wrapper loading-state\"\n};\nimport { computed, onMounted, ref, watch } from 'vue';\nimport { lorebookService } from '../../services/LorebookService';\nimport { avatarWorld, mainWorld } from '../../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'WorldDetailsPanel',\n    props: {\n        worldType: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const activeTab = ref('details');\n        const worldSummary = ref('...');\n        const world = computed(() => {\n            return props.worldType === 'mainWorld' ? mainWorld.value : avatarWorld.value;\n        });\n        const availableEpochs = computed(() => {\n            if (!world.value || !world.value.)\n                return [];\n            return Object.values(world.value.).filter(epoch => typeof epoch === 'object' && epoch.ID);\n        });\n        const selectedEpochId = ref(null);\n        onMounted(async () => {\n            const entry = await lorebookService.findEntryByComment('');\n            worldSummary.value = entry ? entry.content : '';\n        });\n        watch(world, newWorld => {\n            if (newWorld) {\n                selectedEpochId.value = newWorld..ID || availableEpochs.value[0]?.ID || null;\n            }\n        }, { immediate: true });\n        const activeEpoch = computed(() => {\n            if (!world.value || !selectedEpochId.value)\n                return null;\n            return world.value.[selectedEpochId.value] || null;\n        });\n        const Array = computed(() => {\n            if (!activeEpoch.value?.?.)\n                return [];\n            const definitions = activeEpoch.value..;\n            return Object.keys(definitions)\n                .filter(key => key !== '$meta')\n                .map(key => definitions[key])\n                .sort((a, b) => a. - b.);\n        });\n        return (_ctx, _cache) => {\n            const _directive_tooltip = _resolveDirective(\"tooltip\");\n            return (world.value && activeEpoch.value)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                    _createElementVNode(\"div\", _hoisted_2, [\n                        _createCommentVNode(\"  \"),\n                        _createElementVNode(\"section\", _hoisted_3, [\n                            _cache[4] || (_cache[4] = _createElementVNode(\"h3\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"div\", _hoisted_4, [\n                                _createElementVNode(\"div\", _hoisted_5, [\n                                    _cache[2] || (_cache[2] = _createElementVNode(\"div\", { class: \"rule-name\" }, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"div\", _hoisted_6, _toDisplayString(world.value..), 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_7, [\n                                    _cache[3] || (_cache[3] = _createElementVNode(\"div\", { class: \"rule-name\" }, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"div\", _hoisted_8, _toDisplayString(world.value..), 1 /* TEXT */)\n                                ])\n                            ])\n                        ]),\n                        _createCommentVNode(\"  \"),\n                        _createElementVNode(\"section\", _hoisted_9, [\n                            _cache[5] || (_cache[5] = _createElementVNode(\"h3\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"div\", _hoisted_10, [\n                                _createElementVNode(\"button\", {\n                                    class: _normalizeClass([\"epoch-tab\", { active: activeTab.value === 'details' }]),\n                                    onClick: _cache[0] || (_cache[0] = ($event) => (activeTab.value = 'details'))\n                                }, \"  \", 2 /* CLASS */),\n                                _createElementVNode(\"button\", {\n                                    class: _normalizeClass([\"epoch-tab\", { active: activeTab.value === 'summary' }]),\n                                    onClick: _cache[1] || (_cache[1] = ($event) => (activeTab.value = 'summary'))\n                                }, \"  \", 2 /* CLASS */)\n                            ])\n                        ]),\n                        (activeTab.value === 'summary')\n                            ? (_openBlock(), _createElementBlock(\"div\", {\n                                key: 0,\n                                class: \"summary-content\",\n                                innerHTML: worldSummary.value\n                            }, null, 8 /* PROPS */, _hoisted_11))\n                            : _createCommentVNode(\"v-if\", true),\n                        (activeTab.value === 'details' && activeEpoch.value)\n                            ? (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                                _createCommentVNode(\"  \"),\n                                _createElementVNode(\"section\", _hoisted_12, [\n                                    _createElementVNode(\"div\", _hoisted_13, [\n                                        _createElementVNode(\"h3\", _hoisted_14, \": \" + _toDisplayString(activeEpoch.value.), 1 /* TEXT */),\n                                        _createElementVNode(\"p\", _hoisted_15, _toDisplayString(activeEpoch.value.), 1 /* TEXT */)\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_16, [\n                                        _createElementVNode(\"div\", _hoisted_17, [\n                                            _cache[6] || (_cache[6] = _createElementVNode(\"div\", { class: \"rule-name\" }, \"\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_18, _toDisplayString(activeEpoch.value..), 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_19, [\n                                            _cache[7] || (_cache[7] = _createElementVNode(\"div\", { class: \"rule-name\" }, \"\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_20, _toDisplayString(activeEpoch.value..) + \"x\", 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_21, [\n                                            _cache[8] || (_cache[8] = _createElementVNode(\"div\", { class: \"rule-name\" }, \"\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_22, _toDisplayString(activeEpoch.value..) + \"%\", 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_23, [\n                                            _cache[9] || (_cache[9] = _createElementVNode(\"div\", { class: \"rule-name\" }, \"\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_24, _toDisplayString(activeEpoch.value...), 1 /* TEXT */)\n                                        ])\n                                    ])\n                                ]),\n                                _createCommentVNode(\"  \"),\n                                _createElementVNode(\"section\", _hoisted_25, [\n                                    _cache[12] || (_cache[12] = _createElementVNode(\"h3\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"p\", _hoisted_26, _toDisplayString(activeEpoch.value..), 1 /* TEXT */),\n                                    _createElementVNode(\"div\", _hoisted_27, [\n                                        _cache[10] || (_cache[10] = _createElementVNode(\"h4\", { class: \"subsection-title\" }, \"\", -1 /* CACHED */)),\n                                        _createElementVNode(\"div\", _hoisted_28, [\n                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(activeEpoch.value.., (school) => {\n                                                return (_openBlock(), _createElementBlock(\"span\", {\n                                                    key: school.,\n                                                    class: \"tag\"\n                                                }, _toDisplayString(school.), 1 /* TEXT */));\n                                            }), 128 /* KEYED_FRAGMENT */))\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_29, [\n                                        _cache[11] || (_cache[11] = _createElementVNode(\"h4\", { class: \"subsection-title\" }, \"\", -1 /* CACHED */)),\n                                        _createElementVNode(\"div\", _hoisted_30, [\n                                            _createElementVNode(\"ul\", _hoisted_31, [\n                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(Array.value, (level) => {\n                                                    return _withDirectives((_openBlock(), _createElementBlock(\"li\", {\n                                                        key: level.,\n                                                        class: \"ladder-step\"\n                                                    }, [\n                                                        _createElementVNode(\"span\", _hoisted_32, \" \" + _toDisplayString(level.), 1 /* TEXT */),\n                                                        _createElementVNode(\"span\", _hoisted_33, _toDisplayString(level.), 1 /* TEXT */)\n                                                    ])), [\n                                                        [_directive_tooltip, level.]\n                                                    ]);\n                                                }), 128 /* KEYED_FRAGMENT */))\n                                            ])\n                                        ])\n                                    ])\n                                ])\n                            ], 64 /* STABLE_FRAGMENT */))\n                            : _createCommentVNode(\"v-if\", true)\n                    ])\n                ]))\n                : (_openBlock(), _createElementBlock(\"div\", _hoisted_34, \"...\"));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./WorldDetailsPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./WorldDetailsPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./WorldDetailsPanel.vue?vue&type=style&index=0&id=966c12c6&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-966c12c6\"]])\n\nexport default __exports__","import * as d3 from 'd3';\n\n/**\n * @file ColorService.ts\n * @description \n */\nclass ColorService {\n  private colorCache: Map<string, string> = new Map();\n  private colorScale = d3.scaleOrdinal(d3.schemeCategory10);\n\n  /**\n   * \n   * @param str - \n   * @returns - \n   */\n  private simpleHash(str: string): number {\n    let hash = 0;\n    for (let i = 0; i < str.length; i++) {\n      const char = str.charCodeAt(i);\n      hash = (hash << 5) - hash + char;\n      hash |= 0; // Convert to 32bit integer\n    }\n    return Math.abs(hash);\n  }\n\n  /**\n   * \n   * @param type - \n   * @returns - \n   */\n  public getColor(type: string): string {\n    if (this.colorCache.has(type)) {\n      return this.colorCache.get(type)!;\n    }\n\n    // \n    // d3.schemeCategory10  10 \n    // \n    const hash = this.simpleHash(type);\n    const color = this.colorScale(String(hash % 10));\n\n    this.colorCache.set(type, color);\n    return color;\n  }\n}\n\nexport const colorService = new ColorService();\n","import * as d3 from 'd3';\nimport type { MapNode, RelativeCoordinate } from '../types';\n\n/**\n * @file CoordinateService.ts\n * @description V7.2 - 2D\n *\n * @:\n * 1.  \"['', 15]\"\n * 2. km, AU, \n * 3.  (x, y)\n */\nclass CoordinateService {\n  private baseAngleMap: Map<string, number>;\n\n  constructor() {\n    //  (Y, X)\n    // SVG/Canvas : X, Y\n    // 0(0) -> \n    // 90(PI/2) -> \n    // 180(PI) -> \n    // 270(-PI/2) -> \n    this.baseAngleMap = new Map([\n      ['', 0],\n      ['E', 0],\n      ['', Math.PI / 4],\n      ['SE', Math.PI / 4],\n      ['', Math.PI / 2],\n      ['S', Math.PI / 2],\n      ['', (Math.PI * 3) / 4],\n      ['SW', (Math.PI * 3) / 4],\n      ['', Math.PI],\n      ['W', Math.PI],\n      ['', (Math.PI * 5) / 4],\n      ['NW', (Math.PI * 5) / 4],\n      ['', (Math.PI * 3) / 2],\n      ['N', (Math.PI * 3) / 2],\n      ['', (Math.PI * 7) / 4],\n      ['NE', (Math.PI * 7) / 4],\n      ['', 0],\n      ['C', 0],\n      ['', -Math.PI / 2],\n      ['Up', -Math.PI / 2],\n      ['', Math.PI / 2],\n      ['Down', Math.PI / 2],\n    ]);\n  }\n\n  /**\n   * \n   * @param -  \"['', 15]\"  \"['', -10]\"\n   * @returns \n   */\n  private parseAzimuth(azimuthValue: string | (string | number)[]): number | null {\n    try {\n      let parts: (string | number)[] = [];\n\n      if (Array.isArray(azimuthValue)) {\n        parts = azimuthValue;\n      } else if (typeof azimuthValue === 'string') {\n        const content = azimuthValue.trim().slice(1, -1);\n        const matches = content.match(/'[^']*'|\"[^\"]*\"|[^,\\s]+/g);\n        if (matches) {\n          parts = matches.map(part => part.replace(/['\"]/g, ''));\n        }\n      }\n\n      if (parts.length === 0) {\n        console.warn(`[CoordinateService] :`, azimuthValue);\n        return null;\n      }\n\n      // \n      const baseDirection = String(parts[0])\n        .replace(/[[\\]'\"]/g, '')\n        .trim();\n      //  0\n      const offsetDegrees = parts.length > 1 ? Number(parts[1]) : 0;\n\n      if (isNaN(offsetDegrees)) {\n        console.warn(`[CoordinateService] :`, parts[1]);\n        // \n        const baseAngle = this.baseAngleMap.get(baseDirection);\n        return baseAngle !== undefined ? baseAngle : null;\n      }\n\n      const baseAngle = this.baseAngleMap.get(baseDirection);\n\n      if (baseAngle === undefined) {\n        console.warn(`[CoordinateService] : '${baseDirection}'`);\n        return null;\n      }\n\n      const offsetRadians = (offsetDegrees * Math.PI) / 180;\n      return baseAngle + offsetRadians;\n    } catch (error) {\n      console.error(`[CoordinateService] :`, { value: azimuthValue, error });\n      return null;\n    }\n  }\n\n  /**\n   * \n   * \n   * @param distance -  [100, \"km\"]\n   * @returns \n   */\n  private normalizeDistance(distance: [number | string, string]): number {\n    // \n    const value = Number(distance[0]);\n    const unit = distance[1];\n\n    if (isNaN(value)) {\n      return 0;\n    }\n\n    switch (unit.toLowerCase()) {\n      case 'km':\n        return value;\n      case 'au': // \n        return value * 149597870.7; // km\n      case '':\n        return value * 9460730472580.8; // km\n      default:\n        return value; // km\n    }\n  }\n\n  /**\n   * \n   * @param parentNode -  x, y \n   * @param relativeCoord - \n   * @param scaleFactor - \n   * @returns  { x, y }  null\n   */\n  public getCartesianCoordinates(\n    parentNode: MapNode,\n    relativeCoord: RelativeCoordinate,\n  ): { x: number; y: number } | null {\n    if (parentNode.x === undefined || parentNode.y === undefined || !relativeCoord) {\n      return null;\n    }\n\n    const azimuth = this.parseAzimuth(relativeCoord. as string | [string, number]);\n    if (azimuth === null) {\n      return null;\n    }\n\n    // \n    // \n    let baseDirection = '';\n    if (Array.isArray(relativeCoord.)) {\n      baseDirection = String(relativeCoord.[0]);\n    } else if (typeof relativeCoord. === 'string') {\n      const matches = relativeCoord..match(/'[^']*'|\"[^\"]*\"|[^,\\s]+/g);\n      if (matches && matches.length > 0) {\n        baseDirection = matches[0].replace(/['\"[\\]]/g, '').trim();\n      }\n    }\n\n    if (baseDirection === '' || baseDirection.toUpperCase() === 'C') {\n      return { x: parentNode.x, y: parentNode.y };\n    }\n\n    const theoreticalDistance = this.normalizeDistance(relativeCoord.);\n\n    const childX = parentNode.x + theoreticalDistance * Math.cos(azimuth);\n    const childY = parentNode.y + theoreticalDistance * Math.sin(azimuth);\n\n    return { x: childX, y: childY };\n  }\n  /**\n   * \n   * \n   * @param parent - \n   * @param children - \n   */\n  public calculateRelativePositions(parent: MapNode, children: MapNode[]): void {\n    if (!children || children.length === 0) {\n      return;\n    }\n\n    const allDistances = children\n      .map(child => (child.data. ? this.normalizeDistance(child.data..) : 0))\n      .filter(d => d > 0);\n\n    let distanceScale: d3.ScaleLinear<number, number>;\n    const visualMin = 150;\n    const visualMax = 400;\n\n    if (allDistances.length > 0) {\n      const min = Math.min(...allDistances);\n      const max = Math.max(...allDistances);\n      distanceScale = d3.scaleLinear().domain([min, max]).range([visualMin, visualMax]).clamp(true);\n    } else {\n      // \n      distanceScale = d3.scaleLinear().domain([0, 1]).range([visualMin, visualMin]);\n    }\n\n    children.forEach(child => {\n      const coord = child.data.;\n      if (!coord) {\n        child.x = parent.x;\n        child.y = parent.y;\n        return;\n      }\n\n      const isOverlapping = coord..includes('') && this.normalizeDistance(coord.) === 0;\n      const isVertical = coord..includes('') || coord..includes('');\n\n      if (isOverlapping || isVertical) {\n        child.x = parent.x;\n        child.y = parent.y;\n        if (isVertical) {\n          const azimuth = this.parseAzimuth(coord. as string | [string, number]);\n          if (azimuth !== null) {\n            const visualDistance = distanceScale(this.normalizeDistance(coord.));\n            child.y = (child.y ?? 0) + visualDistance * Math.sin(azimuth);\n          }\n        }\n        return;\n      }\n\n      const azimuth = this.parseAzimuth(coord. as string | [string, number]);\n      if (azimuth === null) {\n        child.x = parent.x;\n        child.y = parent.y;\n        return;\n      }\n\n      const theoreticalDistance = this.normalizeDistance(coord.);\n      const visualDistance = distanceScale(theoreticalDistance);\n\n      child.x = parent.x! + visualDistance * Math.cos(azimuth);\n      child.y = parent.y! + visualDistance * Math.sin(azimuth);\n    });\n  }\n}\n\nexport const coordinateService = new CoordinateService();\n","import type { SpatialEntity, WorldDefinition, Epoch } from '../../../types/world';\nimport type { MapHierarchy, MapNode } from '../types';\n\n/**\n * @file WorldMapDataService.ts\n * @description V8.0 - \n *\n * @:\n * 1.  ``  ``\n * 2.  ``  \"WORLD_ORIGIN\"  (`MapHierarchy`)\n * 3.  (`childCount`)\n * 4. UI\n */\nclass WorldMapDataService {\n  private hierarchyCache: MapHierarchy | null = null;\n\n  /**\n   * \n   * @param worldData -  lorebook \n   * @param epochId - ID\n   * @returns -  \"WORLD_ORIGIN\" \n   */\n  public getMapHierarchy(epoch: Epoch | null): MapHierarchy | null {\n    if (!epoch) return null;\n\n    const cacheKey = epoch.ID;\n    if (this.hierarchyCache && (this.hierarchyCache as any).cacheKey === cacheKey) {\n      return this.hierarchyCache;\n    }\n\n    const spatialEntities = epoch.?.;\n\n    if (!spatialEntities || Object.keys(spatialEntities).length === 0) {\n      console.warn(`WorldMapDataService:  \"${epoch.}\"  \"\" `);\n      return null;\n    }\n\n    const hierarchy = this.buildHierarchy(Object.values(spatialEntities));\n    (hierarchy as any).cacheKey = cacheKey; // Attach cache key\n    this.hierarchyCache = hierarchy;\n    return this.hierarchyCache;\n  }\n\n  /**\n   * \n   */\n  public clearCache(): void {\n    this.hierarchyCache = null;\n  }\n\n  /**\n   * \n   * @param entities - \n   * @returns - \n   */\n  private buildHierarchy(entities: SpatialEntity[]): MapHierarchy {\n    const nodeMap = new Map<string, MapNode>();\n    const rootNodes: MapNode[] = [];\n\n    // 1. \n    entities.forEach(entity => {\n      nodeMap.set(entity.ID, {\n        id: entity.ID,\n        name: entity.,\n        type: entity.,\n        parentId: entity.?.ID,\n        children: [],\n        childCount: 0, // \n        radius: 10,\n        data: entity,\n      });\n    });\n\n    // 2. \n    for (const node of nodeMap.values()) {\n      const parent = node.parentId ? nodeMap.get(node.parentId) : null;\n      if (parent) {\n        parent.children.push(node);\n      } else {\n        //  'WORLD_ORIGIN'\n        rootNodes.push(node);\n      }\n    }\n\n    // 3. \n    for (const node of nodeMap.values()) {\n      node.childCount = node.children.length;\n    }\n\n    // 4. \n    const worldOrigin: MapNode = {\n      id: 'WORLD_ORIGIN',\n      name: '',\n      type: 'Origin',\n      parentId: null,\n      children: rootNodes,\n      childCount: rootNodes.length,\n      radius: 0,\n      data: {} as any,\n    };\n\n    return worldOrigin;\n  }\n}\n\nexport const worldMapDataService = new WorldMapDataService();\n","import { reactive, readonly } from 'vue';\nimport type { WorldDefinition } from '../../../types/world';\nimport type { MapNode } from '../types';\n\ninterface NavigationCrumb {\n  id: string;\n  name: string;\n}\n\ninterface MapState {\n  currentRootId: string;\n  navigationPath: NavigationCrumb[];\n  selectedNode: MapNode | null;\n  isDetailPanelVisible: boolean;\n  worldData: WorldDefinition | null;\n  userLocationId: string | null;\n  avatarLocationId: string | null;\n}\n\nconst state = reactive<MapState>({\n  currentRootId: 'WORLD_ORIGIN',\n  navigationPath: [{ id: 'WORLD_ORIGIN', name: '' }],\n  selectedNode: null,\n  isDetailPanelVisible: false,\n  worldData: null,\n  userLocationId: null,\n  avatarLocationId: null,\n});\n\nconst actions = {\n  /**\n   * \n   * @param node - \n   */\n  navigateToNode(node: MapNode): void {\n    state.currentRootId = node.id;\n    // \n    if (!state.navigationPath.find(crumb => crumb.id === node.id)) {\n      state.navigationPath.push({ id: node.id, name: node.name });\n    }\n  },\n\n  /**\n   * \n   * @param targetId - ID\n   */\n  navigateBack(targetId: string): void {\n    const targetIndex = state.navigationPath.findIndex(crumb => crumb.id === targetId);\n    if (targetIndex > -1) {\n      state.currentRootId = targetId;\n      state.navigationPath.splice(targetIndex + 1);\n    }\n  },\n\n  /**\n   * \n   * @param node - \n   */\n  selectNode(node: MapNode): void {\n    state.selectedNode = node;\n    state.isDetailPanelVisible = true;\n  },\n\n  /**\n   * \n   */\n  hideDetail(): void {\n    state.selectedNode = null;\n    state.isDetailPanelVisible = false;\n  },\n\n  /**\n   * \n   * @param path - \n   */\n  setNavigationPath(path: NavigationCrumb[]): void {\n    state.navigationPath = path;\n  },\n\n  /**\n   * \n   * @param data -  Lorebook \n   */\n  setWorldData(data: WorldDefinition): void {\n    state.worldData = data;\n  },\n\n  /**\n   * ID\n   * @param locations -  user  avatar ID\n   */\n  setPlayerLocations(locations: { user: string | null; avatar: string | null }): void {\n    state.userLocationId = locations.user;\n    state.avatarLocationId = locations.avatar;\n  },\n};\n\nexport const mapState = readonly(state);\nexport const mapActions = actions;\n","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = { class: \"map-navigator\" };\nconst _hoisted_2 = [\"onClick\"];\nconst _hoisted_3 = {\n    key: 0,\n    class: \"separator\"\n};\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'MapNavigator',\n    props: {\n        path: {\n            type: Array,\n            required: true,\n        },\n    },\n    emits: ['navigate'],\n    setup(__props, { emit: __emit }) {\n        const emit = __emit;\n        const onCrumbClick = (nodeId) => {\n            emit('navigate', nodeId);\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.path, (crumb, index) => {\n                    return (_openBlock(), _createElementBlock(\"span\", {\n                        key: crumb.id,\n                        class: \"crumb\",\n                        onClick: ($event) => (onCrumbClick(crumb.id))\n                    }, [\n                        _createTextVNode(_toDisplayString(crumb.name) + \" \", 1 /* TEXT */),\n                        (index < __props.path.length - 1)\n                            ? (_openBlock(), _createElementBlock(\"span\", _hoisted_3, \" > \"))\n                            : _createCommentVNode(\"v-if\", true)\n                    ], 8 /* PROPS */, _hoisted_2));\n                }), 128 /* KEYED_FRAGMENT */))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./MapNavigator.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MapNavigator.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MapNavigator.vue?vue&type=style&index=0&id=41303afe&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-41303afe\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment, normalizeClass as _normalizeClass, createStaticVNode as _createStaticVNode } from \"vue\";\nconst _hoisted_1 = { class: \"panel-header\" };\nconst _hoisted_2 = { class: \"panel-content\" };\nconst _hoisted_3 = { key: 0 };\nconst _hoisted_4 = { class: \"section\" };\nconst _hoisted_5 = { key: 0 };\nconst _hoisted_6 = {\n    key: 0,\n    class: \"section\"\n};\nconst _hoisted_7 = {\n    key: 1,\n    class: \"section\"\n};\nconst _hoisted_8 = { class: \"section-title\" };\nconst _hoisted_9 = { class: \"item-list\" };\nconst _hoisted_10 = [\"onClick\"];\nconst _hoisted_11 = {\n    key: 2,\n    class: \"section\"\n};\nconst _hoisted_12 = { class: \"item-list\" };\nconst _hoisted_13 = {\n    key: 3,\n    class: \"section\"\n};\nconst _hoisted_14 = { class: \"item-list\" };\nconst _hoisted_15 = { key: 1 };\nimport { computed, onMounted, ref } from 'vue';\nimport { mapActions, mapState } from '../store/mapState';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NodeDetailPanel',\n    props: {\n        node: {\n            type: Object,\n            default: null,\n        },\n    },\n    emits: ['close'],\n    setup(__props) {\n        const props = __props;\n        const onNavigate = (node) => {\n            if (node.childCount > 0) {\n                mapActions.navigateToNode(node);\n            }\n        };\n        const children = computed(() => {\n            return props.node?.children || [];\n        });\n        const associatedResources = computed(() => {\n            if (!props.node || !mapState.worldData?.?.) {\n                return [];\n            }\n            const resources = mapState.worldData..;\n            // \n            const resourcesArray = Array.isArray(resources) ? resources : [];\n            return resourcesArray.filter((resource) => resource.ID === props.node?.id);\n        });\n        const associatedFactions = computed(() => {\n            // @TODO: \n            if (!props.node || !mapState.worldData?.?.?.) {\n                return [];\n            }\n            const factionsSource = mapState.worldData...;\n            // \n            const factionsArray = Array.isArray(factionsSource) ? factionsSource : Object.values(factionsSource);\n            // \n            const filtered = factionsArray.filter(faction => {\n                // faction\n                if (!faction || typeof faction !== 'object')\n                    return false;\n                const factionDataString = JSON.stringify(faction);\n                return factionDataString.includes(props.node.name);\n            });\n            return filtered;\n        });\n        const panelRef = ref(null);\n        onMounted(() => {\n            const panel = panelRef.value;\n            if (!panel)\n                return;\n            const header = panel.querySelector('.panel-header');\n            // ---  ---\n            header.addEventListener('mousedown', (e) => {\n                let isDragging = true;\n                const startX = e.clientX;\n                const startY = e.clientY;\n                const startLeft = panel.offsetLeft;\n                const startTop = panel.offsetTop;\n                const onDragMove = (moveEvent) => {\n                    if (!isDragging)\n                        return;\n                    const dx = moveEvent.clientX - startX;\n                    const dy = moveEvent.clientY - startY;\n                    panel.style.left = `${startLeft + dx}px`;\n                    panel.style.top = `${startTop + dy}px`;\n                };\n                const onDragEnd = () => {\n                    isDragging = false;\n                    document.removeEventListener('mousemove', onDragMove);\n                    document.removeEventListener('mouseup', onDragEnd);\n                };\n                document.addEventListener('mousemove', onDragMove);\n                document.addEventListener('mouseup', onDragEnd);\n            });\n            // ---  ---\n            const handles = panel.querySelectorAll('.resize-handle');\n            handles.forEach(handle => {\n                handle.addEventListener('mousedown', (e) => {\n                    e.stopPropagation();\n                    const direction = handle.dataset.direction;\n                    if (!direction)\n                        return;\n                    let isResizing = true;\n                    const startX = e.clientX;\n                    const startY = e.clientY;\n                    const startWidth = panel.offsetWidth;\n                    const startHeight = panel.offsetHeight;\n                    const startLeft = panel.offsetLeft;\n                    const startTop = panel.offsetTop;\n                    const onResizeMove = (moveEvent) => {\n                        if (!isResizing)\n                            return;\n                        const dx = moveEvent.clientX - startX;\n                        const dy = moveEvent.clientY - startY;\n                        if (direction.includes('right')) {\n                            panel.style.width = `${startWidth + dx}px`;\n                        }\n                        if (direction.includes('bottom')) {\n                            panel.style.height = `${startHeight + dy}px`;\n                        }\n                        if (direction.includes('left')) {\n                            panel.style.width = `${startWidth - dx}px`;\n                            panel.style.left = `${startLeft + dx}px`;\n                        }\n                        if (direction.includes('top')) {\n                            panel.style.height = `${startHeight - dy}px`;\n                            panel.style.top = `${startTop + dy}px`;\n                        }\n                    };\n                    const onResizeEnd = () => {\n                        isResizing = false;\n                        document.removeEventListener('mousemove', onResizeMove);\n                        document.removeEventListener('mouseup', onResizeEnd);\n                    };\n                    document.addEventListener('mousemove', onResizeMove);\n                    document.addEventListener('mouseup', onResizeEnd);\n                });\n            });\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n                class: \"node-detail-panel\",\n                ref_key: \"panelRef\",\n                ref: panelRef\n            }, [\n                _createElementVNode(\"div\", _hoisted_1, [\n                    _createElementVNode(\"h3\", null, _toDisplayString(__props.node?.name || ''), 1 /* TEXT */),\n                    _createElementVNode(\"button\", {\n                        class: \"close-btn\",\n                        onClick: _cache[0] || (_cache[0] = ($event) => (_ctx.$emit('close')))\n                    }, \"\")\n                ]),\n                _createElementVNode(\"div\", _hoisted_2, [\n                    (__props.node)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                            _createCommentVNode(\"  \"),\n                            _createElementVNode(\"div\", _hoisted_4, [\n                                _createElementVNode(\"p\", null, [\n                                    _cache[1] || (_cache[1] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                    _createTextVNode(\" \" + _toDisplayString(__props.node.type), 1 /* TEXT */)\n                                ]),\n                                (__props.node.data.)\n                                    ? (_openBlock(), _createElementBlock(\"p\", _hoisted_5, [\n                                        _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                        _createTextVNode(\" \" + _toDisplayString(__props.node.data.[0]) + \" \" + _toDisplayString(__props.node.data.[1]), 1 /* TEXT */)\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ]),\n                            _createCommentVNode(\"  \"),\n                            (__props.node.data.)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [\n                                    _cache[3] || (_cache[3] = _createElementVNode(\"h4\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"pre\", null, _toDisplayString(__props.node.data.), 1 /* TEXT */)\n                                ]))\n                                : _createCommentVNode(\"v-if\", true),\n                            _createCommentVNode(\"  \"),\n                            (children.value.length > 0)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [\n                                    _createElementVNode(\"h4\", _hoisted_8, \" (\" + _toDisplayString(children.value.length) + \")\", 1 /* TEXT */),\n                                    _createElementVNode(\"ul\", _hoisted_9, [\n                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(children.value, (child) => {\n                                            return (_openBlock(), _createElementBlock(\"li\", {\n                                                key: child.id,\n                                                class: \"interactive list-item\",\n                                                onClick: ($event) => (onNavigate(child))\n                                            }, _toDisplayString(child.name) + \" (\" + _toDisplayString(child.type) + \") \", 9 /* TEXT, PROPS */, _hoisted_10));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                    ])\n                                ]))\n                                : _createCommentVNode(\"v-if\", true),\n                            _createCommentVNode(\"  \"),\n                            (associatedResources.value.length > 0)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [\n                                    _cache[4] || (_cache[4] = _createElementVNode(\"h4\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"ul\", _hoisted_12, [\n                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(associatedResources.value, (resource) => {\n                                            return (_openBlock(), _createElementBlock(\"li\", {\n                                                key: resource.ID,\n                                                class: \"list-item\"\n                                            }, [\n                                                _createTextVNode(_toDisplayString(resource.) + \" \", 1 /* TEXT */),\n                                                _createElementVNode(\"span\", {\n                                                    class: _normalizeClass([\"rarity\", `rarity-${resource.}`])\n                                                }, \"[\" + _toDisplayString(resource.) + \"]\", 3 /* TEXT, CLASS */)\n                                            ]));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                    ])\n                                ]))\n                                : _createCommentVNode(\"v-if\", true),\n                            _createCommentVNode(\"  () \"),\n                            (associatedFactions.value.length > 0)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_13, [\n                                    _cache[5] || (_cache[5] = _createElementVNode(\"h4\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"ul\", _hoisted_14, [\n                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(associatedFactions.value, (faction) => {\n                                            return (_openBlock(), _createElementBlock(\"li\", {\n                                                key: faction.ID,\n                                                class: \"list-item\"\n                                            }, _toDisplayString(faction.) + \" (\" + _toDisplayString(faction.) + \") \", 1 /* TEXT */));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                    ])\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_15, [...(_cache[6] || (_cache[6] = [\n                                _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                            ]))]))\n                ]),\n                _cache[7] || (_cache[7] = _createStaticVNode(\"<div class=\\\"resize-handle top\\\" data-direction=\\\"top\\\" data-v-22e5bfcd></div><div class=\\\"resize-handle right\\\" data-direction=\\\"right\\\" data-v-22e5bfcd></div><div class=\\\"resize-handle bottom\\\" data-direction=\\\"bottom\\\" data-v-22e5bfcd></div><div class=\\\"resize-handle left\\\" data-direction=\\\"left\\\" data-v-22e5bfcd></div><div class=\\\"resize-handle top-left\\\" data-direction=\\\"top-left\\\" data-v-22e5bfcd></div><div class=\\\"resize-handle top-right\\\" data-direction=\\\"top-right\\\" data-v-22e5bfcd></div><div class=\\\"resize-handle bottom-left\\\" data-direction=\\\"bottom-left\\\" data-v-22e5bfcd></div><div class=\\\"resize-handle bottom-right\\\" data-direction=\\\"bottom-right\\\" data-v-22e5bfcd></div>\", 8))\n            ], 512 /* NEED_PATCH */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NodeDetailPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NodeDetailPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NodeDetailPanel.vue?vue&type=style&index=0&id=22e5bfcd&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-22e5bfcd\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createVNode as _createVNode, createElementVNode as _createElementVNode, vModelText as _vModelText, withKeys as _withKeys, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, unref as _unref, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = { class: \"world-map-view\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"search-panel\"\n};\nconst _hoisted_3 = {\n    key: 0,\n    class: \"search-results\"\n};\nconst _hoisted_4 = [\"onClick\"];\nimport * as d3 from 'd3';\nimport { computed, nextTick, onActivated, onMounted, onUnmounted, ref, watch } from 'vue';\nimport { lorebookService } from '../../../services/LorebookService';\nimport { store } from '../../../store';\nimport { colorService } from '../services/ColorService';\nimport { coordinateService } from '../services/CoordinateService';\nimport { worldMapDataService } from '../services/WorldMapDataService';\nimport { mapActions, mapState } from '../store/mapState';\nimport MapNavigator from './MapNavigator.vue';\nimport NodeDetailPanel from './NodeDetailPanel.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'AvatarWorldMapView',\n    setup(__props) {\n        const svgRef = ref(null);\n        const fullHierarchy = ref(null);\n        const layoutNodes = ref([]);\n        const layoutLinks = ref([]);\n        const searchText = ref('');\n        const stars = ref([]);\n        const isSearchPanelVisible = ref(false);\n        //  store \n        const navigationPath = computed(() => mapState.navigationPath);\n        const isDetailPanelVisible = computed(() => mapState.isDetailPanelVisible);\n        const selectedNode = computed(() => mapState.selectedNode);\n        const currentRootId = computed(() => mapState.currentRootId);\n        // \n        const findNode = (node, id) => {\n            if (node.id === id)\n                return node;\n            for (const child of node.children) {\n                const found = findNode(child, id);\n                if (found)\n                    return found;\n            }\n            return null;\n        };\n        const currentRootNode = computed(() => {\n            if (!fullHierarchy.value)\n                return null;\n            return findNode(fullHierarchy.value, currentRootId.value);\n        });\n        const allNodes = computed(() => {\n            const nodes = [];\n            function traverse(node) {\n                nodes.push(node);\n                node.children.forEach(traverse);\n            }\n            if (fullHierarchy.value) {\n                traverse(fullHierarchy.value);\n            }\n            return nodes;\n        });\n        const searchResults = computed(() => {\n            if (!searchText.value)\n                return [];\n            return allNodes.value.filter(node => node.name.toLowerCase().includes(searchText.value.toLowerCase())).slice(0, 10); // 10\n        });\n        const getFullPath = (node) => {\n            const path = [];\n            let current = node;\n            while (current && current.id !== 'WORLD_ORIGIN') {\n                path.unshift(current.name);\n                current = allNodes.value.find(n => n.id === current.parentId);\n            }\n            return path.join(' > ');\n        };\n        const jumpToNode = (node) => {\n            const path = [];\n            let current = node;\n            while (current && current.parentId && current.id !== 'WORLD_ORIGIN') {\n                path.unshift(current);\n                current = allNodes.value.find(n => n.id === current.parentId);\n            }\n            if (current) {\n                path.unshift(current);\n            }\n            const newNavPath = path.map(p => ({ id: p.id, name: p.name }));\n            mapActions.setNavigationPath(newNavPath);\n            if (node.parentId) {\n                mapActions.navigateBack(node.parentId);\n            }\n            else {\n                mapActions.navigateBack('WORLD_ORIGIN');\n            }\n            searchText.value = '';\n        };\n        const jumpToFirstResult = () => {\n            if (searchResults.value.length > 0) {\n                jumpToNode(searchResults.value[0]);\n            }\n        };\n        const searchBtnRef = ref(null);\n        const initDraggableSearchBtn = () => {\n            const btn = searchBtnRef.value;\n            if (!btn)\n                return;\n            let isDragging = false;\n            let offsetX = 0, offsetY = 0;\n            const onMouseMove = (e) => {\n                if (!isDragging)\n                    return;\n                const container = btn.parentElement;\n                if (!container)\n                    return;\n                let x = e.clientX - offsetX;\n                let y = e.clientY - offsetY;\n                // \n                const containerRect = container.getBoundingClientRect();\n                x = Math.max(0, Math.min(x, containerRect.width - btn.offsetWidth));\n                y = Math.max(0, Math.min(y, containerRect.height - btn.offsetHeight));\n                btn.style.left = `${x}px`;\n                btn.style.top = `${y}px`;\n            };\n            const onMouseUp = () => {\n                if (!isDragging)\n                    return;\n                isDragging = false;\n                document.removeEventListener('mousemove', onMouseMove);\n                document.removeEventListener('mouseup', onMouseUp);\n                const containerRect = btn.parentElement.getBoundingClientRect();\n                const rect = btn.getBoundingClientRect();\n                const threshold = 50;\n                if (rect.left - containerRect.left < threshold) {\n                    btn.style.left = '10px';\n                }\n                else if (containerRect.right - rect.right < threshold) {\n                    btn.style.left = `${containerRect.width - rect.width - 10}px`;\n                }\n                if (rect.top - containerRect.top < threshold) {\n                    btn.style.top = '10px';\n                }\n                else if (containerRect.bottom - rect.bottom < threshold) {\n                    btn.style.top = `${containerRect.height - rect.height - 10}px`;\n                }\n            };\n            btn.onmousedown = e => {\n                isDragging = true;\n                offsetX = e.clientX - btn.offsetLeft;\n                offsetY = e.clientY - btn.offsetTop;\n                document.addEventListener('mousemove', onMouseMove);\n                document.addEventListener('mouseup', onMouseUp);\n            };\n        };\n        const visibleNodes = computed(() => {\n            return currentRootNode.value ? currentRootNode.value.children : [];\n        });\n        // \n        watch(currentRootNode, newRoot => {\n            if (newRoot && svgRef.value) {\n                // \n                const rootCopy = JSON.parse(JSON.stringify(newRoot));\n                const { width, height } = svgRef.value.getBoundingClientRect();\n                let nodesToRender = [];\n                let links = [];\n                let visualCenterNode = null;\n                if (rootCopy.id === 'WORLD_ORIGIN') {\n                    visualCenterNode = rootCopy.children[0];\n                    if (visualCenterNode) {\n                        visualCenterNode.x = width / 2;\n                        visualCenterNode.y = height / 2;\n                        coordinateService.calculateRelativePositions(visualCenterNode, rootCopy.children);\n                    }\n                    nodesToRender = rootCopy.children;\n                    links = rootCopy.children\n                        .slice(1)\n                        .map((child) => ({ source: visualCenterNode, target: child }));\n                }\n                else {\n                    visualCenterNode = rootCopy;\n                    rootCopy.x = width / 2;\n                    rootCopy.y = height / 2;\n                    coordinateService.calculateRelativePositions(rootCopy, rootCopy.children);\n                    nodesToRender = [rootCopy, ...rootCopy.children];\n                    links = rootCopy.children.map((child) => ({\n                        source: rootCopy,\n                        target: child,\n                    }));\n                }\n                const transform = d3.zoomIdentity;\n                layoutNodes.value = nodesToRender.filter(n => n.id !== 'WORLD_ORIGIN');\n                layoutLinks.value = links;\n                nextTick(() => {\n                    renderD3(layoutNodes.value, layoutLinks.value, transform);\n                });\n            }\n            else {\n                layoutNodes.value = [];\n                layoutLinks.value = [];\n                renderD3([], [], d3.zoomIdentity);\n            }\n        }, { immediate: true });\n        onMounted(async () => {\n            const worldData = (await lorebookService.loadAndParseWorldData(''));\n            if (worldData) {\n                mapActions.setWorldData(worldData);\n                fullHierarchy.value = worldMapDataService.getMapHierarchy(worldData);\n            }\n            // \n            if (store.worldState) {\n                const avatarId = store.worldState.?.?.ID?.[0];\n                const userLocation = store.worldState.?.[store.userId]?.?.[0] || null;\n                const avatarLocation = avatarId && store.worldState.?.[avatarId] ? store.worldState.[avatarId].?.[0] || null : null;\n                mapActions.setPlayerLocations({ user: userLocation, avatar: avatarLocation });\n            }\n            if (svgRef.value) {\n                const { width, height } = svgRef.value.getBoundingClientRect();\n                const starFieldSize = Math.max(width, height) * 4;\n                stars.value = Array.from({ length: 1000 }, (_, i) => ({\n                    id: i,\n                    x: (Math.random() - 0.5) * starFieldSize + width / 2,\n                    y: (Math.random() - 0.5) * starFieldSize + height / 2,\n                    r: Math.random() * 1.2,\n                    o: Math.random() * 0.8 + 0.2,\n                }));\n                const svg = d3.select(svgRef.value);\n                const zoom = d3\n                    .zoom()\n                    .scaleExtent([0.01, 10])\n                    .on('zoom', event => {\n                    d3.select(svgRef.value).select('g.zoom-container').attr('transform', event.transform);\n                });\n                svg.call(zoom).on('dblclick.zoom', null); // \n            }\n            initDraggableSearchBtn();\n            // \n            const handleClickOutside = (event) => {\n                const searchPanel = document.querySelector('.search-panel');\n                if (searchPanel &&\n                    !searchPanel.contains(event.target) &&\n                    !searchBtnRef.value?.contains(event.target)) {\n                    isSearchPanelVisible.value = false;\n                }\n            };\n            document.addEventListener('click', handleClickOutside, true);\n            onUnmounted(() => {\n                document.removeEventListener('click', handleClickOutside, true);\n            });\n        });\n        onActivated(() => {\n            // \n            if (currentRootNode.value?.id === 'WORLD_ORIGIN') {\n                mapActions.setNavigationPath([]);\n            }\n        });\n        function renderD3(nodes, links, transform) {\n            const clickTimers = new Map();\n            if (!svgRef.value)\n                return;\n            const svg = d3.select(svgRef.value);\n            const zoomContainer = svg.selectAll('g.zoom-container').data([null]);\n            const zoomContainerEnter = zoomContainer.enter().append('g').attr('class', 'zoom-container');\n            const g = zoomContainer.merge(zoomContainerEnter);\n            //  (enter)\n            zoomContainerEnter\n                .append('g')\n                .selectAll('circle.star')\n                .data(stars.value)\n                .join('circle')\n                .attr('class', 'star')\n                .attr('cx', d => d.x)\n                .attr('cy', d => d.y)\n                .attr('r', d => d.r)\n                .attr('fill', 'white')\n                .attr('opacity', d => d.o);\n            const zoom = d3\n                .zoom()\n                .scaleExtent([0.01, 10])\n                .on('zoom', event => {\n                g.attr('transform', event.transform);\n            });\n            svg.call(zoom).on('dblclick.zoom', null);\n            svg\n                .transition()\n                .duration(750)\n                .call(zoom.transform, transform);\n            // ---  ---\n            const t = d3.transition().duration(750);\n            // \n            const visualCenterNode = nodes.find(n => n.id === currentRootId.value) || nodes[0];\n            if (visualCenterNode) {\n                const distances = nodes\n                    .filter(n => n.id !== visualCenterNode.id)\n                    .map(n => {\n                    const dx = (n.x ?? 0) - (visualCenterNode.x ?? 0);\n                    const dy = (n.y ?? 0) - (visualCenterNode.y ?? 0);\n                    return Math.sqrt(dx * dx + dy * dy);\n                })\n                    .filter(d => d > 0);\n                g.selectAll('circle.orbit-line')\n                    .data(distances)\n                    .join(enter => enter\n                    .append('circle')\n                    .attr('class', 'orbit-line')\n                    .attr('cx', visualCenterNode.x ?? 0)\n                    .attr('cy', visualCenterNode.y ?? 0)\n                    .attr('r', 0)\n                    .attr('fill', 'none')\n                    .attr('stroke', 'rgba(255, 255, 255, 0.1)')\n                    .call(enter => enter.transition(t).attr('r', d => d)), update => update.call(update => update\n                    .transition(t)\n                    .attr('cx', visualCenterNode.x ?? 0)\n                    .attr('cy', visualCenterNode.y ?? 0)\n                    .attr('r', d => d)), exit => exit.call(exit => exit.transition(t).attr('r', 0).remove()));\n            }\n            // \n            g.selectAll('line.link')\n                .data(links, (d) => `${d.source.id}-${d.target.id}`)\n                .join(enter => enter\n                .append('line')\n                .attr('class', 'link')\n                .attr('stroke', '#999')\n                .attr('stroke-opacity', 0)\n                .attr('x1', d => d.source.x || 0)\n                .attr('y1', d => d.source.y || 0)\n                .attr('x2', d => d.target.x || 0)\n                .attr('y2', d => d.target.y || 0)\n                .call(enter => enter.transition(t).attr('stroke-opacity', 0.4)), update => update.call(update => update\n                .transition(t)\n                .attr('x1', d => d.source.x || 0)\n                .attr('y1', d => d.source.y || 0)\n                .attr('x2', d => d.target.x || 0)\n                .attr('y2', d => d.target.y || 0)), exit => exit.call(exit => exit.transition(t).attr('stroke-opacity', 0).remove()));\n            // \n            const nodeGroups = g.selectAll('g.node-group').data(nodes, d => d.id);\n            const nodeEnter = nodeGroups\n                .enter()\n                .append('g')\n                .attr('class', 'node-group')\n                .attr('transform', (d) => `translate(${d.x || 0},${d.y || 0})`)\n                .attr('opacity', 0);\n            nodeEnter\n                .append('circle')\n                .attr('r', d => d.radius)\n                .attr('fill', d => colorService.getColor(d.type))\n                .attr('stroke', d => d3.color(colorService.getColor(d.type))?.brighter(1.5).toString() ?? '#fff')\n                .attr('stroke-width', 2);\n            nodeEnter\n                .append('text')\n                .text(d => d.name)\n                .attr('text-anchor', 'middle')\n                .attr('dy', d => d.radius + 15)\n                .attr('fill', 'white')\n                .style('font-size', '12px');\n            nodeGroups\n                .merge(nodeEnter)\n                .on('click', function (event, d) {\n                const existingTimeout = clickTimers.get(d.id);\n                if (existingTimeout) {\n                    clearTimeout(existingTimeout);\n                    clickTimers.delete(d.id);\n                    mapActions.selectNode(d);\n                }\n                else {\n                    const newTimeout = window.setTimeout(() => {\n                        if (d.childCount > 0) {\n                            mapActions.navigateToNode(d);\n                        }\n                        else {\n                            mapActions.selectNode(d);\n                        }\n                        clickTimers.delete(d.id);\n                    }, 250);\n                    clickTimers.set(d.id, newTimeout);\n                }\n            })\n                .transition(t)\n                .attr('transform', (d) => `translate(${d.x || 0},${d.y || 0})`)\n                .attr('opacity', 1);\n            nodeGroups.exit().transition(t).attr('opacity', 0).remove();\n        }\n        const onNavigateBack = (nodeId) => {\n            mapActions.navigateBack(nodeId);\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createVNode(MapNavigator, {\n                    path: navigationPath.value,\n                    onNavigate: onNavigateBack\n                }, null, 8 /* PROPS */, [\"path\"]),\n                _createElementVNode(\"button\", {\n                    ref_key: \"searchBtnRef\",\n                    ref: searchBtnRef,\n                    class: \"search-toggle-btn\",\n                    onClick: _cache[0] || (_cache[0] = ($event) => (isSearchPanelVisible.value = !isSearchPanelVisible.value))\n                }, \"  \", 512 /* NEED_PATCH */),\n                (isSearchPanelVisible.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _withDirectives(_createElementVNode(\"input\", {\n                            type: \"text\",\n                            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event) => ((searchText).value = $event)),\n                            placeholder: \"...\",\n                            onKeyup: _withKeys(jumpToFirstResult, [\"enter\"])\n                        }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                            [_vModelText, searchText.value]\n                        ]),\n                        (searchResults.value.length && searchText.value)\n                            ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_3, [\n                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(searchResults.value, (node) => {\n                                    return (_openBlock(), _createElementBlock(\"li\", {\n                                        key: node.id,\n                                        onClick: ($event) => (jumpToNode(node))\n                                    }, _toDisplayString(getFullPath(node)), 9 /* TEXT, PROPS */, _hoisted_4));\n                                }), 128 /* KEYED_FRAGMENT */))\n                            ]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                (_openBlock(), _createElementBlock(\"svg\", {\n                    ref_key: \"svgRef\",\n                    ref: svgRef,\n                    class: \"map-svg\"\n                }, null, 512 /* NEED_PATCH */)),\n                (isDetailPanelVisible.value)\n                    ? (_openBlock(), _createBlock(NodeDetailPanel, {\n                        key: 1,\n                        node: selectedNode.value,\n                        onClose: _unref(mapActions).hideDetail\n                    }, null, 8 /* PROPS */, [\"node\", \"onClose\"]))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./AvatarWorldMapView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AvatarWorldMapView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./AvatarWorldMapView.vue?vue&type=style&index=0&id=8e6ae08a&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createVNode as _createVNode, createElementVNode as _createElementVNode, vModelText as _vModelText, withKeys as _withKeys, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, unref as _unref, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = { class: \"world-map-view\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"search-panel\"\n};\nconst _hoisted_3 = {\n    key: 0,\n    class: \"search-results\"\n};\nconst _hoisted_4 = [\"onClick\"];\nimport * as d3 from 'd3';\nimport { computed, nextTick, onMounted, onUnmounted, ref, watch, onActivated } from 'vue';\nimport { lorebookService } from '../../../services/LorebookService';\nimport { store } from '../../../store';\nimport { coordinateService } from '../services/CoordinateService';\nimport { worldMapDataService } from '../services/WorldMapDataService';\nimport { colorService } from '../services/ColorService';\nimport { mapActions, mapState } from '../store/mapState';\nimport MapNavigator from './MapNavigator.vue';\nimport NodeDetailPanel from './NodeDetailPanel.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'WorldMapView',\n    setup(__props) {\n        const svgRef = ref(null);\n        const fullHierarchy = ref(null);\n        const layoutNodes = ref([]);\n        const layoutLinks = ref([]);\n        const searchText = ref('');\n        const stars = ref([]);\n        const isSearchPanelVisible = ref(false);\n        //  store \n        const navigationPath = computed(() => mapState.navigationPath);\n        const isDetailPanelVisible = computed(() => mapState.isDetailPanelVisible);\n        const selectedNode = computed(() => mapState.selectedNode);\n        const currentRootId = computed(() => mapState.currentRootId);\n        // \n        const findNode = (node, id) => {\n            if (node.id === id)\n                return node;\n            for (const child of node.children) {\n                const found = findNode(child, id);\n                if (found)\n                    return found;\n            }\n            return null;\n        };\n        const currentRootNode = computed(() => {\n            if (!fullHierarchy.value)\n                return null;\n            return findNode(fullHierarchy.value, currentRootId.value);\n        });\n        const allNodes = computed(() => {\n            const nodes = [];\n            function traverse(node) {\n                nodes.push(node);\n                node.children.forEach(traverse);\n            }\n            if (fullHierarchy.value) {\n                traverse(fullHierarchy.value);\n            }\n            return nodes;\n        });\n        const searchResults = computed(() => {\n            if (!searchText.value)\n                return [];\n            return allNodes.value.filter(node => node.name.toLowerCase().includes(searchText.value.toLowerCase())).slice(0, 10); // 10\n        });\n        const getFullPath = (node) => {\n            const path = [];\n            let current = node;\n            while (current && current.id !== 'WORLD_ORIGIN') {\n                path.unshift(current.name);\n                current = allNodes.value.find(n => n.id === current.parentId);\n            }\n            return path.join(' > ');\n        };\n        const jumpToNode = (node) => {\n            const path = [];\n            let current = node;\n            while (current && current.parentId && current.id !== 'WORLD_ORIGIN') {\n                path.unshift(current);\n                current = allNodes.value.find(n => n.id === current.parentId);\n            }\n            if (current) {\n                path.unshift(current);\n            }\n            const newNavPath = path.map(p => ({ id: p.id, name: p.name }));\n            mapActions.setNavigationPath(newNavPath);\n            if (node.parentId) {\n                mapActions.navigateBack(node.parentId);\n            }\n            else {\n                mapActions.navigateBack('WORLD_ORIGIN');\n            }\n            searchText.value = '';\n        };\n        const jumpToFirstResult = () => {\n            if (searchResults.value.length > 0) {\n                jumpToNode(searchResults.value[0]);\n            }\n        };\n        const searchBtnRef = ref(null);\n        const initDraggableSearchBtn = () => {\n            const btn = searchBtnRef.value;\n            if (!btn)\n                return;\n            let isDragging = false;\n            let offsetX = 0, offsetY = 0;\n            const onMouseMove = (e) => {\n                if (!isDragging)\n                    return;\n                const container = btn.parentElement;\n                if (!container)\n                    return;\n                let x = e.clientX - offsetX;\n                let y = e.clientY - offsetY;\n                // \n                const containerRect = container.getBoundingClientRect();\n                x = Math.max(0, Math.min(x, containerRect.width - btn.offsetWidth));\n                y = Math.max(0, Math.min(y, containerRect.height - btn.offsetHeight));\n                btn.style.left = `${x}px`;\n                btn.style.top = `${y}px`;\n            };\n            const onMouseUp = () => {\n                if (!isDragging)\n                    return;\n                isDragging = false;\n                document.removeEventListener('mousemove', onMouseMove);\n                document.removeEventListener('mouseup', onMouseUp);\n                const containerRect = btn.parentElement.getBoundingClientRect();\n                const rect = btn.getBoundingClientRect();\n                const threshold = 50;\n                if (rect.left - containerRect.left < threshold) {\n                    btn.style.left = '10px';\n                }\n                else if (containerRect.right - rect.right < threshold) {\n                    btn.style.left = `${containerRect.width - rect.width - 10}px`;\n                }\n                if (rect.top - containerRect.top < threshold) {\n                    btn.style.top = '10px';\n                }\n                else if (containerRect.bottom - rect.bottom < threshold) {\n                    btn.style.top = `${containerRect.height - rect.height - 10}px`;\n                }\n            };\n            btn.onmousedown = e => {\n                isDragging = true;\n                offsetX = e.clientX - btn.offsetLeft;\n                offsetY = e.clientY - btn.offsetTop;\n                document.addEventListener('mousemove', onMouseMove);\n                document.addEventListener('mouseup', onMouseUp);\n            };\n        };\n        const visibleNodes = computed(() => {\n            return currentRootNode.value ? currentRootNode.value.children : [];\n        });\n        // \n        watch(currentRootNode, newRoot => {\n            if (newRoot && svgRef.value) {\n                // \n                const rootCopy = JSON.parse(JSON.stringify(newRoot));\n                const { width, height } = svgRef.value.getBoundingClientRect();\n                let nodesToRender = [];\n                let links = [];\n                if (rootCopy.id === 'WORLD_ORIGIN') {\n                    const mainNode = rootCopy.children[0];\n                    if (mainNode) {\n                        mainNode.x = width / 2;\n                        mainNode.y = height / 2;\n                        coordinateService.calculateRelativePositions(mainNode, rootCopy.children.slice(1));\n                    }\n                    nodesToRender = rootCopy.children;\n                    links = rootCopy.children\n                        .slice(1)\n                        .map((child) => ({ source: mainNode, target: child }));\n                }\n                else {\n                    rootCopy.x = width / 2;\n                    rootCopy.y = height / 2;\n                    coordinateService.calculateRelativePositions(rootCopy, rootCopy.children);\n                    nodesToRender = [rootCopy, ...rootCopy.children];\n                    links = rootCopy.children.map((child) => ({\n                        source: rootCopy,\n                        target: child,\n                    }));\n                }\n                const transform = d3.zoomIdentity;\n                layoutNodes.value = nodesToRender.filter(n => n.id !== 'WORLD_ORIGIN');\n                layoutLinks.value = links;\n                nextTick(() => {\n                    renderD3(layoutNodes.value, layoutLinks.value, transform);\n                });\n            }\n            else {\n                layoutNodes.value = [];\n                layoutLinks.value = [];\n                renderD3([], [], d3.zoomIdentity);\n            }\n        }, { immediate: true });\n        onMounted(async () => {\n            const worldData = (await lorebookService.loadAndParseWorldData());\n            if (worldData) {\n                mapActions.setWorldData(worldData);\n                fullHierarchy.value = worldMapDataService.getMapHierarchy(worldData);\n            }\n            // \n            if (store.worldState) {\n                const avatarId = store.worldState.?.?.ID?.[0];\n                const userLocation = store.worldState.?.[store.userId]?.?.[0] || null;\n                const avatarLocation = avatarId && store.worldState.?.[avatarId] ? store.worldState.[avatarId].?.[0] || null : null;\n                mapActions.setPlayerLocations({ user: userLocation, avatar: avatarLocation });\n            }\n            if (svgRef.value) {\n                const { width, height } = svgRef.value.getBoundingClientRect();\n                const starFieldSize = Math.max(width, height) * 4;\n                stars.value = Array.from({ length: 1000 }, (_, i) => ({\n                    id: i,\n                    x: (Math.random() - 0.5) * starFieldSize + width / 2,\n                    y: (Math.random() - 0.5) * starFieldSize + height / 2,\n                    r: Math.random() * 1.2,\n                    o: Math.random() * 0.8 + 0.2,\n                }));\n                const svg = d3.select(svgRef.value);\n                const zoom = d3\n                    .zoom()\n                    .scaleExtent([0.01, 10])\n                    .on('zoom', event => {\n                    d3.select(svgRef.value).select('g.zoom-container').attr('transform', event.transform);\n                });\n                svg.call(zoom).on('dblclick.zoom', null); // \n            }\n            initDraggableSearchBtn();\n            // \n            const handleClickOutside = (event) => {\n                const searchPanel = document.querySelector('.search-panel');\n                if (searchPanel &&\n                    !searchPanel.contains(event.target) &&\n                    !searchBtnRef.value?.contains(event.target)) {\n                    isSearchPanelVisible.value = false;\n                }\n            };\n            document.addEventListener('click', handleClickOutside, true);\n            onUnmounted(() => {\n                document.removeEventListener('click', handleClickOutside, true);\n            });\n        });\n        onActivated(() => {\n            // \n            if (currentRootNode.value?.id === 'WORLD_ORIGIN') {\n                mapActions.setNavigationPath([]);\n            }\n        });\n        function renderD3(nodes, links, transform) {\n            const clickTimers = new Map();\n            if (!svgRef.value)\n                return;\n            const svg = d3.select(svgRef.value);\n            const zoomContainer = svg.selectAll('g.zoom-container').data([null]);\n            const zoomContainerEnter = zoomContainer.enter().append('g').attr('class', 'zoom-container');\n            const g = zoomContainer.merge(zoomContainerEnter);\n            //  (enter)\n            zoomContainerEnter\n                .append('g')\n                .selectAll('circle.star')\n                .data(stars.value)\n                .join('circle')\n                .attr('class', 'star')\n                .attr('cx', d => d.x)\n                .attr('cy', d => d.y)\n                .attr('r', d => d.r)\n                .attr('fill', 'white')\n                .attr('opacity', d => d.o);\n            const zoom = d3\n                .zoom()\n                .scaleExtent([0.01, 10])\n                .on('zoom', event => {\n                g.attr('transform', event.transform);\n            });\n            svg.call(zoom).on('dblclick.zoom', null);\n            svg\n                .transition()\n                .duration(750)\n                .call(zoom.transform, transform);\n            // ---  ---\n            const t = d3.transition().duration(750);\n            // \n            const visualCenterNode = nodes.find(n => n.id === currentRootId.value) || nodes[0];\n            if (visualCenterNode) {\n                const distances = nodes\n                    .filter(n => n.id !== visualCenterNode.id)\n                    .map(n => {\n                    const dx = (n.x ?? 0) - (visualCenterNode.x ?? 0);\n                    const dy = (n.y ?? 0) - (visualCenterNode.y ?? 0);\n                    return Math.sqrt(dx * dx + dy * dy);\n                })\n                    .filter(d => d > 0);\n                g.selectAll('circle.orbit-line')\n                    .data(distances)\n                    .join(enter => enter\n                    .append('circle')\n                    .attr('class', 'orbit-line')\n                    .attr('cx', visualCenterNode.x ?? 0)\n                    .attr('cy', visualCenterNode.y ?? 0)\n                    .attr('r', 0)\n                    .attr('fill', 'none')\n                    .attr('stroke', 'rgba(255, 255, 255, 0.1)')\n                    .call(enter => enter.transition(t).attr('r', d => d)), update => update.call(update => update\n                    .transition(t)\n                    .attr('cx', visualCenterNode.x ?? 0)\n                    .attr('cy', visualCenterNode.y ?? 0)\n                    .attr('r', d => d)), exit => exit.call(exit => exit.transition(t).attr('r', 0).remove()));\n            }\n            // \n            g.selectAll('line.link')\n                .data(links, (d) => `${d.source.id}-${d.target.id}`)\n                .join(enter => enter\n                .append('line')\n                .attr('class', 'link')\n                .attr('stroke', '#999')\n                .attr('stroke-opacity', 0)\n                .attr('x1', d => d.source.x || 0)\n                .attr('y1', d => d.source.y || 0)\n                .attr('x2', d => d.target.x || 0)\n                .attr('y2', d => d.target.y || 0)\n                .call(enter => enter.transition(t).attr('stroke-opacity', 0.4)), update => update.call(update => update\n                .transition(t)\n                .attr('x1', d => d.source.x || 0)\n                .attr('y1', d => d.source.y || 0)\n                .attr('x2', d => d.target.x || 0)\n                .attr('y2', d => d.target.y || 0)), exit => exit.call(exit => exit.transition(t).attr('stroke-opacity', 0).remove()));\n            // \n            const nodeGroups = g.selectAll('g.node-group').data(nodes, d => d.id);\n            const nodeEnter = nodeGroups\n                .enter()\n                .append('g')\n                .attr('class', 'node-group')\n                .classed('player-location', d => d.id === mapState.userLocationId)\n                .classed('avatar-location', d => d.id === mapState.avatarLocationId)\n                .attr('transform', (d) => `translate(${d.x || 0},${d.y || 0})`)\n                .attr('opacity', 0);\n            nodeEnter\n                .append('circle')\n                .attr('r', d => d.radius)\n                .attr('fill', d => colorService.getColor(d.type))\n                .attr('stroke', d => d3.color(colorService.getColor(d.type))?.brighter(1.5).toString() ?? '#fff')\n                .attr('stroke-width', 2);\n            nodeEnter\n                .append('text')\n                .text(d => d.name)\n                .attr('text-anchor', 'middle')\n                .attr('dy', d => d.radius + 15)\n                .attr('fill', 'white')\n                .style('font-size', '12px');\n            nodeGroups\n                .merge(nodeEnter)\n                .on('click', function (event, d) {\n                const existingTimeout = clickTimers.get(d.id);\n                if (existingTimeout) {\n                    clearTimeout(existingTimeout);\n                    clickTimers.delete(d.id);\n                    mapActions.selectNode(d);\n                }\n                else {\n                    const newTimeout = window.setTimeout(() => {\n                        if (d.childCount > 0) {\n                            mapActions.navigateToNode(d);\n                        }\n                        else {\n                            mapActions.selectNode(d);\n                        }\n                        clickTimers.delete(d.id);\n                    }, 250);\n                    clickTimers.set(d.id, newTimeout);\n                }\n            })\n                .transition(t)\n                .attr('transform', (d) => `translate(${d.x || 0},${d.y || 0})`)\n                .attr('opacity', 1);\n            nodeGroups.exit().transition(t).attr('opacity', 0).remove();\n        }\n        const onNavigateBack = (nodeId) => {\n            mapActions.navigateBack(nodeId);\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createVNode(MapNavigator, {\n                    path: navigationPath.value,\n                    onNavigate: onNavigateBack\n                }, null, 8 /* PROPS */, [\"path\"]),\n                _createElementVNode(\"button\", {\n                    ref_key: \"searchBtnRef\",\n                    ref: searchBtnRef,\n                    class: \"search-toggle-btn\",\n                    onClick: _cache[0] || (_cache[0] = ($event) => (isSearchPanelVisible.value = !isSearchPanelVisible.value))\n                }, \"  \", 512 /* NEED_PATCH */),\n                (isSearchPanelVisible.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _withDirectives(_createElementVNode(\"input\", {\n                            type: \"text\",\n                            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event) => ((searchText).value = $event)),\n                            placeholder: \"...\",\n                            onKeyup: _withKeys(jumpToFirstResult, [\"enter\"])\n                        }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                            [_vModelText, searchText.value]\n                        ]),\n                        (searchResults.value.length && searchText.value)\n                            ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_3, [\n                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(searchResults.value, (node) => {\n                                    return (_openBlock(), _createElementBlock(\"li\", {\n                                        key: node.id,\n                                        onClick: ($event) => (jumpToNode(node))\n                                    }, _toDisplayString(getFullPath(node)), 9 /* TEXT, PROPS */, _hoisted_4));\n                                }), 128 /* KEYED_FRAGMENT */))\n                            ]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                (_openBlock(), _createElementBlock(\"svg\", {\n                    ref_key: \"svgRef\",\n                    ref: svgRef,\n                    class: \"map-svg\"\n                }, null, 512 /* NEED_PATCH */)),\n                (isDetailPanelVisible.value)\n                    ? (_openBlock(), _createBlock(NodeDetailPanel, {\n                        key: 1,\n                        node: selectedNode.value,\n                        onClose: _unref(mapActions).hideDetail\n                    }, null, 8 /* PROPS */, [\"node\", \"onClose\"]))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","import { isSimulationRunning } from '../store/getters';\nimport { dockManagerService } from './DockManagerService';\n\n// Import all panel components once\nimport AvatarCharacterPanel from '../components/panels/avatar/AvatarCharacterPanel.vue';\nimport AvatarInventoryPanel from '../components/panels/avatar/AvatarInventoryPanel.vue';\nimport AvatarTasksPanel from '../components/panels/avatar/AvatarTasksPanel.vue';\nimport CharacterPanel from '../components/panels/CharacterPanel.vue';\nimport ImprintsPanel from '../components/panels/ImprintsPanel.vue';\nimport InventoryPanel from '../components/panels/InventoryPanel.vue';\nimport SkillsPanel from '../components/panels/SkillsPanel.vue';\nimport NpcDirectoryPanel from '../components/panels/NpcDirectoryPanel.vue';\nimport ReincarnationPanel from '../components/panels/ReincarnationPanel.vue';\nimport RippleDetailPanel from '../components/panels/RippleDetailPanel.vue';\nimport SystemPanel from '../components/panels/SystemPanel.vue';\nimport WorldDetailsPanel from '../components/panels/WorldDetailsPanel.vue';\nimport AvatarWorldMapView from '../modules/world-map/components/AvatarWorldMapView.vue';\nimport WorldMapView from '../modules/world-map/components/WorldMapView.vue';\n\nimport type { Component } from 'vue';\n\ninterface PanelInfo {\n  component: Component;\n  title: string;\n}\n\ntype PanelRegistry = Record<string, Record<string, PanelInfo>>;\n\nconst panelRegistry: PanelRegistry = {\n  mainWorld: {\n    character: { component: CharacterPanel, title: '' },\n    inventory: { component: InventoryPanel, title: '' },\n    skills: { component: SkillsPanel, title: '' },\n    imprints: { component: ImprintsPanel, title: '' },\n    worldDetails: { component: WorldDetailsPanel, title: '' },\n    sandbox: { component: WorldMapView, title: '' },\n  },\n  avatarWorld: {\n    character: { component: AvatarCharacterPanel, title: '' },\n    inventory: { component: AvatarInventoryPanel, title: '' },\n    tasks: { component: AvatarTasksPanel, title: '' },\n    worldDetails: { component: WorldDetailsPanel, title: '' },\n    sandbox: { component: AvatarWorldMapView, title: '' },\n  },\n  reincarnation: {\n    main: { component: ReincarnationPanel, title: '' },\n  },\n  allWorlds: {\n    npcDirectory: { component: NpcDirectoryPanel, title: '' },\n  },\n  ripples: {\n    detail: { component: RippleDetailPanel, title: '' },\n  },\n  system: {\n    saveLoad: { component: SystemPanel, title: '' },\n  },\n};\n\nexport function usePanelManager() {\n  const openPanel = (world: keyof typeof panelRegistry, panel: string, props: Record<string, any> = {}) => {\n    if (world === 'avatarWorld' && !isSimulationRunning.value) {\n      return;\n    }\n\n    const panelInfo = panelRegistry[world]?.[panel];\n    if (panelInfo) {\n      const panelId = `${world}-${panel}-${props.rippleId || ''}`;\n      const finalProps = { worldType: world, ...props };\n      dockManagerService.openPanel(panelId, panelInfo.title, panelInfo.component, finalProps);\n    }\n  };\n\n  return { openPanel };\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"game-text-container\" };\nimport { computed } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'FormattedTextRenderer',\n    props: {\n        text: {\n            type: String,\n            required: true,\n        },\n    },\n    setup(__props) {\n        const props = __props;\n        const segments = computed(() => {\n            if (!props.text)\n                return [];\n            // Strip any potential HTML tags from the input string first.\n            const cleanText = props.text.replace(/<[^>]*>/g, '');\n            const parsedSegments = [];\n            let remainingText = cleanText;\n            const regex = /(.*?)|(.*?)|(.*?)|(\\*.*?\\*)/g;\n            let match;\n            while ((match = regex.exec(remainingText)) !== null) {\n                const matchedText = match[0];\n                const preMatchText = remainingText.substring(0, match.index);\n                if (preMatchText) {\n                    parsedSegments.push({ text: preMatchText, class: '' });\n                }\n                if (match[1]) {\n                    // ...\n                    parsedSegments.push({ text: matchedText.slice(2, -2), class: 'text-system-highlight' });\n                }\n                else if (match[2]) {\n                    // ...\n                    parsedSegments.push({ text: matchedText.slice(1, -1), class: 'text-scenery' });\n                }\n                else if (match[3]) {\n                    // ...\n                    parsedSegments.push({ text: matchedText.slice(1, -1), class: 'text-dialogue' });\n                }\n                else if (match[4]) {\n                    // *...*\n                    parsedSegments.push({ text: matchedText.slice(1, -1), class: 'text-psychology' });\n                }\n                remainingText = remainingText.substring(match.index + matchedText.length);\n                regex.lastIndex = 0; // Reset regex index\n            }\n            if (remainingText) {\n                parsedSegments.push({ text: remainingText, class: '' });\n            }\n            return parsedSegments;\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(segments.value, (segment, index) => {\n                    return (_openBlock(), _createElementBlock(\"span\", {\n                        key: index,\n                        class: _normalizeClass(segment.class)\n                    }, _toDisplayString(segment.text), 3 /* TEXT, CLASS */));\n                }), 128 /* KEYED_FRAGMENT */))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./FormattedTextRenderer.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./FormattedTextRenderer.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./FormattedTextRenderer.vue?vue&type=style&index=0&id=6a49fb58&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-6a49fb58\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n    class: \"main-content-wrapper\",\n    ref: \"mainContentWrapper\"\n};\nimport { combinedNarrative } from './store/getters';\nimport FormattedTextRenderer from './components/common/FormattedTextRenderer.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'MainView',\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createVNode(FormattedTextRenderer, { text: _unref(combinedNarrative) }, null, 8 /* PROPS */, [\"text\"])\n            ], 512 /* NEED_PATCH */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./MainView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MainView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MainView.vue?vue&type=style&index=0&id=6c66b638&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__","/* unplugin-vue-components disabled */import script from \"./DockManager.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DockManager.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./DockManager.vue?vue&type=style&index=0&id=e1139430&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nimport { onMounted, onBeforeUnmount, ref } from 'vue';\nimport { dockManagerService } from '../services/DockManagerService';\nimport { panelRegistry } from '../services/usePanelManager';\nimport MainView from '../MainView.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'DockManager',\n    setup(__props) {\n        const dockHost = ref(null);\n        onMounted(() => {\n            if (dockHost.value) {\n                dockManagerService.initialize(dockHost.value);\n                // Register all components from the panel registry\n                for (const world in panelRegistry) {\n                    for (const panel in panelRegistry[world]) {\n                        const panelInfo = panelRegistry[world][panel];\n                        const componentName = `${world}-${panel}`;\n                        dockManagerService.registerComponent(componentName, panelInfo.component);\n                    }\n                }\n                // Register the main view separately\n                dockManagerService.registerComponent('main-view', MainView);\n                // Load layout (now that all components are registered)\n                dockManagerService.loadSavedLayout();\n            }\n        });\n        onBeforeUnmount(() => {\n            dockManagerService.destroy();\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n                ref_key: \"dockHost\",\n                ref: dockHost,\n                class: \"dock-manager-host\"\n            }, null, 512 /* NEED_PATCH */));\n        };\n    }\n});\n","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeStyle as _normalizeStyle, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = { class: \"loading-overlay\" };\nconst _hoisted_2 = { class: \"loading-content\" };\nconst _hoisted_3 = {\n    key: 0,\n    class: \"error-container\"\n};\nconst _hoisted_4 = { class: \"error-message\" };\nconst _hoisted_5 = { key: 1 };\nconst _hoisted_6 = { class: \"tip\" };\nconst _hoisted_7 = { class: \"progress-bar-container\" };\nconst _hoisted_8 = { class: \"progress-text\" };\nimport { onMounted, onUnmounted, ref, watch } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'LoadingIndicator',\n    props: {\n        error: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const tips = [\n            '',\n            '',\n            '',\n            '',\n            'NPC',\n            '',\n            '',\n            '',\n        ];\n        const randomTip = ref('');\n        const progress = ref(0);\n        let progressInterval = null;\n        onMounted(() => {\n            if (!props.error) {\n                startProgress();\n            }\n        });\n        onUnmounted(() => {\n            stopProgress();\n        });\n        watch(() => props.error, newError => {\n            if (newError) {\n                stopProgress();\n            }\n        });\n        function startProgress() {\n            // \n            randomTip.value = tips[Math.floor(Math.random() * tips.length)];\n            // \n            progress.value = 0;\n            progressInterval = window.setInterval(() => {\n                if (progress.value < 99) {\n                    progress.value += 1;\n                }\n                else {\n                    stopProgress();\n                }\n            }, 90000 / 99); // 90 seconds for 99%\n        }\n        function stopProgress() {\n            if (progressInterval) {\n                clearInterval(progressInterval);\n                progressInterval = null;\n            }\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    (__props.error)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                            _cache[0] || (_cache[0] = _createElementVNode(\"h3\", { class: \"error-title\" }, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"p\", _hoisted_4, _toDisplayString(__props.error), 1 /* TEXT */),\n                            _cache[1] || (_cache[1] = _createElementVNode(\"p\", { class: \"error-tip\" }, \"\", -1 /* CACHED */))\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n                            _createElementVNode(\"p\", _hoisted_6, _toDisplayString(randomTip.value), 1 /* TEXT */),\n                            _createElementVNode(\"div\", _hoisted_7, [\n                                _createElementVNode(\"div\", {\n                                    class: \"progress-bar\",\n                                    style: _normalizeStyle({ width: progress.value + '%' })\n                                }, null, 4 /* STYLE */)\n                            ]),\n                            _createElementVNode(\"span\", _hoisted_8, [\n                                _cache[2] || (_cache[2] = _createElementVNode(\"span\", { class: \"highlight\" }, \"\", -1 /* CACHED */)),\n                                _createTextVNode(\"... \" + _toDisplayString(Math.floor(progress.value)) + \"%\", 1 /* TEXT */)\n                            ])\n                        ]))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./LoadingIndicator.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./LoadingIndicator.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./LoadingIndicator.vue?vue&type=style&index=0&id=6ae2bf70&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-6ae2bf70\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode } from \"vue\";\nconst _hoisted_1 = { class: \"npc-list-modal-content\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"npc-list-container\"\n};\nconst _hoisted_3 = { class: \"npc-list\" };\nconst _hoisted_4 = { class: \"npc-header\" };\nconst _hoisted_5 = { class: \"npc-name\" };\nconst _hoisted_6 = { class: \"npc-identity\" };\nconst _hoisted_7 = { class: \"npc-description\" };\nconst _hoisted_8 = {\n    key: 1,\n    class: \"no-npcs\"\n};\nimport { computed } from 'vue';\nimport { npcService } from '../../services/NpcService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcListModal',\n    props: {\n        worldId: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const npcs = computed(() => {\n            return npcService.getNpcsByWorld(props.worldId);\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (npcs.value.length > 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _createElementVNode(\"ul\", _hoisted_3, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(npcs.value, (npc) => {\n                                return (_openBlock(), _createElementBlock(\"li\", {\n                                    key: npc.[0],\n                                    class: \"npc-item\"\n                                }, [\n                                    _createElementVNode(\"div\", _hoisted_4, [\n                                        _createElementVNode(\"span\", _hoisted_5, _toDisplayString(npc.[0]), 1 /* TEXT */),\n                                        _createElementVNode(\"span\", _hoisted_6, _toDisplayString(npc..join(', ')), 1 /* TEXT */)\n                                    ]),\n                                    _createElementVNode(\"p\", _hoisted_7, _toDisplayString(npc.), 1 /* TEXT */)\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ])\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [...(_cache[0] || (_cache[0] = [\n                            _createElementVNode(\"p\", null, \"NPC\", -1 /* CACHED */)\n                        ]))]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcListModal.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcListModal.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcListModal.vue?vue&type=style&index=0&id=ff267540&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-ff267540\"]])\n\nexport default __exports__","const __WEBPACK_NAMESPACE_OBJECT__ = $;","import $ from 'jquery';\nimport screenfull from 'screenfull';\n\nlet originalStyles: { [selector: string]: { [key: string]: string } } = {};\n\n// ---  (Browser Fullscreen) ---\n\nfunction toggleBrowserFullscreen() {\n  if (screenfull.isEnabled) {\n    screenfull.toggle();\n  } else {\n    console.warn('');\n  }\n}\n\nfunction onBrowserFullscreenChange(callback: (isFullscreen: boolean) => void) {\n  if (screenfull.isEnabled) {\n    screenfull.on('change', () => {\n      callback(screenfull.isFullscreen);\n    });\n  }\n}\n\n// ---  (Web Fullscreen) ---\n\nfunction getIframeSelector(): string | null {\n  const iframes = parent.document.getElementsByTagName('iframe');\n  for (let i = 0; i < iframes.length; i++) {\n    if (iframes[i].contentWindow === window) {\n      const iframe = iframes[i];\n      if (iframe.id) {\n        return `#${iframe.id}`;\n      }\n      const src = iframe.getAttribute('src');\n      if (src) {\n        const srcFileName = src.split('/').pop();\n        if (srcFileName) {\n          return `iframe[src*=\"${srcFileName}\"]`;\n        }\n      }\n      return null;\n    }\n  }\n  return null;\n}\n\nfunction enterWebFullscreen() {\n  const iframeSelector = getIframeSelector();\n  if (!iframeSelector) {\n    console.warn(' iframe');\n    return;\n  }\n\n  const elementsToModify: { [key: string]: JQuery.PlainObject } = {\n    [iframeSelector]: {\n      position: 'fixed',\n      top: '0',\n      left: '0',\n      width: '100vw',\n      height: '100vh',\n      zIndex: '99999',\n      border: 'none',\n      borderRadius: '0',\n    },\n    '#top-settings-holder': { display: 'none' },\n    '#form_sheld > :not(#chat)': { display: 'none' },\n    '#top-bar': { display: 'none' },\n    '#chat': { height: '100vh', maxHeight: '100vh' },\n    '#chat_fullscreen_button': { display: 'none' },\n  };\n\n  originalStyles = {};\n  for (const selector in elementsToModify) {\n    const $element = $(selector, parent.document);\n    if ($element.length > 0) {\n      originalStyles[selector] = {};\n      const newStyles = elementsToModify[selector as keyof typeof elementsToModify];\n      for (const prop in newStyles) {\n        originalStyles[selector][prop] = $element.css(prop);\n      }\n      $element.css(newStyles);\n    }\n  }\n  $(parent.document.documentElement).addClass('web-fullscreen-active');\n  $(parent.document.body).addClass('web-fullscreen-active');\n}\n\nfunction exitWebFullscreen() {\n  for (const selector in originalStyles) {\n    const $element = $(selector, parent.document);\n    if ($element.length > 0) {\n      $element.css(originalStyles[selector]);\n    }\n  }\n  originalStyles = {};\n  $(parent.document.documentElement).removeClass('web-fullscreen-active');\n  $(parent.document.body).removeClass('web-fullscreen-active');\n}\n\nexport const fullscreenService = {\n  // \n  enterWeb: enterWebFullscreen,\n  exitWeb: exitWebFullscreen,\n  // \n  toggleBrowser: toggleBrowserFullscreen,\n  onBrowserChange: onBrowserFullscreenChange,\n  get isBrowserFullscreen() {\n    return screenfull.isEnabled && screenfull.isFullscreen;\n  },\n};\n","import { reactive, markRaw } from 'vue';\nimport NpcListModal from '../components/modals/NpcListModal.vue';\n\ninterface NpcModalState {\n  isVisible: boolean;\n  title: string;\n  props: { worldId: string };\n}\n\nconst state = reactive<NpcModalState>({\n  isVisible: false,\n  title: '',\n  props: { worldId: '' },\n});\n\nconst show = (worldId: string) => {\n  state.title = 'NPC ';\n  state.props = { worldId };\n  //  DetailModalService \n  // state.component = markRaw(NpcListModal);\n  state.isVisible = true;\n};\n\nconst hide = () => {\n  state.isVisible = false;\n};\n\nexport const npcModalService = {\n  state,\n  show,\n  hide,\n};\n","import { reactive, readonly } from 'vue';\nimport { confirmationService } from '../services/ConfirmationService';\nimport { detailModalService } from '../services/DetailModalService';\nimport { dockManagerService } from '../services/DockManagerService';\nimport { fullscreenService } from '../services/fullscreenService';\nimport { inputModalActions } from '../services/InputModalService';\nimport { npcModalService } from '../services/NpcModalService';\n\n//  UI \ninterface UiState {\n  isWebFullscreen: boolean;\n  isBrowserFullscreen: boolean;\n}\n\n// \nconst state = reactive<UiState>({\n  isWebFullscreen: false,\n  isBrowserFullscreen: false,\n});\n\n// \nfullscreenService.onBrowserChange(isFullscreen => {\n  // Check if we are transitioning from fullscreen to not-fullscreen\n  if (state.isBrowserFullscreen && !isFullscreen) {\n    // Use Tavern's built-in refresh mechanism instead of a hard reload\n    TavernHelper.setChatMessages([], { refresh: 'all' });\n  }\n  state.isBrowserFullscreen = isFullscreen;\n});\n\n//  actions\nconst actions = {\n  /**\n   * \n   */\n  toggleBrowserFullscreen(): void {\n    // \n    dockManagerService.closeAllPanels();\n    confirmationService.hide();\n    detailModalService.hide();\n    npcModalService.hide();\n    inputModalActions.hide();\n\n    fullscreenService.toggleBrowser();\n  },\n\n  /**\n   * \n   */\n  toggleWebFullscreen(): void {\n    if (state.isWebFullscreen) {\n      fullscreenService.exitWeb();\n      state.isWebFullscreen = false;\n    } else {\n      fullscreenService.enterWeb();\n      state.isWebFullscreen = true;\n    }\n  },\n\n  /**\n   * \n   */\n  unpinAllPanels(): void {\n    dockManagerService.unpinAllPanels();\n  },\n};\n\n//  actions\nexport const uiState = readonly(state);\nexport const uiActions = actions;\n","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"world-time-display\" };\nconst _hoisted_2 = { class: \"world-name\" };\nconst _hoisted_3 = { class: \"time-string\" };\nimport { computed, toRefs } from 'vue';\nimport { timeStr as avatarTimeStr, mainWorldTimeStr } from '../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'WorldTimeDisplay',\n    props: {\n        worldType: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const { worldType } = toRefs(props);\n        const worldName = computed(() => {\n            return worldType.value === 'main' ? '' : '';\n        });\n        const timeString = computed(() => {\n            return worldType.value === 'main' ? mainWorldTimeStr.value : avatarTimeStr.value;\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"span\", _hoisted_2, _toDisplayString(worldName.value), 1 /* TEXT */),\n                _createElementVNode(\"span\", _hoisted_3, _toDisplayString(timeString.value), 1 /* TEXT */)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./WorldTimeDisplay.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./WorldTimeDisplay.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./WorldTimeDisplay.vue?vue&type=style&index=0&id=668f333f&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-668f333f\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createVNode as _createVNode, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"top-status\" };\nconst _hoisted_2 = { class: \"status-left\" };\nconst _hoisted_3 = { class: \"status-center\" };\nconst _hoisted_4 = [\"title\"];\nconst _hoisted_5 = { class: \"status-right\" };\nimport { computed } from 'vue';\nimport { uiState, uiActions } from '../store/ui';\nimport { usePanelManager } from '../services/usePanelManager';\nimport WorldTimeDisplay from './WorldTimeDisplay.vue';\nimport { inputModalActions } from '../services/InputModalService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'TopStatusBar',\n    setup(__props) {\n        const isBrowserFullscreen = computed(() => uiState.isBrowserFullscreen);\n        const { openPanel } = usePanelManager();\n        const toggleFullscreen = () => {\n            uiActions.toggleBrowserFullscreen();\n            uiActions.toggleWebFullscreen(); // \n        };\n        const openSaveLoadPanel = () => {\n            openPanel('system', 'saveLoad');\n        };\n        const openInputModal = () => {\n            inputModalActions.show();\n        };\n        const fullscreenTitle = computed(() => {\n            return isBrowserFullscreen.value ? '' : '';\n        });\n        const fullscreenIcon = computed(() => {\n            return isBrowserFullscreen.value ? 'fas fa-compress' : 'fas fa-expand';\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createVNode(WorldTimeDisplay, { \"world-type\": \"main\" })\n                ]),\n                _createElementVNode(\"div\", _hoisted_3, [\n                    _createElementVNode(\"button\", {\n                        onClick: openSaveLoadPanel,\n                        class: \"view-toggle-btn\",\n                        title: \"\"\n                    }, [...(_cache[0] || (_cache[0] = [\n                            _createElementVNode(\"i\", { class: \"fas fa-cog\" }, null, -1 /* CACHED */)\n                        ]))]),\n                    _createElementVNode(\"button\", {\n                        onClick: openInputModal,\n                        class: \"view-toggle-btn\",\n                        title: \"\"\n                    }, [...(_cache[1] || (_cache[1] = [\n                            _createElementVNode(\"i\", { class: \"fas fa-keyboard\" }, null, -1 /* CACHED */)\n                        ]))]),\n                    _createElementVNode(\"button\", {\n                        onClick: toggleFullscreen,\n                        class: \"view-toggle-btn\",\n                        title: fullscreenTitle.value\n                    }, [\n                        _createElementVNode(\"i\", {\n                            class: _normalizeClass(fullscreenIcon.value)\n                        }, null, 2 /* CLASS */)\n                    ], 8 /* PROPS */, _hoisted_4)\n                ]),\n                _createElementVNode(\"div\", _hoisted_5, [\n                    _createVNode(WorldTimeDisplay, { \"world-type\": \"avatar\" })\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./TopStatusBar.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./TopStatusBar.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./TopStatusBar.vue?vue&type=style&index=0&id=0fd538fe&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-0fd538fe\"]])\n\nexport default __exports__","import { computed, defineComponent, onMounted, reactive, ref } from 'vue';\nimport ActionPanel from './components/common/ActionPanel.vue';\nimport EnhancedInputBox from './components/common/EnhancedInputBox.vue';\nimport InputHistoryPopup from './components/common/InputHistoryPopup.vue';\nimport NotificationContainer from './components/common/NotificationContainer.vue';\nimport RadialMenu from './components/controls/RadialMenu.vue';\nimport SideMenuButton from './components/controls/SideMenuButton.vue';\nimport DockManager from './components/DockManager.vue';\nimport LoadingIndicator from './components/LoadingIndicator.vue';\nimport NpcListModal from './components/modals/NpcListModal.vue';\nimport TopStatusBar from './components/TopStatusBar.vue';\nimport WorldTimeDisplay from './components/WorldTimeDisplay.vue';\nimport MainView from './MainView.vue';\nimport { commandService } from './services/CommandService';\nimport { confirmationService } from './services/ConfirmationService';\nimport { detailModalService } from './services/DetailModalService';\nimport { dockManagerService } from './services/DockManagerService';\nimport { inputModalActions, inputModalState } from './services/InputModalService';\nimport { npcModalService } from './services/NpcModalService';\nimport { saveLoadService } from './services/saveLoadService';\nimport { usePanelManager } from './services/usePanelManager';\nimport { actions, store } from './store';\nimport { isSimulationRunning } from './store/getters';\nimport { uiActions, uiState } from './store/ui';\nexport default defineComponent({\n    name: 'App',\n    components: {\n        DockManager,\n        EnhancedInputBox,\n        LoadingIndicator,\n        MainView,\n        NpcListModal,\n        TopStatusBar,\n        WorldTimeDisplay,\n        SideMenuButton,\n        RadialMenu,\n        NotificationContainer,\n        ActionPanel,\n        InputHistoryPopup,\n    },\n    setup() {\n        const { openPanel } = usePanelManager();\n        const confirmation = computed(() => confirmationService.state);\n        const detailModal = computed(() => detailModalService.state);\n        const npcModal = computed(() => npcModalService.state);\n        const isWebFullscreen = computed(() => uiState.isWebFullscreen);\n        const inputModal = computed(() => inputModalState);\n        const isActionPanelVisible = ref(false);\n        const isHistoryVisible = ref(false);\n        const isQueueVisible = ref(false);\n        const commands = ref([]);\n        const commandCount = computed(() => commands.value.length);\n        const radialMenu = reactive({\n            isVisible: false,\n            options: [],\n        });\n        const menuOptions = {\n            left: [\n                { id: 'character', icon: '', text: '', action: () => openPanel('mainWorld', 'character') },\n                { id: 'inventory', icon: '', text: '', action: () => openPanel('mainWorld', 'inventory') },\n                { id: 'skills', icon: '', text: '', action: () => openPanel('mainWorld', 'skills') },\n                { id: 'imprints', icon: '', text: '', action: () => openPanel('mainWorld', 'imprints') },\n                { id: 'worldDetails', icon: '', text: '', action: () => openPanel('mainWorld', 'worldDetails') },\n                { id: 'sandbox', icon: '', text: '', action: () => openPanel('mainWorld', 'sandbox') },\n                { id: 'reincarnation', icon: '', text: '', action: () => openPanel('reincarnation', 'main') },\n                { id: 'unpin', icon: '', text: '', action: () => uiActions.unpinAllPanels() },\n            ],\n            right: [\n                {\n                    id: 'character',\n                    icon: '',\n                    text: '',\n                    action: () => openPanel('avatarWorld', 'character'),\n                    disabled: () => !isSimulationRunning.value,\n                },\n                {\n                    id: 'inventory',\n                    icon: '',\n                    text: '',\n                    action: () => openPanel('avatarWorld', 'inventory'),\n                    disabled: () => !isSimulationRunning.value,\n                },\n                {\n                    id: 'tasks',\n                    icon: '',\n                    text: '',\n                    action: () => openPanel('avatarWorld', 'tasks'),\n                    disabled: () => !isSimulationRunning.value,\n                },\n                {\n                    id: 'worldDetails',\n                    icon: '',\n                    text: '',\n                    action: () => openPanel('avatarWorld', 'worldDetails'),\n                    disabled: () => !isSimulationRunning.value,\n                },\n                {\n                    id: 'sandbox',\n                    icon: '',\n                    text: '',\n                    action: () => openPanel('avatarWorld', 'sandbox'),\n                    disabled: () => !isSimulationRunning.value,\n                },\n                { id: 'npcDirectory', icon: '', text: '', action: () => openPanel('allWorlds', 'npcDirectory') },\n                { id: 'unpin', icon: '', text: '', action: () => uiActions.unpinAllPanels() },\n            ],\n        };\n        const handleOverlayClick = () => {\n            if (radialMenu.isVisible) {\n                closeRadialMenu();\n                return;\n            }\n            if (inputModal.value.isVisible) {\n                inputModalActions.hide();\n                return;\n            }\n        };\n        const openRadialMenu = (side) => {\n            radialMenu.options = menuOptions[side];\n            radialMenu.isVisible = true;\n        };\n        const closeRadialMenu = () => {\n            radialMenu.isVisible = false;\n        };\n        const handleAction = async (actionContent) => {\n            console.log('Submitting to AI:', actionContent);\n            await actions.handleAction(actionContent);\n            await saveLoadService.performAutoSave();\n        };\n        const handleSubmit = async (actionContent) => {\n            // Correctly save the raw input value before it gets cleared.\n            const rawInput = inputModal.value.inputValue;\n            inputModalActions.setLastSubmittedValue(rawInput);\n            await handleAction(actionContent);\n            inputModalActions.hide();\n            inputModalActions.clearValue();\n        };\n        const toggleActionPanel = () => {\n            isActionPanelVisible.value = !isActionPanelVisible.value;\n        };\n        const updateCommands = () => {\n            commands.value = commandService.getCommands();\n        };\n        const clearCommands = () => {\n            commandService.clearCommands();\n        };\n        const toggleHistory = () => {\n            isHistoryVisible.value = !isHistoryVisible.value;\n            if (isHistoryVisible.value)\n                isQueueVisible.value = false;\n        };\n        const toggleCommandQueue = () => {\n            isQueueVisible.value = !isQueueVisible.value;\n            if (isQueueVisible.value)\n                isHistoryVisible.value = false;\n        };\n        const selectHistoryEntry = (entry) => {\n            inputModalActions.setValue(entry);\n            isHistoryVisible.value = false;\n        };\n        onMounted(() => {\n            actions.loadAllData();\n            actions.initializeEventListeners();\n            dockManagerService.onAction = handleAction;\n            commandService.subscribe(updateCommands);\n            updateCommands();\n        });\n        return {\n            confirmation,\n            detailModal,\n            npcModal,\n            isWebFullscreen,\n            inputModal,\n            inputModalActions,\n            radialMenu,\n            openRadialMenu,\n            closeRadialMenu,\n            handleAction,\n            handleSubmit,\n            handleOverlayClick,\n            store,\n            confirmationService,\n            detailModalService,\n            npcModalService,\n            isActionPanelVisible,\n            toggleActionPanel,\n            isHistoryVisible,\n            toggleHistory,\n            selectHistoryEntry,\n            isQueueVisible,\n            toggleCommandQueue,\n            commands,\n            commandCount,\n            clearCommands,\n        };\n    },\n});\n","/* unplugin-vue-components disabled */import { render } from \"./app.vue?vue&type=template&id=40d5bcb5&ts=true\"\nimport script from \"./app.vue?vue&type=script&lang=ts\"\nexport * from \"./app.vue?vue&type=script&lang=ts\"\n\nimport \"./app.vue?vue&type=style&index=0&id=40d5bcb5&lang=scss\"\n\nimport exportComponent from \"../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"attribute-item\" };\nconst _hoisted_2 = { class: \"attribute-name\" };\nconst _hoisted_3 = { class: \"attribute-value\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'AttributeDisplay',\n    props: {\n        name: {},\n        value: {}\n    },\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"span\", _hoisted_2, _toDisplayString(__props.name), 1 /* TEXT */),\n                _createElementVNode(\"span\", _hoisted_3, _toDisplayString(__props.value), 1 /* TEXT */)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./AttributeDisplay.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AttributeDisplay.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./AttributeDisplay.vue?vue&type=style&index=0&id=490ee3ff&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-490ee3ff\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createBlock as _createBlock, createVNode as _createVNode, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = { class: \"character-panel\" };\nconst _hoisted_2 = { class: \"panel-section\" };\nconst _hoisted_3 = {\n    id: \"base-attributes-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_4 = { class: \"panel-section\" };\nconst _hoisted_5 = {\n    id: \"secondary-attributes-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_6 = { class: \"panel-section\" };\nconst _hoisted_7 = {\n    id: \"grades-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_8 = { class: \"panel-section\" };\nconst _hoisted_9 = {\n    id: \"skills-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_10 = { class: \"panel-section\" };\nconst _hoisted_11 = {\n    id: \"talents-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_12 = { class: \"panel-section\" };\nconst _hoisted_13 = {\n    id: \"schedule-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_14 = { class: \"panel-section\" };\nconst _hoisted_15 = {\n    id: \"relations-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_16 = { class: \"attribute-name\" };\nconst _hoisted_17 = { class: \"attribute-value\" };\nimport { getters } from '../store';\nimport AttributeDisplay from '../components/AttributeDisplay.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'CharacterView',\n    setup(__props) {\n        const { character, secondaryAttributes, todayCourses, getBaseAttributes, getSubjects, getSkills, getTalents, getRelationships, } = getters;\n        const baseAttributes = getBaseAttributes(character);\n        const subjects = getSubjects(character);\n        const skills = getSkills(character);\n        const talents = getters.getTalents(character);\n        const relationships = getRelationships(character);\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(baseAttributes).value, (attr, key) => {\n                            return (_openBlock(), _createBlock(AttributeDisplay, {\n                                key: key,\n                                name: String(key),\n                                value: `${attr.} / ${attr.}`\n                            }, null, 8 /* PROPS */, [\"name\", \"value\"]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    _cache[1] || (_cache[1] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_5, [\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: ` ${_unref(secondaryAttributes).}`\n                        }, null, 8 /* PROPS */, [\"value\"]),\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: _unref(secondaryAttributes).\n                        }, null, 8 /* PROPS */, [\"value\"])\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_6, [\n                    _cache[2] || (_cache[2] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_7, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(subjects).value, (subject, key) => {\n                            return (_openBlock(), _createBlock(AttributeDisplay, {\n                                key: key,\n                                name: String(key),\n                                value: `${subject.} (${subject.})`\n                            }, null, 8 /* PROPS */, [\"name\", \"value\"]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_8, [\n                    _cache[3] || (_cache[3] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_9, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(skills).value, (skill, key) => {\n                            return (_openBlock(), _createBlock(AttributeDisplay, {\n                                key: key,\n                                name: String(key),\n                                value: `Lv.${skill.} / ${skill.}`\n                            }, null, 8 /* PROPS */, [\"name\", \"value\"]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_10, [\n                    _cache[4] || (_cache[4] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_11, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(talents), (talent, index) => {\n                            return (_openBlock(), _createBlock(AttributeDisplay, {\n                                key: index,\n                                name: talent.,\n                                value: talent.\n                            }, null, 8 /* PROPS */, [\"name\", \"value\"]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_12, [\n                    _cache[5] || (_cache[5] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_13, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(todayCourses), (course, index) => {\n                            return (_openBlock(), _createBlock(AttributeDisplay, {\n                                key: index,\n                                name: course.,\n                                value: course.\n                            }, null, 8 /* PROPS */, [\"name\", \"value\"]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_14, [\n                    _cache[6] || (_cache[6] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_15, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(relationships).value, (rel, name) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: name,\n                                class: \"attribute-item\"\n                            }, [\n                                _createElementVNode(\"span\", _hoisted_16, _toDisplayString(name), 1 /* TEXT */),\n                                _createElementVNode(\"span\", _hoisted_17, \" :\" + _toDisplayString(rel.) + \" :\" + _toDisplayString(rel.), 1 /* TEXT */)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./CharacterView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CharacterView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./CharacterView.vue?vue&type=style&index=0&id=3e931026&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3e931026\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = { class: \"inventory-panel\" };\nconst _hoisted_2 = { class: \"panel-section\" };\nconst _hoisted_3 = { class: \"inventory-grid\" };\nconst _hoisted_4 = { class: \"item-name\" };\nconst _hoisted_5 = { class: \"item-quantity\" };\nimport { ref, onMounted } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'InventoryView',\n    setup(__props) {\n        const inventory = ref([]);\n        onMounted(() => {\n            // Mock data for display purposes\n            inventory.value = [\n                { id: 'food001', name: 'A', quantity: 1 },\n                { id: 'snack002', name: 'Pocky', quantity: 3 },\n                { id: 'study001', name: '', quantity: 1 },\n            ];\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(inventory.value, (item) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: item.id,\n                                class: \"inventory-item\"\n                            }, [\n                                _createElementVNode(\"div\", _hoisted_4, _toDisplayString(item.name), 1 /* TEXT */),\n                                _createElementVNode(\"div\", _hoisted_5, \"x\" + _toDisplayString(item.quantity), 1 /* TEXT */)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./InventoryView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./InventoryView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./InventoryView.vue?vue&type=style&index=0&id=fbf176e0&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-fbf176e0\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createVNode as _createVNode, createCommentVNode as _createCommentVNode, normalizeStyle as _normalizeStyle, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"main-content-view\" };\nconst _hoisted_2 = [\"innerHTML\"];\nconst _hoisted_3 = [\"innerHTML\"];\nimport { computed, reactive } from 'vue';\nimport EnhancedInputBox from '../components/common/EnhancedInputBox.vue';\nimport { combinedNarrative, getItemByName, getNpcByName } from '../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'MainContentView',\n    emits: ['submit-action'],\n    setup(__props, { emit: __emit }) {\n        const emit = __emit;\n        const tooltip = reactive({\n            visible: false,\n            content: '',\n            style: {\n                top: '0px',\n                left: '0px',\n            },\n        });\n        const processedNarrative = computed(() => {\n            let text = combinedNarrative.value;\n            // Regex to find <item name=\"...\">...</item> and <npc name=\"...\">...</npc>\n            const itemRegex = /<item name=\"([^\"]+)\">(.+?)<\\/item>/g;\n            const npcRegex = /<npc name=\"([^\"]+)\">(.+?)<\\/npc>/g;\n            text = text.replace(itemRegex, (match, name, content) => {\n                return `<span class=\"highlighted-item\" data-type=\"item\" data-name=\"${name}\">${content}</span>`;\n            });\n            text = text.replace(npcRegex, (match, name, content) => {\n                return `<span class=\"highlighted-npc\" data-type=\"npc\" data-name=\"${name}\">${content}</span>`;\n            });\n            return text;\n        });\n        const handleMouseOver = (event) => {\n            const target = event.target;\n            const dataType = target.dataset.type;\n            const dataName = target.dataset.name;\n            if (!dataType || !dataName)\n                return;\n            let entity;\n            if (dataType === 'item') {\n                entity = getItemByName(dataName);\n            }\n            else if (dataType === 'npc') {\n                entity = getNpcByName(dataName);\n            }\n            if (entity) {\n                tooltip.content = formatTooltipContent(entity, dataType);\n                tooltip.style.top = `${event.clientY + 15}px`;\n                tooltip.style.left = `${event.clientX + 15}px`;\n                tooltip.visible = true;\n            }\n        };\n        const handleMouseOut = () => {\n            tooltip.visible = false;\n        };\n        const formatTooltipContent = (entity, type) => {\n            if (type === 'item') {\n                return `\n      <div class=\"tooltip-title\">${entity.} [${entity.}]</div>\n      <div class=\"tooltip-description\">${entity.}</div>\n      <div class=\"tooltip-level\">: ${entity.}</div>\n    `;\n            }\n            if (type === 'npc') {\n                return `\n      <div class=\"tooltip-title\">${entity.}</div>\n      <div class=\"tooltip-description\">${entity.}</div>\n      <div class=\"tooltip-identity\">: ${entity..join(', ')}</div>\n    `;\n            }\n            return '';\n        };\n        const handleSubmit = (action) => {\n            emit('submit-action', action);\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", {\n                    class: \"narrative-container\",\n                    innerHTML: processedNarrative.value,\n                    onMouseover: handleMouseOver,\n                    onMouseout: handleMouseOut\n                }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_2),\n                _createVNode(EnhancedInputBox, {\n                    placeholder: \"...\",\n                    onSubmitAction: handleSubmit\n                }),\n                _createCommentVNode(\" Tooltip \"),\n                (tooltip.visible)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 0,\n                        class: \"narrative-tooltip\",\n                        style: _normalizeStyle(tooltip.style),\n                        innerHTML: tooltip.content\n                    }, null, 12 /* STYLE, PROPS */, _hoisted_3))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./MainContentView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MainContentView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MainContentView.vue?vue&type=style&index=0&id=2caac21f&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-2caac21f\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = { class: \"npc-list-panel\" };\nconst _hoisted_2 = { class: \"panel-section\" };\nconst _hoisted_3 = { class: \"npc-list\" };\nconst _hoisted_4 = { class: \"npc-name\" };\nconst _hoisted_5 = { class: \"npc-relationship\" };\nimport { ref, onMounted } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcListView',\n    setup(__props) {\n        const npcs = ref([]);\n        onMounted(() => {\n            // Mock data for display purposes\n            // In a real scenario, you would fetch this from the game state\n            npcs.value = [\n                { id: 'yukinoshita_yukino', name: '', favorability: 55 },\n                { id: 'yuigahama_yui', name: '', favorability: 60 },\n            ];\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"section-title\" }, \"NPC \", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(npcs.value, (npc) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: npc.id,\n                                class: \"npc-item\"\n                            }, [\n                                _createElementVNode(\"div\", _hoisted_4, _toDisplayString(npc.name), 1 /* TEXT */),\n                                _createElementVNode(\"div\", _hoisted_5, \": \" + _toDisplayString(npc.favorability), 1 /* TEXT */)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcListView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcListView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcListView.vue?vue&type=style&index=0&id=cbe78d66&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-cbe78d66\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"world-state-panel\" };\nconst _hoisted_2 = { class: \"panel-section\" };\nconst _hoisted_3 = { class: \"state-list\" };\nimport { ref, onMounted, computed } from 'vue';\nimport AttributeDisplay from '../components/AttributeDisplay.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'WorldStateView',\n    setup(__props) {\n        const worldState = ref(null);\n        const currentTime = computed(() => {\n            if (!worldState.value)\n                return '';\n            const time = worldState.value.;\n            return `${time.}-${time.}-${time.} ${time.}:${time.} (${time.})`;\n        });\n        onMounted(() => {\n            // Mock data for display purposes\n            worldState.value = {\n                : {\n                    : 2024,\n                    : 9,\n                    : 1,\n                    : 8,\n                    : 0,\n                    : '',\n                },\n                : '',\n                : '',\n                : 22,\n                : 100,\n                : 'Y2K',\n            };\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: currentTime.value\n                        }, null, 8 /* PROPS */, [\"value\"]),\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: worldState.value?. || 'N/A'\n                        }, null, 8 /* PROPS */, [\"value\"]),\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: worldState.value?. || 'N/A'\n                        }, null, 8 /* PROPS */, [\"value\"]),\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: `${worldState.value?. || 'N/A'}C`\n                        }, null, 8 /* PROPS */, [\"value\"]),\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: worldState.value?. || 0\n                        }, null, 8 /* PROPS */, [\"value\"]),\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: worldState.value?. || 'N/A'\n                        }, null, 8 /* PROPS */, [\"value\"])\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","import { createApp } from 'vue';\nimport { createMemoryHistory, createRouter, RouteRecordRaw } from 'vue-router';\nimport App from '../app.vue';\nimport CharacterView from '../views/CharacterView.vue';\nimport InventoryView from '../views/InventoryView.vue';\nimport MainContentView from '../views/MainContentView.vue';\nimport NpcListView from '../views/NpcListView.vue';\nimport WorldStateView from '../views/WorldStateView.vue';\n\n// \nconst routes: RouteRecordRaw[] = [\n  { path: '/', component: MainContentView },\n  { path: '/character', component: CharacterView },\n  { path: '/npc-list', component: NpcListView },\n  { path: '/inventory', component: InventoryView },\n  { path: '/world-state', component: WorldStateView },\n];\n\nconst router = createRouter({\n  history: createMemoryHistory(),\n  routes,\n});\n\n// \nrouter.replace('/');\n\n$(() => {\n  $(() => {\n    createApp(App).use(router).mount('#app');\n  });\n});\n","/* unplugin-vue-components disabled */import script from \"./WorldStateView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./WorldStateView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./WorldStateView.vue?vue&type=style&index=0&id=1b7ec95a&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.25_typescript@6.0.0-dev.20250807__webpack@5.103.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1b7ec95a\"]])\n\nexport default __exports__","import './core/vue-loader';\nimport 'golden-layout/dist/css/goldenlayout-base.css';\nimport 'golden-layout/dist/css/themes/goldenlayout-dark-theme.css';\nimport './styles/main.scss';\nimport { saveLoadService } from './services/saveLoadService';\nimport { commandService } from './services/CommandService';\nimport { tavernService } from './services/tavern';\nimport { npcService } from './services/NpcService';\n\n// \nasync function initializeServices() {\n  await npcService.initializeWorldAndLocationData();\n  // \n}\n\nsaveLoadService;\ncommandService;\ntavernService;\n\ninitializeServices().then(() => {\n  console.log('All services initialized.');\n});\n\nconsole.log('Reincarnation Simulator UI loaded.');\n"],"names":["exports","sfc","props","target","__vccOpts","key","val","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","module","__webpack_modules__","n","getter","__esModule","d","a","definition","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","Vue","VueRouter","_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","__name","commandCount","emits","setup","__props","_ctx","_cache","onClick","$event","$emit","commandService","commands","listeners","subscribe","listener","this","push","unsubscribe","filter","l","notify","forEach","addCommand","command","getCommands","clearCommands","STORAGE_KEY_RECENT","STORAGE_KEY_SAVED","inputHistoryService","state","reactive","recent","saved","constructor","loadHistory","recentData","localStorage","getItem","savedData","JSON","parse","saveHistory","setItem","stringify","add","input","trim","existingIndex","indexOf","splice","unshift","length","pop","save","entry","includes","deleteRecent","index","deleteSaved","clearAll","_","processKeyValue","line","parent","indent","stack","separatorIndex","substring","valueStr","newChild","level","startsWith","endsWith","newObj","pairs","slice","split","map","p","pair","parseValue","trimmed","inner","content","parts","buffer","inQuotes","bracketLevel","i","char","part","e","toLowerCase","isNaN","Number","LOREBOOK_NAME","entriesCache","async","getEntries","forceRefresh","entries","TavernHelper","getLorebookEntries","console","error","readFromLorebook","entryName","find","comment","name","writeToLorebook","options","isEnabled","keys","log","allEntries","targetEntry","setLorebookEntries","uid","enabled","baseKey","replace","baseEntryTemplate","newEntryData","position","order","assign","selective","constant","case_sensitive","createLorebookEntries","lorebookService","appendToEntry","newContent","separator","existingContent","findEntryByComment","warn","setEntryEnabled","updatedEntry","loadAndParseWorldData","worldName","worldData","text","startIndex","lines","root","indentMatch","match","trimmedLine","parentObj","listItemContent","Array","isArray","grandParent","lastKey","newListItem","parseWorldLoreForMap","currentEpochId","firstPlayableEpoch","values","epoch","memoryService","INSTANT_MEMORY_KEY","SHORT_TERM_MEMORY_KEY","LONG_TERM_MEMORY_KEY","config","instantMemoryCount","shortTermMemoryCount","longTermMemoryCount","updateMemory","worldLog","updateInstantMemory","updateShortTermMemory","updateLongTermMemory","logs","writeMemory","join","getConfig","setConfig","newConfig","notifications","nextId","actions","show","title","message","type","duration","id","setTimeout","hide","findIndex","success","info","notificationState","notificationService","tavernService","fetchTavernData","messages","getChatMessages","getCurrentMessageId","generateAiResponse","prompt","generateConfig","injects","role","should_scan","should_stream","aiResponse","generate","Error","invokeMvuScript","script","oldVariables","inputData","old_variables","processedScript","creationLine","exec","charName","setLines","RegExp","lineMatch","userObjectString","eventEmit","new_variables","COT_FILES","NORMAL","CREATION","IDENTITY","workflowService","currentState","narrativeCache","updateScriptCache","preserveMode","switchTo","getCurrentState","newState","force","allCots","flat","cotsToEnable","cotName","shouldBeEnabled","cacheNarrative","narrative","popNarrative","cacheUpdateScript","popUpdateScript","setPreserveMode","mode","popPreservedContent","getIndent","findBlockEnd","findPathRange","path","pathParts","searchLines","overallOffset","lastFoundIndex","lastIndent","arrayMatch","foundInContext","arrayName","arrayNameRegex","arrayNameFound","currentIndent","test","blockEndIndex","itemFound","j","itemStartIndex","itemIndent","itemEndIndex","k","lineInItem","testLine","partRegex","endIndex","parentIndent","applyAdd","contentToAdd","range","contentLines","targetItemIndent","firstLineIndex","indentShift","newLines","originalIndent","newIndent","Math","max","repeat","trimStart","applyReplace","contentIndent","applyRemove","contentToRemove","contentToRemoveLines","blockToSearchIn","foundIndexInBlock","isMatch","removeStartIndex","worldUpdateService","applyModifications","modificationBlock","targetEntryName","currentContent","originalContent","instructions","s","instruction","trimmedInstruction","addMatch","replaceMatch","removeMatch","idMatch","updatedContent","z","nonEmptyString","string","min","MetaSchema","object","description","optional","extensible","boolean","EffectBonusSchema","record","union","coerce","number","EffectsSchema","attributes_bonus","percentage_bonus","TimeDurationSchema","prefault","DatabaseItemSchema","effects","array","ActiveSkillSchema","ID","ArtisanSkillSchema","RelationLayerSchema","GoalSchema","CharacterSchema","$meta","any","passthrough","and","catchall","nullable","WorldEpochSchema","extend","transform","num","parseInt","pipe","WorldSchema","WorldStateSchema","describe","parseSimpleYaml","result","nextLineIndex","newList","initialState","isReady","character","worldState","userId","mainWorldNarrative","avatarWorldNarrative","activeView","selectedWorldForReincarnation","reincarnationWorldOptions","reincarnationAvatarOptions","settlementData","newWorldsAvailable","isGenerating","generationError","getItemNameById","database","category","categoryStore","watch","newChar","oldChar","deep","playerCharacter","computed","currentAvatar","avatarId","simulator","reincarnationImprints","unlockedImprints","imprints","imprintId","playerSkills","playerArts","skills","artId","artData","artTemplate","levelSystem","currentLevelInfo","nextLevelInfo","associatedSkills","skillId","skillTemplate","exp","expToNextLevel","createInventoryGetter","characterRef","backpack","items","itemId","quantity","itemDetails","playerInventory","avatarInventory","playerWorldAttributes","activeEpoch","attributesData","templates","template","isSimulationRunning","simulatorCooldown","status","time","prep","mainWorld","worlds","worldId","avatarWorld","world","formatTime","defaultString","era","year","month","String","padStart","day","hour","minuteValue","mainWorldTimeStr","epochId","timeStr","calculateAge","birthDate","currentTime","age","combinedNarrative","ripples","nodes","edges","loreEntry","label","group","charId","isPlayer","potentials","potentialText","item","from","to","arrows","subjectId","subjectRelations","objectId","relationship","totalFavor","conflict","color","dashes","silentUpdater","timerId","isRunning","isUpdating","updateCallback","start","updateFn","interval","window","setInterval","runUpdate","stop","clearInterval","lastProcessedMessageId","isLogHistoryLoaded","checkForChangesAndNotify","oldState","oldInventory","newInventory","allItemIds","Set","oldQty","diff","itemName","action","abs","oldWeb","newWeb","allSubjects","oldRelations","newRelations","allObjects","oldCloseness","closenessDiff","subjectName","objectName","fetchCoreData","data","rawStateData","stat_data","fullMessageContent","currentMessageId","characters","characterIds","gameTextContent","summaryRegex","mainWorldSummaryRegex","avatarWorldSummaryRegex","formatWorldTime","Date","toLocaleString","hour12","processAndWriteSummary","toastrTitle","timestamp","existingSummaries","formattedSummary","summaryContent","worldTime","w","avatarOptionsMatch","xmlDoc","DOMParser","parseFromString","avatars","getElementsByTagName","el","textContent","newWorldRegex","worldLogRegex","processLogRegex","settlementRegex","mainWorldUpdateRegex","avatarWorldUpdateRegex","mainWorldContent","worldBlocks","b","block","nameMatch","automationRuleMatch","contentToWrite","existingEntry","newLog","existingLogs","parseBlock","newLogEntry","t","some","sort","latestLog","newLogContent","settlementContent","avatarWorldEntry","worldIdToLocation","location","sourceEntry","entryIdentifier","entryWorldId","syncWorldEntries","loadAllData","logContent","allLogs","parsed","uniqueLogs","seenIds","has","loadWorldLogFromLorebook","handleAction","actionText","aiResponseString","finalResponseString","response","prefixedInput","gameTextMatch","cachedNarrative","summaryMatch","updateScriptMatch","updateScript","patchedScript","cmd","Boolean","creationCommands","relationCommands","otherCommands","sortedScript","latestState","newVariables","processAiResponse","messageZero","setChatMessages","refresh","reload","errorMessage","isInitialized","prepareReincarnation","worldIdMatch","initializeEventListeners","eventOn","tavern_events","GENERATION_ENDED","fetchReincarnationWorlds","allWorlds","randomWorlds","random","clearSettlementData","triggerCreationWorkflow","currentNarrative","triggerIdentityWorkflow","sourceEntryName","selectAvatarAndStart","avatarName","setActiveView","view","switchFocus","targetWorld","targetName","addActionToQueue","resetReincarnationSelection","currentKey","STORAGE_KEY","LAST_SUBMITTED_STORAGE_KEY","isVisible","inputValue","lastSubmittedValue","setValue","setLastSubmittedValue","clearValue","removeItem","inputModalState","readonly","inputModalActions","placeholder","default","emit","__emit","onInput","event","submitAction","trimmedInput","hasCommands","combinedContent","onKeypress","historyState","useEntry","isSaved","disabled","notification","Notification","toRefs","centerOption","opt","regularOptions","menuStyle","getItemStyle","angle","PI","cos","sin","closeMenu","selectOption","option","handleCenterClick","style","icon","handleClick","x","clientX","y","clientY","dockManagerService","dockManager","hostElement","panelMap","Map","pinnedPanelState","onAction","DOCK_LAYOUT_STORAGE_KEY","PINNED_STATE_STORAGE_KEY","initialize","loadPinnedState","savedLayout","loadState","addLayoutListener","saveLayout","bind","addEventListener","resize","clientWidth","clientHeight","openPanel","panelId","component","existingDialog","document","body","contains","element","bringToFront","delete","panelHostDiv","createElement","width","height","overflow","vnode","h","render","newPanel","setTitle","dragListener","closest","stopPropagation","onClose","elementTitle","removeEventListener","pinnedState","dialogWidth","dialogHeight","hostWidth","hostHeight","dialog","floatDialog","addPinButton","set","updateLayout","panel","querySelector","insertAdjacentHTML","pinButton","isLocked","applyPinState","currentlyLocked","hostRect","getBoundingClientRect","panelRect","elementPanel","left","top","savePinnedState","classList","toggle","noDocking","resizable","layoutState","saveState","stateToSave","savedState","parsedState","closeAllPanels","elementContent","close","clear","unpinAllPanels","destroy","on","dispose","viewBox","_hoisted_20","defaultDescription","centerTitle","ref","centerDescription","getDisplayValue","defaultValue","characterData","innerRingNodes","combatParams","orbitalNodes","attrs","specialKeys","attrValue","isSpecial","valueKeys","current","every","setCenterContent","resetCenterContent","node","onMouseenter","onMouseleave","param","attr","cx","cy","formatAttribute","worldSpecificAttributes","combatAttributes","isDrawerOpen","DestinyPlate","_hoisted_21","selectedItem","closeDetail","avatarItems","tierColorMap","common","rare","epic","legendary","getTierStyle","tierKey","tier","fill","startOffset","destiny","allTasks","taskObject","ultimateTask","destinyNodes","task","derivedTasks","selectedNode","detailModalStyle","getTaskNameById","taskId","starPositions","positions","totalNodes","progress","starPaths","paths","startPos","endPos","parseFloat","lastNodePos","ultimatePos","parentNode","parentNodeIndex","parentPos","taskPos","getDerivedStarPosition","offsetX","floor","offsetY","selectNode","nodeData","currentTarget","starNode","startDrag","modal","startX","startY","startTop","offsetTop","startLeft","offsetLeft","doDrag","stopDrag","getStarPosition","x1","y1","x2","y2","offset","triggered","onMousedown","formatAttributeValue","daoHeart","worldAttributes","_directive_tooltip","detailModalService","markRaw","imprint","paddedImprints","empty","clickable","ImprintDetailModal","openImprintDetail","_hoisted_22","_hoisted_23","allItemsWithSeparators","sortedItems","typeOrder","lastType","isSeparator","categoryName","expandedSkills","isExpanded","skill","expanded","activeSkill","locationNameCache","allNpcs","userAndAvatarIds","npcService","getNpcsByWorld","npc","initializeWorldAndLocationData","worldInfoPromises","spatialEntities","entity","results","Promise","all","uniqueWorlds","getLocationName","getNpcNameById","getNpcId","calculated","formattedBirthDate","bd","v","tendencyKey","attributes","filteredAttributes","rest","formatValue","output","talents","talentDb","talentId","talentData","npcArts","artDb","skillsList","AttributeGrid","talent","displayValue","isBidirectional","fillStyle","right","backgroundColor","vectorGroups","vectors","relations","expandedRelation","getFormattedTags","relation","causeTags","tag","relationName","vector","ProgressBar","npcId","inventoryItems","InventoryGrid","RelationsDisplay","memory","activeTab","tabs","tab","active","NpcArchiveTab","NpcPowerTab","NpcCauseTab","FOLLOWED_NPCS_STORAGE_KEY","followedNpcs","useFollowSystem","isFollowed","toggleFollow","unfollow","follow","newSet","isFollowedState","watchEffect","followed","selectedWorldId","selectedNpc","selectedNpcId","isWorldListVisible","worldSearchTerm","npcSearchTerm","filteredWorlds","selectedWorldNpcs","npcs","locationId","locationName","filteredNpcs","onMounted","FollowButton","NpcDetailDisplay","remainingSeconds","intervalId","stopCountdown","newCooldown","totalSeconds","timeData","days","hours","minutes","dataToParse","dayIndex","hourIndex","minIndex","daysMatch","hoursMatch","minutesMatch","parseCooldownTime","immediate","cooldownService","remainingTime","seconds","formatRemainingTime","isCoolingDown","expandedLog","logId","ripplesService","loadRipples","rippleContent","rippleBlocks","parsedRipples","blockContent","blockData","rippleId","rawContent","getRippleById","selectedRipple","ripple","avatar","onConfirm","onCancel","hideCancel","confirmationService","resolve","confirm","cancel","choice","required","isSelected","selectCard","toastr","selectedChoice","choices","choicesObj","c","confirmChoice","mainCharacter","soulEssence","SettlementChoiceCard","onSelect","StarMapService","scene","camera","renderer","controls","container","stars","skybox","starObjects","speedMultiplier","antialias","alpha","init","domElement","enableDamping","dampingFactor","autoRotate","autoRotateSpeed","minDistance","maxDistance","enablePan","panSpeed","animate","setSize","setPixelRatio","devicePixelRatio","appendChild","onWindowResize","createSkybox","shaderMaterial","vertexShader","fragmentShader","uniforms","u_time","side","skyboxGeometry","getColorForEnergyLevel","createStars","selectableIds","coreGeometry","haloGeometry","phi","acos","theta","sqrt","isSelectable","energyLevel","timeFlow","baseColor","starColor","coreMaterial","core","haloMaterial","transparent","opacity","blending","halo","scale","starGroup","userData","orbitSpeed","log1p","orbitRadius","orbitAngle","atan2","requestAnimationFrame","material","star","update","aspect","updateProjectionMatrix","removeChild","pickStar","raycaster","mouse","rect","setFromCamera","intersects","intersectObjects","children","setSpeedMultiplier","multiplier","getSpeedMultiplier","starmapContainer","starMapService","isLoading","detailedWorld","selectableWorldIds","progressInterval","speedLevels","speedLevel","parsedWorlds","energyLevelMatch","timeFlowMatch","descriptionMatch","raw","cooldown","isDetailedWorldActive","selectRandomWorlds","ids","shuffled","handleCanvasClick","pickedWorld","newContainer","onUnmounted","newWorlds","wasRunning","adjustSpeed","delta","newLevel","ref_key","visible","closeSettlement","canSelectAvatar","hasSettlementData","newValue","WorldSelection","AvatarSelection","SettlementView","LogPanel","RipplesPanel","SettlementPanel","isAutoMemoryEnabled","memoryContent","instant","short","long","activeMemoryContent","fetchMemoryContent","updateConfig","forceUpdate","for","_hoisted_24","_hoisted_25","SAVE_SLOT_PREFIX","AUTO_SAVE_SLOTS","LOREBOOK_KEYS_TO_BACKUP","saveLoadService","manualSlots","autoSlots","turnCounter","isAutoSaveEnabled","autoSaveInterval","initializeSlots","loadAutoSaveState","loadTurnCounter","loadAllSaveSlots","updateSlot","slot","worldLogDate","worldLogTitle","entryUid","saveGame","slotId","isAutoSave","toISOString","lorebookBackup","lastLogEntry","saveData","mvu_data","message_content","lorebook_backup","loadGame","deleteSave","deleteLorebookEntries","performAutoSave","toString","exportSave","dataStr","dataBlob","Blob","url","URL","createObjectURL","link","href","download","click","revokeObjectURL","importSave","jsonContent","emptySlot","toggleAutoSave","savedCounter","defineComponent","fileInput","loadSlots","formatTimestamp","handleFileImport","files","file","reader","FileReader","onload","readAsText","slotToExport","$props","$setup","$data","$options","args","onChange","accept","SaveLoadPanel","MemoryPanel","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","worldType","worldSummary","availableEpochs","selectedEpochId","newWorld","definitions","innerHTML","school","colorService","colorCache","colorScale","simpleHash","str","hash","charCodeAt","getColor","coordinateService","baseAngleMap","parseAzimuth","azimuthValue","matches","baseDirection","offsetDegrees","baseAngle","normalizeDistance","distance","unit","getCartesianCoordinates","relativeCoord","azimuth","toUpperCase","theoreticalDistance","calculateRelativePositions","allDistances","child","distanceScale","domain","clamp","coord","isOverlapping","isVertical","visualDistance","worldMapDataService","hierarchyCache","getMapHierarchy","cacheKey","hierarchy","buildHierarchy","clearCache","entities","nodeMap","rootNodes","parentId","childCount","radius","currentRootId","navigationPath","isDetailPanelVisible","userLocationId","avatarLocationId","navigateToNode","crumb","navigateBack","targetId","targetIndex","hideDetail","setNavigationPath","setWorldData","setPlayerLocations","locations","user","mapState","mapActions","nodeId","associatedResources","resources","resource","associatedFactions","factionsSource","faction","panelRef","isDragging","onDragMove","moveEvent","dx","dy","onDragEnd","querySelectorAll","handle","direction","dataset","isResizing","startWidth","offsetWidth","startHeight","offsetHeight","onResizeMove","onResizeEnd","svgRef","fullHierarchy","layoutNodes","layoutLinks","searchText","isSearchPanelVisible","findNode","found","currentRootNode","allNodes","traverse","searchResults","jumpToNode","newNavPath","jumpToFirstResult","searchBtnRef","renderD3","links","clickTimers","svg","zoomContainer","selectAll","zoomContainerEnter","enter","append","g","merge","zoom","scaleExtent","transition","visualCenterNode","distances","exit","remove","source","nodeGroups","nodeEnter","brighter","existingTimeout","clearTimeout","newTimeout","newRoot","rootCopy","nodesToRender","nextTick","userLocation","avatarLocation","starFieldSize","select","btn","onMouseMove","parentElement","containerRect","onMouseUp","bottom","onmousedown","initDraggableSearchBtn","handleClickOutside","searchPanel","onActivated","onNavigateBack","MapNavigator","onNavigate","onKeyup","getFullPath","NodeDetailPanel","panelRegistry","CharacterPanel","inventory","InventoryPanel","SkillsPanel","ImprintsPanel","worldDetails","WorldDetailsPanel","sandbox","classed","mainNode","AvatarCharacterPanel","AvatarInventoryPanel","tasks","AvatarTasksPanel","AvatarWorldMapView","reincarnation","main","ReincarnationPanel","npcDirectory","NpcDirectoryPanel","detail","RippleDetailPanel","system","saveLoad","SystemPanel","usePanelManager","panelInfo","finalProps","segments","parsedSegments","remainingText","regex","matchedText","preMatchText","lastIndex","segment","FormattedTextRenderer","dockHost","componentName","registerComponent","MainView","loadSavedLayout","onBeforeUnmount","tips","randomTip","stopProgress","newError","$","originalStyles","fullscreenService","enterWeb","iframeSelector","iframes","contentWindow","iframe","src","getAttribute","srcFileName","getIframeSelector","elementsToModify","zIndex","border","borderRadius","display","maxHeight","selector","$element","newStyles","css","documentElement","addClass","exitWeb","removeClass","toggleBrowser","onBrowserChange","callback","isBrowserFullscreen","npcModalService","isWebFullscreen","isFullscreen","toggleBrowserFullscreen","toggleWebFullscreen","uiState","uiActions","timeString","toggleFullscreen","openSaveLoadPanel","openInputModal","fullscreenTitle","fullscreenIcon","WorldTimeDisplay","components","DockManager","EnhancedInputBox","LoadingIndicator","NpcListModal","TopStatusBar","SideMenuButton","RadialMenu","NotificationContainer","ActionPanel","InputHistoryPopup","confirmation","detailModal","npcModal","inputModal","isActionPanelVisible","isHistoryVisible","isQueueVisible","radialMenu","menuOptions","closeRadialMenu","actionContent","updateCommands","openRadialMenu","handleSubmit","rawInput","handleOverlayClick","store","toggleActionPanel","toggleHistory","selectHistoryEntry","toggleCommandQueue","_component_TopStatusBar","_component_MainView","_component_DockManager","_component_RadialMenu","_component_LoadingIndicator","_component_NpcListModal","_component_ActionPanel","_component_EnhancedInputBox","_component_InputHistoryPopup","_component_NotificationContainer","onOpenMainMenu","onOpenAvatarMenu","onToggleHistory","onToggleCommands","onSubmitAction","onToggleActionPanel","onSelectEntry","secondaryAttributes","todayCourses","getBaseAttributes","getSubjects","getSkills","getTalents","getRelationships","getters","baseAttributes","subjects","relationships","AttributeDisplay","subject","course","rel","tooltip","processedNarrative","handleMouseOver","dataType","dataName","getItemByName","getNpcByName","formatTooltipContent","handleMouseOut","onMouseover","onMouseout","favorability","routes","MainContentView","CharacterView","NpcListView","InventoryView","router","createRouter","history","createMemoryHistory","createApp","use","mount","initializeServices","then"],"ignoreList":[],"sourceRoot":""}