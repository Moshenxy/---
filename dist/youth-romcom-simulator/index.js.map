{"version":3,"file":"index.js","mappings":"26BAIAA,EAAQ,EAAU,CAACC,EAAKC,KACpB,MAAMC,EAASF,EAAIG,WAAaH,EAChC,IAAK,MAAOI,EAAKC,KAAQJ,EACrBC,EAAOE,GAAOC,EAElB,OAAOH,E,GCRPI,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAaV,QAGrB,IAAIY,EAASL,EAAyBE,GAAY,CAGjDT,QAAS,CAAC,GAOX,OAHAa,EAAoBJ,GAAUG,EAAQA,EAAOZ,QAASQ,GAG/CI,EAAOZ,OACf,CCrBAQ,EAAoBM,EAAKF,IACxB,IAAIG,EAASH,GAAUA,EAAOI,WAC7B,IAAOJ,EAAiB,QACxB,IAAM,EAEP,OADAJ,EAAoBS,EAAEF,EAAQ,CAAEG,EAAGH,IAC5BA,GCLRP,EAAoBS,EAAI,CAACjB,EAASmB,KACjC,IAAI,IAAId,KAAOc,EACXX,EAAoBY,EAAED,EAAYd,KAASG,EAAoBY,EAAEpB,EAASK,IAC5EgB,OAAOC,eAAetB,EAASK,EAAK,CAAEkB,YAAY,EAAMC,IAAKL,EAAWd,MCJ3EG,EAAoBY,EAAI,CAACK,EAAKC,IAAUL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,GCClFlB,EAAoBsB,EAAK9B,IACH,oBAAX+B,QAA0BA,OAAOC,aAC1CX,OAAOC,eAAetB,EAAS+B,OAAOC,YAAa,CAAEC,MAAO,WAE7DZ,OAAOC,eAAetB,EAAS,aAAc,CAAEiC,OAAO,K,0JCLvD,MAAM,EAA+BC,ICiC9B,MAAMC,EAAiB,IA/B9B,MACUC,SAAqB,GACrBC,UAA+B,GAEvC,SAAAC,CAAUC,GACRC,KAAKH,UAAUI,KAAKF,EACtB,CAEA,WAAAG,CAAYH,GACVC,KAAKH,UAAYG,KAAKH,UAAUM,OAAOC,GAAKA,IAAML,EACpD,CAEQ,MAAAM,GACNL,KAAKH,UAAUS,QAAQP,GAAYA,EAAS,IAAIC,KAAKJ,WACvD,CAEA,UAAAW,CAAWC,GACTR,KAAKJ,SAASK,KAAKO,GACnBR,KAAKK,QACP,CAEA,WAAAI,GACE,MAAO,IAAIT,KAAKJ,SAClB,CAEA,aAAAc,GACEV,KAAKJ,SAAW,GAChBI,KAAKK,QACP,GCyCK,MAAMM,EAAqB,IArDlC,MACUC,YAAc,IAAIC,IAClBC,UAAY,IAAID,IAChBE,eAAgB,EAKjB,gBAAMC,CAAWC,GACtB,GAAIjB,KAAKe,gBAAkBE,EAAY,OAEvCC,QAAQC,IAAI,6EACZnB,KAAKY,YAAYQ,QACjBpB,KAAKc,UAAUM,QAGf,MAAMC,EAAaJ,EAAW,KAC9B,IAAK,MAAMK,KAAUD,EAAY,CAC/B,MAAME,EAAOF,EAAWC,GACpBC,GAAwB,iBAATA,GAAqBA,EAAK,IAC3CvB,KAAKwB,UAAU,CACbC,GAAIH,EACJI,KAAMH,EAAK,GACXI,KAAM,aAGZ,CAKA3B,KAAKe,eAAgB,EACrBG,QAAQC,IAAI,6DAA6DnB,KAAKc,UAAUc,gBAC1F,CAEO,UAAAC,CAAWH,GAChB,OAAO1B,KAAKY,YAAY5B,IAAI0C,EAC9B,CAEO,QAAAI,CAASL,GACd,OAAOzB,KAAKc,UAAU9B,IAAIyC,EAC5B,CAEQ,SAAAD,CAAUO,GAChB,MAAMC,EAAiBhC,KAAKY,YAAY5B,IAAI+C,EAAOL,OAAS,GAC5D1B,KAAKY,YAAYqB,IAAIF,EAAOL,KAAM,IAAIM,EAAgBD,IAEjD/B,KAAKc,UAAUoB,IAAIH,EAAON,KAC7BzB,KAAKc,UAAUmB,IAAIF,EAAON,GAAIM,EAElC,GCpEI,EAA+BI,ECqf9B,MAAMC,EAAiB,IAje9B,MACS,iBAAAC,CACLC,EACArB,EACAsB,GAEA,MAAMC,EAAqB,CACzBC,WAAY,UACZC,iBAAkB,CAChBrB,WAAY,GACZsB,UAAW,GACXC,QAAS,IAEXC,iBAAkB,IAGpB,IAAK5B,EAAY,OAAOuB,EAGxB,MAAMM,EAAcjE,OAAOkE,OAAO9B,EAAW,IAAM,CAAC,GAAG+B,KAAKC,GAC1D,CAAC,MAAO,UAAUC,UAAS,IAAAlE,KAAIiE,EAAG,YAAa,MAE3CE,GAAW,IAAAnE,KAAIiC,EAAY,oBAC3BmC,EAAgBD,GAAW,IAAAnE,KAAI8D,EAAa,MAAMK,MAAc,IAAAnE,KAAIiC,EAAY,SAEtF,GAAImC,GAAiBN,EAAa,CAChC,MAAMO,EAAoBD,EAAc,KACxC,GAAIC,EAAmB,CACrBb,EAAOE,iBAAiBC,UAAU1C,KAAKoD,GAGvC,IAAIC,EAAW3C,EAAmBmB,SAASuB,IAAoBC,SAC/D,KAAOA,GAAyB,iBAAbA,GACjBd,EAAOE,iBAAiBC,UAAU1C,KAAKqD,GACvCA,EAAW3C,EAAmBmB,SAASwB,IAAWA,SAIpD,MAAMC,GAAa,IAAAvE,KAAI8D,EAAa,KAAM,CAAC,GAC3C,IAAK,MAAMxB,KAAUiC,GACf,IAAAvE,KAAIuE,EAAY,GAAGjC,YAAmB+B,GACxCb,EAAOE,iBAAiBrB,WAAWpB,KAAKqB,EAG9C,CACF,CAGA,MAAMkC,EAAyD,CAC7DC,OAAQ,EACRC,UAAW,EACXC,OAAQ,EACRC,YAAa,EACbC,SAAU,EACVC,QAAS,GAG2E,CACpF,CAAEnC,KAAM,SAAUoC,MAAO,uCAAwCC,OAAQ,GACzE,CAAErC,KAAM,YAAaoC,MAAO,kCAAmCC,OAAQ,GACvE,CAAErC,KAAM,SAAUoC,MAAO,uCAAwCC,OAAQ,GACzE,CAAErC,KAAM,SAAUoC,MAAO,aAAcC,OAAQ,KAC/C,CAAErC,KAAM,cAAeoC,MAAO,sCAAuCC,OAAQ,GAC7E,CAAErC,KAAM,WAAYoC,MAAO,yBAA0BC,OAAQ,IAGtD1D,QAAQ,EAAGqB,OAAMoC,QAAOC,aAC3BD,EAAME,KAAK3B,KACbkB,EAAa7B,IAASqC,KAK1B,IAAIE,EAAW,EACXC,EAAuC,UAE3C,IAAK,MAAOxC,EAAMyC,KAAUvF,OAAOwF,QAAQb,GACrCY,EAAQF,IACVA,EAAWE,EACXD,EAAaxC,GAGjBa,EAAOC,WAAa0B,EAIpB,MAAMG,EAAiBhC,EAAUiC,MAAM,4BAA8B,GAErE,IAAK,MAAM7C,KAAQ4C,EAAgB,CACjC,MAAME,EAAU7D,EAAmBkB,WAAWH,GAC9C,GAAI8C,EACF,IAAK,MAAMC,KAAQD,EAAS,CAC1B,OAAQC,EAAK9C,MACX,IAAK,YACHa,EAAOE,iBAAiBrB,WAAWpB,KAAKwE,EAAKhD,IAC7C,MACF,IAAK,WACHe,EAAOE,iBAAiBC,UAAU1C,KAAKwE,EAAKhD,IAC5C,MACF,IAAK,SACL,IAAK,QACL,IAAK,WACL,IAAK,SACHe,EAAOE,iBAAiBE,QAAQ3C,KAAKwE,EAAKhD,IAC1C,MACF,IAAK,UACiB,WAAhBgD,EAAKC,SACFlC,EAAOmC,qBAAoBnC,EAAOmC,mBAAqB,IAC5DnC,EAAOmC,mBAAmB1E,KAAK,UAMrC,MAAM2E,EAAgB/F,OAAOgG,KAAK5D,EAAW,IAAI+B,KAAK8B,GACpD,CAAC,MAAO,UAAU5B,UAAS,IAAAlE,KAAIiC,EAAY,MAAM6D,gBAAoB,KAEnEL,EAAKM,UAAYH,GAAkC,YAAjBH,EAAKM,UACpCvC,EAAOwC,oBACVxC,EAAOwC,kBAAoB,CAAED,QAASN,EAAKM,QAASE,MAAO,GAAItC,UAAW,KAE1D,aAAd8B,EAAK9C,KACPa,EAAOwC,kBAAkBrC,WAAW1C,KAAKwE,EAAKhD,IAE9Ce,EAAOwC,kBAAkBC,OAAOhF,KAAKwE,EAAKhD,IAGhD,CAEJ,CAGA,GAAI2B,EACF,IAAK,MAAM8B,KAAU3C,EAAkB,CACrC,MAAM4C,EAAYD,EAAOE,kBACzB,IAAIC,GAAc,EAOlB,GALIjC,EAAc,MAAQ+B,EAAUG,YAAYpC,SAASE,EAAc,QACrEiC,GAAc,GAIZA,EAAa,CACfnE,QAAQC,IAAI,2BAA2B+D,EAAOzD,yCAA0CyD,GACxF1C,EAAOK,iBAAiB5C,KAAKiF,GAE7B,MAAMK,EAAiBvF,KAAKwF,wBAAwBN,EAAOO,QAASxE,GACpEuB,EAAOE,iBAAiBrB,WAAWpB,QAAQsF,EAAelE,YAC1DmB,EAAOE,iBAAiBC,UAAU1C,QAAQsF,EAAe5C,WACzDH,EAAOE,iBAAiBE,QAAQ3C,QAAQsF,EAAe3C,QACzD,CACF,CAUF,MAN0B,cAAtBJ,EAAOC,aACJD,EAAOmC,qBAAoBnC,EAAOmC,mBAAqB,IAC5DnC,EAAOmC,mBAAmB1E,KAAK,KAAM,UAGvCiB,QAAQC,IAAI,yCAA0CqB,GAC/CA,CACT,CAEQ,uBAAAgD,CAAwBE,EAAczE,GAC5C,MAAM0E,EAA2C,CAAEtE,WAAY,GAAIsB,UAAW,GAAIC,QAAS,IAC3F,IAAK3B,EAAY,OAAO0E,EAExB,MAAMrB,EAAiBoB,EAAKnB,MAAM,4BAA8B,GAChE,IAAK,MAAM7C,KAAQ4C,EAAgB,CACjC,MAAME,EAAU7D,EAAmBkB,WAAWH,GAC9C,GAAI8C,EACF,IAAK,MAAMC,KAAQD,EACjB,OAAQC,EAAK9C,MACX,IAAK,YACHgE,EAAStE,WAAWpB,KAAKwE,EAAKhD,IAC9B,MACF,IAAK,WACHkE,EAAShD,UAAU1C,KAAKwE,EAAKhD,IAC7B,MACF,IAAK,SACHkE,EAAS/C,QAAQ3C,KAAKwE,EAAKhD,IAKrC,CACA,OAAOkE,CACT,CAKO,oBAAAC,CACLtD,EACAuD,EACA5E,GAEA,MAAM0E,EAAW,IAAIG,IAAY,CAACD,IAClC,IAAK5E,IAAeA,EAAW,GAAI,OAAO8E,MAAMC,KAAKL,GAErD,MAAM7C,EAAcjE,OAAOkE,OAAO9B,EAAW,IAAI+B,KAC/CC,GAA6B,SAAxB,IAAAjE,KAAIiE,EAAG,cAAkD,YAAxB,IAAAjE,KAAIiE,EAAG,cAE/C,IAAKH,EAAa,OAAOiD,MAAMC,KAAKL,GAEpC,MAAMM,GAAgB,IAAAjH,KAAI8D,EAAa,KAAM,CAAC,GACxCoD,GAAc,IAAAlH,KAAIiH,EAAeJ,KAAuB,IAAA7G,KAAIiC,EAAY,SAC9E,IAAKiF,EAAa,OAAOH,MAAMC,KAAKL,GAEpC,MAAMtC,EAAoB6C,EAAY,KAGtC,IAAK,MAAM5E,KAAU2E,EACfA,EAAc3E,GAAQ,OAAS+B,GACjCsC,EAASQ,IAAI7E,GAKjB,MAAM8E,GAAY,IAAApH,KAAI8D,EAAa,OAAQ,CAAC,GACtCuD,GAAkB,IAAArH,KAAIoH,EAAWP,EAAoB,CAAC,GAEtDS,EAAkBzH,OAAOwF,QAAQgC,GACpCE,IAAI,EAAE9E,EAAI+E,MAAwB,CACjC/E,KACAgF,UAAU,IAAAzH,KAAIwH,EAAK,UAAW,GAC9BE,UAAU,IAAA1H,KAAIwH,EAAK,WAAY,MAEhCG,KAAK,CAACjI,EAAGkI,IAAMA,EAAEH,SAAW/H,EAAE+H,UAEjC,GAAIH,EAAgBO,OAAS,EAAG,CAC9BlB,EAASQ,IAAIG,EAAgB,GAAG7E,IAChC,MAAMqF,EAAcR,EAAgBK,KAAK,CAACjI,EAAGkI,IAAMA,EAAEF,SAAWhI,EAAEgI,UAAU,GACxEI,GAAanB,EAASQ,IAAIW,EAAYrF,GAC5C,CAGA,IAAK,MAAMA,KAAMwE,EAAe,CAC9B,MAAMc,EAAYd,EAAcxE,GAC5BsF,GAAaA,EAAU,IAAMzE,EAAUY,SAAS6D,EAAU,KAC5DpB,EAASQ,IAAI1E,EAEjB,CAEA,OAAOsE,MAAMC,KAAKL,EACpB,CASO,gBAAAqB,CACLxE,EACAF,EACArB,EACAgG,GAEA,IAAKhG,EAAY,MAAO,CAAEiG,UAAW,CAAC,GAEtC,MAAMC,EAAiB,CACrB,GAAI,CACF,GAAI,CAAC,EACL,KAAK,IAAAnI,KAAIiC,EAAY,UACrB,MAAM,IAAAjC,KAAIiC,EAAY,YAExB,GAAI,CAAC,GAIDmG,GAAiB,IAAApI,KAAIiC,EAAY,QAAS,CAAC,GAE3CoG,EAAsB,IAAKD,GAE7BA,EAAe,KACjBC,EAAe,GAAKrH,KAAKsH,cAAcF,EAAe,KAEpDA,EAAe,QACjBC,EAAe,MAAQrH,KAAKsH,cAAcF,EAAe,QAIvD5E,EAAOmC,oBACTnC,EAAOmC,mBAAmBrE,QAASzC,IAC7BuJ,EAAevJ,KACjBwJ,EAAexJ,GAAOuJ,EAAevJ,MAI3CsJ,EAAU,GAAG,GAAKE,EAGlB,MAAME,EAAexB,MAAMC,KAAK,IAAIF,IAAI,CAACmB,KAAWzE,EAAOE,iBAAiBrB,cAGtEmG,EAAmB3I,OAAOwF,SAAQ,IAAArF,KAAIiC,EAAY,KAAM,CAAC,IAA+B+B,KAC5F,EAAE,CAAEC,KAA+B,SAAxB,IAAAjE,KAAIiE,EAAG,cAAkD,YAAxB,IAAAjE,KAAIiE,EAAG,cAGrD,GAAIuE,EAAkB,CACpB,MAAOzC,EAASjC,GAAe0E,EACzBC,GAAU,IAAAzI,KAAI8D,EAAa,iBAGjC,GAAI2E,EAAS,CACX,MAAMC,GAAc,IAAA1I,KAAI8D,EAAa,CAAC,KAAM,OAAQ2E,IACpD,GAAIC,EAAa,CACf,MAAMC,EAAY,IAAKD,UAEfC,EAAkB,GAC1BA,EAAU,MAAO,IAAA3I,KAAI0I,EAAa,OAAQ,CAAC,GAI3C,MAAME,GAAe,IAAA5I,KAAI0I,EAAa,UAAW,CAAC,GAC5CG,EAAqC,CAAC,EAE5C,GAAIrF,EAAOE,iBAAiBC,UAAUkE,OAAS,EAC7C,IAAK,MAAMiB,KAAStF,EAAOE,iBAAiBC,UAAW,CACrD,MAAMoF,EAAOH,EAAqCE,GAClD,GAAIC,EAAK,CACPF,EAAcC,GAASC,EAEvB,IAAIzE,GAAW,IAAAtE,KAAI+I,EAAK,SACxB,KAAOzE,GAAyB,iBAAbA,GAA6B,CAC9C,MAAM0E,EAAUJ,EAAqCtE,GACrD,IAAI0E,EAOF,MALKH,EAAcvE,KACjBuE,EAAcvE,GAAY0E,GAE5B1E,GAAW,IAAAtE,KAAIgJ,EAAQ,QAI3B,CACF,CACF,CAIEnJ,OAAOgG,KAAKgD,GAAehB,OAAS,IACrCc,EAAkB,GAAK,CAAE,KAAME,IAG7BV,EAAU,GAAGpC,KAAUoC,EAAU,GAAGpC,GAAW,CAAC,GACrDoC,EAAU,GAAGpC,GAAS,GAAK,CACzB,KAAK,IAAA/F,KAAI8D,EAAa,UACtB,KAAM,CAAE,CAAC2E,GAAUE,GAEvB,CACF,CAGA,MAAMpE,GAAa,IAAAvE,KAAIiC,EAAW,GAAG8D,GAAU,KAAM,CAAC,GAChDkD,EAAiB,CAAC,EAGlB9E,GAAW,IAAAnE,KAAIiC,EAAY,oBAC3BmC,EAAiBD,GAAW,IAAAnE,KAAIuE,EAAYJ,GAAYiE,EAGxDc,EAAgBlI,KAAK4F,qBAAqBtD,EAAW2E,EAAQhG,GACnEsG,EAAatH,QAAQiI,GAErB,MAAMC,EAAmBpC,MAAMC,KAAK,IAAIF,IAAIyB,IAE5C,IAAK,MAAMjG,KAAU6G,EAAkB,CACrC,MAAM5G,GAAO,IAAAvC,KAAIuE,EAAYjC,KAAYA,IAAW2F,EAASG,EAAiB,MAC1E7F,IAGsB,WAAtBiB,EAAOC,YACe,cAAtBD,EAAOC,YACPlB,EAAK,OAAS6B,GAAe,KAE7B6E,EAAU3G,GAAUC,EAEpB0G,EAAU3G,GAAU,CAElB,GAAIC,EAAK,GACT,GAAIA,EAAK,GACT,KAAMA,EAAK,KACX,GAAIA,EAAK,GACT,GAAIA,EAAK,GACT,KAAMA,EAAK,MAInB,CACA4F,EAAU,GAAGpC,GAAS,GAAKkD,EAG3B,MAAMG,GAAgB,IAAApJ,KAAI8D,EAAa,OAAQ,CAAC,GAChDqE,EAAU,GAAGpC,GAAS,KAAO,CAAC,EAC9B,MAAMsD,EAAgBxJ,OAAOgG,KAAKoD,GAC7BI,EAAcnF,SAAS+D,IAC1BoB,EAAcpI,KAAKgH,GAGrB,IAAK,MAAMqB,KAAaD,EAAe,CACrC,MAAME,GAAY,IAAAvJ,KAAIoJ,EAAeE,GACrC,GAAIC,EAAW,CACRpB,EAAU,GAAGpC,GAAS,OAAMoC,EAAU,GAAGpC,GAAS,KAAO,CAAC,GAC/DoC,EAAU,GAAGpC,GAAS,KAAKuD,GAAa,CAAC,EACzC,IAAK,MAAME,KAAYD,EACjBF,EAAcnF,SAASsF,KACzBrB,EAAU,GAAGpC,GAAS,KAAKuD,GAAWE,GAAYD,EAAUC,GAGlE,CACF,CAGA,MAAMC,EAAkB,IAAI3C,IAAY,IAAItD,EAAOE,iBAAiBE,UAC9D8F,GAAe,IAAA1J,KAAI8D,EAAa,MAAO,CAAC,GAO9C,GALA,CAACuE,KAAmBxI,OAAOkE,OAAOkF,IAAY3H,QAASiB,IACjDA,EAAK,IAAI1C,OAAOgG,KAAKtD,EAAK,IAAIjB,QAAQmB,GAAMgH,EAAgBtC,IAAI1E,IAChEF,EAAK,OAAOA,EAAK,MAAMjB,QAASmB,GAAeA,GAAMgH,EAAgBtC,IAAI1E,MAG3EgH,EAAgB7G,KAAO,GAAK8G,EAAc,CACvCvB,EAAU,GAAGpC,GAAS,MAAKoC,EAAU,GAAGpC,GAAS,IAAM,CAAC,GAC7D,IAAK,MAAM4D,KAAYD,EAAc,CACnC,GAAiB,UAAbC,EAAsB,SAC1B,MAAMC,GAAgB,IAAA5J,KAAI0J,EAAcC,EAAU,CAAC,GACnD,IAAK,MAAME,KAAUJ,GACf,IAAAzJ,KAAI4J,EAAeC,KAChB1B,EAAU,GAAGpC,GAAS,IAAI4D,KAAWxB,EAAU,GAAGpC,GAAS,IAAI4D,GAAY,CAAC,GACjFxB,EAAU,GAAGpC,GAAS,IAAI4D,GAAUE,IAAU,IAAA7J,KAAI4J,EAAeC,GAGvE,CACF,CACF,CAGA,GAAIrG,EAAOwC,kBAAmB,CAC5B,MAAM,QAAED,EAAO,MAAEE,EAAK,UAAEtC,GAAcH,EAAOwC,kBACvC8D,GAAc,IAAA9J,KAAIiC,EAAW,GAAI8D,GACvC,GAAI+D,IACG3B,EAAU,GAAGpC,KAAUoC,EAAU,GAAGpC,GAAW,CAAC,GAGjDE,GAASA,EAAM4B,OAAS,GAAG,CAC7B,MAAMkC,GAAW,IAAA/J,KAAI8J,EAAa,MAAO,CAAC,GACrC3B,EAAU,GAAGpC,GAAS,MAAKoC,EAAU,GAAGpC,GAAS,IAAM,CAAC,GAC7D,IAAK,MAAM4D,KAAYI,EAAU,CAC/B,GAAiB,UAAbJ,EAAsB,SAC1B,MAAMK,EAAQD,EAASJ,GACvB1D,EAAM3E,QAAQuI,IACRG,EAAMH,KACH1B,EAAU,GAAGpC,GAAS,IAAI4D,KAAWxB,EAAU,GAAGpC,GAAS,IAAI4D,GAAY,CAAC,GACjFxB,EAAU,GAAGpC,GAAS,IAAI4D,GAAUE,GAAUG,EAAMH,KAG1D,CACF,CAEJ,CAGA,OADA3H,QAAQC,IAAI,0CAA2C,CAAE+F,UAAWC,IAC7D,CAAED,UAAWC,EACtB,CAEQ,aAAAG,CAAcf,GACpB,IAAKA,EAAK,MAAO,CAAC,EAClB,MAAM0C,EAAc,CAAC,EACrB,IAAK,MAAMpL,KAAO0I,EACJ,UAAR1I,IAEJoL,EAAOpL,GAA2B,iBAAb0I,EAAI1I,IAAoB0I,EAAI1I,IAEnD,OAAOoL,CACT,GC7aF,SAASC,EAAgBC,EAAcnB,EAAaoB,EAAgBC,GAClE,MAAMC,EAAiBH,EAAKI,QAAQ,KACpC,GAAID,GAAkB,EAAG,CACvB,MAAMzL,EAAMsL,EAAKK,UAAU,EAAGF,GAAgBG,OACxCC,EAAWP,EAAKK,UAAUF,EAAiB,GAAGG,OAEpD,GAAiB,KAAbC,EAAiB,CACnB,MAAMC,EAAW,CAAC,EAClB3B,EAAOnK,GAAO8L,EACdN,EAAMpJ,KAAK,CAAE2J,MAAOR,EAAQnK,IAAK0K,GACnC,MAAO,GAAID,EAASG,WAAW,MAAQH,EAASI,SAAS,KAAM,CAC7D,MAAMC,EAAS,CAAC,EAChB/B,EAAOnK,GAAOkM,EACd,MACMC,EADaN,EAASO,MAAM,GAAI,GAAGR,OAChBS,MAAM,KAAK3D,IAAI4D,GAAKA,EAAEV,QAC/C,IAAK,MAAMW,KAAQJ,EACjBd,EAAgBkB,EAAML,EAAQX,EAAS,EAAGC,EAE9C,MACErB,EAAOnK,GAAOwM,EAAWX,EAE7B,CACF,CAEA,SAASW,EAAW5K,GAClB,MAAM6K,EAAU7K,EAAMgK,OAEtB,GAAIa,EAAQT,WAAW,MAAQS,EAAQR,SAAS,KAAM,CACpD,MAAMS,EAAQD,EAAQL,MAAM,GAAI,GAChC,OAAIM,EAAMV,WAAW,MAAQU,EAAMT,SAAS,KACnCO,EAAWE,GAEbA,CACT,CAEA,GAAID,EAAQT,WAAW,MAAQS,EAAQR,SAAS,KAC9C,IACE,MAAMrE,EAAU6E,EAAQL,MAAM,GAAI,GAAGR,OAC/Be,EAAQ,GACd,IAAIC,EAAS,GACTC,GAAW,EACXC,EAAe,EAEnB,IAAK,IAAIC,EAAI,EAAGA,EAAInF,EAAQoB,OAAQ+D,IAAK,CACvC,MAAMrJ,EAAOkE,EAAQmF,GACR,OAATrJ,GAAyB,MAATA,IAClBmJ,GAAYA,GAETA,IACU,MAATnJ,GAAcoJ,IACL,MAATpJ,GAAcoJ,IACL,MAATpJ,GAAiC,IAAjBoJ,GAMtBF,GAAUlJ,GALNiJ,EAAMvK,KAAKwK,EAAOhB,QAClBgB,EAAS,GAKf,CAKA,OAJIA,GACFD,EAAMvK,KAAKwK,EAAOhB,QAGbe,EAAMjE,IAAIsE,GAAQR,EAAWQ,GACtC,CAAE,MAAOC,GAET,CAGF,MAA8B,SAA1BR,EAAQS,eACkB,UAA1BT,EAAQS,gBACI,SAAZT,EAA2B,KACf,KAAZA,GAAmBU,MAAMC,OAAOX,KAAcA,EAAQpH,SAAS,KAI5DoH,EAHEW,OAAOX,GAIlB,CC/IA,MAAMY,EAAgB,QACtB,IAAIC,EAA6B,KAEjCC,eAAeC,EAAWC,GAAe,GACvC,GAAIH,IAAiBG,EACnB,OAAOH,EAET,IACE,MAAM9G,QAAgBkH,aAAaC,mBAAmBN,GACtD,OAAK7G,GAKL8G,EAAe9G,EACRA,IALLnD,QAAQuK,MAAM,6BAA6BP,wBAC3CC,EAAe,KACR,KAIX,CAAE,MAAOM,GAEP,OADAvK,QAAQuK,MAAM,+CAAgDA,GACvD,IACT,CACF,CAUAL,eAAeM,EAAiBC,EAAmBL,GAAe,GAChE,MAAMjH,QAAgBgH,EAAWC,GACjC,IAAKjH,EAAS,OAAO,KACrB,MAAMuH,EAAQvH,EAAQrB,KAAM8H,GAAWA,EAAEe,UAAYF,GAAab,EAAEpJ,OAASiK,GAC7E,OAAOC,EAAQA,EAAMnG,QAAU,IACjC,CAEA2F,eAAeU,EACbH,EACAlG,EACAsG,EAAkD,CAAEC,WAAW,EAAMnH,KAAM,KAE3E3D,QAAQC,IAAI,2DAA2DwK,OACvE,MAAMM,QAAmBZ,IACzB,IAAKY,EAAY,OAEjB,MAAMC,EAAcD,EAAWjJ,KAAM8H,GAAWA,EAAEe,UAAYF,GAAab,EAAEpJ,OAASiK,GAEtF,IACE,GAAIO,EAEFhL,QAAQC,IAAI,gCAAgCwK,sDACtCJ,aAAaY,mBAAmBjB,EAAe,CACnD,CAAEkB,IAAKF,EAAYE,IAAK3G,QAASA,EAAS4G,QAASN,EAAQC,iBAExD,CAEL9K,QAAQC,IAAI,gCAAgCwK,2DAE5C,MAAMW,EAAUX,EAAUY,QAAQ,WAAY,IACxCC,EAAoBP,EAAWjJ,KAAM4I,GAAeA,EAAMC,UAAYS,GAAWV,EAAMlK,OAAS4K,GAGhGG,EAAoB,CACxBZ,QAASF,EACTlG,QAASA,EACTZ,KAAM,CAAC8G,GACPU,QAASN,EAAQC,UACjBU,SAAU,8BACVC,MAAO,KAILH,GACF3N,OAAO+N,OAAOH,EAAc,CAC1B5H,KAAM,IAAK2H,EAAkB3H,MAAQ,GAAK8G,GAC1CkB,UAAWL,EAAkBK,UAC7BC,SAAUN,EAAkBM,SAC5BJ,SAAUF,EAAkBE,SAC5BC,MAAOH,EAAkBG,MACzBI,eAAgBP,EAAkBO,iBAItC7L,QAAQC,IACN,4DAA4DwK,mBAC5DqB,KAAKC,UAAUR,UAEXlB,aAAa2B,sBAAsBhC,EAAe,CAACuB,GAC3D,CACAvL,QAAQC,IAAI,mCAAmCwK,8BAC/CR,EAAe,IACjB,CAAE,MAAOM,GACPvK,QAAQuK,MAAM,2BAA2BE,UAAmBF,EAC9D,CACF,CAgDO,MAAM0B,EAAkB,CAC7B9B,aACAK,mBACAI,kBACAsB,cAlDFhC,eAA6BO,EAAmB0B,EAAoBC,EAAY,eAC9EpM,QAAQC,IAAI,6CAA6CwK,OACzD,IACE,MAAM4B,QAAwB7B,EAAiBC,GACzClG,EAAU8H,EAAkB,GAAGA,IAAkBD,IAAYD,IAAeA,QAE5EvB,EAAgBH,EAAWlG,EACnC,CAAE,MAAOgG,GACPvK,QAAQuK,MAAM,8BAA8BE,UAAmBF,EACjE,CACF,EAyCE+B,mBA9HF,SAA4B3B,GAC1B,OAAKV,EAIEA,EAAanI,KAAM8H,GAAWA,EAAEe,UAAYA,IAAY,MAH7D3K,QAAQuM,KAAK,2EACN,KAGX,EAyHEC,gBAIFtC,eAA+BO,EAAmBK,GAChD9K,QAAQC,IAAI,oCAAoCwK,yBAAiCK,KACjF,IACE,MAAMC,QAAmBZ,IACzB,IAAKY,EAAY,OAEjB,MAAMC,EAAcD,EAAWjJ,KAAM8H,GAAWA,EAAEe,UAAYF,GAAab,EAAEpJ,OAASiK,GAEtF,GAAIO,EAAa,CAEf,MAAMyB,EAAe,IAAKzB,EAAaG,QAASL,SAC1CT,aAAaY,mBAAmBjB,EAAe,CAACyC,IACtDzM,QAAQC,IAAI,uCAAuCwK,cAAsBK,KAC3E,MAEE9K,QAAQuM,KAAK,6CAA6C9B,0BAE9D,CAAE,MAAOF,GACPvK,QAAQuK,MAAM,2BAA2BE,cAAuBF,EAClE,CACF,EAvBEmC,sBAtCFxC,eAAqCyC,EAAY,OAC/C,IACE,MAAMpI,QAAgBiG,EAAiBmC,GACvC,IAAKpI,EAEH,OADAvE,QAAQuM,KAAK,8BAA8BI,gBACpC,KAGT,MAAMC,EDtHH,SAA8BpI,GACnC,IAAKA,EAEH,OADAxE,QAAQuM,KAAK,yDACN,KAGT,MACMM,EAAarI,EAAK6D,QADK,UAE7B,IAAoB,IAAhBwE,EAEF,OADA7M,QAAQuK,MAAM,oEACP,KAGT,MACMuC,EADWtI,EAAK8D,UAAUuE,GACT7D,MAAM,MAAMD,MAAM,GAEnCgE,EAAO,CAAC,EACR5E,EAAuC,CAAC,CAAEO,OAAQ,EAAG3K,IAAKgP,IAEhE,IAAK,MAAM9E,KAAQ6E,EAAO,CACxB,GAAoB,KAAhB7E,EAAKM,OAAe,SAExB,MAAMyE,EAAc/E,EAAK5E,MAAM,QACzB6E,EAAS8E,EAAcA,EAAY,GAAGrH,OAAS,EAC/CsH,EAAchF,EAAKM,OAEzB,KAAOJ,EAAMxC,OAAS,GAAKuC,GAAUC,EAAMA,EAAMxC,OAAS,GAAG+C,OAC3DP,EAAM+E,MAGR,IAAIC,EAAYhF,EAAMA,EAAMxC,OAAS,GAAG5H,IAExC,GAAIkP,EAAYtE,WAAW,MAAO,CAChC,MAAMyE,EAAkBH,EAAY3E,UAAU,GAAGC,OAEjD,IAAK1D,MAAMwI,QAAQF,GAAY,CAC7B,MAAMG,EAAcnF,EAAMA,EAAMxC,OAAS,GAAG5H,IACtCwP,EAAU5P,OAAOgG,KAAK2J,GAAaJ,MACzC,IAAIK,GAAWD,EAAYC,KAAaJ,EAKtC,SAJAA,EAAY,GACZG,EAAYC,GAAWJ,EACvBhF,EAAMA,EAAMxC,OAAS,GAAG5H,IAAMoP,CAIlC,CAGA,IAAwB,IADDC,EAAgB/E,QAAQ,KAE7C8E,EAAUpO,KAAKoK,EAAWiE,QACrB,CACL,MAAMI,EAAc,CAAC,EACrBL,EAAUpO,KAAKyO,GACfrF,EAAMpJ,KAAK,CAAE2J,MAAOR,EAAQnK,IAAKyP,IACjCxF,EAAgBoF,EAAiBI,EAAatF,EAAQC,EACxD,CACF,MACEH,EAAgBiF,EAAaE,EAAWjF,EAAQC,EAEpD,CAEA,OAAO4E,CACT,CCwDsBU,CAAqBlJ,GAEvC,GAAIqI,GAAaA,EAAU,MAAQA,EAAU,IAAK,CAEhD,MAAMc,EAAiBd,EAAU,IAAI,OACrC,GAAIc,GAAkBd,EAAU,KAAKc,GACnC,OAAOd,EAAU,KAAKc,GAGxB,MAAMC,EAAqBhQ,OAAOkE,OAAO+K,EAAU,MAAM9K,KAAK8L,GAASA,EAAM,KAC7E,GAAID,EACF,OAAOA,CAEX,CAGA,OADA3N,QAAQuM,KAAK,wBAAwBI,yBAC9B,IACT,CAAE,MAAOpC,GAEP,OADAvK,QAAQuK,MAAM,6BAA6BoC,UAAmBpC,GACvD,IACT,CACF,GCrIA,MAAMsD,GAAQ,IAAAC,UAAS,CACrBC,cAAe,KAGjB,IAAIC,EAAS,EAEb,MAAMC,EAAU,CACd,IAAAC,CAAKC,EAAeC,EAAiB3N,EAAyB,OAAQ4N,EAAmB,KACvF,MAAM9N,EAAKyN,IACXH,EAAME,cAAchP,KAAK,CAAEwB,KAAI4N,QAAOC,UAAS3N,SAE3C4N,EAAW,GACbC,WAAW,KACTxP,KAAKyP,KAAKhO,IACT8N,EAEP,EAEA,IAAAE,CAAKhO,GACH,MAAMiO,EAAQX,EAAME,cAAcU,UAAUrR,GAAKA,EAAEmD,KAAOA,IAC3C,IAAXiO,GACFX,EAAME,cAAcW,OAAOF,EAAO,EAEtC,EAEA,OAAAG,CAAQR,EAAeC,EAAiBC,EAAmB,KACzDvP,KAAKoP,KAAKC,EAAOC,EAAS,UAAWC,EACvC,EAEA,IAAAO,CAAKT,EAAeC,EAAiBC,EAAmB,KACtDvP,KAAKoP,KAAKC,EAAOC,EAAS,OAAQC,EACpC,EAEA,IAAA9B,CAAK4B,EAAeC,EAAiBC,EAAmB,KACtDvP,KAAKoP,KAAKC,EAAOC,EAAS,UAAWC,EACvC,EAEA,KAAA9D,CAAM4D,EAAeC,EAAiBC,EAAmB,KACvDvP,KAAKoP,KAAKC,EAAOC,EAAS,QAASC,EACrC,GAGWQ,EAAoBhB,EACpBiB,EAAsBb,ECnC7Bc,EAAqC,CAAC,EAE/BC,EAAiB,CAC5B,QAAAC,CAA0CtS,EAAQuS,GAChDH,EAASpS,GAAOuS,CAClB,EACA,GAAApR,CAAqCnB,GACnC,MAAMuS,EAAWH,EAASpS,GAC1B,IAAKuS,EACH,MAAM,IAAIC,MAAM,qBAAqBxS,+BAEvC,OAAOuS,CACT,GCqBK,MAAME,EAAgB,IA9C7B,MAIE,qBAAMC,GACJrP,QAAQsP,MAAM,gCACd,MAAMC,QAAiBC,gBAAgBC,uBAEvC,OADAzP,QAAQsP,MAAM,qBAAsBC,GAC7BA,CACT,CAOA,wBAAMG,CAAmBC,EAAgBC,GACvC,MAAMC,EAAsB,CAC1BC,QAAS,CAAC,CAAEC,KAAM,OAAQxL,QAASoL,EAAQnE,SAAU,UAAWwE,aAAa,IAC7EC,eAAe,GAGbL,IACFC,EAAeD,UAAYA,GAG7B,MAAMM,QAAmB7F,aAAa8F,SAASN,GAC/C,GAA0B,iBAAfK,EACT,MAAM,IAAIf,MAAM,eAElB,OAAOe,CACT,CAOA,qBAAME,CAAgBC,EAAgBC,GACpC,MAAMC,EAAiB,CAAEC,cAAeF,GAGxC,aADMG,UAAU,iBAAkBJ,EAAQE,GACnCA,EAAUG,aACnB,GCjDF,MAAM,GAA+BC,ECS/B,GAAS,CACb,IAAK,CACH,CAAEnQ,KAAM,KAAMoQ,WAAYC,KAC1B,CAAErQ,KAAM,KAAMoQ,WAAY,IAC1B,CAAEpQ,KAAM,KAAMoQ,WAAY,IAC1B,CAAEpQ,KAAM,KAAMoQ,WAAY,IAC1B,CAAEpQ,KAAM,KAAMoQ,UAAW,IACzB,CAAEpQ,KAAM,KAAMoQ,UAAW,IACzB,CAAEpQ,KAAM,KAAMoQ,UAAW,IACzB,CAAEpQ,KAAM,KAAMoQ,UAAW,KACzB,CAAEpQ,KAAM,KAAMoQ,UAAW,KACzB,CAAEpQ,KAAM,KAAMoQ,UAAW,KACzB,CAAEpQ,KAAM,KAAMoQ,UAAW,KACzB,CAAEpQ,KAAM,KAAMoQ,UAAW,MAE3B,IAAK,CACH,CAAEpQ,KAAM,KAAMoQ,WAAY,KAC1B,CAAEpQ,KAAM,KAAMoQ,WAAY,IAC1B,CAAEpQ,KAAM,KAAMoQ,WAAY,IAC1B,CAAEpQ,KAAM,KAAMoQ,UAAW,GACzB,CAAEpQ,KAAM,KAAMoQ,UAAW,IACzB,CAAEpQ,KAAM,KAAMoQ,UAAW,IACzB,CAAEpQ,KAAM,KAAMoQ,UAAW,IACzB,CAAEpQ,KAAM,KAAMoQ,UAAW,KACzB,CAAEpQ,KAAM,KAAMoQ,UAAW,KACzB,CAAEpQ,KAAM,KAAMoQ,UAAW,KACzB,CAAEpQ,KAAM,KAAMoQ,UAAW,KACzB,CAAEpQ,KAAM,KAAMoQ,UAAW,MAE3B,IAAK,CACH,CAAEpQ,KAAM,KAAMoQ,WAAY,KAC1B,CAAEpQ,KAAM,KAAMoQ,WAAY,IAC1B,CAAEpQ,KAAM,KAAMoQ,WAAY,IAC1B,CAAEpQ,KAAM,KAAMoQ,WAAY,IAC1B,CAAEpQ,KAAM,KAAMoQ,UAAW,IACzB,CAAEpQ,KAAM,KAAMoQ,UAAW,IACzB,CAAEpQ,KAAM,KAAMoQ,UAAW,IACzB,CAAEpQ,KAAM,KAAMoQ,UAAW,IACzB,CAAEpQ,KAAM,KAAMoQ,UAAW,KACzB,CAAEpQ,KAAM,KAAMoQ,UAAW,KACzB,CAAEpQ,KAAM,OAAQoQ,UAAW,KAC3B,CAAEpQ,KAAM,OAAQoQ,UAAW,OAIzB,GAAS,CACb,CAAEpQ,KAAM,KAAMoQ,UAAW,EAAG,GAAI,0CAChC,CAAEpQ,KAAM,KAAMoQ,UAAW,GAAI,GAAI,yCACjC,CACEpQ,KAAM,KACNoQ,UAAW,GACX,GAAI,4CAEN,CAAEpQ,KAAM,KAAMoQ,UAAW,GAAI,GAAI,qBACjC,CAAEpQ,KAAM,KAAMoQ,UAAW,GAAI,GAAI,2CAGtB,GAAS,CACpB,CAAE,GAAI,IAAK,KAAM,EAAG,KAAM,KAC1B,CAAE,GAAI,IAAK,KAAM,EAAG,KAAM,KAC1B,CAAE,GAAI,IAAK,KAAM,EAAG,KAAM,KAC1B,CAAE,GAAI,IAAK,IAAK,EAAG,KAAM,KACzB,CAAE,GAAI,IAAK,IAAK,EAAG,KAAM,KACzB,CAAE,GAAI,IAAK,IAAK,EAAG,KAAM,KACzB,CAAE,GAAI,IAAK,IAAK,GAAI,KAAM,KAC1B,CAAE,GAAI,KAAM,IAAK,GAAI,KAAM,KAC3B,CAAE,GAAI,MAAO,IAAK,GAAI,KAAMC,MAIxB,GAAS,GAAAF,EAAEG,KAAK,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAAM,QAE1DC,GAAY,CAACxS,EAAeyS,KAChC,IAAIC,EAAeD,EAAO,GAC1B,IAAK,MAAME,KAASF,EAAQ,CAC1B,KAAIzS,GAAS2S,EAAMN,WAGjB,MAFAK,EAAeC,CAInB,CACA,OAAOD,EAAazQ,MAKT,GAAW,GAAAmQ,EACrBQ,OAAO,CACN,GAAI,GAAAR,EACDQ,OAAO,CACN,IAAK,GAAAR,EAAES,OAAOC,SAASzO,QAAQ,GAC/B,IAAK,GAAA+N,EAAES,OAAOC,SAASzO,QAAQ,GAC/B,IAAK,GAAA+N,EAAES,OAAOC,SAASzO,QAAQ,KAEhCA,QAAQ,CAAE,IAAK,EAAG,IAAK,EAAG,IAAK,IAClC,GAAI,GAAA+N,EACDQ,OAAO,CACN,IAAK,GAAAR,EAAEW,SAAS1O,QAAQ,MACxB,IAAK,GAAA+N,EAAEW,SAAS1O,QAAQ,MACxB,IAAK,GAAA+N,EAAEW,SAAS1O,QAAQ,QAEzBA,QAAQ,CAAE,IAAK,KAAM,IAAK,KAAM,IAAK,OACxC,KAAM,GAAA+N,EAAEW,SAAS1O,QAAQ,OAE1BA,QAAQ,CACP,GAAI,CAAE,IAAK,EAAG,IAAK,EAAG,IAAK,GAC3B,GAAI,CAAE,IAAK,KAAM,IAAK,KAAM,IAAK,MACjC,KAAM,MAEP2O,UAAU3U,IACTA,EAAI,GAAG,IAAMmU,GAAUnU,EAAI,GAAG,IAAK,GAAO,KAC1CA,EAAI,GAAG,IAAMmU,GAAUnU,EAAI,GAAG,IAAK,GAAO,KAC1CA,EAAI,GAAG,IAAMmU,GAAUnU,EAAI,GAAG,IAAK,GAAO,KACnCA,IAGE,GAAW,GAAA+T,EAAEQ,OAAO,CAC/BK,GAAI,GAAAb,EAAEW,SAAS1O,QAAQ,IAAM,SAAQ,IAAI6O,MAAOC,aAChD,GAAI,GAAAf,EAAEG,KAAK,CAAC,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,QACpE,GAAI,GAAOlO,QAAQ,KACnB,GAAI,GAAA+N,EAAEW,SAAS1O,QAAQ,SACvB,GAAI,GAAA+N,EAAEW,SAAS1O,QAAQ,IACvB,GAAI,GAAA+N,EAAEW,SAASK,MAAMC,GAAG,GAAAjB,EAAEkB,QAAQ,KAAKjP,QAAQ,IAC/C,GAAI,GAAA+N,EAAEW,SAAS1O,QAAQ,OAGZ,GAAW,GAAA+N,EAAEQ,OAAO,CAC/B,GAAI,GAAAR,EAAEG,KAAK,CAAC,OAAQ,SACpB,GAAI,GAAOlO,QAAQ,KACnB,GAAI,GAAA+N,EAAEW,SAAS1O,QAAQ,IACvB,GAAI,GAAA+N,EAAEmB,mBAAmB,KAAM,CAC7B,GAAAnB,EAAEQ,OAAO,CACP,GAAI,GAAAR,EAAEkB,QAAQ,MACd,KAAM,GAAAlB,EAAEW,SACR,KAAM,GAAAX,EAAEG,KAAK,CAAC,IAAK,IAAK,IAAK,MAC7B,EAAG,GAAAH,EAAES,OAAOC,SACZ,GAAI,GAAAV,EAAES,OACHC,SACAE,UAAUQ,GAAKC,KAAKC,IAAI,EAAGD,KAAKE,IAAIH,EAAG,OACvCnP,QAAQ,OAEb,GAAA+N,EAAEQ,OAAO,CACP,GAAI,GAAAR,EAAEkB,QAAQ,MACd,GAAI,GAAAlB,EAAEW,eAKC,GAAW,GAAAX,EACrBQ,OAAO,CACN,GAAI,GAAOvO,QAAQ,KACnB,IAAK,GAAA+N,EAAES,OAAOC,SAASzO,QAAQ,GAC/B,IAAK,GAAA+N,EAAES,OAAOC,SAASzO,QAAQ,KAEhC2O,UAAU3U,IACT,MAAMuV,EAAmB,GAAOrQ,KAAK5C,GAAKA,EAAE,KAAOtC,EAAI,IACvD,GAAIuV,IACFvV,EAAI,IAAMuV,EAAiB,IACvBvV,EAAI,KAAOuV,EAAiB,MAAQA,EAAiB,OAAStB,KAAU,CAC1E,MAAMuB,EAAiB,GAAO3D,UAAUvP,GAAKA,EAAE,KAAOtC,EAAI,IAAM,EAChE,GAAIwV,EAAiB,GAAOzM,OAAQ,CAClC,MAAM0M,EAAgB,GAAOD,GAC7BxV,EAAI,GAAKyV,EAAc,GACvBzV,EAAI,KAAOuV,EAAiB,KAC5BvV,EAAI,IAAMyV,EAAc,GAC1B,CACF,CAEF,OAAOzV,IAGE,GAAW,GAAA+T,EAAEQ,OAAO,CAC/B,GAAI,GAAAR,EAAEW,SAAS1O,QAAQ,OACvB,GAAI,GAAA+N,EAAE2B,MAAM,GAAA3B,EAAEQ,OAAO,CAAE,GAAI,GAAAR,EAAEW,SAAU,GAAI,GAAAX,EAAEW,YAAa1O,QAAQ,IAClE,KAAM,GAAA+N,EACHQ,OAAO,CACN,KAAM,GAAAR,EAAES,OAAOmB,OAAO3P,QAAQ,IAAM,IAAI6O,KAAK,eAC7C,GAAI,GAAAd,EAAES,OAAOC,SAASzO,QAAQ,IAC9B,GAAI,GAAA+N,EAAEW,SAAS1O,QAAQ,OACvB,GAAI,GAAA+N,EAAEW,SAAS1O,QAAQ,OACvB,GAAI,GAAA+N,EAAEW,SAAS1O,QAAQ,SAExBA,QAAQ,CACP,KAAM,IAAI6O,KAAK,cACf,GAAI,GACJ,GAAI,MACJ,GAAI,MACJ,GAAI,QAER,KAAM,GAAAd,EACHQ,OAAO,CACN,KAAM,GAAAR,EAAES,OACLC,SACAE,UAAUQ,GAAKC,KAAKC,IAAI,EAAGD,KAAKE,IAAIH,EAAG,OACvCnP,QAAQ,IACX,KAAM,GAAA+N,EAAEW,SAAS1O,QAAQ,MACzB,KAAM,GAAA+N,EACH6B,OAAO,GAAA7B,EAAEG,KAAK,CAAC,KAAM,KAAM,KAAM,KAAM,OAAQ,GAAAH,EAAES,OAAOC,UACxDzO,QAAQ,CAAE,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,KACjD,KAAM,GAAA+N,EAAE2B,MAAM,GAAA3B,EAAEQ,OAAO,CAAE,IAAK,GAAAR,EAAEW,SAAU,KAAM,GAAAX,EAAEW,YAAa1O,QAAQ,MAExEA,QAAQ,CACP,KAAM,GACN,KAAM,KACN,KAAM,CAAE,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,IAC5C,KAAM,KAEP2O,UAAW3U,IACNA,EAAI,OAAMA,EAAI,KAAOmU,GAAUnU,EAAI,KAAM,KACtCA,IAEX,KAAM,GAAA+T,EAAE2B,MAAM,GAAA3B,EAAEQ,OAAO,CAAE,GAAI,GAAAR,EAAEW,SAAU,GAAI,GAAAX,EAAEW,YAAa1O,QAAQ,IACpE,GAAI,GAAA+N,EAAE6B,OAAO,GAAA7B,EAAEG,KAAK,CAAC,KAAM,KAAM,MAAO,MAAO,KAAM,OAAQ,IAAU2B,WACvE,GAAI,GAAA9B,EAAE6B,OAAO,GAAA7B,EAAEW,SAAU,IAAUmB,WACnC,GAAI,GAAA9B,EACD2B,MACC,GAAA3B,EAAEQ,OAAO,CACP,GAAI,GAAAR,EAAES,OAAOmB,OACb,KAAM,GAAA5B,EAAEW,SACR,KAAM,GAAAX,EAAEG,KAAK,CAAC,KAAM,KAAM,KAAM,KAAM,KAAM,OAC5C,GAAI,GAAAH,EAAEW,YAGT1O,QAAQ,IACX,IAAK,GAAA+N,EAAE6B,OAAO,GAAA7B,EAAEW,SAAU,GAAAX,EAAEQ,OAAO,CAAE,GAAI,GAAAR,EAAES,OAAOC,SAASzO,QAAQ,MAAO6P,WAC1E,KAAM,GAAA9B,EAAE2B,MAAM,GAAA3B,EAAEW,UAAU1O,QAAQ,IAClC,GAAI,GAAA+N,EAAEW,SAAS1O,QAAQ,QAGZ8P,GAAa,GAAA/B,EAAEQ,OAAO,CACjC,KAAM,GAAAR,EACHQ,OAAO,CACN,GAAI,GAAAR,EAAES,OAAOmB,OAAO3P,QAAQ,IAAM,IAAI6O,KAAK,wBAC3C,GAAI,GAAAd,EAAEW,SAAS1O,QAAQ,SACvB,GAAI,GAAA+N,EAAEG,KAAK,CAAC,KAAM,KAAM,KAAM,KAAM,KAAM,MAAO,IAAK,KAAM,MAAMlO,QAAQ,MAC1E,GAAI,GAAA+N,EACDQ,OAAO,CACN,KAAM,GAAAR,EAAEW,SAAS1O,QAAQ,iBACzB,EAAG,GAAA+N,EAAES,OAAOC,SAASzO,QAAQ,GAC7B,EAAG,GAAA+N,EAAES,OAAOC,SAASzO,QAAQ,GAC7B,GAAI,GAAA+N,EAAEW,SAAS1O,QAAQ,YAExBA,QAAQ,CACP,KAAM,gBACN,EAAG,EACH,EAAG,EACH,GAAI,aAGTA,QAAQ,CACP,GAAI,IAAI6O,KAAK,uBACb,GAAI,QACJ,GAAI,KACJ,GAAI,CACF,KAAM,gBACN,EAAG,EACH,EAAG,EACH,GAAI,YAGV,KAAM,GAAAd,EAAE6B,OAAO,GAAA7B,EAAEW,SAAU,GAASM,GAAG,GAAAjB,EAAEkB,QAAQ,UAAUjP,QAAQ,CACjE+P,mBAAoB,OACpBC,kBAAmB,OACnBC,cAAe,SAEjB,GAAI,GAAAlC,EAAE6B,OAAO,GAAA7B,EAAEW,SAAU,GAASM,GAAG,GAAAjB,EAAEkB,QAAQ,UAAUjP,QAAQ,CAAC,GAClE,OAAQ,GAAA+N,EACLQ,OAAO,CACN,OAAQ,GAAAR,EAAES,OAAOmB,OAAO3P,QAAQ,IAAM,IAAI6O,KAAK,wBAC/C,GAAI,GAAAd,EAAE6B,OAAO,GAASM,MAAM,GAAI,GAAAnC,EAAE2B,MAAM,GAAA3B,EAAEW,WAAW1O,QAAQ,CAC3D,IAAK,GACL,IAAK,GACL,IAAK,GACL,IAAK,GACL,IAAK,GACL,IAAK,GACL,IAAK,GACL,IAAK,GACL,IAAK,KAEP,KAAM,GAAA+N,EAAE6B,OAAO,GAAA7B,EAAEW,SAAU,IAAU1O,QAAQ,CAAC,GAC9C,MAAO,GAAA+N,EAAE6B,OAAO,GAAA7B,EAAEW,SAAU,GAAAX,EAAE2B,MAAM,GAAA3B,EAAEW,WAAW1O,QAAQ,CAAC,KAE3DA,QAAQ,CACP,OAAQ,IAAI6O,KAAK,uBACjB,GAAI,CACF,IAAK,GACL,IAAK,GACL,IAAK,GACL,IAAK,GACL,IAAK,GACL,IAAK,GACL,IAAK,GACL,IAAK,GACL,IAAK,IAEP,KAAM,CAAC,EACP,MAAO,CAAC,IAEZ,KAAM,GAAAd,EACHQ,OAAO,CACN,KAAM,GAAAR,EACH6B,OACC,GAAA7B,EAAEW,SACF,GAAAX,EAAEQ,OAAO,CACP,IAAK,GAAAR,EAAEW,SACP,GAAI,GAAAX,EAAEW,SACN,GAAI,GAAAX,EAAEG,KAAK,CAAC,MAAO,MAAO,MAAO,QACjC,KAAM,GAAAH,EAAEW,YAGX1O,QAAQ,CAAC,GACZ,KAAM,GAAA+N,EAAE2B,MAAM,GAAA3B,EAAEW,UAAU1O,QAAQ,IAClC,OAAQ,GAAA+N,EAAE2B,MAAM,GAAA3B,EAAEW,UAAU1O,QAAQ,MAErCA,QAAQ,CACP,KAAM,CAAC,EACP,KAAM,GACN,OAAQ,OCnUDmQ,GAAU,WAkBV,IAAQ,IAAAjF,UAAmB,CAdtCkF,SAAS,EACTjT,WAAY,KAEZkT,UAAW,cACXC,mBAAoB,cACpBC,qBAAsB,GACtBC,WAAY,YACZC,cAAc,EACdC,gBAAiB,KACjBC,oBAAqB,KACrBC,SAAU,KCNZ,SAASC,GAAkBC,GACzB,OAAKA,EACEA,EAAK1N,WAAa0N,EADP,IAEpB,EDYA,IAAAC,OACE,IAAM,GAAM5T,WACZ,CAAC6T,EAAUC,KACT7T,QAAQC,IAAI,qCAER2T,GACF5T,QAAQC,IAAI,QAAS2T,EAAS,OAGlC,CAAEE,MAAM,KAGV,IAAAH,OACE,IAAM,GAAMX,QACXA,IACChT,QAAQC,IAAI,8BAA8B+S,EAAU,QAAU,kBCzBlE,IACIe,IAAqB,EACzB,MAAMC,GAAyB,mBAC/B,IAAIC,GAAwE,SAAnDC,eAAeC,QAAQH,IAEhD,SAASI,GAAyBP,EAAyBD,GACzD,IAAKC,IAAaD,EAAU,OAG5B,MAAMS,EAAa1W,OAAOgG,KAAKkQ,EAAS,MAClCS,EAAa3W,OAAOgG,KAAKiQ,EAAS,MACxC,IAAK,MAAMxT,KAAUkU,EACnB,IAAKD,EAAWrS,SAAS5B,GAAS,CAChC,MAAMmU,EAAUX,EAAS,KAAKxT,GACP,iBAAZmU,GACTzF,EAAoBF,KAAK,QAAS,QAAQ2F,EAAQ,MAEtD,CAIF,IAAK,MAAMC,KAASZ,EAAS,GAAI,CAC/B,MAAMa,EAASZ,EAAS,GAAGW,GACrBE,EAASd,EAAS,GAAGY,GAC3B,GAAIC,GAAUC,GAA4B,iBAAXD,GAAyC,iBAAXC,GACvDD,EAAO,GAAG,MAAQC,EAAO,GAAG,IAAK,CACnC,MAAMC,EAAaH,EAAMnJ,QAAQ0H,GAAS,IAAI1H,QAAQ,IAAK,IAC3DyD,EAAoBH,QAAQ,OAAQ,KAAKgG,YAAqBD,EAAO,GAAG,MAC1E,CAEJ,CAGA,IAAK,MAAMtU,KAAUwT,EAAS,KAAM,CAClC,MAAMgB,EAAUf,EAAS,KAAKzT,GACxBmU,EAAUX,EAAS,KAAKxT,GAC9B,GAAIwU,GAAWL,GAA8B,iBAAZK,GAA2C,iBAAZL,EAAsB,CACpF,IAAKK,EAAQ,KAAOL,EAAQ,GAAI,SAChC,IAAK,MAAMM,KAAWN,EAAQ,GAAI,CAChC,MAAMO,EAAUF,EAAQ,GAAGC,GACrBE,EAAUR,EAAQ,GAAGM,GACvBC,GAAWC,GAAWD,EAAQ,KAAOC,EAAQ,IAC/CjG,EAAoBF,KAAK,OAAQ,GAAG2F,EAAQ,OAAOM,SAAeE,EAAQ,QAE9E,CACF,CACF,CAGA,GAAInB,EAAS,QAAUC,EAAS,OAAQ,CACtC,MAAMmB,EAAarX,OAAOgG,KAAKkQ,EAAS,OAAO,MACzCoB,EAAatX,OAAOgG,KAAKiQ,EAAS,OAAO,MAC/C,IAAK,MAAMsB,KAAUD,EACnB,IAAKD,EAAWhT,SAASkT,GAAS,CAChC,MAAMC,EAAUvB,EAAS,OAAO,KAAKsB,GACrCpG,EAAoBH,QAAQ,QAAS,SAASwG,EAAQ,OAAOA,EAAQ,MACvE,CAEJ,CAGA,GAAIvB,EAAS,MAAQC,EAAS,KAAM,CAClC,MAAMuB,EAAczX,OAAOgG,KAAKkQ,EAAS,KAAK,MACxCwB,EAAc1X,OAAOgG,KAAKiQ,EAAS,KAAK,MAC9C,IAAK,MAAM0B,KAAWD,EACpB,IAAKD,EAAYpT,SAASsT,GAAU,CAClC,MAAMC,EAAW3B,EAAS,KAAK,KAAK0B,GACpCxG,EAAoBvC,KAAK,OAAQ,MAAMgJ,EAAS,aAAaA,EAAS,KACxE,CAEJ,CACF,CAgBArL,eAAesL,KACb,IACE,MAAMjG,QAAiBH,EAAcC,kBACrC,GAAIE,GAAYA,EAAS5J,OAAS,GAAK4J,EAAS,GAAGmE,KAAM,CACvD,MAAM+B,EAAehC,GAAkBlE,EAAS,GAAGmE,MAC7CG,GAAW,IAAA6B,WAAU,GAAM3V,YAC3B4V,EAAcjD,GAAWkD,UAAUH,GAEzC,GAAIE,EAAYhH,QACd,GAAM5O,WAAa4V,EAAYjC,KAC3BO,IAAoBC,eAAe2B,WAAW7B,IAClDC,IAAqB,MAChB,CAEL,GADAjU,QAAQuK,MAAM,yBAA0BoL,EAAYpL,QAC/C0J,GAAoB,CACvB,MAAM6B,EAAaH,EAAYpL,MAAMwL,OAAO,GACtCC,EAAe,OAAOF,EAAWG,KAAKC,KAAK,gBAAgBJ,EAAW1H,UAC5EU,EAAoBvE,MAAM,SAAUyL,GACpC9B,eAAeiC,QAAQnC,GAAwB,QAC/CC,IAAqB,CACvB,CACA,GAAMlU,WAAa0V,CACrB,CAEA,MAAMW,EAAqB7G,EAAS,GAAGnB,QACjCiI,EAAkBD,GAAoB/S,MAAM,qCAAqC,GAAGkF,OACtF8N,IACF,GAAMnD,mBAAqBmD,GAG7BjC,GAAyBP,EAAU,GAAM9T,WAC3C,CACF,CAAE,MAAOwK,GACPvK,QAAQuK,MAAM,aAAcA,EAC9B,CACF,CAEAL,eAAeoM,KACRvC,WApDP7J,iBACE,IACE,MAAMqM,QAAmBtK,EAAgBzB,iBAAiB,QAC1D,IAAK+L,IAAeA,EAAWhO,OAE7B,YADA,GAAMiL,SAAW,GAIrB,CAAE,MAAOjJ,GACPvK,QAAQuK,MAAM,yCAA0CA,GACxD,GAAMiJ,SAAW,EACnB,CACF,CAyCUgD,GACNzC,IAAqB,SAEjByB,KACN,GAAMxC,SAAU,EAChBhT,QAAQC,IAAI,+CACd,CAEA,SAASwW,GAAWC,GAClB,MAAMhD,EAAkC,CAAC,EACnC5G,EAAQ4J,EAAMnO,OAAOS,MAAM,MACjC,IAAI2N,EAAa,GACjB,IAAK,MAAM1O,KAAQ6E,EAAO,CACxB,MAAM1E,EAAiBH,EAAKI,QAAQ,KACpC,IAAwB,IAApBD,EAAuB,CACzB,MAAMzL,EAAMsL,EAAKK,UAAU,EAAGF,GAAgBG,OACxChK,EAAQ0J,EAAKK,UAAUF,EAAiB,GAAGG,OAC7C5L,IAEF+W,EAAK/W,GAAO4B,EACZoY,EAAaha,EAEjB,MAAWga,GAAc1O,EAAKM,SAC5BmL,EAAKiD,IAAe,KAAO1O,EAE/B,CAEA,IAAK,MAAMtL,KAAO+W,EAChBA,EAAK/W,GAAO+W,EAAK/W,GAAK4L,OAExB,OAAOmL,CACT,CA4IA,IAAI7T,IAAgB,EAcb,MAAM,GAAU,CACrByW,eACAM,aA3DF1M,eAA4B2M,GAC1B,GAAKA,EAAWtO,OAAhB,CACK,GAAMyK,eAAesD,KAE1B,GAAMjD,cAAe,EACrB,GAAME,oBAAsBsD,EAE5B,IACE,MAAMvV,EAASJ,EAAeC,kBAAkB0V,EAAY,GAAM9W,WAAY,IACxE+W,EAAmB5V,EAAe4E,iBAAiBxE,EAAQuV,EAAY,GAAM9W,WAAYgT,IAE/F/S,QAAQC,IAAI,qEAEZ,MACM8W,ECxRH,SAAqBvS,GAC1B,IAAIwS,EAAgBxS,EAIpBwS,EAAgBA,EAAc3L,QAAQ,oBAAqBhI,GAClDA,EAAMsF,WAAW,MAAQ,cAAgB,cAIlDqO,EAAgBA,EAAc3L,QAAQ,uCAAwChI,GACrEA,EAAMsF,WAAW,MAAQ,aAAe,aAI5CqO,EAAchV,SAAS,gBAC1BgV,EAAgB,4BAA8BA,GAIhD,MAAMC,EAAoBD,EAAc3O,QAAQ,cAC1C6O,EAAqBF,EAAc3O,QAAQ,eAC3C8O,EAAmBH,EAAc3O,QAAQ,cAEpB,IAAvB4O,IAAoD,IAAxBC,KACJ,IAAtBC,GAA2BA,EAAmBF,EAEhDD,EACEA,EAAcjO,MAAM,EAAGoO,GAAoB,gBAAkBH,EAAcjO,MAAMoO,GAGnFH,GAAiB,iBAMrBA,EAAgBA,EAAc3L,QADR,oCAC+B,CAAChI,EAAOkB,IAEpD,aADkBA,EAAQ8G,QAAQ,OAAQ,kBAKnD,MAAM+L,EAAwBJ,EAAc3O,QAAQ,gBAGrB,IAA3B+O,GAAiCJ,EAAchV,SAAS,eAC1DgV,EACEA,EAAcjO,MAAM,EAAGqO,EAAwB,IAC/C,wBACAJ,EAAcjO,MAAMqO,EAAwB,KAIhD,MAAMC,EAAwBL,EAAc3O,QAAQ,aAC9CiP,EAAoBN,EAAc3O,QAAQ,cAEhD,IAA+B,IAA3BgP,IAAuD,IAAvBC,EAA0B,CAE5D,MAAMC,EAAeP,EAAc3O,QAAQ,IAAKgP,EAAwB,IAClD,IAAlBE,EACFP,EAAgBA,EAAcjO,MAAM,EAAGwO,GAAgB,eAAiBP,EAAcjO,MAAMwO,GAG5FP,GAAiB,cAErB,CAEA,OAAOA,CACT,CDmN6BQ,OADGpI,EAAcM,mBAAmBmH,EAAYC,UA5G7E5M,eAAiCuN,GAC/B,IAAKA,EAAU,OAGf,MAAMC,EAAgBD,EAASpU,MAAM,mCAC/B4P,EAAYyE,EAAgBA,EAAc,GAAGnP,OAAS,IACxD0K,GAAcwE,EAASzV,SAAS,sBAClC,GAAMkR,mBAAqBD,IAAcwE,EAASzV,SAAS,cAAgB,GAAKyV,IAIlF,MAAME,EAAW,4BACjB,IAAIC,EACJ,KAAgD,QAAxCA,EAAWD,EAASE,KAAKJ,KAAqB,CACpD,MAAMf,EAAQD,GAAWmB,EAAS,IAClC,GAAIlB,GAASA,EAAM,MAAO,CACxB,MAAMoB,EAAc,CAClB,GAAIC,SAASrB,EAAM,MAAO,IAC1B,GAAIA,EAAM,OAAS,OACnB,GAAIA,EAAM,OAAS,MACnB,GAAIA,EAAM,OAAS,OACnB,GAAIA,EAAM,OAAS,OACnB,GAAIA,EAAM,OAAS,GACnB,KAAMA,EAAM,SAAW,GACvB,GAAIA,EAAM,MACNA,EAAM,MACHrL,QAAQ,UAAW,IACnBrC,MAAM,KACN3D,IAAI2S,GAAKA,EAAEzP,QACXtJ,OAAOgZ,SACV,GACJ,KAAMvB,EAAM,SAAW,GACvB,MAAOA,EAAM,UAAY,GACzB,KAAMA,EAAM,SAAW,GACvB,MAAOA,EAAM,UAAY,IAEtB,GAAMlD,SAAS0E,KAAKjY,GAAOA,EAAI,KAAO6X,EAAY,KACrD,GAAMtE,SAASzU,KAAK+Y,EAExB,CACF,CACA,GAAIH,EAAS5U,KAAK0U,GAAW,CAE3B,GAAMjE,SAAS/N,KAAK,CAACjI,EAAGkI,IAAMlI,EAAE,GAAKkI,EAAE,IACvC,MAAMyS,EAAiB,GAAM3E,SAC1BnO,IAAIpF,GACHtC,OAAOwF,QAAQlD,GACZoF,IAAI,EAAE1I,EAAK4B,KAAW,GAAG5B,KAAOkI,MAAMwI,QAAQ9O,GAASA,EAAM2X,KAAK,KAAO3X,KACzE2X,KAAK,OAETA,KAAK,qBACFjK,EAAgBrB,gBAAgB,OAAQuN,EAAgB,CAAErN,WAAW,EAAMnH,KAAM,CAAC,SAC1F,CAGA,MAAMyU,EAAoBX,EAASpU,MAAM,iDACnCgV,EAAeD,EAAoBA,EAAkB,GAAG7P,OAAS,KAEvE,GAAI8P,EAAc,CAChB,MAAMC,EAAiBD,EAAahV,MAAM,uCAC1C,GAAIiV,GAAkBA,EAAe,GAAI,CACvC,MAAMC,EAAcD,EAAe,GAAG/P,OACtC,IACE,MAAMiQ,EAAQ1M,KAAK2M,MAAMF,GACnB1E,GAAW,IAAA6B,WAAU,GAAM3V,YAC3B2Y,QAAqBtJ,EAAcgB,gBAAgBoI,EAAO3E,GAEhE,GAAI6E,EAAc,CAChB,MAAMC,EAAgBlF,GAAkBiF,GAClC/C,EAAcjD,GAAWkD,UAAU+C,GACzC,GAAIhD,EAAYhH,QACd,GAAM5O,WAAa4V,EAAYjC,KAC3BO,IAAoBC,eAAe2B,WAAW7B,IAClDC,IAAqB,MAChB,CAEL,GADAjU,QAAQuK,MAAM,gDAAiDoL,EAAYpL,QACtE0J,GAAoB,CACvB,MAAM6B,EAAaH,EAAYpL,MAAMwL,OAAO,GACtCC,EAAe,OAAOF,EAAWG,KAAKC,KAAK,gBAAgBJ,EAAW1H,UAC5EU,EAAoBvE,MAAM,SAAUyL,GACpC9B,eAAeiC,QAAQnC,GAAwB,QAC/CC,IAAqB,CACvB,CACA,GAAMlU,WAAa4Y,CACrB,CACAvE,GAAyBP,EAAU,GAAM9T,WAC3C,CACF,CAAE,MAAO6J,GACP5J,QAAQuK,MAAM,yCAA0CX,GACxDkF,EAAoBvE,MAAM,SAAU,eACtC,CACF,CACF,CACF,CAkBUqO,CAAkB7B,GAExB,MAAMxH,QAAiBH,EAAcC,kBACrC,GAAIE,GAAYA,EAAS5J,OAAS,EAAG,CACnC,MAAMkT,EAActJ,EAAS,GAC7BsJ,EAAYzK,QAAU2I,EACtB,MAAM+B,EAAUD,EAAYnF,MAAQ,CAAC,EACrCoF,EAAQ9S,WAAY,IAAA0P,WAAU,GAAM3V,YACpC8Y,EAAYnF,KAAOoF,QACbzO,aAAa0O,gBAAgB,CAACF,GAAc,CAAEG,QAAS,QAC/D,CACF,CAAE,MAAOzO,GACPvK,QAAQuK,MAAM,WAAYA,GAC1B,MAAMyL,EAAezL,aAAiB4E,MAAQ5E,EAAM6D,QAAU6K,OAAO1O,GACrE,GAAM+I,gBAAkB,WAAW0C,IACnClH,EAAoBvE,MAAM,OAAQ,kBACpC,C,QACE+D,WACE,KACE,GAAM+E,cAAe,EACrB,GAAMC,gBAAkB,MAE1B,GAAMA,gBAAkB,IAAO,EAEnC,CAvC8B,CAwChC,EAmBE4F,iBAAkBhP,UAChB,MAAMiP,EAAkBnK,EAAelR,IAAI,mBAC3CkC,QAAQC,IAAI,+BACZ,IACE6O,EAAoBF,KAAK,aAAc,iBACjCuK,EAAgBC,iBACxB,CAAE,MAAO7O,GACPvK,QAAQuK,MAAM,iBAAkBA,GAChCuE,EAAoBvE,MAAM,OAAQA,aAAiB4E,MAAQ5E,EAAM6D,QAAU,OAC7E,GAEFiL,yBA1BF,WACMxZ,KACJG,QAAQC,IAAI,8DAEZqZ,QAAQC,cAAcC,iBAAkB,KACtClL,WAAW,IAAMkH,KAAiB,OAGpC3V,IAAgB,EAChBG,QAAQC,IAAI,uCACd,GE7TMwZ,GAAc,sCACdC,GAA6B,yCAE7B,IAAQ,IAAA5L,UAA0B,CACtC6L,WAAW,EACXC,WAAYC,aAAa1F,QAAQsF,KAAgB,GACjDK,mBAAoBD,aAAa1F,QAAQuF,KAA+B,KAGpE,GAAU,CACd,IAAAxL,GACM,GAAMoF,kBAER,GAAMsG,WAAa,GAAME,oBAE3B,GAAMH,WAAY,CACpB,EAEA,IAAApL,GACE,GAAMoL,WAAY,CACpB,EAEA,QAAAI,CAASxb,GACP,GAAMqb,WAAarb,EACnBsb,aAAa1D,QAAQsD,GAAalb,EACpC,EAEA,qBAAAyb,CAAsBzb,GACpB,GAAMub,mBAAqBvb,EAC3Bsb,aAAa1D,QAAQuD,GAA4Bnb,EACnD,EAEA,UAAA0b,GACE,GAAML,WAAa,GACnBC,aAAahE,WAAW4D,GAC1B,GAGWS,IAAkB,IAAAC,UAAS,IAC3BC,GAAoB,GCnB1B,MAAMC,GAAW,IA3BxB,MACUC,OAA0C,CAAC,EAEnD,EAAAC,CAAGC,EAAeC,GACX3b,KAAKwb,OAAOE,KACf1b,KAAKwb,OAAOE,GAAS,IAEvB1b,KAAKwb,OAAOE,GAAOzb,KAAK0b,EAC1B,CAEA,GAAAC,CAAIF,EAAeC,GACZ3b,KAAKwb,OAAOE,KACjB1b,KAAKwb,OAAOE,GAAS1b,KAAKwb,OAAOE,GAAOvb,OAAO0b,GAAMA,IAAOF,GAC9D,CAEA,IAAAG,CAAKJ,KAAkBK,GAChB/b,KAAKwb,OAAOE,IACjB1b,KAAKwb,OAAOE,GAAOpb,QAAQqb,IACzB,IACEA,KAAYI,EACd,CAAE,MAAOjR,GACP5J,QAAQuK,MAAM,8BAA8BiQ,KAAU5Q,EACxD,GAEJ,GC2FK,MAAMkR,GAAgB,IAjH7B,MACmBC,mBAAqB,WACrBC,sBAAwB,WACxBC,qBAAuB,WAEhCC,OAAS,CACfC,mBAAoB,GACpBC,qBAAsB,GACtBC,oBAAqB,IAGhB,kBAAMC,CAAa9H,GACxBxT,QAAQC,IAAI,mEACZ,UACQnB,KAAKyc,oBAAoB/H,SACzB1U,KAAK0c,sBAAsBhI,SAC3B1U,KAAK2c,qBAAqBjI,GAChCxT,QAAQC,IAAI,0DACZoa,GAASO,KAAK,gBAChB,CAAE,MAAOrQ,GACPvK,QAAQuK,MAAM,iDAAkDA,EAClE,CACF,CAEO,yBAAMgR,CAAoB/H,GAC/B,MAAMkI,EAAOlI,EAASzK,OAAOjK,KAAKoc,OAAOC,oBACzC,GAAoB,IAAhBO,EAAK/V,OAEP,kBADM7G,KAAK6c,YAAY7c,KAAKic,mBAAoB,WAIlD,MAAM5O,EAAauP,EAChBrW,IAAIpF,GACI,CACL,MAAMA,EAAI,KACV,MAAMA,EAAI,KACV,MAAMA,EAAI,KACV,MAAMA,EAAI,KACV,MAAMA,EAAI,KACV,MAAMA,EAAI,KACV,QAAQA,EAAI,MAAQ,MACpB,QAAQA,EAAI,MAAQ,MACpB,SAASA,EAAI,OAAS,MACtB,SAASA,EAAI,OAAS,OACtBiW,KAAK,OAERA,KAAK,qBAEFpX,KAAK6c,YAAY7c,KAAKic,mBAAoB5O,EAAW5D,QAC3DvI,QAAQC,IAAI,0CACd,CAEO,2BAAMub,CAAsBhI,GACjC,MAAMkI,EAAOlI,EAASzK,OAAOjK,KAAKoc,OAAOE,sBACzC,GAAoB,IAAhBM,EAAK/V,OAEP,kBADM7G,KAAK6c,YAAY7c,KAAKkc,sBAAuB,WAIrD,MAAM7O,EAAauP,EAChBrW,IAAIpF,IACH,MAAM2b,EAAkB3b,EAAI,MAAMoD,MAAM,sBAAsB,IAAM,IAC9DwY,EAAiB5b,EAAI,MAAMoD,MAAM,sBAAsB,IAAM,IACnE,MAAO,CACL,MAAMpD,EAAI,KACV,MAAMA,EAAI,KACV,MAAMA,EAAI,KACV,MAAMA,EAAI,KACV,QAAQ2b,IACR,QAAQC,KACR3F,KAAK,QAERA,KAAK,qBAEFpX,KAAK6c,YAAY7c,KAAKkc,sBAAuB7O,EAAW5D,QAC9DvI,QAAQC,IAAI,6CACd,CAEO,0BAAMwb,CAAqBjI,GAChC,MAAMkI,EAAOlI,EAASzK,OAAOjK,KAAKoc,OAAOG,qBACzC,GAAoB,IAAhBK,EAAK/V,OAEP,kBADM7G,KAAK6c,YAAY7c,KAAKmc,qBAAsB,WAIpD,MAAM9O,EAAauP,EAChBrW,IAAIpF,IACH,MAAM6b,EAAe7b,EAAI,MAAMoD,MAAM,sBAAsB,IAAM,IACjE,MAAO,CAAC,MAAMpD,EAAI,KAAM,MAAMA,EAAI,KAAM,QAAQ6b,KAAgB5F,KAAK,QAEtEA,KAAK,qBAEFpX,KAAK6c,YAAY7c,KAAKmc,qBAAsB9O,EAAW5D,QAC7DvI,QAAQC,IAAI,4CACd,CAEQ,iBAAM0b,CAAYhf,EAAa4H,SAC/B0H,EAAgBrB,gBAAgBjO,EAAK4H,EAAS,CAClDuG,WAAW,EACXnH,KAAM,CAAChH,IAEX,CAEO,SAAAof,GACL,OAAOjd,KAAKoc,MACd,CAEO,SAAAc,CAAUC,GACfnd,KAAKoc,OAAS,IAAKpc,KAAKoc,UAAWe,GACnCjc,QAAQC,IAAI,kCAAmCnB,KAAKoc,OACtD,GCvGF,SAAS,GAAWxE,GAClB,MAAMhD,EAAkC,CAAC,EACnC5G,EAAQ4J,EAAMnO,OAAOS,MAAM,MACjC,IAAI2N,EAAa,GACjB,IAAK,MAAM1O,KAAQ6E,EAAO,CACxB,MAAM1E,EAAiBH,EAAKI,QAAQ,KACpC,IAAwB,IAApBD,EAAuB,CACzB,MAAMzL,EAAMsL,EAAKK,UAAU,EAAGF,GAAgBG,OACxChK,EAAQ0J,EAAKK,UAAUF,EAAiB,GAAGG,OACjDmL,EAAK/W,GAAO4B,EACZoY,EAAaha,CACf,MAAWga,GAAc1O,EAAKM,SAC5BmL,EAAKiD,IAAe,KAAO1O,EAE/B,CACA,IAAK,MAAMtL,KAAO+W,EAChBA,EAAK/W,GAAO+W,EAAK/W,GAAK4L,OAExB,OAAOmL,CACT,CA8IO,MAAMwI,GAAiB,IA5I9B,MACUC,gBAA8B,KAC9BC,WAAY,EAEb,YAAAC,CAAaC,EAAW,MACzBxd,KAAKqd,iBACPrd,KAAKyd,cAEPvc,QAAQC,IAAI,wDAAwDqc,QACpExd,KAAKqd,gBAAkBK,YAAY,IAAM1d,KAAK2d,mBAAoBH,GAClExd,KAAK2d,kBACP,CAEO,WAAAF,GACDzd,KAAKqd,kBACPO,cAAc5d,KAAKqd,iBACnBrd,KAAKqd,gBAAkB,KACvBnc,QAAQC,IAAI,kDAEhB,CAEO,sBAAMwc,GACX,GAAI3d,KAAKsd,UACPpc,QAAQC,IAAI,+DADd,CAIAnB,KAAKsd,WAAY,EACjBpc,QAAQC,IAAI,2DAEZ,IACE,MAAMsP,QAAiBH,EAAcC,kBACrC,IAAKE,EAEH,YADAzQ,KAAKsd,WAAY,GAInB,MAAMO,EAAiC,GACjCC,EAAgB,4BAEtB,IAAK,MAAMxO,KAAWmB,EAAU,CAC9B,GAAInB,EAAQyO,QAAS,SAErB,IAAIxZ,EACJ,KAAyD,QAAjDA,EAAQuZ,EAAc/E,KAAKzJ,EAAQA,WACzC,IACE,MAAMsI,EAAQ,GAAWrT,EAAM,IAC3BqT,GAASA,EAAM,OACjBiG,EAAc5d,KAAK,CACjB,GAAIgZ,SAASrB,EAAM,MAAO,IAC1B,GAAIA,EAAM,OAAS,OACnB,GAAIA,EAAM,OAAS,MACnB,GAAIA,EAAM,OAAS,OACnB,GAAIA,EAAM,OAAS,OACnB,GAAIA,EAAM,OAAS,GACnB,KAAMA,EAAM,SAAW,GACvB,GAAIA,EAAM,MACNA,EAAM,MACHrL,QAAQ,UAAW,IACnBrC,MAAM,KACN3D,IAAI2S,GAAKA,EAAEzP,QACXtJ,OAAOgZ,SACV,GACJ,KAAMvB,EAAM,SAAW,GACvB,MAAOA,EAAM,UAAY,GACzB,MAAOA,EAAM,UAAY,GACzB,KAAMA,EAAM,SAAW,IAG7B,CAAE,MAAO9M,GACP5J,QAAQuK,MAAM,gDAAiDX,EACjE,CAEJ,CAEA,GAA6B,IAAzB+S,EAAchX,OAGhB,OAFA3F,QAAQC,IAAI,0EACZnB,KAAKsd,WAAY,GAInB,MAAMU,EAAiB,IAAIlY,IAAI,GAAM4O,SAASnO,IAAIpF,GAAOA,EAAI,KACvD8c,EAAUJ,EAAc1d,OAAOgB,IAAQ6c,EAAe9b,IAAIf,EAAI,MAAQ6J,MAAM7J,EAAI,KAEtF,GAAI8c,EAAQpX,OAAS,EAAG,CAEtBoX,EAAQtX,KAAK,CAACjI,EAAGkI,IAAMlI,EAAE,GAAKkI,EAAE,IAGhC,GAAM8N,SAAW,IAAI,GAAMA,YAAauJ,GAAStX,KAAK,CAACjI,EAAGkI,IAAMlI,EAAE,GAAKkI,EAAE,IAGjDqX,EACrB1X,IAAIpF,GACItC,OAAOwF,QAAQlD,GACnBoF,IAAI,EAAE1I,EAAK4B,KAAW,GAAG5B,KAAOkI,MAAMwI,QAAQ9O,GAASA,EAAM2X,KAAK,MAAQ3X,KAC1E2X,KAAK,OAETA,KAAK,eANR,MAQM7J,QAAwBJ,EAAgBzB,iBAAiB,QACzDwS,EAAuBD,EAC1B1X,IAAIpF,IACH,MAAMgd,EAAWtf,OAAOwF,QAAQlD,GAC7BoF,IAAI,EAAE1I,EAAK4B,KAAW,GAAG5B,KAAOkI,MAAMwI,QAAQ9O,GAASA,EAAM2X,KAAK,MAAQ3X,KAC1E2X,KAAK,MAER,OAAO7J,GAAmBA,EAAgBrK,SAAS,MAAM/B,EAAI,MAAQ,KAAOgd,IAE7Ehe,OAAOgZ,SACP/B,KAAK,eAEJ8G,SACI/Q,EAAgBC,cAAc,OAAQ8Q,EAAsB,eAClElO,EAAoBH,QAAQ,SAAU,SAASoO,EAAQpX,gBACvD3F,QAAQC,IAAI,6BAA6B8c,EAAQpX,wCAEjD3F,QAAQC,IAAI,8FAEd6O,EAAoBH,QAAQ,SAAU,SAASoO,EAAQpX,gBACvD3F,QAAQC,IAAI,2BAA2B8c,EAAQpX,0BACjD,MACE3F,QAAQC,IAAI,oEAEhB,CAAE,MAAOsK,GACPvK,QAAQuK,MAAM,0CAA2CA,EAC3D,C,QAEE,UACQuQ,GAAcS,oBAAoB,GAAM/H,gBACxCsH,GAAcU,sBAAsB,GAAMhI,gBAC1CsH,GAAcW,qBAAqB,GAAMjI,UAC/CxT,QAAQC,IAAI,iEACd,CAAE,MAAOid,GACPld,QAAQuK,MAAM,sEAAuE2S,EACvF,CACApe,KAAKsd,WAAY,CACnB,CA/GA,CAgHF,GCpKIe,IAAgB,IAAArP,UAAS,IAAInO,KAgE5B,MAAMyd,GAAa,CACxBC,SA5Dc,IAAAC,UAAS,KACvB,MAAMvd,EAAa,GAAMA,WACzB,IAAKA,GAAY,KAAM,MAAO,GAE9B,MAAMwd,EAAa,GACnB,IAAK,MAAMnd,KAAUL,EAAW,KAAM,CACpC,GAAIK,IAAW2S,GAAS,SAExB,MAAM1S,EAAON,EAAW,KAAKK,GACzBC,GAAwB,iBAATA,GACjBkd,EAAKxe,KAAKsB,EAEd,CACA,OAAOkd,IAgDPC,+BA1CFtT,iBACqB,GAAMnK,YAKzBod,GAAcjd,QACdF,QAAQC,IAAI,4DAJVD,QAAQuM,KAAK,+DAKjB,EAmCEkR,gBAjCF,SAAyBld,GACvB,OAAO4c,GAAcrf,IAAIyC,IAAKC,MAAQD,CACxC,EAgCEmd,eAxBF,SAAwBnd,GACtB,MAAMF,GAAO,IAAAvC,KAAI,GAAO,mBAAmByC,KAC3C,OAAIF,GAAwB,iBAATA,EACVA,EAAK,GAEPE,IAAOwS,GAAU,IAAMxS,CAChC,EAmBEod,SAjBF,SAAkBC,GAChB,MAAM7d,EAAa,GAAMA,WACzB,IAAKA,GAAY,KAAM,OAAO,KAE9B,IAAK,MAAMQ,KAAMR,EAAW,KAC1B,GAAIA,EAAW,KAAKQ,KAAQqd,EAC1B,OAAOrd,EAGX,OAAO,IACT,EAQE4c,iBACAU,sBAjCF,SAA+Btd,GAC7B,MAAM6B,EAAW+a,GAAcrf,IAAIyC,IAAK6B,SACxC,OAAKA,GACE+a,GAAcrf,IAAIsE,IAAW5B,MADd,IAExB,GC/CM,GAA+Bsd,OCI/B,GAAgB,QAChBC,GAAmB,MAEnBC,GAAkB,CAAC,OAAQ,QAC3BC,GAAsB,QACtBC,GAAoC,CACxC,WACA,WACA,WACA,QA6TK,MAAM/E,GAAkB,IA/S/B,MACSgF,YAA0B,GAC1BC,UAAwB,GACxBC,WAA8B,KAC9BC,YAAsB,EACtBC,mBAA6B,EAC5BC,iBACAC,gBAAiB,EAEzB,WAAAC,GACE5f,KAAK6f,kBACL7f,KAAK8f,oBACL9f,KAAK+f,iBAEP,CAEQ,uBAAMC,GACPhgB,KAAK2f,uBACF3f,KAAKigB,mBACXjgB,KAAK2f,gBAAiB,EAE1B,CAEQ,eAAAE,GACN,IAAK,IAAIjV,EAAI,EAAGA,GA7CK,EA6CkBA,IACrC5K,KAAKqf,YAAYpf,KAAK,CAAEwB,GAAI,MAAMmJ,IAAKlJ,KAAM,QAAQkJ,IAAKsV,UAAW,KAAMtL,KAAM,OAEnF,IAAK,MAAMnT,KAAMyd,GACflf,KAAKsf,UAAUrf,KAAK,CAAEwB,KAAIC,KAAM,QAAQD,EAAGyI,MAAM,KAAK,KAAMgW,UAAW,KAAMtL,KAAM,OAErF5U,KAAKuf,WAAa,CAAE9d,GAAI0d,GAAqBzd,KAAM,OAAQwe,UAAW,KAAMtL,KAAM,KACpF,CAEA,sBAAMqL,GACJ,IACE,MAAMhU,QAAmBV,aAAaC,mBAAmB,IACzD,IAAKS,EAAY,OAEjB,MAAMkU,EAAcC,IAClB,MAAMxU,EAAQK,EAAWjJ,KAAM8H,GAAWA,EAAEe,UAAY,GAAGoT,KAAmBmB,EAAK3e,MACnF,GAAImK,GAASA,EAAMnG,QACjB,IACE2a,EAAKxL,KAAO5H,KAAK2M,MAAM/N,EAAMnG,SAC7B2a,EAAKF,UAAYE,EAAKxL,KAAKsL,UAC3BE,EAAKC,aAAeD,EAAKxL,KAAKyL,aAC9BD,EAAKE,cAAgBF,EAAKxL,KAAK0L,cAC/BF,EAAKG,SAAW3U,EAAMQ,GACxB,CAAE,MAAOtB,GACP5J,QAAQuK,MAAM,QAAQ2U,EAAK3e,SAAUqJ,GACrCsV,EAAKF,UAAY,OACjBE,EAAKxL,KAAO,IACd,MAEAwL,EAAKF,UAAY,KACjBE,EAAKxL,KAAO,KACZwL,EAAKG,cAAWpiB,GAIpB6B,KAAKqf,YAAY/e,QAAQ6f,GACzBngB,KAAKsf,UAAUhf,QAAQ6f,GACnBngB,KAAKuf,YACPY,EAAWngB,KAAKuf,WAEpB,CAAE,MAAO9T,GACPvK,QAAQuK,MAAM,aAAcA,GAC5B,SAAa,YACf,CACF,CAEA,cAAM+U,CAASC,EAAgBC,GAAa,SACpC1gB,KAAKggB,oBACNU,GACH,QAAY,YAAYD,SAG1B,IACE,MAAMhQ,QAAiBlF,aAAamF,gBAAgB,KACpD,IAAKD,GAAgC,IAApBA,EAAS5J,OACxB,MAAM,IAAIwJ,MAAM,oBAElB,MAAM0J,EAActJ,EAAS,GACvByP,GAAY,IAAIvN,MAAOgO,cAEvBC,EAA4C,CAAC,EACnD,IAAK,MAAM/iB,KAAOuhB,GAAyB,CACzC,MAAM3Z,QAAgB0H,EAAgBzB,iBAAiB7N,GACvD+iB,EAAe/iB,GAAO4H,GAAW,EACnC,CAEA,MAAMuD,EAAQkH,EAAelR,IAAI,SAC3B6hB,EAAe7X,EAAM0L,SAAS7N,OAAS,EAAImC,EAAM0L,SAAS1L,EAAM0L,SAAS7N,OAAS,GAAK,KAEvFia,EAAW,CACfZ,YACAa,SAAUhH,EAAYnF,KACtBoM,gBAAiBjH,EAAYzK,QAC7B2R,gBAAiBL,EACjBP,aAAcQ,GAAc,GAC5BP,cAAeO,GAAc,IAGzBhV,EAAU,GAAGoT,KAAmBwB,IAEhCS,SADmB3V,aAAaC,mBAAmB,KACxBxI,KAAM8H,GAAWA,EAAEe,UAAYA,GAE5DqV,QACI3V,aAAaY,mBAAmB,GAAe,CACnD,CAAEC,IAAK8U,EAAc9U,IAAK3G,QAASuH,KAAKC,UAAU6T,EAAU,KAAM,YAG9DvV,aAAa2B,sBAAsB,GAAe,CACtD,CACErB,QAASA,EACTpG,QAASuH,KAAKC,UAAU6T,EAAU,KAAM,GACxCjc,KAAM,CAACgH,GACPa,SAAU,6BACVC,MAAO,aAKP3M,KAAKigB,mBACNS,EAGHxf,QAAQC,IAAI,sBAAsBsf,KAFlC,WAAe,aAAaA,MAIhC,CAAE,MAAOhV,GACP,MAAMyL,EAAe,SAASzL,aAAiB4E,MAAQ5E,EAAM6D,QAAU6K,OAAO1O,KAC9EvK,QAAQuK,MAAM,WAAWgV,SAAehV,GACnCiV,GACH,SAAaxJ,EAEjB,CACF,CAEQ,uBAAMiK,CAAkBf,GAC9B,IAAKA,EAAKxL,OAASwL,EAAKxL,KAAKmM,SAC3B,MAAM,IAAI1Q,MAAM,kBAElB,GAAI+P,EAAKxL,KAAKqM,gBACZ,IAAK,MAAMpjB,KAAOuiB,EAAKxL,KAAKqM,sBACpB9T,EAAgBrB,gBAAgBjO,EAAKuiB,EAAKxL,KAAKqM,gBAAgBpjB,IAGzE,MACMkc,SADiBxO,aAAamF,gBAAgB,MACvB,IAAM,CAAC,EACpCqJ,EAAYnF,KAAOwL,EAAKxL,KAAKmM,SAC7BhH,EAAYzK,QAAU8Q,EAAKxL,KAAKoM,sBAC1BzV,aAAa0O,gBAAgB,CAACF,GAAc,CAAEG,QAAS,OAC/D,CAEA,cAAMkH,CAAShB,GACb,GAAKiB,QAAQ,YAAYjB,EAAK1e,4BAA9B,CAGA,QAAY,QAAQ0e,EAAK1e,iBACzB,UACQ1B,KAAKmhB,kBAAkBf,GAC7B,WAAe,SAASA,EAAK1e,uBAC/B,CAAE,MAAO+J,GACP,MAAMyL,EAAe,SAASzL,aAAiB4E,MAAQ5E,EAAM6D,QAAU6K,OAAO1O,KAC9EvK,QAAQuK,MAAM,UAAU2U,EAAK1e,YAAa+J,GAC1C,SAAayL,EACf,CATA,CAUF,CAEA,gBAAMoK,CAAWlB,GACf,GAAKA,EAAKG,UAIV,GAAKc,QAAQ,eAAejB,EAAK1e,sBAAjC,CAGA,QAAY,WAAW0e,EAAK1e,YAC5B,UACQ6J,aAAagW,sBAAsB,GAAe,CAACnB,EAAKG,iBACxDvgB,KAAKigB,mBACX,WAAe,OAAOG,EAAK1e,cAC7B,CAAE,MAAO+J,GACPvK,QAAQuK,MAAM,QAAQ2U,EAAK1e,YAAa+J,GACxC,SAAa,SAASA,aAAiB4E,MAAQ5E,EAAM6D,QAAU6K,OAAO1O,KACxE,CATA,OALE,WAAe,gBAenB,CAEA,qBAAM+V,GACJ,IAAKxhB,KAAKyf,kBAAmB,OAE7Bzf,KAAKwf,cACLzE,aAAa1D,QAAQ,uBAAwBrX,KAAKwf,YAAYiC,YAC9D,MAAMhB,EAASzgB,KAAKwf,YAAc,GAAM,EAAIN,GAAgB,GAAKA,GAAgB,SAC3Elf,KAAKwgB,SAASC,GAAQ,EAC9B,CAEA,wBAAMiB,GACJxgB,QAAQC,IAAI,uDACNnB,KAAKwgB,SAASrB,IAAqB,EAC3C,CAEA,qBAAM7E,GAGJ,SAFMta,KAAKggB,qBAENhgB,KAAKuf,aAAevf,KAAKuf,WAAW3K,KAEvC,MADA,SAAa,kBACP,IAAIvE,MAAM,+BAElBnP,QAAQC,IAAI,iEAGZ4Z,aAAa1D,QAAQ,wCAAyC,cAGxDrX,KAAKmhB,kBAAkBnhB,KAAKuf,YAElC/P,WAAW,IAAMmS,OAAOC,SAASC,SAAU,IAC7C,CAEA,UAAAC,CAAW1B,GACT,IAAKA,EAAKxL,KAER,YADA,WAAe,YAGjB,MAAMmN,EAAU/U,KAAKC,UAAUmT,EAAKxL,KAAM,KAAM,GAC1CoN,EAAW,IAAIC,KAAK,CAACF,GAAU,CAAEpgB,KAAM,qBACvCkR,EAAMqP,IAAIC,gBAAgBH,GAC1BI,EAAOC,SAASC,cAAc,KACpCF,EAAKG,KAAO1P,EACZuP,EAAKI,SAAW,aAAapC,EAAK1e,SAAQ,IAAIiR,MAAOgO,qBACrD0B,SAASI,KAAKC,YAAYN,GAC1BA,EAAKO,QACLN,SAASI,KAAKG,YAAYR,GAC1BF,IAAIW,gBAAgBhQ,GACpB,WAAe,OAAOuN,EAAK1e,aAC7B,CAEA,gBAAMohB,CAAWC,GACf,IACE,MAAMjC,EAAW9T,KAAK2M,MAAMoJ,GAC5B,IAAKjC,EAASZ,YAAcY,EAASC,SACnC,MAAM,IAAI1Q,MAAM,cAGlB,MAAM2S,EAAYhjB,KAAKqf,YAAYrc,KAAKod,IAASA,EAAKxL,MACtD,IAAKoO,EAEH,YADA,SAAa,oBAIf,QAAY,cAAcA,EAAUthB,YAEpC,MAAMmK,EAAU,GAAGoT,KAAmB+D,EAAUvhB,KAE1Cyf,SADmB3V,aAAaC,mBAAmB,KACxBxI,KAAM8H,GAAWA,EAAEe,UAAYA,GAE5DqV,QACI3V,aAAaY,mBAAmB,GAAe,CACnD,CAAEC,IAAK8U,EAAc9U,IAAK3G,QAASuH,KAAKC,UAAU6T,EAAU,KAAM,YAG9DvV,aAAa2B,sBAAsB,GAAe,CACtD,CACErB,QAASA,EACTpG,QAASuH,KAAKC,UAAU6T,EAAU,KAAM,GACxCjc,KAAM,CAACgH,GACPa,SAAU,6BACVC,MAAO,IACPN,SAAS,WAKTrM,KAAKigB,mBACX,WAAe,aAAa+C,EAAUthB,SACxC,CAAE,MAAO+J,GACP,MAAMyL,EAAe,SAASzL,aAAiB4E,MAAQ5E,EAAM6D,QAAU6K,OAAO1O,KAC9EvK,QAAQuK,MAAM,WAAYA,GAC1B,SAAayL,EACf,CACF,CAEA,cAAA+L,CAAe5W,GACbrM,KAAKyf,kBAAoBpT,EACzB0O,aAAa1D,QAAQ,4BAA6BrK,KAAKC,UAAUZ,IACjE,QAAY,SAAQA,EAAU,KAAO,MACvC,CAEQ,iBAAAyT,GACN,MAAMoD,EAAanI,aAAa1F,QAAQ,6BACrB,OAAf6N,IACFljB,KAAKyf,kBAAoBzS,KAAK2M,MAAMuJ,GAExC,CAEQ,eAAAnD,GACN,MAAMoD,EAAepI,aAAa1F,QAAQ,wBACrB,OAAjB8N,IACFnjB,KAAKwf,YAAcvG,SAASkK,EAAc,KAAO,EAErD,GCvUI,GAA+BC,UCC/BC,GAAa,CAAEC,MAAO,eACtBC,GAAa,CAAED,MAAO,oCACtBE,GAAa,CAAEF,MAAO,sBACtBG,GAAa,CAAEH,MAAO,wBACtBI,GAAa,CAAEJ,MAAO,wBACtBK,GAAa,CAAEL,MAAO,8BACtBM,GAAa,CAAEN,MAAO,gBACtBO,GAAa,CAAEP,MAAO,eACtBQ,GAAa,CAAER,MAAO,cACtBS,GAAc,CAAET,MAAO,8BACvBU,GAAc,CAAEV,MAAO,gBACvBW,GAAc,CAAEX,MAAO,eACvBY,GAAc,CAAEZ,MAAO,cACvBa,GAAc,CAChBtmB,IAAK,EACLylB,MAAO,qCAELc,GAAc,CAAEd,MAAO,qCACvBe,GAAc,CAAEf,MAAO,wBACvBgB,GAAc,CAAEhB,MAAO,2BACvBiB,GAAc,CAChB1mB,IAAK,EACLylB,MAAO,sBACPkB,MAAO,CAAE,mBAAoB,UAAW,OAAU,sBAEhDC,GAAc,CAAEnB,MAAO,gBACvBoB,GAAc,CAAEpB,MAAO,cACvBqB,GAAc,CAChB9mB,IAAK,EACLylB,MAAO,gBAELsB,GAAc,CAChB/mB,IAAK,EACLylB,MAAO,eAELuB,GAAc,CAChBhnB,IAAK,EACLylB,MAAO,gBCpCX,MAAM,GAAa,CAAEA,MAAO,gBACtB,GAAa,CAAEA,MAAO,cACtB,GAAa,CAAC,WAAY,WAC1B,GAAa,CAAEA,MAAO,cACtB,GAAa,CAAC,WAAY,WAC1B,GAAa,CAAEA,MAAO,cACtB,GAAa,CAAC,WAAY,WAChC,IAA6B,qBAAiB,CAC1CwB,OAAQ,cACRpnB,MAAO,CACHqnB,aAAc,CAAC,EACfC,YAAa,CAAC,EACdC,cAAe,CAAC,EAChBC,cAAe,CAAC,GAEpBC,MAAO,CAAC,iBAAkB,mBAC1BC,MAAMC,GACK,CAACC,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACzD,wBAAoB,MAAO,GAAY,GAClC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYF,EAAQL,YAAcQ,KAC9E,kBAAc,wBAAoB,SAAU,CAChD3nB,IAAK2nB,EAAO/jB,GACZ6hB,MAAO,gBACPmC,SAAUD,EAAOC,UAAYD,EAAOC,WACpCC,QAASF,EAAOG,SACjB,qBAAiBH,EAAO9f,MAAO,EAAqB,MACvD,SAER,wBAAoB,MAAO,GAAY,GAClC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAY2f,EAAQJ,cAAgBO,KAChF,kBAAc,wBAAoB,SAAU,CAChD3nB,IAAK2nB,EAAO/jB,GACZ6hB,MAAO,gBACPmC,SAAUD,EAAOC,UAAYD,EAAOC,WACpCC,QAASF,EAAOG,SACjB,qBAAiBH,EAAO9f,MAAO,EAAqB,MACvD,SAER,wBAAoB,MAAO,GAAY,GAClC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAY2f,EAAQH,cAAgBM,KAChF,kBAAc,wBAAoB,SAAU,CAChD3nB,IAAK2nB,EAAO/jB,GACZ6hB,MAAO,gBACPmC,SAAUD,EAAOC,UAAYD,EAAOC,WACpCC,QAASF,EAAOG,SACjB,qBAAiBH,EAAO9f,MAAO,EAAqB,MACvD,OACJ,wBAAoB,SAAU,CAC1B4d,MAAO,gBACPoC,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAYN,EAAKO,MAAM,oBAC5D,OACH,wBAAoB,SAAU,CAC1BvC,MAAO,gBACPoC,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAYN,EAAKO,MAAM,qBAC5D,QAAS,qBAAiBR,EAAQN,cAAgB,IAAK,U,cCnD9E,MAEA,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCFjEe,GAAqB,qCACrBC,GAAoB,oCA0EnB,MAAMC,GAAsB,IAxEnC,MACSjX,OAAQ,IAAAC,UAAS,CACtBiX,OAAQ,GACRC,MAAO,KAGT,WAAAtG,GACE5f,KAAKmmB,aACP,CAEQ,WAAAA,GACN,MAAMC,EAAarL,aAAa1F,QAAQyQ,IAClCO,EAAYtL,aAAa1F,QAAQ0Q,IACnCK,IACFpmB,KAAK+O,MAAMkX,OAASjZ,KAAK2M,MAAMyM,IAE7BC,IACFrmB,KAAK+O,MAAMmX,MAAQlZ,KAAK2M,MAAM0M,GAElC,CAEQ,WAAAC,GACNvL,aAAa1D,QAAQyO,GAAoB9Y,KAAKC,UAAUjN,KAAK+O,MAAMkX,SACnElL,aAAa1D,QAAQ0O,GAAmB/Y,KAAKC,UAAUjN,KAAK+O,MAAMmX,OACpE,CAEA,GAAA/f,CAAIogB,GACF,IAAKA,GAA0B,KAAjBA,EAAM9c,OAClB,OAGF,MAAM+c,EAAgBxmB,KAAK+O,MAAMkX,OAAO1c,QAAQgd,GAC5CC,GAAiB,GACnBxmB,KAAK+O,MAAMkX,OAAOrW,OAAO4W,EAAe,GAG1CxmB,KAAK+O,MAAMkX,OAAOQ,QAAQF,GACtBvmB,KAAK+O,MAAMkX,OAAOpf,OA1CC,GA2CrB7G,KAAK+O,MAAMkX,OAAO7X,MAEpBpO,KAAKsmB,aACP,CAEA,IAAAI,CAAK9a,GACC5L,KAAK+O,MAAMmX,MAAMhjB,SAAS0I,KAI9B5L,KAAK+O,MAAMmX,MAAMO,QAAQ7a,GACrB5L,KAAK+O,MAAMmX,MAAMrf,OArDC,GAsDpB7G,KAAK+O,MAAMmX,MAAM9X,MAEnBpO,KAAKsmB,cACP,CAEA,YAAAK,CAAajX,GACX1P,KAAK+O,MAAMkX,OAAOrW,OAAOF,EAAO,GAChC1P,KAAKsmB,aACP,CAEA,WAAAM,CAAYlX,GACV1P,KAAK+O,MAAMmX,MAAMtW,OAAOF,EAAO,GAC/B1P,KAAKsmB,aACP,CAEA,QAAAO,GACE7mB,KAAK+O,MAAMkX,OAAS,GACpBjmB,KAAK+O,MAAMmX,MAAQ,GACnBlmB,KAAKsmB,aACP,GCrEIQ,GAA6C,CACjDC,OAAQ,CAAC,gBACTC,SAAU,CAAC,kBACXC,SAAU,CAAC,mBAkIN,MAAMC,GAAkB,IA/H/B,MACUC,aAA8B,SAC9BC,eAAgC,KAChCC,kBAAmC,KACnCC,aAA4C,OAEpD,WAAA1H,GAEE5f,KAAKunB,SAAS,SAChB,CAKO,eAAAC,GACL,OAAOxnB,KAAKmnB,YACd,CAMO,cAAMI,CAASzS,EAAyB2S,GAAiB,GAC9D,GAAIznB,KAAKmnB,eAAiBrS,IAAa2S,EACrC,OAGFvmB,QAAQC,IAAI,oCAAoCnB,KAAKmnB,mBAAmBrS,cAAqB2S,MAE7F,MAAMC,EAAU7oB,OAAOkE,OAAO+jB,IAAWa,OACnCC,EAAed,GAAUhS,GAG/B,IAAK,MAAM+S,KAAWH,EAAS,CAC7B,MAAMI,EAAkBF,EAAa1kB,SAAS2kB,SACxC1a,EAAgBO,gBAAgBma,EAASC,EACjD,CAEA9nB,KAAKmnB,aAAerS,EACpB5T,QAAQC,IAAI,iCAAiC2T,oBAA2B8S,EAAaxQ,KAAK,QAC5F,CAMO,cAAA2Q,CAAe5T,GACpBnU,KAAKonB,eAAiBjT,EACtBjT,QAAQC,IAAI,sCACd,CAMO,YAAA6mB,GACL,MAAM7T,EAAYnU,KAAKonB,eAKvB,OAJApnB,KAAKonB,eAAiB,KAClBjT,GACFjT,QAAQC,IAAI,8CAEPgT,CACT,CAKO,iBAAA8T,CAAkB1W,GACvBvR,KAAKqnB,kBAAoB9V,EACzBrQ,QAAQC,IAAI,0CACd,CAKO,eAAA+mB,GACL,MAAM3W,EAASvR,KAAKqnB,kBAKpB,OAJArnB,KAAKqnB,kBAAoB,KACrB9V,GACFrQ,QAAQC,IAAI,kDAEPoQ,CACT,CAMO,eAAA4W,CAAgBC,GACrBpoB,KAAKsnB,aAAec,EACpBlnB,QAAQC,IAAI,2CAA2CinB,IACzD,CAMO,mBAAAC,GACL,IAAI5iB,EAAU,GAyBd,MAvB0B,YAAtBzF,KAAKsnB,cAAoD,SAAtBtnB,KAAKsnB,cACtCtnB,KAAKonB,iBACP3hB,GAAW,cAAczF,KAAKonB,2BAC9BlmB,QAAQC,IAAI,6DAIU,SAAtBnB,KAAKsnB,cACHtnB,KAAKqnB,oBACP5hB,GAAW,qBAAqBzF,KAAKqnB,qCACrCnmB,QAAQC,IAAI,iEAKhBnB,KAAKonB,eAAiB,KACtBpnB,KAAKqnB,kBAAoB,KACzBrnB,KAAKsnB,aAAe,OAEhB7hB,GACFvE,QAAQC,IAAI,oDAAqDsE,EAAQoB,QAGpEpB,CACT,GCvII,GAAa,CAAE6d,MAAO,gCACtB,GAAa,CAAEA,MAAO,iBACtB,GAAa,CAAC,QAAS,cAAe,cAM5C,IAA6B,qBAAiB,CAC1CwB,OAAQ,mBACRpnB,MAAO,CACH4qB,YAAa,CACT3mB,KAAMwY,OACNrW,QAAS,aAGjBqhB,MAAO,CAAC,gBAAiB,uBACzB,KAAAC,CAAMC,GAAWvJ,KAAMyM,IACnB,MAAMzM,EAAOyM,EACPzN,GAAa,IAAA0D,UAAS,IAAMpD,GAAgBN,YAC5Clb,GAAW,IAAA4e,UAAS,IAAM7e,EAAec,eACzC+nB,EAAW9M,IACb,MAAM/d,EAAS+d,EAAM/d,OACrB2d,GAAkBL,SAAStd,EAAO8B,QAEhCgpB,EAAe,KACjB,MAAMC,EAAe5N,EAAWrb,MAAMgK,OAChCkf,EAAc/oB,EAASH,MAAMoH,OAAS,EAC5C,IAAK6hB,IAAiBC,EAClB,OAEAD,GACA1C,GAAoB7f,IAAIuiB,GAE5B,IAAIE,EAAkB,GAClBD,IACAC,GAAmB,aAAehpB,EAASH,MAAM8G,IAAIsiB,GAAO,KAAKA,KAAOzR,KAAK,OAE7EsR,IACIC,IACAC,GAAmB,MAEvBA,GAAmB,WAAWF,cAElCxB,GAAgBK,SAAS,UAAU,GACnCzL,EAAK,gBAAiB8M,GACtBjpB,EAAee,iBAEnB,MAAO,CAAC4kB,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACzD,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,SAAU,CAC1BjC,MAAO,0BACPoC,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAYN,EAAKO,MAAM,yBAC5D,MACH,wBAAoB,WAAY,CAC5BpmB,MAAOqb,EAAWrb,MAClB+oB,QAASA,EACTF,YAAajD,EAAQiD,YACrBQ,YAAY,eAAU,mBAAeL,EAAc,CAAC,QAAS,YAAa,CAAC,WAC5E,KAAM,GAAgC,KACzC,wBAAoB,SAAU,CAC1BnF,MAAO,wBACPoC,QAAS+C,GACV,UAInB,IChEE,IAA2B,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBAEvE,MCNM,GAAa,CAAEnF,MAAO,uBACtB,GAAa,CAAEA,MAAO,mBACtB,GAAa,CAAEzlB,IAAK,GACpB,GAAa,CAAC,WACd,GAAa,CAAEylB,MAAO,WACtB,GAAa,CAAC,UAAW,YACzB,GAAa,CAAC,WACd,GAAa,CACfzlB,IAAK,EACLylB,MAAO,cAEL,GAAa,CAAEA,MAAO,mBACtB,GAAc,CAAEzlB,IAAK,GACrB,GAAc,CAAC,WACf,GAAc,CAAEylB,MAAO,WACvB,GAAc,CAAC,WACf,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,cAGX,IAA6B,qBAAiB,CAC1CwB,OAAQ,oBACRK,MAAO,CAAC,eAAgB,SACxB,KAAAC,CAAMC,GAAWvJ,KAAMyM,IACnB,MAAMQ,EAAe/C,GAAoBjX,MACnC+M,EAAOyM,EACPS,EAAYpd,IACdkQ,EAAK,eAAgBlQ,IAWnBqd,EAAWrd,GACNmd,EAAa7C,MAAMhjB,SAAS0I,GAEvC,MAAO,CAAC0Z,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACzD,wBAAoB,MAAO,GAAY,CACnCA,EAAO,KAAOA,EAAO,IAAK,wBAAoB,KAAM,KAAM,QAAS,KAClE,WAAOwD,GAAc9C,OAAOpf,OAAS,IAC/B,kBAAc,wBAAoB,KAAM,GAAY,GAClD,gBAAW,IAAO,wBAAoB,WAAW,MAAM,iBAAY,WAAOkiB,GAAc9C,OAAQ,CAACra,EAAO8D,MAC7F,kBAAc,wBAAoB,KAAM,CAC5C7R,IAAK,UAAU6R,KAChB,EACC,wBAAoB,OAAQ,CACxB4T,MAAO,aACPoC,QAAUE,GAAYoD,EAASpd,KAChC,qBAAiBA,GAAQ,EAAqB,KACjD,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,SAAU,CAC1B8Z,QAAUE,GA5B5B,CAACha,IACfoa,GAAoBU,KAAK9a,IA2B4B,CAAWA,GAChC6Z,SAAUwD,EAAQrd,IACnB,KAAM,EAAe,KACxB,wBAAoB,SAAU,CAC1B8Z,QAAUE,GA7BpB,CAAClW,IACvBsW,GAAoBW,aAAajX,IA4BoB,CAAmBA,IACzC,KAAM,EAAe,UAGhC,WAEL,kBAAc,wBAAoB,IAAK,GAAY,eAE9D,wBAAoB,MAAO,GAAY,CACnC6V,EAAO,KAAOA,EAAO,IAAK,wBAAoB,KAAM,KAAM,QAAS,KAClE,WAAOwD,GAAc7C,MAAMrf,OAAS,IAC9B,kBAAc,wBAAoB,KAAM,GAAa,GACnD,gBAAW,IAAO,wBAAoB,WAAW,MAAM,iBAAY,WAAOkiB,GAAc7C,MAAO,CAACta,EAAO8D,MAC5F,kBAAc,wBAAoB,KAAM,CAC5C7R,IAAK,SAAS6R,KACf,EACC,wBAAoB,OAAQ,CACxB4T,MAAO,aACPoC,QAAUE,GAAYoD,EAASpd,KAChC,qBAAiBA,GAAQ,EAAqB,KACjD,wBAAoB,MAAO,GAAa,EACpC,wBAAoB,SAAU,CAC1B8Z,QAAUE,GAhDrB,CAAClW,IACtBsW,GAAoBY,YAAYlX,IA+CqB,CAAkBA,IACxC,OAAQ,EAAe,UAGlC,WAEL,kBAAc,wBAAoB,IAAK,GAAa,eAE/D,wBAAoB,SAAU,CAC1BgW,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAYN,EAAKO,MAAM,UAC3DvC,MAAO,sBACR,QAGf,IC9FE,IAA2B,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBAEvE,MCNM,GAAa,CAAEA,MAAO,yBACtB,GAAa,CAAEA,MAAO,uBACtB,GAAa,CAAEA,MAAO,yBAE5B,IAA6B,qBAAiB,CAC1CwB,OAAQ,eACRpnB,MAAO,CACHwrB,aAAc,CAAC,GAEnB,KAAA9D,CAAMC,GACF,MAAM3nB,EAAQ2nB,EACR8D,EAAmB,KACrBnZ,EAAoBP,KAAK/R,EAAMwrB,aAAaznB,KAEhD,MAAO,CAAC6jB,EAAMC,MACF,kBAAc,iBAAa,aAAa,CAAE7jB,KAAM,qBAAuB,CAC3EoC,SAAS,aAAS,IAAM,EACpB,wBAAoB,MAAO,CACvBwf,OAAO,oBAAgB,CAAC,eAAgB,iBAAiB+B,EAAQ6D,aAAavnB,SAC9E+jB,QAASyD,GACV,EACC,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,KAAM,IAAY,qBAAiB9D,EAAQ6D,aAAa7Z,OAAQ,IACpF,wBAAoB,IAAK,IAAY,qBAAiBgW,EAAQ6D,aAAa5Z,SAAU,KAEzFiW,EAAO,KAAOA,EAAO,IAAK,wBAAoB,MAAO,CAAEjC,MAAO,uBAAyB,MAAO,KAC/F,KAEPnhB,EAAG,IAGf,IC5BE,GAAc,GAEpB,MCLM,GAAa,CAAEmhB,MAAO,0BAG5B,IAA6B,qBAAiB,CAC1CwB,OAAQ,wBACRM,MAAMC,GACK,CAACC,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,GACxD,gBAAW,IAAO,wBAAoB,WAAW,MAAM,iBAAY,WAAOxV,GAAmBd,cAAgBia,KAClG,kBAAc,iBAAaE,GAAc,CAC7CvrB,IAAKqrB,EAAaznB,GAClBynB,aAAcA,GACf,KAAM,EAAe,CAAC,mBACzB,WCVd,GAAc,GAEpB,MCLM,GAAa,CAAE5F,MAAO,QAC5B,IAA6B,qBAAiB,CAC1CwB,OAAQ,iBACRpnB,MAAO,CACH2rB,KAAM,CAAC,GAEXlE,MAAO,CAAC,QACR,KAAAC,CAAMC,GAAWvJ,KAAMyM,IACnB,MACMzM,EAAOyM,EACPe,EAAe5N,IACjBI,EAAK,OAAQ,CAAEyN,EAAG7N,EAAM8N,QAASC,EAAG/N,EAAMgO,WAE9C,MAAO,CAACpE,EAAMC,MACF,kBAAc,wBAAoB,SAAU,CAChDjC,MAAO,mBACPoC,QAAS4D,GACV,EACC,wBAAoB,OAAQ,IAAY,qBAAiBjE,EAAQgE,MAAO,KAGpF,ICjBE,IAA2B,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBAEvE,MCOaM,IAA0C,IAAAnL,UAAS,KAC9D,IAAK,GAAMvd,WAAY,OAAO,KAC9B,MAAM2oB,GAAS,IAAA5qB,KAAI,GAAMiC,WAAW,KAAMgT,IAC1C,OAAI2V,GAA4B,iBAAXA,EACZA,EAEF,OAMIC,IAAc,IAAArL,UAAS,KAClC,MAAMsL,GAAU,IAAA9qB,KAAI,GAAO,sBAC3B,OAAK8qB,EACE,CACLza,MAAOya,EAAQ,KACfC,QAAS,IAAID,EAAQ,OAAOA,EAAQ,OAAOA,EAAQ,MAHhC,CAAEza,MAAO,OAAQ0a,QAAS,UAUpCC,IAAe,IAAAxL,UAAS,KACnC,MAAMyL,GAAO,IAAAjrB,KAAI,GAAO,sBACxB,IAAKirB,EAAM,MAAO,OAClB,IAEE,OADa,IAAItX,KAAKsX,GAEnBC,eAAe,QAAS,CACvBC,KAAM,UACNC,MAAO,UACPC,IAAK,UACLC,KAAM,UACNC,OAAQ,UACRC,QAAQ,IAETje,QAAQ,MAAO,IACpB,CAAE,MAAOzB,GACP,MAAO,QACT,IAMW2f,IAAoB,IAAAjM,UAAS,IAEjC,gCADW,GAAMpK,oBAAsB,sBCrD1C,IAAQ,IAAApF,UAA2B,CACvC6L,WAAW,EACX6P,UAAW,KACXhtB,MAAO,CAAC,EACR2R,MAAO,KAGIsb,GAAqB,CAIhC5b,OAAO,IAAAsM,UAAS,IAQhB,IAAAjM,CAAKC,EAAeqb,EAAsBhtB,EAA6B,CAAC,GACtE,GAAM2R,MAAQA,EACd,GAAMqb,WAAY,IAAAE,SAAQF,GAC1B,GAAMhtB,MAAQA,EACd,GAAMmd,WAAY,CACpB,EAKA,IAAApL,GACE,GAAMoL,WAAY,EAElBrL,WAAW,KACT,GAAMkb,UAAY,KAClB,GAAMhtB,MAAQ,CAAC,EACf,GAAM2R,MAAQ,IACb,IACL,GC7CI,GAAa,CAAEiU,MAAO,kCACtB,GAAa,CAAEA,MAAO,eACtB,GAAa,CAAEA,MAAO,gBACtB,GAAa,CAAEA,MAAO,eACtB,GAAa,CAAEA,MAAO,gBACtB,GAAa,CAAEA,MAAO,eACtB,GAAa,CAAEA,MAAO,gBACtB,GAAa,CAAEA,MAAO,eACtB,GAAa,CAAEA,MAAO,gBACtB,GAAc,CAAEA,MAAO,0BACvB,GAAc,CAAEA,MAAO,gBACvB,GAAc,CAAEA,MAAO,0BACvB,GAAc,CAAEA,MAAO,gBACvB,GAAc,CAAEA,MAAO,0BACvB,GAAc,CAAEA,MAAO,gBACvB,GAAc,CAAEA,MAAO,gBACvB,GAAc,CAAEA,MAAO,kBACvB,GAAc,CAAEA,MAAO,0BACvB,GAAc,CAAEA,MAAO,gBACvB,GAAc,CAAEA,MAAO,gBACvB,GAAc,CAAEA,MAAO,kBAE7B,IAA6B,qBAAiB,CAC1CwB,OAAQ,gBACRpnB,MAAO,CACHohB,IAAK,CAAC,GAEV,KAAAsG,CAAMC,GACF,MAAM3nB,EAAQ2nB,EACRwF,GAAM,IAAArM,UAAS,IACZ9gB,EAAMohB,IAAI,MAAM,GAEdphB,EAAMohB,IAAI,KAAK,GADX,MAGTgM,GAAqB,IAAAtM,UAAS,KAChC,MAAMuM,EAAKrtB,EAAMohB,IAAI,MAAM,KAC3B,IAAKiM,EACD,MAAO,KACX,MAAMtX,EAAO,IAAId,KAAKoY,GACtB,MAAO,GAAGtX,EAAKuX,iBAAiBvX,EAAKwX,WAAa,KAAKxX,EAAKyX,eAEhE,MAAO,CAAC5F,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACzD,wBAAoB,MAAO,GAAY,CACnCA,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,CAAEjC,MAAO,cAAgB,OAAQ,KACzF,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,IAAK,MAAM,qBAAiB+B,EAAQvG,IAAI,IAAK,QAGzE,wBAAoB,MAAO,GAAY,CACnCyG,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,CAAEjC,MAAO,cAAgB,OAAQ,KACzF,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,IAAK,MAAM,qBAAiBwH,EAAmBrrB,OAAS,MAAO,qBAAiBorB,EAAIprB,OAAS,IAAK,QAG9H,wBAAoB,MAAO,GAAY,CACnC8lB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,CAAEjC,MAAO,cAAgB,OAAQ,KACzF,wBAAoB,MAAO,GAAY,GAClC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAY+B,EAAQvG,IAAI,GAAKqM,KACzE,kBAAc,wBAAoB,OAAQ,CAC9CttB,IAAKstB,EAAK,GACV7H,MAAO,QACR,qBAAiB6H,EAAK,IAAM,OAAQ,qBAAiBA,EAAK,IAAK,KAClE,WAGZ,wBAAoB,MAAO,GAAY,CACnC5F,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,CAAEjC,MAAO,cAAgB,SAAU,KAC3F,wBAAoB,MAAO,GAAY,GAClC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAY+B,EAAQvG,IAAI,KAAK,KAAM,CAACrf,EAAO5B,MACvF,kBAAc,wBAAoB,OAAQ,CAC9CA,IAAKA,EACLylB,MAAO,QACR,qBAAiBzlB,GAAO,MAAO,qBAAiB4B,GAAQ,KAC3D,WAGZ,wBAAoB,MAAO,GAAa,CACpC8lB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,CAAEjC,MAAO,cAAgB,OAAQ,KACzF,wBAAoB,MAAO,GAAa,EACpC,wBAAoB,IAAK,MAAM,qBAAiB+B,EAAQvG,IAAI,KAAK,IAAK,QAG9E,wBAAoB,MAAO,GAAa,CACpCyG,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,CAAEjC,MAAO,cAAgB,OAAQ,KACzF,wBAAoB,MAAO,GAAa,EACpC,wBAAoB,IAAK,MAAM,qBAAiB+B,EAAQvG,IAAI,KAAK,IAAK,QAG9E,wBAAoB,MAAO,GAAa,CACpCyG,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,CAAEjC,MAAO,cAAgB,SAAU,KAC3F,wBAAoB,MAAO,GAAa,EACpC,wBAAoB,KAAM,GAAa,GAClC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAY+B,EAAQvG,IAAI,KAAOsM,KAC3E,kBAAc,wBAAoB,KAAM,CAC5CvtB,IAAKutB,EAAM,IACZ,EACC,wBAAoB,SAAU,MAAM,qBAAiBA,EAAM,IAAK,IAChE,wBAAoB,IAAK,IAAa,qBAAiBA,EAAM,IAAK,OAEtE,aAIhB,wBAAoB,MAAO,GAAa,CACpC7F,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,CAAEjC,MAAO,cAAgB,OAAQ,KACzF,wBAAoB,MAAO,GAAa,EACpC,wBAAoB,KAAM,GAAa,GAClC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAY+B,EAAQvG,IAAI,GAAI,CAACpD,EAAOhM,MAChF,kBAAc,wBAAoB,KAAM,CAAE7R,IAAK6R,GAAS,EAC5D,wBAAoB,SAAU,MAAM,qBAAiB,IAAIiD,KAAK+I,EAAM,IAAI2P,sBAAwB,MAAO,qBAAiB3P,EAAM,MAAO,IACrI,wBAAoB,IAAK,GAAa,QAAS,qBAAiBA,EAAM,IAAK,OAE/E,cAM5B,ICnHE,IAA2B,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBAEvE,MCNM,GAAa,CAAE4H,MAAO,kCACtB,GAAa,CAAEA,MAAO,0BACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,mBAEL,GAAa,CAAEA,MAAO,eACtB,GAAa,CAAEA,MAAO,aACtB,GAAa,CAAEA,MAAO,cACtB,GAAa,CAAEA,MAAO,qBACtB,GAAa,CAAEA,MAAO,WACtB,GAAa,CAAEA,MAAO,YACtB,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,eAEL,GAAc,CAAEA,MAAO,0BACvB,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,eAEL,GAAc,CAAEA,MAAO,gBACvB,GAAc,CAAEA,MAAO,eACvB,GAAc,CAAEA,MAAO,qBACvB,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,eAIX,IAA6B,qBAAiB,CAC1CwB,OAAQ,mBACRpnB,MAAO,CACHohB,IAAK,CAAC,GAEV,KAAAsG,CAAMC,GACF,MAAM3nB,EAAQ2nB,EACRiG,GAAa,IAAA9M,UAAS,IACnB9gB,EAAMohB,IAAI,GAERjgB,OAAOwF,QAAQ3G,EAAMohB,IAAI,IAAIvY,IAAI,EAAE1I,EAAK4B,MAC3C,MAAM8rB,EAAY,GAAOvoB,KAAM5C,GAAMA,EAAE,KAAOX,EAAM,IAC9C+rB,EAAiBD,EAAaA,EAAU,OAASxZ,IAAW,MAAQwZ,EAAU,KAAQ,EACtFE,EAA0C,iBAAnBD,GAA+BA,EAAiB,EAAK/rB,EAAM,IAAM+rB,EAAkB,IAAM,EACtH,MAAO,CACH3tB,SACG4B,EACHgsB,gBACAD,oBATG,IAaTE,GAAS,IAAAlN,UAAS,IACf9gB,EAAMohB,IAAI,GAERjgB,OAAOwF,QAAQ3G,EAAMohB,IAAI,IAAIvY,IAAI,EAAE1I,EAAK4B,MACpC,CACHiC,KAAM7D,EACN+L,MAAOnK,EAAM,GACbksB,YAAalsB,EAAM,MALhB,IASf,MAAO,CAAC6lB,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACzD,wBAAoB,MAAO,GAAY,CACnCA,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,CAAEjC,MAAO,cAAgB,MAAO,IACvFgI,EAAW7rB,MAAMoH,OAAS,IACpB,kBAAc,wBAAoB,MAAO,GAAY,GACnD,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYykB,EAAW7rB,MAAQmsB,KAC3E,kBAAc,wBAAoB,MAAO,CAC7C/tB,IAAK+tB,EAAK/tB,IACVylB,MAAO,kBACR,EACC,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,OAAQ,IAAY,qBAAiBsI,EAAK/tB,KAAM,IACpE,wBAAoB,OAAQ,IAAY,qBAAiB+tB,EAAK,IAAM,MAAO,qBAAiBA,EAAK,KAAO,EAAI,IAAM,KAAM,qBAAiBA,EAAK,KAAO,IAAK,MAE9J,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,MAAO,CACvBtI,MAAO,WACPkB,OAAO,oBAAgB,CAAEqH,MAAO,GAAGD,EAAKH,oBACzC,KAAM,MAEb,wBAAoB,OAAQ,IAAY,qBAAiBG,EAAK,KAAO,OAAQ,qBAAiBA,EAAKJ,gBAAiB,SAG5H,WAEL,kBAAc,wBAAoB,MAAO,GAAa,SAEjE,wBAAoB,MAAO,GAAa,CACpCjG,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,CAAEjC,MAAO,cAAgB,MAAO,IACvFoI,EAAOjsB,MAAMoH,OAAS,IAChB,kBAAc,wBAAoB,MAAO,GAAa,GACpD,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAY6kB,EAAOjsB,MAAQqsB,KACvE,kBAAc,wBAAoB,MAAO,CAC7CjuB,IAAKiuB,EAAMpqB,KACX4hB,MAAO,cACR,EACC,wBAAoB,MAAO,GAAa,EACpC,wBAAoB,KAAM,MAAM,qBAAiBwI,EAAMpqB,MAAO,IAC9D,wBAAoB,MAAO,GAAa,OAAQ,qBAAiBoqB,EAAMliB,OAAQ,MAEnF,wBAAoB,IAAK,IAAa,qBAAiBkiB,EAAMH,aAAc,OAE/E,WAEL,kBAAc,wBAAoB,MAAO,GAAa,UAI7E,IC7GE,IAA2B,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBAEvE,MCNM,GAAa,CAAErI,MAAO,0BACtB,GAAa,CAAEA,MAAO,SACtB,GAAa,CAAEA,MAAO,kBACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,eAEL,GAAa,CAAEA,MAAO,SAE5B,IAA6B,qBAAiB,CAC1CwB,OAAQ,cACRpnB,MAAO,CACHquB,MAAO,CAAC,EACRtsB,MAAO,CAAC,EACR0T,IAAK,CAAC,EACNC,IAAK,CAAC,EACN4Y,MAAO,CAAC,GAEZ,KAAA5G,CAAMC,GACF,MAAM3nB,EAAQ2nB,EACR4G,GAAe,IAAAzN,UAAS,IAAM9gB,EAAM+B,OACpCysB,GAAkB,IAAA1N,UAAS,SAAoBrgB,IAAdT,EAAM0V,KAAqB1V,EAAM0V,IAAM,GACxE+Y,GAAY,IAAA3N,UAAS,KACvB,MAAMpL,EAAM1V,EAAM0V,KAAO,EACnBD,EAAMzV,EAAMyV,KAAO,IACnB1T,EAAQyT,KAAKC,IAAIC,EAAKF,KAAKE,IAAID,EAAKzV,EAAM+B,QAChD,GAAIysB,EAAgBzsB,MAAO,CAEvB,OAAIA,EAAQ,EACD,CACH2sB,KAAM,MACNC,MAAO,OACPR,MAAWpsB,EAAQ0T,EAAO,GAAnB,IACPmZ,gBAAiB5uB,EAAMsuB,OAIpB,CACHI,KAAM,OACNC,MAAO,MACPR,MAAW3Y,KAAKqZ,IAAI9sB,GAASyT,KAAKqZ,IAAInZ,GAAQ,GAAvC,IACPkZ,gBAAiB,UAG7B,CAGI,MAAO,CACHF,KAAM,IACNC,MAAO,OACPR,MAAO,GAJQ1Y,IAAQC,EAAM,GAAM3T,EAAQ2T,IAAQD,EAAMC,GAAQ,OAKjEkZ,gBAAiB5uB,EAAMsuB,SAInC,MAAO,CAAC1G,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACzD,wBAAoB,OAAQ,IAAY,qBAAiBF,EAAQ0G,OAAQ,IACzE,wBAAoB,MAAO,GAAY,CAClCG,EAAqB,QACf,kBAAc,wBAAoB,MAAO,MAC1C,wBAAoB,QAAQ,IAClC,wBAAoB,MAAO,CACvB5I,MAAO,gBACPkB,OAAO,oBAAgB2H,EAAU1sB,QAClC,KAAM,MAEb,wBAAoB,OAAQ,IAAY,qBAAiBwsB,EAAaxsB,OAAQ,KAG1F,IClEE,IAA2B,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBAEvE,MCNM,GAAa,CAAE6jB,MAAO,qBACtB,GAAa,CAAEA,MAAO,iBACtB,GAAa,CAAC,WACd,GAAa,CAAEA,MAAO,iBACtB,GAAa,CAAEA,MAAO,iBACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,oBAEL,GAAa,CAAEA,MAAO,eAM5B,IAA6B,qBAAiB,CAC1CwB,OAAQ,mBACRpnB,MAAO,CACH4K,UAAW,CAAC,GAEhB,KAAA8c,CAAMC,GACF,MAAMmH,EAAe,CACjB,CACInd,MAAO,MACPod,QAAS,CACL,CAAEV,MAAO,MAAO5U,KAAM,UAAW/D,KAAM,IAAKD,IAAK,IAAK6Y,MAAO,WAC7D,CAAED,MAAO,OAAQ5U,KAAM,WAAY/D,KAAM,IAAKD,IAAK,IAAK6Y,MAAO,WAC/D,CAAED,MAAO,MAAO5U,KAAM,UAAW/D,IAAK,EAAGD,IAAK,IAAK6Y,MAAO,aAGlE,CACI3c,MAAO,MACPod,QAAS,CACL,CAAEV,MAAO,MAAO5U,KAAM,UAAW/D,KAAM,IAAKD,IAAK,IAAK6Y,MAAO,WAC7D,CAAED,MAAO,MAAO5U,KAAM,UAAW/D,IAAK,EAAGD,IAAK,IAAK6Y,MAAO,aAGlE,CACI3c,MAAO,MACPod,QAAS,CACL,CAAEV,MAAO,OAAQ5U,KAAM,WAAY/D,IAAK,EAAGD,IAAK,IAAK6Y,MAAO,WAC5D,CAAED,MAAO,OAAQ5U,KAAM,WAAY/D,IAAK,EAAGD,IAAK,IAAK6Y,MAAO,WAC5D,CAAED,MAAO,OAAQ5U,KAAM,WAAY/D,IAAK,EAAGD,IAAK,IAAK6Y,MAAO,cAIlEtuB,EAAQ2nB,EACR9c,GAAY,IAAAmkB,KAAI,CAAC,IACvB,IAAA7X,OAAM,IAAM,CAACnX,EAAM4K,UAAW,GAAMrH,YAAY,IAAK,KACjD,IAAKvD,EAAM4K,YAAc,GAAMrH,YAAY,GAEvC,YADAsH,EAAU9I,MAAQ,CAAC,GAGvB,IAAIsF,EAAU,KACd,IAAK,MAAMtD,KAAM,GAAMR,WAAW,GAC9B,IAAI,IAAAjC,KAAI,GAAMiC,WAAW,GAAGQ,GAAK,MAAM/D,EAAM4K,aAAc,CACvDvD,EAAUtD,EACV,KACJ,CAEJ,IAAKsD,EAED,YADAwD,EAAU9I,MAAQ,CAAC,GAGvB,MAAM2G,GAAY,IAAApH,KAAI,GAAMiC,WAAW,GAAG8D,GAAU,QAKpDwD,EAAU9I,MAJL2G,GAIaA,EAAU1I,EAAM4K,YAHZ,CAAC,GAIxB,CAAEqkB,WAAW,EAAM3X,MAAM,IAC5B,MAAM,eAAE4J,GAAmBN,GACrBsO,GAAmB,IAAAF,KAAI,MAU7B,SAASG,EAAiBC,GACtB,MAAMC,GAAY,IAAA/tB,KAAI8tB,EAAU,OAAQ,CAAC,GACzC,OAAOjuB,OAAOkE,OAAOgqB,GAChB5sB,OAAQ6sB,GAAuB,iBAARA,GAA4B,OAARA,GAAgBA,EAAI,IAC/DzmB,IAAKymB,GAAQA,EAAI,GAC1B,CACA,MAAO,CAAC1H,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACzD,wBAAoB,KAAM,GAAY,GACjC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYhd,EAAU9I,MAAO,CAACqtB,EAAUrrB,MACpF,kBAAc,wBAAoB,KAAM,CAC5C5D,IAAK4D,EACL6hB,MAAO,iBACR,EACC,wBAAoB,MAAO,CACvBA,MAAO,kBACPoC,QAAUE,GAzBlC,SAAsBlkB,GAClB,MAAMurB,EAAe9S,OAAOzY,GACxBkrB,EAAiBntB,QAAUwtB,EAC3BL,EAAiBntB,MAAQ,KAGzBmtB,EAAiBntB,MAAQwtB,CAEjC,CAiB6C,CAAcxrB,IACpC,EACC,wBAAoB,OAAQ,IAAY,sBAAiB,WAAOmd,EAAP,CAAuBzE,OAAO1Y,KAAO,IAC9F,wBAAoB,MAAO,GAAY,GAClC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYorB,EAAiBC,GAAYE,KACrF,kBAAc,wBAAoB,OAAQ,CAC9CnvB,IAAKmvB,EACL1J,MAAO,QACR,qBAAiB0J,GAAM,KAC1B,SAET,EAAe,IACjBJ,EAAiBntB,QAAUgC,IACrB,kBAAc,wBAAoB,MAAO,GAAY,GACnD,kBAAc,wBAAoB,WAAW,MAAM,gBAAY+qB,EAAeU,IACpE,wBAAoB,MAAO,CAC9BrvB,IAAKqvB,EAAM7d,MACXiU,MAAO,gBACR,EACC,wBAAoB,SAAU,IAAY,qBAAiB4J,EAAM7d,OAAQ,KACxE,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAY6d,EAAMT,QAAUU,KACxE,kBAAc,iBAAaC,GAAa,CAC5CvvB,IAAKsvB,EAAOpB,MACZA,MAAOoB,EAAOpB,MACdtsB,OAAO,WAAO,EAAAT,IAAP,CAAY8tB,EAAUK,EAAOhW,KAAM,GAC1C/D,IAAK+Z,EAAO/Z,IACZD,IAAKga,EAAOha,IACZ6Y,MAAOmB,EAAOnB,OACf,KAAM,EAAe,CAAC,QAAS,QAAS,MAAO,MAAO,YACzD,SAER,SAEN,wBAAoB,QAAQ,OAEtC,UAIpB,ICrIE,IAA2B,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBAEvE,MCNM,GAAa,CAAE1I,MAAO,kCACtB,GAAa,CAAEA,MAAO,0BACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,eAGX,IAA6B,qBAAiB,CAC1CwB,OAAQ,cACRpnB,MAAO,CACHohB,IAAK,CAAC,EACNuO,MAAO,CAAC,GAEZjI,MAAMC,GACK,CAACC,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACzD,wBAAoB,MAAO,GAAY,CACnCA,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,CAAEjC,MAAO,cAAgB,QAAS,IACzF+B,EAAa,QACP,kBAAc,iBAAaiI,GAAkB,CAC5CzvB,IAAK,EACL,aAAcwnB,EAAQgI,OACvB,KAAM,EAAe,CAAC,kBACtB,kBAAc,wBAAoB,MAAO,GAAY,iBAEhE,wBAAoB,gCCrB9B,IAA2B,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBAEvE,MCNM,GAAa,CAAE/J,MAAO,sBACtB,GAAa,CAAEA,MAAO,QACtB,GAAa,CAAC,WACd,GAAa,CAAEA,MAAO,eACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,eAMX,IAA6B,qBAAiB,CAC1CwB,OAAQ,mBACRpnB,MAAO,CACHohB,IAAK,CAAC,EACNuO,MAAO,CAAC,GAEZ,KAAAjI,CAAMC,GACF,MAAMkI,GAAY,IAAAb,KAAI,WAChBc,EAAO,CACT,CAAE/rB,GAAI,UAAWC,KAAM,QACvB,CAAED,GAAI,aAAcC,KAAM,QAC1B,CAAED,GAAI,QAASC,KAAM,SAEzB,MAAO,CAAC4jB,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACzD,wBAAoB,MAAO,GAAY,GAClC,kBAAc,wBAAoB,WAAW,MAAM,gBAAYiI,EAAOC,IAC5D,wBAAoB,SAAU,CACjC5vB,IAAK4vB,EAAIhsB,GACT6hB,OAAO,oBAAgB,CAAEoK,OAAQH,EAAU9tB,QAAUguB,EAAIhsB,KACzDikB,QAAUE,GAAY2H,EAAU9tB,MAAQguB,EAAIhsB,KAC7C,qBAAiBgsB,EAAI/rB,MAAO,GAA6B,KAC5D,QAER,wBAAoB,MAAO,GAAY,CAClC2jB,EAAW,MACL,kBAAc,wBAAoB,WAAW,CAAExnB,IAAK,GAAK,CACnC,YAApB0vB,EAAU9tB,QACJ,kBAAc,iBAAakuB,GAAe,CACzC9vB,IAAK,EACLihB,IAAKuG,EAAQvG,KACd,KAAM,EAAe,CAAC,UACvB,wBAAoB,QAAQ,GACb,eAApByO,EAAU9tB,QACJ,kBAAc,iBAAamuB,GAAkB,CAC5C/vB,IAAK,EACLihB,IAAKuG,EAAQvG,KACd,KAAM,EAAe,CAAC,UACvB,wBAAoB,QAAQ,GACb,UAApByO,EAAU9tB,QACJ,kBAAc,iBAAaouB,GAAa,CACvChwB,IAAK,EACLihB,IAAKuG,EAAQvG,IACb,SAAUuG,EAAQgI,OACnB,KAAM,EAAe,CAAC,MAAO,aAC9B,wBAAoB,QAAQ,IACnC,OACA,kBAAc,wBAAoB,MAAO,GAAY,IAAK9H,EAAO,KAAOA,EAAO,GAAK,EAC/E,wBAAoB,IAAK,KAAM,QAAS,YAKpE,IC7DE,IAA2B,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBAEvE,MCNM,GAAa,CACf1nB,IAAK,EACLylB,MAAO,sBAEL,GAAa,CAAEA,MAAO,aACtB,GAAa,CAAEA,MAAO,aACtB,GAAa,CAAEA,MAAO,aACtB,GAAa,CAAEA,MAAO,aACtB,GAAa,CAAEA,MAAO,aACtB,GAAa,CAAEA,MAAO,wBACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,uBAMX,IAA6B,qBAAiB,CAC1CwB,OAAQ,mBACRpnB,MAAO,CACHowB,WAAY,CACRnsB,KAAMwY,OACN4T,UAAU,IAGlB,KAAA3I,CAAMC,GACF,MAAM3nB,EAAQ2nB,EACR2I,GAAkB,IAAAxP,UAAS,KAC7B,IAAK9gB,EAAMowB,aAAe,GAAM7sB,YAAY,GACxC,OAAO,KACX,IAAK,MAAM8D,KAAW,GAAM9D,WAAW,GAAI,CACvC,MAAMgtB,EAAQ,GAAMhtB,WAAW,GAAG8D,GAC5BmpB,GAAmB,IAAAlvB,KAAIivB,EAAO,UAAW,CAAC,GAChD,IAAK,MAAMxmB,KAAWymB,EAAkB,CACpC,MAAMpf,EAAQof,EAAiBzmB,GACzB1F,GAAS,IAAA/C,KAAI8P,EAAO,WAAWpR,EAAMowB,cAC3C,GAAI/rB,EACA,OAAOA,CAEf,CACJ,CACA,OAAO,OAELosB,GAAqB,IAAA3P,UAAS,IAC3BwP,EAAgBvuB,MAEd6e,GAAWS,sBAAsBrhB,EAAMowB,YADnC,MAGTM,EAAc3uB,GACK,iBAAVA,EACAA,EACJA,EAAM8M,QAAQ,YAAa,IAEhC8hB,EAAcC,IAChB,IAAKA,EACD,MAAO,KACX,GAAIvoB,MAAMwI,QAAQ+f,GACd,OAAOA,EAAKlX,KAAK,KAIrB,OAFgBgX,EAAWjU,OAAOmU,IACZpkB,MAAM,KACfkN,KAAK,MAEhBmX,EAAqBC,IACvB,IAAKA,EACD,MAAO,KACX,IACI,MAAMC,EAAQL,EAAWI,EAAO,MAC1BE,EAAUpQ,GAAWK,gBAAgB8P,GAErCE,EADgBP,EAAWI,EAAO,IACLtkB,MAAM,KACnC0kB,EAAYD,EAAa,IAAM,GAC/BE,EAAQF,EAAa,IAAM,GAE3BG,EADiBV,EAAWjU,OAAOqU,EAAO,KACXtkB,MAAM,KACrCzK,EAAQqvB,EAAc,IAAM,GAElC,MAAO,KAAKJ,KAAWjvB,IADVqvB,EAAc,IAAM,MACMF,IAAYC,IACvD,CACA,MAAO/jB,GAEH,OADA5J,QAAQuK,MAAM,gCAAiCX,GACxC,MACX,GAEJ,MAAO,CAACwa,EAAMC,IACFyI,EAAqB,QACtB,kBAAc,wBAAoB,MAAO,GAAY,EACpD,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,MAAO,GAAY,CACnCzI,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,MAAO,KACrE,wBAAoB,OAAQ,MAAM,qBAAiB6I,EAAWJ,EAAgBvuB,MAAM,OAAQ,MAEhG,wBAAoB,MAAO,GAAY,CACnC8lB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,MAAO,KACrE,wBAAoB,OAAQ,MAAM,qBAAiB4I,EAAmB1uB,OAAQ,MAElF,wBAAoB,MAAO,GAAY,CACnC8lB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,MAAO,KACrE,wBAAoB,OAAQ,MAAM,qBAAiB8I,EAAWL,EAAgBvuB,MAAM,KAAM,MAE9F,wBAAoB,MAAO,GAAY,CACnC8lB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,QAAS,KACvE,wBAAoB,OAAQ,MAAM,qBAAiBgJ,EAAkBP,EAAgBvuB,MAAM,OAAQ,MAEvG,wBAAoB,MAAO,GAAY,CACnC8lB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,MAAO,KACrE,wBAAoB,OAAQ,MAAM,qBAAiB6I,EAAWJ,EAAgBvuB,MAAM,KAAM,YAInG,kBAAc,wBAAoB,MAAO,GAAY,eAEpE,IC7GE,IAA2B,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBAEvE,MCNM,GAAa,CAAE6jB,MAAO,sBACtB,GAAa,CAAEA,MAAO,aACtB,GAAa,CAAEA,MAAO,aACtB,GAAa,CAAEA,MAAO,aACtB,GAAa,CAAEA,MAAO,aACtB,GAAa,CAAEA,MAAO,wBACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,wBAGX,IAA6B,qBAAiB,CAC1CwB,OAAQ,mBACRpnB,MAAO,CACHytB,KAAM,CACFxpB,KAAM9C,OACNkvB,UAAU,IAGlB,KAAA3I,CAAMC,GACF,MAAM3nB,EAAQ2nB,EACR0J,GAAU,IAAAvQ,UAAS,KACrB,IAAK9gB,EAAMytB,KAAK4D,QACZ,OAAO,KACX,MAAM,iBAAEC,EAAgB,iBAAEC,GAAqBvxB,EAAMytB,KAAK4D,QACpDvkB,EAAQ,GACd,GAAIwkB,EACA,IAAK,MAAMnxB,KAAOmxB,EACF,UAARnxB,GAEJ2M,EAAMvK,KAAK,GAAGpC,MAAQmxB,EAAiBnxB,MAG/C,GAAIoxB,EACA,IAAK,MAAMpxB,KAAOoxB,EACF,UAARpxB,GAEJ2M,EAAMvK,KAAK,GAAGpC,MAAQoxB,EAAiBpxB,MAG/C,OAAO2M,EAAM4M,KAAK,OAEtB,MAAO,CAACkO,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACzD,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,MAAO,GAAY,CACnCA,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,MAAO,KACrE,wBAAoB,OAAQ,MAAM,qBAAiBF,EAAQ8F,KAAK,IAAM,MAAO,MAEjF,wBAAoB,MAAO,GAAY,CACnC5F,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,OAAQ,KACtE,wBAAoB,OAAQ,MAAM,qBAAiBF,EAAQ8F,KAAK,KAAO,KAAM,MAEjF,wBAAoB,MAAO,GAAY,CACnC5F,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,MAAO,KACrE,wBAAoB,OAAQ,MAAM,qBAAiBF,EAAQ8F,KAAK,IAAM,MAAO,MAEjF,wBAAoB,MAAO,GAAY,CACnC5F,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,MAAO,KACrE,wBAAoB,OAAQ,MAAM,qBAAiBF,EAAQ8F,KAAK,IAAM,UAAW,KAEpF4D,EAAa,QACP,kBAAc,wBAAoB,MAAO,GAAY,CACpDxJ,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,MAAO,KACrE,wBAAoB,OAAQ,MAAM,qBAAiBwJ,EAAQtvB,OAAQ,OAErE,wBAAoB,QAAQ,OAIlD,IChEJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjE,GAAa,CAAE6jB,MAAO,uBACtB,GAAa,CAAC,WASpB,IAA6B,qBAAiB,CAC1CwB,OAAQ,wBACRpnB,MAAO,CACHgI,KAAM,CACF/D,KAAMwY,OACN4T,UAAU,IAGlB,KAAA3I,CAAMC,GACF,MAAM3nB,EAAQ2nB,EACR6J,GAAgB,IAAA1Q,UAAS,KAC3B,MAAM2Q,EAAQ7Q,GAAWC,QAAQ9e,MAAM8G,IAAIuY,GAAQ/Y,MAAMwI,QAAQuQ,EAAI,IAAMA,EAAI,GAAG,GAAKA,EAAI,IAAK3e,OAAOgZ,SACvG,GAAqB,IAAjBgW,EAAMtoB,OACN,OAAO,KACX,MAAMuoB,EAAeD,EAAM5oB,IAAI7E,GAAQA,EAAK6K,QAAQ,sBAAuB,SAC3E,OAAO,IAAI8iB,OAAO,IAAID,EAAahY,KAAK,QAAS,OAE/CkY,GAAqB,IAAA9Q,UAAS,KAChC,MAAM2Q,EAAQppB,MAAMC,KAAKsY,GAAWD,cAActb,UAAUwD,IAAIwB,GAAOA,EAAIrG,MAC3E,GAAqB,IAAjBytB,EAAMtoB,OACN,OAAO,KACX,MAAMuoB,EAAeD,EAAM5oB,IAAI7E,GAAQA,EAAK6K,QAAQ,sBAAuB,SAC3E,OAAO,IAAI8iB,OAAO,IAAID,EAAahY,KAAK,QAAS,OAE/CtU,GAAc,IAAA0b,UAAS,IAA4B,cAArB,GAAMlK,WAA6B,EAAAib,UAAA,MAAkB,EAAAC,YAAA,OACnFC,GAAyB,IAAAjR,UAAS,KACpC,MAAMkR,EAAW5sB,EAAYrD,OAAO,IACpC,IAAKiwB,EACD,OAAO,KACX,MAAMP,EAAQ,GACd,IAAK,MAAMxmB,KAAY+mB,EAAU,CAC7B,GAAiB,UAAb/mB,EACA,SACJ,MAAMC,EAAgB8mB,EAAS/mB,GAC/B,GAAIC,EACA,IAAK,MAAMC,KAAUD,EAAe,CAChC,GAAe,UAAXC,EACA,SACJ,MAAMsiB,EAAOviB,EAAcC,GACvBsiB,GAAQA,EAAK,IACbgE,EAAMlvB,KAAKkrB,EAAK,GAExB,CAER,CACA,GAAqB,IAAjBgE,EAAMtoB,OACN,OAAO,KACX,MAAMuoB,EAAeD,EAAM5oB,IAAI7E,GAAQA,EAAK6K,QAAQ,sBAAuB,SAC3E,OAAO,IAAI8iB,OAAO,IAAID,EAAahY,KAAK,QAAS,OAE/CuY,GAAW,IAAAnR,UAAS,KACtB,IAAK9gB,EAAMgI,KACP,MAAO,GAEX,OAEJ,SAAmBA,GACf,MAAMiqB,EAAW,GACX5rB,EAAQ,uCACd,IACIQ,EADAqrB,EAAY,EAEhB,KAAsC,QAA9BrrB,EAAQR,EAAMgV,KAAKrT,KAAiB,CACpCnB,EAAMmL,MAAQkgB,GACdD,EAAS1vB,QAAQ4vB,EAAcnqB,EAAK8D,UAAUomB,EAAWrrB,EAAMmL,SAEnE,MAAMogB,EAAcvrB,EAAM,GAC1B,IAAIwrB,EAAY,GACZC,EAAa,GACbzrB,EAAM,IACNwrB,EAAYD,EAAY7lB,MAAM,GAAI,GAClC+lB,EAAa,yBAERzrB,EAAM,IACXwrB,EAAYD,EAAY7lB,MAAM,GAAI,GAClC+lB,EAAa,gBAERzrB,EAAM,IACXwrB,EAAYD,EAAY7lB,MAAM,GAAI,GAClC+lB,EAAa,iBAERzrB,EAAM,KACXwrB,EAAYD,EAAY7lB,MAAM,GAAI,GAClC+lB,EAAa,mBAEKH,EAAcE,GACtBzvB,QAAQ2vB,IAClB,MAAMC,EAAgBnqB,MAAMwI,QAAQ0hB,EAAQ3M,OACtC,CAAC0M,KAAeC,EAAQ3M,OACxB,CAAC0M,EAAYC,EAAQ3M,OAAOnjB,OAAOgZ,SACzCwW,EAAS1vB,KAAK,IAAKgwB,EAAS3M,MAAO4M,MAEvCN,EAAYrrB,EAAMmL,MAAQogB,EAAYjpB,MAC1C,CACI+oB,EAAYlqB,EAAKmB,QACjB8oB,EAAS1vB,QAAQ4vB,EAAcnqB,EAAK8D,UAAUomB,KAElD,OAAOD,CACX,CA3CWQ,CADWzyB,EAAMgI,KAAK6G,QAAQ,WAAY,OA6CrD,SAASsjB,EAAcnqB,GACnB,MAAMiqB,EAAW,GACXS,EAAmB,GAOzB,GANIlB,EAAczvB,OACd2wB,EAAiBnwB,KAAKivB,EAAczvB,MAAMiF,QAC1C4qB,EAAmB7vB,OACnB2wB,EAAiBnwB,KAAKqvB,EAAmB7vB,MAAMiF,QAC/C+qB,EAAuBhwB,OACvB2wB,EAAiBnwB,KAAKwvB,EAAuBhwB,MAAMiF,QACvB,IAA5B0rB,EAAiBvpB,OACjB,MAAO,CAAC,CAAEnB,OAAM4d,MAAO,KAE3B,MAAM+M,EAAc,IAAIhB,OAAOe,EAAiBhZ,KAAK,KAAM,KAC3D,IACI7S,EADAqrB,EAAY,EAEhB,KAA4C,QAApCrrB,EAAQ8rB,EAAYtX,KAAKrT,KAAiB,CAC1CnB,EAAMmL,MAAQkgB,GACdD,EAAS1vB,KAAK,CAAEyF,KAAMA,EAAK8D,UAAUomB,EAAWrrB,EAAMmL,OAAQ4T,MAAO,KAEzE,MAAM5hB,EAAO6C,EAAM,GACbua,EAAMR,GAAWC,QAAQ9e,MAAMuD,KAAK1E,IAAMyH,MAAMwI,QAAQjQ,EAAE,IAAMA,EAAE,GAAG,GAAKA,EAAE,MAAQoD,GACpFoG,EAAQ,IAAIwW,GAAWD,cAAcha,WAAWrB,KAAK,EAAEvB,EAAIsG,KAASA,EAAIrG,OAASA,KAAQ,GACzFypB,EAAOmF,EAAoB5uB,GACjC,GAAIod,EAAK,CACL,MAAMyR,EAAoBC,EAAwB1R,GAClD6Q,EAAS1vB,KAAK,CAAEyF,KAAMhE,EAAM4hB,MAAO,CAAC,WAAYiN,GAAoBzR,OACxE,MACShX,EACL6nB,EAAS1vB,KAAK,CAAEyF,KAAMhE,EAAM4hB,MAAO,gBAAiBwK,WAAYhmB,IAE3DqjB,EACLwE,EAAS1vB,KAAK,CAAEyF,KAAMhE,EAAM4hB,MAAO,qBAAsB6H,SAGzDwE,EAAS1vB,KAAK,CAAEyF,KAAMhE,EAAM4hB,MAAO,KAEvCsM,EAAYrrB,EAAMmL,MAAQhO,EAAKmF,MACnC,CAIA,OAHI+oB,EAAYlqB,EAAKmB,QACjB8oB,EAAS1vB,KAAK,CAAEyF,KAAMA,EAAK8D,UAAUomB,GAAYtM,MAAO,KAErDqM,CACX,CAmBA,SAASW,EAAoB5uB,GACzB,MAAMguB,EAAW5sB,EAAYrD,OAAO,IACpC,IAAKiwB,EACD,OAAO,KACX,IAAK,MAAM/mB,KAAY+mB,EAAU,CAC7B,GAAiB,UAAb/mB,EACA,SACJ,MAAMC,EAAgB8mB,EAAS/mB,GAC/B,GAAIC,EACA,IAAK,MAAMC,KAAUD,EAAe,CAChC,GAAe,UAAXC,EACA,SACJ,MAAMsiB,EAAOviB,EAAcC,GAC3B,GAAIsiB,GAAQA,EAAK,KAAOzpB,EACpB,OAAOypB,CAEf,CAER,CACA,OAAO,IACX,CACA,SAASqF,EAAwB1R,GAC7B,MAAMuO,EAAQ/O,GAAWO,SAASC,GAC5B1Y,EAAYtD,EAAYrD,OAAO,KACrC,IAAK4tB,IAAUjnB,IAAcA,EAAUinB,KAAS,MAC5C,MAAO,cAEX,MAAMoD,EAAerqB,EAAUinB,GAAO,MAChCqD,GAAgBD,EAAa,KAAK,KAAO,IAAMA,EAAa,KAAK,KAAO,GAC9E,OAAIC,IAAiB,IACV,sBACPA,IAAiB,GACV,cACPA,EAAe,EACR,iBACPA,EAAe,GACR,cACPA,EAAe,IACR,eACPA,EAAe,IACR,cACJ,eACX,CACA,MAAO,CAACpL,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,GACxD,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYoK,EAASlwB,MAAO,CAACwwB,EAASvgB,MAClF,kBAAc,wBAAoB,OAAQ,CAC9C7R,IAAK6R,EACL4T,OAAO,oBAAgB2M,EAAQ3M,OAC/BoC,QAAUE,IAAW,OAACqK,EAAQnR,IAnE1B,CAACA,IACjB,IAAKA,EACD,OACJ,MAAMuO,EAAQ/O,GAAWO,SAASC,GAC5B6R,EAAU5qB,MAAMwI,QAAQuQ,EAAI,IAAMA,EAAI,GAAG,GAAKA,EAAI,GACxD6L,GAAmBvb,KAAKuhB,EAASC,GAAkB,CAAE9R,MAAKuO,WA+DxCwD,CAAYZ,EAAQnR,KACpBmR,EAAQnC,WA9DL,CAACA,IACtB,IAAKA,EACD,OACJ,MAAMgD,EAAexS,GAAWK,gBAAgBmP,GAChDnD,GAAmBvb,KAAK0hB,EAAcC,GAAkB,CAAEjD,gBA2DpCkD,CAAiBf,EAAQnC,YACzBmC,EAAQ9E,WA1DJA,EA2DqB8E,EAAQ9E,OAxDvDR,GAAmBvb,KAAK+b,EAAK,GAAI8F,GAAkB,CAAE9F,UAyD3B,KA5DD,IAACA,KA6Df,qBAAiB8E,EAAQvqB,MAAO,GAA6B,MAChE,QAGhB,IC/NJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjE,GAAa,CACf4d,MAAO,uBACPoJ,IAAK,sBCGT,IDC6B,qBAAiB,CAC1C5H,OAAQ,WACRM,MAAMC,GACK,CAACC,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACzD,iBAAa2L,GAAuB,CAAExrB,MAAM,WAAO+kB,KAAsB,KAAM,EAAe,CAAC,UAChG,QEZT,GAAa,CAAEnH,MAAO,2BACtB,GAAa,CAAEA,MAAO,iBACtB,GAAa,CAAEA,MAAO,gBACtB,GAAa,CAAEA,MAAO,cACtB,GAAa,CAAEA,MAAO,cACtB,GAAa,CAAEA,MAAO,oBACtB,GAAa,CAAEA,MAAO,cACtB,GAAa,CAAC,gBACd,GAAa,CAAEA,MAAO,aACtB,GAAc,CAAEA,MAAO,cACvB,GAAc,CAAEA,MAAO,eACvB,GAAc,CAAC,gBACf,GAAc,CAAEA,MAAO,aACvB,GAAc,CAAEA,MAAO,cACvB,GAAc,CAAEA,MAAO,cACvB,GAAc,CAChBA,MAAO,YACP6N,QAAS,eAEP,GAAc,CAAC,gBACf,GAAc,CAAC,gBACf,GAAc,CAAE7N,MAAO,aACvB,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,cAKL8N,GAAqB,UAC3B,IAA6B,qBAAiB,CAC1CtM,OAAQ,eACRpnB,MAAO,CACHqJ,UAAW,CACPpF,KAAM9C,OACNiF,QAAS,OAGjB,KAAAshB,CAAMC,GACF,MAAM3nB,EAAQ2nB,EACRgM,GAAc,IAAA3E,KAZP,MAaP4E,GAAoB,IAAA5E,KAAI0E,IACxBG,EAAkB,CAAC9xB,EAAO+xB,EAAe,IACvC/xB,QACO+xB,EACJ/xB,EAmBLgyB,GAAgB,IAAAjT,UAAS,IAAM9gB,EAAMqJ,WAAa,GAAMA,WAExD2qB,GAAiB,IAAAlT,UAAS,KAC5B,MAAMjd,EAAOkwB,EAAchyB,MAC3B,MAAO,CACH,CAAEgC,GAAI,OAAQC,KAAM,KAAMjC,MAAO8xB,EAAgBhwB,GAAM,GAAI,KAAMoqB,YAAa,YAC9E,CAAElqB,GAAI,OAAQC,KAAM,KAAMjC,MAAO8xB,EAAgBhwB,GAAM,KAAM,GAAIoqB,YAAa,aAC9E,CAAElqB,GAAI,MAAOC,KAAM,KAAMjC,MAAO8xB,EAAgBhwB,GAAM,GAAI,GAAIoqB,YAAa,aAC3E,CACIlqB,GAAI,OACJC,KAAM,IACNjC,MAAO8xB,EAAgBhwB,GAAM,MAAM,GACnCoqB,YAAa,mBAEjB,CAAElqB,GAAI,KAAMC,KAAM,IAAKjC,MAAO8xB,EAAgBhwB,GAAM,MAAM,GAAIoqB,YAAa,gBAC3E,CAAElqB,GAAI,OAAQC,KAAM,IAAKjC,MAAO8xB,EAAgBhwB,GAAM,MAAM,GAAIoqB,YAAa,iBAC7E,CAAElqB,GAAI,MAAOC,KAAM,IAAKjC,MAAO8xB,EAAgBhwB,GAAM,MAAM,GAAIoqB,YAAa,oBAI9EgG,GAAe,IAAAnT,UAAS,KAC1B,MAAMjd,EAAOkwB,EAAchyB,MAC3B,MAAO,CACH,CACIgC,GAAI,WACJC,KAAM,KACNjC,MAAO8xB,EAAgBhwB,GAAM,MAAM,IACnCoqB,YAAa,yBAEjB,CACIlqB,GAAI,QACJC,KAAM,KACNjC,MAAO8xB,EAAgBhwB,GAAM,MAAM,IACnCoqB,YAAa,wBAEjB,CACIlqB,GAAI,SACJC,KAAM,KACNjC,MAAO8xB,EAAgBhwB,GAAM,MAAM,IACnCoqB,YAAa,sBAEjB,CACIlqB,GAAI,OACJC,KAAM,KACNjC,MAAO8xB,EAAgBhwB,GAAM,MAAM,IACnCoqB,YAAa,wBAEjB,CACIlqB,GAAI,OACJC,KAAM,KACNjC,MAAO8xB,EAAgBhwB,GAAM,MAAM,IACnCoqB,YAAa,uBAKnBiG,GAAe,IAAApT,UAAS,KAC1B,MAAMjd,EAAOkwB,EAAchyB,MAC3B,IAAK8B,IAASA,EAAK,OACf,MAAO,GACX,MAAMswB,EAAQtwB,EAAK,OACb0sB,EAAQ,GAAMhtB,YAAY,KAAKM,EAAK,MACpCqN,EAAiBqf,GAAO,IAAI,KAAK,OACjC6D,EAAeljB,EAAiBqf,GAAO,GAAG,OAAOrf,GAAkB,KACnEmjB,EAAqBD,GAAc,MAAM,KACzCE,EAAc,CAAC,OAAQ,SAC7B,OAAOnzB,OAAOwF,QAAQwtB,GACjB1xB,OAAO,EAAEtC,KAAiB,UAARA,GAClB0I,IAAI,EAAE1I,EAAKo0B,MACZ,MAAMC,EAAWH,EAAqBA,EAAmBl0B,GAAO,KAC1D6D,EAAOwwB,GAAU,IAAMr0B,EACvBs0B,EAAYH,EAAY9uB,SAASxB,GACvC,IAAIiqB,EAAcuG,GAAU,IAAM,SAASxwB,IACvCjC,EAAQ,KACRkC,EAAO,OACPwR,EAAM,MACV,GAAyB,iBAAd8e,GAAwC,OAAdA,EAAoB,CACrDtG,EAAcsG,EAAUtG,aAAeA,EACvC,MAAMyG,EAAYvzB,OAAOgG,KAAKotB,GAAW9xB,OAAOkyB,GAAW,UAANA,GAAuB,gBAANA,GACtE,IAAK,YAAaJ,GAAa,OAAQA,KAAe,QAASA,GAAa,OAAQA,GAChFtwB,EAAO,QACPlC,EAAQ8xB,EAAgBU,EAAU,IAAMA,EAAUK,QAAS,GAC3Dnf,EAAMoe,EAAgBU,EAAU,IAAMA,EAAU9e,IAAK,KACrDwY,EAAc,GAAGjqB,MAASjC,OAAW0T,SAEpC,GAAI,UAAW8e,EAChBxyB,EAAQ8xB,EAAgBU,EAAUxyB,MAAO,UAExC,GAAI2yB,EAAUvrB,OAAS,GACxBurB,EAAUG,MAAMF,GAA6B,iBAAjBJ,EAAUI,IAAmBJ,EAAUI,IAAI,IACvE5yB,EAAQ2yB,EAAU7rB,IAAI8rB,GAAKJ,EAAUI,GAAG,IAAIjb,KAAK,UAEhD,GAAIgb,EAAUvrB,OAAS,EAAG,CAC3BpH,EAAQ,MAMRksB,EAJyB9sB,OAAOgG,KAAKotB,GAChC9xB,OAAOkyB,GAAW,UAANA,GAAuB,gBAANA,GAA6B,OAANA,GACpD9rB,IAAI8rB,GAAK,GAAGA,MAAMd,EAAgBU,EAAUI,OAC5Cjb,KAAK,MAEd,CACJ,MAEI3X,EAAQ8xB,EAAgBU,EAAW,KAEvC,MAAO,CAAExwB,GAAI5D,EAAK6D,KAAMA,EAAMjC,QAAO0T,MAAKxR,OAAMgqB,cAAawG,iBAG/DK,EAAoBrH,IACtBkG,EAAY5xB,MAAQ0rB,EAAKzpB,KACzB4vB,EAAkB7xB,MAAQ0rB,EAAKQ,aAAe,IAE5C8G,EAAqB,KACvBpB,EAAY5xB,MArJH,KAsJT6xB,EAAkB7xB,MAAQ2xB,IAE9B,MAAO,CAAC9L,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACzD,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,aACpBA,EAAO,KAAOA,EAAO,IAAK,wBAAoB,MAAO,CAAEjC,MAAO,wBAA0B,MAAO,IAC/FiC,EAAO,KAAOA,EAAO,IAAK,wBAAoB,MAAO,CAAEjC,MAAO,wBAA0B,MAAO,IAC/FiC,EAAO,KAAOA,EAAO,IAAK,wBAAoB,MAAO,CAAEjC,MAAO,wBAA0B,MAAO,IAC/FiC,EAAO,KAAOA,EAAO,IAAK,wBAAoB,MAAO,CAAEjC,MAAO,wBAA0B,MAAO,KAC/F,wBAAoB,aACpB,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,OAAQ,IAAY,qBAAiB+N,EAAY5xB,OAAQ,IAC7E,wBAAoB,MAAO,IAAY,qBAAiB6xB,EAAkB7xB,OAAQ,QAG1F,wBAAoB,eACpB,wBAAoB,MAAO,GAAY,GAClC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYiyB,EAAejyB,MAAO,CAACizB,EAAMhjB,MACrF,kBAAc,wBAAoB,MAAO,CAC7C7R,IAAK60B,EAAKjxB,GACV6hB,MAAO,kBACPkB,OAAO,oBAAgB,CAAE,UAAY9U,EAAQgiB,EAAejyB,MAAMoH,OAAU,IAAM,QAClF8rB,aAAe/M,GAAY4M,EAAiBE,GAC5CE,aAAcH,GACf,EACC,wBAAoB,OAAQ,IAAY,qBAAiBC,EAAKhxB,MAAO,IACrE,wBAAoB,OAAQ,IAAa,qBAAiBgxB,EAAKjzB,OAAQ,IACxE,GAAuC,MAC1C,SAER,wBAAoB,eACpB,wBAAoB,MAAO,GAAa,GACnC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYkyB,EAAalyB,MAAO,CAACozB,EAAOnjB,MACpF,kBAAc,wBAAoB,MAAO,CAC7C7R,IAAKg1B,EAAMpxB,GACX6hB,MAAO,kBACPkB,OAAO,oBAAgB,CAAE,UAAY9U,EAAQiiB,EAAalyB,MAAMoH,OAAU,IAAM,GAAK,QACrF8rB,aAAe/M,GAAY4M,EAAiBK,GAC5CD,aAAcH,GACf,EACC,wBAAoB,OAAQ,IAAa,qBAAiBI,EAAMnxB,MAAO,IACvE,wBAAoB,OAAQ,IAAa,qBAAiBmxB,EAAMpzB,OAAQ,IACzE,GAAuC,MAC1C,SAER,wBAAoB,iBACpB,wBAAoB,MAAO,GAAa,GACnC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYmyB,EAAanyB,MAAO,CAACmsB,EAAMlc,MACnF,kBAAc,wBAAoB,WAAW,CACjD7R,IAAK+tB,EAAKnqB,IACX,EACC,wBAAoB,uBACL,UAAdmqB,EAAKjqB,OACC,kBAAc,wBAAoB,MAAO,CACxC9D,IAAK,EACLylB,MAAO,cACPkB,OAAO,oBAAgB,CAAE,UAAY9U,EAAQkiB,EAAanyB,MAAMoH,OAAU,IAAM,SACjF,GACE,kBAAc,wBAAoB,MAAO,GAAa,CACnD0e,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,CACpDjC,MAAO,QACPwP,GAAI,KACJC,GAAI,KACJzzB,EAAG,MACJ,MAAO,KACV,wBAAoB,SAAU,CAC1BgkB,MAAO,WACPwP,GAAI,KACJC,GAAI,KACJzzB,EAAG,KACHklB,OAAO,oBAAgB,CACnB,oBAAqB,KAChB,GAC0B,iBAAfoH,EAAKnsB,OAA0C,iBAAbmsB,EAAKzY,KAAoByY,EAAKzY,IAAM,EACxEyY,EAAKnsB,MAAQmsB,EAAKzY,IAClB,OAEnB,KAAM,OAEb,wBAAoB,MAAO,CACvBmQ,MAAO,cACPqP,aAAe/M,GAAY4M,EAAiB5G,GAC5CgH,aAAcH,IACf,qBAAiB7G,EAAKlqB,MAAO,GAAsC,KACvE,MACA,kBAAc,wBAAoB,WAAW,CAAE7D,IAAK,GAAK,EACxD,wBAAoB,yBACpB,wBAAoB,MAAO,CACvBylB,MAAO,kBACPkB,OAAO,oBAAgB,CAAE,UAAY9U,EAAQkiB,EAAanyB,MAAMoH,OAAU,IAAM,QAChF8rB,aAAe/M,GAAY4M,EAAiB5G,GAC5CgH,aAAcH,GACf,EACC,wBAAoB,OAAQ,IAAa,qBAAiB7G,EAAKlqB,MAAO,GACtD,OAAfkqB,EAAKnsB,QACC,kBAAc,wBAAoB,OAAQ,IAAa,qBAAiBmsB,EAAKnsB,OAAQ,KACtF,wBAAoB,QAAQ,IACnC,GAAuC,KAC3C,QACR,MACH,YAKxB,ICvRJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjE,GAAa,CAAE6jB,MAAO,2CACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,mBAEL,GAAa,CAAEA,MAAO,kBACtB,GAAa,CAAEA,MAAO,4BACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,mBAEL,GAAa,CAAEA,MAAO,SACtB,GAAa,CAAEA,MAAO,SACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,eAEL,GAAa,CAAEA,MAAO,6BACtB,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,mBAEL,GAAc,CAAEA,MAAO,SACvB,GAAc,CAAEA,MAAO,SACvB,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,eAEL,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,iBAKX,IAA6B,qBAAiB,CAC1CwB,OAAQ,uBACR,KAAAM,CAAMC,GACF,MAAMkM,EAAkB,CAAC9xB,EAAO+xB,EAAe,IACvC/xB,QACO+xB,EACJ/xB,EAELuzB,EAAmBpH,IACrB,GAAIA,QACA,MAAO,IACX,GAAoB,iBAATA,IAAsB7lB,MAAMwI,QAAQqd,GAAO,CAClD,QAAgBztB,IAAZytB,EAAK,SAAgCztB,IAAZytB,EAAK,GAC9B,MAAO,GAAGA,EAAK,QAAQA,EAAK,KAGhC,OADa/sB,OAAOgG,KAAK+mB,GAAMzrB,OAAOkyB,GAAW,UAANA,GAClCxrB,OAAS,EACPhI,OAAOwF,QAAQunB,GACjBzrB,OAAO,EAAEtC,KAAiB,UAARA,GAClB0I,IAAI,EAAE1I,EAAKC,KAAS,GAAGD,MAAQ0zB,EAAgBzzB,MAC/CsZ,KAAK,MAEP,MACX,CACA,OAAO+C,OAAOoX,EAAgB3F,KAE5BqH,GAA0B,IAAAzU,UAAS,IAAM,EAAA0U,cAAA,OAAqB,QAAU,CAAC,GACzEC,GAAmB,IAAA3U,UAAS,IAAM,EAAA0U,cAAA,OAAqB,MAAQ,CAAC,GAChEE,GAAe,IAAA1G,MAAI,GACzB,MAAO,CAACpH,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACxD,WAAO,EAAA2N,iBACD,kBAAc,wBAAoB,MAAO,GAAY,EACpD,wBAAoB,SACpB,iBAAaG,GAAc,CAAEtsB,WAAW,WAAO,EAAAmsB,gBAAkB,KAAM,EAAe,CAAC,eACvF,wBAAoB,SACpB,wBAAoB,MAAO,CACvB5P,OAAO,oBAAgB,CAAC,yBAA0B,CAAE,UAAW8P,EAAa3zB,UAC7E,EACC,wBAAoB,SAAU,CAC1B6jB,MAAO,gBACPoC,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAYwN,EAAa3zB,OAAS2zB,EAAa3zB,QACpF,IAAK8lB,EAAO,KAAOA,EAAO,GAAK,EAC1B,wBAAoB,IAAK,CAAEjC,MAAO,eAAiB,MAAO,IAC1D,wBAAoB,OAAQ,KAAM,MAAO,QAEjD,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,aACpB,wBAAoB,MAAO,GAAY,CACnCiC,EAAO,KAAOA,EAAO,IAAK,wBAAoB,KAAM,CAAEjC,MAAO,iBAAmB,QAAS,IACxF2P,EAAwBxzB,OAASZ,OAAOgG,KAAKouB,EAAwBxzB,OAAOoH,OAAS,IAC/E,kBAAc,wBAAoB,KAAM,GAAY,GAClD,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYosB,EAAwBxzB,MAAO,CAACA,EAAO5B,MAC/F,kBAAc,wBAAoB,KAAM,CAC5CA,IAAKA,EACLylB,MAAO,kBACR,EACC,wBAAoB,OAAQ,IAAY,qBAAiBzlB,GAAM,IAC/D,wBAAoB,OAAQ,IAAY,qBAAiBm1B,EAAgBvzB,IAAS,OAEtF,WAEL,kBAAc,wBAAoB,MAAO,GAAY,SAEhE,wBAAoB,WACpB,wBAAoB,MAAO,GAAY,CACnC8lB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,KAAM,CAAEjC,MAAO,iBAAmB,QAAS,IACxF6P,EAAiB1zB,OAASZ,OAAOgG,KAAKsuB,EAAiB1zB,OAAOoH,OAAS,IACjE,kBAAc,wBAAoB,KAAM,GAAa,GACnD,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYssB,EAAiB1zB,MAAO,CAACA,EAAO5B,MACxF,kBAAc,wBAAoB,KAAM,CAC5CA,IAAKA,EACLylB,MAAO,kBACR,EACC,wBAAoB,OAAQ,IAAa,qBAAiBzlB,GAAM,IAChE,wBAAoB,OAAQ,IAAa,qBAAiBm1B,EAAgBvzB,IAAS,OAEvF,WAEL,kBAAc,wBAAoB,MAAO,GAAa,WAGtE,QAEJ,kBAAc,wBAAoB,MAAO,GAAa,iBAGzE,ICpHJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjE,GAAa,CAAE6jB,MAAO,iCACtB,GAAa,CAAEA,MAAO,gBACtB,GAAa,CAAEA,MAAO,uBACtB,GAAa,CAAEA,MAAO,aACtB,GAAa,CAAC,WACd,GAAa,CACfA,MAAO,gBACP6N,QAAS,eAEP,GAAa,CAAC,MACd,GAAa,CAAC,cACd,GAAa,CAAE7N,MAAO,eACtB,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,iBAEL,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,cAEL,GAAc,CAAEA,MAAO,sBACvB,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,kBAEL,GAAc,CAAEA,MAAO,eACvB,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,aAEL,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,aAEL,GAAc,CAAEA,MAAO,eACvB,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,kBAEL,GAAc,CAAEzlB,IAAK,GACrB,GAAc,CAAEA,IAAK,GACrB,GAAc,CAChBA,IAAK,EACLylB,MAAO,WAIX,IAA6B,qBAAiB,CAC1CwB,OAAQ,uBACR,KAAAM,CAAMC,GACF,MAAMiO,GAAe,IAAA5G,KAAI,MAInB6G,EAAc,KAChBD,EAAa7zB,MAAQ,MAEnB+zB,GAAc,IAAAhV,UAAS,IAClB,EAAAiV,gBAAA,OAELC,EAAe,CACjBC,OAAQ,gBACRC,KAAM,eACNC,KAAM,eACNC,UAAW,gBAETC,EAAgB5I,IAClB,IAAI6I,EAAU,SACd,GAAI7I,GAAQA,EAAK,GAAI,CACjB,MAAM8I,EAAO9I,EAAK,GACd8I,GAAQ,EACRD,EAAU,YACLC,GAAQ,EACbD,EAAU,OACLC,GAAQ,IACbD,EAAU,OAClB,CACA,MAAO,CACH,mBAAoBN,EAAaM,KAGzC,MAAO,CAAC1O,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACxD,WAAO,EAAA2N,iBACD,kBAAc,wBAAoB,MAAO,CACxCr1B,IAAK,EACLylB,OAAO,oBAAgB,CAAC,mBAAoB,CAAE,cAAegQ,EAAa7zB,UAC3E,EACC,wBAAoB,wCACpB,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,cACpB,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,MAAO,GAAY,GAClC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAY+zB,EAAY/zB,MAAO,CAAC0rB,EAAMzb,MAClF,kBAAc,wBAAoB,WAAW,CACjD7R,IAAKstB,EAAKzY,IAAM,QAAQhD,KACzB,EACC,wBAAoB,aACpB,wBAAoB,MAAO,CACvB4T,MAAO,YACPkB,OAAO,oBAAgBuP,EAAa5I,IACpCzF,QAAUE,GAlD/B,CAACuF,IAChBmI,EAAa7zB,MAAQ0rB,GAiDoC,CAAYA,IAClC,EACC,wBAAoB,eACnB,kBAAc,wBAAoB,MAAO,GAAY,EAClD,wBAAoB,OAAQ,KAAM,EAC9B,wBAAoB,gBACpB,wBAAoB,OAAQ,CACxB1pB,GAAI,YAAY0pB,EAAKzY,IAAMhD,IAC3BjR,EAAG,6BACHy1B,KAAM,QACP,KAAM,EAAe,OAE5B,wBAAoB,OAAQ,KAAM,EAC9B,wBAAoB,WAAY,CAC5B5Q,MAAO,WACP,aAAc,aAAa6H,EAAKzY,IAAMhD,IACtCykB,YAAa,MACb,cAAe,WAChB,qBAAiBhJ,EAAK,IAAK,EAAqB,UAG3D,wBAAoB,MAAO,GAAY,CAClC,OAAQA,GAAQA,EAAK,KACf,kBAAc,wBAAoB,OAAQ,GAAa,KAAM,qBAAiBA,EAAK,IAAK,KACzF,wBAAoB,QAAQ,MAEvC,GAAuB,KAC3B,MACH,QAEsB,IAA7BqI,EAAY/zB,MAAMoH,SACZ,kBAAc,wBAAoB,MAAO,GAAa,IAAK0e,EAAO,KAAOA,EAAO,GAAK,EAChF,wBAAoB,IAAK,KAAM,QAAS,SAE9C,wBAAoB,QAAQ,QAG1C,wBAAoB,gCACpB,wBAAoB,MAAO,GAAa,CACnC+N,EAAkB,QACZ,kBAAc,wBAAoB,MAAO,GAAa,EACrD,wBAAoB,SAAU,CAC1B5N,QAAS6N,EACTjQ,MAAO,gBACR,MACH,wBAAoB,KAAM,CACtBA,MAAO,cACPkB,OAAO,oBAAgBuP,EAAaT,EAAa7zB,UAClD,qBAAiB6zB,EAAa7zB,MAAM,IAAK,IAC5C,wBAAoB,MAAO,GAAa,CACnC6zB,EAAa7zB,MAAQ,KACf,kBAAc,wBAAoB,OAAQ,GAAa,OAAQ,qBAAiB6zB,EAAa7zB,MAAM,IAAK,KACzG,wBAAoB,QAAQ,GACjC6zB,EAAa7zB,MAAQ,KACf,kBAAc,wBAAoB,OAAQ,IAAa,qBAAiB6zB,EAAa7zB,MAAM,IAAK,KACjG,wBAAoB,QAAQ,MAEtC,wBAAoB,IAAK,IAAa,qBAAiB6zB,EAAa7zB,MAAM,IAAK,GAC9E6zB,EAAa7zB,MAAa,UACpB,kBAAc,wBAAoB,MAAO,GAAa,CACrD8lB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,KAAM,KAAM,OAAQ,IACjE+N,EAAa7zB,MAAMsvB,QAAQC,kBAAoBnwB,OAAOgG,KAAKyuB,EAAa7zB,MAAMsvB,QAAQC,kBAAkBnoB,OAAS,IAC3G,kBAAc,wBAAoB,KAAM,GAAa,GACnD,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYysB,EAAa7zB,MAAMsvB,QAAQC,iBAAkB,CAACvvB,EAAO5B,MAC7G,kBAAc,wBAAoB,KAAM,CAAEA,IAAKA,IAAO,qBAAiBA,GAAO,MAAO,qBAAiB4B,GAAQ,KACtH,UAEN,wBAAoB,QAAQ,GACjC6zB,EAAa7zB,MAAMsvB,QAAQE,kBAAoBpwB,OAAOgG,KAAKyuB,EAAa7zB,MAAMsvB,QAAQE,kBAAkBpoB,OAAS,IAC3G,kBAAc,wBAAoB,KAAM,GAAa,GACnD,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYysB,EAAa7zB,MAAMsvB,QAAQE,iBAAkB,CAACxvB,EAAO5B,MAC7G,kBAAc,wBAAoB,KAAM,CAAEA,IAAKA,IAAO,qBAAiBA,GAAO,KAAM,qBAAiB4B,GAAQ,KACrH,UAEN,wBAAoB,QAAQ,OAEpC,wBAAoB,QAAQ,OAEpC,wBAAoB,QAAQ,MAEvC,MACA,kBAAc,wBAAoB,MAAO,GAAa,aAGzE,ICnLJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjE,GAAa,CAAE6jB,MAAO,qCACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,qBAEL,GAAa,CAAEA,MAAO,eACtB,GAAa,CAAC,KACd,GAAa,CAAC,WACd,GAAa,CAAEA,MAAO,cACtB,GAAa,CAAC,WACd,GAAa,CAAEA,MAAO,eACtB,GAAa,CAAEA,MAAO,eACtB,GAAc,CAAEzlB,IAAK,GACrB,GAAc,CAAEA,IAAK,GACrB,GAAc,CAAEA,IAAK,GACrB,GAAc,CAAEA,IAAK,GACrB,GAAc,CAChBA,IAAK,EACLylB,MAAO,WAKX,IAA6B,qBAAiB,CAC1CwB,OAAQ,mBACR,KAAAM,CAAMC,GACF,MAAM+O,GAAU,IAAA5V,UAAS,KAAM,IAAAxf,KAAI,EAAAk0B,cAAA,MAAqB,OAAQ,OAa1DmB,GAAW,IAAA7V,UAAS,KACtB,IAAK4V,EAAQ30B,MACT,MAAO,GACX,MAAM60B,GAAa,IAAAt1B,KAAIo1B,EAAQ30B,MAAO,OAAQ,CAAC,GAC/C,OAAOZ,OAAOkE,OAAOuxB,KAEnBC,GAAe,IAAA/V,UAAS,IACrB4V,EAAQ30B,OAEN,IAAAT,KAAIo1B,EAAQ30B,MAAO,OAAQ,MADvB,MAGT+0B,GAAe,IAAAhW,UAAS,IACnB6V,EAAS50B,MAAMU,OAAOs0B,GAAoB,SAAZA,EAAK,KAExCC,GAAe,IAAAlW,UAAS,IACnB6V,EAAS50B,MAAMU,OAAOs0B,GAAoB,SAAZA,EAAK,KAExCE,GAAe,IAAAjI,KAAI,MACnBkI,GAAmB,IAAA5lB,UAAS,CAAE6lB,IAAK,MAAOzI,KAAM,MAAO3Z,UAAW,0BAClEqiB,EAAmBC,IACrB,IAAKA,EACD,MAAO,IACX,MAAMN,EAAOJ,EAAS50B,MAAMuD,KAAKkW,GAAKA,EAAExG,KAAOqiB,GAC/C,OAAON,EAAOA,EAAK,GAAKM,GAEtBC,GAAgB,IAAAxW,UAAS,KAC3B,MAAMyW,EAAY,GACZC,EAAaV,EAAa/0B,MAAMoH,OACtCouB,EAAUh1B,KAAK,CAAE40B,IAAK,MAAOzI,KAAM,QASnC,OANAoI,EAAa/0B,MAAMa,QAAQ,CAAC6B,EAAGyI,KAC3B,MAAMuqB,EAAWD,EAAa,EAAItqB,GAAKsqB,EAAa,GAAK,GACnDzL,EAJK,GAIQ,GAAkB0L,EAC/B5L,EAAI,GAAK,GAAKrW,KAAKkiB,IAAID,EAAWjiB,KAAKmiB,GAAK,GAClDJ,EAAUh1B,KAAK,CAAE40B,IAAK,GAAGpL,KAAM2C,KAAM,GAAG7C,SAErC0L,IAELK,GAAY,IAAA9W,UAAS,KACvB,GAAIwW,EAAcv1B,MAAMoH,QAAU,EAC9B,MAAO,GACX,MAAM0uB,EAAQ,GACd,IAAK,IAAI3qB,EAAI,EAAGA,EAAI4pB,EAAa/0B,MAAMoH,OAAS,EAAG+D,IAAK,CACpD,MAAM4qB,EAAWR,EAAcv1B,MAAMmL,EAAI,GACnC6qB,EAAST,EAAcv1B,MAAMmL,EAAI,GACjCnM,EAAI,KAAKi3B,WAAWF,EAASpJ,SAASsJ,WAAWF,EAASX,WAAWa,WAAWF,EAASpJ,MAAQsJ,WAAWD,EAAOrJ,OAAS,MAAMsJ,WAAWF,EAASX,KAAOa,WAAWD,EAAOZ,MAAQ,KAAKa,WAAWD,EAAOrJ,SAASsJ,WAAWD,EAAOZ,OAC/OU,EAAMt1B,KAAK,CACPxB,IACA6kB,MAAwC,OAAjCkR,EAAa/0B,MAAMmL,EAAI,GAAG,GAAc,sBAAwB,aAE/E,CACA,GAAI4pB,EAAa/0B,MAAMoH,OAAS,EAAG,CAC/B,MAAM8uB,EAAcX,EAAcv1B,MAAM+0B,EAAa/0B,MAAMoH,QACrD+uB,EAAcZ,EAAcv1B,MAAM,GAClChB,EAAI,KAAKi3B,WAAWC,EAAYvJ,SAASsJ,WAAWC,EAAYd,WAAWa,WAAWC,EAAYvJ,MAAQsJ,WAAWE,EAAYxJ,OAAS,MAAMsJ,WAAWC,EAAYd,KAAOa,WAAWE,EAAYf,MAAQ,KAAKa,WAAWE,EAAYxJ,SAASsJ,WAAWE,EAAYf,OAC/QU,EAAMt1B,KAAK,CACPxB,IACA6kB,MAAgE,OAAzDkR,EAAa/0B,MAAM+0B,EAAa/0B,MAAMoH,OAAS,GAAG,GAAc,sBAAwB,aAEvG,CAcA,OAbA6tB,EAAaj1B,MAAMa,QAAQ,CAACm0B,EAAM/kB,KAC9B,MAAMmmB,EAAarB,EAAa/0B,MAAMuD,KAAK1E,GAAKA,EAAEoU,KAAO+hB,EAAK,QAC9D,GAAIoB,EAAY,CACZ,MAAMC,EAAkBtB,EAAa/0B,MAAM8J,QAAQssB,GAC7CE,EAAYf,EAAcv1B,MAAMq2B,EAAkB,GAClDE,EAAUC,EAAuBxB,EAAM/kB,GACvCjR,EAAI,KAAKi3B,WAAWK,EAAU3J,SAASsJ,WAAWK,EAAUlB,UAAUa,WAAWM,EAAQ5J,KAAK7f,QAAQ,QAAS,IAAIA,QAAQ,IAAK,QAAQmpB,WAAWM,EAAQnB,IAAItoB,QAAQ,QAAS,IAAIA,QAAQ,IAAK,OACvMgpB,EAAMt1B,KAAK,CACPxB,IACA6kB,MAAO,0BAEf,IAEGiS,IAELU,EAAyB,CAACxB,EAAM/kB,KAClC,MAAMmmB,EAAarB,EAAa/0B,MAAMuD,KAAK1E,GAAKA,EAAEoU,KAAO+hB,EAAK,QAC9D,IAAKoB,EACD,MAAO,CAAEhB,IAAK,KAAMzI,KAAM,MAC9B,MAAM0J,EAAkBtB,EAAa/0B,MAAM8J,QAAQssB,GAC7CE,EAAYf,EAAcv1B,MAAMq2B,EAAkB,GAClDI,GAAWxmB,EAAQ,GAAM,EAAI,GAAK,IAAMwD,KAAKijB,MAAMzmB,EAAQ,GAAK,GAChE0mB,GAAW1mB,EAAQ,GAAM,GAAK,EAAI,IAAMwD,KAAKijB,MAAMzmB,EAAQ,GAAK,GACtE,MAAO,CACHmlB,IAAK,QAAQkB,EAAUlB,SAASuB,MAChChK,KAAM,QAAQ2J,EAAU3J,UAAU8J,QAGpCG,EAAa,CAACC,EAAU30B,EAAM+Z,KAChCiZ,EAAal1B,MAAQ,CAAEmV,KAAM0hB,EAAU30B,OAAM40B,GAAI7a,EAAM8a,eACvD,MAAMC,EAAW/a,EAAM8a,cACjB3B,EAAM,QAAQ4B,EAASjS,MAAMqQ,cAC7BzI,EAAO,QAAQqK,EAASjS,MAAM4H,eACpCwI,EAAiBC,IAAMA,EACvBD,EAAiBxI,KAAOA,GAEtBsK,EAAahb,IACf,MAAMib,EAAQjb,EAAM/d,OAAOi5B,QAAQ,sBACnC,IAAKD,EACD,OACJ,MAAME,EAASnb,EAAM8N,QACfsN,EAASpb,EAAMgO,QACfqN,EAAWJ,EAAMK,UACjBC,EAAYN,EAAMO,WAClBC,EAAUrsB,IACZ8pB,EAAiBC,IAASkC,EAAWjsB,EAAE4e,QAAUoN,EAA1B,KACvBlC,EAAiBxI,KAAU6K,EAAYnsB,EAAE0e,QAAUqN,EAA3B,MAEtBO,EAAW,KACb/U,SAASgV,oBAAoB,YAAaF,GAC1C9U,SAASgV,oBAAoB,UAAWD,IAE5C/U,SAASiV,iBAAiB,YAAaH,GACvC9U,SAASiV,iBAAiB,UAAWF,IAEnCG,EAAmB7nB,GACdslB,EAAcv1B,MAAMiQ,IAAU,CAAEmlB,IAAK,MAAOzI,KAAM,OAE7D,MAAO,CAAC9G,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,CACxD6O,EAAa,QACP,kBAAc,wBAAoB,MAAO,GAAY,GACnD,kBAAc,wBAAoB,MAAO,GAAY,CAClD7O,EAAO,KAAOA,EAAO,IAAK,wBAAoB,OAAQ,KAAM,EACxD,wBAAoB,iBAAkB,CAClC9jB,GAAI,iBACJ+1B,GAAI,KACJC,GAAI,KACJC,GAAI,KACJC,GAAI,QACL,EACC,wBAAoB,OAAQ,CACxBC,OAAQ,KACRpT,MAAO,CAAE,aAAc,6BAE3B,wBAAoB,OAAQ,CACxBoT,OAAQ,OACRpT,MAAO,CAAE,aAAc,iCAG/B,KACJ,wBAAoB,UACnB,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAY8Q,EAAU71B,MAAQ0X,KAC1E,kBAAc,wBAAoB,OAAQ,CAC9CtZ,IAAKsZ,EAAK1Y,EACVA,EAAG0Y,EAAK1Y,EACR6kB,OAAO,oBAAgBnM,EAAKmM,QAC7B,KAAM,GAAuB,MAChC,UAER,wBAAoB,eACnBiR,EAAkB,QACZ,kBAAc,wBAAoB,MAAO,CACxC12B,IAAK,EACLylB,MAAO,0BACPkB,OAAO,oBAAgB+S,EAAgB,IACvC7R,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAYyQ,EAAW9B,EAAa90B,MAAO,WAAYmmB,KAC5F,IAAKL,EAAO,KAAOA,EAAO,GAAK,EAC1B,wBAAoB,MAAO,CAAEjC,MAAO,aAAe,MAAO,IAC1D,wBAAoB,MAAO,CAAEA,MAAO,cAAgB,QAAS,MAC3D,KACR,wBAAoB,QAAQ,IAClC,wBAAoB,iBACnB,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYkR,EAAa/0B,MAAO,CAACizB,EAAMhjB,MACnF,kBAAc,wBAAoB,MAAO,CAC7C7R,IAAK60B,EAAKhgB,GACV4Q,OAAO,oBAAgB,CAAC,yBAA0B,CAAEuU,UAAuB,OAAZnF,EAAK,MACpElO,OAAO,oBAAgB+S,EAAgB7nB,EAAQ,IAC/CgW,QAAUE,GAAYyQ,EAAW3D,EAAM,UAAW9M,IACnD,CACCL,EAAO,KAAOA,EAAO,IAAK,wBAAoB,MAAO,CAAEjC,MAAO,aAAe,MAAO,KACpF,wBAAoB,MAAO,IAAY,qBAAiBoP,EAAK,IAAK,IACnE,GAA8B,MACjC,OACJ,wBAAoB,iBACnB,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYgC,EAAaj1B,MAAO,CAACg1B,EAAM/kB,MACnF,kBAAc,wBAAoB,MAAO,CAC7C7R,IAAK42B,EAAK/hB,GACV4Q,MAAO,yBACPkB,OAAO,oBAAgByR,EAAuBxB,EAAM/kB,IACpDgW,QAAUE,GAAYyQ,EAAW5B,EAAM,UAAW7O,IACnD,IAAKL,EAAO,KAAOA,EAAO,GAAK,EAC1B,wBAAoB,MAAO,CAAEjC,MAAO,aAAe,MAAO,MACxD,GAAuB,MACjC,OACJ,wBAAoB,UACnBqR,EAAkB,QACZ,kBAAc,wBAAoB,MAAO,CACxC92B,IAAK,EACLylB,MAAO,oBACPkB,OAAO,oBAAgBoQ,IACxB,EACC,wBAAoB,KAAM,CACtBtR,MAAO,eACPwU,YAAapB,IACd,qBAAiB/B,EAAal1B,MAAMmV,KAAK,IAAK,KACjD,wBAAoB,IAAK,IAAY,qBAAiB+f,EAAal1B,MAAMmV,KAAK,IAAK,IACnF,wBAAoB,MAAO,GAAY,CAClC+f,EAAal1B,MAAMmV,KAAO,KACpB,kBAAc,wBAAoB,IAAK,GAAa,CACnD2Q,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,OAAQ,KACtE,qBAAiB,KAAM,qBAAiBoP,EAAal1B,MAAMmV,KAAK,IAAK,OAEvE,wBAAoB,QAAQ,GACjC+f,EAAal1B,MAAMmV,KAAO,KACpB,kBAAc,wBAAoB,IAAK,GAAa,CACnD2Q,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,OAAQ,KACtE,qBAAiB,KAAM,qBAAiBoP,EAAal1B,MAAMmV,KAAK,IAAK,OAEvE,wBAAoB,QAAQ,GACjC+f,EAAal1B,MAAMmV,KAAW,SACxB,kBAAc,wBAAoB,IAAK,GAAa,CACnD2Q,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,OAAQ,KACtE,qBAAiB,KAAM,qBAAiBuP,EAAgBH,EAAal1B,MAAMmV,KAAK,SAAU,OAE5F,wBAAoB,QAAQ,GACL,aAA5B+f,EAAal1B,MAAMkC,MAAuBgzB,EAAal1B,MAAMmV,KAAK,OAC5D,kBAAc,wBAAoB,IAAK,GAAa,CACnD2Q,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,SAAU,KACxE,qBAAiB,KAAM,qBAAiBoP,EAAal1B,MAAMmV,KAAK,KAAKwC,KAAK,OAAQ,OAEpF,wBAAoB,QAAQ,MAEtC,wBAAoB,SAAU,CAC1BkM,MAAO,eACPoC,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAY+O,EAAal1B,MAAQ,OACtE,MACJ,KACD,wBAAoB,QAAQ,QAEnC,kBAAc,wBAAoB,MAAO,GAAa,EACrD,wBAAoB,IAAK,MAAM,sBAAiB,WAAO,EAAAyzB,eAAiB,cAAgB,cAAe,QAI3H,IC7QJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjE,GAAa,CAAE5P,MAAO,2CACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,mBAEL,GAAa,CAAEA,MAAO,kBACtB,GAAa,CAAEA,MAAO,aACtB,GAAa,CAAEA,MAAO,SACtB,GAAa,CAAEA,MAAO,aACtB,GAAa,CAAEA,MAAO,SACtB,GAAa,CAAEA,MAAO,4BACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,mBAEL,GAAc,CAAEA,MAAO,SACvB,GAAc,CAAEA,MAAO,SACvB,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,eAEL,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,iBAMX,IAA6B,qBAAiB,CAC1CwB,OAAQ,iBACR,KAAAM,CAAMC,GACF,MAAMkM,EAAkB,CAAC9xB,EAAO+xB,EAAe,IACvC/xB,QACO+xB,EACJ/xB,EAELs4B,EAAwB9F,IAC1B,GAAIA,QACA,MAAO,IACX,GAAyB,iBAAdA,IAA2BlsB,MAAMwI,QAAQ0jB,GAAY,CAE5D,MAAM,GAAE,KAAO+F,GAAS/F,EAClBptB,EAAOhG,OAAOgG,KAAKmzB,GAAM73B,OAAOkyB,GAAW,UAANA,GAAuB,gBAANA,GAC5D,OAAoB,IAAhBxtB,EAAKgC,OACE,QAEU1I,IAAjB65B,EAAK1F,cAAsCn0B,IAAb65B,EAAK7kB,IAC5B,GAAG6kB,EAAK1F,aAAa0F,EAAK7kB,WAErBhV,IAAZ65B,EAAK,SAAgC75B,IAAZ65B,EAAK,GACvB,GAAGA,EAAK,QAAQA,EAAK,UAGb75B,IAAf65B,EAAKv4B,OAAuC,IAAhBoF,EAAKgC,OAC1BsT,OAAOoX,EAAgByG,EAAKv4B,QAGnCoF,EAAKgC,OAAS,GAAKhC,EAAK0tB,MAAMF,GAAwB,iBAAZ2F,EAAK3F,IAAmB2F,EAAK3F,IAAI,IACpExtB,EAAK0B,IAAI8rB,GAAK2F,EAAK3F,GAAG,IAAIjb,KAAK,KAGtCvS,EAAKgC,OAAS,EACPhC,EAAK0B,IAAI1I,GAAO,GAAGA,MAAQ0zB,EAAgByG,EAAKn6B,OAASuZ,KAAK,OAElE,KACX,CACA,OAAO+C,OAAOoX,EAAgBU,KAE5BlrB,GAAY,IAAAyX,UAAS,IAAM,GAAMzX,WAEjCkxB,IADa,IAAAzZ,UAAS,IAAM+S,EAAgBxqB,EAAUtH,OAAO,KAAM,KACxD,IAAA+e,UAAS,IAAM+S,EAAgBxqB,EAAUtH,OAAO,GAAI,KAC/Dy4B,EAAkB,EAAAC,sBAClB/E,GAAe,IAAA1G,MAAI,GACzB,MAAO,CAACpH,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,CACxDxe,EAAe,QACT,kBAAc,wBAAoB,MAAO,GAAY,EACpD,wBAAoB,SACpB,iBAAassB,GAAc,CAAEtsB,UAAWA,EAAUtH,OAAS,KAAM,EAAe,CAAC,eACjF,wBAAoB,SACpB,wBAAoB,MAAO,CACvB6jB,OAAO,oBAAgB,CAAC,yBAA0B,CAAE,UAAW8P,EAAa3zB,UAC7E,EACC,wBAAoB,SAAU,CAC1B6jB,MAAO,gBACPoC,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAYwN,EAAa3zB,OAAS2zB,EAAa3zB,QACpF,IAAK8lB,EAAO,KAAOA,EAAO,GAAK,EAC1B,wBAAoB,IAAK,CAAEjC,MAAO,eAAiB,MAAO,IAC1D,wBAAoB,OAAQ,KAAM,MAAO,QAEjD,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,MAAO,GAAY,CACnCiC,EAAO,KAAOA,EAAO,IAAK,wBAAoB,OAAQ,CAAEjC,MAAO,SAAW,OAAQ,KAClF,wBAAoB,OAAQ,IAAY,qBAAiBiO,EAAgBxqB,EAAUtH,MAAM,GAAI,OAAQ,MAEzG,wBAAoB,MAAO,GAAY,CACnC8lB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,OAAQ,CAAEjC,MAAO,SAAW,OAAQ,KAClF,wBAAoB,OAAQ,IAAY,qBAAiB2U,EAASx4B,OAAQ,MAE9E,wBAAoB,aACpB,wBAAoB,MAAO,GAAY,CACnC8lB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,KAAM,CAAEjC,MAAO,iBAAmB,QAAS,KACxF,WAAO4U,GAAiBrxB,OAAS,IAC3B,kBAAc,wBAAoB,KAAM,GAAY,GAClD,gBAAW,IAAO,wBAAoB,WAAW,MAAM,iBAAY,WAAOqxB,GAAmBtM,KAClF,kBAAc,wBAAoB,KAAM,CAC5C/tB,IAAK+tB,EAAK/tB,IACVylB,MAAO,kBACR,EACC,wBAAoB,OAAQ,IAAa,qBAAiBsI,EAAK/tB,KAAM,IACrE,wBAAoB,OAAQ,IAAa,qBAAiBk6B,EAAqBnM,EAAKnsB,QAAS,OAEjG,WAEL,kBAAc,wBAAoB,MAAO,GAAa,WAGtE,QAEJ,kBAAc,wBAAoB,MAAO,GAAa,aAGzE,ICrHJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjE,GAAa,CACf5B,IAAK,EACLylB,MAAO,gCAEL,GAAa,CAAEA,MAAO,kBACtB,GAAa,CAAEA,MAAO,gBACtB,GAAa,CAAEA,MAAO,gBACtB,GAAa,CAAEA,MAAO,gBACtB,GAAa,CAAC,cACd,GAAa,CAAEA,MAAO,gBACtB,GAAa,CAAEA,MAAO,wBACtB,GAAa,CAAC,cACd,GAAc,CAAEA,MAAO,uBACvB,GAAc,CAAEA,MAAO,mBACvB,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,gBAEL,GAAc,CAAEA,MAAO,eACvB,GAAc,CAAEA,MAAO,gBACvB,GAAc,CAAEA,MAAO,eACvB,GAAc,CAAEA,MAAO,gBClB7B,IDmB6B,qBAAiB,CAC1CwB,OAAQ,qBACRpnB,MAAO,CACH06B,QAAS,CAAC,GAEdhT,MAAMC,GACK,CAACC,EAAMC,IACFF,EAAe,UAChB,kBAAc,wBAAoB,MAAO,GAAY,EACpD,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,KAAM,IAAY,qBAAiBA,EAAQ+S,QAAQ,IAAK,IAC5E,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,OAAQ,IAAY,qBAAiB/S,EAAQ+S,QAAQ,IAAK,IAC9E,wBAAoB,OAAQ,CACxB9U,MAAO,gBACP,aAAc+B,EAAQ+S,QAAQ,IAC/B,OAAQ,qBAAiB/S,EAAQ+S,QAAQ,IAAK,EAAqB,SAG9E,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,MAAO,CACvB9U,MAAO,kBACP,aAAc+B,EAAQ+S,QAAQ,IAC/B,EACC,wBAAoB,2DACpB7S,EAAO,KAAOA,EAAO,IAAK,wBAAoB,OAAQ,CAAEjC,MAAO,gBAAkB,KAAM,KACxF,EAAe,KAClB,wBAAoB,IAAK,IAAa,qBAAiB+B,EAAQ+S,QAAQ,IAAK,MAEhF,wBAAoB,MAAO,GAAa,CACpC7S,EAAO,KAAOA,EAAO,IAAK,wBAAoB,KAAM,CAAEjC,MAAO,iBAAmB,MAAO,IACtF+B,EAAQ+S,QAAe,UACjB,kBAAc,wBAAoB,KAAM,GAAa,CACnD/S,EAAQ+S,QAAQrJ,QAAwB,mBAClC,gBAAW,IAAO,wBAAoB,WAAW,CAAElxB,IAAK,IAAK,gBAAYwnB,EAAQ+S,QAAQrJ,QAAQC,iBAAkB,CAACvvB,EAAO5B,MAClH,kBAAc,wBAAoB,KAAM,CAC5CA,IAAKA,EACLylB,MAAO,eACR,EACC,wBAAoB,SAAU,IAAa,qBAAiBzlB,GAAO,IAAK,IACxE,wBAAoB,OAAQ,GAAa,KAAM,qBAAiB4B,GAAQ,GACxE8lB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,IAAK,CAAEjC,MAAO,sBAAwB,SAAU,QAElG,OACF,wBAAoB,QAAQ,GACjC+B,EAAQ+S,QAAQrJ,QAAwB,mBAClC,gBAAW,IAAO,wBAAoB,WAAW,CAAElxB,IAAK,IAAK,gBAAYwnB,EAAQ+S,QAAQrJ,QAAQE,iBAAkB,CAACxvB,EAAO5B,MAClH,kBAAc,wBAAoB,KAAM,CAC5CA,IAAKA,EACLylB,MAAO,eACR,EACC,wBAAoB,SAAU,IAAa,qBAAiBzlB,GAAO,IAAK,IACxE,wBAAoB,OAAQ,IAAa,qBAAiB4B,GAAQ,GAClE8lB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,IAAK,CAAEjC,MAAO,sBAAwB,SAAU,QAElG,OACF,wBAAoB,QAAQ,OAEpC,wBAAoB,QAAQ,WAI5C,wBAAoB,QAAQ,KErFxC,GAAa,CAAEA,MAAO,0CACtB,GAAa,CAAEA,MAAO,iBACtB,GAAa,CAAC,aAAc,WAC5B,GAAa,CAAEA,MAAO,gBACtB,GAAa,CAAEA,MAAO,iBACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,cAMX,IAA6B,qBAAiB,CAC1CwB,OAAQ,gBACR,KAAAM,CAAMC,GACF,MAAMgT,GAAW,IAAA7Z,UAAS,IAAM,EAAA8Z,sBAAA,OAK1BC,GAAiB,IAAA/Z,UAAS,KAC5B,MACMga,EAAS,IADOH,EAAS54B,OAAS,IAExC,KAAO+4B,EAAO3xB,OAAS,GACnB2xB,EAAOv4B,KAAK,MAEhB,OAAOu4B,EAAOvuB,MAAM,EAAG,KAE3B,MAAO,CAACqb,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACzD,wBAAoB,MAAO,GAAY,GAClC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYgT,EAAe94B,MAAO,CAAC24B,EAAS1oB,MACxF,kBAAc,wBAAoB,MAAO,CAC7C7R,IAAK6R,EACL4T,OAAO,oBAAgB,CAAC,eAAgB,CAAEmV,OAAQL,EAASM,YAAaN,KACxE,aAAcA,GAAS,GACvB1S,QAAUE,GAAYwS,GApBhB,CAACA,IACvBzN,GAAmBvb,KAAKgpB,EAAQ,GAAIO,GAAoB,CAAEP,aAmBTQ,CAAkBR,IACpD,CACCA,IACO,kBAAc,wBAAoB,WAAW,CAAEv6B,IAAK,GAAK,EACxD,wBAAoB,MAAO,IAAY,qBAAiBu6B,EAAQ,IAAK,IACrE,wBAAoB,MAAO,GAAY,QAAS,qBAAiBA,EAAQ,IAAK,IAC/E,OACA,kBAAc,wBAAoB,MAAO,GAAY,OAC7D,GAAuB,MAC1B,QAER7S,EAAO,KAAOA,EAAO,IAAK,wBAAoB,MAAO,CAAEjC,MAAO,sBAAwB,EAClF,wBAAoB,IAAK,KAAM,cAC/B,MAGhB,IC/CJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjE,GAAa,CACfzlB,IAAK,EACLylB,MAAO,qBAEL,GAAa,CAAEA,MAAO,eACtB,GAAa,CAAEA,MAAO,eACtB,GAAa,CAAEA,MAAO,aACtB,GAAa,CAAEA,MAAO,eACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,kBAEL,GAAa,CAAEzlB,IAAK,GACpB,GAAa,CAAEA,IAAK,GACpB,GAAa,CAAEA,IAAK,GACpB,GAAc,CAAEA,IAAK,GACrB,GAAc,CAChBA,IAAK,EACLylB,MAAO,gBAEX,IAA6B,qBAAiB,CAC1CwB,OAAQ,kBACRpnB,MAAO,CACHytB,KAAM,CAAC,GAEX,KAAA/F,CAAMC,GACF,MACMqO,EAAe,CACjBC,OAAQ,UACRC,KAAM,UACNC,KAAM,UACNC,UAAW,WAETC,EAAe,CAAC5I,EAAM0N,GAAS,KACjC,IAAI7E,EAAU,SACd,GAAI7I,GAAQA,EAAK,GAAI,CACjB,MAAM8I,EAAO9I,EAAK,GACd8I,GAAQ,EACRD,EAAU,YACLC,GAAQ,EACbD,EAAU,OACLC,GAAQ,IACbD,EAAU,OAClB,CACA,OAAI6E,EACO,CAAE7M,MAAO0H,EAAaM,IAE1B,CACH,sBAAuBN,EAAaM,KAG5C,MAAO,CAAC1O,EAAMC,IACFF,EAAY,OACb,kBAAc,wBAAoB,MAAO,GAAY,EACpD,wBAAoB,KAAM,IAAY,qBAAiBA,EAAQ8F,KAAK,IAAK,IACzE,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,OAAQ,CACxB7H,MAAO,YACPkB,OAAO,oBAAgBuP,EAAa1O,EAAQ8F,MAAM,KACnD,OAAQ,qBAAiB9F,EAAQ8F,KAAK,IAAK,IAC9C,wBAAoB,OAAQ,IAAY,qBAAiB9F,EAAQ8F,KAAK,IAAK,MAE/E,wBAAoB,IAAK,IAAY,qBAAiB9F,EAAQ8F,KAAK,IAAK,GACvE9F,EAAQ8F,KAAY,UACd,kBAAc,wBAAoB,MAAO,GAAY,CACpD5F,EAAO,KAAOA,EAAO,IAAK,wBAAoB,KAAM,KAAM,OAAQ,IACjEF,EAAQ8F,KAAK4D,QAAQC,kBAAoBnwB,OAAOgG,KAAKwgB,EAAQ8F,KAAK4D,QAAQC,kBAAkBnoB,OAAS,IAC/F,kBAAc,wBAAoB,KAAM,GAAY,GAClD,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYwe,EAAQ8F,KAAK4D,QAAQC,iBAAkB,CAACvvB,EAAO5B,MACvG,kBAAc,wBAAoB,KAAM,CAAEA,IAAKA,GAAO,CACjD,UAARA,IACM,kBAAc,wBAAoB,OAAQ,IAAY,qBAAiBA,GAAO,OAAQ,qBAAiB4B,GAAQ,KAChH,wBAAoB,QAAQ,OAEtC,UAEN,wBAAoB,QAAQ,GACjC4lB,EAAQ8F,KAAK4D,QAAQE,kBAAoBpwB,OAAOgG,KAAKwgB,EAAQ8F,KAAK4D,QAAQE,kBAAkBpoB,OAAS,IAC/F,kBAAc,wBAAoB,KAAM,GAAY,GAClD,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYwe,EAAQ8F,KAAK4D,QAAQE,iBAAkB,CAACxvB,EAAO5B,MACvG,kBAAc,wBAAoB,KAAM,CAAEA,IAAKA,GAAO,CACjD,UAARA,IACM,kBAAc,wBAAoB,OAAQ,IAAa,qBAAiBA,GAAO,MAAO,qBAAiB4B,GAAQ,KAChH,wBAAoB,QAAQ,OAEtC,UAEN,wBAAoB,QAAQ,OAEpC,wBAAoB,QAAQ,QAEnC,kBAAc,wBAAoB,MAAO,GAAa,IAAK8lB,EAAO,KAAOA,EAAO,GAAK,EAChF,wBAAoB,IAAK,KAAM,eAAgB,OAGnE,ICzFJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjE,GAAa,CAAEjC,MAAO,iCACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,oBAEL,GAAa,CAAEA,MAAO,mBACtB,GAAa,CAAC,WACd,GAAa,CAAEA,MAAO,gBACtB,GAAa,CAAEA,MAAO,uBACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,aAEL,GAAa,CAAC,WACd,GAAa,CAAEA,MAAO,aACtB,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,iBAEL,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,cAEL,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,WAKX,IAA6B,qBAAiB,CAC1CwB,OAAQ,iBACR,KAAAM,CAAMC,GACF,MAAMiO,GAAe,IAAA5G,KAAI,MACnBoM,GAAmB,IAAApM,KAAI,MACvBqM,GAAe,IAAAva,UAAS,KAC1B,MAAMvZ,EAAQ,EAAA+zB,gBAAA,MACRC,EAAS,CACX,IAAK,GACL,GAAI,GACJ,GAAI,GACJ,GAAI,IAER,IAAKh0B,EACD,OAAOg0B,EAQX,GAPAh0B,EAAM3E,QAAQ6qB,IACV,MAAMxiB,EAAWwiB,EAAK,GAClB8N,EAAOtwB,IACPswB,EAAOtwB,GAAU1I,KAAKkrB,MAIzB2N,EAAiBr5B,MAAO,CACzB,MAAMy5B,EAAyBr6B,OAAOgG,KAAKo0B,GAAQj2B,KAAKqvB,GAAK4G,EAAO5G,GAAGxrB,OAAS,GAC5EqyB,IACAJ,EAAiBr5B,MAAQy5B,EAEjC,CACA,OAAOD,IAELE,GAA0B,IAAA3a,UAAS,IAChCsa,EAAiBr5B,OAAUs5B,EAAat5B,MAAMq5B,EAAiBr5B,OAG7Ds5B,EAAat5B,MAAMq5B,EAAiBr5B,OAFhC,IAOTi0B,EAAe,CACjBC,OAAQ,UACRC,KAAM,UACNC,KAAM,UACNC,UAAW,WAETC,EAAe,CAAC5I,EAAM0N,GAAS,KACjC,IAAI7E,EAAU,SACd,GAAI7I,GAAQA,EAAK,GAAI,CACjB,MAAM8I,EAAO9I,EAAK,GACd8I,GAAQ,EACRD,EAAU,YACLC,GAAQ,EACbD,EAAU,OACLC,GAAQ,IACbD,EAAU,OAClB,CACA,OAAI6E,EACO,CAAE7M,MAAO0H,EAAaM,IAE1B,CACH,sBAAuBN,EAAaM,KAG5C,MAAO,CAAC1O,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACxD,WAAOoE,MACD,kBAAc,wBAAoB,MAAO,GAAY,EACpD,wBAAoB,yBACpB,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,KAAM,KAAM,GAC3B,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAY9qB,OAAOgG,KAAKk0B,EAAat5B,OAASkJ,KAC1F,kBAAc,wBAAoB,KAAM,CAC5C9K,IAAK8K,EACL2a,OAAO,oBAAgB,CAAEoK,OAAQoL,EAAiBr5B,QAAUkJ,IAC5D+c,QAAUE,GAAYkT,EAAiBr5B,MAAQkJ,IAChD,qBAAiBA,GAAY,MAAO,qBAAiBowB,EAAat5B,MAAMkJ,GAAU9B,QAAU,KAAM,GAA6B,MAClI,WAGZ,wBAAoB,wCACpB,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,MAAO,GAAY,CAClCsyB,EAAwB15B,MAAMoH,OAAS,IACjC,kBAAc,wBAAoB,MAAO,GAAY,GACnD,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYsyB,EAAwB15B,MAAQ0rB,KACxF,kBAAc,wBAAoB,MAAO,CAC7CttB,IAAKstB,EAAKzY,GACV4Q,OAAO,oBAAgB,CAAC,YAAa,CAAE8V,SAAU9F,EAAa7zB,OAAOiT,KAAOyY,EAAKzY,MACjF8R,OAAO,oBAAgBuP,EAAa5I,IACpCzF,QAAUE,GArD/B,CAACuF,IAChBmI,EAAa7zB,MAAQ0rB,GAoDoC,CAAYA,IAClC,EACC,wBAAoB,MAAO,IAAY,qBAAiBA,EAAK,IAAK,GACjEA,EAAO,KACD,kBAAc,wBAAoB,MAAO,GAAa,KAAM,qBAAiBA,EAAK,IAAK,KACxF,wBAAoB,QAAQ,IACnC,GAA8B,MACjC,WAEL,kBAAc,wBAAoB,MAAO,GAAa,IAAK5F,EAAO,KAAOA,EAAO,GAAK,EAChF,wBAAoB,IAAK,KAAM,QAAS,WAGxD,iBAAa8T,GAAiB,CAAElO,KAAMmI,EAAa7zB,OAAS,KAAM,EAAe,CAAC,gBAGvF,kBAAc,wBAAoB,MAAO,GAAa,aAGzE,ICpIJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjE,GAAa,CAAE6jB,MAAO,uBACtB,GAAa,CAAEA,MAAO,mBACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,YAEL,GAAa,CAAC,WACd,GAAa,CAAEA,MAAO,YACtB,GAAa,CAAEA,MAAO,YACtB,GAAa,CAAEA,MAAO,gBACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,eAEL,GAAa,CAAEA,MAAO,qBACtB,GAAc,CAAEzlB,IAAK,GACrB,GAAc,CAChBA,IAAK,EACLylB,MAAO,eAKX,IAA6B,qBAAiB,CAC1CwB,OAAQ,oBACR,KAAAM,CAAMC,GACF,MAAMiU,GAAc,IAAA5M,KAAI,MAClB6M,GAAgB,IAAA7M,KAAI,MACpB8M,GAAgB,IAAA9M,KAAI,IACpB+M,GAAe,IAAAjb,UAAS,KAC1B,IAAIC,EAAO,IAAIH,GAAWC,QAAQ9e,OAClC,OAAK+5B,EAAc/5B,MAGZgf,EAAKte,OAAO7B,GAAKA,EAAE,IAAMA,EAAE,GAAG4E,SAASs2B,EAAc/5B,QAFjDgf,IAcf,OANA,IAAA5J,OAAM4kB,EAAc,KACZH,EAAY75B,QAAUg6B,EAAah6B,MAAMyD,SAASo2B,EAAY75B,SAC9D65B,EAAY75B,MAAQ,KACpB85B,EAAc95B,MAAQ,QAGvB,CAAC6lB,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACzD,wBAAoB,eACpB,wBAAoB,MAAO,GAAY,CACnCA,EAAO,KAAOA,EAAO,IAAK,wBAAoB,KAAM,KAAM,SAAU,KACpE,qBAAgB,wBAAoB,QAAS,CACzC5jB,KAAM,OACN,sBAAuB4jB,EAAO,KAAOA,EAAO,GAAMK,GAAY,EAAgBnmB,MAAQmmB,GACtF0C,YAAa,WACbhF,MAAO,gBACR,KAAM,KAAuB,CAC5B,CAAC,aAAakW,EAAc/5B,SAE/Bg6B,EAAah6B,MAAMoH,OAAS,IACtB,kBAAc,wBAAoB,KAAM,GAAY,GAClD,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAY4yB,EAAah6B,MAAQqf,KAC7E,kBAAc,wBAAoB,KAAM,CAC5CjhB,IAAKihB,EAAI,GACTwE,OAAO,oBAAgB,CAAEoK,OAAQ4L,EAAY75B,QAAUqf,IACvD4G,QAAUE,GA7BtC,SAAmB9G,GACfwa,EAAY75B,MAAQqf,EACpBya,EAAc95B,MAAQ6e,GAAWO,SAASC,EAC9C,CA0BiD,CAAWA,IACjC,EACC,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,OAAQ,IAAY,qBAAiBA,EAAI,IAAK,IAClE,wBAAoB,OAAQ,IAAY,qBAAiBA,EAAI,IAAK,MAEvE,GAAuB,MAC1B,WAEL,kBAAc,wBAAoB,MAAO,GAAY,aAEhE,wBAAoB,kBACpB,wBAAoB,MAAO,GAAY,CACnCyG,EAAO,KAAOA,EAAO,IAAK,wBAAoB,KAAM,KAAM,SAAU,IACnE+T,EAAiB,QACX,kBAAc,wBAAoB,MAAO,GAAa,EACrD,iBAAa1I,GAAkB,CAC3B9R,IAAKwa,EAAY75B,MACjB,SAAU85B,EAAc95B,OACzB,KAAM,EAAe,CAAC,MAAO,gBAEjC,kBAAc,wBAAoB,MAAO,GAAa,qBAI7E,ICpFJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjE,GAAa,CAAE6jB,MAAO,uBACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,YAEL,GAAa,CAAC,WACd,GAAa,CAAEA,MAAO,cACtB,GAAa,CAAEA,MAAO,aACtB,GAAa,CAAEA,MAAO,YACtB,GAAa,CAAEA,MAAO,YACtB,GAAa,CAAEA,MAAO,mBACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,eAEL,GAAc,CAAEA,MAAO,kBACvB,GAAc,CAAEA,MAAO,kBACvB,GAAc,CAAEA,MAAO,kBACvB,GAAc,CAAEA,MAAO,oCACvB,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,YAEL,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,eAIX,IAA6B,qBAAiB,CAC1CwB,OAAQ,WACR,KAAAM,CAAMC,GACF,MAAMzI,GAAO,IAAA4B,UAAS,IAAM,IAAI,GAAM9J,UAAU/N,KAAK,CAACjI,EAAGkI,IAAMA,EAAE,GAAKlI,EAAE,KAClEg7B,GAAc,IAAAhN,KAAI,MASxB,MAAO,CAACpH,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,CACxD3I,EAAKnd,MAAMoH,OAAS,IACd,kBAAc,wBAAoB,KAAM,GAAY,GAClD,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAY+V,EAAKnd,MAAQ0B,KACrE,kBAAc,wBAAoB,KAAM,CAC5CtD,IAAKsD,EAAI,GACTmiB,MAAO,iBACR,CACCiC,EAAO,KAAOA,EAAO,IAAK,wBAAoB,MAAO,CAAEjC,MAAO,mBAAqB,MAAO,KAC1F,wBAAoB,MAAO,CACvBA,MAAO,mBACPoC,QAAUE,IAAW,OApB1B+T,EAoByCx4B,EAAI,QAnB5Du4B,EAAYj6B,QAAUk6B,EACtBD,EAAYj6B,MAAQ,KAGpBi6B,EAAYj6B,MAAQk6B,GAL5B,IAAuBA,IAqBI,EACC,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,OAAQ,IAAY,qBAAiBx4B,EAAI,IAAK,IAClE,wBAAoB,OAAQ,IAAY,qBAAiBA,EAAI,IAAK,MAEtE,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,OAAQ,KAAM,CAC9BokB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,IAAK,CAAEjC,MAAO,8BAAgC,MAAO,KACnG,qBAAiB,KAAM,qBAAiBniB,EAAI,IAAK,MAErD,wBAAoB,OAAQ,KAAM,CAC9BokB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,IAAK,CAAEjC,MAAO,qBAAuB,MAAO,KAC1F,qBAAiB,KAAM,qBAAiBniB,EAAI,IAAK,QAGzD,wBAAoB,IAAK,IAAY,qBAAiBA,EAAI,IAAK,GAC9Du4B,EAAYj6B,QAAU0B,EAAI,KACpB,kBAAc,wBAAoB,MAAO,GAAY,EACpD,wBAAoB,MAAO,GAAa,CACpCokB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,SAAU,KACxE,wBAAoB,IAAK,MAAM,qBAAiBpkB,EAAI,MAAO,MAE/D,wBAAoB,MAAO,GAAa,CACpCokB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,SAAU,KACxE,wBAAoB,IAAK,MAAM,qBAAiBpkB,EAAI,MAAO,MAE/D,wBAAoB,MAAO,GAAa,CACpCokB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,UAAW,KACzE,wBAAoB,IAAK,MAAM,qBAAiBpkB,EAAI,OAAQ,MAEhE,wBAAoB,MAAO,GAAa,CACpCokB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,UAAW,KACzE,wBAAoB,MAAO,MAAM,qBAAiBpkB,EAAI,OAAQ,KAEjEA,EAAI,IAAMA,EAAI,GAAG0F,OAAS,IACpB,kBAAc,wBAAoB,MAAO,GAAa,GACpD,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAY1F,EAAI,GAAK6rB,KACjE,kBAAc,wBAAoB,OAAQ,CAC9CnvB,IAAKmvB,EACL1J,MAAO,QACR,qBAAiB0J,GAAM,KAC1B,UAEN,wBAAoB,QAAQ,OAEpC,wBAAoB,QAAQ,IACnC,EAAe,QAEtB,WAEL,kBAAc,wBAAoB,MAAO,GAAa,IAAKzH,EAAO,KAAOA,EAAO,GAAK,EAChF,wBAAoB,IAAK,KAAM,WAAY,UAInE,ICxGJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCKvE,SAAS,GAAW3N,GAClB,MAAMhD,EAAkC,CAAC,EACnC5G,EAAQ4J,EAAMnO,OAAOS,MAAM,MACjC,IAAI2N,EAAa,GACjB,IAAK,MAAM1O,KAAQ6E,EAAO,CACxB,MAAM1E,EAAiBH,EAAKI,QAAQ,KACpC,IAAwB,IAApBD,EAAuB,CACzB,MAAMzL,EAAMsL,EAAKK,UAAU,EAAGF,GAAgBG,OACxChK,EAAQ0J,EAAKK,UAAUF,EAAiB,GAAGG,OACjDmL,EAAK/W,GAAO4B,EACZoY,EAAaha,CACf,MAAWga,GAAc1O,EAAKM,SAC5BmL,EAAKiD,IAAe,KAAO1O,EAE/B,CACA,IAAK,MAAMtL,KAAO+W,EAChBA,EAAK/W,GAAO+W,EAAK/W,GAAK4L,OAExB,OAAOmL,CACT,CAiDO,MAAMglB,GAAiB,IA/C9B,MACSC,SAAU,IAAA7qB,UAAmB,IAEpC,gBAAM8qB,SACE95B,KAAK+5B,aACb,CAEA,iBAAMA,GACJ,IACE,MAAMC,QAAsB7sB,EAAgBzB,iBAAiB,QAC7D,IAAKsuB,IAAkBA,EAAcvwB,OAEnC,YADAzJ,KAAK65B,QAAQjqB,OAAO,EAAG5P,KAAK65B,QAAQhzB,QAItC,MAAMozB,EAAeD,EAAc9vB,MAAM,eACnCgwB,EAA0B,GAEhC,IAAK,MAAMC,KAAgBF,EAAc,CACvC,IAAKE,EAAa1wB,OAAQ,SAC1B,MAAM2wB,EAAY,GAAWD,GACvBE,EAAWphB,SAASmhB,EAAU,OAAQ,IAEvCpvB,MAAMqvB,IACTH,EAAcj6B,KAAK,CACjBwB,GAAI44B,EACJhrB,MAAO,KAAKgrB,MACZC,WAAYH,KACTC,GAGT,CAGAp6B,KAAK65B,QAAQjqB,OAAO,EAAG5P,KAAK65B,QAAQhzB,UAAWqzB,EAAcvzB,KAAK,CAACjI,EAAGkI,IAAMlI,EAAE+C,GAAKmF,EAAEnF,KACrFP,QAAQC,IAAI,2BAA2BnB,KAAK65B,QAAQhzB,kBACtD,CAAE,MAAO4E,GACPvK,QAAQuK,MAAM,0CAA2CA,GACzDzL,KAAK65B,QAAQjqB,OAAO,EAAG5P,KAAK65B,QAAQhzB,OACtC,CACF,CAEA,aAAA0zB,CAAc94B,GACZ,OAAOzB,KAAK65B,QAAQ72B,KAAK1D,GAAKA,EAAEmC,KAAOA,EACzC,GC1EI,GAAa,CAAE6hB,MAAO,iBACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,gBAEL,GAAa,CACfzlB,IAAK,EACLylB,MAAO,eAEL,GAAa,CAAEzlB,IAAK,GACpB,GAAa,CAAC,WACd,GAAa,CAAEylB,MAAO,gBACtB,GAAa,CAAEA,MAAO,kBACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,iBAEL,GAAa,CAAEA,MAAO,kBACtB,GAAc,CAAEA,MAAO,cACvB,GAAc,CAAEA,MAAO,gBAG7B,IAA6B,qBAAiB,CAC1CwB,OAAQ,eACR,KAAAM,CAAMC,GACF,MAAMwU,GAAU,IAAArb,UAAS,IAAMob,GAAeC,SACxCW,GAAiB,IAAA9N,KAAI,MAO3B,OAHA,IAAA+N,WAAU,KACNb,GAAeG,gBAEZ,CAACzU,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,CACvDiV,EAAe/6B,QAgBV,kBAAc,wBAAoB,MAAO,GAAY,EACpD,wBAAoB,SAAU,CAC1BimB,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAY4U,EAAe/6B,MAAQ,MACvE6jB,MAAO,eACR,WACH,wBAAoB,MAAO,GAAY,GAClC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYkX,EAAe/6B,MAAO,CAACA,EAAO5B,MACtF,kBAAc,wBAAoB,MAAO,CAC7CA,IAAKA,EACLylB,MAAO,eACR,EACC,wBAAoB,SAAU,IAAa,qBAAiBzlB,GAAO,IAAK,IACxE,wBAAoB,MAAO,IAAa,qBAAiB4B,GAAQ,OAErE,aA7BT,kBAAc,wBAAoB,MAAO,GAAY,CAC1B,IAAzBo6B,EAAQp6B,MAAMoH,SACR,kBAAc,wBAAoB,MAAO,GAAY,gBACrD,kBAAc,wBAAoB,KAAM,GAAY,GAClD,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYgzB,EAAQp6B,MAAQyF,KACxE,kBAAc,wBAAoB,KAAM,CAC5CrH,IAAKqH,EAAOzD,GACZikB,QAAUE,GAhBrB,CAAC1gB,IAClBs1B,EAAe/6B,MAAQyF,GAe0B,CAAcA,IACpC,EACC,wBAAoB,OAAQ,IAAY,qBAAiBA,EAAOmK,OAAQ,IACxE,wBAAoB,OAAQ,IAAY,qBAAiBnK,EAAO,SAASsE,UAAU,EAAG,KAAO,MAAO,IACrG,EAAe,MAClB,cAsBhC,IChEJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjE,GAAa,CAAE8Z,MAAO,oBACtB,GAAa,CAAEzlB,IAAK,GACpB,GAAa,CAAC,WAGpB,IAA6B,qBAAiB,CAC1CinB,OAAQ,kBACR,KAAAM,CAAMC,GACF,MAAMqV,GAAU,IAAAlc,UAAS,IAAM,GAAMmc,4BAOrC,MAAO,CAACrV,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,CAC/B,IAAzBmV,EAAQj7B,MAAMoH,SACR,kBAAc,wBAAoB,MAAO,GAAY,kBACrD,gBAAW,IAAO,wBAAoB,WAAW,CAAEhJ,IAAK,IAAK,gBAAY68B,EAAQj7B,MAAO,CAACm7B,EAAQlrB,MACxF,kBAAc,wBAAoB,MAAO,CAC7C7R,IAAK6R,EACL4T,MAAO,cACPoC,QAAUE,GAdT,CAACgV,IAElB,GAAQC,qBAAqBD,EAAO,KAYC,CAAcA,IACpC,EACC,wBAAoB,KAAM,MAAM,qBAAiBA,EAAO,IAAK,IAC7D,wBAAoB,IAAK,KAAM,CAC3BrV,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,OAAQ,KACtE,qBAAiB,KAAM,qBAAiBqV,EAAO,IAAK,MAExD,wBAAoB,IAAK,KAAM,CAC3BrV,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,OAAQ,KACtE,qBAAiB,KAAM,qBAAiBqV,EAAO,IAAK,MAEzD,EAAe,MAClB,QAGpB,IChCJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCKjE,IAAQ,IAAA5rB,UAA4B,CACxC6L,WAAW,EACXxL,MAAO,GACPC,QAAS,GACTwrB,UAAW,KACXC,SAAU,KACVC,YAAY,IAGDC,GAAsB,CACjC,SAAIlsB,GACF,OAAO,EACT,EAEA,IAAAK,CAAKC,EAAeC,EAAiBwrB,EAAuBE,GAAa,GACvE,OAAO,IAAIE,QAAiBC,IAC1B,GAAM9rB,MAAQA,EACd,GAAMC,QAAUA,EAChB,GAAMwrB,UAAY,KAChBA,IACAK,GAAQ,IAEV,GAAMJ,SAAW,KACf/6B,KAAKyP,OACL0rB,GAAQ,IAEV,GAAMH,WAAaA,EACnB,GAAMngB,WAAY,GAEtB,EAEA,IAAApL,GACE,GAAMoL,WAAY,EAClB,GAAMxL,MAAQ,GACd,GAAMC,QAAU,GAChB,GAAMwrB,UAAY,KAClB,GAAMC,SAAW,KACjB,GAAMC,YAAa,CACrB,EAEA,OAAA3Z,GACM,GAAMyZ,WACR,GAAMA,WAGV,EACA,MAAAM,GACM,GAAML,UACR,GAAMA,UAEV,GC3DI,GAAa,CAAEzX,MAAO,eACtB,GAAa,CAAEA,MAAO,eACtB,GAAa,CAAEA,MAAO,aACtB,GAAa,CAAEA,MAAO,eACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,gBAEL,GAAa,CAAEA,MAAO,aACtB,GAAa,CAAEA,MAAO,oBACtB,GAAa,CAAEA,MAAO,eACtB,GAAa,CAAEA,MAAO,QCR5B,IDS6B,qBAAiB,CAC1CwB,OAAQ,uBACRpnB,MAAO,CACH29B,OAAQ,CACJ15B,KAAM9C,OACNkvB,UAAU,GAEduN,WAAY,CACR35B,KAAMwX,QACNrV,SAAS,IAGjBqhB,MAAO,CAAC,UACR,KAAAC,CAAMC,GAAWvJ,KAAMyM,IACnB,MAAM7qB,EAAQ2nB,EACRF,EAAQoD,EACRgT,EAAa,KACfpW,EAAM,SAAUznB,EAAM29B,SAE1B,MAAO,CAAC/V,EAAMC,MACF,kBAAc,wBAAoB,MAAO,CAC7CjC,OAAO,oBAAgB,CAAC,yBAA0B,CAAE,cAAe+B,EAAQiW,cAC3E5V,QAAS6V,GACV,EACC,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,OAAQ,IAAY,qBAAiBlW,EAAQgW,OAAO,MAAO,MAEnF,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,IAAK,IAAY,qBAAiBhW,EAAQgW,OAAO,IAAK,GACzEhW,EAAQgW,OAAS,KACX,kBAAc,wBAAoB,MAAO,GAAY,EACpD,wBAAoB,SAAU,IAAY,qBAAiBhW,EAAQgW,OAAO,GAAG,IAAK,IAClF,wBAAoB,IAAK,IAAY,qBAAiBhW,EAAQgW,OAAO,GAAG,IAAK,OAE/E,wBAAoB,QAAQ,MAEtC,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,OAAQ,GAAY,YAAa,qBAAiBhW,EAAQgW,OAAO,IAAK,MAE/F,GAEX,IErDE,GAAa,CAAE/X,MAAO,mBACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,gBAEL,GAAa,CACfzlB,IAAK,EACLylB,MAAO,cAEL,GAAa,CACfzlB,IAAK,EACLylB,MAAO,kBAEL,GAAa,CAAC,YCVpB,IDkB6B,qBAAiB,CAC1CwB,OAAQ,iBACR,KAAAM,CAAMC,GACF,MAAMmW,GAAiB,IAAA9O,KAAI,MACrB+O,GAAU,IAAAjd,UAAS,KACrB,MAAMkd,GAAa,IAAA18B,KAAI,GAAMiC,WAAY,iBAAkB,CAAC,GAC5D,MAA0B,iBAAfy6B,GAA0C,OAAfA,EAC3B78B,OAAOkE,OAAO24B,GAAYv7B,OAAQw7B,GAAMA,GAAKA,EAAE,MAAQA,EAAE,KAAOA,EAAE,GAAGz4B,SAAS,OAElF,KAEL04B,EAAgBxwB,UAClB,IAAKowB,EAAe/7B,MAChB,OACJ,MAAM47B,EAASG,EAAe/7B,MAExB4B,GAAa,IAAArC,KAAI,GAAMiC,WAAY,KAAM,CAAC,GAC1C46B,EAAgBh9B,OAAOkE,OAAO1B,GAAY2B,KAAMzB,GAASA,GAAQA,EAAKnC,eAAe,SAC3F,IAAKy8B,EAGD,OAFA,SAAa,uBACb36B,QAAQuK,MAAM,yDAGlB,MAAMqwB,GAAc,IAAA98B,KAAI68B,EAAe,OAAQ,GAC/C,GAAIC,EAAcT,EAAO,GAErB,kBADMJ,GAAoB7rB,KAAK,SAAU,WAAWisB,EAAO,iBAAiBS,KAAgB,QAAW,GAI3G,SADwBb,GAAoB7rB,KAAK,UAAW,UAAUisB,EAAO,cAAcA,EAAO,GAAG,uBAAwB,QAC9G,CAGXn6B,QAAQC,IAAI,oBAAqBk6B,GACjC,MAAM76B,EAAU,SAASwM,KAAKC,UAAUouB,EAAO,OAC/C17B,EAAeY,WAAWC,GAC1By6B,GAAoBxrB,OACpB,WAAe,YAAY4rB,EAAO,GAAG,eACzC,GAEJ,MAAO,CAAC/V,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,CACxDkW,EAAQh8B,MAAMoH,OAAS,IACjB,kBAAc,wBAAoB,MAAO,GAAY,GACnD,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAY40B,EAAQh8B,MAAO,CAAC47B,EAAQ3rB,MAChF,kBAAc,iBAAaqsB,GAAsB,CACrDl+B,IAAK6R,EACL2rB,OAAQA,EACR,cAAeG,EAAe/7B,QAAU47B,EACxCW,SAAUzW,EAAO,KAAOA,EAAO,GAAMK,GAAY4V,EAAe/7B,MAAQmmB,IACzE,KAAM,EAAe,CAAC,SAAU,kBACnC,WAEL,kBAAc,wBAAoB,MAAO,GAAY,IAAKL,EAAO,KAAOA,EAAO,GAAK,EAC/E,wBAAoB,IAAK,KAAM,WAAY,IAC3C,wBAAoB,IAAK,KAAM,2BAA4B,QAEtEkW,EAAQh8B,MAAMoH,OAAS,IACjB,kBAAc,wBAAoB,MAAO,GAAY,EACpD,wBAAoB,SAAU,CAC1Byc,MAAO,iBACPoC,QAASkW,EACTnW,UAAW+V,EAAe/7B,OAC3B,OAAQ,EAAe,QAE5B,wBAAoB,QAAQ,KAG9C,IE3EG,MAAMw8B,GACHC,MACAC,OACAC,SACAC,SACAC,UACAC,MACAC,OAA4B,KAC5BC,YAA4B,GAC5BC,gBAA0B,GAElC,WAAA9c,CAAY0c,GACVp7B,QAAQC,IAAI,wCACZnB,KAAKs8B,UAAYA,EACjBt8B,KAAKk8B,MAAQ,IAAI,EACjBl8B,KAAKm8B,OAAS,IAAI,EAAwB,GAAIn8B,KAAKs8B,UAAUK,YAAc38B,KAAKs8B,UAAUM,aAAc,GAAK,KAC7G58B,KAAKo8B,SAAW,IAAI,EAAoB,CAAES,WAAW,EAAMC,OAAO,IAClE98B,KAAKu8B,MAAQ,IAAI,EAEjBv8B,KAAK+8B,OAEL/8B,KAAKq8B,SAAW,IAAI,EAAcr8B,KAAKm8B,OAAQn8B,KAAKo8B,SAASY,YAC7Dh9B,KAAKq8B,SAASY,eAAgB,EAC9Bj9B,KAAKq8B,SAASa,cAAgB,IAC9Bl9B,KAAKq8B,SAASc,YAAa,EAC3Bn9B,KAAKq8B,SAASe,gBAAkB,GAChCp9B,KAAKq8B,SAASgB,YAAc,EAC5Br9B,KAAKq8B,SAASiB,YAAc,IAC5Bt9B,KAAKq8B,SAASkB,WAAY,EAC1Bv9B,KAAKq8B,SAASmB,SAAW,GAEzBx9B,KAAKy9B,SACP,CAEQ,IAAAV,GACN77B,QAAQC,IAAI,kCAEZnB,KAAKo8B,SAASsB,QAAQ19B,KAAKs8B,UAAUK,YAAa38B,KAAKs8B,UAAUM,cACjE58B,KAAKo8B,SAASuB,cAAchc,OAAOic,kBACnC59B,KAAKs8B,UAAU5Z,YAAY1iB,KAAKo8B,SAASY,YAGzCh9B,KAAKm8B,OAAOzvB,SAASmF,EAAI,GACzB7R,KAAKk8B,MAAM/1B,IAAInG,KAAKm8B,QAGpBn8B,KAAKk8B,MAAM/1B,IAAInG,KAAKu8B,OAGpB5a,OAAO2V,iBAAiB,SAAUt3B,KAAK69B,eAAeC,KAAK99B,OAC3DA,KAAK+9B,cACP,CAEQ,YAAAA,GACN,MAAMC,EAAiB,IAAI,EAAqB,CAC9CC,aAAc,gLAOdC,eAAgB,2lDAoDhBC,SAAU,CACRC,OAAQ,CAAE3+B,MAAO,IAEnB4+B,KAAM,IAGFC,EAAiB,IAAI,EAAqB,IAAK,GAAI,IACzDt+B,KAAKw8B,OAAS,IAAI,EAAW8B,EAAgBN,GAC7Ch+B,KAAKk8B,MAAM/1B,IAAInG,KAAKw8B,OACtB,CAEQ,sBAAA+B,CAAuB30B,GAC7B,OAAuB,IAAI,EAAvBA,GAAS,EAA0B,MACnCA,GAAS,GAA2B,MACpCA,GAAS,GAA2B,SACpCA,GAAS,GAA2B,SACjB,QACzB,CAEO,WAAA40B,CAAYC,EAAqBC,GACtCx9B,QAAQC,IAAI,wCAAwCs9B,EAAO53B,kBAE3D,MAAM83B,EAAkB,IAAI74B,IAAI9F,KAAKy8B,YAAYl2B,IAAIq4B,GAAKA,EAAEC,SAAS5Q,MAAMxsB,KACrEq9B,EAAc,IAAIh5B,IAAI24B,EAAOl4B,IAAItD,GAAKA,EAAExB,KAG9CzB,KAAKy8B,YAAcz8B,KAAKy8B,YAAYt8B,OAAO4+B,KACpCD,EAAY58B,IAAI68B,EAAKF,SAAS5Q,MAAMxsB,MAEvCzB,KAAKu8B,MAAMyC,OAAOD,IACX,IAMXN,EAAOn+B,QAAQ2tB,IACR0Q,EAAgBz8B,IAAI+rB,EAAMxsB,KAC7BzB,KAAKi/B,iBAAiBhR,EAAOyQ,KAKjC1+B,KAAKy8B,YAAYn8B,QAAQy+B,IACvB,MAAM9Q,EAAQ8Q,EAAKF,SAAS5Q,MACtBiR,EAAeR,EAAcx8B,IAAI+rB,EAAMxsB,IACvC09B,EAAclR,EAAMkR,aAAe,EACnCC,EAAYp/B,KAAKu+B,uBAAuBY,GACxCE,EAAWH,EAAeE,EAAY,IAAI,EAAY,SAEtDE,EAAOP,EAAKQ,SAAS,GACrBC,EAAOT,EAAKQ,SAAS,GAEvBD,GAAQE,IACVF,EAAKG,SAASzT,MAAM0T,KAAKL,EAAU,IACnCG,EAAKC,SAASzT,MAAM0T,KAAKL,EAAU,MAGzC,CAEQ,gBAAAJ,CAAiBhR,EAAkByQ,GACzC,MAAMiB,EAAe,IAAI,EAAqB,GAAK,GAAI,IACjDC,EAAe,IAAI,EAAqB,GAAK,GAAI,IAEjDC,EAAM3sB,KAAK4sB,KAAU,EAAI5sB,KAAK6sB,SAAb,GACjBC,EAAQ9sB,KAAK+sB,KAAKjgC,KAAKy8B,YAAY51B,OAASqM,KAAKmiB,IAAMwK,EAGvDtW,EAFS,GAEIrW,KAAKgtB,IAAIF,GAAS9sB,KAAKkiB,IAAIyK,GACxCpW,EAHS,GAGIvW,KAAKkiB,IAAI4K,GAAS9sB,KAAKkiB,IAAIyK,GACxChuB,EAJS,GAIIqB,KAAKgtB,IAAIL,GAEtBX,EAAeR,EAAcx8B,IAAI+rB,EAAMxsB,IACvC09B,EAAclR,EAAMkR,aAAe,EACnCgB,EAAWlS,EAAMkS,UAAY,EAE7Bf,EAAYp/B,KAAKu+B,uBAAuBY,GACxCiB,EAAYlB,EAAeE,EAAY,IAAI,EAAY,SAGvDiB,EAAe,IAAI,EAAwB,CAAErU,MAAOoU,IACpDd,EAAO,IAAI,EAAWK,EAAcU,GAGpCC,EAAe,IAAI,EAAwB,CAC/CtU,MAAOoU,EACPG,aAAa,EACbC,QAAS,GACTC,SAAU,IAENjB,EAAO,IAAI,EAAWI,EAAcU,GAG1Cd,EAAKkB,MAAMz+B,IADO,aAGlB,MAAM0+B,EAAwB,IAAI,EAClCA,EAAUx6B,IAAIm5B,GACdqB,EAAUx6B,IAAIq5B,GAEdmB,EAAUj0B,SAASzK,IAAIsnB,EAAGE,EAAG5X,GAG7B8uB,EAAU9B,SAAW,CAAE5Q,SACvBqR,EAAKT,SAAW,CAAE5Q,SAClBuR,EAAKX,SAAW,CAAE5Q,SAGlB0S,EAAUC,WAAoC,KAAvB1tB,KAAK2tB,MAAMV,GAClCQ,EAAUG,YAAc5tB,KAAK+sB,KAAK1W,EAAIA,EAAI1X,EAAIA,GAC9C8uB,EAAUI,WAAa7tB,KAAK8tB,MAAMnvB,EAAG0X,GAErCvpB,KAAKu8B,MAAMp2B,IAAIw6B,GACf3gC,KAAKy8B,YAAYx8B,KAAK0gC,EACxB,CAEQ,OAAAlD,GACNwD,sBAAsBjhC,KAAKy9B,QAAQK,KAAK99B,OAGpCA,KAAKw8B,QAAUx8B,KAAKw8B,OAAOiD,oBAAoB,IACjDz/B,KAAKw8B,OAAOiD,SAAStB,SAASC,OAAO3+B,OAAS,KAIhDO,KAAKy8B,YAAYn8B,QAAQy+B,IACnBA,EAAK6B,YAAc7B,EAAK+B,kBAAmC3iC,IAApB4gC,EAAKgC,aAC9ChC,EAAKgC,YAAchC,EAAK6B,WAAa5gC,KAAK08B,gBAC1CqC,EAAKryB,SAAS6c,EAAIwV,EAAK+B,YAAc5tB,KAAKgtB,IAAInB,EAAKgC,YACnDhC,EAAKryB,SAASmF,EAAIktB,EAAK+B,YAAc5tB,KAAKkiB,IAAI2J,EAAKgC,eAIvD/gC,KAAKq8B,SAAS6E,SACdlhC,KAAKo8B,SAAS+E,OAAOnhC,KAAKk8B,MAAOl8B,KAAKm8B,OACxC,CAEQ,cAAA0B,GACN79B,KAAKm8B,OAAOiF,OAASphC,KAAKs8B,UAAUK,YAAc38B,KAAKs8B,UAAUM,aACjE58B,KAAKm8B,OAAOkF,yBACZrhC,KAAKo8B,SAASsB,QAAQ19B,KAAKs8B,UAAUK,YAAa38B,KAAKs8B,UAAUM,aACnE,CAEO,OAAA0E,GACL3f,OAAO0V,oBAAoB,SAAUr3B,KAAK69B,eAAeC,KAAK99B,OAC9DA,KAAKo8B,SAASmF,UACVvhC,KAAKs8B,WAAat8B,KAAKo8B,SAASY,YAClCh9B,KAAKs8B,UAAU1Z,YAAY5iB,KAAKo8B,SAASY,WAE7C,CAGO,QAAAwE,CAAS9lB,GACd,MAAM+lB,EAAY,IAAI,EAChBC,EAAQ,IAAI,EACZC,EAAO3hC,KAAKo8B,SAASY,WAAW4E,wBAGtCF,EAAMnY,GAAM7N,EAAM8N,QAAUmY,EAAKvV,MAAQuV,EAAK9V,MAAS,EAAI,EAC3D6V,EAAMjY,IAAO/N,EAAMgO,QAAUiY,EAAK9M,KAAO8M,EAAKE,OAAU,EAAI,EAE5DJ,EAAUK,cAAcJ,EAAO1hC,KAAKm8B,QACpC,MAAM4F,EAAaN,EAAUO,iBAAiBhiC,KAAKu8B,MAAMgD,UAEzD,OAAIwC,EAAWl7B,OAAS,EACfk7B,EAAW,GAAG1vB,OAAOwsB,SAAS5Q,MAEhC,IACT,CAEO,kBAAAgU,CAAmBC,GACxBliC,KAAK08B,gBAAkBxpB,KAAKC,IAAI,EAAG+uB,EACrC,CAEO,kBAAAC,GACL,OAAOniC,KAAK08B,eACd,EC9SF,MAAM,GAAa,CAAEpZ,MAAO,6BACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,iBAEL,GAAa,CAAEA,MAAO,0BACtB,GAAa,CAAEA,MAAO,eACtB,GAAa,CAAEA,MAAO,eACtB,GAAa,CAAEA,MAAO,cACtB,GAAa,CAAC,WACd,GAAa,CAAEA,MAAO,eACtB,GAAa,CAAEA,MAAO,eACtB,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,eAEL,GAAc,CAAEA,MAAO,qBACvB,GAAc,CAAEA,MAAO,gBACvB,GAAc,CAAC,YACf,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,uBAEL,GAAc,CAAEA,MAAO,gBACvB,GAAc,CAAEA,MAAO,0BACvB,GAAc,CAAEA,MAAO,uBACvB,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,oBASX,IAA6B,qBAAiB,CAC1CwB,OAAQ,iBACR,KAAAM,CAAMC,GACF,MAAM+c,GAAmB,IAAA1V,KAAI,MAC7B,IAAI2V,EAAiB,KACrB,MAAMC,GAAY,IAAA5V,MAAI,GAChB6V,GAAgB,IAAA7V,KAAI,MACpB8V,GAAqB,IAAA9V,KAAI,IAAI5mB,KAC7BqvB,GAAW,IAAAzI,KAAI,GACrB,IAAI+V,EAAmB,KACvB,MAAMC,GAAgB,IAAAhW,KAAI,MAEpBiW,EAAc,CAAC,EAAG,GAAK,GAAK,EAAK,GACjCC,GAAa,IAAAlW,KAAI,GACjBmW,GAAe,IAAArkB,UAAS,KAC1B,MAAMigB,GAAS,IAAAz/B,KAAI,GAAMiC,WAAY,KAAM,CAAC,GAC5C,IAAI6hC,EAAY,EAChB,OAAOjkC,OAAOwF,QAAQo6B,GACjBt+B,OAAO,EAAE4E,KAAyB,UAAZA,IAAwBA,EAAQ7B,SAAS,aAC/DqD,IAAI,EAAExB,EAAS+I,MAChB,MAAMogB,GAAmB,IAAAlvB,KAAI8O,EAAW,UAAW,CAAC,GAC9Ci1B,EAASlkC,OAAOwF,QAAQ6pB,GAAkB3nB,IAAI,EAAEkB,EAASu7B,MAC3D,MAAMC,GAAW,IAAAjkC,KAAIgkC,EAAW,UAAW,CAAC,GAC5C,MAAO,CACHvhC,GAAIgG,EACJ/F,KAAMshC,EAAU,MAAQ,OACxB7D,aAAa,IAAAngC,KAAIgkC,EAAW,UAAW,GACvC7C,UAAU,IAAAnhC,KAAIgkC,EAAW,UAAW,GACpCrX,YAAaqX,EAAU,MAAQ,cAC/BC,SAAUpkC,OAAOkE,OAAOkgC,GACnB18B,IAAK28B,GAAQA,EAAI,IACjB/iC,OAAOgZ,YAGpB,MAAO,CACH1X,KAAMqhC,EACNphC,KAAMoM,EAAU,IAAM,OACtBq1B,IAAK,IAAKr1B,EAAWs1B,WAAYr+B,GACjCs+B,uBAAuB,IAAArkC,KAAI8O,EAAW,cAAe,MACrDw1B,eAAe,IAAAtkC,KAAI8O,EAAW,cAAe,MAC7Cc,gBAAgB,IAAA5P,KAAI8O,EAAW,gBAAiB,IAChDi1B,OAAQA,OAIdQ,GAAW,IAAA/kB,UAAS,IAAM,EAAAglB,kBAAA,OAC1BC,GAAwB,IAAAjlB,UAAS,KAE3B,EAAAklB,oBAAA,OAAuD,QAA1BH,EAAS9jC,MAAMkkC,QAElDC,EAAqB,KAGvB,GAAI,EAAAF,oBAAA,MAEA,YADAlB,EAAmB/iC,MAAQ,IAAIqG,KAInC,MAAM24B,EAASoE,EAAapjC,MAC5B,GAAsB,IAAlBg/B,EAAO53B,OACP,OACJ,MAAMg9B,EAAMpF,EAAOl4B,IAAItD,GAAKA,EAAExB,IAC9B,GAAIg9B,EAAO53B,QAAU,EACjB27B,EAAmB/iC,MAAQ,IAAIqG,IAAI+9B,OAElC,CACD,MAAMC,EAAW,IAAID,GAAKl9B,KAAK,IAAM,GAAMuM,KAAK6sB,UAChDyC,EAAmB/iC,MAAQ,IAAIqG,IAAIg+B,EAAS75B,MAAM,EAAG,GACzD,GA4BE85B,EAAqBroB,IACvB,IAAK2mB,EACD,OACJ,MAAM2B,EAAc3B,EAAeb,SAAS9lB,GAExC6mB,EAAc9iC,MADdukC,GAIsB,MAGxBt8B,GAAc,IAAA8W,UAAS,IACpB+jB,EAAc9iC,OAAUijC,EAAcjjC,MAEpC8iC,EAAc9iC,MAAMsjC,OAAO//B,KAAK8H,GAAKA,EAAErJ,KAAOihC,EAAcjjC,OADxD,OAGf,IAAAoV,OAAM0tB,EAAe0B,IAEbvB,EAAcjjC,MADdwkC,EACsBA,EAASr1B,eAGT,QAG9B,IAAAiG,OAAMutB,EAAkB8B,IAChBA,IAAiB7B,IACjBnhC,QAAQC,IAAI,oFACZkhC,EAAiB,IAAIpG,GAAeiI,GAEhCrB,EAAapjC,MAAMoH,OAAS,IAC5B3F,QAAQC,IAAI,sFACZkhC,EAAe7D,YAAYqE,EAAapjC,MAAO+iC,EAAmB/iC,YAI9E,IAAAg7B,WAAUrvB,UACNlK,QAAQC,IAAI,6CAEN,GAAQgjC,2BACdP,IACIvB,GACAA,EAAe7D,YAAYqE,EAAapjC,MAAO+iC,EAAmB/iC,OAEtE6iC,EAAU7iC,OAAQ,KAEtB,IAAA2kC,aAAY,KACR/B,GAAgBf,aAEpB,IAAAzsB,OAAMguB,EAAcwB,IAChBnjC,QAAQC,IAAI,qDAAqDkjC,EAAUx9B,kBACvEw9B,EAAUx9B,OAAS,IAKnB+8B,IAEIvB,IACAnhC,QAAQC,IAAI,2EACZkhC,EAAe7D,YAAY6F,EAAW7B,EAAmB/iC,UAGlE,CAAEuV,MAAM,KAEX,IAAAH,OAAM,EAAA6uB,oBAAqB,CAACY,EAAWC,KAE/BA,IAAeD,IACfpjC,QAAQC,IAAI,sEACZyiC,OAGR,MAMMY,EAAeC,IACjB,MAAMC,EAAW9B,EAAWnjC,MAAQglC,EAChCC,GAAY,GAAKA,EAAW/B,EAAY97B,SACxC+7B,EAAWnjC,MAAQilC,EACfrC,GACAA,EAAeJ,mBAAmBU,EAAYC,EAAWnjC,UASrE,OALA,IAAAoV,OAAM+tB,EAAY8B,IACVrC,GACAA,EAAeJ,mBAAmBU,EAAY+B,KAEnD,CAAE/X,WAAW,IACT,CAACrH,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,CACxD+c,EAAe,QACT,kBAAc,wBAAoB,MAAO,GAAY,EACpD,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,MAAO,CACvBhf,MAAO,eACPkB,OAAO,oBAAgB,CAAEqH,MAAOsJ,EAAS11B,MAAQ,OAClD,KAAM,MAEb,wBAAoB,OAAQ,KAAM,aAAc,qBAAiB01B,EAAS11B,OAAS,IAAK,OAE1F,wBAAoB,QAAQ,GAChC6iC,EAAU7iC,OAQN,wBAAoB,QAAQ,KAP3B,kBAAc,wBAAoB,MAAO,CACxC5B,IAAK,EACL8mC,QAAS,mBACTjY,IAAK0V,EACL9e,MAAO,kBACPoC,QAASqe,GACV,KAAM,OAEb,wBAAoB,MAAO,CACvBzgB,OAAO,oBAAgB,CAAC,qBAAsB,CAAEshB,UAAWrC,EAAc9iC,UAC1E,CACE8iC,EAAc9iC,OAASiI,EAAYjI,QAC7B,kBAAc,wBAAoB,WAAW,CAAE5B,IAAK,GAAK,EACxD,wBAAoB,KAAM,MAAM,qBAAiB0kC,EAAc9iC,MAAMiC,MAAO,IAC5E,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,IAAK,KAAM,CAC3B6jB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,SAAU,KACxE,qBAAiB,KAAM,qBAAiBgd,EAAc9iC,MAAM4jC,uBAAwB,QAG5F,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,IAAK,KAAM,CAC3B9d,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,SAAU,KACxE,qBAAiB,KAAM,qBAAiBgd,EAAc9iC,MAAM6jC,eAAgB,QAGpF,wBAAoB,MAAO,GAAY,GAClC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYf,EAAc9iC,MAAMsjC,OAASj0B,KACrF,kBAAc,wBAAoB,SAAU,CAChDjR,IAAKiR,EAAMrN,GACX6hB,OAAO,oBAAgB,CAAEoK,OAAQgV,EAAcjjC,QAAUqP,EAAMrN,KAC/DikB,QAAUE,GAAY8c,EAAcjjC,MAAQqP,EAAMrN,KACnD,qBAAiBqN,EAAMpN,MAAO,GAA6B,MAC9D,SAER,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,IAAK,KAAM,CAC3B6jB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,OAAQ,KACtE,qBAAiB,KAAM,qBAAiB7d,EAAYjI,MAAM0/B,aAAc,QAGhF,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,IAAK,KAAM,CAC3B5Z,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,SAAU,KACxE,qBAAiB,KAAM,qBAAiB7d,EAAYjI,MAAM0gC,UAAY,IAAK,OAGlFz4B,EAAYjI,MAAMwjC,UAAYv7B,EAAYjI,MAAMwjC,SAASp8B,OAAS,IAC5D,kBAAc,wBAAoB,MAAO,GAAa,CACrD0e,EAAO,KAAOA,EAAO,IAAK,wBAAoB,IAAK,KAAM,EACrD,wBAAoB,SAAU,KAAM,WACpC,KACJ,wBAAoB,KAAM,KAAM,GAC3B,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAY7d,EAAYjI,MAAMwjC,SAAU,CAACC,EAAKxzB,MAC1F,kBAAc,wBAAoB,KAAM,CAAE7R,IAAK6R,IAAS,qBAAiBwzB,GAAM,KACvF,YAGV,wBAAoB,QAAQ,IAClC,wBAAoB,MAAO,GAAa,EACpC,wBAAoB,IAAK,MAAM,qBAAiBx7B,EAAYjI,MAAMksB,aAAc,MAEpF,wBAAoB,MAAO,GAAa,CACnC8X,EAA2B,QACrB,kBAAc,wBAAoB,SAAU,CAC3C5lC,IAAK,EACL6nB,QAASH,EAAO,KAAOA,EAAO,GAAMK,IAAW,OApGjDqI,EAoGuEsU,EAAc9iC,MAAM0jC,SAnGhH,EAAAO,oBAAA,QACD,GAAQmB,wBAAwB5W,EAAMmV,YACtCb,EAAc9iC,MAAQ,OAHD,IAACwuB,IAqGExI,UAAWge,EAAsBhkC,OAClC,SAAU,EAAe,OACzB,kBAAc,wBAAoB,IAAK,GAAa,iBAEhE,MACD,wBAAoB,QAAQ,IACnC,IACH,wBAAoB,MAAO,GAAa,EACpC,wBAAoB,SAAU,CAC1BimB,QAASH,EAAO,KAAOA,EAAO,GAAMK,IA9MhD0c,EAAU7iC,OAAQ,EAClB8iC,EAAc9iC,MAAQ,KACtB01B,EAAS11B,MAAQ,EACbgjC,GACA7kB,cAAc6kB,GAElBA,EAAmB9gB,OAAOjE,YAAY,KAC9ByX,EAAS11B,MAAQ,GACjB01B,EAAS11B,QAGLgjC,GACA7kB,cAAc6kB,IAEvB,KAEH,GAAQqC,mCAER,GAAQC,4BA6LIzhB,MAAO,cACR,WAEP,wBAAoB,MAAO,GAAa,EACpC,wBAAoB,SAAU,CAC1BoC,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAY4e,EAAY,IAC5Dn1B,MAAO,KACPiU,MAAO,eACR,MACH,wBAAoB,MAAO,GAAa,CACpCiC,EAAO,KAAOA,EAAO,IAAK,wBAAoB,MAAO,CAAEjC,MAAO,mBAAqB,MAAO,KAC1F,wBAAoB,MAAO,CACvBA,MAAO,iBACPkB,OAAO,oBAAgB,CAAEqd,OAA8B,GAAnBe,EAAWnjC,MAAd,OAClC,KAAM,MAEb,wBAAoB,SAAU,CAC1BimB,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAY4e,GAAa,IAC7Dn1B,MAAO,KACPiU,MAAO,eACR,QAEN,WAAO,EAAAogB,uBACD,kBAAc,wBAAoB,MAAO,GAAa,IAAKne,EAAO,MAAQA,EAAO,IAAM,EAClF,wBAAoB,IAAK,KAAM,gBAAiB,IAChD,wBAAoB,MAAO,CAAEjC,MAAO,WAAa,MAAO,SAE9D,wBAAoB,QAAQ,KAG9C,ICnVJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjE,GAAa,CAAEA,MAAO,uBACtB,GAAa,CAAEA,MAAO,QACtB,GAAa,CAAC,YACd,GAAa,CAAC,YACd,GAAa,CAAC,YACd,GAAa,CAAEA,MAAO,eACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,sBASX,IAA6B,qBAAiB,CAC1CwB,OAAQ,qBACR,KAAAM,CAAMC,GACF,MAAMkI,GAAY,IAAAb,KAAI,kBAChBsY,GAAsB,IAAAxmB,UAAS,IAAM,EAAAymB,gBAAA,OACrC1B,GAAW,IAAA/kB,UAAS,IAAM,EAAAglB,kBAAA,OAC1B0B,GAAa,IAAA1mB,UAAS,KACxB,OAAQwmB,EAAoBvlC,OACxB,IAAK,kBACD,MAAO,OACX,IAAK,mBACD,MAAO,OACX,IAAK,aACD,MAAO,MACX,IAAK,aACD,MAAO,OACX,IAAK,WACD,MAAO,QAAQ8jC,EAAS9jC,MAAM0lC,gBAClC,QACI,MAAO,UAcnB,OAXA,IAAAtwB,OAAMmwB,EAAqBI,IACL,oBAAdA,EACA7X,EAAU9tB,MAAQ,iBAEC,qBAAd2lC,EACL7X,EAAU9tB,MAAQ,kBAEC,eAAd2lC,IACL7X,EAAU9tB,MAAQ,mBAEvB,CAAEktB,WAAW,IACT,CAACrH,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACzD,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,SAAU,CAC1BjC,OAAO,oBAAgB,CAAEoK,OAA4B,mBAApBH,EAAU9tB,QAC3CimB,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAY2H,EAAU9tB,MAAQ,kBAClEgmB,SAAwC,oBAA9Buf,EAAoBvlC,OAA6D,aAA9BulC,EAAoBvlC,OAClF,YAAa,qBAAiBylC,EAAWzlC,OAAS,KAAM,GAA6B,KACxF,wBAAoB,SAAU,CAC1B6jB,OAAO,oBAAgB,CAAEoK,OAA4B,oBAApBH,EAAU9tB,QAC3CimB,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAY2H,EAAU9tB,MAAQ,mBAClEgmB,SAAwC,qBAA9Buf,EAAoBvlC,OAC/B,SAAU,GAAuB,KACpC,wBAAoB,SAAU,CAC1B6jB,OAAO,oBAAgB,CAAEoK,OAA4B,mBAApBH,EAAU9tB,QAC3CimB,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAY2H,EAAU9tB,MAAQ,kBAClEgmB,SAAwC,eAA9Buf,EAAoBvlC,OAC/B,SAAU,GAAuB,KACpC,wBAAoB,SAAU,CAC1B6jB,OAAO,oBAAgB,CAAEoK,OAA4B,QAApBH,EAAU9tB,QAC3CimB,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAY2H,EAAU9tB,MAAQ,QACnE,OAAQ,IACX,wBAAoB,SAAU,CAC1B6jB,OAAO,oBAAgB,CAAEoK,OAA4B,YAApBH,EAAU9tB,QAC3CimB,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAY2H,EAAU9tB,MAAQ,YACnE,OAAQ,MAEf,wBAAoB,MAAO,GAAY,CACd,mBAApB8tB,EAAU9tB,QACJ,kBAAc,iBAAa4lC,GAAgB,CAAExnC,IAAK,MACnD,wBAAoB,QAAQ,GACb,oBAApB0vB,EAAU9tB,QACJ,kBAAc,iBAAa6lC,GAAiB,CAAEznC,IAAK,MACpD,wBAAoB,QAAQ,GACb,mBAApB0vB,EAAU9tB,QACJ,kBAAc,iBAAa8lC,GAAgB,CAAE1nC,IAAK,MACnD,wBAAoB,QAAQ,GACb,QAApB0vB,EAAU9tB,QACJ,kBAAc,iBAAa+lC,GAAU,CAAE3nC,IAAK,MAC7C,wBAAoB,QAAQ,GACb,YAApB0vB,EAAU9tB,QACJ,kBAAc,iBAAagmC,GAAc,CAAE5nC,IAAK,MACjD,wBAAoB,QAAQ,GACH,eAA9BmnC,EAAoBvlC,QACd,kBAAc,wBAAoB,MAAO,GAAY,YACtD,wBAAoB,QAAQ,OAIlD,IC7FJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjE,GAAa,CAAE6jB,MAAO,uBACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,kBAEL,GAAa,CAAEA,MAAO,cACtB,GAAa,CAAEA,MAAO,gBACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,mBAIX,IAA6B,qBAAiB,CAC1CwB,OAAQ,oBACRpnB,MAAO,CACH28B,SAAU,CAAC,GAEf,KAAAjV,CAAMC,GACF,MAAM3nB,EAAQ2nB,GACR,SAAEgV,IAAa,IAAAqL,QAAOhoC,GACtBwH,GAAS,IAAAwnB,UAAIvuB,GAInB,OAHA,IAAAs8B,WAAU,KACNv1B,EAAOzF,MAAQm6B,GAAeW,cAAcF,EAAS56B,SAElD,CAAC6lB,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,CACxDrgB,EAAY,QACN,kBAAc,wBAAoB,MAAO,GAAY,GACnD,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYA,EAAOzF,MAAO,CAACA,EAAO5B,MAC9E,kBAAc,wBAAoB,MAAO,CAC7CA,IAAKA,EACLylB,MAAO,eACR,EACC,wBAAoB,SAAU,IAAY,qBAAiBzlB,GAAO,IAAK,IACvE,wBAAoB,OAAQ,IAAY,qBAAiB4B,GAAQ,OAErE,WAEL,kBAAc,wBAAoB,MAAO,GAAY,oBAGxE,ICpCJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjE,GAAa,CAAE6jB,MAAO,gBACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,eAEL,GAAa,CACfzlB,IAAK,EACLylB,MAAO,eAEL,GAAa,CAAEA,MAAO,gBACtB,GAAa,CAAEA,MAAO,eACtB,GAAa,CAAEA,MAAO,qBACtB,GAAa,CAAEA,MAAO,kBACtB,GAAa,CAAEA,MAAO,wBACtB,GAAa,CAAC,QAAS,OACvB,GAAc,CAAEA,MAAO,iBACvB,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,qBAEL,GAAc,CAAC,WACf,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,0BAEL,GAAc,CAAEA,MAAO,cACvB,GAAc,CAAEA,MAAO,yCACvB,GAAc,CAAEA,MAAO,gBACvB,GAAc,CAAEA,MAAO,gBAG7B,IAA6B,qBAAiB,CAC1CwB,OAAQ,cACR,KAAAM,CAAMC,GACF,MAAMqG,GAAS,IAAAlN,UAAS,IAAM,EAAAmnB,aAAA,OACxBC,GAAiB,IAAAlZ,KAAI,CAAC,GAItBmZ,EAAcC,KACPF,EAAenmC,MAAMqmC,GAElC,MAAO,CAACxgB,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,CACzDA,EAAO,KAAOA,EAAO,IAAK,wBAAoB,KAAM,KAAM,MAAO,IACxC,IAAxBmG,EAAOjsB,MAAMoH,SACP,kBAAc,wBAAoB,MAAO,GAAY,IAAK0e,EAAO,KAAOA,EAAO,GAAK,EAC/E,wBAAoB,IAAK,KAAM,aAAc,UAElD,kBAAc,wBAAoB,MAAO,GAAY,GACnD,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYmG,EAAOjsB,MAAQqsB,KACvE,kBAAc,wBAAoB,MAAO,CAC7CjuB,IAAKiuB,EAAMrqB,GACX6hB,MAAO,cACR,EACC,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,KAAM,MAAM,qBAAiBwI,EAAMpqB,MAAO,IAC9D,wBAAoB,MAAO,GAAY,OAAQ,qBAAiBoqB,EAAMliB,OAAQ,MAElF,wBAAoB,IAAK,IAAY,qBAAiBkiB,EAAMH,aAAc,IAC1E,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,WAAY,CAC5BlsB,MAAOqsB,EAAMia,IACb5yB,IAA8B,QAAzB2Y,EAAMN,eAA2BM,EAAMia,IAAMja,EAAMN,gBACzD,KAAM,EAAe,KACxB,wBAAoB,OAAQ,IAAa,qBAAiBM,EAAMia,KAAO,OAAQ,qBAAiBja,EAAMN,gBAAiB,OAG9HM,EAAMka,kBAAoBla,EAAMka,iBAAiBn/B,OAAS,IACpD,kBAAc,wBAAoB,MAAO,GAAa,EACrD,wBAAoB,SAAU,CAC1B6e,QAAUE,IAAW,OApCnCkgB,EAoCiDha,EAAMrqB,QAnCzEmkC,EAAenmC,MAAMqmC,IAAYF,EAAenmC,MAAMqmC,IADrC,IAACA,GAqCcxiB,MAAO,2BACR,CACCiC,EAAO,KAAOA,EAAO,IAAK,qBAAiB,UAAW,KACtD,wBAAoB,OAAQ,CACxBjC,OAAO,oBAAgB,CAAC,QAAS,CAAE2iB,SAAUJ,EAAW/Z,EAAMrqB,QAC/D,KAAM,IACV,EAAe,IACjBokC,EAAW/Z,EAAMrqB,MACX,kBAAc,wBAAoB,KAAM,GAAa,GACnD,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYqqB,EAAMka,iBAAmBE,KACjF,kBAAc,wBAAoB,KAAM,CAC5CroC,IAAKqoC,EAAYxzB,GACjB4Q,MAAO,yBACR,EACC,wBAAoB,MAAO,GAAa,EACpC,wBAAoB,SAAU,MAAM,qBAAiB4iB,EAAY,IAAK,IACtE,qBAAiB,MAAO,qBAAiBA,EAAY,IAAM,KAAM,MAErE,wBAAoB,MAAO,IAAa,qBAAiBA,EAAY,IAAK,IAC1E,wBAAoB,MAAO,GAAa,CACpC3gB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,SAAU,KACxE,qBAAiB,KAAM,qBAAiB2gB,EAAY,MAAO,MAE/D,wBAAoB,MAAO,GAAa,CACpC3gB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,OAAQ,KACtE,qBAAiB,KAAM,qBAAiB2gB,EAAY,QAAS,SAGrE,UAEN,wBAAoB,QAAQ,OAEpC,wBAAoB,QAAQ,OAEtC,WAIxB,ICzGJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjE,GAAa,CAAE5iB,MAAO,wCACtB,GAAa,CAAEA,MAAO,iBACtB,GAAa,CAAEA,MAAO,WACtB,GAAa,CAAEA,MAAO,gBACtB,GAAa,CAAEA,MAAO,WACtB,GAAa,CAAEA,MAAO,gBACtB,GAAa,CAAEA,MAAO,gBACtB,GAAa,CAAEA,MAAO,gBACtB,GAAa,CAAEA,MAAO,WACtB,GAAc,CAAEA,MAAO,QACvB,GAAc,CAAEA,MAAO,kBACvB,GAAc,CAAC,SAOrB,IAA6B,qBAAiB,CAC1CwB,OAAQ,cACR,KAAAM,CAAMC,GACF,MAAM8gB,GAAsB,IAAAzZ,MAAI,GAC1BtQ,GAAS,IAAAsQ,KAAI,CACfrQ,mBAAoB,EACpBC,qBAAsB,GACtBC,oBAAqB,MAEnBgR,GAAY,IAAAb,KAAI,WAChB0Z,GAAgB,IAAA1Z,KAAI,CACtB2Z,QAAS,SACTC,MAAO,SACPC,KAAM,WAEJC,GAAsB,IAAAhoB,UAAS,IAC1B4nB,EAAc3mC,MAAM8tB,EAAU9tB,QAEzC2L,eAAeq7B,EAAmBn7B,GAAe,GAC7C,IACI,MAAO+6B,EAASC,EAAOC,SAAcrL,QAAQwL,IAAI,CAC7Cv5B,EAAgBzB,iBAAiB,WAAYJ,GAC7C6B,EAAgBzB,iBAAiB,WAAYJ,GAC7C6B,EAAgBzB,iBAAiB,WAAYJ,KAEjD86B,EAAc3mC,MAAM4mC,QAAUA,GAAW,OACzCD,EAAc3mC,MAAM6mC,MAAQA,GAAS,OACrCF,EAAc3mC,MAAM8mC,KAAOA,GAAQ,MACvC,CACA,MAAO96B,GACHvK,QAAQuK,MAAM,gDAAiDA,GAC/D,SAAa,WACjB,CACJ,CACA,SAASk7B,IACL3qB,GAAckB,UAAUd,EAAO3c,OAC/B,WAAe,YACnB,CACA2L,eAAew7B,IACX,QAAY,mBACZ1lC,QAAQC,IAAI,8CAA+C6L,KAAKC,UAAU,GAAMyH,SAAU,KAAM,UAC1FsH,GAAcQ,aAAa,GAAM9H,gBACjC+xB,GAAmB,GACzB,WAAe,WACnB,CACA,MAAMI,EAAqB,KACvB3lC,QAAQC,IAAI,+DACZslC,GAAmB,IAUvB,OARA,IAAAhM,WAAU,KACNre,EAAO3c,MAAQuc,GAAciB,YAC7BwpB,IACAlrB,GAASE,GAAG,gBAAiBorB,MAEjC,IAAAzC,aAAY,KACR7oB,GAASK,IAAI,gBAAiBirB,KAE3B,CAACvhB,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACzD,wBAAoB,MAAO,GAAY,CACnCA,EAAO,MAAQA,EAAO,KAAM,wBAAoB,KAAM,CAAEjC,MAAO,eAAiB,UAAW,KAC3F,wBAAoB,yBACpB,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,MAAO,GAAY,CACnCiC,EAAO,KAAOA,EAAO,IAAK,wBAAoB,QAAS,CAAEuhB,IAAK,sBAAwB,YAAa,KACnG,qBAAgB,wBAAoB,QAAS,CACzCnlC,KAAM,WACNF,GAAI,qBACJ,sBAAuB8jB,EAAO,KAAOA,EAAO,GAAMK,GAAY,EAAsBnmB,MAAQmmB,IAC7F,KAAM,KAAuB,CAC5B,CAAC,iBAAiBugB,EAAoB1mC,WAG9C8lB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,IAAK,CAAEjC,MAAO,eAAiB,8BAA+B,OAEhH,wBAAoB,oBACpB,wBAAoB,MAAO,GAAY,CACnCiC,EAAO,MAAQA,EAAO,KAAM,wBAAoB,KAAM,KAAM,QAAS,KACrE,wBAAoB,MAAO,GAAY,CACnCA,EAAO,KAAOA,EAAO,IAAK,wBAAoB,QAAS,CAAEuhB,IAAK,wBAA0B,UAAW,KACnG,qBAAgB,wBAAoB,QAAS,CACzCnlC,KAAM,SACNF,GAAI,uBACJ,sBAAuB8jB,EAAO,KAAOA,EAAO,GAAMK,GAAaxJ,EAAO3c,MAAwB,mBAAImmB,IACnG,KAAM,KAAuB,CAC5B,CACI,aACAxJ,EAAO3c,MAAM4c,wBACR,EACL,CAAE9J,QAAQ,SAItB,wBAAoB,MAAO,GAAY,CACnCgT,EAAO,MAAQA,EAAO,KAAM,wBAAoB,QAAS,CAAEuhB,IAAK,oBAAsB,UAAW,KACjG,qBAAgB,wBAAoB,QAAS,CACzCnlC,KAAM,SACNF,GAAI,mBACJ,sBAAuB8jB,EAAO,KAAOA,EAAO,GAAMK,GAAaxJ,EAAO3c,MAA0B,qBAAImmB,IACrG,KAAM,KAAuB,CAC5B,CACI,aACAxJ,EAAO3c,MAAM6c,0BACR,EACL,CAAE/J,QAAQ,SAItB,wBAAoB,MAAO,GAAY,CACnCgT,EAAO,MAAQA,EAAO,KAAM,wBAAoB,QAAS,CAAEuhB,IAAK,mBAAqB,UAAW,KAChG,qBAAgB,wBAAoB,QAAS,CACzCnlC,KAAM,SACNF,GAAI,kBACJ,sBAAuB8jB,EAAO,KAAOA,EAAO,GAAMK,GAAaxJ,EAAO3c,MAAyB,oBAAImmB,IACpG,KAAM,KAAuB,CAC5B,CACI,aACAxJ,EAAO3c,MAAM8c,yBACR,EACL,CAAEhK,QAAQ,SAItB,wBAAoB,SAAU,CAAEmT,QAASihB,GAAgB,SACzD,wBAAoB,SAAU,CAAEjhB,QAASkhB,GAAe,eAE5D,wBAAoB,oBACpB,wBAAoB,MAAO,GAAY,CACnCrhB,EAAO,MAAQA,EAAO,KAAM,wBAAoB,KAAM,KAAM,QAAS,KACrE,wBAAoB,MAAO,GAAa,EACpC,wBAAoB,SAAU,CAC1BjC,OAAO,oBAAgB,CAAEoK,OAA4B,YAApBH,EAAU9tB,QAC3CimB,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAY2H,EAAU9tB,MAAQ,YACnE,OAAQ,IACX,wBAAoB,SAAU,CAC1B6jB,OAAO,oBAAgB,CAAEoK,OAA4B,UAApBH,EAAU9tB,QAC3CimB,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAY2H,EAAU9tB,MAAQ,UACnE,OAAQ,IACX,wBAAoB,SAAU,CAC1B6jB,OAAO,oBAAgB,CAAEoK,OAA4B,SAApBH,EAAU9tB,QAC3CimB,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAY2H,EAAU9tB,MAAQ,SACnE,OAAQ,MAEf,wBAAoB,MAAO,GAAa,EACpC,wBAAoB,WAAY,CAC5B4b,SAAU,GACV5b,MAAO+mC,EAAoB/mC,OAC5B,KAAM,EAAe,YAMhD,ICrKJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCLjE,GAAa,CAAE6jB,MAAO,mBACtB,GAAa,CAAEA,MAAO,gBACtB,GAAa,CAAEA,MAAO,kBACtB,GAAa,CAAEA,MAAO,wBACtB,GAAa,CAAEA,MAAO,cACtB,GAAa,CAAEA,MAAO,aACtB,GAAa,CAAEA,MAAO,aACtB,GAAa,CAAEA,MAAO,kBACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,kBAEL,GAAc,CAAEA,MAAO,YACvB,GAAc,CAAEA,MAAO,aACvB,GAAc,CAAEA,MAAO,gBACvB,GAAc,CAAC,WACf,GAAc,CAAC,UAAW,YAC1B,GAAc,CAAC,UAAW,YAC1B,GAAc,CAAEA,MAAO,cACvB,GAAc,CAAEA,MAAO,aACvB,GAAc,CAAEA,MAAO,aACvB,GAAc,CAAEA,MAAO,kBACvB,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,kBAEL,GAAc,CAAEA,MAAO,YACvB,GAAc,CAAEA,MAAO,aACvB,GAAc,CAAEA,MAAO,gBACvByjB,GAAc,CAAC,UAAW,YAC1BC,GAAc,CAAE1jB,MAAO,oBC5B7B,UAAe,IAAA2jB,iBAAgB,CAC3BvlC,KAAM,gBACN,KAAA0jB,GACI,MAAM/F,GAAc,IAAAqN,KAAI,IAClBpN,GAAY,IAAAoN,KAAI,IAChBjN,GAAoB,IAAAiN,MAAI,GACxBwa,GAAY,IAAAxa,KAAI,MAChBya,EAAY/7B,gBACRiP,GAAgB4F,mBACtBZ,EAAY5f,MAAQ,IAAI4a,GAAgBgF,aACxCC,EAAU7f,MAAQ,IAAI4a,GAAgBiF,aAE1C,IAAAmb,WAAU,KACN0M,IACA1nB,EAAkBhgB,MAAQ4a,GAAgBoF,oBAmD9C,MAAO,CACHJ,cACAC,YACAG,oBACAynB,YACAE,gBAtDqBlnB,GACd,IAAIvN,KAAKuN,GAAWgK,eAAe,QAAS,CAAEM,QAAQ,IAsD7DhK,SApDapV,MAAOqV,UACdpG,GAAgBmG,SAASC,SACzB0mB,KAmDN/lB,SAjDahW,MAAOgV,UACd/F,GAAgB+G,SAAShB,IAiD/BkB,WA/CelW,MAAOgV,UAChB/F,GAAgBiH,WAAWlB,SAC3B+mB,KA8CNlkB,eA5CmB,KACnB5I,GAAgB4I,eAAexD,EAAkBhgB,QA4CjDqjB,WA1Ce,KACfokB,EAAUznC,OAAOkjB,SA0CjB0kB,iBAxCsB3rB,IACtB,MAAM/d,EAAS+d,EAAM/d,OACrB,GAAIA,EAAO2pC,OAAS3pC,EAAO2pC,MAAM,GAAI,CACjC,MAAMC,EAAO5pC,EAAO2pC,MAAM,GACpBE,EAAS,IAAIC,WACnBD,EAAOE,OAASt8B,MAAON,IACnB,IACI,MAAMrF,EAAUqF,EAAEnN,QAAQ66B,aACpBne,GAAgByI,WAAWrd,SAC3B0hC,GACV,CACA,MAAO17B,GACH,SAAa,qBACbvK,QAAQuK,MAAMA,EAClB,GAEJ+7B,EAAOG,WAAWJ,GAClB5pC,EAAO8B,MAAQ,EACnB,GAuBAqiB,WArBe1W,UAEf,MAAMw8B,EAAevoB,EAAY5f,MAAMuD,KAAKod,GAAQA,EAAKxL,MACpDgzB,EAILvtB,GAAgByH,WAAW8lB,GAHvB,WAAe,cAmB3B,ICzEJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,SFyBpD,SAAgBtiB,EAAMC,EAAQsiB,EAAQC,EAAQC,EAAOC,GACxD,OAAQ,kBAAc,wBAAoB,MAAO,GAAY,EACzD,wBAAoB,MAAO,GAAY,CACnCziB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,KAAM,CAAEjC,MAAO,eAAiB,QAAS,KACvF,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,SAAU,CAC1BoC,QAASH,EAAO,KAAOA,EAAO,GAE1B,IAAIxJ,IAAUuJ,EAAKxC,YAAcwC,EAAKxC,cAAc/G,IACxDuH,MAAO,cACR,OACH,wBAAoB,SAAU,CAC1BoC,QAASH,EAAO,KAAOA,EAAO,GAE1B,IAAIxJ,IAAUuJ,EAAKxD,YAAcwD,EAAKxD,cAAc/F,IACxDuH,MAAO,cACR,WAGX,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,MAAO,GAAY,CACnCiC,EAAO,KAAOA,EAAO,IAAK,wBAAoB,KAAM,CAAEjC,MAAO,eAAiB,QAAS,MACtF,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYgC,EAAKjG,YAAce,KAC3E,kBAAc,wBAAoB,MAAO,CAC7CviB,IAAKuiB,EAAK3e,GACV6hB,MAAO,aACR,EACC,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,OAAQ,IAAY,qBAAiBlD,EAAK1e,MAAO,IACrE,wBAAoB,OAAQ,IAAY,qBAAiB0e,EAAKF,UAAYoF,EAAK8hB,gBAAgBhnB,EAAKF,WAAa,OAAQ,GACxHE,EAAKC,cAAgBD,EAAKE,gBACpB,kBAAc,wBAAoB,MAAO,GAAY,EACpD,wBAAoB,OAAQ,IAAa,qBAAiBF,EAAKC,cAAe,IAC9E,wBAAoB,OAAQ,IAAa,qBAAiBD,EAAKE,eAAgB,OAEjF,wBAAoB,QAAQ,MAEtC,wBAAoB,MAAO,GAAa,EACpC,wBAAoB,SAAU,CAC1BoF,QAAUE,GAAYN,EAAK9E,SAASJ,EAAK3e,IACzC6hB,MAAO,uBACR,KAAM,EAAe,KACxB,wBAAoB,SAAU,CAC1BoC,QAAUE,GAAYN,EAAKlE,SAAShB,GACpCqF,UAAWrF,EAAKxL,KAChB0O,MAAO,uBACR,KAAM,EAAe,KACxB,wBAAoB,SAAU,CAC1BoC,QAAUE,GAAYN,EAAKhE,WAAWlB,GACtCqF,UAAWrF,EAAKxL,KAChB0O,MAAO,yBACR,KAAM,EAAe,UAGhC,SAER,wBAAoB,MAAO,GAAa,CACpCiC,EAAO,KAAOA,EAAO,IAAK,wBAAoB,KAAM,CAAEjC,MAAO,eAAiB,QAAS,MACtF,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYgC,EAAKhG,UAAYc,KACzE,kBAAc,wBAAoB,MAAO,CAC7CviB,IAAKuiB,EAAK3e,GACV6hB,MAAO,uBACR,EACC,wBAAoB,MAAO,GAAa,EACpC,wBAAoB,OAAQ,IAAa,qBAAiBlD,EAAK1e,MAAO,IACtE,wBAAoB,OAAQ,IAAa,qBAAiB0e,EAAKF,UAAYoF,EAAK8hB,gBAAgBhnB,EAAKF,WAAa,OAAQ,GACzHE,EAAKC,cAAgBD,EAAKE,gBACpB,kBAAc,wBAAoB,MAAO,GAAa,EACrD,wBAAoB,OAAQ,IAAa,qBAAiBF,EAAKC,cAAe,IAC9E,wBAAoB,OAAQ,IAAa,qBAAiBD,EAAKE,eAAgB,OAEjF,wBAAoB,QAAQ,MAEtC,wBAAoB,MAAO,GAAa,EACpC,wBAAoB,SAAU,CAC1BoF,QAAUE,GAAYN,EAAKlE,SAAShB,GACpCqF,UAAWrF,EAAKxL,KAChB0O,MAAO,uBACR,KAAM,EAAeyjB,UAGhC,SAER,wBAAoB,MAAOC,GAAa,EACpC,wBAAoB,QAAS,KAAM,EAC/B,qBAAgB,wBAAoB,QAAS,CACzCrlC,KAAM,WACN,sBAAuB4jB,EAAO,KAAOA,EAAO,GAAMK,GAAaN,EAAsB,kBAAIM,GACzFqiB,SAAU1iB,EAAO,KAAOA,EAAO,GAE3B,IAAIxJ,IAAUuJ,EAAKrC,gBAAkBqC,EAAKrC,kBAAkBlH,KACjE,KAAM,KAAuC,CAC5C,CAAC,iBAAiBuJ,EAAK7F,qBAE3B8F,EAAO,KAAOA,EAAO,IAAK,qBAAiB,YAAa,WAIpE,wBAAoB,QAAS,CACzB5jB,KAAM,OACN+qB,IAAK,YACLub,SAAU1iB,EAAO,KAAOA,EAAO,GAE3B,IAAIxJ,IAAUuJ,EAAK+hB,kBAAoB/hB,EAAK+hB,oBAAoBtrB,IACpEyI,MAAO,CAAE,QAAW,QACpB0jB,OAAQ,SACT,KAAM,MAEjB,GErI4E,CAAC,YAAY,qBCLnF,GAAa,CAAE5kB,MAAO,gBACtB,GAAa,CAAEA,MAAO,cACtB,GAAa,CAAEA,MAAO,iBAI5B,IAA6B,qBAAiB,CAC1CwB,OAAQ,cACR,KAAAM,CAAMC,GACF,MAAMkI,GAAY,IAAAb,KAAI,YACtB,MAAO,CAACpH,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACzD,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,SAAU,CAC1BjC,OAAO,oBAAgB,CAAEoK,OAA4B,aAApBH,EAAU9tB,QAC3CimB,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAY2H,EAAU9tB,MAAQ,aACnE,OAAQ,IACX,wBAAoB,SAAU,CAC1B6jB,OAAO,oBAAgB,CAAEoK,OAA4B,WAApBH,EAAU9tB,QAC3CimB,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAY2H,EAAU9tB,MAAQ,WACnE,OAAQ,MAEf,wBAAoB,MAAO,GAAY,EACnC,qBAAgB,iBAAa0oC,GAAe,KAAM,KAAM,KAAuB,CAC3E,CAAC,QAA4B,aAApB5a,EAAU9tB,UAEvB,qBAAgB,iBAAa2oC,GAAa,KAAM,KAAM,KAAuB,CACzE,CAAC,QAA4B,WAApB7a,EAAU9tB,aAKvC,IC1BJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjE,GAAa,CACf5B,IAAK,EACLylB,MAAO,qBAEL,GAAa,CAAEA,MAAO,aACtB,GAAa,CAAEA,MAAO,aACtB,GAAa,CAAEA,MAAO,wBACtB,GAAa,CAAEA,MAAO,wBACtB,GAAa,CAAEA,MAAO,wBAC5B,IAA6B,qBAAiB,CAC1CwB,OAAQ,kBACRpnB,MAAO,CACH2qC,MAAO,CACH1mC,KAAM9C,OACNkvB,UAAU,IAGlB3I,MAAMC,GACK,CAACC,EAAMC,IACFF,EAAa,QACd,kBAAc,wBAAoB,MAAO,GAAY,EACpD,wBAAoB,MAAO,GAAY,CACnCE,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,MAAO,KACrE,wBAAoB,OAAQ,MAAM,qBAAiBF,EAAQgjB,MAAM,IAAK,MAE1E,wBAAoB,MAAO,GAAY,CACnC9iB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,MAAO,KACrE,wBAAoB,OAAQ,MAAM,qBAAiBF,EAAQgjB,MAAM,IAAK,MAE1E,wBAAoB,MAAO,GAAY,CACnC9iB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,MAAO,KACrE,wBAAoB,OAAQ,MAAM,qBAAiBF,EAAQgjB,MAAM,IAAK,MAE1E,wBAAoB,MAAO,GAAY,CACnC9iB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,QAAS,KACvE,wBAAoB,OAAQ,MAAM,qBAAiBF,EAAQgjB,MAAM,MAAM,IAAiC,MAA3BhjB,EAAQgjB,MAAM,MAAM,GAAa,GAAGhjB,EAAQgjB,MAAM,KAAK,QAAQhjB,EAAQgjB,MAAM,KAAK,KAAO,KAAM,MAEhL,wBAAoB,MAAO,GAAY,CACnC9iB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,QAAS,KACvE,wBAAoB,KAAM,KAAM,GAC3B,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYF,EAAQgjB,MAAM,KAAM,CAACC,EAAKzqC,MAClF,kBAAc,wBAAoB,KAAM,CAAEA,IAAKA,IAAO,qBAAiByqC,EAAI,IAAK,KACxF,cAId,wBAAoB,QAAQ,KCxC9C,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjE,GAAa,CACfzqC,IAAK,EACLylB,MAAO,4CAEL,GAAa,CAAEA,MAAO,oBACtB,GAAa,CAAEA,MAAO,iBACtB,GAAa,CAAEA,MAAO,cACtB,GAAa,CAAEA,MAAO,aACtB,GAAa,CAAEA,MAAO,cACtB,GAAa,CAAEA,MAAO,aACtB,GAAa,CAAEA,MAAO,cACtB,GAAa,CAAEA,MAAO,iCACtB,GAAc,CAAEA,MAAO,4BACvB,GAAc,CAAC,aACf,GAAc,CAAEA,MAAO,iBACvB,GAAc,CAAEA,MAAO,gBACvB,GAAc,CAAEA,MAAO,iBACvB,GAAc,CAAEA,MAAO,kBACvB,GAAc,CAAEA,MAAO,cACvB,GAAc,CAAEA,MAAO,aACvB,GAAc,CAAEA,MAAO,cACvB,GAAc,CAAEA,MAAO,aACvB,GAAc,CAAEA,MAAO,cACvB,GAAc,CAAEA,MAAO,aACvB,GAAc,CAAEA,MAAO,cACvB,GAAc,CAAEA,MAAO,aACvB,GAAc,CAAEA,MAAO,cACvB,GAAc,CAAEA,MAAO,iBACvBilB,GAAc,CAAEjlB,MAAO,mBACvBklB,GAAc,CAAEllB,MAAO,cACvBmlB,GAAc,CAAEnlB,MAAO,oBACvBolB,GAAc,CAAEplB,MAAO,aACvBqlB,GAAc,CAAC,WACfC,GAAc,CAAEtlB,MAAO,gBACvBulB,GAAc,CAAEvlB,MAAO,cACvBwlB,GAAc,CAChBjrC,IAAK,EACLylB,MAAO,+BAOX,IAA6B,qBAAiB,CAC1CwB,OAAQ,oBACRpnB,MAAO,CACHqrC,UAAW,CAAC,GAEhB,KAAA3jB,CAAMC,GACF,MAAM3nB,EAAQ2nB,EACRkI,GAAY,IAAAb,KAAI,WAChBsc,GAAe,IAAAtc,KAAI,YACnBuB,GAAQ,IAAAzP,UAAS,IACQ,cAApB9gB,EAAMqrC,UAA4B,EAAAxZ,UAAA,MAAkB,EAAAC,YAAA,OAEzDyZ,GAAkB,IAAAzqB,UAAS,IACxByP,EAAMxuB,OAAUwuB,EAAMxuB,MAAM,GAAG,KAE7BZ,OAAOkE,OAAOkrB,EAAMxuB,MAAM,GAAG,MAAMU,OAAO2O,GAA0B,iBAAVA,GAAsBA,EAAM,MADlF,IAGTo6B,GAAkB,IAAAxc,KAAI,OAC5B,IAAA+N,WAAUrvB,UACN,MAAMQ,QAAcuB,EAAgBzB,iBAAiB,aAGjDs9B,EAAavpC,MAFbmM,EAEqBA,EAChB1B,MAAM,eACN3D,IAAIqR,GAAS,MAAMA,EAAMrL,QAAQ,MAAO,eACxC6K,KAAK,IAGW,gBAG7B,IAAAvC,OAAMoZ,EAAOgW,IACLA,IACAiF,EAAgBzpC,MAAQwkC,EAAS,GAAG,IAAI,QAAUgF,EAAgBxpC,MAAM,IAAI,MAAQ,OAEzF,CAAEktB,WAAW,IAChB,MAAMjlB,GAAc,IAAA8W,UAAS,IACpByP,EAAMxuB,OAAUypC,EAAgBzpC,OAE9BwuB,EAAMxuB,MAAM,GAAG,KAAKypC,EAAgBzpC,QADhC,MAGT,GAAY,IAAA+e,UAAS,KACvB,IAAK9W,EAAYjI,OAAO,MAAM,KAC1B,MAAO,GACX,MAAM0pC,EAAczhC,EAAYjI,MAAM,KAAK,KAC3C,OAAOZ,OAAOgG,KAAKskC,GACdhpC,OAAOtC,GAAe,UAARA,GACd0I,IAAI1I,GAAOsrC,EAAYtrC,IACvB8I,KAAK,CAACjI,EAAGkI,IAAMlI,EAAE,GAAKkI,EAAE,MAOjC,MAAO,CAAC0e,EAAMC,IACF0I,EAAMxuB,OAASiI,EAAYjI,QAC5B,kBAAc,wBAAoB,MAAO,GAAY,EACpD,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,UACpB,wBAAoB,UAAW,GAAY,CACvC8lB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,KAAM,CAAEjC,MAAO,iBAAmB,OAAQ,KACxF,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,MAAO,GAAY,CACnCiC,EAAO,KAAOA,EAAO,IAAK,wBAAoB,MAAO,CAAEjC,MAAO,aAAe,QAAS,KACtF,wBAAoB,MAAO,IAAY,qBAAiB2K,EAAMxuB,MAAM,GAAG,IAAI,MAAO,MAEtF,wBAAoB,MAAO,GAAY,CACnC8lB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,MAAO,CAAEjC,MAAO,aAAe,QAAS,KACtF,wBAAoB,MAAO,IAAY,qBAAiB2K,EAAMxuB,MAAM,GAAG,IAAI,MAAO,UAI9F,wBAAoB,WACpB,wBAAoB,UAAW,GAAY,CACvC8lB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,KAAM,CAAEjC,MAAO,iBAAmB,QAAS,KACzF,wBAAoB,MAAO,GAAa,EACpC,wBAAoB,SAAU,CAC1BA,OAAO,oBAAgB,CAAC,YAAa,CAAEoK,OAA4B,YAApBH,EAAU9tB,SACzDimB,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAY2H,EAAU9tB,MAAQ,YACnE,SAAU,IACb,wBAAoB,SAAU,CAC1B6jB,OAAO,oBAAgB,CAAC,YAAa,CAAEoK,OAA4B,YAApBH,EAAU9tB,SACzDimB,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAY2H,EAAU9tB,MAAQ,YACnE,SAAU,OAGA,YAApB8tB,EAAU9tB,QACJ,kBAAc,wBAAoB,MAAO,CACxC5B,IAAK,EACLylB,MAAO,kBACP8lB,UAAWJ,EAAavpC,OACzB,KAAM,EAAe,MACtB,wBAAoB,QAAQ,GACb,YAApB8tB,EAAU9tB,OAAuBiI,EAAYjI,QACvC,kBAAc,wBAAoB,WAAW,CAAE5B,IAAK,GAAK,EACxD,wBAAoB,WACpB,wBAAoB,UAAW,GAAa,EACxC,wBAAoB,MAAO,GAAa,EACpC,wBAAoB,KAAM,GAAa,QAAS,qBAAiB6J,EAAYjI,MAAM,MAAO,IAC1F,wBAAoB,IAAK,IAAa,qBAAiBiI,EAAYjI,MAAM,MAAO,MAEpF,wBAAoB,MAAO,GAAa,EACpC,wBAAoB,MAAO,GAAa,CACpC8lB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,MAAO,CAAEjC,MAAO,aAAe,QAAS,KACtF,wBAAoB,MAAO,IAAa,qBAAiB5b,EAAYjI,MAAM,GAAG,MAAO,MAEzF,wBAAoB,MAAO,GAAa,CACpC8lB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,MAAO,CAAEjC,MAAO,aAAe,QAAS,KACtF,wBAAoB,MAAO,IAAa,qBAAiB5b,EAAYjI,MAAM,GAAG,MAAQ,IAAK,MAE/F,wBAAoB,MAAO,GAAa,CACpC8lB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,MAAO,CAAEjC,MAAO,aAAe,SAAU,KACvF,wBAAoB,MAAO,IAAa,qBAAiB5b,EAAYjI,MAAM,GAAG,OAAS,IAAK,MAEhG,wBAAoB,MAAO,GAAa,CACpC8lB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,MAAO,CAAEjC,MAAO,aAAe,QAAS,KACtF,wBAAoB,MAAO,IAAa,qBAAiB5b,EAAYjI,MAAM,GAAG,KAAK,KAAM,UAIrG,wBAAoB,WACpB,wBAAoB,UAAW,GAAa,CACxC8lB,EAAO,MAAQA,EAAO,KAAM,wBAAoB,KAAM,CAAEjC,MAAO,iBAAmB,QAAS,KAC3F,wBAAoB,IAAKilB,IAAa,qBAAiB7gC,EAAYjI,MAAM,KAAK,MAAO,IACrF,wBAAoB,MAAO+oC,GAAa,CACpCjjB,EAAO,MAAQA,EAAO,KAAM,wBAAoB,KAAM,CAAEjC,MAAO,oBAAsB,QAAS,KAC9F,wBAAoB,MAAOmlB,GAAa,EACpC,wBAAoB,KAAMC,GAAa,GAClC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAY,EAAUjpC,MAAQmK,KAC1E,kBAAc,wBAAoB,KAAM,CAC5C/L,IAAK+L,EAAM,GACX0Z,MAAO,cACPoC,QAAUE,IAnFjC,IAACyiB,KAmF6Dz+B,IAhFnF+gB,GAAmBvb,KAAKi5B,EAAM,GAAIgB,GAAiB,CAAEhB,YAiFV,EACC,wBAAoB,OAAQO,GAAa,OAAQ,qBAAiBh/B,EAAM,IAAK,IAC7E,wBAAoB,OAAQi/B,IAAa,qBAAiBj/B,EAAM,IAAK,IACtE,EAAe++B,MAClB,eAKrB,MACD,wBAAoB,QAAQ,UAGvC,kBAAc,wBAAoB,MAAOG,GAAa,cAErE,IC3LJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCwChE,MAAMQ,GAAe,IAxC5B,MACUC,WAAkC,IAAI1oC,IACtC2oC,WAAa,EAAgB,GAO7B,UAAAC,CAAWC,GACjB,IAAIC,EAAO,EACX,IAAK,IAAI/+B,EAAI,EAAGA,EAAI8+B,EAAI7iC,OAAQ+D,IAAK,CAEnC++B,GAAQA,GAAQ,GAAKA,EADRD,EAAIE,WAAWh/B,GAE5B++B,GAAQ,CACV,CACA,OAAOz2B,KAAKqZ,IAAIod,EAClB,CAOO,QAAAE,CAASloC,GACd,GAAI3B,KAAKupC,WAAWrnC,IAAIP,GACtB,OAAO3B,KAAKupC,WAAWvqC,IAAI2C,GAM7B,MAAMgoC,EAAO3pC,KAAKypC,WAAW9nC,GACvBqqB,EAAQhsB,KAAKwpC,WAAWrvB,OAAOwvB,EAAO,KAG5C,OADA3pC,KAAKupC,WAAWtnC,IAAIN,EAAMqqB,GACnBA,CACT,GCkMK,MAAM8d,GAAoB,IAjOjC,MACUC,aAER,WAAAnqB,GAOE5f,KAAK+pC,aAAe,IAAIlpC,IAAI,CAC1B,CAAC,IAAK,GACN,CAAC,IAAK,GACN,CAAC,KAAMqS,KAAKmiB,GAAK,GACjB,CAAC,KAAMniB,KAAKmiB,GAAK,GACjB,CAAC,IAAKniB,KAAKmiB,GAAK,GAChB,CAAC,IAAKniB,KAAKmiB,GAAK,GAChB,CAAC,KAAiB,EAAVniB,KAAKmiB,GAAU,GACvB,CAAC,KAAiB,EAAVniB,KAAKmiB,GAAU,GACvB,CAAC,IAAKniB,KAAKmiB,IACX,CAAC,IAAKniB,KAAKmiB,IACX,CAAC,KAAiB,EAAVniB,KAAKmiB,GAAU,GACvB,CAAC,KAAiB,EAAVniB,KAAKmiB,GAAU,GACvB,CAAC,IAAgB,EAAVniB,KAAKmiB,GAAU,GACtB,CAAC,IAAgB,EAAVniB,KAAKmiB,GAAU,GACtB,CAAC,KAAiB,EAAVniB,KAAKmiB,GAAU,GACvB,CAAC,KAAiB,EAAVniB,KAAKmiB,GAAU,GACvB,CAAC,IAAK,GACN,CAAC,IAAK,GACN,CAAC,KAAMniB,KAAKmiB,GAAK,GACjB,CAAC,MAAOniB,KAAKmiB,GAAK,GAClB,CAAC,IAAKniB,KAAKmiB,GAAK,GAChB,CAAC,OAAQniB,KAAKmiB,GAAK,IAEvB,CAOQ,YAAA2U,CAAaC,GACnB,IACE,IAAIC,EACAC,EAAgB,EAEpB,GAAIpkC,MAAMwI,QAAQ07B,GAChBC,EAAgB/vB,OAAO8vB,EAAa,IAAIxgC,OACxC0gC,EAAgBF,EAAapjC,OAAS,EAAIoE,OAAOg/B,EAAa,IAAM,MAC/D,IAA4B,iBAAjBA,EAQhB,OADA/oC,QAAQuM,KAAK,kCAAmCw8B,GACzC,KARoC,CAE3C,MACMz/B,EADey/B,EAAa19B,QAAQ,WAAY,IAAI9C,OAC/BS,MAAM,KACjCggC,EAAgB1/B,EAAM,GAAGf,OACzB0gC,EAAgB3/B,EAAM3D,OAAS,EAAIoE,OAAOT,EAAM,IAAM,CACxD,CAGA,CAEA,IAAK0/B,EAEH,OADAhpC,QAAQuM,KAAK,qCAAsCw8B,GAC5C,KAGT,GAAIj/B,MAAMm/B,GAAgB,CACxBjpC,QAAQuM,KAAK,wCAAyCw8B,GAEtD,MAAMG,EAAYpqC,KAAK+pC,aAAa/qC,IAAIkrC,GACxC,YAAqB/rC,IAAdisC,EAA0BA,EAAY,IAC/C,CAEA,MAAMA,EAAYpqC,KAAK+pC,aAAa/qC,IAAIkrC,GAExC,QAAkB/rC,IAAdisC,EAEF,OADAlpC,QAAQuM,KAAK,iCAAiCy8B,MACvC,KAIT,OAAOE,EADgBD,EAAgBj3B,KAAKmiB,GAAM,GAEpD,CAAE,MAAO5pB,GAEP,OADAvK,QAAQuK,MAAM,uCAAwC,CAAEhM,MAAOwqC,EAAcx+B,UACtE,IACT,CACF,CAQQ,iBAAA4+B,CAAkBC,GAExB,MAAM7qC,EAAQwL,OAAOq/B,EAAS,IACxBC,EAAOD,EAAS,GAEtB,GAAIt/B,MAAMvL,GACR,OAAO,EAGT,OAAQ8qC,EAAKx/B,eACX,IAAK,KAML,QACE,OAAOtL,EALT,IAAK,KACH,OAAe,YAARA,EACT,IAAK,KACH,OAAe,gBAARA,EAIb,CASO,uBAAA+qC,CACL3U,EACA4U,GAEA,QAAqBtsC,IAAjB03B,EAAWtM,QAAoCprB,IAAjB03B,EAAWpM,IAAoBghB,EAC/D,OAAO,KAGT,MAAMC,EAAU1qC,KAAKgqC,aAAaS,EAAc,IAChD,GAAgB,OAAZC,EACF,OAAO,KAKT,IAAIR,EAAgB,GACpB,GAAInkC,MAAMwI,QAAQk8B,EAAc,IAC9BP,EAAgB/vB,OAAOswB,EAAc,GAAG,SACnC,GAAgC,iBAArBA,EAAc,GAAiB,CAC/C,MAAME,EAAUF,EAAc,GAAGlmC,MAAM,4BACnComC,GAAWA,EAAQ9jC,OAAS,IAC9BqjC,EAAgBS,EAAQ,GAAGp+B,QAAQ,WAAY,IAAI9C,OAEvD,CAEA,GAAsB,MAAlBygC,GAAyD,MAAhCA,EAAcU,cACzC,MAAO,CAAErhB,EAAGsM,EAAWtM,EAAGE,EAAGoM,EAAWpM,GAG1C,MAAMohB,EAAsB7qC,KAAKqqC,kBAAkBI,EAAc,IAKjE,MAAO,CAAElhB,EAHMsM,EAAWtM,EAAIshB,EAAsB33B,KAAKgtB,IAAIwK,GAGzCjhB,EAFLoM,EAAWpM,EAAIohB,EAAsB33B,KAAKkiB,IAAIsV,GAG/D,CAOO,0BAAAI,CAA2B9iC,EAAiBu3B,GACjD,IAAKA,GAAgC,IAApBA,EAAS14B,OACxB,OAGF,MAAMkkC,EAAexL,EAClBh5B,IAAIykC,GAAUA,EAAMp2B,KAAK,KAAO5U,KAAKqqC,kBAAkBW,EAAMp2B,KAAK,KAAK,IAAM,GAC7EzU,OAAO1B,GAAKA,EAAI,GAEnB,IAAIwsC,EAIJ,GAAIF,EAAalkC,OAAS,EAAG,CAC3B,MAAMuM,EAAMF,KAAKE,OAAO23B,GAClB53B,EAAMD,KAAKC,OAAO43B,GACxBE,EAAgB,IAAiBC,OAAO,CAAC93B,EAAKD,IAAMg4B,MAAM,CAN1C,IACA,MAKkEC,OAAM,EAC1F,MAEEH,EAAgB,IAAiBC,OAAO,CAAC,EAAG,IAAIC,MAAM,CATtC,UAYlB5L,EAASj/B,QAAQ0qC,IACf,MAAMK,EAAQL,EAAMp2B,KAAK,KACzB,IAAKy2B,EAGH,OAFAL,EAAMzhB,EAAIvhB,EAAOuhB,OACjByhB,EAAMvhB,EAAIzhB,EAAOyhB,GAInB,MAAM6hB,EAAgBD,EAAM,GAAGnoC,SAAS,MAA6C,IAArClD,KAAKqqC,kBAAkBgB,EAAM,IACvEE,EAAaF,EAAM,GAAGnoC,SAAS,MAAQmoC,EAAM,GAAGnoC,SAAS,KAE/D,GAAIooC,GAAiBC,EAAY,CAG/B,GAFAP,EAAMzhB,EAAIvhB,EAAOuhB,EACjByhB,EAAMvhB,EAAIzhB,EAAOyhB,EACb8hB,EAAY,CACd,MAAMb,EAAU1qC,KAAKgqC,aAAaqB,EAAM,IACxC,GAAgB,OAAZX,EAAkB,CACpB,MAAMc,EAAiBP,EAAcjrC,KAAKqqC,kBAAkBgB,EAAM,KAClEL,EAAMvhB,GAAKuhB,EAAMvhB,GAAK,GAAK+hB,EAAiBt4B,KAAKkiB,IAAIsV,EACvD,CACF,CACA,MACF,CAEA,MAAMA,EAAU1qC,KAAKgqC,aAAaqB,EAAM,IACxC,GAAgB,OAAZX,EAGF,OAFAM,EAAMzhB,EAAIvhB,EAAOuhB,OACjByhB,EAAMvhB,EAAIzhB,EAAOyhB,GAInB,MAAMohB,EAAsB7qC,KAAKqqC,kBAAkBgB,EAAM,IACnDG,EAAiBP,EAAcJ,GAErCG,EAAMzhB,EAAIvhB,EAAOuhB,EAAKiiB,EAAiBt4B,KAAKgtB,IAAIwK,GAChDM,EAAMvhB,EAAIzhB,EAAOyhB,EAAK+hB,EAAiBt4B,KAAKkiB,IAAIsV,IAEpD,GCxHK,MAAMe,GAAsB,IArGnC,MACUC,eAAsC,KAQvC,eAAAC,CAAgB78B,GACrB,IAAKA,EAAO,OAAO,KAEnB,MAAM88B,EAAW98B,EAAM,KACvB,GAAI9O,KAAK0rC,gBAAmB1rC,KAAK0rC,eAAuBE,WAAaA,EACnE,OAAO5rC,KAAK0rC,eAGd,MAAMG,EAAkB/8B,EAAM,IAAI,KAElC,IAAK+8B,GAA2D,IAAxChtC,OAAOgG,KAAKgnC,GAAiBhlC,OAEnD,OADA3F,QAAQuM,KAAK,6BAA6BqB,EAAM,0BACzC,KAIT,MAAMg9B,EAAiC,GACvC,IAAK,MAAMjuC,KAAOguC,EACJ,UAARhuC,GAAmBgB,OAAOM,UAAUC,eAAeC,KAAKwsC,EAAiBhuC,IAC3EiuC,EAAc7rC,KAAK,IAAM4rC,EAAwBhuC,GAAM6U,GAAI7U,IAI/D,MAAMkuC,EAAY/rC,KAAKgsC,eAAeF,GAGtC,OAFCC,EAAkBH,SAAWA,EAC9B5rC,KAAK0rC,eAAiBK,EACf/rC,KAAK0rC,cACd,CAKO,UAAAO,GACLjsC,KAAK0rC,eAAiB,IACxB,CAOQ,cAAAM,CAAermC,GACrB,MAAMumC,EAAU,IAAIrrC,IACdsrC,EAAuB,GAG7BxmC,EAASrF,QAAQyB,IACfmqC,EAAQjqC,IAAIF,EAAO2Q,GAAI,CACrBjR,GAAIM,EAAO2Q,GACXhR,KAAMK,EAAO,GACbJ,KAAMI,EAAO,KACbuB,SAAUvB,EAAO,IAAI2Q,GACrB6sB,SAAU,GACV6M,WAAY,EACZC,OAAQ,GACRz3B,KAAM7S,MAKV,IAAK,MAAM2wB,KAAQwZ,EAAQnpC,SAAU,CAGnC,MAAMiF,EAAS0qB,EAAKpvB,SAAW4oC,EAAQltC,IAAI0zB,EAAKpvB,UAAY,KACxD0E,EACFA,EAAOu3B,SAASt/B,KAAKyyB,GAErByZ,EAAUlsC,KAAKyyB,EAEnB,CAGA,IAAK,MAAMA,KAAQwZ,EAAQnpC,SACzB2vB,EAAK0Z,WAAa1Z,EAAK6M,SAAS14B,OAelC,MAX6B,CAC3BpF,GAAI,eACJC,KAAM,KACNC,KAAM,SACN2B,SAAU,KACVi8B,SAAU4M,EACVC,WAAYD,EAAUtlC,OACtBwlC,OAAQ,EACRz3B,KAAM,CAAC,EAIX,GC5FI,IAAQ,IAAA5F,UAAmB,CAC/Bs9B,cAAe,eACfC,eAAgB,CAAC,CAAE9qC,GAAI,eAAgBC,KAAM,OAC7CizB,aAAc,KACd6X,sBAAsB,EACtB1+B,UAAW,KACX2+B,eAAgB,KAChBC,iBAAkB,OAGd,GAAU,CAKd,cAAAC,CAAeja,GACb,GAAM4Z,cAAgB5Z,EAAKjxB,GAEtB,GAAM8qC,eAAevpC,KAAK4pC,GAASA,EAAMnrC,KAAOixB,EAAKjxB,KACxD,GAAM8qC,eAAetsC,KAAK,CAAEwB,GAAIixB,EAAKjxB,GAAIC,KAAMgxB,EAAKhxB,MAExD,EAMA,YAAAmrC,CAAaC,GACX,MAAMC,EAAc,GAAMR,eAAe58B,UAAUi9B,GAASA,EAAMnrC,KAAOqrC,GACrEC,GAAe,IACjB,GAAMT,cAAgBQ,EACtB,GAAMP,eAAe38B,OAAOm9B,EAAc,GAE9C,EAMA,UAAA1W,CAAW3D,GACT,GAAMiC,aAAejC,EACrB,GAAM8Z,sBAAuB,CAC/B,EAKA,UAAAQ,GACE,GAAMrY,aAAe,KACrB,GAAM6X,sBAAuB,CAC/B,EAMA,iBAAAS,CAAkB91B,GAChB,GAAMo1B,eAAiBp1B,CACzB,EAMA,YAAA+1B,CAAat4B,GACX,GAAM9G,UAAY8G,CACpB,EAMA,kBAAAu4B,CAAmBxqC,GACjB,GAAM8pC,eAAiB9pC,EAAUyqC,KACjC,GAAMV,iBAAmB/pC,EAAUi4B,MACrC,GAGWyS,IAAW,IAAAhyB,UAAS,IACpBiyB,GAAa,GChGpB,GAAa,CAAEhqB,MAAO,iBACtB,GAAa,CAAC,WACd,GAAa,CACfzlB,IAAK,EACLylB,MAAO,aAEX,IAA6B,qBAAiB,CAC1CwB,OAAQ,eACRpnB,MAAO,CACHyZ,KAAM,CACFxV,KAAMoE,MACNgoB,UAAU,IAGlB5I,MAAO,CAAC,YACR,KAAAC,CAAMC,GAAWvJ,KAAMyM,IACnB,MAAMzM,EAAOyM,EAIb,MAAO,CAACjD,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,GACxD,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYF,EAAQlO,KAAM,CAACy1B,EAAOl9B,MAC9E,kBAAc,wBAAoB,OAAQ,CAC9C7R,IAAK+uC,EAAMnrC,GACX6hB,MAAO,QACPoC,QAAUE,IAAW,OATf2nB,EAS6BX,EAAMnrC,QARrDqa,EAAK,WAAYyxB,GADA,IAACA,IAUP,EACC,sBAAiB,qBAAiBX,EAAMlrC,MAAQ,IAAK,GACpDgO,EAAQ2V,EAAQlO,KAAKtQ,OAAS,IACxB,kBAAc,wBAAoB,OAAQ,GAAY,SACvD,wBAAoB,QAAQ,IACnC,EAAe,MAClB,QAGhB,IC9BJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjE,GAAa,CAAEyc,MAAO,gBACtB,GAAa,CAAEA,MAAO,iBACtB,GAAa,CAAEzlB,IAAK,GACpB,GAAa,CAAEylB,MAAO,WACtB,GAAa,CAAEzlB,IAAK,GACpB,GAAa,CACfA,IAAK,EACLylB,MAAO,WAEL,GAAa,CACfzlB,IAAK,EACLylB,MAAO,WAEL,GAAa,CAAEA,MAAO,iBACtB,GAAa,CAAEA,MAAO,aACtB,GAAc,CAAC,WACf,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,WAEL,GAAc,CAAEA,MAAO,aACvB,GAAc,CAChBzlB,IAAK,EACLylB,MAAO,WAEL,GAAc,CAAEA,MAAO,aACvB,GAAc,CAAEzlB,IAAK,GAG3B,IAA6B,qBAAiB,CAC1CinB,OAAQ,kBACRpnB,MAAO,CACHg1B,KAAM,CACF/wB,KAAM9C,OACNiF,QAAS,OAGjBqhB,MAAO,CAAC,SACR,KAAAC,CAAMC,GACF,MAAM3nB,EAAQ2nB,EAMRka,GAAW,IAAA/gB,UAAS,IACf9gB,EAAMg1B,MAAM6M,UAAY,IAE7BiO,GAAsB,IAAAhvB,UAAS,KACjC,IAAK9gB,EAAMg1B,OAAS2a,GAASv/B,WAAW,IAAI,GACxC,MAAO,GAEX,MAAM2/B,EAAYJ,GAASv/B,UAAU,GAAG,GAGxC,OADuB/H,MAAMwI,QAAQk/B,GAAaA,EAAY,IACxCttC,OAAQutC,GAAaA,EAAS,SAAWhwC,EAAMg1B,MAAMjxB,MAEzEksC,GAAqB,IAAAnvB,UAAS,KAEhC,IAAK9gB,EAAMg1B,OAAS2a,GAASv/B,WAAW,IAAI,IAAI,GAC5C,MAAO,GAEX,MAAM8/B,EAAiBP,GAASv/B,UAAU,GAAG,GAAG,GAWhD,OATsB/H,MAAMwI,QAAQq/B,GAAkBA,EAAiB/uC,OAAOkE,OAAO6qC,IAEtDztC,OAAO0tC,IAElC,IAAKA,GAA8B,iBAAZA,EACnB,OAAO,EAEX,OAD0B7gC,KAAKC,UAAU4gC,GAChB3qC,SAASxF,EAAMg1B,KAAKhxB,UAI/CosC,GAAW,IAAAphB,KAAI,MA0ErB,OAzEA,IAAA+N,WAAU,KACN,MAAMsT,EAAQD,EAASruC,MACvB,IAAKsuC,EACD,OACWA,EAAMC,cAAc,iBAE5B1W,iBAAiB,YAAcxsB,IAClC,IAAImjC,GAAa,EACjB,MAAMpX,EAAS/rB,EAAE0e,QACXsN,EAAShsB,EAAE4e,QACXuN,EAAY8W,EAAM7W,WAClBH,EAAWgX,EAAM/W,UACjBkX,EAAcC,IAChB,IAAKF,EACD,OACJ,MAAMG,EAAKD,EAAU3kB,QAAUqN,EACzBwX,EAAKF,EAAUzkB,QAAUoN,EAC/BiX,EAAMvpB,MAAM4H,KAAO,GAAG6K,EAAYmX,MAClCL,EAAMvpB,MAAMqQ,IAAM,GAAGkC,EAAWsX,OAE9BC,EAAY,KACdL,GAAa,EACb5rB,SAASgV,oBAAoB,YAAa6W,GAC1C7rB,SAASgV,oBAAoB,UAAWiX,IAE5CjsB,SAASiV,iBAAiB,YAAa4W,GACvC7rB,SAASiV,iBAAiB,UAAWgX,KAGzBP,EAAMQ,iBAAiB,kBAC/BjuC,QAAQkuC,IACZA,EAAOlX,iBAAiB,YAAcxsB,IAClCA,EAAE2jC,kBACF,MAAM7f,EAAY4f,EAAOE,QAAQ9f,UACjC,IAAKA,EACD,OACJ,IAAI+f,GAAa,EACjB,MAAM9X,EAAS/rB,EAAE0e,QACXsN,EAAShsB,EAAE4e,QACXklB,EAAab,EAAMc,YACnBC,EAAcf,EAAMgB,aACpB9X,EAAY8W,EAAM7W,WAClBH,EAAWgX,EAAM/W,UACjBgY,EAAgBb,IAClB,IAAKQ,EACD,OACJ,MAAMP,EAAKD,EAAU3kB,QAAUqN,EACzBwX,EAAKF,EAAUzkB,QAAUoN,EAC3BlI,EAAU1rB,SAAS,WACnB6qC,EAAMvpB,MAAMqH,MAAQ,GAAG+iB,EAAaR,OAEpCxf,EAAU1rB,SAAS,YACnB6qC,EAAMvpB,MAAMqd,OAAS,GAAGiN,EAAcT,OAEtCzf,EAAU1rB,SAAS,UACnB6qC,EAAMvpB,MAAMqH,MAAW+iB,EAAaR,EAAhB,KACpBL,EAAMvpB,MAAM4H,KAAO,GAAG6K,EAAYmX,OAElCxf,EAAU1rB,SAAS,SACnB6qC,EAAMvpB,MAAMqd,OAAYiN,EAAcT,EAAjB,KACrBN,EAAMvpB,MAAMqQ,IAAM,GAAGkC,EAAWsX,QAGlCY,EAAc,KAChBN,GAAa,EACbtsB,SAASgV,oBAAoB,YAAa2X,GAC1C3sB,SAASgV,oBAAoB,UAAW4X,IAE5C5sB,SAASiV,iBAAiB,YAAa0X,GACvC3sB,SAASiV,iBAAiB,UAAW2X,SAI1C,CAAC3pB,EAAMC,MACF,kBAAc,wBAAoB,MAAO,CAC7CjC,MAAO,oBACPqhB,QAAS,WACTjY,IAAKohB,GACN,EACC,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,KAAM,MAAM,qBAAiBzoB,EAAQqN,MAAMhxB,MAAQ,MAAO,IAC9E,wBAAoB,SAAU,CAC1B4hB,MAAO,YACPoC,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAYN,EAAKO,MAAM,WAC5D,QAEP,wBAAoB,MAAO,GAAY,CAClCR,EAAY,OACN,kBAAc,wBAAoB,MAAO,GAAY,EACpD,wBAAoB,SACpB,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,IAAK,KAAM,CAC3BE,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,OAAQ,KACtE,qBAAiB,KAAM,qBAAiBF,EAAQqN,KAAK/wB,MAAO,KAE/D0jB,EAAQqN,KAAK9d,KAAO,KACd,kBAAc,wBAAoB,IAAK,GAAY,CAClD2Q,EAAO,KAAOA,EAAO,IAAK,wBAAoB,SAAU,KAAM,OAAQ,KACtE,qBAAiB,KAAM,qBAAiBF,EAAQqN,KAAK9d,KAAK,GAAG,IAAM,KAAM,qBAAiByQ,EAAQqN,KAAK9d,KAAK,GAAG,IAAK,OAEtH,wBAAoB,QAAQ,MAEtC,wBAAoB,QACnByQ,EAAQqN,KAAK9d,KAAO,KACd,kBAAc,wBAAoB,MAAO,GAAY,CACpD2Q,EAAO,KAAOA,EAAO,IAAK,wBAAoB,KAAM,CAAEjC,MAAO,iBAAmB,MAAO,KACvF,wBAAoB,MAAO,MAAM,qBAAiB+B,EAAQqN,KAAK9d,KAAK,IAAK,OAE3E,wBAAoB,QAAQ,IAClC,wBAAoB,SACnB2qB,EAAS9/B,MAAMoH,OAAS,IAClB,kBAAc,wBAAoB,MAAO,GAAY,EACpD,wBAAoB,KAAM,GAAY,SAAU,qBAAiB04B,EAAS9/B,MAAMoH,QAAU,IAAK,IAC/F,wBAAoB,KAAM,GAAY,GACjC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAY04B,EAAS9/B,MAAQurC,KACzE,kBAAc,wBAAoB,KAAM,CAC5CntC,IAAKmtC,EAAMvpC,GACX6hB,MAAO,wBACPoC,QAAUE,IA1J/B,IAAC8M,KA0JqDsY,GAzJ5DoB,WAAa,GAClBkB,GAAWX,eAAeja,MAyJK,qBAAiBsY,EAAMtpC,MAAQ,MAAO,qBAAiBspC,EAAMrpC,MAAQ,KAAM,EAAqB,MACnG,YAGV,wBAAoB,QAAQ,IAClC,wBAAoB,UACnB6rC,EAAoB/tC,MAAMoH,OAAS,IAC7B,kBAAc,wBAAoB,MAAO,GAAa,CACrD0e,EAAO,KAAOA,EAAO,IAAK,wBAAoB,KAAM,CAAEjC,MAAO,iBAAmB,QAAS,KACzF,wBAAoB,KAAM,GAAa,GAClC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYkqB,EAAoB/tC,MAAQiuC,KACpF,kBAAc,wBAAoB,KAAM,CAC5C7vC,IAAK6vC,EAASh7B,GACd4Q,MAAO,aACR,EACC,sBAAiB,qBAAiBoqB,EAAS,IAAM,IAAK,IACtD,wBAAoB,OAAQ,CACxBpqB,OAAO,oBAAgB,CAAC,SAAU,UAAUoqB,EAAS,SACtD,KAAM,qBAAiBA,EAAS,KAAO,IAAK,OAEnD,YAGV,wBAAoB,QAAQ,IAClC,wBAAoB,iBACnBC,EAAmBluC,MAAMoH,OAAS,IAC5B,kBAAc,wBAAoB,MAAO,GAAa,CACrD0e,EAAO,KAAOA,EAAO,IAAK,wBAAoB,KAAM,CAAEjC,MAAO,iBAAmB,QAAS,KACzF,wBAAoB,KAAM,GAAa,GAClC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYqqB,EAAmBluC,MAAQouC,KACnF,kBAAc,wBAAoB,KAAM,CAC5ChwC,IAAKgwC,EAAQn7B,GACb4Q,MAAO,cACR,qBAAiBuqB,EAAQ,IAAM,MAAO,qBAAiBA,EAAQ,IAAM,KAAM,KAC9E,YAGV,wBAAoB,QAAQ,QAEnC,kBAAc,wBAAoB,MAAO,GAAa,IAAKtoB,EAAO,KAAOA,EAAO,GAAK,EAChF,wBAAoB,IAAK,KAAM,YAAa,UAG5DA,EAAO,KAAOA,EAAO,IAAK,uBAAmB,upBAAwrB,KACtuB,KAEX,IC3OJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjE,GAAa,CAAEjC,MAAO,kBACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,gBAEL,GAAa,CACfzlB,IAAK,EACLylB,MAAO,kBAEL,GAAa,CAAC,WCJpB,IDe6B,qBAAiB,CAC1CwB,OAAQ,qBACR,KAAAM,CAAMC,GACF,MAAM6pB,GAAS,IAAAxiB,KAAI,MACbyiB,GAAgB,IAAAziB,KAAI,MACpB0iB,GAAc,IAAA1iB,KAAI,IAClB2iB,GAAc,IAAA3iB,KAAI,IAClB4iB,GAAa,IAAA5iB,KAAI,IACjB6P,GAAQ,IAAA7P,KAAI,IACZ6iB,GAAuB,IAAA7iB,MAAI,GAE3B6f,GAAiB,IAAA/tB,UAAS,IAAM6uB,GAASd,gBACzCC,GAAuB,IAAAhuB,UAAS,IAAM6uB,GAASb,sBAC/C7X,GAAe,IAAAnW,UAAS,IAAM6uB,GAAS1Y,cACvC2X,GAAgB,IAAA9tB,UAAS,IAAM6uB,GAASf,eAExCkD,EAAW,CAAC9c,EAAMjxB,KACpB,GAAIixB,EAAKjxB,KAAOA,EACZ,OAAOixB,EACX,IAAK,MAAMsY,KAAStY,EAAK6M,SAAU,CAC/B,MAAMkQ,EAAQD,EAASxE,EAAOvpC,GAC9B,GAAIguC,EACA,OAAOA,CACf,CACA,OAAO,MAELC,GAAkB,IAAAlxB,UAAS,IACxB2wB,EAAc1vC,MAEZ+vC,EAASL,EAAc1vC,MAAO6sC,EAAc7sC,OADxC,MAGTkwC,GAAW,IAAAnxB,UAAS,KACtB,MAAMoxB,EAAQ,GAQd,OAHIT,EAAc1vC,OAJlB,SAASowC,EAASnd,GACdkd,EAAM3vC,KAAKyyB,GACXA,EAAK6M,SAASj/B,QAAQuvC,EAC1B,CAEIA,CAASV,EAAc1vC,OAEpBmwC,IAELE,GAAgB,IAAAtxB,UAAS,IACtB8wB,EAAW7vC,MAETkwC,EAASlwC,MAAMU,OAAOuyB,GAAQA,EAAKhxB,KAAKqJ,cAAc7H,SAASosC,EAAW7vC,MAAMsL,gBAAgBd,MAAM,EAAG,IADrG,IAYT8lC,EAAcrd,IAChB,MAAMvb,EAAO,GACb,IAAImb,EAAUI,EACd,KAAOJ,GAAWA,EAAQhvB,UAA2B,iBAAfgvB,EAAQ7wB,IAC1C0V,EAAKsP,QAAQ6L,GACbA,EAAUqd,EAASlwC,MAAMuD,KAAK1E,GAAKA,EAAEmD,KAAO6wB,EAAQhvB,UAEpDgvB,GACAnb,EAAKsP,QAAQ6L,GAEjB,MAAM0d,EAAa74B,EAAK5Q,IAAI4D,IAAK,CAAG1I,GAAI0I,EAAE1I,GAAIC,KAAMyI,EAAEzI,QACtD4rC,GAAWL,kBAAkB+C,GACzBtd,EAAKpvB,SACLgqC,GAAWT,aAAana,EAAKpvB,UAG7BgqC,GAAWT,aAAa,gBAE5ByC,EAAW7vC,MAAQ,IAEjBwwC,EAAoB,KAClBH,EAAcrwC,MAAMoH,OAAS,GAC7BkpC,EAAWD,EAAcrwC,MAAM,KAGjCywC,GAAe,IAAAxjB,KAAI,OAoDJ,IAAAlO,UAAS,IACnBkxB,EAAgBjwC,MAAQiwC,EAAgBjwC,MAAM8/B,SAAW,IAsHpE,SAAS4Q,EAASP,EAAOQ,EAAO39B,GAC5B,MAAM49B,EAAc,IAAIxvC,IACxB,IAAKquC,EAAOzvC,MACR,OACJ,MAAM6wC,EAAM,EAAUpB,EAAOzvC,OACvB8wC,EAAgBD,EAAIE,UAAU,oBAAoB57B,KAAK,CAAC,OACxD67B,EAAqBF,EAAcG,QAAQC,OAAO,KAAK/kB,KAAK,QAAS,kBACrEglB,EAAIL,EAAcM,MAAMJ,GAE9BA,EACKE,OAAO,KACPH,UAAU,eACV57B,KAAK2nB,EAAM98B,OACX2X,KAAK,UACLwU,KAAK,QAAS,QACdA,KAAK,KAAMntB,GAAKA,EAAE8qB,GAClBqC,KAAK,KAAMntB,GAAKA,EAAEgrB,GAClBmC,KAAK,IAAKntB,GAAKA,EAAEa,GACjBssB,KAAK,OAAQ,SACbA,KAAK,UAAWntB,GAAKA,EAAEG,GAC5B,MAAMkyC,EAAO,IAERC,YAAY,CAAC,IAAM,KACnBt1B,GAAG,OAAQC,IACZk1B,EAAEhlB,KAAK,YAAalQ,EAAMjJ,aAE9B69B,EAAIjxC,KAAKyxC,GAAMr1B,GAAG,gBAAiB,MACnC60B,EACKU,aACAzhC,SAAS,KACTlQ,KAAKyxC,EAAKr+B,UAAWA,GAE1B,MAAMyG,EAAI,IAAgB3J,SAAS,KAE7B0hC,EAAmBrB,EAAM5sC,KAAK1E,GAAKA,EAAEmD,KAAO6qC,EAAc7sC,QAAUmwC,EAAM,GAChF,GAAIqB,EAAkB,CAClB,MAAMC,EAAYtB,EACbzvC,OAAO7B,GAAKA,EAAEmD,KAAOwvC,EAAiBxvC,IACtC8E,IAAIjI,IACL,MAAM8vC,GAAM9vC,EAAEirB,GAAK,IAAM0nB,EAAiB1nB,GAAK,GACzC8kB,GAAM/vC,EAAEmrB,GAAK,IAAMwnB,EAAiBxnB,GAAK,GAC/C,OAAOvW,KAAK+sB,KAAKmO,EAAKA,EAAKC,EAAKA,KAE/BluC,OAAO1B,GAAKA,EAAI,GACrBmyC,EAAEJ,UAAU,qBACP57B,KAAKs8B,GACL95B,KAAKs5B,GAASA,EACdC,OAAO,UACP/kB,KAAK,QAAS,cACdA,KAAK,KAAMqlB,EAAiB1nB,GAAK,GACjCqC,KAAK,KAAMqlB,EAAiBxnB,GAAK,GACjCmC,KAAK,IAAK,GACVA,KAAK,OAAQ,QACbA,KAAK,SAAU,4BACfvsB,KAAKqxC,GAASA,EAAMM,WAAW93B,GAAG0S,KAAK,IAAKntB,GAAKA,IAAKyiC,GAAUA,EAAO7hC,KAAK6hC,GAAUA,EACtF8P,WAAW93B,GACX0S,KAAK,KAAMqlB,EAAiB1nB,GAAK,GACjCqC,KAAK,KAAMqlB,EAAiBxnB,GAAK,GACjCmC,KAAK,IAAKntB,GAAKA,IAAK0yC,GAAQA,EAAK9xC,KAAK8xC,GAAQA,EAAKH,WAAW93B,GAAG0S,KAAK,IAAK,GAAGoT,UACvF,CAEA4R,EAAEJ,UAAU,aACP57B,KAAKw7B,EAAQ3xC,GAAM,GAAGA,EAAEiG,OAAOjD,MAAMhD,EAAEd,OAAO8D,MAC9C2V,KAAKs5B,GAASA,EACdC,OAAO,QACP/kB,KAAK,QAAS,QACdA,KAAK,SAAU,QACfA,KAAK,iBAAkB,GACvBA,KAAK,KAAMntB,GAAKA,EAAEiG,OAAO6kB,GAAK,GAC9BqC,KAAK,KAAMntB,GAAKA,EAAEiG,OAAO+kB,GAAK,GAC9BmC,KAAK,KAAMntB,GAAKA,EAAEd,OAAO4rB,GAAK,GAC9BqC,KAAK,KAAMntB,GAAKA,EAAEd,OAAO8rB,GAAK,GAC9BpqB,KAAKqxC,GAASA,EAAMM,WAAW93B,GAAG0S,KAAK,iBAAkB,KAAOsV,GAAUA,EAAO7hC,KAAK6hC,GAAUA,EAChG8P,WAAW93B,GACX0S,KAAK,KAAMntB,GAAKA,EAAEiG,OAAO6kB,GAAK,GAC9BqC,KAAK,KAAMntB,GAAKA,EAAEiG,OAAO+kB,GAAK,GAC9BmC,KAAK,KAAMntB,GAAKA,EAAEd,OAAO4rB,GAAK,GAC9BqC,KAAK,KAAMntB,GAAKA,EAAEd,OAAO8rB,GAAK,IAAK0nB,GAAQA,EAAK9xC,KAAK8xC,GAAQA,EAAKH,WAAW93B,GAAG0S,KAAK,iBAAkB,GAAGoT,WAE/G,MAAMoS,EAAaR,EAAEJ,UAAU,gBAAgB57B,KAAKg7B,EAAOnxC,GAAKA,EAAEgD,IAC5D4vC,EAAYD,EACbV,QACAC,OAAO,KACP/kB,KAAK,QAAS,cACdA,KAAK,YAAcntB,GAAM,aAAaA,EAAE8qB,GAAK,KAAK9qB,EAAEgrB,GAAK,MACzDmC,KAAK,UAAW,GACrBylB,EACKV,OAAO,UACP/kB,KAAK,IAAKntB,GAAKA,EAAE4tC,QACjBzgB,KAAK,OAAQntB,GAAK6qC,GAAaO,SAASprC,EAAEkD,OAC1CiqB,KAAK,SAAUntB,GAAK,EAAS6qC,GAAaO,SAASprC,EAAEkD,QAAQ2vC,SAAS,KAAK7vB,YAAc,QACzFmK,KAAK,eAAgB,GAC1BylB,EACKV,OAAO,QACPjrC,KAAKjH,GAAKA,EAAEiD,MACZkqB,KAAK,cAAe,UACpBA,KAAK,KAAMntB,GAAKA,EAAE4tC,OAAS,IAC3BzgB,KAAK,OAAQ,SACbpH,MAAM,YAAa,QACxB4sB,EACKP,MAAMQ,GACN51B,GAAG,QAAS,SAAUC,EAAOjd,GAC9B,MAAM8yC,EAAkBlB,EAAYrxC,IAAIP,EAAEgD,IAC1C,GAAI8vC,EACAC,aAAaD,GACblB,EAAYoB,OAAOhzC,EAAEgD,IACrB6rC,GAAWjX,WAAW53B,OAErB,CACD,MAAMizC,EAAa/vB,OAAOnS,WAAW,KAC7B/Q,EAAE2tC,WAAa,EACfkB,GAAWX,eAAeluC,GAG1B6uC,GAAWjX,WAAW53B,GAE1B4xC,EAAYoB,OAAOhzC,EAAEgD,KACtB,KACH4uC,EAAYpuC,IAAIxD,EAAEgD,GAAIiwC,EAC1B,CACJ,GACKV,WAAW93B,GACX0S,KAAK,YAAcntB,GAAM,aAAaA,EAAE8qB,GAAK,KAAK9qB,EAAEgrB,GAAK,MACzDmC,KAAK,UAAW,GACrBwlB,EAAWD,OAAOH,WAAW93B,GAAG0S,KAAK,UAAW,GAAGoT,QACvD,EAhPA,IAAAnqB,OAAM66B,EAAiBiC,IACnB,GAAIA,GAAWzC,EAAOzvC,MAAO,CAEzB,MAAMmyC,EAAW5kC,KAAK2M,MAAM3M,KAAKC,UAAU0kC,KACrC,MAAE9lB,EAAK,OAAEgW,GAAWqN,EAAOzvC,MAAMmiC,wBACvC,IAAIiQ,EAAgB,GAChBzB,EAAQ,GACRa,EAAmB,KACH,iBAAhBW,EAASnwC,IACTwvC,EAAmBW,EAASrS,SAAS,GACjC0R,IACAA,EAAiB1nB,EAAIsC,EAAQ,EAC7BolB,EAAiBxnB,EAAIoY,EAAS,EAC9BiI,GAAkBgB,2BAA2BmG,EAAkBW,EAASrS,WAE5EsS,EAAgBD,EAASrS,SACzB6Q,EAAQwB,EAASrS,SACZt1B,MAAM,GACN1D,IAAKykC,IAAU,CAAGtmC,OAAQusC,EAAkBtzC,OAAQqtC,OAGzDiG,EAAmBW,EACnBA,EAASroB,EAAIsC,EAAQ,EACrB+lB,EAASnoB,EAAIoY,EAAS,EACtBiI,GAAkBgB,2BAA2B8G,EAAUA,EAASrS,UAChEsS,EAAgB,CAACD,KAAaA,EAASrS,UACvC6Q,EAAQwB,EAASrS,SAASh5B,IAAKykC,IAAU,CACrCtmC,OAAQktC,EACRj0C,OAAQqtC,MAGhB,MAAMv4B,EAAY,EAClB28B,EAAY3vC,MAAQoyC,EAAc1xC,OAAO7B,GAAc,iBAATA,EAAEmD,IAChD4tC,EAAY5vC,MAAQ2wC,GACpB,IAAA0B,UAAS,KACL3B,EAASf,EAAY3vC,MAAO4vC,EAAY5vC,MAAOgT,IAEvD,MAEI28B,EAAY3vC,MAAQ,GACpB4vC,EAAY5vC,MAAQ,GACpB0wC,EAAS,GAAI,GAAI,IAEtB,CAAExjB,WAAW,KAChB,IAAA8N,WAAUrvB,UACN,IACI,MAAM1D,QAAoByF,EAAgBS,sBAAsB,QAC5DlG,EACAynC,EAAc1vC,MAAQgsC,GAAoBE,gBAAgBjkC,GAG1DxG,QAAQuK,MAAM,uEAEtB,CACA,MAAOA,GACHvK,QAAQuK,MAAM,0CAA2CA,EAC7D,CAmBA,IAjBA,IAAAoJ,OAAM,IAAM,GAAM5T,WAAY6T,IAC1B,IAAKA,EACD,OACJ,MAAM3R,EAAW2R,EAAS,IAAI,KAAK,IAAI,OACjCi9B,EAAej9B,EAAS,IAAI,IAAI,MAAQ,KAC9C,IAAIk9B,EAAiB,KACrB,GAAI7uC,GAAY2R,EAAS,GACrB,IAAK,MAAMmZ,KAASpvB,OAAOkE,OAAO+R,EAAS,IAAK,CAC5C,MAAMm9B,EAAchkB,EAAM,KAAK9qB,GAC/B,GAAI8uC,EAAa,CACbD,EAAiBC,EAAY,MAAQ,KACrC,KACJ,CACJ,CAEJ3E,GAAWH,mBAAmB,CAAEC,KAAM2E,EAAcnX,OAAQoX,KAC7D,CAAErlB,WAAW,EAAM3X,MAAM,IACxBk6B,EAAOzvC,MAAO,CACd,MAAM,MAAEosB,EAAK,OAAEgW,GAAWqN,EAAOzvC,MAAMmiC,wBACjCsQ,EAA0C,EAA1Bh/B,KAAKC,IAAI0Y,EAAOgW,GACtCtF,EAAM98B,MAAQsG,MAAMC,KAAK,CAAEa,OAAQ,KAAQ,CAAC1E,EAAGyI,KAAM,CACjDnJ,GAAImJ,EACJ2e,GAAIrW,KAAK6sB,SAAW,IAAOmS,EAAgBrmB,EAAQ,EACnDpC,GAAIvW,KAAK6sB,SAAW,IAAOmS,EAAgBrQ,EAAS,EACpDviC,EAAmB,IAAhB4T,KAAK6sB,SACRnhC,EAAmB,GAAhBsU,KAAK6sB,SAAiB,MAE7B,MAAMuQ,EAAM,EAAUpB,EAAOzvC,OACvBqxC,EAAO,IAERC,YAAY,CAAC,IAAM,KACnBt1B,GAAG,OAAQC,IACZ,EAAUwzB,EAAOzvC,OAAO0yC,OAAO,oBAAoBvmB,KAAK,YAAalQ,EAAMjJ,aAE/E69B,EAAIjxC,KAAKyxC,GAAMr1B,GAAG,gBAAiB,KACvC,CApJ2B,MAC3B,MAAM22B,EAAMlC,EAAazwC,MACzB,IAAK2yC,EACD,OACJ,IAAInE,GAAa,EACb/X,EAAU,EAAGE,EAAU,EAC3B,MAAMic,EAAevnC,IACjB,IAAKmjC,EACD,OACJ,MAAM3R,EAAY8V,EAAIE,cACtB,IAAKhW,EACD,OACJ,IAAI/S,EAAIze,EAAE0e,QAAU0M,EAChBzM,EAAI3e,EAAE4e,QAAU0M,EAEpB,MAAMmc,EAAgBjW,EAAUsF,wBAChCrY,EAAIrW,KAAKC,IAAI,EAAGD,KAAKE,IAAImW,EAAGgpB,EAAc1mB,MAAQumB,EAAIvD,cACtDplB,EAAIvW,KAAKC,IAAI,EAAGD,KAAKE,IAAIqW,EAAG8oB,EAAc1Q,OAASuQ,EAAIrD,eACvDqD,EAAI5tB,MAAM4H,KAAO,GAAG7C,MACpB6oB,EAAI5tB,MAAMqQ,IAAM,GAAGpL,OAEjB+oB,EAAY,KACd,IAAKvE,EACD,OACJA,GAAa,EACb5rB,SAASgV,oBAAoB,YAAagb,GAC1ChwB,SAASgV,oBAAoB,UAAWmb,GACxC,MAAMD,EAAgBH,EAAIE,cAAc1Q,wBAClCD,EAAOyQ,EAAIxQ,wBAEbD,EAAKvV,KAAOmmB,EAAcnmB,KADZ,GAEdgmB,EAAI5tB,MAAM4H,KAAO,OAEZmmB,EAAclmB,MAAQsV,EAAKtV,MAJlB,KAKd+lB,EAAI5tB,MAAM4H,KAAUmmB,EAAc1mB,MAAQ8V,EAAK9V,MAAQ,GAAtC,MAEjB8V,EAAK9M,IAAM0d,EAAc1d,IAPX,GAQdud,EAAI5tB,MAAMqQ,IAAM,OAEX0d,EAAcE,OAAS9Q,EAAK8Q,OAVnB,KAWdL,EAAI5tB,MAAMqQ,IAAS0d,EAAc1Q,OAASF,EAAKE,OAAS,GAAxC,OAGxBuQ,EAAIM,YAAc5nC,IACdmjC,GAAa,EACb/X,EAAUprB,EAAE0e,QAAU4oB,EAAIlb,WAC1Bd,EAAUtrB,EAAE4e,QAAU0oB,EAAIpb,UAC1B3U,SAASiV,iBAAiB,YAAa+a,GACvChwB,SAASiV,iBAAiB,UAAWkb,KAqGzCG,GAEA,MAAMC,EAAsBl3B,IACxB,MAAMm3B,EAAcxwB,SAAS2rB,cAAc,kBACvC6E,GACCA,EAAYC,SAASp3B,EAAM/d,SAC3BuyC,EAAazwC,OAAOqzC,SAASp3B,EAAM/d,UACpC4xC,EAAqB9vC,OAAQ,IAGrC4iB,SAASiV,iBAAiB,QAASsb,GAAoB,IACvD,IAAAxO,aAAY,KACR/hB,SAASgV,oBAAoB,QAASub,GAAoB,QAGlE,IAAAG,aAAY,KAE0B,iBAA9BrD,EAAgBjwC,OAAOgC,IACvB6rC,GAAWL,kBAAkB,MAiIrC,MAAM+F,EAAkBzF,IACpBD,GAAWT,aAAaU,IAE5B,MAAO,CAACjoB,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACzD,iBAAa0tB,GAAc,CACvB97B,KAAMo1B,EAAe9sC,MACrByzC,WAAYF,GACb,KAAM,EAAe,CAAC,UACzB,wBAAoB,SAAU,CAC1BrO,QAAS,eACTjY,IAAKwjB,EACL5sB,MAAO,oBACPoC,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAY2pB,EAAqB9vC,OAAS8vC,EAAqB9vC,QACpG,OAAQ,KACV8vC,EAA0B,QACpB,kBAAc,wBAAoB,MAAO,GAAY,EACpD,qBAAgB,wBAAoB,QAAS,CACzC5tC,KAAM,OACN,sBAAuB4jB,EAAO,KAAOA,EAAO,GAAMK,GAAY,EAAanmB,MAAQmmB,GACnF0C,YAAa,UACb6qB,SAAS,cAAUlD,EAAmB,CAAC,WACxC,KAAM,KAAuC,CAC5C,CAAC,aAAaX,EAAW7vC,SAE5BqwC,EAAcrwC,MAAMoH,QAAUyoC,EAAW7vC,QACnC,kBAAc,wBAAoB,KAAM,GAAY,GAClD,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYqwC,EAAcrwC,MAAQizB,KAC9E,kBAAc,wBAAoB,KAAM,CAC5C70B,IAAK60B,EAAKjxB,GACVikB,QAAUE,GAAYmqB,EAAWrd,KAClC,qBA1WX,CAACA,IACjB,MAAMvb,EAAO,GACb,IAAImb,EAAUI,EACd,KAAOJ,GAA0B,iBAAfA,EAAQ7wB,IACtB0V,EAAKsP,QAAQ6L,EAAQ5wB,MACrB4wB,EAAUqd,EAASlwC,MAAMuD,KAAK1E,GAAKA,EAAEmD,KAAO6wB,EAAQhvB,UAExD,OAAO6T,EAAKC,KAAK,QAmW2Bg8B,CAAY1gB,IAAQ,EAAqB,MAC7D,UAEN,wBAAoB,QAAQ,OAEpC,wBAAoB,QAAQ,KACjC,kBAAc,wBAAoB,MAAO,CACtCiS,QAAS,SACTjY,IAAKwiB,EACL5rB,MAAO,WACR,KAAM,MACRkpB,EAA0B,QACpB,kBAAc,iBAAa6G,GAAiB,CAC3Cx1C,IAAK,EACL60B,KAAMiC,EAAal1B,MACnB6zC,SAAS,WAAOhG,IAAYN,YAC7B,KAAM,EAAe,CAAC,OAAQ,cAC/B,wBAAoB,QAAQ,KAG9C,IEjcE,GAAa,CACfnvC,IAAK,EACLylB,MAAO,gBAEL,GAAa,CACfzlB,IAAK,EACLylB,MAAO,kBAEL,GAAa,CAAC,WAWpB,IAA6B,qBAAiB,CAC1CwB,OAAQ,eACR,KAAAM,CAAMC,GACF,MAAM6pB,GAAS,IAAAxiB,KAAI,MACb6mB,GAAY,IAAA7mB,KAAI,MAChByiB,GAAgB,IAAAziB,KAAI,MACpB0iB,GAAc,IAAA1iB,KAAI,IAClB2iB,GAAc,IAAA3iB,KAAI,IAClB4iB,GAAa,IAAA5iB,KAAI,IACjB6P,GAAQ,IAAA7P,KAAI,IACZ6iB,GAAuB,IAAA7iB,MAAI,GAC3B8mB,GAAyB,IAAA9mB,MAAI,GAC7B6f,GAAiB,IAAA/tB,UAAS,IAAM6uB,GAASd,gBACzCC,GAAuB,IAAAhuB,UAAS,IAAM6uB,GAASb,sBAC/C7X,GAAe,IAAAnW,UAAS,IAAM6uB,GAAS1Y,cACvC2X,GAAgB,IAAA9tB,UAAS,IAAM6uB,GAASf,eACxCkD,EAAW,CAAC9c,EAAMjxB,KACpB,GAAIixB,EAAKjxB,KAAOA,EACZ,OAAOixB,EACX,IAAK,MAAMsY,KAAStY,EAAK6M,SAAU,CAC/B,MAAMkQ,EAAQD,EAASxE,EAAOvpC,GAC9B,GAAIguC,EACA,OAAOA,CACf,CACA,OAAO,MAELC,GAAkB,IAAAlxB,UAAS,IACxB2wB,EAAc1vC,MAEZ+vC,EAASL,EAAc1vC,MAAO6sC,EAAc7sC,OADxC,MAGTkwC,GAAW,IAAAnxB,UAAS,KACtB,MAAMoxB,EAAQ,GAQd,OAHIT,EAAc1vC,OAJlB,SAASowC,EAASnd,GACdkd,EAAM3vC,KAAKyyB,GACXA,EAAK6M,SAASj/B,QAAQuvC,EAC1B,CAEIA,CAASV,EAAc1vC,OAEpBmwC,IAELE,GAAgB,IAAAtxB,UAAS,IACtB8wB,EAAW7vC,MAETkwC,EAASlwC,MAAMU,OAAOuyB,GAAQA,EAAKhxB,KAAKqJ,cAAc7H,SAASosC,EAAW7vC,MAAMsL,gBAAgBd,MAAM,EAAG,IADrG,IAYT8lC,EAAcrd,IAChB,MAAMvb,EAAO,GACb,IAAImb,EAAUI,EACd,KAAOJ,GAAWA,EAAQhvB,UAA2B,iBAAfgvB,EAAQ7wB,IAC1C0V,EAAKsP,QAAQ6L,GACbA,EAAUqd,EAASlwC,MAAMuD,KAAK1E,GAAKA,EAAEmD,KAAO6wB,EAAQhvB,UAEpDgvB,GACAnb,EAAKsP,QAAQ6L,GAEjB,MAAM0d,EAAa74B,EAAK5Q,IAAI4D,IAAK,CAAG1I,GAAI0I,EAAE1I,GAAIC,KAAMyI,EAAEzI,QACtD4rC,GAAWL,kBAAkB+C,GACzBtd,EAAKpvB,SACLgqC,GAAWT,aAAana,EAAKpvB,UAG7BgqC,GAAWT,aAAa,gBAE5ByC,EAAW7vC,MAAQ,IAEjBwwC,EAAoB,KAClBH,EAAcrwC,MAAMoH,OAAS,GAC7BkpC,EAAWD,EAAcrwC,MAAM,KAGjCywC,GAAe,IAAAxjB,KAAI,MAgDnB+mB,GAAuB,IAAAj1B,UAAS,KAClC,MAAMzP,EAAQ,GAAM9N,WACpB,IAAK8N,IAAUA,EAAM,GACjB,OAAO,KACX,MAAMkf,EAAQpvB,OAAOkE,OAAOgM,EAAM,IAAI/L,KAAKC,GAAuB,QAAlBA,EAAE,IAAI,KAAK,IAC3D,IAAKgrB,EACD,OAAO,KACX,MAAMrf,EAAiBqf,EAAM,IAAI,KAAK,OACtC,OAAKrf,GAAmBqf,EAAM,GAAG,MAE1BA,EAAM,GAAG,KAAKrf,IADV,OAGT8kC,GAAqB,IAAAC,UAAS,KAChC,IAAKzE,EAAOzvC,MACR,OACJ,MAAM,MAAEosB,EAAK,OAAEgW,GAAWqN,EAAOzvC,MAAMmiC,wBACvC,GAAc,IAAV/V,GAA0B,IAAXgW,EACf,OAEJ,IAAK2R,EAAuB/zC,MAAO,CAC/B,MAAMyyC,EAA0C,EAA1Bh/B,KAAKC,IAAI0Y,EAAOgW,GACtCtF,EAAM98B,MAAQsG,MAAMC,KAAK,CAAEa,OAAQ,KAAQ,CAAC1E,EAAGyI,KAAM,CACjDnJ,GAAImJ,EACJ2e,GAAIrW,KAAK6sB,SAAW,IAAOmS,EAAgBrmB,EAAQ,EACnDpC,GAAIvW,KAAK6sB,SAAW,IAAOmS,EAAgBrQ,EAAS,EACpDviC,EAAmB,IAAhB4T,KAAK6sB,SACRnhC,EAAmB,GAAhBsU,KAAK6sB,SAAiB,MAE7ByT,EAAuB/zC,OAAQ,CACnC,CACA,IAAKg0C,EAAqBh0C,MAEtB,YADA0wC,EAAS,GAAI,GAAI,GAIrB,GADAhB,EAAc1vC,MAAQgsC,GAAoBE,gBAAgB8H,EAAqBh0C,QAC1EiwC,EAAgBjwC,MAEjB,YADA0wC,EAAS,GAAI,GAAI,GAGrB,MAAMyB,EAAW5kC,KAAK2M,MAAM3M,KAAKC,UAAUyiC,EAAgBjwC,QAC3D,IAAIoyC,EAAgB,GAChBzB,EAAQ,GACZ,GAAoB,iBAAhBwB,EAASnwC,GAAuB,CAChC,MAAMmyC,EAAWhC,EAASrS,SAAS,GAC/BqU,IACAA,EAASrqB,EAAIsC,EAAQ,EACrB+nB,EAASnqB,EAAIoY,EAAS,EACtBiI,GAAkBgB,2BAA2B8I,EAAUhC,EAASrS,SAASt1B,MAAM,KAEnF4nC,EAAgBD,EAASrS,SACzB6Q,EAAQwB,EAASrS,SACZt1B,MAAM,GACN1D,IAAKykC,IAAU,CAAGtmC,OAAQkvC,EAAUj2C,OAAQqtC,IACrD,MAEI4G,EAASroB,EAAIsC,EAAQ,EACrB+lB,EAASnoB,EAAIoY,EAAS,EACtBiI,GAAkBgB,2BAA2B8G,EAAUA,EAASrS,UAChEsS,EAAgB,CAACD,KAAaA,EAASrS,UACvC6Q,EAAQwB,EAASrS,SAASh5B,IAAKykC,IAAU,CACrCtmC,OAAQktC,EACRj0C,OAAQqtC,KAGhBoE,EAAY3vC,MAAQoyC,EAAc1xC,OAAO7B,GAAc,iBAATA,EAAEmD,IAChD4tC,EAAY5vC,MAAQ2wC,GACpB,IAAA0B,UAAS,KACL3B,EAASf,EAAY3vC,MAAO4vC,EAAY5vC,MAAO,MAEpD,KA+CH,SAAS0wC,EAASP,EAAOQ,EAAO39B,GAC5B,MAAM49B,EAAc,IAAIxvC,IACxB,IAAKquC,EAAOzvC,MACR,OACJ,MAAM6wC,EAAM,EAAUpB,EAAOzvC,OACvB8wC,EAAgBD,EAAIE,UAAU,oBAAoB57B,KAAK,CAAC,OACxD67B,EAAqBF,EAAcG,QAAQC,OAAO,KAAK/kB,KAAK,QAAS,kBACrEglB,EAAIL,EAAcM,MAAMJ,GAC9BA,EACKE,OAAO,KACPH,UAAU,eACV57B,KAAK2nB,EAAM98B,OACX2X,KAAK,UACLwU,KAAK,QAAS,QACdA,KAAK,KAAOntB,GAAMA,EAAE8qB,GACpBqC,KAAK,KAAOntB,GAAMA,EAAEgrB,GACpBmC,KAAK,IAAMntB,GAAMA,EAAEa,GACnBssB,KAAK,OAAQ,SACbA,KAAK,UAAYntB,GAAMA,EAAEG,GAC9B,MAAMkyC,EAAO,IAERC,YAAY,CAAC,IAAM,KACnBt1B,GAAG,OAASC,IACbk1B,EAAEhlB,KAAK,YAAalQ,EAAMjJ,aAE9B69B,EAAIjxC,KAAKyxC,GAAMr1B,GAAG,gBAAiB,MACnC60B,EACKU,aACAzhC,SAAS,KACTlQ,KAAKyxC,EAAKr+B,UAAWA,GAC1B,MAAMyG,EAAI,IAAgB3J,SAAS,KAC7B0hC,EAAmBrB,EAAM5sC,KAAK1E,GAAKA,EAAEmD,KAAO6qC,EAAc7sC,QAAUmwC,EAAM,GAChF,GAAIqB,EAAkB,CAClB,MAAMC,EAAYtB,EACbzvC,OAAO7B,GAAKA,EAAEmD,KAAOwvC,EAAiBxvC,IACtC8E,IAAIjI,IACL,MAAM8vC,GAAM9vC,EAAEirB,GAAK,IAAM0nB,EAAiB1nB,GAAK,GACzC8kB,GAAM/vC,EAAEmrB,GAAK,IAAMwnB,EAAiBxnB,GAAK,GAC/C,OAAOvW,KAAK+sB,KAAKmO,EAAKA,EAAKC,EAAKA,KAE/BluC,OAAO1B,GAAKA,EAAI,GACrBmyC,EAAEJ,UAAU,qBACP57B,KAAKs8B,GACL95B,KAAMs5B,GAAUA,EAChBC,OAAO,UACP/kB,KAAK,QAAS,cACdA,KAAK,KAAMqlB,EAAiB1nB,GAAK,GACjCqC,KAAK,KAAMqlB,EAAiBxnB,GAAK,GACjCmC,KAAK,IAAK,GACVA,KAAK,OAAQ,QACbA,KAAK,SAAU,4BACfvsB,KAAMqxC,GAAUA,EAAMM,WAAW93B,GAAG0S,KAAK,IAAMntB,GAAMA,IAAMyiC,GAAWA,EAAO7hC,KAAM6hC,GAAWA,EAC9F8P,WAAW93B,GACX0S,KAAK,KAAMqlB,EAAiB1nB,GAAK,GACjCqC,KAAK,KAAMqlB,EAAiBxnB,GAAK,GACjCmC,KAAK,IAAMntB,GAAMA,IAAM0yC,GAASA,EAAK9xC,KAAM8xC,GAASA,EAAKH,WAAW93B,GAAG0S,KAAK,IAAK,GAAGoT,UAC7F,CACA4R,EAAEJ,UAAU,aACP57B,KAAKw7B,EAAQ3xC,GAAM,GAAGA,EAAEiG,OAAOjD,MAAMhD,EAAEd,OAAO8D,MAC9C2V,KAAMs5B,GAAUA,EAChBC,OAAO,QACP/kB,KAAK,QAAS,QACdA,KAAK,SAAU,QACfA,KAAK,iBAAkB,GACvBA,KAAK,KAAOntB,GAAMA,EAAEiG,OAAO6kB,GAAK,GAChCqC,KAAK,KAAOntB,GAAMA,EAAEiG,OAAO+kB,GAAK,GAChCmC,KAAK,KAAOntB,GAAMA,EAAEd,OAAO4rB,GAAK,GAChCqC,KAAK,KAAOntB,GAAMA,EAAEd,OAAO8rB,GAAK,GAChCpqB,KAAMqxC,GAAUA,EAAMM,WAAW93B,GAAG0S,KAAK,iBAAkB,KAAQsV,GAAWA,EAAO7hC,KAAM6hC,GAAWA,EACtG8P,WAAW93B,GACX0S,KAAK,KAAOntB,GAAMA,EAAEiG,OAAO6kB,GAAK,GAChCqC,KAAK,KAAOntB,GAAMA,EAAEiG,OAAO+kB,GAAK,GAChCmC,KAAK,KAAOntB,GAAMA,EAAEd,OAAO4rB,GAAK,GAChCqC,KAAK,KAAOntB,GAAMA,EAAEd,OAAO8rB,GAAK,IAAM0nB,GAASA,EAAK9xC,KAAM8xC,GAASA,EAAKH,WAAW93B,GAAG0S,KAAK,iBAAkB,GAAGoT,WACrH,MAAMoS,EAAaR,EAAEJ,UAAU,gBAAgB57B,KAAKg7B,EAAQnxC,GAAMA,EAAEgD,IAC9D4vC,EAAYD,EACbV,QACAC,OAAO,KACP/kB,KAAK,QAAS,cACdioB,QAAQ,kBAAoBp1C,GAAMA,EAAEgD,KAAO4rC,GAASZ,gBACpDoH,QAAQ,kBAAoBp1C,GAAMA,EAAEgD,KAAO4rC,GAASX,kBACpD9gB,KAAK,YAAcntB,GAAM,aAAaA,EAAE8qB,GAAK,KAAK9qB,EAAEgrB,GAAK,MACzDmC,KAAK,UAAW,GACrBylB,EACKV,OAAO,UACP/kB,KAAK,IAAMntB,GAAMA,EAAE4tC,QACnBzgB,KAAK,OAASntB,GAAM6qC,GAAaO,SAASprC,EAAEkD,OAC5CiqB,KAAK,SAAWntB,GAAM,EAAS6qC,GAAaO,SAASprC,EAAEkD,QAAQ2vC,SAAS,KAAK7vB,YAAc,QAC3FmK,KAAK,eAAgB,GAC1BylB,EACKV,OAAO,QACPjrC,KAAMjH,GAAMA,EAAEiD,MACdkqB,KAAK,cAAe,UACpBA,KAAK,KAAOntB,GAAMA,EAAE4tC,OAAS,IAC7BzgB,KAAK,OAAQ,SACbpH,MAAM,YAAa,QACxB4sB,EACKP,MAAMQ,GACN51B,GAAG,QAAS,SAAUC,EAAOjd,GAC9B,MAAM8yC,EAAkBlB,EAAYrxC,IAAIP,EAAEgD,IAC1C,GAAI8vC,EACAC,aAAaD,GACblB,EAAYoB,OAAOhzC,EAAEgD,IACrB6rC,GAAWjX,WAAW53B,OAErB,CACD,MAAMizC,EAAa/vB,OAAOnS,WAAW,KAC7B/Q,EAAE2tC,WAAa,EACfkB,GAAWX,eAAeluC,GAG1B6uC,GAAWjX,WAAW53B,GAE1B4xC,EAAYoB,OAAOhzC,EAAEgD,KACtB,KACH4uC,EAAYpuC,IAAIxD,EAAEgD,GAAIiwC,EAC1B,CACJ,GACKV,WAAW93B,GACX0S,KAAK,YAAcntB,GAAM,aAAaA,EAAE8qB,GAAK,KAAK9qB,EAAEgrB,GAAK,MACzDmC,KAAK,UAAW,GACrBwlB,EAAWD,OAAOH,WAAW93B,GAAG0S,KAAK,UAAW,GAAGoT,QACvD,EAxKA,IAAAnqB,OAAM4+B,EAAsBC,EAAoB,CAAE/mB,WAAW,KAC7D,IAAA9X,OAAMy3B,EAAeoH,IACrB,IAAA7+B,OAAM,IAAM,GAAM5T,WAAY6T,IAC1B,IAAKA,EACD,OACJ,MAAM3R,EAAW2R,EAAS,IAAI,KAAK,IAAI,OACjCi9B,EAAej9B,EAAS,IAAI,IAAI,MAAQ,KAC9C,IAAIk9B,EAAiB,KACrB,GAAI7uC,GAAY2R,EAAS,GACrB,IAAK,MAAMmZ,KAASpvB,OAAOkE,OAAO+R,EAAS,IAAK,CAC5C,MAAMm9B,EAAchkB,EAAM,KAAK9qB,GAC/B,GAAI8uC,EAAa,CACbD,EAAiBC,EAAY,MAAQ,KACrC,KACJ,CACJ,CAEJ3E,GAAWH,mBAAmB,CAAEC,KAAM2E,EAAcnX,OAAQoX,KAC7D,CAAEh9B,MAAM,EAAM2X,WAAW,KAC5B,IAAA8N,WAAU,KAxIqB,MAC3B,MAAM2X,EAAMlC,EAAazwC,MACzB,IAAK2yC,EACD,OACJ,IAAInE,GAAa,EACb/X,EAAU,EAAGE,EAAU,EAC3B,MAAMic,EAAevnC,IACjB,IAAKmjC,EACD,OACJ,MAAM3R,EAAY8V,EAAIE,cACtB,IAAKhW,EACD,OACJ,IAAI/S,EAAIze,EAAE0e,QAAU0M,EAChBzM,EAAI3e,EAAE4e,QAAU0M,EACpB,MAAMmc,EAAgBjW,EAAUsF,wBAChCrY,EAAIrW,KAAKC,IAAI,EAAGD,KAAKE,IAAImW,EAAGgpB,EAAc1mB,MAAQumB,EAAIvD,cACtDplB,EAAIvW,KAAKC,IAAI,EAAGD,KAAKE,IAAIqW,EAAG8oB,EAAc1Q,OAASuQ,EAAIrD,eACvDqD,EAAI5tB,MAAM4H,KAAO,GAAG7C,MACpB6oB,EAAI5tB,MAAMqQ,IAAM,GAAGpL,OAEjB+oB,EAAY,KACd,IAAKvE,EACD,OACJA,GAAa,EACb5rB,SAASgV,oBAAoB,YAAagb,GAC1ChwB,SAASgV,oBAAoB,UAAWmb,GACxC,MAAMD,EAAgBH,EAAIE,cAAc1Q,wBAClCD,EAAOyQ,EAAIxQ,wBAEbD,EAAKvV,KAAOmmB,EAAcnmB,KADZ,GAEdgmB,EAAI5tB,MAAM4H,KAAO,OACZmmB,EAAclmB,MAAQsV,EAAKtV,MAHlB,KAId+lB,EAAI5tB,MAAM4H,KAAUmmB,EAAc1mB,MAAQ8V,EAAK9V,MAAQ,GAAtC,MACjB8V,EAAK9M,IAAM0d,EAAc1d,IALX,GAMdud,EAAI5tB,MAAMqQ,IAAM,OACX0d,EAAcE,OAAS9Q,EAAK8Q,OAPnB,KAQdL,EAAI5tB,MAAMqQ,IAAS0d,EAAc1Q,OAASF,EAAKE,OAAS,GAAxC,OAExBuQ,EAAIM,YAAc5nC,IACdmjC,GAAa,EACb/X,EAAUprB,EAAE0e,QAAU4oB,EAAIlb,WAC1Bd,EAAUtrB,EAAE4e,QAAU0oB,EAAIpb,UAC1B3U,SAASiV,iBAAiB,YAAa+a,GACvChwB,SAASiV,iBAAiB,UAAWkb,KA8FzCG,GACA,MAAMC,EAAsBl3B,IACxB,MAAMm3B,EAAcxwB,SAAS2rB,cAAc,kBACvC6E,GACCA,EAAYC,SAASp3B,EAAM/d,SAC3BuyC,EAAazwC,OAAOqzC,SAASp3B,EAAM/d,UACpC4xC,EAAqB9vC,OAAQ,IAGrC4iB,SAASiV,iBAAiB,QAASsb,GAAoB,GACvD,MAAMkB,EAAW,IAAIC,eAAe,KAChCL,MAEAH,EAAU9zC,OACVq0C,EAASE,QAAQT,EAAU9zC,QAE/B,IAAA2kC,aAAY,KACR/hB,SAASgV,oBAAoB,QAASub,GAAoB,GAC1DkB,EAASG,kBAGjB,IAAAlB,aAAY,KAC0B,iBAA9BrD,EAAgBjwC,OAAOgC,IACvB6rC,GAAWL,kBAAkB,MA8HrC,MAAM+F,EAAkBzF,IACpBD,GAAWT,aAAaU,IAE5B,MAAO,CAACjoB,EAAMC,MACF,kBAAc,wBAAoB,MAAO,CAC7CjC,MAAO,iBACPqhB,QAAS,YACTjY,IAAK6mB,GACN,EACC,iBAAaN,GAAc,CACvB97B,KAAMo1B,EAAe9sC,MACrByzC,WAAYF,GACb,KAAM,EAAe,CAAC,UACzB,wBAAoB,SAAU,CAC1BrO,QAAS,eACTjY,IAAKwjB,EACL5sB,MAAO,oBACPoC,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAY2pB,EAAqB9vC,OAAS8vC,EAAqB9vC,QACpG,OAAQ,KACV8vC,EAA0B,QACpB,kBAAc,wBAAoB,MAAO,GAAY,EACpD,qBAAgB,wBAAoB,QAAS,CACzC5tC,KAAM,OACN,sBAAuB4jB,EAAO,KAAOA,EAAO,GAAMK,GAAY,EAAanmB,MAAQmmB,GACnF0C,YAAa,UACb6qB,SAAS,cAAUlD,EAAmB,CAAC,WACxC,KAAM,KAAuC,CAC5C,CAAC,aAAaX,EAAW7vC,SAE5BqwC,EAAcrwC,MAAMoH,QAAUyoC,EAAW7vC,QACnC,kBAAc,wBAAoB,KAAM,GAAY,GAClD,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYqwC,EAAcrwC,MAAQizB,KAC9E,kBAAc,wBAAoB,KAAM,CAC5C70B,IAAK60B,EAAKjxB,GACVikB,QAAUE,GAAYmqB,EAAWrd,KAClC,qBApWX,CAACA,IACjB,MAAMvb,EAAO,GACb,IAAImb,EAAUI,EACd,KAAOJ,GAA0B,iBAAfA,EAAQ7wB,IACtB0V,EAAKsP,QAAQ6L,EAAQ5wB,MACrB4wB,EAAUqd,EAASlwC,MAAMuD,KAAK1E,GAAKA,EAAEmD,KAAO6wB,EAAQhvB,UAExD,OAAO6T,EAAKC,KAAK,QA6V2Bg8B,CAAY1gB,IAAQ,EAAqB,MAC7D,UAEN,wBAAoB,QAAQ,OAEpC,wBAAoB,QAAQ,KACjC,kBAAc,wBAAoB,MAAO,CACtCiS,QAAS,SACTjY,IAAKwiB,EACL5rB,MAAO,WACR,KAAM,MACRkpB,EAA0B,QACpB,kBAAc,iBAAa6G,GAAiB,CAC3Cx1C,IAAK,EACL60B,KAAMiC,EAAal1B,MACnB6zC,SAAS,WAAOhG,IAAYN,YAC7B,KAAM,EAAe,CAAC,OAAQ,cAC/B,wBAAoB,QAAQ,IACnC,KAEX,ICraSkH,GAA+B,CAC1C3kB,UAAW,CACTxoB,UAAW,CAAE2jB,UAAWypB,GAAgB9kC,MAAO,QAC/C3L,UAAW,CAAEgnB,UAAW0pB,GAAgB/kC,MAAO,QAC/Cqc,OAAQ,CAAEhB,UAAW2pB,GAAahlC,MAAO,QACzCgpB,SAAU,CAAE3N,UAAW4pB,GAAejlC,MAAO,QAC7CklC,aAAc,CAAE7pB,UAAW8pB,GAAmBnlC,MAAO,SACrDolC,QAAS,CAAE/pB,UCzBK,GDyBoBrb,MAAO,SAE7CmgB,YAAa,CACXzoB,UAAW,CAAE2jB,UAAWgqB,GAAsBrlC,MAAO,QACrD3L,UAAW,CAAEgnB,UAAWiqB,GAAsBtlC,MAAO,QACrDulC,MAAO,CAAElqB,UAAWmqB,GAAkBxlC,MAAO,QAC7CklC,aAAc,CAAE7pB,UAAW8pB,GAAmBnlC,MAAO,UACrDolC,QAAS,CAAE/pB,UAAWoqB,GAAoBzlC,MAAO,WAEnD0lC,cAAe,CACbC,KAAM,CAAEtqB,UAAWuqB,GAAoB5lC,MAAO,OAEhD6lC,UAAW,CACTC,aAAc,CAAEzqB,UAAW0qB,GAAmB/lC,MAAO,SAEvDwqB,QAAS,CACPwb,OAAQ,CAAE3qB,UAAW4qB,GAAmBjmC,MAAO,WAEjDkmC,OAAQ,CACNC,SAAU,CAAE9qB,UAAW+qB,GAAapmC,MAAO,QEyHxC,MAAMqmC,GAAqB,IApKlC,MACUC,aAAoC,KACpCC,YAAkC,KAClCC,aAAuC,IAAIh1C,IAC5Ci1C,SAA8C,KACrD,UAAAhc,CAAW8b,GACT,IAAI51C,KAAK21C,cAAiBC,EAA1B,CAEA51C,KAAK41C,YAAcA,EACnB51C,KAAK21C,aAAe,IAAI,EAAa31C,KAAK41C,aAG1C51C,KAAK+1C,kBAAkB,YAAaC,IACpC,IAAK,MAAM/nB,KAASimB,GAClB,IAAK,MAAMnG,KAASmG,GAAcjmB,GAAQ,CACxC,MAAMgoB,EAAgB,GAAGhoB,KAAS8f,IAAQhjC,cACpCmrC,EAAYhC,GAAcjmB,GAAO8f,GACvC/tC,KAAK+1C,kBAAkBE,EAAeC,EAAUxrB,UAClD,CAGF/I,OAAO2V,iBAAiB,SAAU,IAAMt3B,KAAKm2C,eAfA,CAmB/C,CAEO,UAAAC,CAAWh6B,GAChB,GAAKpc,KAAK21C,aACV,IACE31C,KAAK21C,aAAaS,WAAWh6B,EAC/B,CAAE,MAAOtR,GACP5J,QAAQuK,MAAM,yBAA0BX,GAExC,IACE9K,KAAK21C,aAAaS,WAAWp2C,KAAKq2C,mBACpC,CAAE,MAAOC,GACPp1C,QAAQuK,MAAM,6CAA8C6qC,EAC9D,CACF,CACF,CAIA,eAAAC,GACOv2C,KAAK21C,cAEV31C,KAAK21C,aAAaS,WAAWp2C,KAAKq2C,mBACpC,CAEA,iBAAAN,CAAkBE,EAAuBvrB,GACnC1qB,KAAK61C,aAAa3zC,IAAI+zC,KAG1Bj2C,KAAK61C,aAAa5zC,IAAIg0C,EAAevrB,GAErC1qB,KAAK21C,cAAcI,kBAAkBE,EAAe,CAAC3Z,EAA+Bka,KAClF,MAAMC,GAAe,IAAAxP,iBAAgB,CACnC7hB,MAAO,IAAM,KAAM,IAAAsxB,GAAEhsB,EAAW8rB,GAAgB94C,OAAS,CAAC,KAEtDi5C,GAAQ,IAAAD,GAAED,IAChB,IAAAtV,QAAOwV,EAAOra,EAAUsa,cAGnBJ,GAAwBnnC,OAC3BitB,EAAUua,SAAUL,EAAuBnnC,OAI5CitB,EAAkB7gB,GAAG,UAAW,KAC/B,MAAMq7B,EAAWN,GAAwBM,QACrCA,GACFv7B,GAASO,KAAK,cAAeg7B,OAIrC,CAEA,SAAAC,CAAUD,EAAiBznC,EAAe4mC,EAAuBv4C,EAA6B,CAAC,GAC7F,IAAKsC,KAAK21C,aAER,YADAz0C,QAAQuK,MAAM,kCAIEzL,KAAK61C,aAAa72C,IAAIi3C,GAMxCj2C,KAAK21C,aAAaqB,aAAaf,EAAe,CAAE5mC,QAAO3R,QAAOo5C,WAAWA,GAJvE51C,QAAQuK,MAAM,cAAcwqC,wBAKhC,CAEA,YAAAE,GACMn2C,KAAK21C,cAAgB31C,KAAK41C,aAC5B51C,KAAK21C,aAAasB,WAAWj3C,KAAK41C,YAAYjZ,YAAa38B,KAAK41C,YAAYhZ,aAEhF,CAEA,cAAAsa,GACE,IAAKl3C,KAAK21C,cAAcwB,SAAU,OAGZn3C,KAAK21C,aAAawB,SAASC,aAAaj3C,OAAQgrB,GAAcA,EAAKksB,YAE3E/2C,QAAS6qB,IACrB,IACEA,EAAK6T,QACP,CAAE,MAAOl0B,GACP5J,QAAQuK,MAAM,+BAAgC0f,EAAMrgB,EACtD,GAEJ,CAEA,OAAAw2B,GACMthC,KAAK21C,eACP31C,KAAK21C,aAAarU,UAClBthC,KAAK21C,aAAe,MAEtB31C,KAAK61C,aAAaz0C,QAClBugB,OAAO0V,oBAAoB,SAAU,OACvC,CAEA,cAAAigB,GACOt3C,KAAK21C,cAEV31C,KAAK21C,aAAaS,WAAWp2C,KAAKq2C,mBAEpC,CAEQ,gBAAAA,GACN,MAAO,CACLpoC,KAAM,CACJtM,KAAM,MACN8D,QAAS,CACP,CACE9D,KAAM,YACN41C,cAAe,YACfloC,MAAO,MACPgoC,YAAY,KAKtB,CAEO,mBAAAG,GACL,MAAO,CACLvpC,KAAM,CACJtM,KAAM,MACN8D,QAAS,CACP,CACE9D,KAAM,YACN41C,cAAe,YACfloC,MAAO,MACPgoC,YAAY,EACZxrB,MAAO,OAKjB,GCnKK,SAAS4rB,KAiBd,MAAO,CAAEV,UAhBS,CAAC9oB,EAAmC8f,EAAerwC,EAA6B,CAAC,KACjG,MAAMw4C,EAAYhC,GAAcjmB,KAAS8f,GACzC,GAAImI,EAAW,CACb,MAAMY,EAAU,GAAG7oB,KAAS8f,KAASrwC,EAAM28B,UAAY,KAAKtvB,cACtDkrC,EAAgB,GAAGhoB,KAAS8f,IAAQhjC,cAG1C2qC,GAAmBK,kBAAkBE,EAAeC,EAAUxrB,WAE9D,MAAMgtB,EAAa,CAAE3O,UAAW9a,KAAUvwB,GAC1Cg4C,GAAmBqB,UAAUD,EAASZ,EAAU7mC,MAAO4mC,EAAeyB,GAEtEn8B,GAASO,KAAK,cAAe,CAAEmS,QAAO8f,QAAOrwC,QAAOo5C,WACtD,GAIJ,CChBA,MCCA,IDD6B,qBAAiB,CAC1ChyB,OAAQ,cACR,KAAAM,CAAMC,GACF,MAAMsyB,GAAW,IAAAjrB,KAAI,MAqBrB,OApBA,IAAA+N,WAAU,KACN,GAAIkd,EAASl4C,MAAO,CAChBi2C,GAAmB5b,WAAW6d,EAASl4C,OAEvC,IAAK,MAAMwuB,KAAS,EAAAimB,cAChB,IAAK,MAAMnG,KAAS,EAAAmG,cAAcjmB,GAAQ,CACtC,MAAMioB,EAAY,EAAAhC,cAAcjmB,GAAO8f,GACjCkI,EAAgB,GAAGhoB,KAAS8f,IAClC2H,GAAmBK,kBAAkBE,EAAeC,EAAUxrB,UAClE,CAGJgrB,GAAmBK,kBAAkB,YAAaC,IAElDN,GAAmBa,iBACvB,KAEJ,IAAAqB,iBAAgB,KACZlC,GAAmBpU,YAEhB,CAAChc,EAAMC,MACF,kBAAc,wBAAoB,MAAO,CAC7Cof,QAAS,WACTjY,IAAKirB,EACLr0B,MAAO,qBACR,KAAM,KAEjB,IEnCE,GAAa,CAAEA,MAAO,mBACtB,GAAa,CAAEA,MAAO,mBACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,mBAEL,GAAa,CAAEA,MAAO,iBACtB,GAAa,CAAEzlB,IAAK,GACpB,GAAa,CAAEylB,MAAO,OACtB,GAAa,CAAEA,MAAO,0BACtB,GAAa,CAAEA,MAAO,iBAE5B,IAA6B,qBAAiB,CAC1CwB,OAAQ,mBACRpnB,MAAO,CACH+N,MAAO,CAAC,GAEZ,KAAA2Z,CAAMC,GACF,MAAM3nB,EAAQ2nB,EACRwyB,EAAO,CACT,kCACA,wCACA,iCACA,uCACA,iCACA,4BACA,kCACA,+BAEEC,GAAY,IAAAprB,KAAI,IAChByI,GAAW,IAAAzI,KAAI,GACrB,IAAI+V,EAAmB,KA4BvB,SAASsV,IACDtV,IACA7kB,cAAc6kB,GACdA,EAAmB,KAE3B,CACA,OAjCA,IAAAhI,WAAU,KACD/8B,EAAM+N,QAcXqsC,EAAUr4C,MAAQo4C,EAAK3kC,KAAKijB,MAAMjjB,KAAK6sB,SAAW8X,EAAKhxC,SAEvDsuB,EAAS11B,MAAQ,EACjBgjC,EAAmB9gB,OAAOjE,YAAY,KAC9ByX,EAAS11B,MAAQ,GACjB01B,EAAS11B,OAAS,EAGlBs4C,KAEL,IAAQ,QApBf,IAAA3T,aAAY,KACR2T,OAEJ,IAAAljC,OAAM,IAAMnX,EAAM+N,MAAOusC,IACjBA,GACAD,MAuBD,CAACzyB,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACzD,wBAAoB,MAAO,GAAY,CAClCF,EAAa,QACP,kBAAc,wBAAoB,MAAO,GAAY,CACpDE,EAAO,KAAOA,EAAO,IAAK,wBAAoB,KAAM,CAAEjC,MAAO,eAAiB,QAAS,KACvF,wBAAoB,IAAK,IAAY,qBAAiB+B,EAAQ5Z,OAAQ,GACtE8Z,EAAO,KAAOA,EAAO,IAAK,wBAAoB,IAAK,CAAEjC,MAAO,aAAe,iBAAkB,SAE9F,kBAAc,wBAAoB,MAAO,GAAY,EACpD,wBAAoB,IAAK,IAAY,qBAAiBw0B,EAAUr4C,OAAQ,IACxE,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,MAAO,CACvB6jB,MAAO,eACPkB,OAAO,oBAAgB,CAAEqH,MAAOsJ,EAAS11B,MAAQ,OAClD,KAAM,MAEb,wBAAoB,OAAQ,GAAY,CACpC8lB,EAAO,KAAOA,EAAO,IAAK,wBAAoB,OAAQ,CAAEjC,MAAO,aAAe,MAAO,KACrF,qBAAiB,WAAY,qBAAiBpQ,KAAKijB,MAAMhB,EAAS11B,QAAU,IAAK,YAM7G,ICpFJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjE,GAAa,CAAE6jB,MAAO,0BACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,sBAEL,GAAa,CAAEA,MAAO,YACtB,GAAa,CAAEA,MAAO,cACtB,GAAa,CAAEA,MAAO,YACtB,GAAa,CAAEA,MAAO,gBACtB,GAAa,CAAEA,MAAO,mBACtB,GAAa,CACfzlB,IAAK,EACLylB,MAAO,WAIX,IAA6B,qBAAiB,CAC1CwB,OAAQ,eACRpnB,MAAO,CACHqH,QAAS,CAAC,GAEd,KAAAqgB,CAAMC,GACF,MAAM3nB,EAAQ2nB,EACR5G,GAAO,IAAAD,UAAS,IACXF,GAAW25B,eAAev6C,EAAMqH,UAE3C,MAAO,CAACugB,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,CACxD9G,EAAKhf,MAAMoH,OAAS,IACd,kBAAc,wBAAoB,MAAO,GAAY,EACpD,wBAAoB,KAAM,GAAY,GACjC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAY4X,EAAKhf,MAAQqf,KACrE,kBAAc,wBAAoB,KAAM,CAC5CjhB,IAAKihB,EAAI,GAAG,GACZwE,MAAO,YACR,EACC,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,OAAQ,IAAY,qBAAiBxE,EAAI,GAAG,IAAK,IACrE,wBAAoB,OAAQ,IAAY,qBAAiBA,EAAI,GAAG1H,KAAK,OAAQ,MAEjF,wBAAoB,IAAK,IAAY,qBAAiB0H,EAAI,MAAO,OAErE,aAGT,kBAAc,wBAAoB,MAAO,GAAY,IAAKyG,EAAO,KAAOA,EAAO,GAAK,EAC/E,wBAAoB,IAAK,KAAM,qBAAsB,UAI7E,IC5CJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCNjE,GAA+B2yB,E,eCGrC,IAAIC,GAAoE,CAAC,EAgGlE,MAAMC,GAAoB,CAE/BC,SAvDF,WACE,MAAMC,EAtBR,WACE,MAAMC,EAAUvwC,OAAOqa,SAASm2B,qBAAqB,UACrD,IAAK,IAAI5tC,EAAI,EAAGA,EAAI2tC,EAAQ1xC,OAAQ+D,IAClC,GAAI2tC,EAAQ3tC,GAAG6tC,gBAAkB92B,OAAQ,CACvC,MAAM+2B,EAASH,EAAQ3tC,GACvB,GAAI8tC,EAAOj3C,GACT,MAAO,IAAIi3C,EAAOj3C,KAEpB,MAAMk3C,EAAMD,EAAOE,aAAa,OAChC,GAAID,EAAK,CACP,MAAME,EAAcF,EAAIzuC,MAAM,KAAKkE,MACnC,GAAIyqC,EACF,MAAO,gBAAgBA,KAE3B,CACA,OAAO,IACT,CAEF,OAAO,IACT,CAGyBC,GACvB,IAAKR,EAEH,YADAp3C,QAAQuM,KAAK,6BAIf,MAAMsrC,EAA0D,CAC9D,CAACT,GAAiB,CAChB5rC,SAAU,QACVmoB,IAAK,IACLzI,KAAM,IACNP,MAAO,QACPgW,OAAQ,QACRmX,OAAQ,QACRC,OAAQ,OACRC,aAAc,KAEhB,uBAAwB,CAAEC,QAAS,QACnC,4BAA6B,CAAEA,QAAS,QACxC,WAAY,CAAEA,QAAS,QACvB,QAAS,CAAEtX,OAAQ,QAASuX,UAAW,SACvC,0BAA2B,CAAED,QAAS,SAGxChB,GAAiB,CAAC,EAClB,IAAK,MAAMkB,KAAYN,EAAkB,CACvC,MAAMO,EAAW,KAAED,EAAUrxC,OAAOqa,UACpC,GAAIi3B,EAASzyC,OAAS,EAAG,CACvBsxC,GAAekB,GAAY,CAAC,EAC5B,MAAME,EAAYR,EAAiBM,GACnC,IAAK,MAAMn6C,KAAQq6C,EACjBpB,GAAekB,GAAUn6C,GAAQo6C,EAASE,IAAIt6C,GAEhDo6C,EAASE,IAAID,EACf,CACF,CACA,KAAEvxC,OAAOqa,SAASo3B,iBAAiBC,SAAS,yBAC5C,KAAE1xC,OAAOqa,SAASI,MAAMi3B,SAAS,wBACnC,EAiBEC,QAfF,WACE,IAAK,MAAMN,KAAYlB,GAAgB,CACrC,MAAMmB,EAAW,KAAED,EAAUrxC,OAAOqa,UAChCi3B,EAASzyC,OAAS,GACpByyC,EAASE,IAAIrB,GAAekB,GAEhC,CACAlB,GAAiB,CAAC,EAClB,KAAEnwC,OAAOqa,SAASo3B,iBAAiBG,YAAY,yBAC/C,KAAE5xC,OAAOqa,SAASI,MAAMm3B,YAAY,wBACtC,EAOEC,cAjGF,WACM,YACF,WAEA34C,QAAQuM,KAAK,kBAEjB,EA4FEqsC,gBA1FF,SAAmCn+B,GAC7B,aACF,KAAc,SAAU,KACtBA,EAAS,iBAGf,EAqFE,uBAAIo+B,GACF,OAAO,aAAwB,cACjC,GCnGI,IAAQ,IAAA/qC,UAAwB,CACpC6L,WAAW,EACXxL,MAAO,GACP3R,MAAO,CAAEqH,QAAS,MAePi1C,GAAkB,CAC7BjrC,MAAK,GACLK,KAdYrK,IACZ,GAAMsK,MAAQ,SACd,GAAM3R,MAAQ,CAAEqH,WAGhB,GAAM8V,WAAY,GAUlBpL,KAPW,KACX,GAAMoL,WAAY,ICRd,IAAQ,IAAA7L,UAAkB,CAC9BirC,iBAAiB,EACjBF,qBAAqB,IAIvB3B,GAAkB0B,gBAAgBI,IAE5B,GAAMH,sBAAwBG,GAEhC3uC,aAAa0O,gBAAgB,GAAI,CAAEC,QAAS,QAE9C,GAAM6/B,oBAAsBG,IAI9B,MAAM,GAAU,CAId,uBAAAC,GAEEzE,GAAmBwB,iBACnBjc,GAAoBxrB,OACpBkb,GAAmBlb,OACnBuqC,GAAgBvqC,OAChB6L,GAAkB7L,OAElB2oC,GAAkByB,eACpB,EAKA,mBAAAO,GACE,MAAMC,GAAsB,GAAMJ,gBAClC,GAAMA,gBAAkBI,EAEpBA,EACFjC,GAAkBC,WAElBD,GAAkBuB,UAGpBp+B,GAASO,KAAK,oBAAqBu+B,EACrC,EAKA,cAAA/C,GACE5B,GAAmB4B,gBACrB,GAIWgD,IAAU,IAAAj/B,UAAS,IACnBk/B,GAAY,GCvEnB,GAAa,CAAEj3B,MAAO,cACtB,GAAa,CAAEA,MAAO,eACtB,GAAa,CAAEA,MAAO,6BACtB,GAAa,CAAEA,MAAO,iBACtB,GAAa,CAAEA,MAAO,mBACtB,GAAa,CAAEA,MAAO,iBACtB,GAAa,CAAC,SACd,GAAa,CAAEA,MAAO,gBACtB,GAAa,CAAEA,MAAO,2BAO5B,IAA6B,qBAAiB,CAC1CwB,OAAQ,eACR,KAAAM,CAAMC,GACF,MAAM00B,GAAsB,IAAAv7B,UAAS,IAAM87B,GAAQP,sBAC7C,UAAEhD,GAAcU,KAChB+C,EAAmB,KACrBD,GAAUJ,0BACVI,GAAUH,uBAERK,EAAoB,KACtB1D,EAAU,SAAU,aAElB2D,EAAiB,KACft/B,GAAgBP,UAChBS,GAAkB7L,OAGlB6L,GAAkBlM,QAGpBurC,GAAkB,IAAAn8B,UAAS,IACtBu7B,EAAoBt6C,MAAQ,OAAS,SAE1Cm7C,GAAiB,IAAAp8B,UAAS,IACrBu7B,EAAoBt6C,MAAQ,kBAAoB,iBAE3D,MAAO,CAAC6lB,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACzD,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,OAAQ,IAAY,sBAAiB,WAAOsE,IAAaxa,OAAQ,IACrF,wBAAoB,OAAQ,IAAY,sBAAiB,WAAOwa,IAAaE,SAAU,QAG/F,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,SAAU,CAC1BrE,QAAS+0B,EACTn3B,MAAO,kBACPjU,MAAO,QACR,IAAKkW,EAAO,KAAOA,EAAO,GAAK,EAC1B,wBAAoB,IAAK,CAAEjC,MAAO,cAAgB,MAAO,QAEjE,wBAAoB,SAAU,CAC1BoC,QAASg1B,EACTp3B,MAAO,kBACPjU,MAAO,QACR,IAAKkW,EAAO,KAAOA,EAAO,GAAK,EAC1B,wBAAoB,IAAK,CAAEjC,MAAO,mBAAqB,MAAO,QAEtE,wBAAoB,SAAU,CAC1BoC,QAAS80B,EACTl3B,MAAO,kBACPjU,MAAOsrC,EAAgBl7C,OACxB,EACC,wBAAoB,IAAK,CACrB6jB,OAAO,oBAAgBs3B,EAAen7C,QACvC,KAAM,IACV,EAAe,KAClB,wBAAoB,SAAU,CAC1BimB,QAASH,EAAO,KAAOA,EAAO,GAE1B,IAAIxJ,KAAU,WAAO,IAAS3B,mBAAoB,WAAO,IAASA,oBAAoB2B,IAC1FuH,MAAO,kBACPjU,MAAO,MACR,IAAKkW,EAAO,KAAOA,EAAO,GAAK,EAC1B,wBAAoB,IAAK,CAAEjC,MAAO,eAAiB,MAAO,UAGtE,wBAAoB,MAAO,GAAY,EACnC,wBAAoB,MAAO,IAAY,sBAAiB,WAAO0G,KAAgB,OAI/F,IClFJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjE,GAAa,CAAE1G,MAAO,sBACtB,GAAa,CAAEA,MAAO,cACtB,GAAa,CAAEA,MAAO,eAG5B,IAA6B,qBAAiB,CAC1CwB,OAAQ,mBACRpnB,MAAO,CACHqrC,UAAW,CAAC,GAEhB,KAAA3jB,CAAMC,GACF,MAAM3nB,EAAQ2nB,GACR,UAAE0jB,IAAc,IAAArD,QAAOhoC,GACvBmQ,GAAY,IAAA2Q,UAAS,IACI,SAApBuqB,EAAUtpC,MAAmB,MAAQ,QAE1Co7C,GAAa,IAAAr8B,UAAS,IACG,SAApBuqB,EAAUtpC,MAAmB,EAAAq7C,iBAAA,MAAyB,iBAEjE,MAAO,CAACx1B,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACzD,wBAAoB,OAAQ,IAAY,qBAAiB1X,EAAUpO,OAAQ,IAC3E,wBAAoB,OAAQ,IAAY,qBAAiBo7C,EAAWp7C,OAAQ,KAGxF,ICnBJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjEs7C,GAAoB,iDACpBC,GAAwB,qDAyEvB,MAAMC,GAAgB,IAhE7B,MACUC,aAAwC,IAAIr6C,IAC5Cs6C,iBAA4C,IAAIt6C,IAChDq5C,cAAe,EAEvB,WAAAt6B,GACE5f,KAAKo7C,iBACL7/B,GAASE,GAAG,cAAgB1M,GAAsB/O,KAAKq7C,SAAStsC,IAChEwM,GAASE,GAAG,cAAgBq7B,GAAoB92C,KAAKs7C,YAAYxE,IACjEv7B,GAASE,GAAG,oBAAsBy+B,GAA0Bl6C,KAAKu7C,uBAAuBrB,GAC1F,CAEQ,cAAAkB,GACN,IACE,MAAMI,EAAczgC,aAAa1F,QAAQ0lC,IACrCS,IAAax7C,KAAKk7C,aAAe,IAAIr6C,IAAImM,KAAK2M,MAAM6hC,KAExD,MAAMC,EAAkB1gC,aAAa1F,QAAQ2lC,IACzCS,IAAiBz7C,KAAKm7C,iBAAmB,IAAIt6C,IAAImM,KAAK2M,MAAM8hC,IAClE,CAAE,MAAO3wC,GACP5J,QAAQuK,MAAM,gCAAiCX,EACjD,CACF,CAEQ,eAAA4wC,GACF17C,KAAKk6C,aACPn/B,aAAa1D,QAAQ2jC,GAAuBhuC,KAAKC,UAAUlH,MAAMC,KAAKhG,KAAKm7C,iBAAiB92C,aAE5F0W,aAAa1D,QAAQ0jC,GAAmB/tC,KAAKC,UAAUlH,MAAMC,KAAKhG,KAAKk7C,aAAa72C,YAExF,CAEO,QAAAg3C,CAAStsC,GACd,MAAM4sC,EAAa37C,KAAKk6C,aAAel6C,KAAKm7C,iBAAmBn7C,KAAKk7C,aAC/DS,EAAWz5C,IAAI6M,EAAM+nC,WACxB6E,EAAW15C,IAAI8M,EAAM+nC,QAAS/nC,GAC9B/O,KAAK07C,kBAET,CAEO,WAAAJ,CAAYxE,GACjB,MAAM6E,EAAa37C,KAAKk6C,aAAel6C,KAAKm7C,iBAAmBn7C,KAAKk7C,aAChES,EAAWz5C,IAAI40C,KACjB6E,EAAWlK,OAAOqF,GAClB92C,KAAK07C,kBAET,CAEQ,sBAAAH,CAAuBrB,GAC7Bl6C,KAAKk6C,aAAeA,EACpBl6C,KAAK47C,eACP,CAEO,aAAAA,GACL,MAAMC,EAAkB77C,KAAKk6C,aAAel6C,KAAKm7C,iBAAmBn7C,KAAKk7C,aACzEh6C,QAAQC,IAAI,wCAAwCnB,KAAKk6C,aAAe,aAAe,4BACvF3+B,GAASO,KAAK,gBAAiB/V,MAAMC,KAAK61C,EAAgB94C,UAC5D,CAEO,yBAAA+4C,CAA0B5B,GAC/Bl6C,KAAKk6C,aAAeA,CACtB,GClDF,IAAe,IAAAjT,iBAAgB,CAC3BvlC,KAAM,MACNq6C,WAAY,CACRC,YAAW,GACXC,iBAAgB,GAChBC,iBAAgB,GAChBC,aAAY,GACZC,aAAY,GACZC,iBAAgB,GAChBC,eAAc,GACdC,sBAAqB,GACrBC,YAAW,GACXC,kBAAiB,IAErB,KAAAr3B,GACI,MAAM,UAAE2xB,GAAcU,KAChBiF,GAAe,IAAAl+B,UAAS,IAAMyc,GAAoBlsB,OAClD4tC,GAAc,IAAAn+B,UAAS,IAAMmM,GAAmB5b,OAChD6tC,GAAW,IAAAp+B,UAAS,IAAMw7B,GAAgBjrC,OAC1CkrC,GAAkB,IAAAz7B,UAAS,IAAM87B,GAAQL,iBACzC4C,GAAa,IAAAr+B,UAAS,IAAMpD,IAC5B0hC,GAAuB,IAAApwB,MAAI,GAC3BqwB,GAAmB,IAAArwB,MAAI,GACvBswB,GAAiB,IAAAtwB,MAAI,GACrB9sB,GAAW,IAAA8sB,KAAI,IACf3H,GAAe,IAAAvG,UAAS,IAAM5e,EAASH,MAAMoH,QAC7Co2C,EAAc,CAChBjI,KAAM,CACF,CAAEvzC,GAAI,YAAa4nB,KAAM,IAAK3jB,KAAM,KAAMigB,OAAQ,IAAMoxB,EAAU,YAAa,cAC/E,CAAEt1C,GAAI,YAAa4nB,KAAM,IAAK3jB,KAAM,KAAMigB,OAAQ,IAAMoxB,EAAU,YAAa,cAC/E,CAAEt1C,GAAI,SAAU4nB,KAAM,IAAK3jB,KAAM,KAAMigB,OAAQ,IAAMoxB,EAAU,YAAa,WAC5E,CAAEt1C,GAAI,eAAgB4nB,KAAM,IAAK3jB,KAAM,KAAMigB,OAAQ,IAAMoxB,EAAU,YAAa,iBAClF,CAAEt1C,GAAI,UAAW4nB,KAAM,IAAK3jB,KAAM,KAAMigB,OAAQ,IAAMoxB,EAAU,YAAa,aAEjFnc,OAAQ,CACJ,CACIn5B,GAAI,mBACJ4nB,KAAM,IACN3jB,KAAM,KACNigB,OAAQ,IAAMoxB,EAAU,cAAe,cAE3C,CACIt1C,GAAI,mBACJ4nB,KAAM,IACN3jB,KAAM,KACNigB,OAAQ,IAAMoxB,EAAU,cAAe,cAE3C,CACIt1C,GAAI,eACJ4nB,KAAM,IACN3jB,KAAM,KACNigB,OAAQ,IAAMoxB,EAAU,cAAe,UAE3C,CACIt1C,GAAI,sBACJ4nB,KAAM,IACN3jB,KAAM,KACNigB,OAAQ,IAAMoxB,EAAU,cAAe,iBAE3C,CACIt1C,GAAI,iBACJ4nB,KAAM,IACN3jB,KAAM,KACNigB,OAAQ,IAAMoxB,EAAU,cAAe,aAG/CpjB,OAAQ,CACJ,CAAElyB,GAAI,WAAY4nB,KAAM,IAAK3jB,KAAM,KAAMigB,OAAQ,IAAMoxB,EAAU,YAAa,aAC9E,CAAEt1C,GAAI,gBAAiB4nB,KAAM,IAAK3jB,KAAM,KAAMigB,OAAQ,IAAMoxB,EAAU,gBAAiB,SACvF,CAAEt1C,GAAI,eAAgB4nB,KAAM,IAAK3jB,KAAM,KAAMigB,OAAQ,IAAMoxB,EAAU,YAAa,mBASpFj/B,EAAe1M,MAAO8xC,IACxBh8C,QAAQC,IAAI,oBAAqB+7C,SAC3B,GAAQplC,aAAaolC,SACrB7iC,GAAgBmH,mBAapB27B,EAAiB,KACnBv9C,EAASH,MAAQE,EAAec,eAiDpC,OA9BA,IAAAg6B,WAAU,KACN,MAAMkd,EAAWt1B,SAAS+6B,eAAe,OACrCzF,EACAjC,GAAmB5b,WAAW6d,GAG9Bz2C,QAAQuK,MAAM,gCAElB,GAAQ+L,cACR,GAAQ+C,2BACRm7B,GAAmBI,SAAWh+B,EAC9BnY,EAAeG,UAAUq9C,GACzBA,IAEA5hC,GAASE,GAAG,gBAAkB4hC,IAC1B,MAAM,UAAEtG,GAAcU,KACtB/B,GAAmBwB,iBACnBmG,EAAO/8C,QAAQg9C,IACX,IACIvG,EAAUuG,EAAWrvB,MAAOqvB,EAAWvP,MAAOuP,EAAW5/C,OAAS,CAAC,EACvE,CACA,MAAOoN,GACH5J,QAAQuK,MAAM,4BAA4B6xC,EAAWrvB,SAASqvB,EAAWvP,QAASjjC,EACtF,MAIRmwC,GAAca,0BAA0BxB,GAAQL,iBAChDgB,GAAcW,kBAEX,CACHc,eACAC,cACAC,WACA3C,kBACA4C,aACAvhC,kBAAiB,GACjB2hC,cACAnlC,eACAylC,aAtEiBnyC,MAAO8xC,IAExB,MAAMM,EAAWX,EAAWp9C,MAAMqb,WAClCQ,GAAkBJ,sBAAsBsiC,SAClC1lC,EAAaolC,GACnB5hC,GAAkB7L,OAClB6L,GAAkBH,cAiElBsiC,mBAlFuB,KACnBZ,EAAWp9C,MAAMob,WACjBS,GAAkB7L,QAiFtBzG,MAAK,GACLiyB,oBAAmB,GACnBtQ,mBAAkB,GAClBqvB,gBAAe,GACf8C,uBACAY,kBArEsB,KACtBZ,EAAqBr9C,OAASq9C,EAAqBr9C,OAqEnDs9C,mBACAY,cA9DkB,KAClBZ,EAAiBt9C,OAASs9C,EAAiBt9C,MACvCs9C,EAAiBt9C,QACjBu9C,EAAev9C,OAAQ,IA4D3Bm+C,mBArDwBhyC,IACxB0P,GAAkBL,SAASrP,GAC3BmxC,EAAiBt9C,OAAQ,GAoDzBu9C,iBACAa,mBA5DuB,KACvBb,EAAev9C,OAASu9C,EAAev9C,MACnCu9C,EAAev9C,QACfs9C,EAAiBt9C,OAAQ,IA0D7BG,WACAmlB,eACArkB,cAvEkB,KAClBf,EAAee,iBAwEvB,ICxLJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,SxHiCpD,SAAgB4kB,EAAMC,EAAQsiB,EAAQC,EAAQC,EAAOC,GACxD,MAAM8V,GAA0B,sBAAkB,gBAC5CC,GAAyB,sBAAkB,eAC3CC,GAA8B,sBAAkB,oBAChDC,GAA0B,sBAAkB,gBAC5CC,GAAyB,sBAAkB,eAC3CC,GAA8B,sBAAkB,oBAChDC,GAA+B,sBAAkB,qBACjDC,GAAmC,sBAAkB,yBAC3D,OAAQ,kBAAc,wBAAoB,MAAO,CAC7C/6B,OAAO,oBAAgB,CAAC,uBAAwB,CAAE,iBAAkBgC,EAAK20B,oBAC1E,EACC,iBAAa6D,IACb,wBAAoB,MAAOz6B,GAAY,EACnC,iBAAa06B,MAEjB,wBAAoB,+BACnBz4B,EAAKo3B,aAAsB,YACrB,kBAAc,wBAAoB,MAAO,CACxC7+C,IAAK,EACLylB,MAAO,gBACPoC,QAASH,EAAO,KAAOA,EAAO,IAAK,mBAAgBK,GAAYN,EAAK2V,oBAAoBxrB,OAAS,CAAC,WACnG,EACC,wBAAoB,MAAO8T,GAAY,EACnC,wBAAoB,KAAMC,IAAY,qBAAiB8B,EAAKo3B,aAAartC,OAAQ,IACjF,wBAAoB,IAAKoU,IAAY,qBAAiB6B,EAAKo3B,aAAaptC,SAAU,IAClF,wBAAoB,MAAOoU,GAAY,EACnC,wBAAoB,SAAU,CAC1BgC,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAYN,EAAK2V,oBAAoBxrB,SAC1E,OACH,wBAAoB,SAAU,CAC1B6T,MAAO,UACPoC,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAYN,EAAK2V,oBAAoB5Z,YAC1E,cAIb,wBAAoB,QAAQ,IAClC,wBAAoB,yBACnBiE,EAAKq3B,YAAqB,YACpB,kBAAc,wBAAoB,MAAO,CACxC9+C,IAAK,EACLylB,MAAO,gBACPoC,QAASH,EAAO,KAAOA,EAAO,IAAK,mBAAgBK,GAAYN,EAAKqF,mBAAmBlb,OAAS,CAAC,WAClG,EACC,wBAAoB,MAAOkU,GAAY,EACnC,wBAAoB,MAAOC,GAAY,EACnC,wBAAoB,KAAMC,IAAY,qBAAiByB,EAAKq3B,YAAYttC,OAAQ,IAChF,wBAAoB,SAAU,CAC1BiU,MAAO,eACPoC,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAYN,EAAKqF,mBAAmBlb,SACzE,QAEP,wBAAoB,MAAOqU,GAAY,GAClC,kBAAc,kBAAa,6BAAyBwB,EAAKq3B,YAAYjyB,YAAY,qBAAgB,wBAAoBpF,EAAKq3B,YAAYj/C,QAAS,KAAM,aAIhK,wBAAoB,QAAQ,GACjC4nB,EAAKtc,MAAkB,eACjB,kBAAc,iBAAag1C,EAA6B,CACvDngD,IAAK,EACL4N,MAAO6Z,EAAKtc,MAAMwL,iBACnB,KAAM,EAAe,CAAC,YACvB,wBAAoB,QAAQ,IAClC,wBAAoB,2BACnB8Q,EAAKs3B,SAAkB,YACjB,kBAAc,wBAAoB,MAAO,CACxC/+C,IAAK,EACLylB,MAAO,gBACPoC,QAASH,EAAO,KAAOA,EAAO,IAAK,mBAAgBK,GAAYN,EAAK00B,gBAAgBvqC,OAAS,CAAC,WAC/F,EACC,wBAAoB,MAAOsU,GAAa,EACpC,wBAAoB,MAAOC,GAAa,EACpC,wBAAoB,KAAMC,IAAa,qBAAiBqB,EAAKs3B,SAASvtC,OAAQ,IAC9E,wBAAoB,SAAU,CAC1BiU,MAAO,eACPoC,QAASH,EAAO,KAAOA,EAAO,GAAMK,GAAYN,EAAK00B,gBAAgBvqC,SACtE,QAEP,wBAAoB,MAAOyU,GAAa,EACpC,iBAAa+5B,GAAyB,qBAAgB,wBAAoB34B,EAAKs3B,SAASl/C,QAAS,KAAM,YAIjH,wBAAoB,QAAQ,IAClC,wBAAoB,wBACnB4nB,EAAKu3B,WAAoB,YACnB,kBAAc,wBAAoB,MAAO14B,GAAa,EACrD,wBAAoB,MAAOC,GAAa,EACpC,wBAAoB,MAAOC,GAAa,CACnCiB,EAAyB,uBACnB,kBAAc,iBAAa44B,EAAwB,CAClDrgD,IAAK,EACL,gBAAiBynB,EAAKP,aACtB,eAAgBO,EAAK23B,YAAYjI,KACjC,iBAAkB1vB,EAAK23B,YAAYriB,OACnC,iBAAkBtV,EAAK23B,YAAYtpB,OACnC2qB,gBAAiBh5B,EAAKq4B,cACtBY,iBAAkBj5B,EAAKu4B,oBACxB,KAAM,EAAe,CAAC,gBAAiB,eAAgB,iBAAkB,iBAAkB,kBAAmB,uBAC/G,wBAAoB,QAAQ,IAClC,wBAAoB,MAAOv5B,GAAa,EACpC,iBAAa65B,EAA6B,CACtCK,eAAgBl5B,EAAKi4B,aACrBkB,oBAAqBn5B,EAAKo4B,mBAC3B,KAAM,EAAe,CAAC,iBAAkB,0BAE9Cp4B,EAAqB,mBACf,kBAAc,iBAAa84B,EAA8B,CACxDvgD,IAAK,EACLy1C,QAAShuB,EAAKq4B,cACde,cAAep5B,EAAKs4B,oBACrB,KAAM,EAAe,CAAC,UAAW,oBAClC,wBAAoB,QAAQ,GACjCt4B,EAAmB,iBACb,kBAAc,wBAAoB,MAAOf,GAAa,EACrD,wBAAoB,MAAOE,GAAa,CACpCc,EAAO,KAAOA,EAAO,IAAK,wBAAoB,KAAM,KAAM,QAAS,KACnE,wBAAoB,SAAU,CAC1BjC,MAAO,qBACPoC,QAASH,EAAO,KAAOA,EAAO,GAE1B,IAAIxJ,IAAUuJ,EAAKu4B,oBAAsBv4B,EAAKu4B,sBAAsB9hC,KACzE,QAEP,wBAAoB,MAAO2I,GAAa,CACnCY,EAAKP,aAAe,IACd,kBAAc,wBAAoB,MAAOJ,GAAa,GACpD,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAYW,EAAK1lB,SAAU,CAACipB,EAAKnZ,MAC7E,kBAAc,wBAAoB,MAAO,CAC7C7R,IAAK6R,EACL4T,MAAO,iBACR,qBAAiBuF,GAAM,KAC1B,WAEL,kBAAc,wBAAoB,MAAOjE,GAAa,eAEhEU,EAAKP,aAAe,IACd,kBAAc,wBAAoB,MAAOF,GAAa,EACrD,wBAAoB,SAAU,CAC1BvB,MAAO,eACPoC,QAASH,EAAO,KAAOA,EAAO,GAE1B,IAAIxJ,IAAUuJ,EAAK5kB,eAAiB4kB,EAAK5kB,iBAAiBqb,KAC/D,cAEL,wBAAoB,QAAQ,OAEpC,wBAAoB,QAAQ,WAI5C,wBAAoB,QAAQ,IAClC,iBAAasiC,IACd,EACP,KyHlMM,GAAa,CAAE/6B,MAAO,kBACtB,GAAa,CAAEA,MAAO,kBACtB,GAAa,CAAEA,MAAO,mBAC5B,IAA6B,qBAAiB,CAC1CwB,OAAQ,mBACRpnB,MAAO,CACHgE,KAAM,CAAC,EACPjC,MAAO,CAAC,GAEZ2lB,MAAMC,GACK,CAACC,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACzD,wBAAoB,OAAQ,IAAY,qBAAiBF,EAAQ3jB,MAAO,IACxE,wBAAoB,OAAQ,IAAY,qBAAiB2jB,EAAQ5lB,OAAQ,QCPzF,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjE,GAAa,CAAE6jB,MAAO,mBACtB,GAAa,CAAEA,MAAO,iBACtB,GAAa,CACf7hB,GAAI,uBACJ6hB,MAAO,mBAEL,GAAa,CAAEA,MAAO,iBACtB,GAAa,CACf7hB,GAAI,4BACJ6hB,MAAO,mBAEL,GAAa,CAAEA,MAAO,iBACtB,GAAa,CACf7hB,GAAI,cACJ6hB,MAAO,mBAEL,GAAa,CAAEA,MAAO,iBACtB,GAAa,CACf7hB,GAAI,cACJ6hB,MAAO,mBAEL,GAAc,CAAEA,MAAO,iBACvB,GAAc,CAChB7hB,GAAI,eACJ6hB,MAAO,mBAEL,GAAc,CAAEA,MAAO,iBACvB,GAAc,CAChB7hB,GAAI,gBACJ6hB,MAAO,mBAEL,GAAc,CAAEA,MAAO,iBACvB,GAAc,CAChB7hB,GAAI,iBACJ6hB,MAAO,mBAEL,GAAc,CAAEA,MAAO,kBACvB,GAAc,CAAEA,MAAO,mBAG7B,IAA6B,qBAAiB,CAC1CwB,OAAQ,gBACR,KAAAM,CAAMC,GACF,MAAM,UAAEte,EAAS,oBAAE43C,EAAmB,aAAEC,EAAY,kBAAEC,EAAiB,YAAEC,EAAW,UAAEC,EAAS,WAAEC,EAAU,iBAAEC,GAAsB,EAAAC,QAC7HC,EAAiBN,EAAkB93C,GACnCq4C,EAAWN,EAAY/3C,GACvB2kB,EAASqzB,EAAUh4C,GACnBs4C,EAAU,EAAAH,QAAA,WAAmBn4C,GAC7Bu4C,EAAgBL,EAAiBl4C,GACvC,MAAO,CAACue,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACzD,wBAAoB,MAAO,GAAY,CACnCA,EAAO,KAAOA,EAAO,IAAK,wBAAoB,MAAO,CAAEjC,MAAO,iBAAmB,QAAS,KAC1F,wBAAoB,MAAO,GAAY,GAClC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,iBAAY,WAAO67B,GAAgB1/C,MAAO,CAACmsB,EAAM/tB,MAC7F,kBAAc,iBAAa0hD,GAAkB,CACjD1hD,IAAKA,EACL6D,KAAMyY,OAAOtc,GACb4B,MAAO,GAAGmsB,EAAK,OAAOA,EAAK,OAC5B,KAAM,EAAe,CAAC,OAAQ,YACjC,WAGZ,wBAAoB,MAAO,GAAY,CACnCrG,EAAO,KAAOA,EAAO,IAAK,wBAAoB,MAAO,CAAEjC,MAAO,iBAAmB,QAAS,KAC1F,wBAAoB,MAAO,GAAY,EACnC,iBAAai8B,GAAkB,CAC3B79C,KAAM,KACNjC,MAAO,MAAK,WAAOk/C,GAAqB,MACzC,KAAM,EAAe,CAAC,WACzB,iBAAaY,GAAkB,CAC3B79C,KAAM,KACNjC,OAAO,WAAOk/C,GAAqB,IACpC,KAAM,EAAe,CAAC,eAGjC,wBAAoB,MAAO,GAAY,CACnCp5B,EAAO,KAAOA,EAAO,IAAK,wBAAoB,MAAO,CAAEjC,MAAO,iBAAmB,QAAS,KAC1F,wBAAoB,MAAO,GAAY,GAClC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,iBAAY,WAAO87B,GAAU3/C,MAAO,CAAC+/C,EAAS3hD,MAC1F,kBAAc,iBAAa0hD,GAAkB,CACjD1hD,IAAKA,EACL6D,KAAMyY,OAAOtc,GACb4B,MAAO,GAAG+/C,EAAQ,SAASA,EAAQ,WACpC,KAAM,EAAe,CAAC,OAAQ,YACjC,WAGZ,wBAAoB,MAAO,GAAY,CACnCj6B,EAAO,KAAOA,EAAO,IAAK,wBAAoB,MAAO,CAAEjC,MAAO,iBAAmB,SAAU,KAC3F,wBAAoB,MAAO,GAAY,GAClC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,iBAAY,WAAOoI,GAAQjsB,MAAO,CAACqsB,EAAOjuB,MACtF,kBAAc,iBAAa0hD,GAAkB,CACjD1hD,IAAKA,EACL6D,KAAMyY,OAAOtc,GACb4B,MAAO,MAAMqsB,EAAM,QAAQA,EAAM,OAClC,KAAM,EAAe,CAAC,OAAQ,YACjC,WAGZ,wBAAoB,MAAO,GAAa,CACpCvG,EAAO,KAAOA,EAAO,IAAK,wBAAoB,MAAO,CAAEjC,MAAO,iBAAmB,SAAU,KAC3F,wBAAoB,MAAO,GAAa,GACnC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,iBAAY,WAAO+7B,GAAU,CAACI,EAAQ/vC,MAClF,kBAAc,iBAAa6vC,GAAkB,CACjD1hD,IAAK6R,EACLhO,KAAM+9C,EAAO,GACbhgD,MAAOggD,EAAO,IACf,KAAM,EAAe,CAAC,OAAQ,YACjC,WAGZ,wBAAoB,MAAO,GAAa,CACpCl6B,EAAO,KAAOA,EAAO,IAAK,wBAAoB,MAAO,CAAEjC,MAAO,iBAAmB,QAAS,KAC1F,wBAAoB,MAAO,GAAa,GACnC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,iBAAY,WAAOs7B,GAAe,CAACc,EAAQhwC,MACvF,kBAAc,iBAAa6vC,GAAkB,CACjD1hD,IAAK6R,EACLhO,KAAMg+C,EAAO,GACbjgD,MAAOigD,EAAO,KACf,KAAM,EAAe,CAAC,OAAQ,YACjC,WAGZ,wBAAoB,MAAO,GAAa,CACpCn6B,EAAO,KAAOA,EAAO,IAAK,wBAAoB,MAAO,CAAEjC,MAAO,iBAAmB,QAAS,KAC1F,wBAAoB,MAAO,GAAa,GACnC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,iBAAY,WAAOg8B,GAAe7/C,MAAO,CAAC+G,EAAK9E,MAC3F,kBAAc,wBAAoB,MAAO,CAC7C7D,IAAK6D,EACL4hB,MAAO,kBACR,EACC,wBAAoB,OAAQ,IAAa,qBAAiB5hB,GAAO,IACjE,wBAAoB,OAAQ,GAAa,QAAS,qBAAiB8E,EAAI,IAAM,QAAS,qBAAiBA,EAAI,IAAK,OAEpH,YAKxB,ICtIJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjE,GAAa,CAAE8c,MAAO,mBACtB,GAAa,CAAEA,MAAO,iBACtB,GAAa,CAAEA,MAAO,kBACtB,GAAa,CAAEA,MAAO,aACtB,GAAa,CAAEA,MAAO,iBAE5B,IAA6B,qBAAiB,CAC1CwB,OAAQ,gBACR,KAAAM,CAAMC,GACF,MAAM3hB,GAAY,IAAAgpB,KAAI,IAStB,OARA,IAAA+N,WAAU,KAEN/2B,EAAUjE,MAAQ,CACd,CAAEgC,GAAI,UAAWC,KAAM,QAASi+C,SAAU,GAC1C,CAAEl+C,GAAI,WAAYC,KAAM,YAAai+C,SAAU,GAC/C,CAAEl+C,GAAI,WAAYC,KAAM,WAAYi+C,SAAU,MAG/C,CAACr6B,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACzD,wBAAoB,MAAO,GAAY,CACnCA,EAAO,KAAOA,EAAO,IAAK,wBAAoB,MAAO,CAAEjC,MAAO,iBAAmB,QAAS,KAC1F,wBAAoB,MAAO,GAAY,GAClC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAY5f,EAAUjE,MAAQ0rB,KAC1E,kBAAc,wBAAoB,MAAO,CAC7CttB,IAAKstB,EAAK1pB,GACV6hB,MAAO,kBACR,EACC,wBAAoB,MAAO,IAAY,qBAAiB6H,EAAKzpB,MAAO,IACpE,wBAAoB,MAAO,GAAY,KAAM,qBAAiBypB,EAAKw0B,UAAW,OAElF,YAKxB,IC9BJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjE,GAAa,CAAEr8B,MAAO,qBACtB,GAAa,CAAC,aACd,GAAa,CAAC,aAIpB,IAA6B,qBAAiB,CAC1CwB,OAAQ,kBACRK,MAAO,CAAC,iBACR,KAAAC,CAAMC,GAAWvJ,KAAMyM,IACnB,MAAMzM,EAAOyM,EACPq3B,GAAU,IAAA5wC,UAAS,CACrB41B,SAAS,EACTn/B,QAAS,GACT+e,MAAO,CACHqQ,IAAK,MACLzI,KAAM,SAGRyzB,GAAqB,IAAArhC,UAAS,KAChC,IAAI9Y,EAAO+kB,GAAkBhrB,MAU7B,OANAiG,EAAOA,EAAK6G,QAFM,sCAEa,CAAChI,EAAO7C,EAAM+D,IAClC,8DAA8D/D,MAAS+D,YAElFC,EAAOA,EAAK6G,QAJK,oCAIa,CAAChI,EAAO7C,EAAM+D,IACjC,4DAA4D/D,MAAS+D,YAEzEC,IAELo6C,EAAmBpkC,IACrB,MAAM/d,EAAS+d,EAAM/d,OACfoiD,EAAWpiD,EAAO+wC,QAAQ/sC,KAC1Bq+C,EAAWriD,EAAO+wC,QAAQhtC,KAChC,IAAKq+C,IAAaC,EACd,OACJ,IAAIj+C,EACa,SAAbg+C,EACAh+C,GAAS,IAAAk+C,eAAcD,GAEL,QAAbD,IACLh+C,GAAS,IAAAm+C,cAAaF,IAEtBj+C,IACA69C,EAAQn6C,QAAU06C,EAAqBp+C,EAAQg+C,GAC/CH,EAAQp7B,MAAMqQ,IAAM,GAAGnZ,EAAMgO,QAAU,OACvCk2B,EAAQp7B,MAAM4H,KAAO,GAAG1Q,EAAM8N,QAAU,OACxCo2B,EAAQhb,SAAU,IAGpBwb,EAAiB,KACnBR,EAAQhb,SAAU,GAEhBub,EAAuB,CAACp+C,EAAQJ,IACrB,SAATA,EACO,sCACYI,EAAO,OAAOA,EAAO,qDACfA,EAAO,kDACTA,EAAO,iBAGrB,QAATJ,EACO,sCACYI,EAAO,oDACDA,EAAO,uDACNA,EAAO,GAAGqV,KAAK,oBAGtC,GAELmmC,EAAgB53B,IAClB7J,EAAK,gBAAiB6J,IAE1B,MAAO,CAACL,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACzD,wBAAoB,MAAO,CACvBjC,MAAO,sBACP8lB,UAAWyW,EAAmBpgD,MAC9B4gD,YAAaP,EACbQ,WAAYF,GACb,KAAM,GAAgC,KACzC,iBAAanE,GAAkB,CAC3B3zB,YAAa,WACbk2B,eAAgBjB,KAEpB,wBAAoB,aACnBqC,EAAe,UACT,kBAAc,wBAAoB,MAAO,CACxC/hD,IAAK,EACLylB,MAAO,oBACPkB,OAAO,oBAAgBo7B,EAAQp7B,OAC/B4kB,UAAWwW,EAAQn6C,SACpB,KAAM,GAAuB,MAC9B,wBAAoB,QAAQ,KAG9C,IC5FJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjE,GAAa,CAAE6d,MAAO,kBACtB,GAAa,CAAEA,MAAO,iBACtB,GAAa,CAAEA,MAAO,YACtB,GAAa,CAAEA,MAAO,YACtB,GAAa,CAAEA,MAAO,oBAE5B,IAA6B,qBAAiB,CAC1CwB,OAAQ,cACR,KAAAM,CAAMC,GACF,MAAM5G,GAAO,IAAAiO,KAAI,IASjB,OARA,IAAA+N,WAAU,KAGNhc,EAAKhf,MAAQ,CACT,CAAEgC,GAAI,qBAAsBC,KAAM,QAAS6+C,aAAc,IACzD,CAAE9+C,GAAI,gBAAiBC,KAAM,QAAS6+C,aAAc,OAGrD,CAACj7B,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACzD,wBAAoB,MAAO,GAAY,CACnCA,EAAO,KAAOA,EAAO,IAAK,wBAAoB,MAAO,CAAEjC,MAAO,iBAAmB,UAAW,KAC5F,wBAAoB,MAAO,GAAY,GAClC,gBAAW,IAAO,wBAAoB,WAAW,MAAM,gBAAY7E,EAAKhf,MAAQqf,KACrE,kBAAc,wBAAoB,MAAO,CAC7CjhB,IAAKihB,EAAIrd,GACT6hB,MAAO,YACR,EACC,wBAAoB,MAAO,IAAY,qBAAiBxE,EAAIpd,MAAO,IACnE,wBAAoB,MAAO,GAAY,SAAU,qBAAiBod,EAAIyhC,cAAe,OAEzF,YAKxB,IC9BJ,IAFiC,QAAgB,GAAQ,CAAC,CAAC,YAAY,qBCJjE,GAAa,CAAEj9B,MAAO,qBACtB,GAAa,CAAEA,MAAO,iBACtB,GAAa,CAAEA,MAAO,cAG5B,IAA6B,qBAAiB,CAC1CwB,OAAQ,iBACR,KAAAM,CAAMC,GACF,MAAMpkB,GAAa,IAAAyrB,KAAI,MACjB8zB,GAAc,IAAAhiC,UAAS,KACzB,IAAKvd,EAAWxB,MACZ,MAAO,GACX,MAAMwqB,EAAOhpB,EAAWxB,MAAM,KAC9B,MAAO,GAAGwqB,EAAK,KAAKA,EAAK,KAAKA,EAAK,KAAKA,EAAK,KAAKA,EAAK,MAAMA,EAAK,QAoBtE,OAlBA,IAAAwQ,WAAU,KAENx5B,EAAWxB,MAAQ,CACf,KAAM,CACF,EAAG,KACH,EAAG,EACH,EAAG,EACH,EAAG,EACH,EAAG,EACH,GAAI,MAER,GAAI,IACJ,GAAI,IACJ,GAAI,GACJ,KAAM,IACN,KAAM,aAGP,CAAC6lB,EAAMC,MACF,kBAAc,wBAAoB,MAAO,GAAY,EACzD,wBAAoB,MAAO,GAAY,CACnCA,EAAO,KAAOA,EAAO,IAAK,wBAAoB,MAAO,CAAEjC,MAAO,iBAAmB,QAAS,KAC1F,wBAAoB,MAAO,GAAY,EACnC,iBAAai8B,GAAkB,CAC3B79C,KAAM,OACNjC,MAAO+gD,EAAY/gD,OACpB,KAAM,EAAe,CAAC,WACzB,iBAAa8/C,GAAkB,CAC3B79C,KAAM,KACNjC,MAAOwB,EAAWxB,OAAO,IAAM,OAChC,KAAM,EAAe,CAAC,WACzB,iBAAa8/C,GAAkB,CAC3B79C,KAAM,KACNjC,MAAOwB,EAAWxB,OAAO,IAAM,OAChC,KAAM,EAAe,CAAC,WACzB,iBAAa8/C,GAAkB,CAC3B79C,KAAM,KACNjC,MAAO,GAAGwB,EAAWxB,OAAO,IAAM,WACnC,KAAM,EAAe,CAAC,WACzB,iBAAa8/C,GAAkB,CAC3B79C,KAAM,OACNjC,MAAOwB,EAAWxB,OAAO,MAAQ,GAClC,KAAM,EAAe,CAAC,WACzB,iBAAa8/C,GAAkB,CAC3B79C,KAAM,OACNjC,MAAOwB,EAAWxB,OAAO,MAAQ,OAClC,KAAM,EAAe,CAAC,gBAK7C,IC1DEghD,GAA2B,CAC/B,CAAEtpC,KAAM,IAAKuT,UAAWg2B,IACxB,CAAEvpC,KAAM,aAAcuT,UAAWi2B,IACjC,CAAExpC,KAAM,YAAauT,UAAWk2B,IAChC,CAAEzpC,KAAM,aAAcuT,UAAWm2B,IACjC,CAAE1pC,KAAM,eAAgBuT,WCTO,QAAgB,GAAQ,CAAC,CAAC,YAAY,uBDYjEo2B,IAAS,KAAAC,cAAa,CAC1BC,SAAS,KAAAC,uBACTR,YAIFK,GAAOv0C,QAAQ,KAEf2rC,EAAE,MACA,IAAAgJ,WAAU,IAAKC,IAAIL,IAAQM,MAAM,UEVnC,GAAQ5pC,cAGRtH,EAAeC,SAAS,kBAAmBkK,IAC3CnK,EAAeC,SAAS,kBAAmBiL,IAC3ClL,EAAeC,SAAS,oBAAqBmL,IAC7CpL,EAAeC,SAAS,QAAS,IACjCD,EAAeC,SAAS,UAAW,IAGnC,MAAMkxC,IAAU,IAAAxsC,OACd,IAAM,GAAMX,QACZA,IACMA,IACFhT,QAAQC,IAAI,qEAWlBiK,iBACE,IAAK,GAAMnK,WAET,YADAC,QAAQuK,MAAM,uGAGV6S,GAAWI,uCACX/d,EAAmBK,WAAW,GAAMC,YAE1CC,QAAQC,IAAI,6BAmBd,WAEE,GAAsB,SADA4Z,aAAa1F,QAAQ,yCACb,CAC5BnU,QAAQC,IAAI,uDACZ,MAAMmgD,EAAYvmC,aAAa1F,QAAQ,0CACnCisC,IACFhmC,GAAkBL,SAASqmC,GAC3BhmC,GAAkBlM,QAEpB2L,aAAahE,WAAW,wCAC1B,CACF,CA7BEwqC,GAGAnkC,GAAeG,aAAa,OAG5B,IAAA1I,OACE,IAAM,GAAMH,SACZ,CAAC8sC,EAAQC,KACHD,EAAO36C,QAAU46C,GAAQ56C,QAAU,KACrC3F,QAAQC,IAAI,8DACZ6a,GAAcQ,aAAaglC,KAG/B,CAAExsC,MAAM,GAEZ,CAnCM0sC,GACAL,OAGJ,CAAE10B,WAAW","sources":["src://tavern_helper_template/node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js","src://tavern_helper_template/webpack/bootstrap","src://tavern_helper_template/webpack/runtime/compat get default export","src://tavern_helper_template/webpack/runtime/define property getters","src://tavern_helper_template/webpack/runtime/hasOwnProperty shorthand","src://tavern_helper_template/webpack/runtime/make namespace object","src://tavern_helper_template/external var \"Vue\"","src://tavern_helper_template/src/youth-romcom-simulator/services/CommandService.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/EntityIndexService.ts","src://tavern_helper_template/external var \"_\"","src://tavern_helper_template/src/youth-romcom-simulator/services/ContextService.ts","src://tavern_helper_template/src/youth-romcom-simulator/modules/world-map/services/WorldMapParser.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/LorebookService.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/NotificationService.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/service-locator.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/tavern.ts","src://tavern_helper_template/external var \"z\"","src://tavern_helper_template/src/youth-romcom-simulator/types/index.ts","src://tavern_helper_template/src/youth-romcom-simulator/store/state.ts","src://tavern_helper_template/src/youth-romcom-simulator/store/actions.ts","src://tavern_helper_template/src/youth-romcom-simulator/utils/tagProcessor.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/InputModalService.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/EventBus.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/MemoryService.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/LogSyncService.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/NpcService.ts","src://tavern_helper_template/external var \"toastr\"","src://tavern_helper_template/src/youth-romcom-simulator/services/saveLoadService.ts","src://tavern_helper_template/external var \"VueRouter\"","webpack://tavern_helper_template/./src/youth-romcom-simulator/app.vue?4ff4","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/ActionPanel.vue?59e6","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/ActionPanel.vue?31a0","src://tavern_helper_template/src/youth-romcom-simulator/services/InputHistoryService.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/WorkflowService.ts","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/EnhancedInputBox.vue?15ff","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/EnhancedInputBox.vue?78b6","src://tavern_helper_template/src/youth-romcom-simulator/components/common/InputHistoryPopup.vue","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/InputHistoryPopup.vue?5d80","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/Notification.vue?fa92","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/Notification.vue?857b","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/NotificationContainer.vue?222a","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/NotificationContainer.vue?ea1b","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/controls/SideMenuButton.vue?2d5f","webpack://tavern_helper_template/src/youth-romcom-simulator/components/controls/SideMenuButton.vue?1c6c","src://tavern_helper_template/src/youth-romcom-simulator/store/getters.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/DetailModalService.ts","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/npc-details/NpcArchiveTab.vue?c279","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/npc-details/NpcArchiveTab.vue?8039","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/npc-details/NpcAttributesTab.vue?e0be","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/npc-details/NpcAttributesTab.vue?12f6","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/ProgressBar.vue?c703","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/ProgressBar.vue?edf2","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/RelationsDisplay.vue?1b2a","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/RelationsDisplay.vue?2447","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/npc-details/NpcCauseTab.vue?c4cb","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/npc-details/NpcCauseTab.vue?5bec","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/NpcDetailDisplay.vue?13d9","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/NpcDetailDisplay.vue?5fdf","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/LocationInfoCard.vue?d00e","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/LocationInfoCard.vue?1238","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/DatabaseItemCard.vue?aa45","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/DatabaseItemCard.vue?4ad7","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/FormattedTextRenderer.vue?144c","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/FormattedTextRenderer.vue?929c","webpack://tavern_helper_template/./src/youth-romcom-simulator/MainView.vue?17a7","webpack://tavern_helper_template/src/youth-romcom-simulator/MainView.vue?6863","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/DestinyPlate.vue?ad67","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/DestinyPlate.vue?78aa","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/avatar/AvatarCharacterPanel.vue?716e","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/avatar/AvatarCharacterPanel.vue?42c4","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/avatar/AvatarInventoryPanel.vue?6cd9","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/avatar/AvatarInventoryPanel.vue?1143","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/avatar/AvatarTasksPanel.vue?41af","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/avatar/AvatarTasksPanel.vue?b749","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/CharacterPanel.vue?3060","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/CharacterPanel.vue?e51d","src://tavern_helper_template/src/youth-romcom-simulator/components/modals/ImprintDetailModal.vue","webpack://tavern_helper_template/src/youth-romcom-simulator/components/modals/ImprintDetailModal.vue?7b4a","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/ImprintsPanel.vue?4620","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/ImprintsPanel.vue?9757","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/inventory/ItemDetailPanel.vue?59f4","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/inventory/ItemDetailPanel.vue?ce03","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/InventoryPanel.vue?7a2d","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/InventoryPanel.vue?bd5b","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/NpcDirectoryPanel.vue?99eb","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/NpcDirectoryPanel.vue?d023","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/LogPanel.vue?36b5","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/LogPanel.vue?544f","src://tavern_helper_template/src/youth-romcom-simulator/services/RipplesService.ts","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/RipplesPanel.vue?549b","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/RipplesPanel.vue?1778","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/reincarnation/AvatarSelection.vue?7a94","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/reincarnation/AvatarSelection.vue?be7d","src://tavern_helper_template/src/youth-romcom-simulator/services/ConfirmationService.ts","src://tavern_helper_template/src/youth-romcom-simulator/components/panels/reincarnation/SettlementChoiceCard.vue","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/reincarnation/SettlementChoiceCard.vue?25e6","src://tavern_helper_template/src/youth-romcom-simulator/components/panels/reincarnation/SettlementView.vue","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/reincarnation/SettlementView.vue?a286","src://tavern_helper_template/src/youth-romcom-simulator/services/StarMapService.ts","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/reincarnation/WorldSelection.vue?3b8e","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/reincarnation/WorldSelection.vue?03e1","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/ReincarnationPanel.vue?bbb8","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/ReincarnationPanel.vue?b82f","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/RippleDetailPanel.vue?0308","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/RippleDetailPanel.vue?6a69","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/SkillsPanel.vue?311c","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/SkillsPanel.vue?a7f3","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/MemoryPanel.vue?2aca","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/MemoryPanel.vue?60ac","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/SaveLoadPanel.vue?309a","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/SaveLoadPanel.vue?694b","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/SaveLoadPanel.vue?347f","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/SystemPanel.vue?0614","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/SystemPanel.vue?abdb","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/RealmDetailCard.vue?4954","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/RealmDetailCard.vue?1521","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/WorldDetailsPanel.vue?bc33","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/WorldDetailsPanel.vue?2030","src://tavern_helper_template/src/youth-romcom-simulator/modules/world-map/services/ColorService.ts","src://tavern_helper_template/src/youth-romcom-simulator/modules/world-map/services/CoordinateService.ts","src://tavern_helper_template/src/youth-romcom-simulator/modules/world-map/services/WorldMapDataService.ts","src://tavern_helper_template/src/youth-romcom-simulator/modules/world-map/store/mapState.ts","webpack://tavern_helper_template/./src/youth-romcom-simulator/modules/world-map/components/MapNavigator.vue?6a8c","webpack://tavern_helper_template/src/youth-romcom-simulator/modules/world-map/components/MapNavigator.vue?82d3","webpack://tavern_helper_template/./src/youth-romcom-simulator/modules/world-map/components/NodeDetailPanel.vue?c8eb","webpack://tavern_helper_template/src/youth-romcom-simulator/modules/world-map/components/NodeDetailPanel.vue?b733","webpack://tavern_helper_template/./src/youth-romcom-simulator/modules/world-map/components/AvatarWorldMapView.vue?cb70","webpack://tavern_helper_template/src/youth-romcom-simulator/modules/world-map/components/AvatarWorldMapView.vue?9c90","webpack://tavern_helper_template/./src/youth-romcom-simulator/modules/world-map/components/WorldMapView.vue?4fd9","src://tavern_helper_template/src/youth-romcom-simulator/services/panelRegistry.ts","webpack://tavern_helper_template/src/youth-romcom-simulator/modules/world-map/components/WorldMapView.vue?7145","src://tavern_helper_template/src/youth-romcom-simulator/services/DockManagerService.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/usePanelManager.ts","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/DockManager.vue?d3e0","webpack://tavern_helper_template/src/youth-romcom-simulator/components/DockManager.vue?6bee","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/LoadingIndicator.vue?02c2","webpack://tavern_helper_template/src/youth-romcom-simulator/components/LoadingIndicator.vue?2106","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/modals/NpcListModal.vue?70a0","webpack://tavern_helper_template/src/youth-romcom-simulator/components/modals/NpcListModal.vue?d49d","src://tavern_helper_template/external var \"$\"","src://tavern_helper_template/src/youth-romcom-simulator/services/fullscreenService.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/NpcModalService.ts","src://tavern_helper_template/src/youth-romcom-simulator/store/ui.ts","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/TopStatusBar.vue?ead9","webpack://tavern_helper_template/src/youth-romcom-simulator/components/TopStatusBar.vue?9450","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/WorldTimeDisplay.vue?8e1f","webpack://tavern_helper_template/src/youth-romcom-simulator/components/WorldTimeDisplay.vue?a26f","src://tavern_helper_template/src/youth-romcom-simulator/services/LayoutService.ts","webpack://tavern_helper_template/./src/youth-romcom-simulator/app.vue?e61b","webpack://tavern_helper_template/src/youth-romcom-simulator/app.vue?61b5","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/AttributeDisplay.vue?92f3","webpack://tavern_helper_template/src/youth-romcom-simulator/components/AttributeDisplay.vue?fa46","webpack://tavern_helper_template/./src/youth-romcom-simulator/views/CharacterView.vue?45f2","webpack://tavern_helper_template/src/youth-romcom-simulator/views/CharacterView.vue?d997","webpack://tavern_helper_template/./src/youth-romcom-simulator/views/InventoryView.vue?2f10","webpack://tavern_helper_template/src/youth-romcom-simulator/views/InventoryView.vue?1463","webpack://tavern_helper_template/./src/youth-romcom-simulator/views/MainContentView.vue?7657","webpack://tavern_helper_template/src/youth-romcom-simulator/views/MainContentView.vue?cbc5","webpack://tavern_helper_template/./src/youth-romcom-simulator/views/NpcListView.vue?594a","webpack://tavern_helper_template/src/youth-romcom-simulator/views/NpcListView.vue?0c7f","webpack://tavern_helper_template/./src/youth-romcom-simulator/views/WorldStateView.vue?c846","src://tavern_helper_template/src/youth-romcom-simulator/core/vue-loader.ts","webpack://tavern_helper_template/src/youth-romcom-simulator/views/WorldStateView.vue?0cd4","src://tavern_helper_template/src/youth-romcom-simulator/index.ts"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = Vue;","type CommandListener = (commands: string[]) => void;\n\nclass CommandService {\n  private commands: string[] = [];\n  private listeners: CommandListener[] = [];\n\n  subscribe(listener: CommandListener) {\n    this.listeners.push(listener);\n  }\n\n  unsubscribe(listener: CommandListener) {\n    this.listeners = this.listeners.filter(l => l !== listener);\n  }\n\n  private notify() {\n    this.listeners.forEach(listener => listener([...this.commands]));\n  }\n\n  addCommand(command: string) {\n    this.commands.push(command);\n    this.notify();\n  }\n\n  getCommands(): string[] {\n    return [...this.commands];\n  }\n\n  clearCommands() {\n    this.commands = [];\n    this.notify();\n  }\n}\n\nexport const commandService = new CommandService();\n","import { get } from 'lodash';\nimport { ,  } from '../types';\n\n/**\n * \n */\nexport interface EntityMetadata {\n  id: string;\n  name: string;\n  type: 'character' | 'location' | 'dbItem' | 'skill' | 'artifice' | 'talent';\n  //  worldId, epochId \n  category?: string;\n  path?: string;\n}\n\n/**\n *  (-)\n */\nclass EntityIndexService {\n  private indexByName = new Map<string, EntityMetadata[]>();\n  private indexById = new Map<string, EntityMetadata>();\n  private isInitialized = false;\n\n  /**\n   * \n   */\n  public async buildIndex(worldState:  | null): Promise<void> {\n    if (this.isInitialized || !worldState) return;\n\n    console.log('[EntityIndexService] Starting to build entity index for Oregairu-verse...');\n    this.indexByName.clear();\n    this.indexById.clear();\n\n    // 1. \n    const characters = worldState.;\n    for (const charId in characters) {\n      const char = characters[charId];\n      if (char && typeof char !== 'string' && char.) {\n        this.addEntity({\n          id: charId,\n          name: char.,\n          type: 'character',\n        });\n      }\n    }\n\n    // TODO: \n    // \n\n    this.isInitialized = true;\n    console.log(`[EntityIndexService] Entity index built successfully with ${this.indexById.size} entries.`);\n  }\n\n  public findByName(name: string): EntityMetadata[] | undefined {\n    return this.indexByName.get(name);\n  }\n\n  public findById(id: string): EntityMetadata | undefined {\n    return this.indexById.get(id);\n  }\n\n  private addEntity(entity: EntityMetadata) {\n    const existingByName = this.indexByName.get(entity.name) || [];\n    this.indexByName.set(entity.name, [...existingByName, entity]);\n\n    if (!this.indexById.has(entity.id)) {\n      this.indexById.set(entity.id, entity);\n    }\n  }\n}\n\nexport const entityIndexService = new EntityIndexService();\n","const __WEBPACK_NAMESPACE_OBJECT__ = _;","import { get } from 'lodash';\nimport { AppState, Character, World, WorldEpoch, WorldState } from '../types';\nimport { InformationRipple } from '../types/evolution';\nimport { entityIndexService } from './EntityIndexService';\n\nexport interface UserIntent {\n  actionType: 'combat' | 'social' | 'exploration' | 'inventory' | 'creation' | 'default';\n  crossContextQuery?: { worldId: string; epochId?: string; items?: string[]; locations?: string[] };\n  explicitEntities: {\n    characters: string[];\n    locations: string[];\n    dbItems: string[];\n  };\n  triggeredRipples: InformationRipple[]; // \n  loadFullPlayerData?: (keyof WorldState[''][''])[];\n}\n\n/**\n * AI\n */\nclass ContextService {\n  public analyzeUserIntent(\n    userInput: string,\n    worldState: AppState['worldState'],\n    availableRipples: InformationRipple[],\n  ): UserIntent {\n    const intent: UserIntent = {\n      actionType: 'default',\n      explicitEntities: {\n        characters: [],\n        locations: [],\n        dbItems: [],\n      },\n      triggeredRipples: [],\n    };\n\n    if (!worldState) return intent;\n\n    // 1. \n    const activeWorld = Object.values(worldState. || {}).find(w =>\n      ['', ''].includes(get(w, '..', '')),\n    );\n    const avatarId = get(worldState, '...ID');\n    const currentPlayer = avatarId ? get(activeWorld, `.${avatarId}`) : get(worldState, '.');\n\n    if (currentPlayer && activeWorld) {\n      const currentLocationId = currentPlayer.;\n      if (currentLocationId) {\n        intent.explicitEntities.locations.push(currentLocationId);\n\n        // \n        let parentId = entityIndexService.findById(currentLocationId)?.parentId;\n        while (parentId && parentId !== 'WORLD_ORIGIN') {\n          intent.explicitEntities.locations.push(parentId);\n          parentId = entityIndexService.findById(parentId)?.parentId;\n        }\n\n        // NPC\n        const worldChars = get(activeWorld, '', {});\n        for (const charId in worldChars) {\n          if (get(worldChars, `${charId}.`) === currentLocationId) {\n            intent.explicitEntities.characters.push(charId);\n          }\n        }\n      }\n    }\n\n    // 2.  (Action Type) - \n    const intentScores: Record<UserIntent['actionType'], number> = {\n      combat: 0,\n      inventory: 0,\n      social: 0,\n      exploration: 0,\n      creation: 0,\n      default: 1, // \n    };\n\n    const patterns: { type: UserIntent['actionType']; regex: RegExp; weight: number }[] = [\n      { type: 'combat', regex: /(|||||||||||)/, weight: 3 },\n      { type: 'inventory', regex: /(|||||||||)/, weight: 2 },\n      { type: 'social', regex: /(|||||||||||)/, weight: 2 },\n      { type: 'social', regex: /[\"].*[\"]/, weight: 1.5 }, // \n      { type: 'exploration', regex: /(|||||||||||)/, weight: 2 },\n      { type: 'creation', regex: /(||||||)/, weight: 3 },\n    ];\n\n    patterns.forEach(({ type, regex, weight }) => {\n      if (regex.test(userInput)) {\n        intentScores[type] += weight;\n      }\n    });\n\n    // \n    let maxScore = 0;\n    let bestIntent: UserIntent['actionType'] = 'default';\n\n    for (const [type, score] of Object.entries(intentScores)) {\n      if (score > maxScore) {\n        maxScore = score;\n        bestIntent = type as UserIntent['actionType'];\n      }\n    }\n    intent.actionType = bestIntent;\n\n    // 2. \n    // A simple regex to find potential entities (could be improved)\n    const potentialNames = userInput.match(/[\\u4e00-\\u9fa5a-zA-Z]+/g) || [];\n\n    for (const name of potentialNames) {\n      const results = entityIndexService.findByName(name);\n      if (results) {\n        for (const meta of results) {\n          switch (meta.type) {\n            case 'character':\n              intent.explicitEntities.characters.push(meta.id);\n              break;\n            case 'location':\n              intent.explicitEntities.locations.push(meta.id);\n              break;\n            case 'dbItem':\n            case 'skill':\n            case 'artifice':\n            case 'talent':\n              intent.explicitEntities.dbItems.push(meta.id);\n              break;\n            case 'imprint':\n              if (meta.source === 'player') {\n                if (!intent.loadFullPlayerData) intent.loadFullPlayerData = [];\n                intent.loadFullPlayerData.push('');\n              }\n              break;\n          }\n\n          // /\n          const activeWorldId = Object.keys(worldState.).find(wId =>\n            ['', ''].includes(get(worldState, `.${wId}...`) || ''),\n          );\n          if (meta.worldId !== activeWorldId && meta.worldId !== '_player') {\n            if (!intent.crossContextQuery) {\n              intent.crossContextQuery = { worldId: meta.worldId, items: [], locations: [] };\n            }\n            if (meta.type === 'location') {\n              intent.crossContextQuery.locations?.push(meta.id);\n            } else {\n              intent.crossContextQuery.items?.push(meta.id);\n            }\n          }\n        }\n      }\n    }\n\n    // 3. \n    if (currentPlayer) {\n      for (const ripple of availableRipples) {\n        const influence = ripple.sphereOfInfluence;\n        let isTriggered = false;\n        // \n        if (currentPlayer. && influence.locationIds.includes(currentPlayer.)) {\n          isTriggered = true;\n        }\n        // TODO: \n\n        if (isTriggered) {\n          console.log(`[EvoSys-Gravity] Ripple ${ripple.id} was triggered by narrative gravity.`, ripple);\n          intent.triggeredRipples.push(ripple);\n          // \n          const rippleEntities = this.extractEntitiesFromText(ripple.content, worldState);\n          intent.explicitEntities.characters.push(...rippleEntities.characters);\n          intent.explicitEntities.locations.push(...rippleEntities.locations);\n          intent.explicitEntities.dbItems.push(...rippleEntities.dbItems);\n        }\n      }\n    }\n\n    // 4. \n    if (intent.actionType === 'inventory') {\n      if (!intent.loadFullPlayerData) intent.loadFullPlayerData = [];\n      intent.loadFullPlayerData.push('', '');\n    }\n\n    console.log('[ContextService] User Intent Analyzed:', intent);\n    return intent;\n  }\n\n  private extractEntitiesFromText(text: string, worldState: AppState['worldState']): UserIntent['explicitEntities'] {\n    const entities: UserIntent['explicitEntities'] = { characters: [], locations: [], dbItems: [] };\n    if (!worldState) return entities;\n\n    const potentialNames = text.match(/[\\u4e00-\\u9fa5a-zA-Z]+/g) || [];\n    for (const name of potentialNames) {\n      const results = entityIndexService.findByName(name);\n      if (results) {\n        for (const meta of results) {\n          switch (meta.type) {\n            case 'character':\n              entities.characters.push(meta.id);\n              break;\n            case 'location':\n              entities.locations.push(meta.id);\n              break;\n            case 'dbItem':\n              entities.dbItems.push(meta.id);\n              break;\n          }\n        }\n      }\n    }\n    return entities;\n  }\n\n  /**\n   * ID\n   */\n  public identifyCoreEntities(\n    userInput: string,\n    currentCharacterId: string,\n    worldState: AppState['worldState'],\n  ): string[] {\n    const entities = new Set<string>([currentCharacterId]);\n    if (!worldState || !worldState.) return Array.from(entities);\n\n    const activeWorld = Object.values(worldState.).find(\n      w => get(w, '..') === '' || get(w, '..') === '',\n    );\n    if (!activeWorld) return Array.from(entities);\n\n    const allCharacters = get(activeWorld, '', {}) as { [id: string]: Character };\n    const currentUser = get(allCharacters, currentCharacterId) || get(worldState, '.');\n    if (!currentUser) return Array.from(entities);\n\n    const currentLocationId = currentUser.;\n\n    // 1. NPC\n    for (const charId in allCharacters) {\n      if (allCharacters[charId]. === currentLocationId) {\n        entities.add(charId);\n      }\n    }\n\n    // 2. NPC\n    const causalNet = get(activeWorld, '', {});\n    const playerRelations = get(causalNet, currentCharacterId, {});\n\n    const sortedRelations = Object.entries(playerRelations)\n      .map(([id, rel]: [string, any]) => ({\n        id,\n        intimacy: get(rel, '.', 0),\n        conflict: get(rel, '.', 0),\n      }))\n      .sort((a, b) => b.intimacy - a.intimacy);\n\n    if (sortedRelations.length > 0) {\n      entities.add(sortedRelations[0].id); // \n      const mostHostile = sortedRelations.sort((a, b) => b.conflict - a.conflict)[0];\n      if (mostHostile) entities.add(mostHostile.id); // \n    }\n\n    // 3. \n    for (const id in allCharacters) {\n      const character = allCharacters[id];\n      if (character && character. && userInput.includes(character.)) {\n        entities.add(id);\n      }\n    }\n\n    return Array.from(entities);\n  }\n\n  /**\n   * \n   * @param intent - \n   * @param worldState - \n   * @param userId - ID\n   * @returns \n   */\n  public buildLeanContext(\n    intent: UserIntent,\n    userInput: string, //  <--  userInput \n    worldState: AppState['worldState'],\n    userId: string,\n  ): { stat_data: Partial<AppState['worldState']> } {\n    if (!worldState) return { stat_data: {} };\n\n    const leanState: any = {\n      : {\n        : {},\n        : get(worldState, '.'),\n        : get(worldState, '.'),\n      },\n      : {},\n    };\n\n    // 1.  ()\n    const playerFullData = get(worldState, '.', {}) as Character;\n    // \n    const playerLeanData: any = { ...playerFullData };\n    // \n    if (playerFullData.) {\n      playerLeanData. = this.simplifyIdMap(playerFullData.);\n    }\n    if (playerFullData.) {\n      playerLeanData. = this.simplifyIdMap(playerFullData.);\n    }\n\n    // \n    if (intent.loadFullPlayerData) {\n      intent.loadFullPlayerData.forEach((key: any) => {\n        if (playerFullData[key]) {\n          playerLeanData[key] = playerFullData[key];\n        }\n      });\n    }\n    leanState.. = playerLeanData;\n\n    // 2. \n    const coreEntities = Array.from(new Set([userId, ...intent.explicitEntities.characters]));\n\n    // 3. \n    const activeWorldEntry = Object.entries(get(worldState, '', {}) as { [id: string]: World }).find(\n      ([, w]) => get(w, '..') === '' || get(w, '..') === '',\n    );\n\n    if (activeWorldEntry) {\n      const [worldId, activeWorld] = activeWorldEntry;\n      const epochId = get(activeWorld, '..ID');\n\n      // 3.1  ()\n      if (epochId) {\n        const activeEpoch = get(activeWorld, ['', '', epochId]) as WorldEpoch;\n        if (activeEpoch) {\n          const leanEpoch = { ...activeEpoch };\n          // \n          delete (leanEpoch as any).;\n          leanEpoch. = get(activeEpoch, '', {});\n\n          //  (Location Injection)\n          //  intent.explicitEntities.locations ID activeEpoch.. \n          const allLocations = get(activeEpoch, '.', {});\n          const leanLocations: Record<string, any> = {};\n\n          if (intent.explicitEntities.locations.length > 0) {\n            for (const locId of intent.explicitEntities.locations) {\n              const loc = (allLocations as Record<string, any>)[locId];\n              if (loc) {\n                leanLocations[locId] = loc;\n                //  ()\n                let parentId = get(loc, '.ID');\n                while (parentId && parentId !== 'WORLD_ORIGIN') {\n                  const parent = (allLocations as Record<string, any>)[parentId];\n                  if (parent) {\n                    // \n                    if (!leanLocations[parentId]) {\n                      leanLocations[parentId] = parent;\n                    }\n                    parentId = get(parent, '.ID');\n                  } else {\n                    break;\n                  }\n                }\n              }\n            }\n          }\n\n          //  leanEpoch\n          if (Object.keys(leanLocations).length > 0) {\n            (leanEpoch as any). = { : leanLocations };\n          }\n\n          if (!leanState.[worldId]) leanState.[worldId] = {};\n          leanState.[worldId]. = {\n            : get(activeWorld, '.'),\n            : { [epochId]: leanEpoch },\n          };\n        }\n      }\n\n      // 3.2  ()\n      const worldChars = get(worldState.[worldId], '', {}) as { [id: string]: Character };\n      const leanChars: any = {};\n\n      // \n      const avatarId = get(worldState, '...ID');\n      const currentPlayer = (avatarId ? get(worldChars, avatarId) : playerFullData) as Character;\n\n      // \n      const sceneEntities = this.identifyCoreEntities(userInput, userId, worldState);\n      coreEntities.push(...sceneEntities);\n\n      const allActiveCharIds = Array.from(new Set(coreEntities));\n\n      for (const charId of allActiveCharIds) {\n        const char = get(worldChars, charId) || (charId === userId ? playerFullData : null);\n        if (char) {\n          // \n          if (\n            intent.actionType === 'combat' ||\n            intent.actionType === 'inventory' ||\n            char. === currentPlayer?.\n          ) {\n            leanChars[charId] = char; // \n          } else {\n            leanChars[charId] = {\n              // \n              : char.,\n              : char.,\n              : char.,\n              : char.,\n              : char.,\n              : char.,\n            };\n          }\n        }\n      }\n      leanState.[worldId]. = leanChars;\n\n      // 3.3  ()\n      const fullCausalNet = get(activeWorld, '', {});\n      leanState.[worldId]. = {};\n      const activeCharIds = Object.keys(leanChars);\n      if (!activeCharIds.includes(userId)) {\n        activeCharIds.push(userId); // \n      }\n\n      for (const subjectId of activeCharIds) {\n        const relations = get(fullCausalNet, subjectId);\n        if (relations) {\n          if (!leanState.[worldId].) leanState.[worldId]. = {};\n          leanState.[worldId].[subjectId] = {};\n          for (const objectId in relations) {\n            if (activeCharIds.includes(objectId)) {\n              leanState.[worldId].[subjectId][objectId] = relations[objectId];\n            }\n          }\n        }\n      }\n\n      // 3.4  ( intent )\n      const referencedDbIds = new Set<string>([...intent.explicitEntities.dbItems]);\n      const fullDatabase = get(activeWorld, '', {});\n      //  leanChars  playerLeanData  ()\n      [playerLeanData, ...Object.values(leanChars)].forEach((char: any) => {\n        if (char.) Object.keys(char.).forEach(id => referencedDbIds.add(id));\n        if (char.) char..forEach((id: string) => id && referencedDbIds.add(id));\n      });\n\n      if (referencedDbIds.size > 0 && fullDatabase) {\n        if (!leanState.[worldId].) leanState.[worldId]. = {};\n        for (const category in fullDatabase) {\n          if (category === '$meta') continue;\n          const categoryStore = get(fullDatabase, category, {});\n          for (const itemId of referencedDbIds) {\n            if (get(categoryStore, itemId)) {\n              if (!leanState.[worldId].[category]) leanState.[worldId].[category] = {};\n              leanState.[worldId].[category][itemId] = get(categoryStore, itemId);\n            }\n          }\n        }\n      }\n    }\n\n    // 4.  (Cross Context Query)\n    if (intent.crossContextQuery) {\n      const { worldId, items, locations } = intent.crossContextQuery;\n      const targetWorld = get(worldState., worldId);\n      if (targetWorld) {\n        if (!leanState.[worldId]) leanState.[worldId] = {};\n\n        // \n        if (items && items.length > 0) {\n          const targetDb = get(targetWorld, '', {});\n          if (!leanState.[worldId].) leanState.[worldId]. = {};\n          for (const category in targetDb) {\n            if (category === '$meta') continue;\n            const store = targetDb[category as keyof typeof targetDb] as any;\n            items.forEach(itemId => {\n              if (store[itemId]) {\n                if (!leanState.[worldId].[category]) leanState.[worldId].[category] = {};\n                leanState.[worldId].[category][itemId] = store[itemId];\n              }\n            });\n          }\n        }\n      }\n    }\n\n    console.log('[ContextService] Built Lean Context V4:', { stat_data: leanState });\n    return { stat_data: leanState };\n  }\n\n  private simplifyIdMap(map: any) {\n    if (!map) return {};\n    const simple: any = {};\n    for (const key in map) {\n      if (key === '$meta') continue;\n      //  ()\n      simple[key] = typeof map[key] === 'number' ? map[key] : true;\n    }\n    return simple;\n  }\n}\n\nexport const contextService = new ContextService();\n","import type { WorldDefinition } from '../../../types/world';\n\n/**\n * A robust, non-regex based parser for the custom YAML-like format.\n */\nexport function parseWorldLoreForMap(text: string): WorldDefinition | null {\n  if (!text) {\n    console.warn('[WorldMapParser] Received empty or null lore content.');\n    return null;\n  }\n\n  const automationRuleMarker = ':';\n  const startIndex = text.indexOf(automationRuleMarker);\n  if (startIndex === -1) {\n    console.error('[WorldMapParser] \":\" block not found in the lorebook entry.');\n    return null;\n  }\n\n  const yamlText = text.substring(startIndex);\n  const lines = yamlText.split('\\n').slice(1); // Skip the \":\" line\n\n  const root = {};\n  const stack: { level: number; obj: any }[] = [{ level: -1, obj: root }];\n\n  for (const line of lines) {\n    if (line.trim() === '') continue;\n\n    const indentMatch = line.match(/^\\s*/);\n    const indent = indentMatch ? indentMatch[0].length : 0;\n    const trimmedLine = line.trim();\n\n    while (stack.length > 1 && indent <= stack[stack.length - 1].level) {\n      stack.pop();\n    }\n\n    let parentObj = stack[stack.length - 1].obj;\n\n    if (trimmedLine.startsWith('- ')) {\n      const listItemContent = trimmedLine.substring(2).trim();\n\n      if (!Array.isArray(parentObj)) {\n        const grandParent = stack[stack.length - 2].obj;\n        const lastKey = Object.keys(grandParent).pop();\n        if (lastKey && grandParent[lastKey] === parentObj) {\n          parentObj = [];\n          grandParent[lastKey] = parentObj;\n          stack[stack.length - 1].obj = parentObj;\n        } else {\n          continue;\n        }\n      }\n\n      const separatorIndex = listItemContent.indexOf(':');\n      if (separatorIndex === -1) {\n        parentObj.push(parseValue(listItemContent));\n      } else {\n        const newListItem = {};\n        parentObj.push(newListItem);\n        stack.push({ level: indent, obj: newListItem });\n        processKeyValue(listItemContent, newListItem, indent, stack);\n      }\n    } else {\n      processKeyValue(trimmedLine, parentObj, indent, stack);\n    }\n  }\n\n  return root as WorldDefinition;\n}\n\nfunction processKeyValue(line: string, parent: any, indent: number, stack: any[]) {\n  const separatorIndex = line.indexOf(':');\n  if (separatorIndex > -1) {\n    const key = line.substring(0, separatorIndex).trim();\n    const valueStr = line.substring(separatorIndex + 1).trim();\n\n    if (valueStr === '') {\n      const newChild = {};\n      parent[key] = newChild;\n      stack.push({ level: indent, obj: newChild });\n    } else if (valueStr.startsWith('{') && valueStr.endsWith('}')) {\n      const newObj = {};\n      parent[key] = newObj;\n      const objContent = valueStr.slice(1, -1).trim();\n      const pairs = objContent.split(',').map(p => p.trim());\n      for (const pair of pairs) {\n        processKeyValue(pair, newObj, indent + 2, stack);\n      }\n    } else {\n      parent[key] = parseValue(valueStr);\n    }\n  }\n}\n\nfunction parseValue(value: string): any {\n  const trimmed = value.trim();\n\n  if (trimmed.startsWith('\"') && trimmed.endsWith('\"')) {\n    const inner = trimmed.slice(1, -1);\n    if (inner.startsWith('[') && inner.endsWith(']')) {\n      return parseValue(inner);\n    }\n    return inner;\n  }\n\n  if (trimmed.startsWith('[') && trimmed.endsWith(']')) {\n    try {\n      const content = trimmed.slice(1, -1).trim();\n      const parts = [];\n      let buffer = '';\n      let inQuotes = false;\n      let bracketLevel = 0;\n\n      for (let i = 0; i < content.length; i++) {\n        const char = content[i];\n        if (char === \"'\" || char === '\"') {\n          inQuotes = !inQuotes;\n        }\n        if (!inQuotes) {\n          if (char === '[') bracketLevel++;\n          if (char === ']') bracketLevel--;\n          if (char === ',' && bracketLevel === 0) {\n            parts.push(buffer.trim());\n            buffer = '';\n            continue;\n          }\n        }\n        buffer += char;\n      }\n      if (buffer) {\n        parts.push(buffer.trim());\n      }\n\n      return parts.map(part => parseValue(part));\n    } catch (e) {\n      // Fallback\n    }\n  }\n\n  if (trimmed.toLowerCase() === 'true') return true;\n  if (trimmed.toLowerCase() === 'false') return false;\n  if (trimmed === 'null') return null;\n  if (trimmed !== '' && !isNaN(Number(trimmed)) && !trimmed.includes('x')) {\n    return Number(trimmed);\n  }\n\n  return trimmed;\n}\n","//  TavernHelper API\ndeclare const TavernHelper: any;\n\nconst LOREBOOK_NAME = '-';\nlet entriesCache: any[] | null = null;\n\nasync function getEntries(forceRefresh = false) {\n  if (entriesCache && !forceRefresh) {\n    return entriesCache;\n  }\n  try {\n    const entries = await TavernHelper.getLorebookEntries(LOREBOOK_NAME);\n    if (!entries) {\n      console.error(`[LorebookService]  \"${LOREBOOK_NAME}\" `);\n      entriesCache = null;\n      return null;\n    }\n    entriesCache = entries;\n    return entries;\n  } catch (error) {\n    console.error(`[LorebookService]  getLorebookEntries :`, error);\n    return null;\n  }\n}\n\nfunction findEntryByComment(comment: string): any | null {\n  if (!entriesCache) {\n    console.warn('[LorebookService] findEntryByComment called before cache was populated.');\n    return null;\n  }\n  return entriesCache.find((e: any) => e.comment === comment) || null;\n}\n\nasync function readFromLorebook(entryName: string, forceRefresh = false): Promise<string | null> {\n  const entries = await getEntries(forceRefresh);\n  if (!entries) return null;\n  const entry = entries.find((e: any) => e.comment === entryName || e.name === entryName);\n  return entry ? entry.content : null;\n}\n\nasync function writeToLorebook(\n  entryName: string,\n  content: string,\n  options: { isEnabled: boolean; keys: string[] } = { isEnabled: true, keys: [] },\n) {\n  console.log(`[Roo Debug] Lorebook: Preparing to write/create entry: \"${entryName}\".`);\n  const allEntries = await getEntries();\n  if (!allEntries) return;\n\n  const targetEntry = allEntries.find((e: any) => e.comment === entryName || e.name === entryName);\n\n  try {\n    if (targetEntry) {\n      // ---  ---\n      console.log(`[Roo Debug] Lorebook: Entry \"${entryName}\" exists. Updating with setLorebookEntries.`);\n      await TavernHelper.setLorebookEntries(LOREBOOK_NAME, [\n        { uid: targetEntry.uid, content: content, enabled: options.isEnabled },\n      ]);\n    } else {\n      // ---  ( UpdateVariable5.html) ---\n      console.log(`[Roo Debug] Lorebook: Entry \"${entryName}\" does not exist. Creating with createLorebookEntries.`);\n\n      const baseKey = entryName.replace(/\\(\\d+\\)$/, '');\n      const baseEntryTemplate = allEntries.find((entry: any) => entry.comment === baseKey || entry.name === baseKey);\n\n      // \n      const newEntryData: any = {\n        comment: entryName,\n        content: content,\n        keys: [entryName],\n        enabled: options.isEnabled,\n        position: 'before_character_definition',\n        order: 100,\n      };\n\n      // \n      if (baseEntryTemplate) {\n        Object.assign(newEntryData, {\n          keys: [...(baseEntryTemplate.keys || []), entryName],\n          selective: baseEntryTemplate.selective,\n          constant: baseEntryTemplate.constant,\n          position: baseEntryTemplate.position,\n          order: baseEntryTemplate.order,\n          case_sensitive: baseEntryTemplate.case_sensitive,\n        });\n      }\n\n      console.log(\n        `[Roo Debug] Lorebook: Calling createLorebookEntries for \"${entryName}\" with payload:`,\n        JSON.stringify(newEntryData),\n      );\n      await TavernHelper.createLorebookEntries(LOREBOOK_NAME, [newEntryData]);\n    }\n    console.log(`[LorebookService] API call for \"${entryName}\" completed successfully.`);\n    entriesCache = null; // \n  } catch (error) {\n    console.error(`[LorebookService]  \"${entryName}\" :`, error);\n  }\n}\n\nasync function appendToEntry(entryName: string, newContent: string, separator = '\\n\\n---\\n\\n'): Promise<void> {\n  console.log(`[Roo Debug] Lorebook: Appending to entry \"${entryName}\".`);\n  try {\n    const existingContent = await readFromLorebook(entryName);\n    const content = existingContent ? `${existingContent}${separator}${newContent}` : newContent;\n    // `writeToLorebook` \n    await writeToLorebook(entryName, content);\n  } catch (error) {\n    console.error(`[LorebookService]  \"${entryName}\" :`, error);\n  }\n}\n\nimport { parseWorldLoreForMap } from '../modules/world-map/services/WorldMapParser';\nimport type { Epoch, WorldDefinition } from '../types/world';\n\nasync function loadAndParseWorldData(worldName = ''): Promise<Epoch | null> {\n  try {\n    const content = await readFromLorebook(worldName);\n    if (!content) {\n      console.warn(`[LorebookService]  \"${worldName}\" `);\n      return null;\n    }\n\n    const worldData = parseWorldLoreForMap(content) as WorldDefinition | null;\n\n    if (worldData && worldData. && worldData.) {\n      // ID\n      const currentEpochId = worldData..ID;\n      if (currentEpochId && worldData.[currentEpochId]) {\n        return worldData.[currentEpochId];\n      }\n      // \n      const firstPlayableEpoch = Object.values(worldData.).find(epoch => epoch.);\n      if (firstPlayableEpoch) {\n        return firstPlayableEpoch;\n      }\n    }\n\n    console.warn(`[LorebookService]  \"${worldName}\" `);\n    return null;\n  } catch (error) {\n    console.error(`[LorebookService]  \"${worldName}\" :`, error);\n    return null;\n  }\n}\n\nexport const lorebookService = {\n  getEntries,\n  readFromLorebook,\n  writeToLorebook,\n  appendToEntry,\n  findEntryByComment,\n  setEntryEnabled,\n  loadAndParseWorldData, // \n};\n\nasync function setEntryEnabled(entryName: string, isEnabled: boolean): Promise<void> {\n  console.log(`[LorebookService] Setting entry \"${entryName}\" enabled status to: ${isEnabled}`);\n  try {\n    const allEntries = await getEntries();\n    if (!allEntries) return;\n\n    const targetEntry = allEntries.find((e: any) => e.comment === entryName || e.name === entryName);\n\n    if (targetEntry) {\n      // [PATCH] \n      const updatedEntry = { ...targetEntry, enabled: isEnabled };\n      await TavernHelper.setLorebookEntries(LOREBOOK_NAME, [updatedEntry]);\n      console.log(`[LorebookService] Successfully set \"${entryName}\" enabled=${isEnabled}.`);\n    } else {\n      // \n      console.warn(`[LorebookService] setEntryEnabled: Entry \"${entryName}\" not found. Skipping.`);\n    }\n  } catch (error) {\n    console.error(`[LorebookService]  \"${entryName}\" :`, error);\n  }\n}\n","import { reactive } from 'vue';\n\nexport type NotificationType = 'info' | 'success' | 'warning' | 'error';\n\nexport interface Notification {\n  id: number;\n  title: string;\n  message: string;\n  type: NotificationType;\n}\n\nconst state = reactive({\n  notifications: [] as Notification[],\n});\n\nlet nextId = 0;\n\nconst actions = {\n  show(title: string, message: string, type: NotificationType = 'info', duration: number = 4000) {\n    const id = nextId++;\n    state.notifications.push({ id, title, message, type });\n\n    if (duration > 0) {\n      setTimeout(() => {\n        this.hide(id);\n      }, duration);\n    }\n  },\n\n  hide(id: number) {\n    const index = state.notifications.findIndex(n => n.id === id);\n    if (index !== -1) {\n      state.notifications.splice(index, 1);\n    }\n  },\n\n  success(title: string, message: string, duration: number = 4000) {\n    this.show(title, message, 'success', duration);\n  },\n\n  info(title: string, message: string, duration: number = 4000) {\n    this.show(title, message, 'info', duration);\n  },\n\n  warn(title: string, message: string, duration: number = 5000) {\n    this.show(title, message, 'warning', duration);\n  },\n\n  error(title: string, message: string, duration: number = 7000) {\n    this.show(title, message, 'error', duration);\n  },\n};\n\nexport const notificationState = state;\nexport const notificationService = actions;\n","import type { saveLoadService } from './saveLoadService';\nimport type { inputModalActions, inputModalState } from './InputModalService';\nimport type { store, actions } from '../store';\n\n// \nexport type SaveLoadService = typeof saveLoadService;\nexport type InputModalActions = typeof inputModalActions;\nexport type InputModalState = typeof inputModalState;\nexport type Store = typeof store;\nexport type Actions = typeof actions;\n\ninterface ServiceRegistry {\n  saveLoadService: SaveLoadService;\n  inputModalActions: InputModalActions;\n  inputModalState: InputModalState;\n  store: Store;\n  actions: Actions;\n}\n\nconst registry: Partial<ServiceRegistry> = {};\n\nexport const serviceLocator = {\n  register<K extends keyof ServiceRegistry>(key: K, instance: ServiceRegistry[K]): void {\n    registry[key] = instance;\n  },\n  get<K extends keyof ServiceRegistry>(key: K): NonNullable<ServiceRegistry[K]> {\n    const instance = registry[key];\n    if (!instance) {\n      throw new Error(`Service with key \"${key}\" has not been registered.`);\n    }\n    return instance as NonNullable<ServiceRegistry[K]>;\n  },\n};\n","// API\ndeclare const TavernHelper: any;\ndeclare const eventEmit: any;\ndeclare const getChatMessages: (id: string) => Promise<any[]>;\ndeclare const getCurrentMessageId: () => string;\n\nclass TavernService {\n  /**\n   * Tavern\n   */\n  async fetchTavernData() {\n    console.debug('Fetching data from Tavern...');\n    const messages = await getChatMessages(getCurrentMessageId());\n    console.debug('Messages received:', messages);\n    return messages;\n  }\n\n  /**\n   * AI\n   * @param prompt - AI\n   * @param variables - \n   */\n  async generateAiResponse(prompt: string, variables?: any): Promise<string> {\n    const generateConfig: any = {\n      injects: [{ role: 'user', content: prompt, position: 'in_chat', should_scan: true }],\n      should_stream: false,\n    };\n\n    if (variables) {\n      generateConfig.variables = variables;\n    }\n\n    const aiResponse = await TavernHelper.generate(generateConfig);\n    if (typeof aiResponse !== 'string') {\n      throw new Error('AI');\n    }\n    return aiResponse;\n  }\n\n  /**\n   * MVU\n   * @param script - MVU\n   * @param oldVariables - \n   */\n  async invokeMvuScript(script: string, oldVariables: any): Promise<any> {\n    const inputData: any = { old_variables: oldVariables };\n\n    await eventEmit('mag_invoke_mvu', script, inputData);\n    return inputData.new_variables;\n  }\n}\n\nexport const tavernService = new TavernService();\n","const __WEBPACK_NAMESPACE_OBJECT__ = z;","import { z } from 'zod';\n\n/**\n * @file  - - v1.0\n * @description  `.txt`  Zod Schema \n */\n\n// ---  ---\n\nconst  = {\n  : [\n    { name: '', threshold: -Infinity },\n    { name: '', threshold: -80 },\n    { name: '', threshold: -40 },\n    { name: '', threshold: -10 },\n    { name: '', threshold: 10 },\n    { name: '', threshold: 40 },\n    { name: '', threshold: 80 },\n    { name: '', threshold: 100 },\n    { name: '', threshold: 120 },\n    { name: '', threshold: 150 },\n    { name: '', threshold: 180 },\n    { name: '', threshold: 200 },\n  ],\n  : [\n    { name: '', threshold: -100 },\n    { name: '', threshold: -60 },\n    { name: '', threshold: -30 },\n    { name: '', threshold: 0 },\n    { name: '', threshold: 30 },\n    { name: '', threshold: 60 },\n    { name: '', threshold: 80 },\n    { name: '', threshold: 100 },\n    { name: '', threshold: 120 },\n    { name: '', threshold: 150 },\n    { name: '', threshold: 180 },\n    { name: '', threshold: 200 },\n  ],\n  : [\n    { name: '', threshold: -100 },\n    { name: '', threshold: -70 },\n    { name: '', threshold: -40 },\n    { name: '', threshold: -10 },\n    { name: '', threshold: 10 },\n    { name: '', threshold: 40 },\n    { name: '', threshold: 70 },\n    { name: '', threshold: 90 },\n    { name: '', threshold: 110 },\n    { name: '', threshold: 140 },\n    { name: '', threshold: 170 },\n    { name: '', threshold: 200 },\n  ],\n};\n\nconst  = [\n  { name: '', threshold: 0, : '' },\n  { name: '', threshold: 25, : '' },\n  {\n    name: '',\n    threshold: 50,\n    : '',\n  },\n  { name: '', threshold: 75, : '' },\n  { name: '', threshold: 90, : '' },\n] as const;\n\nexport const  = [\n  { : 'F', : -5, : 100 },\n  { : 'E', : -3, : 200 },\n  { : 'D', : -1, : 300 },\n  { : 'C', : 0, : 400 },\n  { : 'B', : 2, : 500 },\n  { : 'A', : 5, : 600 },\n  { : 'S', : 10, : 800 },\n  { : 'SS', : 15, : 1000 },\n  { : 'SSS', : 20, : Infinity },\n] as const;\n\ntype  = (typeof )[number][''];\nconst  = z.enum(['F', 'E', 'D', 'C', 'B', 'A', 'S', 'SS', 'SSS']);\n\nconst findStage = (value: number, stages: readonly { name: string; threshold: number }[]) => {\n  let currentStage = stages[0];\n  for (const stage of stages) {\n    if (value >= stage.threshold) {\n      currentStage = stage;\n    } else {\n      break;\n    }\n  }\n  return currentStage.name;\n};\n\n// --- Zod Schema  ---\n\nexport const Schema = z\n  .object({\n    : z\n      .object({\n        : z.coerce.number().default(0),\n        : z.coerce.number().default(0),\n        : z.coerce.number().default(0),\n      })\n      .default({ : 0, : 0, : 0 }),\n    : z\n      .object({\n        : z.string().default(''),\n        : z.string().default(''),\n        : z.string().default(''),\n      })\n      .default({ : '', : '', : '' }),\n    : z.string().default(''),\n  })\n  .default({\n    : { : 0, : 0, : 0 },\n    : { : '', : '', : '' },\n    : '',\n  })\n  .transform(val => {\n    val.. = findStage(val.., .);\n    val.. = findStage(val.., .);\n    val.. = findStage(val.., .);\n    return val;\n  });\n\nexport const Schema = z.object({\n  ID: z.string().default(() => `card_${new Date().getTime()}`),\n  : z.enum(['', '', '', '', '', '', '', '', '']),\n  : .default('F'),\n  : z.string().default(''),\n  : z.string().default(''),\n  : z.string().url().or(z.literal('')).default(''),\n  : z.string().default(''),\n});\n\nexport const Schema = z.object({\n  : z.enum(['', '']),\n  : .default('F'),\n  : z.string().default(''),\n  : z.discriminatedUnion('', [\n    z.object({\n      : z.literal(''),\n      : z.string(),\n      : z.enum(['', '', '', '']),\n      : z.coerce.number(),\n      : z.coerce\n        .number()\n        .transform(v => Math.max(0, Math.min(v, 100)))\n        .default(100),\n    }),\n    z.object({\n      : z.literal(''),\n      : z.string(),\n    }),\n  ]),\n});\n\nexport const Schema = z\n  .object({\n    : .default('C'),\n    : z.coerce.number().default(0),\n    : z.coerce.number().default(0),\n  })\n  .transform(val => {\n    const currentLevelInfo = .find(l => l. === val.);\n    if (currentLevelInfo) {\n      val. = currentLevelInfo.;\n      if (val. >= currentLevelInfo. && currentLevelInfo. !== Infinity) {\n        const nextLevelIndex = .findIndex(l => l. === val.) + 1;\n        if (nextLevelIndex < .length) {\n          const nextLevelInfo = [nextLevelIndex];\n          val. = nextLevelInfo.;\n          val. -= currentLevelInfo.;\n          val. = nextLevelInfo.;\n        }\n      }\n    }\n    return val;\n  });\n\nexport const Schema = z.object({\n  : z.string().default(''),\n  : z.array(z.object({ : z.string(), : z.string() })).default([]),\n  : z\n    .object({\n      : z.coerce.date().default(() => new Date('1996-01-01')),\n      : z.coerce.number().default(17),\n      : z.string().default(''),\n      : z.string().default(''),\n      : z.string().default(''),\n    })\n    .default({\n      : new Date('1996-01-01'),\n      : 17,\n      : '',\n      : '',\n      : '',\n    }),\n  : z\n    .object({\n      : z.coerce\n        .number()\n        .transform(v => Math.max(0, Math.min(v, 100)))\n        .default(80),\n      : z.string().default(''),\n      : z\n        .record(z.enum(['', '', '', '', '']), z.coerce.number())\n        .default({ : 50, : 30, : 10, : 10, : 10 }),\n      : z.array(z.object({ : z.string(), : z.string() })).default([]),\n    })\n    .default({\n      : 80,\n      : '',\n      : { : 50, : 30, : 10, : 10, : 10 },\n      : [],\n    })\n    .transform((val: any) => {\n      if (val.) val. = findStage(val., );\n      return val;\n    }),\n  : z.array(z.object({ : z.string(), : z.string() })).default([]),\n  : z.record(z.enum(['', '', '', '', '', '']), Schema).optional(),\n  : z.record(z.string(), Schema).optional(),\n  : z\n    .array(\n      z.object({\n        : z.coerce.date(),\n        : z.string(),\n        : z.enum(['', '', '', '', '', '']),\n        : z.string(),\n      }),\n    )\n    .default([]),\n  : z.record(z.string(), z.object({ : z.coerce.number().default(1) })).optional(),\n  : z.array(z.string()).default([]),\n  : z.string().default(''),\n});\n\nexport const RootSchema = z.object({\n  : z\n    .object({\n      : z.coerce.date().default(() => new Date('2013-04-12T15:30:00')),\n      : z.string().default(''),\n      : z.enum(['', '', '', '', '', '', '', '', '']).default(''),\n      : z\n        .object({\n          : z.string().default(''),\n          : z.coerce.number().default(1),\n          : z.coerce.number().default(1),\n          : z.string().default(''),\n        })\n        .default({\n          : '',\n          : 1,\n          : 1,\n          : '',\n        }),\n    })\n    .default({\n      : new Date('2013-04-12T15:30:00'),\n      : '',\n      : '',\n      : {\n        : '',\n        : 1,\n        : 1,\n        : '',\n      },\n    }),\n  : z.record(z.string(), Schema.or(z.literal(''))).default({\n    Yukinoshita_Yukino: '',\n    Hikigaya_Hachiman: '',\n    Yuigahama_Yui: '',\n  }),\n  : z.record(z.string(), Schema.or(z.literal(''))).default({}),\n  : z\n    .object({\n      : z.coerce.date().default(() => new Date('2013-04-13T00:00:00')),\n      : z.record(Schema.shape., z.array(z.string())).default({\n        : [],\n        : [],\n        : [],\n        : [],\n        : [],\n        : [],\n        : [],\n        : [],\n        : [],\n      }),\n      : z.record(z.string(), Schema).default({}),\n      : z.record(z.string(), z.array(z.string())).default({}),\n    })\n    .default({\n      : new Date('2013-04-13T00:00:00'),\n      : {\n        : [],\n        : [],\n        : [],\n        : [],\n        : [],\n        : [],\n        : [],\n        : [],\n        : [],\n      },\n      : {},\n      : {},\n    }),\n  : z\n    .object({\n      : z\n        .record(\n          z.string(),\n          z.object({\n            : z.string(),\n            : z.string(),\n            : z.enum(['', '', '', '']),\n            : z.string(),\n          }),\n        )\n        .default({}),\n      : z.array(z.string()).default([]),\n      : z.array(z.string()).default([]),\n    })\n    .default({\n      : {},\n      : [],\n      : [],\n    }),\n});\n\n// --- TypeScript  ---\n\nexport type  = z.infer<typeof Schema>;\nexport type  = z.infer<typeof Schema>;\nexport type  = z.infer<typeof Schema>;\nexport type  = z.infer<typeof Schema>;\nexport type  = z.infer<typeof Schema>;\nexport type  = z.infer<typeof RootSchema>;\n\nexport interface AppState {\n  isReady: boolean;\n  worldState:  | null;\n  narrative: string;\n  mainWorldNarrative: string;\n  avatarWorldNarrative: string;\n  activeView: 'mainWorld' | 'avatarWorld' | null;\n  isGenerating: boolean;\n  generationError: string | null;\n  lastSubmittedAction: string | null;\n  worldLog: any[];\n}\n\nexport interface WorldLogEntry {\n  : number;\n  : string;\n  : string;\n  : string;\n  : string;\n  : string;\n  ?: string;\n  ?: string;\n  ?: string;\n  ?: string;\n}\n","import { reactive, watch } from 'vue';\nimport type { AppState } from '../types';\n\n// ID\nexport const USER_ID = '{{user}}';\n\n//  AppState \nconst initialState: AppState = {\n  isReady: false,\n  worldState: null,\n  // narrative  mainWorldNarrative  avatarWorldNarrative UI\n  narrative: '...',\n  mainWorldNarrative: '...',\n  avatarWorldNarrative: '',\n  activeView: 'mainWorld', // \n  isGenerating: false,\n  generationError: null as string | null,\n  lastSubmittedAction: null,\n  worldLog: [],\n};\n\n//  reactive  store\nexport const store = reactive<AppState>({\n  ...initialState,\n});\n\n//  watch \nwatch(\n  () => store.worldState,\n  (newState, oldState) => {\n    console.log('[State Watch] worldState changed.');\n    //  watch \n    if (newState) {\n      console.log(':', newState.);\n    }\n  },\n  { deep: true },\n);\n\nwatch(\n  () => store.isReady,\n  (isReady: boolean) => {\n    console.log(`[State Watch] Store is now ${isReady ? 'ready' : 'not ready'}.`);\n  },\n);\n","import { cloneDeep, get } from 'lodash';\nimport { z } from 'zod';\nimport { contextService } from '../services/ContextService';\nimport { lorebookService } from '../services/LorebookService';\nimport { notificationService } from '../services/NotificationService';\nimport { serviceLocator } from '../services/service-locator';\nimport { tavernService } from '../services/tavern';\nimport { processTags } from '../utils/tagProcessor';\nimport type {  } from '../types';\nimport { RootSchema } from '../types';\nimport { store, USER_ID } from './state';\n\nfunction sanitizeStateData(data: any): any {\n  if (!data) return null;\n  return data.stat_data || data;\n}\n\nlet lastProcessedMessageId: string | null = null;\nlet isLogHistoryLoaded = false;\nconst ZOD_ERROR_NOTIFIED_KEY = 'zodErrorNotified';\nlet isZodErrorNotified = sessionStorage.getItem(ZOD_ERROR_NOTIFIED_KEY) === 'true';\n\nfunction checkForChangesAndNotify(oldState:  | null, newState:  | null) {\n  if (!oldState || !newState) return;\n\n  // 1. \n  const oldCharIds = Object.keys(oldState.);\n  const newCharIds = Object.keys(newState.);\n  for (const charId of newCharIds) {\n    if (!oldCharIds.includes(charId)) {\n      const newChar = newState.[charId];\n      if (typeof newChar !== 'string') {\n        notificationService.info('', ` ${newChar.}`);\n      }\n    }\n  }\n\n  // 2. \n  for (const relId in newState.) {\n    const oldRel = oldState.[relId];\n    const newRel = newState.[relId];\n    if (oldRel && newRel && typeof oldRel !== 'string' && typeof newRel !== 'string') {\n      if (oldRel.. !== newRel..) {\n        const targetName = relId.replace(USER_ID, '').replace('-', '');\n        notificationService.success('', ` ${targetName}  ${newRel..}`);\n      }\n    }\n  }\n\n  // 3. \n  for (const charId in newState.) {\n    const oldChar = oldState.[charId];\n    const newChar = newState.[charId];\n    if (oldChar && newChar && typeof oldChar !== 'string' && typeof newChar !== 'string') {\n      if (!oldChar. || !newChar.) continue;\n      for (const attrKey in newChar.) {\n        const oldAttr = oldChar.[attrKey as keyof typeof oldChar.];\n        const newAttr = newChar.[attrKey as keyof typeof newChar.];\n        if (oldAttr && newAttr && oldAttr. !== newAttr.) {\n          notificationService.info('', `${newChar.}'${attrKey}' ${newAttr.} !`);\n        }\n      }\n    }\n  }\n\n  // 4. \n  if (newState. && oldState.) {\n    const oldCardIds = Object.keys(oldState..);\n    const newCardIds = Object.keys(newState..);\n    for (const cardId of newCardIds) {\n      if (!oldCardIds.includes(cardId)) {\n        const newCard = newState..[cardId];\n        notificationService.success('', ` [${newCard.}] ${newCard.}`);\n      }\n    }\n  }\n\n  // 5. \n  if (newState. && oldState.) {\n    const oldQuestIds = Object.keys(oldState..);\n    const newQuestIds = Object.keys(newState..);\n    for (const questId of newQuestIds) {\n      if (!oldQuestIds.includes(questId)) {\n        const newQuest = newState..[questId];\n        notificationService.warn('', ` ${newQuest.} : ${newQuest.}`);\n      }\n    }\n  }\n}\n\nasync function loadWorldLogFromLorebook() {\n  try {\n    const logContent = await lorebookService.readFromLorebook('');\n    if (!logContent || !logContent.trim()) {\n      store.worldLog = [];\n      return;\n    }\n    // Log parsing logic needs to be adapted here\n  } catch (error) {\n    console.error('Error loading world log from lorebook:', error);\n    store.worldLog = [];\n  }\n}\n\nasync function fetchCoreData() {\n  try {\n    const messages = await tavernService.fetchTavernData();\n    if (messages && messages.length > 0 && messages[0].data) {\n      const rawStateData = sanitizeStateData(messages[0].data);\n      const oldState = cloneDeep(store.worldState);\n      const parseResult = RootSchema.safeParse(rawStateData);\n\n      if (parseResult.success) {\n        store.worldState = parseResult.data;\n        if (isZodErrorNotified) sessionStorage.removeItem(ZOD_ERROR_NOTIFIED_KEY);\n        isZodErrorNotified = false;\n      } else {\n        console.error('Zod validation failed:', parseResult.error);\n        if (!isZodErrorNotified) {\n          const firstIssue = parseResult.error.issues[0];\n          const errorMessage = ` [${firstIssue.path.join(' -> ')}] : ${firstIssue.message}`;\n          notificationService.error('', errorMessage);\n          sessionStorage.setItem(ZOD_ERROR_NOTIFIED_KEY, 'true');\n          isZodErrorNotified = true;\n        }\n        store.worldState = rawStateData as ;\n      }\n\n      const fullMessageContent = messages[0].message;\n      const gameTextContent = fullMessageContent?.match(/<gametxt>([\\s\\S]*?)<\\/gametxt>/i)?.[1].trim();\n      if (gameTextContent) {\n        store.mainWorldNarrative = gameTextContent;\n      }\n\n      checkForChangesAndNotify(oldState, store.worldState);\n    }\n  } catch (error) {\n    console.error(':', error);\n  }\n}\n\nasync function loadAllData() {\n  if (!isLogHistoryLoaded) {\n    await loadWorldLogFromLorebook();\n    isLogHistoryLoaded = true;\n  }\n  await fetchCoreData();\n  store.isReady = true;\n  console.log('[Store] Core data for Oregairu-verse loaded.');\n}\n\nfunction parseBlock(block: string): { [key: string]: string } {\n  const data: { [key: string]: string } = {};\n  const lines = block.trim().split('\\n');\n  let currentKey = '';\n  for (const line of lines) {\n    const separatorIndex = line.indexOf('|');\n    if (separatorIndex !== -1) {\n      const key = line.substring(0, separatorIndex).trim();\n      const value = line.substring(separatorIndex + 1).trim();\n      if (key) {\n        // Ensure key is not empty\n        data[key] = value;\n        currentKey = key;\n      }\n    } else if (currentKey && line.trim()) {\n      data[currentKey] += '\\n' + line;\n    }\n  }\n  // Trim the final value for each key\n  for (const key in data) {\n    data[key] = data[key].trim();\n  }\n  return data;\n}\n\nasync function processAiResponse(response: string) {\n  if (!response) return;\n\n  // 1.  <gametxt>\n  const gameTextMatch = response.match(/<gametxt>([\\s\\S]*?)<\\/gametxt>/i);\n  const narrative = gameTextMatch ? gameTextMatch[1].trim() : '';\n  if (narrative || !response.includes('<UpdateVariable>')) {\n    store.mainWorldNarrative = narrative || (response.includes('<thinking>') ? '' : response);\n  }\n\n  // 2.  <>\n  const logRegex = /<>([\\s\\S]+?)<\\/>/g;\n  let logMatch;\n  while ((logMatch = logRegex.exec(response)) !== null) {\n    const block = parseBlock(logMatch[1]);\n    if (block && block['']) {\n      const newLogEntry = {\n        : parseInt(block[''], 10),\n        : block[''] || '',\n        : block[''] || '',\n        : block[''] || '',\n        : block[''] || '',\n        : block[''] || '',\n        : block[''] || '',\n        : block['']\n          ? block['']\n              .replace(/[[\\]\"]/g, '')\n              .split(',')\n              .map(t => t.trim())\n              .filter(Boolean)\n          : [],\n        : block[''] || '',\n        : block[''] || '',\n        : block[''] || '',\n        : block[''] || '',\n      };\n      if (!store.worldLog.some(log => log. === newLogEntry.)) {\n        store.worldLog.push(newLogEntry as any);\n      }\n    }\n  }\n  if (logRegex.test(response)) {\n    // Only sort and save if logs were processed\n    store.worldLog.sort((a, b) => a. - b.);\n    const fullLogContent = store.worldLog\n      .map(log =>\n        Object.entries(log)\n          .map(([key, value]) => `${key}|${Array.isArray(value) ? value.join(',') : value}`)\n          .join('\\n'),\n      )\n      .join('\\n\\n---\\n\\n');\n    await lorebookService.writeToLorebook('', fullLogContent, { isEnabled: true, keys: [''] });\n  }\n\n  // 3.  <UpdateVariable>\n  const updateScriptMatch = response.match(/<UpdateVariable>([\\s\\S]+?)<\\/UpdateVariable>/i);\n  const updateScript = updateScriptMatch ? updateScriptMatch[1].trim() : null;\n\n  if (updateScript) {\n    const jsonPatchMatch = updateScript.match(/<JSONPatch>([\\s\\S]*?)<\\/JSONPatch>/i);\n    if (jsonPatchMatch && jsonPatchMatch[1]) {\n      const patchString = jsonPatchMatch[1].trim();\n      try {\n        const patch = JSON.parse(patchString);\n        const oldState = cloneDeep(store.worldState);\n        const newVariables = await tavernService.invokeMvuScript(patch, oldState);\n\n        if (newVariables) {\n          const sanitizedVars = sanitizeStateData(newVariables);\n          const parseResult = RootSchema.safeParse(sanitizedVars);\n          if (parseResult.success) {\n            store.worldState = parseResult.data;\n            if (isZodErrorNotified) sessionStorage.removeItem(ZOD_ERROR_NOTIFIED_KEY);\n            isZodErrorNotified = false;\n          } else {\n            console.error('Zod validation failed after script execution:', parseResult.error);\n            if (!isZodErrorNotified) {\n              const firstIssue = parseResult.error.issues[0];\n              const errorMessage = ` [${firstIssue.path.join(' -> ')}] : ${firstIssue.message}`;\n              notificationService.error('', errorMessage);\n              sessionStorage.setItem(ZOD_ERROR_NOTIFIED_KEY, 'true');\n              isZodErrorNotified = true;\n            }\n            store.worldState = sanitizedVars as ;\n          }\n          checkForChangesAndNotify(oldState, store.worldState);\n        }\n      } catch (e) {\n        console.error('Failed to parse JSONPatch or apply it:', e);\n        notificationService.error('', 'AI');\n      }\n    }\n  }\n}\n\nasync function handleAction(actionText: string) {\n  if (!actionText.trim()) return;\n  if (!store.isReady) await loadAllData();\n\n  store.isGenerating = true;\n  store.lastSubmittedAction = actionText;\n\n  try {\n    const intent = contextService.analyzeUserIntent(actionText, store.worldState, []);\n    const contextVariables = contextService.buildLeanContext(intent, actionText, store.worldState, USER_ID);\n\n    console.log('[Actions] Generating AI response with Oregairu context variables.');\n\n    const rawAiResponse = await tavernService.generateAiResponse(actionText, contextVariables);\n    const aiResponseString = processTags(rawAiResponse);\n\n    await processAiResponse(aiResponseString);\n\n    const messages = await tavernService.fetchTavernData();\n    if (messages && messages.length > 0) {\n      const messageZero = messages[0];\n      messageZero.message = aiResponseString;\n      const newData = messageZero.data || {};\n      newData.stat_data = cloneDeep(store.worldState);\n      messageZero.data = newData;\n      await TavernHelper.setChatMessages([messageZero], { refresh: 'none' });\n    }\n  } catch (error) {\n    console.error(':', error);\n    const errorMessage = error instanceof Error ? error.message : String(error);\n    store.generationError = `AI: ${errorMessage}`;\n    notificationService.error('', 'AI');\n  } finally {\n    setTimeout(\n      () => {\n        store.isGenerating = false;\n        store.generationError = null;\n      },\n      store.generationError ? 5000 : 0,\n    );\n  }\n}\n\nlet isInitialized = false;\n\nfunction initializeEventListeners() {\n  if (isInitialized) return;\n  console.log('[Store] Initializing event listeners for Oregairu-verse...');\n\n  eventOn(tavern_events.GENERATION_ENDED, () => {\n    setTimeout(() => fetchCoreData(), 500);\n  });\n\n  isInitialized = true;\n  console.log('[Store] Event listeners are active.');\n}\n\nexport const actions = {\n  loadAllData,\n  handleAction,\n  rerollLastAction: async () => {\n    const saveLoadService = serviceLocator.get('saveLoadService');\n    console.log('[Actions] Reroll requested.');\n    try {\n      notificationService.info('...', '');\n      await saveLoadService.loadRerollState();\n    } catch (error) {\n      console.error('Reroll failed:', error);\n      notificationService.error('', error instanceof Error ? error.message : '');\n    }\n  },\n  initializeEventListeners,\n};\n","/**\n * AI &#x60;<thinking>&#x60;  &#x60;<gametxt>&#x60; \n * @param text - AI\n * @returns - \n */\nexport function processTags(text: string): string {\n  let processedText = text;\n\n  // \n  //  thinking \n  processedText = processedText.replace(/<\\/?think(ing)?>/g, match => {\n    return match.startsWith('</') ? '</thinking>' : '<thinking>';\n  });\n\n  //  gametxt \n  processedText = processedText.replace(/<\\/?(game-?txt|gamet-?xt|gametxtt)>/g, match => {\n    return match.startsWith('</') ? '</gametxt>' : '<gametxt>';\n  });\n\n  // 1.  <thinking> \n  if (!processedText.includes('<thinking>')) {\n    processedText = '<thinking>\\n</thinking>\\n' + processedText;\n  }\n\n  // 2.  <thinking> \n  const thinkingOpenIndex = processedText.indexOf('<thinking>');\n  const thinkingCloseIndex = processedText.indexOf('</thinking>');\n  const gametxtOpenIndex = processedText.indexOf('<gametxt>');\n\n  if (thinkingOpenIndex !== -1 && thinkingCloseIndex === -1) {\n    if (gametxtOpenIndex !== -1 && gametxtOpenIndex > thinkingOpenIndex) {\n      //  <gametxt> \n      processedText =\n        processedText.slice(0, gametxtOpenIndex) + '</thinking>\\n' + processedText.slice(gametxtOpenIndex);\n    } else {\n      //  <gametxt>\n      processedText += '\\n</thinking>';\n    }\n  }\n\n  // 3.  <thinking>  <  > \n  const thinkingRegex = /<thinking>([\\s\\S]*?)<\\/thinking>/g;\n  processedText = processedText.replace(thinkingRegex, (match, content) => {\n    const sanitizedContent = content.replace(/<|>/g, '');\n    return `<thinking>${sanitizedContent}</thinking>`;\n  });\n\n  //  thinkingCloseIndex\n  const newThinkingCloseIndex = processedText.indexOf('</thinking>');\n\n  // 4.  <gametxt>  </thinking> \n  if (newThinkingCloseIndex !== -1 && !processedText.includes('<gametxt>')) {\n    processedText =\n      processedText.slice(0, newThinkingCloseIndex + '</thinking>'.length) +\n      '\\n<gametxt></gametxt>' +\n      processedText.slice(newThinkingCloseIndex + '</thinking>'.length);\n  }\n\n  // 5.  <gametxt> \n  const gametxtOpenIndexAgain = processedText.indexOf('<gametxt>');\n  const gametxtCloseIndex = processedText.indexOf('</gametxt>');\n\n  if (gametxtOpenIndexAgain !== -1 && gametxtCloseIndex === -1) {\n    //  < \n    const nextTagIndex = processedText.indexOf('<', gametxtOpenIndexAgain + '<gametxt>'.length);\n    if (nextTagIndex !== -1) {\n      processedText = processedText.slice(0, nextTagIndex) + '</gametxt>\\n' + processedText.slice(nextTagIndex);\n    } else {\n      // \n      processedText += '\\n</gametxt>';\n    }\n  }\n\n  return processedText;\n}\n","import { reactive, readonly } from 'vue';\nimport { store } from '../store';\n\ninterface InputModalState {\n  isVisible: boolean;\n  inputValue: string;\n  lastSubmittedValue: string;\n}\n\nconst STORAGE_KEY = 'reincarnation-simulator-input-value';\nconst LAST_SUBMITTED_STORAGE_KEY = 'reincarnation-simulator-last-submitted';\n\nconst state = reactive<InputModalState>({\n  isVisible: false,\n  inputValue: localStorage.getItem(STORAGE_KEY) || '',\n  lastSubmittedValue: localStorage.getItem(LAST_SUBMITTED_STORAGE_KEY) || '',\n});\n\nconst actions = {\n  show(): void {\n    if (store.generationError) {\n      // \n      state.inputValue = state.lastSubmittedValue;\n    }\n    state.isVisible = true;\n  },\n\n  hide(): void {\n    state.isVisible = false;\n  },\n\n  setValue(value: string): void {\n    state.inputValue = value;\n    localStorage.setItem(STORAGE_KEY, value);\n  },\n\n  setLastSubmittedValue(value: string): void {\n    state.lastSubmittedValue = value;\n    localStorage.setItem(LAST_SUBMITTED_STORAGE_KEY, value);\n  },\n\n  clearValue(): void {\n    state.inputValue = '';\n    localStorage.removeItem(STORAGE_KEY);\n  },\n};\n\nexport const inputModalState = readonly(state);\nexport const inputModalActions = actions;\n","type EventCallback = (...args: any[]) => void;\n\nclass EventBus {\n  private events: Record<string, EventCallback[]> = {};\n\n  on(event: string, callback: EventCallback): void {\n    if (!this.events[event]) {\n      this.events[event] = [];\n    }\n    this.events[event].push(callback);\n  }\n\n  off(event: string, callback: EventCallback): void {\n    if (!this.events[event]) return;\n    this.events[event] = this.events[event].filter(cb => cb !== callback);\n  }\n\n  emit(event: string, ...args: any[]): void {\n    if (!this.events[event]) return;\n    this.events[event].forEach(callback => {\n      try {\n        callback(...args);\n      } catch (e) {\n        console.error(`Error in event handler for ${event}:`, e);\n      }\n    });\n  }\n}\n\nexport const eventBus = new EventBus();\n","import { eventBus } from './EventBus';\nimport { lorebookService } from './LorebookService';\nimport type { WorldLogEntry } from '../types';\n\nclass MemoryService {\n  private readonly INSTANT_MEMORY_KEY = '[]';\n  private readonly SHORT_TERM_MEMORY_KEY = '[]';\n  private readonly LONG_TERM_MEMORY_KEY = '[]';\n\n  private config = {\n    instantMemoryCount: 15,\n    shortTermMemoryCount: 30,\n    longTermMemoryCount: 60,\n  };\n\n  public async updateMemory(worldLog: WorldLogEntry[]): Promise<void> {\n    console.log('[MemoryService] Updating all memory tiers for Oregairu-verse...');\n    try {\n      await this.updateInstantMemory(worldLog);\n      await this.updateShortTermMemory(worldLog);\n      await this.updateLongTermMemory(worldLog);\n      console.log('[MemoryService] All memory tiers updated successfully.');\n      eventBus.emit('memoryUpdated');\n    } catch (error) {\n      console.error('[MemoryService] Failed to update memory tiers:', error);\n    }\n  }\n\n  public async updateInstantMemory(worldLog: WorldLogEntry[]): Promise<void> {\n    const logs = worldLog.slice(-this.config.instantMemoryCount);\n    if (logs.length === 0) {\n      await this.writeMemory(this.INSTANT_MEMORY_KEY, '');\n      return;\n    }\n\n    const newContent = logs\n      .map(log => {\n        return [\n          `|${log.}`,\n          `|${log.}`,\n          `|${log.}`,\n          `|${log.}`,\n          `|${log.}`,\n          `|${log.}`,\n          `|${log. || ''}`,\n          `|${log. || ''}`,\n          `|${log. || ''}`,\n          `|${log. || ''}`,\n        ].join('\\n');\n      })\n      .join('\\n\\n---\\n\\n');\n\n    await this.writeMemory(this.INSTANT_MEMORY_KEY, newContent.trim());\n    console.log('[MemoryService] Instant memory updated.');\n  }\n\n  public async updateShortTermMemory(worldLog: WorldLogEntry[]): Promise<void> {\n    const logs = worldLog.slice(-this.config.shortTermMemoryCount);\n    if (logs.length === 0) {\n      await this.writeMemory(this.SHORT_TERM_MEMORY_KEY, '');\n      return;\n    }\n\n    const newContent = logs\n      .map(log => {\n        const coreInteraction = log.?.match(/(.*?)(|$)/)?.[1] || '';\n        const relationChange = log.?.match(/(.*?)(|$)/)?.[1] || '';\n        return [\n          `|${log.}`,\n          `|${log.}`,\n          `|${log.}`,\n          `|${log.}`,\n          `|${coreInteraction}`,\n          `|${relationChange}`,\n        ].join('\\n');\n      })\n      .join('\\n\\n---\\n\\n');\n\n    await this.writeMemory(this.SHORT_TERM_MEMORY_KEY, newContent.trim());\n    console.log('[MemoryService] Short-term memory updated.');\n  }\n\n  public async updateLongTermMemory(worldLog: WorldLogEntry[]): Promise<void> {\n    const logs = worldLog.slice(-this.config.longTermMemoryCount);\n    if (logs.length === 0) {\n      await this.writeMemory(this.LONG_TERM_MEMORY_KEY, '');\n      return;\n    }\n\n    const newContent = logs\n      .map(log => {\n        const coreConflict = log.?.match(/(.*?)(|$)/)?.[1] || '';\n        return [`|${log.}`, `|${log.}`, `|${coreConflict}`].join('\\n');\n      })\n      .join('\\n\\n---\\n\\n');\n\n    await this.writeMemory(this.LONG_TERM_MEMORY_KEY, newContent.trim());\n    console.log('[MemoryService] Long-term memory updated.');\n  }\n\n  private async writeMemory(key: string, content: string): Promise<void> {\n    await lorebookService.writeToLorebook(key, content, {\n      isEnabled: true,\n      keys: [key],\n    });\n  }\n\n  public getConfig() {\n    return this.config;\n  }\n\n  public setConfig(newConfig: Partial<typeof this.config>) {\n    this.config = { ...this.config, ...newConfig };\n    console.log('[MemoryService] Config updated:', this.config);\n  }\n}\n\nexport const memoryService = new MemoryService();\n","import { store } from '../store';\nimport type { WorldLogEntry } from '../types';\nimport { lorebookService } from './LorebookService';\nimport { memoryService } from './MemoryService';\nimport { notificationService } from './NotificationService';\nimport { tavernService } from './tavern';\n\n/**\n * \n * ( actions.ts )\n */\nfunction parseBlock(block: string): { [key: string]: string } {\n  const data: { [key: string]: string } = {};\n  const lines = block.trim().split('\\n');\n  let currentKey = '';\n  for (const line of lines) {\n    const separatorIndex = line.indexOf('|');\n    if (separatorIndex !== -1) {\n      const key = line.substring(0, separatorIndex).trim();\n      const value = line.substring(separatorIndex + 1).trim();\n      data[key] = value;\n      currentKey = key;\n    } else if (currentKey && line.trim()) {\n      data[currentKey] += '\\n' + line;\n    }\n  }\n  for (const key in data) {\n    data[key] = data[key].trim();\n  }\n  return data;\n}\n\nclass LogSyncService {\n  private pollingInterval: any | null = null;\n  private isSyncing = false;\n\n  public startPolling(interval = 15000) {\n    if (this.pollingInterval) {\n      this.stopPolling();\n    }\n    console.log(`[LogSyncService] Starting to poll chat history every ${interval}ms.`);\n    this.pollingInterval = setInterval(() => this.syncLogsFromChat(), interval);\n    this.syncLogsFromChat(); // \n  }\n\n  public stopPolling() {\n    if (this.pollingInterval) {\n      clearInterval(this.pollingInterval);\n      this.pollingInterval = null;\n      console.log('[LogSyncService] Stopped polling chat history.');\n    }\n  }\n\n  public async syncLogsFromChat() {\n    if (this.isSyncing) {\n      console.log('[LogSyncService] Sync is already in progress. Skipping.');\n      return;\n    }\n    this.isSyncing = true;\n    console.log('[LogSyncService] Starting log sync from chat history...');\n\n    try {\n      const messages = await tavernService.fetchTavernData();\n      if (!messages) {\n        this.isSyncing = false;\n        return;\n      }\n\n      const allParsedLogs: WorldLogEntry[] = [];\n      const logBlockRegex = /<>([\\s\\S]+?)<\\/>/g;\n\n      for (const message of messages) {\n        if (message.is_user) continue; // AI\n\n        let match;\n        while ((match = logBlockRegex.exec(message.message)) !== null) {\n          try {\n            const block = parseBlock(match[1]);\n            if (block && block['']) {\n              allParsedLogs.push({\n                : parseInt(block[''], 10),\n                : block[''] || '',\n                : block[''] || '',\n                : block[''] || '',\n                : block[''] || '',\n                : block[''] || '',\n                : block[''] || '',\n                : block['']\n                  ? block['']\n                      .replace(/[[\\]\"]/g, '')\n                      .split(',')\n                      .map(t => t.trim())\n                      .filter(Boolean)\n                  : [],\n                : block[''] || '',\n                : block[''] || '',\n                : block[''] || '',\n                : block[''] || '',\n              });\n            }\n          } catch (e) {\n            console.error('[LogSyncService] Failed to parse a log block:', e);\n          }\n        }\n      }\n\n      if (allParsedLogs.length === 0) {\n        console.log('[LogSyncService] No new log entries found in recent chat history.');\n        this.isSyncing = false;\n        return;\n      }\n\n      const existingLogIds = new Set(store.worldLog.map(log => log.));\n      const newLogs = allParsedLogs.filter(log => !existingLogIds.has(log.) && !isNaN(log.));\n\n      if (newLogs.length > 0) {\n        // \n        newLogs.sort((a, b) => a. - b.);\n\n        // \n        store.worldLog = [...store.worldLog, ...newLogs].sort((a, b) => a. - b.);\n\n        // \n        const contentToAppend = newLogs\n          .map(log => {\n            return Object.entries(log)\n              .map(([key, value]) => `${key}|${Array.isArray(value) ? value.join(', ') : value}`)\n              .join('\\n');\n          })\n          .join('\\n\\n---\\n\\n');\n\n        const existingContent = await lorebookService.readFromLorebook('');\n        const finalContentToAppend = newLogs\n          .map(log => {\n            const logBlock = Object.entries(log)\n              .map(([key, value]) => `${key}|${Array.isArray(value) ? value.join(', ') : value}`)\n              .join('\\n');\n            // \n            return existingContent && existingContent.includes(`|${log.}`) ? null : logBlock;\n          })\n          .filter(Boolean) //  null\n          .join('\\n\\n---\\n\\n');\n\n        if (finalContentToAppend) {\n          await lorebookService.appendToEntry('', finalContentToAppend, '\\n\\n---\\n\\n');\n          notificationService.success('', ` ${newLogs.length} `);\n          console.log(`[LogSyncService] Appended ${newLogs.length} new log entries to Lorebook.`);\n        } else {\n          console.log('[LogSyncService] All new logs were already present in the Lorebook entry. No changes made.');\n        }\n        notificationService.success('', ` ${newLogs.length} `);\n        console.log(`[LogSyncService] Synced ${newLogs.length} new log entries.`);\n      } else {\n        console.log('[LogSyncService] All found logs are already present in the store.');\n      }\n    } catch (error) {\n      console.error('[LogSyncService] Error during log sync:', error);\n    } finally {\n      // \n      try {\n        await memoryService.updateInstantMemory(store.worldLog);\n        await memoryService.updateShortTermMemory(store.worldLog);\n        await memoryService.updateLongTermMemory(store.worldLog);\n        console.log('[LogSyncService] Silently updated all memory tiers after sync.');\n      } catch (memError) {\n        console.error('[LogSyncService] Failed to silently update memory tiers after sync:', memError);\n      }\n      this.isSyncing = false;\n    }\n  }\n}\n\nexport const logSyncService = new LogSyncService();\n","import { get } from 'lodash';\nimport { computed, reactive } from 'vue';\nimport { store, USER_ID } from '../store';\nimport type {  } from '../types';\n\nconst locationCache = reactive(new Map<string, { name: string; parentId: string | null }>());\n\n/**\n * NPC\n */\nconst allNpcs = computed(() => {\n  const worldState = store.worldState;\n  if (!worldState?.) return [];\n\n  const npcs: [] = [];\n  for (const charId in worldState.) {\n    if (charId === USER_ID) continue;\n\n    const char = worldState.[charId];\n    if (char && typeof char !== 'string') {\n      npcs.push(char);\n    }\n  }\n  return npcs;\n});\n\n/**\n * NPC\n */\nasync function initializeWorldAndLocationData(): Promise<void> {\n  const worldState = store.worldState;\n  if (!worldState) {\n    console.warn('[NpcService] worldState is not available for initialization.');\n    return;\n  }\n  locationCache.clear();\n  console.log('[NpcService] Location cache cleared for Oregairu-verse.');\n}\n\nfunction getLocationName(id: string): string {\n  return locationCache.get(id)?.name || id;\n}\n\nfunction getParentLocationName(id: string): string {\n  const parentId = locationCache.get(id)?.parentId;\n  if (!parentId) return '';\n  return locationCache.get(parentId)?.name || '';\n}\n\nfunction getNpcNameById(id: string): string {\n  const char = get(store, `worldState..${id}`);\n  if (char && typeof char !== 'string') {\n    return char.;\n  }\n  return id === USER_ID ? '' : id;\n}\n\nfunction getNpcId(npc: ): string | null {\n  const worldState = store.worldState;\n  if (!worldState?.) return null;\n\n  for (const id in worldState.) {\n    if (worldState.[id] === npc) {\n      return id;\n    }\n  }\n  return null;\n}\n\nexport const npcService = {\n  allNpcs,\n  initializeWorldAndLocationData,\n  getLocationName,\n  getNpcNameById,\n  getNpcId,\n  locationCache,\n  getParentLocationName,\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = toastr;","import * as toastr from 'toastr';\nimport { lorebookService } from './LorebookService';\nimport { serviceLocator } from './service-locator';\n\nconst LOREBOOK_NAME = '-';\nconst SAVE_SLOT_PREFIX = '-';\nconst MAX_MANUAL_SAVES = 5;\nconst AUTO_SAVE_SLOTS = ['-A', '-B'];\nconst REROLL_SAVE_SLOT_ID = '-';\nconst LOREBOOK_KEYS_TO_BACKUP: string[] = [\n  '[]',\n  '[]',\n  '[]',\n  '',\n  // \n];\n\nexport interface SaveSlot {\n  id: string;\n  name: string;\n  timestamp: string | null;\n  data: any | null;\n  entryUid?: number;\n  worldLogDate?: string | null;\n  worldLogTitle?: string | null;\n}\n\nclass SaveLoadService {\n  public manualSlots: SaveSlot[] = [];\n  public autoSlots: SaveSlot[] = [];\n  public rerollSlot: SaveSlot | null = null;\n  public turnCounter: number = 0;\n  public isAutoSaveEnabled: boolean = true;\n  private autoSaveInterval: any;\n  private areSlotsLoaded = false;\n\n  constructor() {\n    this.initializeSlots();\n    this.loadAutoSaveState();\n    this.loadTurnCounter();\n    // \n  }\n\n  private async ensureSlotsLoaded() {\n    if (!this.areSlotsLoaded) {\n      await this.loadAllSaveSlots();\n      this.areSlotsLoaded = true;\n    }\n  }\n\n  private initializeSlots() {\n    for (let i = 1; i <= MAX_MANUAL_SAVES; i++) {\n      this.manualSlots.push({ id: `-${i}`, name: ` ${i}`, timestamp: null, data: null });\n    }\n    for (const id of AUTO_SAVE_SLOTS) {\n      this.autoSlots.push({ id, name: ` ${id.split('-')[1]}`, timestamp: null, data: null });\n    }\n    this.rerollSlot = { id: REROLL_SAVE_SLOT_ID, name: '', timestamp: null, data: null };\n  }\n\n  async loadAllSaveSlots() {\n    try {\n      const allEntries = await TavernHelper.getLorebookEntries(LOREBOOK_NAME);\n      if (!allEntries) return;\n\n      const updateSlot = (slot: SaveSlot) => {\n        const entry = allEntries.find((e: any) => e.comment === `${SAVE_SLOT_PREFIX}${slot.id}`);\n        if (entry && entry.content) {\n          try {\n            slot.data = JSON.parse(entry.content);\n            slot.timestamp = slot.data.timestamp;\n            slot.worldLogDate = slot.data.worldLogDate;\n            slot.worldLogTitle = slot.data.worldLogTitle;\n            slot.entryUid = entry.uid;\n          } catch (e) {\n            console.error(` ${slot.id} :`, e);\n            slot.timestamp = '';\n            slot.data = null;\n          }\n        } else {\n          slot.timestamp = null;\n          slot.data = null;\n          slot.entryUid = undefined;\n        }\n      };\n\n      this.manualSlots.forEach(updateSlot);\n      this.autoSlots.forEach(updateSlot);\n      if (this.rerollSlot) {\n        updateSlot(this.rerollSlot);\n      }\n    } catch (error) {\n      console.error(':', error);\n      toastr.error('');\n    }\n  }\n\n  async saveGame(slotId: string, isAutoSave = false) {\n    await this.ensureSlotsLoaded(); // \n    if (!isAutoSave) {\n      toastr.info(` [${slotId}]...`);\n    }\n\n    try {\n      const messages = await TavernHelper.getChatMessages('0');\n      if (!messages || messages.length === 0) {\n        throw new Error('');\n      }\n      const messageZero = messages[0];\n      const timestamp = new Date().toISOString();\n\n      const lorebookBackup: { [key: string]: string } = {};\n      for (const key of LOREBOOK_KEYS_TO_BACKUP) {\n        const content = await lorebookService.readFromLorebook(key);\n        lorebookBackup[key] = content ?? '';\n      }\n\n      const store = serviceLocator.get('store');\n      const lastLogEntry = store.worldLog.length > 0 ? store.worldLog[store.worldLog.length - 1] : null;\n\n      const saveData = {\n        timestamp,\n        mvu_data: messageZero.data,\n        message_content: messageZero.message,\n        lorebook_backup: lorebookBackup,\n        worldLogDate: lastLogEntry?.,\n        worldLogTitle: lastLogEntry?.,\n      };\n\n      const comment = `${SAVE_SLOT_PREFIX}${slotId}`;\n      const allEntries = await TavernHelper.getLorebookEntries(LOREBOOK_NAME);\n      const existingEntry = allEntries.find((e: any) => e.comment === comment);\n\n      if (existingEntry) {\n        await TavernHelper.setLorebookEntries(LOREBOOK_NAME, [\n          { uid: existingEntry.uid, content: JSON.stringify(saveData, null, 2) },\n        ]);\n      } else {\n        await TavernHelper.createLorebookEntries(LOREBOOK_NAME, [\n          {\n            comment: comment,\n            content: JSON.stringify(saveData, null, 2),\n            keys: [comment],\n            position: 'after_character_definition',\n            order: 200,\n          },\n        ]);\n      }\n\n      await this.loadAllSaveSlots();\n      if (!isAutoSave) {\n        toastr.success(` [${slotId}]`);\n      } else {\n        console.log(`[AutoSave]  ${slotId}`);\n      }\n    } catch (error) {\n      const errorMessage = `: ${error instanceof Error ? error.message : String(error)}`;\n      console.error(` ${slotId} :`, error);\n      if (!isAutoSave) {\n        toastr.error(errorMessage);\n      }\n    }\n  }\n\n  private async _internalLoadGame(slot: SaveSlot) {\n    if (!slot.data || !slot.data.mvu_data) {\n      throw new Error('');\n    }\n    if (slot.data.lorebook_backup) {\n      for (const key in slot.data.lorebook_backup) {\n        await lorebookService.writeToLorebook(key, slot.data.lorebook_backup[key]);\n      }\n    }\n    const messages = await TavernHelper.getChatMessages('0');\n    const messageZero = messages[0] || {};\n    messageZero.data = slot.data.mvu_data;\n    messageZero.message = slot.data.message_content;\n    await TavernHelper.setChatMessages([messageZero], { refresh: 'all' });\n  }\n\n  async loadGame(slot: SaveSlot) {\n    if (!confirm(` [${slot.name}] `)) {\n      return;\n    }\n    toastr.info(` [${slot.name}] ...`);\n    try {\n      await this._internalLoadGame(slot);\n      toastr.success(` [${slot.name}] ...`);\n    } catch (error) {\n      const errorMessage = `: ${error instanceof Error ? error.message : String(error)}`;\n      console.error(` ${slot.name} :`, error);\n      toastr.error(errorMessage);\n    }\n  }\n\n  async deleteSave(slot: SaveSlot) {\n    if (!slot.entryUid) {\n      toastr.warning('');\n      return;\n    }\n    if (!confirm(` [${slot.name}] \\n`)) {\n      return;\n    }\n    toastr.info(` [${slot.name}]...`);\n    try {\n      await TavernHelper.deleteLorebookEntries(LOREBOOK_NAME, [slot.entryUid]);\n      await this.loadAllSaveSlots();\n      toastr.success(` [${slot.name}] `);\n    } catch (error) {\n      console.error(` ${slot.name} :`, error);\n      toastr.error(`: ${error instanceof Error ? error.message : String(error)}`);\n    }\n  }\n\n  async performAutoSave() {\n    if (!this.isAutoSaveEnabled) return;\n\n    this.turnCounter++;\n    localStorage.setItem('tianhua_turn_counter', this.turnCounter.toString());\n    const slotId = this.turnCounter % 2 === 1 ? AUTO_SAVE_SLOTS[0] : AUTO_SAVE_SLOTS[1];\n    await this.saveGame(slotId, true);\n  }\n\n  async saveStateForReroll() {\n    console.log('[Reroll] Saving state for potential reroll...');\n    await this.saveGame(REROLL_SAVE_SLOT_ID, true);\n  }\n\n  async loadRerollState() {\n    await this.ensureSlotsLoaded(); // \n\n    if (!this.rerollSlot || !this.rerollSlot.data) {\n      toastr.error('');\n      throw new Error('No reroll save state found.');\n    }\n    console.log('[Reroll] Loading state for reroll and setting restore flag...');\n\n    // \n    localStorage.setItem('reincarnation-simulator-restore-input', 'true');\n\n    // \n    await this._internalLoadGame(this.rerollSlot);\n    // \n    setTimeout(() => window.location.reload(), 500);\n  }\n\n  exportSave(slot: SaveSlot) {\n    if (!slot.data) {\n      toastr.warning('');\n      return;\n    }\n    const dataStr = JSON.stringify(slot.data, null, 2);\n    const dataBlob = new Blob([dataStr], { type: 'application/json' });\n    const url = URL.createObjectURL(dataBlob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = `[-]-${slot.name}-${new Date().toISOString()}.json`;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    URL.revokeObjectURL(url);\n    toastr.success(` [${slot.name}] `);\n  }\n\n  async importSave(jsonContent: string) {\n    try {\n      const saveData = JSON.parse(jsonContent);\n      if (!saveData.timestamp || !saveData.mvu_data) {\n        throw new Error('');\n      }\n\n      const emptySlot = this.manualSlots.find(slot => !slot.data);\n      if (!emptySlot) {\n        toastr.error('');\n        return;\n      }\n\n      toastr.info(` [${emptySlot.name}]...`);\n\n      const comment = `${SAVE_SLOT_PREFIX}${emptySlot.id}`;\n      const allEntries = await TavernHelper.getLorebookEntries(LOREBOOK_NAME);\n      const existingEntry = allEntries.find((e: any) => e.comment === comment);\n\n      if (existingEntry) {\n        await TavernHelper.setLorebookEntries(LOREBOOK_NAME, [\n          { uid: existingEntry.uid, content: JSON.stringify(saveData, null, 2) },\n        ]);\n      } else {\n        await TavernHelper.createLorebookEntries(LOREBOOK_NAME, [\n          {\n            comment: comment,\n            content: JSON.stringify(saveData, null, 2),\n            keys: [comment],\n            position: 'after_character_definition',\n            order: 200,\n            enabled: false, // \n          },\n        ]);\n      }\n\n      await this.loadAllSaveSlots();\n      toastr.success(` [${emptySlot.name}]`);\n    } catch (error) {\n      const errorMessage = `: ${error instanceof Error ? error.message : String(error)}`;\n      console.error(':', error);\n      toastr.error(errorMessage);\n    }\n  }\n\n  toggleAutoSave(enabled: boolean) {\n    this.isAutoSaveEnabled = enabled;\n    localStorage.setItem('tianhua_auto_save_enabled', JSON.stringify(enabled));\n    toastr.info(`${enabled ? '' : ''}`);\n  }\n\n  private loadAutoSaveState() {\n    const savedState = localStorage.getItem('tianhua_auto_save_enabled');\n    if (savedState !== null) {\n      this.isAutoSaveEnabled = JSON.parse(savedState);\n    }\n  }\n\n  private loadTurnCounter() {\n    const savedCounter = localStorage.getItem('tianhua_turn_counter');\n    if (savedCounter !== null) {\n      this.turnCounter = parseInt(savedCounter, 10) || 0;\n    }\n  }\n}\n\nexport const saveLoadService = new SaveLoadService();\n","const __WEBPACK_NAMESPACE_OBJECT__ = VueRouter;","import { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, withModifiers as _withModifiers, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveDynamicComponent as _resolveDynamicComponent, normalizeProps as _normalizeProps, guardReactiveProps as _guardReactiveProps, createBlock as _createBlock, renderList as _renderList, Fragment as _Fragment, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"main-layout\" };\nconst _hoisted_2 = { class: \"modal-content confirmation-modal\" };\nconst _hoisted_3 = { class: \"confirmation-title\" };\nconst _hoisted_4 = { class: \"confirmation-message\" };\nconst _hoisted_5 = { class: \"confirmation-buttons\" };\nconst _hoisted_6 = { class: \"modal-content detail-modal\" };\nconst _hoisted_7 = { class: \"modal-header\" };\nconst _hoisted_8 = { class: \"modal-title\" };\nconst _hoisted_9 = { class: \"modal-body\" };\nconst _hoisted_10 = { class: \"modal-content detail-modal\" };\nconst _hoisted_11 = { class: \"modal-header\" };\nconst _hoisted_12 = { class: \"modal-title\" };\nconst _hoisted_13 = { class: \"modal-body\" };\nconst _hoisted_14 = {\n    key: 4,\n    class: \"modal-overlay input-modal-overlay\"\n};\nconst _hoisted_15 = { class: \"modal-content input-modal-content\" };\nconst _hoisted_16 = { class: \"input-area-container\" };\nconst _hoisted_17 = { class: \"input-area-with-buttons\" };\nconst _hoisted_18 = {\n    key: 2,\n    class: \"command-queue-popup\",\n    style: { \"background-color\": \"#0a0f1e\", \"border\": \"1px solid #d4af37\" }\n};\nconst _hoisted_19 = { class: \"popup-header\" };\nconst _hoisted_20 = { class: \"popup-body\" };\nconst _hoisted_21 = {\n    key: 0,\n    class: \"command-list\"\n};\nconst _hoisted_22 = {\n    key: 1,\n    class: \"empty-queue\"\n};\nconst _hoisted_23 = {\n    key: 0,\n    class: \"popup-footer\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n    const _component_TopStatusBar = _resolveComponent(\"TopStatusBar\");\n    const _component_DockManager = _resolveComponent(\"DockManager\");\n    const _component_LoadingIndicator = _resolveComponent(\"LoadingIndicator\");\n    const _component_NpcListModal = _resolveComponent(\"NpcListModal\");\n    const _component_ActionPanel = _resolveComponent(\"ActionPanel\");\n    const _component_EnhancedInputBox = _resolveComponent(\"EnhancedInputBox\");\n    const _component_InputHistoryPopup = _resolveComponent(\"InputHistoryPopup\");\n    const _component_NotificationContainer = _resolveComponent(\"NotificationContainer\");\n    return (_openBlock(), _createElementBlock(\"div\", {\n        class: _normalizeClass([\"guixu-root-container\", { 'web-fullscreen': _ctx.isWebFullscreen }])\n    }, [\n        _createVNode(_component_TopStatusBar),\n        _createElementVNode(\"div\", _hoisted_1, [\n            _createVNode(_component_DockManager)\n        ]),\n        _createCommentVNode(\" Global Confirmation Modal \"),\n        (_ctx.confirmation.isVisible)\n            ? (_openBlock(), _createElementBlock(\"div\", {\n                key: 0,\n                class: \"modal-overlay\",\n                onClick: _cache[2] || (_cache[2] = _withModifiers(($event) => (_ctx.confirmationService.hide()), [\"self\"]))\n            }, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"h3\", _hoisted_3, _toDisplayString(_ctx.confirmation.title), 1 /* TEXT */),\n                    _createElementVNode(\"p\", _hoisted_4, _toDisplayString(_ctx.confirmation.message), 1 /* TEXT */),\n                    _createElementVNode(\"div\", _hoisted_5, [\n                        _createElementVNode(\"button\", {\n                            onClick: _cache[0] || (_cache[0] = ($event) => (_ctx.confirmationService.hide()))\n                        }, \"\"),\n                        _createElementVNode(\"button\", {\n                            class: \"primary\",\n                            onClick: _cache[1] || (_cache[1] = ($event) => (_ctx.confirmationService.confirm()))\n                        }, \"\")\n                    ])\n                ])\n            ]))\n            : _createCommentVNode(\"v-if\", true),\n        _createCommentVNode(\" Global Detail Modal \"),\n        (_ctx.detailModal.isVisible)\n            ? (_openBlock(), _createElementBlock(\"div\", {\n                key: 1,\n                class: \"modal-overlay\",\n                onClick: _cache[4] || (_cache[4] = _withModifiers(($event) => (_ctx.detailModalService.hide()), [\"self\"]))\n            }, [\n                _createElementVNode(\"div\", _hoisted_6, [\n                    _createElementVNode(\"div\", _hoisted_7, [\n                        _createElementVNode(\"h3\", _hoisted_8, _toDisplayString(_ctx.detailModal.title), 1 /* TEXT */),\n                        _createElementVNode(\"button\", {\n                            class: \"close-button\",\n                            onClick: _cache[3] || (_cache[3] = ($event) => (_ctx.detailModalService.hide()))\n                        }, \"\")\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_9, [\n                        (_openBlock(), _createBlock(_resolveDynamicComponent(_ctx.detailModal.component), _normalizeProps(_guardReactiveProps(_ctx.detailModal.props)), null, 16 /* FULL_PROPS */))\n                    ])\n                ])\n            ]))\n            : _createCommentVNode(\"v-if\", true),\n        (_ctx.store.isGenerating)\n            ? (_openBlock(), _createBlock(_component_LoadingIndicator, {\n                key: 2,\n                error: _ctx.store.generationError\n            }, null, 8 /* PROPS */, [\"error\"]))\n            : _createCommentVNode(\"v-if\", true),\n        _createCommentVNode(\" Global NPC List Modal \"),\n        (_ctx.npcModal.isVisible)\n            ? (_openBlock(), _createElementBlock(\"div\", {\n                key: 3,\n                class: \"modal-overlay\",\n                onClick: _cache[6] || (_cache[6] = _withModifiers(($event) => (_ctx.npcModalService.hide()), [\"self\"]))\n            }, [\n                _createElementVNode(\"div\", _hoisted_10, [\n                    _createElementVNode(\"div\", _hoisted_11, [\n                        _createElementVNode(\"h3\", _hoisted_12, _toDisplayString(_ctx.npcModal.title), 1 /* TEXT */),\n                        _createElementVNode(\"button\", {\n                            class: \"close-button\",\n                            onClick: _cache[5] || (_cache[5] = ($event) => (_ctx.npcModalService.hide()))\n                        }, \"\")\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_13, [\n                        _createVNode(_component_NpcListModal, _normalizeProps(_guardReactiveProps(_ctx.npcModal.props)), null, 16 /* FULL_PROPS */)\n                    ])\n                ])\n            ]))\n            : _createCommentVNode(\"v-if\", true),\n        _createCommentVNode(\" Global Input Modal \"),\n        (_ctx.inputModal.isVisible)\n            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_14, [\n                _createElementVNode(\"div\", _hoisted_15, [\n                    _createElementVNode(\"div\", _hoisted_16, [\n                        (_ctx.isActionPanelVisible)\n                            ? (_openBlock(), _createBlock(_component_ActionPanel, {\n                                key: 0,\n                                \"command-count\": _ctx.commandCount,\n                                \"main-options\": _ctx.menuOptions.main,\n                                \"avatar-options\": _ctx.menuOptions.avatar,\n                                \"common-options\": _ctx.menuOptions.common,\n                                onToggleHistory: _ctx.toggleHistory,\n                                onToggleCommands: _ctx.toggleCommandQueue\n                            }, null, 8 /* PROPS */, [\"command-count\", \"main-options\", \"avatar-options\", \"common-options\", \"onToggleHistory\", \"onToggleCommands\"]))\n                            : _createCommentVNode(\"v-if\", true),\n                        _createElementVNode(\"div\", _hoisted_17, [\n                            _createVNode(_component_EnhancedInputBox, {\n                                onSubmitAction: _ctx.handleSubmit,\n                                onToggleActionPanel: _ctx.toggleActionPanel\n                            }, null, 8 /* PROPS */, [\"onSubmitAction\", \"onToggleActionPanel\"])\n                        ]),\n                        (_ctx.isHistoryVisible)\n                            ? (_openBlock(), _createBlock(_component_InputHistoryPopup, {\n                                key: 1,\n                                onClose: _ctx.toggleHistory,\n                                onSelectEntry: _ctx.selectHistoryEntry\n                            }, null, 8 /* PROPS */, [\"onClose\", \"onSelectEntry\"]))\n                            : _createCommentVNode(\"v-if\", true),\n                        (_ctx.isQueueVisible)\n                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_18, [\n                                _createElementVNode(\"div\", _hoisted_19, [\n                                    _cache[9] || (_cache[9] = _createElementVNode(\"h3\", null, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"button\", {\n                                        class: \"close-popup-button\",\n                                        onClick: _cache[7] || (_cache[7] =\n                                            //@ts-ignore\n                                            (...args) => (_ctx.toggleCommandQueue && _ctx.toggleCommandQueue(...args)))\n                                    }, \"\")\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_20, [\n                                    (_ctx.commandCount > 0)\n                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_21, [\n                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.commands, (cmd, index) => {\n                                                return (_openBlock(), _createElementBlock(\"div\", {\n                                                    key: index,\n                                                    class: \"command-item\"\n                                                }, _toDisplayString(cmd), 1 /* TEXT */));\n                                            }), 128 /* KEYED_FRAGMENT */))\n                                        ]))\n                                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_22, \"\"))\n                                ]),\n                                (_ctx.commandCount > 0)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_23, [\n                                        _createElementVNode(\"button\", {\n                                            class: \"clear-button\",\n                                            onClick: _cache[8] || (_cache[8] =\n                                                //@ts-ignore\n                                                (...args) => (_ctx.clearCommands && _ctx.clearCommands(...args)))\n                                        }, \"\")\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ])\n                ])\n            ]))\n            : _createCommentVNode(\"v-if\", true),\n        _createVNode(_component_NotificationContainer)\n    ], 2 /* CLASS */));\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode } from \"vue\";\nconst _hoisted_1 = { class: \"action-panel\" };\nconst _hoisted_2 = { class: \"button-row\" };\nconst _hoisted_3 = [\"disabled\", \"onClick\"];\nconst _hoisted_4 = { class: \"button-row\" };\nconst _hoisted_5 = [\"disabled\", \"onClick\"];\nconst _hoisted_6 = { class: \"button-row\" };\nconst _hoisted_7 = [\"disabled\", \"onClick\"];\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ActionPanel',\n    props: {\n        commandCount: {},\n        mainOptions: {},\n        avatarOptions: {},\n        commonOptions: {}\n    },\n    emits: ['toggle-history', 'toggle-commands'],\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.mainOptions, (option) => {\n                        return (_openBlock(), _createElementBlock(\"button\", {\n                            key: option.id,\n                            class: \"action-button\",\n                            disabled: option.disabled && option.disabled(),\n                            onClick: option.action\n                        }, _toDisplayString(option.text), 9 /* TEXT, PROPS */, _hoisted_3));\n                    }), 128 /* KEYED_FRAGMENT */))\n                ]),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.avatarOptions, (option) => {\n                        return (_openBlock(), _createElementBlock(\"button\", {\n                            key: option.id,\n                            class: \"action-button\",\n                            disabled: option.disabled && option.disabled(),\n                            onClick: option.action\n                        }, _toDisplayString(option.text), 9 /* TEXT, PROPS */, _hoisted_5));\n                    }), 128 /* KEYED_FRAGMENT */))\n                ]),\n                _createElementVNode(\"div\", _hoisted_6, [\n                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.commonOptions, (option) => {\n                        return (_openBlock(), _createElementBlock(\"button\", {\n                            key: option.id,\n                            class: \"action-button\",\n                            disabled: option.disabled && option.disabled(),\n                            onClick: option.action\n                        }, _toDisplayString(option.text), 9 /* TEXT, PROPS */, _hoisted_7));\n                    }), 128 /* KEYED_FRAGMENT */)),\n                    _createElementVNode(\"button\", {\n                        class: \"action-button\",\n                        onClick: _cache[0] || (_cache[0] = ($event) => (_ctx.$emit('toggle-history')))\n                    }, \"\"),\n                    _createElementVNode(\"button\", {\n                        class: \"action-button\",\n                        onClick: _cache[1] || (_cache[1] = ($event) => (_ctx.$emit('toggle-commands')))\n                    }, \" (\" + _toDisplayString(__props.commandCount) + \")\", 1 /* TEXT */)\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ActionPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ActionPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ActionPanel.vue?vue&type=style&index=0&id=f91c06ec&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-f91c06ec\"]])\n\nexport default __exports__","import { reactive } from 'vue';\n\nconst MAX_RECENT_HISTORY = 5;\nconst MAX_SAVED_HISTORY = 5;\nconst STORAGE_KEY_RECENT = 'reincarnation_input_history_recent';\nconst STORAGE_KEY_SAVED = 'reincarnation_input_history_saved';\n\nclass InputHistoryService {\n  public state = reactive({\n    recent: [] as string[],\n    saved: [] as string[],\n  });\n\n  constructor() {\n    this.loadHistory();\n  }\n\n  private loadHistory() {\n    const recentData = localStorage.getItem(STORAGE_KEY_RECENT);\n    const savedData = localStorage.getItem(STORAGE_KEY_SAVED);\n    if (recentData) {\n      this.state.recent = JSON.parse(recentData);\n    }\n    if (savedData) {\n      this.state.saved = JSON.parse(savedData);\n    }\n  }\n\n  private saveHistory() {\n    localStorage.setItem(STORAGE_KEY_RECENT, JSON.stringify(this.state.recent));\n    localStorage.setItem(STORAGE_KEY_SAVED, JSON.stringify(this.state.saved));\n  }\n\n  add(input: string) {\n    if (!input || input.trim() === '') {\n      return;\n    }\n    // Avoid duplicates\n    const existingIndex = this.state.recent.indexOf(input);\n    if (existingIndex > -1) {\n      this.state.recent.splice(existingIndex, 1);\n    }\n\n    this.state.recent.unshift(input);\n    if (this.state.recent.length > MAX_RECENT_HISTORY) {\n      this.state.recent.pop();\n    }\n    this.saveHistory();\n  }\n\n  save(entry: string) {\n    if (this.state.saved.includes(entry)) {\n      return;\n    }\n\n    this.state.saved.unshift(entry);\n    if (this.state.saved.length > MAX_SAVED_HISTORY) {\n      this.state.saved.pop();\n    }\n    this.saveHistory();\n  }\n\n  deleteRecent(index: number) {\n    this.state.recent.splice(index, 1);\n    this.saveHistory();\n  }\n\n  deleteSaved(index: number) {\n    this.state.saved.splice(index, 1);\n    this.saveHistory();\n  }\n\n  clearAll() {\n    this.state.recent = [];\n    this.state.saved = [];\n    this.saveHistory();\n  }\n}\n\nexport const inputHistoryService = new InputHistoryService();\n","import { lorebookService } from './LorebookService';\n\n// \nexport type WorkflowState = 'NORMAL' | 'CREATION' | 'IDENTITY';\n\n// CoT\n// \nconst COT_FILES: Record<WorkflowState, string[]> = {\n  NORMAL: ['cotcot'],\n  CREATION: ['cotcot'],\n  IDENTITY: ['cotcot'],\n};\n\nclass WorkflowService {\n  private currentState: WorkflowState = 'NORMAL';\n  private narrativeCache: string | null = null; //  <gametxt>\n  private updateScriptCache: string | null = null; //  <UpdateVariable>\n  private preserveMode: 'none' | 'gametxt' | 'full' = 'none';\n\n  constructor() {\n    // CoT\n    this.switchTo('NORMAL');\n  }\n\n  /**\n   * \n   */\n  public getCurrentState(): WorkflowState {\n    return this.currentState;\n  }\n\n  /**\n   * CoT/\n   * @param newState \n   */\n  public async switchTo(newState: WorkflowState, force: boolean = false) {\n    if (this.currentState === newState && !force) {\n      return; // \n    }\n\n    console.log(`[WorkflowService] Switching from ${this.currentState} to ${newState} (Forced: ${force})`);\n\n    const allCots = Object.values(COT_FILES).flat();\n    const cotsToEnable = COT_FILES[newState];\n\n    // CoT\n    for (const cotName of allCots) {\n      const shouldBeEnabled = cotsToEnable.includes(cotName);\n      await lorebookService.setEntryEnabled(cotName, shouldBeEnabled);\n    }\n\n    this.currentState = newState;\n    console.log(`[WorkflowService] Switched to ${newState}. Enabled CoTs: ${cotsToEnable.join(', ')}`);\n  }\n\n  /**\n   * \n   * @param narrative  <gametxt> \n   */\n  public cacheNarrative(narrative: string) {\n    this.narrativeCache = narrative;\n    console.log('[WorkflowService] Narrative cached.');\n  }\n\n  /**\n   * \n   * @returns  <gametxt>  null\n   */\n  public popNarrative(): string | null {\n    const narrative = this.narrativeCache;\n    this.narrativeCache = null;\n    if (narrative) {\n      console.log('[WorkflowService] Popped cached narrative.');\n    }\n    return narrative;\n  }\n\n  /**\n   * \n   */\n  public cacheUpdateScript(script: string) {\n    this.updateScriptCache = script;\n    console.log('[WorkflowService] Update script cached.');\n  }\n\n  /**\n   * \n   */\n  public popUpdateScript(): string | null {\n    const script = this.updateScriptCache;\n    this.updateScriptCache = null;\n    if (script) {\n      console.log('[WorkflowService] Popped cached update script.');\n    }\n    return script;\n  }\n\n  /**\n   * AI\n   * @param mode 'gametxt' , 'full' \n   */\n  public setPreserveMode(mode: 'none' | 'gametxt' | 'full') {\n    this.preserveMode = mode;\n    console.log(`[WorkflowService] Preserve mode set to: ${mode}`);\n  }\n\n  /**\n   * \n   * @returns \n   */\n  public popPreservedContent(): string {\n    let content = '';\n\n    if (this.preserveMode === 'gametxt' || this.preserveMode === 'full') {\n      if (this.narrativeCache) {\n        content += `\\n<gametxt>${this.narrativeCache}</gametxt>`;\n        console.log('[WorkflowService] Popped cached narrative for appending.');\n      }\n    }\n\n    if (this.preserveMode === 'full') {\n      if (this.updateScriptCache) {\n        content += `\\n<UpdateVariable>${this.updateScriptCache}</UpdateVariable>`;\n        console.log('[WorkflowService] Popped cached update script for appending.');\n      }\n    }\n\n    // \n    this.narrativeCache = null;\n    this.updateScriptCache = null;\n    this.preserveMode = 'none';\n\n    if (content) {\n      console.log('[WorkflowService] Final content to append length:', content.length);\n    }\n\n    return content;\n  }\n}\n\nexport const workflowService = new WorkflowService();\n","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, withModifiers as _withModifiers, withKeys as _withKeys, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"enhanced-input-box-container\" };\nconst _hoisted_2 = { class: \"input-wrapper\" };\nconst _hoisted_3 = [\"value\", \"placeholder\", \"onKeypress\"];\nimport { computed } from 'vue';\nimport { commandService } from '../../services/CommandService';\nimport { inputHistoryService } from '../../services/InputHistoryService';\nimport { inputModalActions, inputModalState } from '../../services/InputModalService';\nimport { workflowService } from '../../services/WorkflowService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'EnhancedInputBox',\n    props: {\n        placeholder: {\n            type: String,\n            default: '...',\n        },\n    },\n    emits: ['submit-action', 'toggle-action-panel'],\n    setup(__props, { emit: __emit }) {\n        const emit = __emit;\n        const inputValue = computed(() => inputModalState.inputValue);\n        const commands = computed(() => commandService.getCommands());\n        const onInput = (event) => {\n            const target = event.target;\n            inputModalActions.setValue(target.value);\n        };\n        const submitAction = () => {\n            const trimmedInput = inputValue.value.trim();\n            const hasCommands = commands.value.length > 0;\n            if (!trimmedInput && !hasCommands) {\n                return;\n            }\n            if (trimmedInput) {\n                inputHistoryService.add(trimmedInput);\n            }\n            let combinedContent = '';\n            if (hasCommands) {\n                combinedContent += '[]\\n' + commands.value.map(cmd => `- ${cmd}`).join('\\n');\n            }\n            if (trimmedInput) {\n                if (hasCommands) {\n                    combinedContent += '\\n';\n                }\n                combinedContent += `<>\\n${trimmedInput}\\n</>`;\n            }\n            workflowService.switchTo('NORMAL', true);\n            emit('submit-action', combinedContent);\n            commandService.clearCommands();\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"button\", {\n                        class: \"action-button activator\",\n                        onClick: _cache[0] || (_cache[0] = ($event) => (_ctx.$emit('toggle-action-panel')))\n                    }, \"\"),\n                    _createElementVNode(\"textarea\", {\n                        value: inputValue.value,\n                        onInput: onInput,\n                        placeholder: __props.placeholder,\n                        onKeypress: _withKeys(_withModifiers(submitAction, [\"exact\", \"prevent\"]), [\"enter\"])\n                    }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_3),\n                    _createElementVNode(\"button\", {\n                        class: \"action-button primary\",\n                        onClick: submitAction\n                    }, \"\")\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./EnhancedInputBox.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./EnhancedInputBox.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./EnhancedInputBox.vue?vue&type=style&index=0&id=78a7c572&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-78a7c572\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = { class: \"input-history-popup\" };\nconst _hoisted_2 = { class: \"history-section\" };\nconst _hoisted_3 = { key: 0 };\nconst _hoisted_4 = [\"onClick\"];\nconst _hoisted_5 = { class: \"actions\" };\nconst _hoisted_6 = [\"onClick\", \"disabled\"];\nconst _hoisted_7 = [\"onClick\"];\nconst _hoisted_8 = {\n    key: 1,\n    class: \"empty-text\"\n};\nconst _hoisted_9 = { class: \"history-section\" };\nconst _hoisted_10 = { key: 0 };\nconst _hoisted_11 = [\"onClick\"];\nconst _hoisted_12 = { class: \"actions\" };\nconst _hoisted_13 = [\"onClick\"];\nconst _hoisted_14 = {\n    key: 1,\n    class: \"empty-text\"\n};\nimport { inputHistoryService } from '../../services/InputHistoryService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'InputHistoryPopup',\n    emits: ['select-entry', 'close'],\n    setup(__props, { emit: __emit }) {\n        const historyState = inputHistoryService.state;\n        const emit = __emit;\n        const useEntry = (entry) => {\n            emit('select-entry', entry);\n        };\n        const saveEntry = (entry) => {\n            inputHistoryService.save(entry);\n        };\n        const deleteRecentEntry = (index) => {\n            inputHistoryService.deleteRecent(index);\n        };\n        const deleteSavedEntry = (index) => {\n            inputHistoryService.deleteSaved(index);\n        };\n        const isSaved = (entry) => {\n            return historyState.saved.includes(entry);\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[1] || (_cache[1] = _createElementVNode(\"h4\", null, \"\", -1 /* CACHED */)),\n                    (_unref(historyState).recent.length > 0)\n                        ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_3, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(historyState).recent, (entry, index) => {\n                                return (_openBlock(), _createElementBlock(\"li\", {\n                                    key: `recent-${index}`\n                                }, [\n                                    _createElementVNode(\"span\", {\n                                        class: \"entry-text\",\n                                        onClick: ($event) => (useEntry(entry))\n                                    }, _toDisplayString(entry), 9 /* TEXT, PROPS */, _hoisted_4),\n                                    _createElementVNode(\"div\", _hoisted_5, [\n                                        _createElementVNode(\"button\", {\n                                            onClick: ($event) => (saveEntry(entry)),\n                                            disabled: isSaved(entry)\n                                        }, \"\", 8 /* PROPS */, _hoisted_6),\n                                        _createElementVNode(\"button\", {\n                                            onClick: ($event) => (deleteRecentEntry(index))\n                                        }, \"\", 8 /* PROPS */, _hoisted_7)\n                                    ])\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"p\", _hoisted_8, \"\"))\n                ]),\n                _createElementVNode(\"div\", _hoisted_9, [\n                    _cache[2] || (_cache[2] = _createElementVNode(\"h4\", null, \"\", -1 /* CACHED */)),\n                    (_unref(historyState).saved.length > 0)\n                        ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_10, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(historyState).saved, (entry, index) => {\n                                return (_openBlock(), _createElementBlock(\"li\", {\n                                    key: `saved-${index}`\n                                }, [\n                                    _createElementVNode(\"span\", {\n                                        class: \"entry-text\",\n                                        onClick: ($event) => (useEntry(entry))\n                                    }, _toDisplayString(entry), 9 /* TEXT, PROPS */, _hoisted_11),\n                                    _createElementVNode(\"div\", _hoisted_12, [\n                                        _createElementVNode(\"button\", {\n                                            onClick: ($event) => (deleteSavedEntry(index))\n                                        }, \"\", 8 /* PROPS */, _hoisted_13)\n                                    ])\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"p\", _hoisted_14, \"\"))\n                ]),\n                _createElementVNode(\"button\", {\n                    onClick: _cache[0] || (_cache[0] = ($event) => (_ctx.$emit('close'))),\n                    class: \"close-button-popup\"\n                }, \"\")\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./InputHistoryPopup.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./InputHistoryPopup.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./InputHistoryPopup.vue?vue&type=style&index=0&id=1f596ce4&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1f596ce4\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, Transition as _Transition, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = { class: \"notification__content\" };\nconst _hoisted_2 = { class: \"notification__title\" };\nconst _hoisted_3 = { class: \"notification__message\" };\nimport { notificationService } from '../../services/NotificationService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'Notification',\n    props: {\n        notification: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const hideNotification = () => {\n            notificationService.hide(props.notification.id);\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createBlock(_Transition, { name: \"notification-fade\" }, {\n                default: _withCtx(() => [\n                    _createElementVNode(\"div\", {\n                        class: _normalizeClass(['notification', `notification--${__props.notification.type}`]),\n                        onClick: hideNotification\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_1, [\n                            _createElementVNode(\"h4\", _hoisted_2, _toDisplayString(__props.notification.title), 1 /* TEXT */),\n                            _createElementVNode(\"p\", _hoisted_3, _toDisplayString(__props.notification.message), 1 /* TEXT */)\n                        ]),\n                        _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"notification__arrow\" }, null, -1 /* CACHED */))\n                    ], 2 /* CLASS */)\n                ]),\n                _: 1 /* STABLE */\n            }));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./Notification.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./Notification.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./Notification.vue?vue&type=style&index=0&id=080f1bc9&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = { class: \"notification-container\" };\nimport { notificationState } from '../../services/NotificationService';\nimport Notification from './Notification.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NotificationContainer',\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(notificationState).notifications, (notification) => {\n                    return (_openBlock(), _createBlock(Notification, {\n                        key: notification.id,\n                        notification: notification\n                    }, null, 8 /* PROPS */, [\"notification\"]));\n                }), 128 /* KEYED_FRAGMENT */))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NotificationContainer.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NotificationContainer.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NotificationContainer.vue?vue&type=style&index=0&id=602ef071&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"icon\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'SideMenuButton',\n    props: {\n        icon: {}\n    },\n    emits: ['open'],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emit = __emit;\n        const handleClick = (event) => {\n            emit('open', { x: event.clientX, y: event.clientY });\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"button\", {\n                class: \"side-menu-button\",\n                onClick: handleClick\n            }, [\n                _createElementVNode(\"span\", _hoisted_1, _toDisplayString(__props.icon), 1 /* TEXT */)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./SideMenuButton.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SideMenuButton.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./SideMenuButton.vue?vue&type=style&index=0&id=fa6acc08&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-fa6acc08\"]])\n\nexport default __exports__","import { computed, ComputedRef } from 'vue';\nimport { get } from 'lodash';\nimport { store, USER_ID } from './state';\nimport type {  } from '../types';\n\n/**\n * @file Getters - -\n * @description \n */\n\n// ---  Getters ---\n\n/**\n * \n */\nexport const playerCharacter: ComputedRef< | null> = computed(() => {\n  if (!store.worldState) return null;\n  const player = get(store.worldState., USER_ID);\n  if (player && typeof player !== 'string') {\n    return player;\n  }\n  return null;\n});\n\n/**\n * \n */\nexport const chapterInfo = computed(() => {\n  const chapter = get(store, 'worldState..');\n  if (!chapter) return { title: '', details: '' };\n  return {\n    title: chapter.,\n    details: `${chapter.} ${chapter.}: ${chapter.}`,\n  };\n});\n\n/**\n * \n */\nexport const worldTimeStr = computed(() => {\n  const time = get(store, 'worldState..');\n  if (!time) return '';\n  try {\n    const date = new Date(time);\n    return date\n      .toLocaleString('zh-CN', {\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit',\n        hour: '2-digit',\n        minute: '2-digit',\n        hour12: false,\n      })\n      .replace(/\\//g, '-');\n  } catch (e) {\n    return '';\n  }\n});\n\n/**\n *  Getter\n */\nexport const combinedNarrative = computed(() => {\n  const narrative = store.mainWorldNarrative || '...';\n  return `<div class=\"narrative-block\">${narrative}</div>`;\n});\n\n/**\n * \n * @param path - lodash get-style path to the variable in worldState\n */\nexport const getVariable = (path: string, defaultValue: any = null) => {\n  return computed(() => get(store.worldState, path, defaultValue));\n};\n","import { reactive, markRaw, readonly } from 'vue';\nimport type { Component } from 'vue';\n\ninterface DetailModalState {\n  isVisible: boolean;\n  component: Component | null;\n  props: Record<string, any>;\n  title: string;\n}\n\nconst state = reactive<DetailModalState>({\n  isVisible: false,\n  component: null,\n  props: {},\n  title: '',\n});\n\nexport const detailModalService = {\n  /**\n   * The reactive state of the detail modal.\n   */\n  state: readonly(state),\n\n  /**\n   * Shows a modal with a specified component and props.\n   * @param title The title to display in the modal header.\n   * @param component The Vue component to render inside the modal.\n   * @param props The props to pass to the component.\n   */\n  show(title: string, component: Component, props: Record<string, any> = {}) {\n    state.title = title;\n    state.component = markRaw(component);\n    state.props = props;\n    state.isVisible = true;\n  },\n\n  /**\n   * Hides the currently visible modal.\n   */\n  hide() {\n    state.isVisible = false;\n    // Delay clearing to allow for fade-out animations\n    setTimeout(() => {\n      state.component = null;\n      state.props = {};\n      state.title = '';\n    }, 300);\n  },\n};\n","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"detail-tab-content grid-layout\" };\nconst _hoisted_2 = { class: \"detail-item\" };\nconst _hoisted_3 = { class: \"detail-value\" };\nconst _hoisted_4 = { class: \"detail-item\" };\nconst _hoisted_5 = { class: \"detail-value\" };\nconst _hoisted_6 = { class: \"detail-item\" };\nconst _hoisted_7 = { class: \"detail-value\" };\nconst _hoisted_8 = { class: \"detail-item\" };\nconst _hoisted_9 = { class: \"detail-value\" };\nconst _hoisted_10 = { class: \"detail-item full-width\" };\nconst _hoisted_11 = { class: \"detail-value\" };\nconst _hoisted_12 = { class: \"detail-item full-width\" };\nconst _hoisted_13 = { class: \"detail-value\" };\nconst _hoisted_14 = { class: \"detail-item full-width\" };\nconst _hoisted_15 = { class: \"detail-value\" };\nconst _hoisted_16 = { class: \"history-list\" };\nconst _hoisted_17 = { class: \"influence-text\" };\nconst _hoisted_18 = { class: \"detail-item full-width\" };\nconst _hoisted_19 = { class: \"detail-value\" };\nconst _hoisted_20 = { class: \"history-list\" };\nconst _hoisted_21 = { class: \"influence-text\" };\nimport { computed } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcArchiveTab',\n    props: {\n        npc: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const age = computed(() => {\n            if (!props.npc.?.)\n                return '';\n            return props.npc..;\n        });\n        const formattedBirthDate = computed(() => {\n            const bd = props.npc.?.;\n            if (!bd)\n                return '';\n            const date = new Date(bd);\n            return `${date.getFullYear()}${date.getMonth() + 1}${date.getDate()}`;\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _createElementVNode(\"p\", null, _toDisplayString(__props.npc.), 1 /* TEXT */)\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    _cache[1] || (_cache[1] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_5, [\n                        _createElementVNode(\"p\", null, _toDisplayString(formattedBirthDate.value) + \" (\" + _toDisplayString(age.value) + \")\", 1 /* TEXT */)\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_6, [\n                    _cache[2] || (_cache[2] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_7, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.npc., (item) => {\n                            return (_openBlock(), _createElementBlock(\"span\", {\n                                key: item.,\n                                class: \"tag\"\n                            }, _toDisplayString(item.) + \" - \" + _toDisplayString(item.), 1 /* TEXT */));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_8, [\n                    _cache[3] || (_cache[3] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_9, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.npc.., (value, key) => {\n                            return (_openBlock(), _createElementBlock(\"span\", {\n                                key: key,\n                                class: \"tag\"\n                            }, _toDisplayString(key) + \": \" + _toDisplayString(value), 1 /* TEXT */));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_10, [\n                    _cache[4] || (_cache[4] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_11, [\n                        _createElementVNode(\"p\", null, _toDisplayString(__props.npc..), 1 /* TEXT */)\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_12, [\n                    _cache[5] || (_cache[5] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_13, [\n                        _createElementVNode(\"p\", null, _toDisplayString(__props.npc..), 1 /* TEXT */)\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_14, [\n                    _cache[6] || (_cache[6] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_15, [\n                        _createElementVNode(\"ul\", _hoisted_16, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.npc., (trait) => {\n                                return (_openBlock(), _createElementBlock(\"li\", {\n                                    key: trait.\n                                }, [\n                                    _createElementVNode(\"strong\", null, _toDisplayString(trait.), 1 /* TEXT */),\n                                    _createElementVNode(\"p\", _hoisted_17, _toDisplayString(trait.), 1 /* TEXT */)\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ])\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_18, [\n                    _cache[7] || (_cache[7] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_19, [\n                        _createElementVNode(\"ul\", _hoisted_20, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.npc., (event, index) => {\n                                return (_openBlock(), _createElementBlock(\"li\", { key: index }, [\n                                    _createElementVNode(\"strong\", null, _toDisplayString(new Date(event.).toLocaleDateString()) + \": \" + _toDisplayString(event.), 1 /* TEXT */),\n                                    _createElementVNode(\"p\", _hoisted_21, \": \" + _toDisplayString(event.), 1 /* TEXT */)\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ])\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcArchiveTab.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcArchiveTab.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcArchiveTab.vue?vue&type=style&index=0&id=b770909e&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-b770909e\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeStyle as _normalizeStyle } from \"vue\";\nconst _hoisted_1 = { class: \"detail-tab-content grid-layout\" };\nconst _hoisted_2 = { class: \"detail-item full-width\" };\nconst _hoisted_3 = {\n    key: 0,\n    class: \"attributes-grid\"\n};\nconst _hoisted_4 = { class: \"attr-header\" };\nconst _hoisted_5 = { class: \"attr-name\" };\nconst _hoisted_6 = { class: \"attr-value\" };\nconst _hoisted_7 = { class: \"exp-bar-container\" };\nconst _hoisted_8 = { class: \"exp-bar\" };\nconst _hoisted_9 = { class: \"exp-text\" };\nconst _hoisted_10 = {\n    key: 1,\n    class: \"placeholder\"\n};\nconst _hoisted_11 = { class: \"detail-item full-width\" };\nconst _hoisted_12 = {\n    key: 0,\n    class: \"skills-list\"\n};\nconst _hoisted_13 = { class: \"skill-header\" };\nconst _hoisted_14 = { class: \"skill-level\" };\nconst _hoisted_15 = { class: \"skill-description\" };\nconst _hoisted_16 = {\n    key: 1,\n    class: \"placeholder\"\n};\nimport { computed } from 'vue';\nimport {  } from '../../../types';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcAttributesTab',\n    props: {\n        npc: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const attributes = computed(() => {\n            if (!props.npc.)\n                return [];\n            return Object.entries(props.npc.).map(([key, value]) => {\n                const levelInfo = .find((l) => l. === value.);\n                const expToNextLevel = levelInfo ? (levelInfo. === Infinity ? 'MAX' : levelInfo.) : 0;\n                const expPercentage = typeof expToNextLevel === 'number' && expToNextLevel > 0 ? (value. / expToNextLevel) * 100 : 0;\n                return {\n                    key,\n                    ...value,\n                    expPercentage,\n                    expToNextLevel,\n                };\n            });\n        });\n        const skills = computed(() => {\n            if (!props.npc.)\n                return [];\n            return Object.entries(props.npc.).map(([key, value]) => {\n                return {\n                    name: key,\n                    level: value.,\n                    description: value.,\n                };\n            });\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \"\", -1 /* CACHED */)),\n                    (attributes.value.length > 0)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(attributes.value, (attr) => {\n                                return (_openBlock(), _createElementBlock(\"div\", {\n                                    key: attr.key,\n                                    class: \"attribute-item\"\n                                }, [\n                                    _createElementVNode(\"div\", _hoisted_4, [\n                                        _createElementVNode(\"span\", _hoisted_5, _toDisplayString(attr.key), 1 /* TEXT */),\n                                        _createElementVNode(\"span\", _hoisted_6, _toDisplayString(attr.) + \" (\" + _toDisplayString(attr. >= 0 ? '+' : '') + _toDisplayString(attr.) + \")\", 1 /* TEXT */)\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_7, [\n                                        _createElementVNode(\"div\", _hoisted_8, [\n                                            _createElementVNode(\"div\", {\n                                                class: \"exp-fill\",\n                                                style: _normalizeStyle({ width: `${attr.expPercentage}%` })\n                                            }, null, 4 /* STYLE */)\n                                        ]),\n                                        _createElementVNode(\"span\", _hoisted_9, _toDisplayString(attr.) + \" / \" + _toDisplayString(attr.expToNextLevel), 1 /* TEXT */)\n                                    ])\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_10, \"\"))\n                ]),\n                _createElementVNode(\"div\", _hoisted_11, [\n                    _cache[1] || (_cache[1] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \"\", -1 /* CACHED */)),\n                    (skills.value.length > 0)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_12, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(skills.value, (skill) => {\n                                return (_openBlock(), _createElementBlock(\"div\", {\n                                    key: skill.name,\n                                    class: \"skill-item\"\n                                }, [\n                                    _createElementVNode(\"div\", _hoisted_13, [\n                                        _createElementVNode(\"h3\", null, _toDisplayString(skill.name), 1 /* TEXT */),\n                                        _createElementVNode(\"div\", _hoisted_14, \" \" + _toDisplayString(skill.level), 1 /* TEXT */)\n                                    ]),\n                                    _createElementVNode(\"p\", _hoisted_15, _toDisplayString(skill.description), 1 /* TEXT */)\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_16, \"\"))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcAttributesTab.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcAttributesTab.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcAttributesTab.vue?vue&type=style&index=0&id=0657319c&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-0657319c\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, normalizeStyle as _normalizeStyle } from \"vue\";\nconst _hoisted_1 = { class: \"progress-bar-container\" };\nconst _hoisted_2 = { class: \"label\" };\nconst _hoisted_3 = { class: \"progress-track\" };\nconst _hoisted_4 = {\n    key: 0,\n    class: \"center-tick\"\n};\nconst _hoisted_5 = { class: \"value\" };\nimport { computed } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ProgressBar',\n    props: {\n        label: {},\n        value: {},\n        max: {},\n        min: {},\n        color: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const displayValue = computed(() => props.value);\n        const isBidirectional = computed(() => props.min !== undefined && props.min < 0);\n        const fillStyle = computed(() => {\n            const min = props.min || 0;\n            const max = props.max || 100;\n            const value = Math.max(min, Math.min(max, props.value));\n            if (isBidirectional.value) {\n                const totalRange = max - min;\n                if (value > 0) {\n                    return {\n                        left: '50%',\n                        right: 'auto',\n                        width: `${(value / max) * 50}%`,\n                        backgroundColor: props.color,\n                    };\n                }\n                else {\n                    return {\n                        left: 'auto',\n                        right: '50%',\n                        width: `${(Math.abs(value) / Math.abs(min)) * 50}%`,\n                        backgroundColor: '#e53935', // \n                    };\n                }\n            }\n            else {\n                const percentage = max === min ? 0 : ((value - min) / (max - min)) * 100;\n                return {\n                    left: '0',\n                    right: 'auto',\n                    width: `${percentage}%`,\n                    backgroundColor: props.color,\n                };\n            }\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"span\", _hoisted_2, _toDisplayString(__props.label), 1 /* TEXT */),\n                _createElementVNode(\"div\", _hoisted_3, [\n                    (isBidirectional.value)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4))\n                        : _createCommentVNode(\"v-if\", true),\n                    _createElementVNode(\"div\", {\n                        class: \"progress-fill\",\n                        style: _normalizeStyle(fillStyle.value)\n                    }, null, 4 /* STYLE */)\n                ]),\n                _createElementVNode(\"span\", _hoisted_5, _toDisplayString(displayValue.value), 1 /* TEXT */)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ProgressBar.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ProgressBar.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ProgressBar.vue?vue&type=style&index=0&id=a2763620&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-a2763620\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, unref as _unref, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createBlock as _createBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = { class: \"relations-display\" };\nconst _hoisted_2 = { class: \"relation-list\" };\nconst _hoisted_3 = [\"onClick\"];\nconst _hoisted_4 = { class: \"relation-name\" };\nconst _hoisted_5 = { class: \"relation-tags\" };\nconst _hoisted_6 = {\n    key: 0,\n    class: \"relation-details\"\n};\nconst _hoisted_7 = { class: \"group-title\" };\nimport { get } from 'lodash';\nimport { ref, watch } from 'vue';\nimport { npcService } from '../../services/NpcService';\nimport { store } from '../../store';\nimport ProgressBar from './ProgressBar.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'RelationsDisplay',\n    props: {\n        subjectId: {}\n    },\n    setup(__props) {\n        const vectorGroups = [\n            {\n                title: '',\n                vectors: [\n                    { label: '', path: '.', min: -100, max: 100, color: '#3a8f9d' },\n                    { label: '', path: '.', min: -100, max: 100, color: '#3a8f9d' },\n                    { label: '', path: '.', min: 0, max: 100, color: '#e53935' },\n                ],\n            },\n            {\n                title: '',\n                vectors: [\n                    { label: '', path: '.', min: -100, max: 100, color: '#c74343' },\n                    { label: '', path: '.', min: 0, max: 100, color: '#c74343' },\n                ],\n            },\n            {\n                title: '',\n                vectors: [\n                    { label: '', path: '.', min: 0, max: 100, color: '#d4af37' },\n                    { label: '', path: '.', min: 0, max: 100, color: '#d4af37' },\n                    { label: '', path: '.', min: 0, max: 100, color: '#e53935' },\n                ],\n            },\n        ];\n        const props = __props;\n        const relations = ref({});\n        watch(() => [props.subjectId, store.worldState?.], () => {\n            if (!props.subjectId || !store.worldState?.) {\n                relations.value = {};\n                return;\n            }\n            let worldId = null;\n            for (const id in store.worldState.) {\n                if (get(store.worldState.[id], `.${props.subjectId}`)) {\n                    worldId = id;\n                    break;\n                }\n            }\n            if (!worldId) {\n                relations.value = {};\n                return;\n            }\n            const causalNet = get(store.worldState.[worldId], '');\n            if (!causalNet) {\n                relations.value = {};\n                return;\n            }\n            relations.value = causalNet[props.subjectId] || {};\n        }, { immediate: true, deep: true });\n        const { getNpcNameById } = npcService;\n        const expandedRelation = ref(null);\n        function toggleExpand(name) {\n            const relationName = String(name);\n            if (expandedRelation.value === relationName) {\n                expandedRelation.value = null;\n            }\n            else {\n                expandedRelation.value = relationName;\n            }\n        }\n        function getFormattedTags(relation) {\n            const causeTags = get(relation, '', {});\n            return Object.values(causeTags)\n                .filter((tag) => typeof tag === 'object' && tag !== null && tag.)\n                .map((tag) => tag.);\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"ul\", _hoisted_2, [\n                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(relations.value, (relation, id) => {\n                        return (_openBlock(), _createElementBlock(\"li\", {\n                            key: id,\n                            class: \"relation-item\"\n                        }, [\n                            _createElementVNode(\"div\", {\n                                class: \"relation-header\",\n                                onClick: ($event) => (toggleExpand(id))\n                            }, [\n                                _createElementVNode(\"span\", _hoisted_4, _toDisplayString(_unref(getNpcNameById)(String(id))), 1 /* TEXT */),\n                                _createElementVNode(\"div\", _hoisted_5, [\n                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(getFormattedTags(relation), (tag) => {\n                                        return (_openBlock(), _createElementBlock(\"span\", {\n                                            key: tag,\n                                            class: \"tag\"\n                                        }, _toDisplayString(tag), 1 /* TEXT */));\n                                    }), 128 /* KEYED_FRAGMENT */))\n                                ])\n                            ], 8 /* PROPS */, _hoisted_3),\n                            (expandedRelation.value === id)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [\n                                    (_openBlock(), _createElementBlock(_Fragment, null, _renderList(vectorGroups, (group) => {\n                                        return _createElementVNode(\"div\", {\n                                            key: group.title,\n                                            class: \"vector-group\"\n                                        }, [\n                                            _createElementVNode(\"strong\", _hoisted_7, _toDisplayString(group.title), 1 /* TEXT */),\n                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(group.vectors, (vector) => {\n                                                return (_openBlock(), _createBlock(ProgressBar, {\n                                                    key: vector.label,\n                                                    label: vector.label,\n                                                    value: _unref(get)(relation, vector.path, 0),\n                                                    min: vector.min,\n                                                    max: vector.max,\n                                                    color: vector.color\n                                                }, null, 8 /* PROPS */, [\"label\", \"value\", \"min\", \"max\", \"color\"]));\n                                            }), 128 /* KEYED_FRAGMENT */))\n                                        ]);\n                                    }), 64 /* STABLE_FRAGMENT */))\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ]));\n                    }), 128 /* KEYED_FRAGMENT */))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./RelationsDisplay.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./RelationsDisplay.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./RelationsDisplay.vue?vue&type=style&index=0&id=07fea588&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-07fea588\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"detail-tab-content grid-layout\" };\nconst _hoisted_2 = { class: \"detail-item full-width\" };\nconst _hoisted_3 = {\n    key: 1,\n    class: \"placeholder\"\n};\nimport RelationsDisplay from '../RelationsDisplay.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcCauseTab',\n    props: {\n        npc: {},\n        npcId: {}\n    },\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \"\", -1 /* CACHED */)),\n                    (__props.npcId)\n                        ? (_openBlock(), _createBlock(RelationsDisplay, {\n                            key: 0,\n                            \"subject-id\": __props.npcId\n                        }, null, 8 /* PROPS */, [\"subject-id\"]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_3, \"\"))\n                ]),\n                _createCommentVNode(\"  \")\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcCauseTab.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcCauseTab.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcCauseTab.vue?vue&type=style&index=0&id=55265fd9&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-55265fd9\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createElementVNode as _createElementVNode, createBlock as _createBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = { class: \"npc-detail-display\" };\nconst _hoisted_2 = { class: \"tabs\" };\nconst _hoisted_3 = [\"onClick\"];\nconst _hoisted_4 = { class: \"tab-content\" };\nconst _hoisted_5 = {\n    key: 1,\n    class: \"placeholder\"\n};\nimport { ref } from 'vue';\nimport NpcArchiveTab from './npc-details/NpcArchiveTab.vue';\nimport NpcAttributesTab from './npc-details/NpcAttributesTab.vue';\nimport NpcCauseTab from './npc-details/NpcCauseTab.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcDetailDisplay',\n    props: {\n        npc: {},\n        npcId: {}\n    },\n    setup(__props) {\n        const activeTab = ref('archive');\n        const tabs = [\n            { id: 'archive', name: '' },\n            { id: 'attributes', name: '' },\n            { id: 'cause', name: '' },\n        ];\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    (_openBlock(), _createElementBlock(_Fragment, null, _renderList(tabs, (tab) => {\n                        return _createElementVNode(\"button\", {\n                            key: tab.id,\n                            class: _normalizeClass({ active: activeTab.value === tab.id }),\n                            onClick: ($event) => (activeTab.value = tab.id)\n                        }, _toDisplayString(tab.name), 11 /* TEXT, CLASS, PROPS */, _hoisted_3);\n                    }), 64 /* STABLE_FRAGMENT */))\n                ]),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    (__props.npc)\n                        ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                            (activeTab.value === 'archive')\n                                ? (_openBlock(), _createBlock(NpcArchiveTab, {\n                                    key: 0,\n                                    npc: __props.npc\n                                }, null, 8 /* PROPS */, [\"npc\"]))\n                                : _createCommentVNode(\"v-if\", true),\n                            (activeTab.value === 'attributes')\n                                ? (_openBlock(), _createBlock(NpcAttributesTab, {\n                                    key: 1,\n                                    npc: __props.npc\n                                }, null, 8 /* PROPS */, [\"npc\"]))\n                                : _createCommentVNode(\"v-if\", true),\n                            (activeTab.value === 'cause')\n                                ? (_openBlock(), _createBlock(NpcCauseTab, {\n                                    key: 2,\n                                    npc: __props.npc,\n                                    \"npc-id\": __props.npcId\n                                }, null, 8 /* PROPS */, [\"npc\", \"npc-id\"]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ], 64 /* STABLE_FRAGMENT */))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [...(_cache[0] || (_cache[0] = [\n                                _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                            ]))]))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcDetailDisplay.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcDetailDisplay.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcDetailDisplay.vue?vue&type=style&index=0&id=1f5d23f4&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1f5d23f4\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n    key: 0,\n    class: \"location-info-card\"\n};\nconst _hoisted_2 = { class: \"info-grid\" };\nconst _hoisted_3 = { class: \"info-item\" };\nconst _hoisted_4 = { class: \"info-item\" };\nconst _hoisted_5 = { class: \"info-item\" };\nconst _hoisted_6 = { class: \"info-item\" };\nconst _hoisted_7 = { class: \"info-item full-width\" };\nconst _hoisted_8 = {\n    key: 1,\n    class: \"loading-placeholder\"\n};\nimport { computed } from 'vue';\nimport { npcService } from '../../services/NpcService';\nimport { store } from '../../store';\nimport { get } from 'lodash';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'LocationInfoCard',\n    props: {\n        locationId: {\n            type: String,\n            required: true,\n        },\n    },\n    setup(__props) {\n        const props = __props;\n        const locationDetails = computed(() => {\n            if (!props.locationId || !store.worldState?.)\n                return null;\n            for (const worldId in store.worldState.) {\n                const world = store.worldState.[worldId];\n                const historicalEpochs = get(world, '.', {});\n                for (const epochId in historicalEpochs) {\n                    const epoch = historicalEpochs[epochId];\n                    const entity = get(epoch, `..${props.locationId}`);\n                    if (entity) {\n                        return entity;\n                    }\n                }\n            }\n            return null;\n        });\n        const parentLocationName = computed(() => {\n            if (!locationDetails.value)\n                return '';\n            return npcService.getParentLocationName(props.locationId);\n        });\n        const cleanValue = (value) => {\n            if (typeof value !== 'string')\n                return value;\n            return value.replace(/[\"'\\[\\]]/g, '');\n        };\n        const formatArea = (area) => {\n            if (!area)\n                return '';\n            if (Array.isArray(area)) {\n                return area.join(' ');\n            }\n            const cleaned = cleanValue(String(area));\n            const parts = cleaned.split(',');\n            return parts.join(' ');\n        };\n        const formatCoordinates = (coords) => {\n            if (!coords)\n                return '';\n            try {\n                const refId = cleanValue(coords.ID);\n                const refName = npcService.getLocationName(refId);\n                const bearingString = cleanValue(coords.);\n                const bearingParts = bearingString.split(',');\n                const direction = bearingParts[0] || '';\n                const angle = bearingParts[1] || '';\n                const distanceString = cleanValue(String(coords.));\n                const distanceParts = distanceString.split(',');\n                const value = distanceParts[0] || '';\n                const unit = distanceParts[1] || '';\n                return ` ${refName} ${value}${unit} ${direction}${angle}`;\n            }\n            catch (e) {\n                console.error('Error formatting coordinates:', e);\n                return '';\n            }\n        };\n        return (_ctx, _cache) => {\n            return (locationDetails.value)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                    _createElementVNode(\"div\", _hoisted_2, [\n                        _createElementVNode(\"div\", _hoisted_3, [\n                            _cache[0] || (_cache[0] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"span\", null, _toDisplayString(cleanValue(locationDetails.value.)), 1 /* TEXT */)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_4, [\n                            _cache[1] || (_cache[1] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"span\", null, _toDisplayString(parentLocationName.value), 1 /* TEXT */)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_5, [\n                            _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"span\", null, _toDisplayString(formatArea(locationDetails.value.)), 1 /* TEXT */)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_6, [\n                            _cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"span\", null, _toDisplayString(formatCoordinates(locationDetails.value.)), 1 /* TEXT */)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_7, [\n                            _cache[4] || (_cache[4] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"span\", null, _toDisplayString(cleanValue(locationDetails.value.)), 1 /* TEXT */)\n                        ])\n                    ])\n                ]))\n                : (_openBlock(), _createElementBlock(\"div\", _hoisted_8, \"...\"));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./LocationInfoCard.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./LocationInfoCard.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./LocationInfoCard.vue?vue&type=style&index=0&id=007a4f99&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-007a4f99\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = { class: \"database-item-card\" };\nconst _hoisted_2 = { class: \"info-grid\" };\nconst _hoisted_3 = { class: \"info-item\" };\nconst _hoisted_4 = { class: \"info-item\" };\nconst _hoisted_5 = { class: \"info-item\" };\nconst _hoisted_6 = { class: \"info-item full-width\" };\nconst _hoisted_7 = {\n    key: 0,\n    class: \"info-item full-width\"\n};\nimport { computed } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'DatabaseItemCard',\n    props: {\n        item: {\n            type: Object,\n            required: true,\n        },\n    },\n    setup(__props) {\n        const props = __props;\n        const effects = computed(() => {\n            if (!props.item.effects)\n                return null;\n            const { attributes_bonus, percentage_bonus } = props.item.effects;\n            const parts = [];\n            if (attributes_bonus) {\n                for (const key in attributes_bonus) {\n                    if (key === '$meta')\n                        continue;\n                    parts.push(`${key} +${attributes_bonus[key]}`);\n                }\n            }\n            if (percentage_bonus) {\n                for (const key in percentage_bonus) {\n                    if (key === '$meta')\n                        continue;\n                    parts.push(`${key} +${percentage_bonus[key]}`);\n                }\n            }\n            return parts.join('');\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _cache[0] || (_cache[0] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.item. || ''), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_4, [\n                        _cache[1] || (_cache[1] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.item. || ''), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_5, [\n                        _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.item. ?? ''), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_6, [\n                        _cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.item. || ''), 1 /* TEXT */)\n                    ]),\n                    (effects.value)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [\n                            _cache[4] || (_cache[4] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"span\", null, _toDisplayString(effects.value), 1 /* TEXT */)\n                        ]))\n                        : _createCommentVNode(\"v-if\", true)\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./DatabaseItemCard.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DatabaseItemCard.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./DatabaseItemCard.vue?vue&type=style&index=0&id=58039cc0&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-58039cc0\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"game-text-container\" };\nconst _hoisted_2 = [\"onClick\"];\nimport { computed } from 'vue';\nimport { npcService } from '../../services/NpcService';\nimport { detailModalService } from '../../services/DetailModalService';\nimport NpcDetailDisplay from './NpcDetailDisplay.vue';\nimport LocationInfoCard from './LocationInfoCard.vue';\nimport DatabaseItemCard from './DatabaseItemCard.vue';\nimport { store } from '../../store';\nimport { mainWorld, avatarWorld } from '../../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'FormattedTextRenderer',\n    props: {\n        text: {\n            type: String,\n            required: true,\n        },\n    },\n    setup(__props) {\n        const props = __props;\n        const npcNamesRegex = computed(() => {\n            const names = npcService.allNpcs.value.map(npc => (Array.isArray(npc.) ? npc.[0] : npc.)).filter(Boolean);\n            if (names.length === 0)\n                return null;\n            const escapedNames = names.map(name => name.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'));\n            return new RegExp(`(${escapedNames.join('|')})`, 'g');\n        });\n        const locationNamesRegex = computed(() => {\n            const names = Array.from(npcService.locationCache.values()).map(loc => loc.name);\n            if (names.length === 0)\n                return null;\n            const escapedNames = names.map(name => name.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'));\n            return new RegExp(`(${escapedNames.join('|')})`, 'g');\n        });\n        const activeWorld = computed(() => (store.activeView === 'mainWorld' ? mainWorld.value : avatarWorld.value));\n        const databaseItemNamesRegex = computed(() => {\n            const database = activeWorld.value?.;\n            if (!database)\n                return null;\n            const names = [];\n            for (const category in database) {\n                if (category === '$meta')\n                    continue;\n                const categoryStore = database[category];\n                if (categoryStore) {\n                    for (const itemId in categoryStore) {\n                        if (itemId === '$meta')\n                            continue;\n                        const item = categoryStore[itemId];\n                        if (item && item.) {\n                            names.push(item.);\n                        }\n                    }\n                }\n            }\n            if (names.length === 0)\n                return null;\n            const escapedNames = names.map(name => name.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'));\n            return new RegExp(`(${escapedNames.join('|')})`, 'g');\n        });\n        const segments = computed(() => {\n            if (!props.text)\n                return [];\n            const cleanText = props.text.replace(/<[^>]*>/g, '');\n            return parseText(cleanText);\n        });\n        function parseText(text) {\n            const segments = [];\n            const regex = /(.*?)|(.*?)|(.*?)|(\\*.*?\\*)/g;\n            let lastIndex = 0;\n            let match;\n            while ((match = regex.exec(text)) !== null) {\n                if (match.index > lastIndex) {\n                    segments.push(...parseEntities(text.substring(lastIndex, match.index)));\n                }\n                const matchedText = match[0];\n                let innerText = '';\n                let outerClass = '';\n                if (match[1]) {\n                    innerText = matchedText.slice(2, -2);\n                    outerClass = 'text-system-highlight';\n                }\n                else if (match[2]) {\n                    innerText = matchedText.slice(1, -1);\n                    outerClass = 'text-scenery';\n                }\n                else if (match[3]) {\n                    innerText = matchedText.slice(1, -1);\n                    outerClass = 'text-dialogue';\n                }\n                else if (match[4]) {\n                    innerText = matchedText.slice(1, -1);\n                    outerClass = 'text-psychology';\n                }\n                const innerSegments = parseEntities(innerText);\n                innerSegments.forEach(segment => {\n                    const combinedClass = Array.isArray(segment.class)\n                        ? [outerClass, ...segment.class]\n                        : [outerClass, segment.class].filter(Boolean);\n                    segments.push({ ...segment, class: combinedClass });\n                });\n                lastIndex = match.index + matchedText.length;\n            }\n            if (lastIndex < text.length) {\n                segments.push(...parseEntities(text.substring(lastIndex)));\n            }\n            return segments;\n        }\n        function parseEntities(text) {\n            const segments = [];\n            const entityRegexParts = [];\n            if (npcNamesRegex.value)\n                entityRegexParts.push(npcNamesRegex.value.source);\n            if (locationNamesRegex.value)\n                entityRegexParts.push(locationNamesRegex.value.source);\n            if (databaseItemNamesRegex.value)\n                entityRegexParts.push(databaseItemNamesRegex.value.source);\n            if (entityRegexParts.length === 0) {\n                return [{ text, class: '' }];\n            }\n            const entityRegex = new RegExp(entityRegexParts.join('|'), 'g');\n            let lastIndex = 0;\n            let match;\n            while ((match = entityRegex.exec(text)) !== null) {\n                if (match.index > lastIndex) {\n                    segments.push({ text: text.substring(lastIndex, match.index), class: '' });\n                }\n                const name = match[0];\n                const npc = npcService.allNpcs.value.find(n => (Array.isArray(n.) ? n.[0] : n.) === name);\n                const locId = [...npcService.locationCache.entries()].find(([id, loc]) => loc.name === name)?.[0];\n                const item = getItemFromDatabase(name);\n                if (npc) {\n                    const relationshipClass = getNpcRelationshipClass(npc);\n                    segments.push({ text: name, class: ['npc-name', relationshipClass], npc });\n                }\n                else if (locId) {\n                    segments.push({ text: name, class: 'location-name', locationId: locId });\n                }\n                else if (item) {\n                    segments.push({ text: name, class: 'database-item-name', item });\n                }\n                else {\n                    segments.push({ text: name, class: '' });\n                }\n                lastIndex = match.index + name.length;\n            }\n            if (lastIndex < text.length) {\n                segments.push({ text: text.substring(lastIndex), class: '' });\n            }\n            return segments;\n        }\n        const showNpcInfo = (npc) => {\n            if (!npc)\n                return;\n            const npcId = npcService.getNpcId(npc);\n            const npcName = Array.isArray(npc.) ? npc.[0] : npc.;\n            detailModalService.show(npcName, NpcDetailDisplay, { npc, npcId });\n        };\n        const showLocationInfo = (locationId) => {\n            if (!locationId)\n                return;\n            const locationName = npcService.getLocationName(locationId);\n            detailModalService.show(locationName, LocationInfoCard, { locationId });\n        };\n        const showDatabaseItemInfo = (item) => {\n            if (!item)\n                return;\n            detailModalService.show(item., DatabaseItemCard, { item });\n        };\n        function getItemFromDatabase(name) {\n            const database = activeWorld.value?.;\n            if (!database)\n                return null;\n            for (const category in database) {\n                if (category === '$meta')\n                    continue;\n                const categoryStore = database[category];\n                if (categoryStore) {\n                    for (const itemId in categoryStore) {\n                        if (itemId === '$meta')\n                            continue;\n                        const item = categoryStore[itemId];\n                        if (item && item. === name) {\n                            return item;\n                        }\n                    }\n                }\n            }\n            return null;\n        }\n        function getNpcRelationshipClass(npc) {\n            const npcId = npcService.getNpcId(npc);\n            const causalNet = activeWorld.value?.;\n            if (!npcId || !causalNet || !causalNet[npcId]?.['']) {\n                return 'npc-unknown';\n            }\n            const relationship = causalNet[npcId][''];\n            const emotionalSum = (relationship.?. || 0) + (relationship.?. || 0);\n            if (emotionalSum <= -150)\n                return 'npc-hostile-intense';\n            if (emotionalSum <= -50)\n                return 'npc-hostile';\n            if (emotionalSum < 0)\n                return 'npc-unfriendly';\n            if (emotionalSum < 50)\n                return 'npc-neutral';\n            if (emotionalSum < 100)\n                return 'npc-friendly';\n            if (emotionalSum < 150)\n                return 'npc-devoted';\n            return 'npc-fanatical';\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(segments.value, (segment, index) => {\n                    return (_openBlock(), _createElementBlock(\"span\", {\n                        key: index,\n                        class: _normalizeClass(segment.class),\n                        onClick: ($event) => (segment.npc\n                            ? showNpcInfo(segment.npc)\n                            : segment.locationId\n                                ? showLocationInfo(segment.locationId)\n                                : segment.item\n                                    ? showDatabaseItemInfo(segment.item)\n                                    : null)\n                    }, _toDisplayString(segment.text), 11 /* TEXT, CLASS, PROPS */, _hoisted_2));\n                }), 128 /* KEYED_FRAGMENT */))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./FormattedTextRenderer.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./FormattedTextRenderer.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./FormattedTextRenderer.vue?vue&type=style&index=0&id=316766ee&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-316766ee\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n    class: \"main-content-wrapper\",\n    ref: \"mainContentWrapper\"\n};\nimport { combinedNarrative } from './store/getters';\nimport FormattedTextRenderer from './components/common/FormattedTextRenderer.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'MainView',\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createVNode(FormattedTextRenderer, { text: _unref(combinedNarrative) }, null, 8 /* PROPS */, [\"text\"])\n            ], 512 /* NEED_PATCH */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./MainView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MainView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MainView.vue?vue&type=style&index=0&id=41e6892e&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeStyle as _normalizeStyle } from \"vue\";\nconst _hoisted_1 = { class: \"destiny-plate-container\" };\nconst _hoisted_2 = { class: \"destiny-plate\" };\nconst _hoisted_3 = { class: \"plate-center\" };\nconst _hoisted_4 = { class: \"plate-core\" };\nconst _hoisted_5 = { class: \"core-title\" };\nconst _hoisted_6 = { class: \"core-description\" };\nconst _hoisted_7 = { class: \"inner-ring\" };\nconst _hoisted_8 = [\"onMouseenter\"];\nconst _hoisted_9 = { class: \"node-name\" };\nconst _hoisted_10 = { class: \"node-value\" };\nconst _hoisted_11 = { class: \"middle-ring\" };\nconst _hoisted_12 = [\"onMouseenter\"];\nconst _hoisted_13 = { class: \"node-name\" };\nconst _hoisted_14 = { class: \"node-value\" };\nconst _hoisted_15 = { class: \"outer-ring\" };\nconst _hoisted_16 = {\n    class: \"orbit-svg\",\n    viewBox: \"0 0 100 100\"\n};\nconst _hoisted_17 = [\"onMouseenter\"];\nconst _hoisted_18 = [\"onMouseenter\"];\nconst _hoisted_19 = { class: \"node-name\" };\nconst _hoisted_20 = {\n    key: 0,\n    class: \"node-value\"\n};\nimport { computed, ref } from 'vue';\nimport { store } from '../../store';\nconst defaultTitle = '';\nconst defaultDescription = '';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'DestinyPlate',\n    props: {\n        character: {\n            type: Object,\n            default: null,\n        },\n    },\n    setup(__props) {\n        const props = __props;\n        const centerTitle = ref(defaultTitle);\n        const centerDescription = ref(defaultDescription);\n        const getDisplayValue = (value, defaultValue = 0) => {\n            if (value === null || value === undefined)\n                return defaultValue;\n            return value;\n        };\n        const formatComplexValue = (value) => {\n            if (value === null || value === undefined)\n                return null;\n            if (typeof value === 'object' && !Array.isArray(value)) {\n                const keys = Object.keys(value).filter(k => k !== '$meta' && k !== 'description');\n                if (keys.includes('value'))\n                    return getDisplayValue(value.value);\n                if (keys.length > 0 && keys.every(k => typeof value[k] === 'object' && value[k]?.)) {\n                    return value[keys[0]].; // \n                }\n                if (keys.length === 1)\n                    return formatComplexValue(value[keys[0]]);\n                return '...';\n            }\n            return value;\n        };\n        //  prop store\n        const characterData = computed(() => props.character || store.character);\n        // \n        const innerRingNodes = computed(() => {\n            const char = characterData.value;\n            return [\n                { id: 'name', name: '', value: getDisplayValue(char?., ''), description: '' },\n                { id: 'soul', name: '', value: getDisplayValue(char?., 0), description: '' },\n                { id: 'dao', name: '', value: getDisplayValue(char?., 0), description: '' },\n                {\n                    id: 'jing',\n                    name: '',\n                    value: getDisplayValue(char?.?.),\n                    description: '',\n                },\n                { id: 'qi', name: '', value: getDisplayValue(char?.?.), description: '' },\n                { id: 'shen', name: '', value: getDisplayValue(char?.?.), description: '' },\n                { id: 'yun', name: '', value: getDisplayValue(char?.?.), description: '' },\n            ];\n        });\n        // \n        const combatParams = computed(() => {\n            const char = characterData.value;\n            return [\n                {\n                    id: 'quanneng',\n                    name: '',\n                    value: getDisplayValue(char?.?.),\n                    description: '',\n                },\n                {\n                    id: 'genji',\n                    name: '',\n                    value: getDisplayValue(char?.?.),\n                    description: '',\n                },\n                {\n                    id: 'jibian',\n                    name: '',\n                    value: getDisplayValue(char?.?.),\n                    description: '',\n                },\n                {\n                    id: 'pofa',\n                    name: '',\n                    value: getDisplayValue(char?.?.),\n                    description: '',\n                },\n                {\n                    id: 'yufa',\n                    name: '',\n                    value: getDisplayValue(char?.?.),\n                    description: '',\n                },\n            ];\n        });\n        // \n        const orbitalNodes = computed(() => {\n            const char = characterData.value;\n            if (!char || !char.)\n                return [];\n            const attrs = char.;\n            const world = store.worldState?.?.[char.];\n            const currentEpochId = world?.?.?.ID;\n            const currentEpoch = currentEpochId ? world?..?.[currentEpochId] : null;\n            const attributeTemplates = currentEpoch?.?.;\n            const specialKeys = ['', ''];\n            return Object.entries(attrs)\n                .filter(([key]) => key !== '$meta')\n                .map(([key, attrValue]) => {\n                const template = attributeTemplates ? attributeTemplates[key] : null;\n                const name = template?. || key;\n                const isSpecial = specialKeys.includes(name);\n                let description = template?. || `: ${name}`;\n                let value = null;\n                let type = 'node';\n                let max = 'MAX';\n                if (typeof attrValue === 'object' && attrValue !== null) {\n                    description = attrValue.description || description;\n                    const valueKeys = Object.keys(attrValue).filter(k => k !== '$meta' && k !== 'description');\n                    if (('current' in attrValue || '' in attrValue) && ('max' in attrValue || '' in attrValue)) {\n                        type = 'orbit';\n                        value = getDisplayValue(attrValue. ?? attrValue.current, 0);\n                        max = getDisplayValue(attrValue. ?? attrValue.max, 100);\n                        description = `${name}: ${value} / ${max}`;\n                    }\n                    else if ('value' in attrValue) {\n                        value = getDisplayValue(attrValue.value, '-');\n                    }\n                    else if (valueKeys.length > 0 &&\n                        valueKeys.every(k => typeof attrValue[k] === 'object' && attrValue[k]?.)) {\n                        value = valueKeys.map(k => attrValue[k].).join('');\n                    }\n                    else if (valueKeys.length > 0) {\n                        value = '...';\n                        // ,\n                        const innerDescription = Object.keys(attrValue)\n                            .filter(k => k !== '$meta' && k !== 'description' && k !== '')\n                            .map(k => `${k}: ${getDisplayValue(attrValue[k])}`)\n                            .join(' | ');\n                        description = innerDescription;\n                    }\n                }\n                else {\n                    value = getDisplayValue(attrValue, '-');\n                }\n                return { id: key, name: name, value, max, type, description, isSpecial };\n            });\n        });\n        const setCenterContent = (item) => {\n            centerTitle.value = item.name;\n            centerDescription.value = item.description || '';\n        };\n        const resetCenterContent = () => {\n            centerTitle.value = defaultTitle;\n            centerDescription.value = defaultDescription;\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createCommentVNode(\"  \"),\n                    _cache[1] || (_cache[1] = _createElementVNode(\"div\", { class: \"static-orbit orbit-1\" }, null, -1 /* CACHED */)),\n                    _cache[2] || (_cache[2] = _createElementVNode(\"div\", { class: \"static-orbit orbit-2\" }, null, -1 /* CACHED */)),\n                    _cache[3] || (_cache[3] = _createElementVNode(\"div\", { class: \"static-orbit orbit-3\" }, null, -1 /* CACHED */)),\n                    _cache[4] || (_cache[4] = _createElementVNode(\"div\", { class: \"static-orbit orbit-4\" }, null, -1 /* CACHED */)),\n                    _createCommentVNode(\"  \"),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _createElementVNode(\"div\", _hoisted_4, [\n                            _createElementVNode(\"span\", _hoisted_5, _toDisplayString(centerTitle.value), 1 /* TEXT */),\n                            _createElementVNode(\"div\", _hoisted_6, _toDisplayString(centerDescription.value), 1 /* TEXT */)\n                        ])\n                    ]),\n                    _createCommentVNode(\" :  \"),\n                    _createElementVNode(\"div\", _hoisted_7, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(innerRingNodes.value, (node, index) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: node.id,\n                                class: \"node inner-node\",\n                                style: _normalizeStyle({ '--angle': (index / innerRingNodes.value.length) * 360 + 'deg' }),\n                                onMouseenter: ($event) => (setCenterContent(node)),\n                                onMouseleave: resetCenterContent\n                            }, [\n                                _createElementVNode(\"span\", _hoisted_9, _toDisplayString(node.name), 1 /* TEXT */),\n                                _createElementVNode(\"span\", _hoisted_10, _toDisplayString(node.value), 1 /* TEXT */)\n                            ], 44 /* STYLE, PROPS, NEED_HYDRATION */, _hoisted_8));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]),\n                    _createCommentVNode(\" :  \"),\n                    _createElementVNode(\"div\", _hoisted_11, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(combatParams.value, (param, index) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: param.id,\n                                class: \"node param-node\",\n                                style: _normalizeStyle({ '--angle': (index / combatParams.value.length) * 360 + 18 + 'deg' }),\n                                onMouseenter: ($event) => (setCenterContent(param)),\n                                onMouseleave: resetCenterContent\n                            }, [\n                                _createElementVNode(\"span\", _hoisted_13, _toDisplayString(param.name), 1 /* TEXT */),\n                                _createElementVNode(\"span\", _hoisted_14, _toDisplayString(param.value), 1 /* TEXT */)\n                            ], 44 /* STYLE, PROPS, NEED_HYDRATION */, _hoisted_12));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]),\n                    _createCommentVNode(\" :  \"),\n                    _createElementVNode(\"div\", _hoisted_15, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(orbitalNodes.value, (attr, index) => {\n                            return (_openBlock(), _createElementBlock(_Fragment, {\n                                key: attr.id\n                            }, [\n                                _createCommentVNode(\"  'orbit'  \"),\n                                (attr.type === 'orbit')\n                                    ? (_openBlock(), _createElementBlock(\"div\", {\n                                        key: 0,\n                                        class: \"orbit-track\",\n                                        style: _normalizeStyle({ '--angle': (index / orbitalNodes.value.length) * 360 + 'deg' })\n                                    }, [\n                                        (_openBlock(), _createElementBlock(\"svg\", _hoisted_16, [\n                                            _cache[0] || (_cache[0] = _createElementVNode(\"circle\", {\n                                                class: \"track\",\n                                                cx: \"50\",\n                                                cy: \"50\",\n                                                r: \"45\"\n                                            }, null, -1 /* CACHED */)),\n                                            _createElementVNode(\"circle\", {\n                                                class: \"progress\",\n                                                cx: \"50\",\n                                                cy: \"50\",\n                                                r: \"45\",\n                                                style: _normalizeStyle({\n                                                    'stroke-dashoffset': 283 *\n                                                        (1 -\n                                                            (typeof attr.value === 'number' && typeof attr.max === 'number' && attr.max > 0\n                                                                ? attr.value / attr.max\n                                                                : 0)),\n                                                })\n                                            }, null, 4 /* STYLE */)\n                                        ])),\n                                        _createElementVNode(\"div\", {\n                                            class: \"orbit-label\",\n                                            onMouseenter: ($event) => (setCenterContent(attr)),\n                                            onMouseleave: resetCenterContent\n                                        }, _toDisplayString(attr.name), 41 /* TEXT, PROPS, NEED_HYDRATION */, _hoisted_17)\n                                    ], 4 /* STYLE */))\n                                    : (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                                        _createCommentVNode(\"  'node'  \"),\n                                        _createElementVNode(\"div\", {\n                                            class: \"node world-node\",\n                                            style: _normalizeStyle({ '--angle': (index / orbitalNodes.value.length) * 360 + 'deg' }),\n                                            onMouseenter: ($event) => (setCenterContent(attr)),\n                                            onMouseleave: resetCenterContent\n                                        }, [\n                                            _createElementVNode(\"span\", _hoisted_19, _toDisplayString(attr.name), 1 /* TEXT */),\n                                            (attr.value !== null)\n                                                ? (_openBlock(), _createElementBlock(\"span\", _hoisted_20, _toDisplayString(attr.value), 1 /* TEXT */))\n                                                : _createCommentVNode(\"v-if\", true)\n                                        ], 44 /* STYLE, PROPS, NEED_HYDRATION */, _hoisted_18)\n                                    ], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */))\n                            ], 64 /* STABLE_FRAGMENT */));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./DestinyPlate.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DestinyPlate.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./DestinyPlate.vue?vue&type=style&index=0&id=2677dddc&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-2677dddc\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, createCommentVNode as _createCommentVNode, createVNode as _createVNode, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"panel-wrapper character-panel-container\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"character-sheet\"\n};\nconst _hoisted_3 = { class: \"drawer-content\" };\nconst _hoisted_4 = { class: \"world-attributes-section\" };\nconst _hoisted_5 = {\n    key: 0,\n    class: \"attributes-list\"\n};\nconst _hoisted_6 = { class: \"label\" };\nconst _hoisted_7 = { class: \"value\" };\nconst _hoisted_8 = {\n    key: 1,\n    class: \"empty-state\"\n};\nconst _hoisted_9 = { class: \"combat-attributes-section\" };\nconst _hoisted_10 = {\n    key: 0,\n    class: \"attributes-list\"\n};\nconst _hoisted_11 = { class: \"label\" };\nconst _hoisted_12 = { class: \"value\" };\nconst _hoisted_13 = {\n    key: 1,\n    class: \"empty-state\"\n};\nconst _hoisted_14 = {\n    key: 1,\n    class: \"loading-state\"\n};\nimport { computed, ref } from 'vue';\nimport { currentAvatar } from '../../../store/getters';\nimport DestinyPlate from '../DestinyPlate.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'AvatarCharacterPanel',\n    setup(__props) {\n        const getDisplayValue = (value, defaultValue = 0) => {\n            if (value === null || value === undefined)\n                return defaultValue;\n            return value;\n        };\n        const formatAttribute = (attr) => {\n            if (attr === null || attr === undefined)\n                return '-';\n            if (typeof attr === 'object' && !Array.isArray(attr)) {\n                if (attr. !== undefined && attr. !== undefined) {\n                    return `${attr.} / ${attr.}`;\n                }\n                const keys = Object.keys(attr).filter(k => k !== '$meta');\n                if (keys.length > 0) {\n                    return Object.entries(attr)\n                        .filter(([key]) => key !== '$meta')\n                        .map(([key, val]) => `${key}: ${getDisplayValue(val)}`)\n                        .join(', ');\n                }\n                return '';\n            }\n            return String(getDisplayValue(attr));\n        };\n        const worldSpecificAttributes = computed(() => currentAvatar.value?. || {});\n        const combatAttributes = computed(() => currentAvatar.value?. || {});\n        const isDrawerOpen = ref(false);\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (_unref(currentAvatar))\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _createCommentVNode(\"  \"),\n                        _createVNode(DestinyPlate, { character: _unref(currentAvatar) }, null, 8 /* PROPS */, [\"character\"]),\n                        _createCommentVNode(\"  \"),\n                        _createElementVNode(\"div\", {\n                            class: _normalizeClass([\"additional-info-drawer\", { 'is-open': isDrawerOpen.value }])\n                        }, [\n                            _createElementVNode(\"button\", {\n                                class: \"drawer-toggle\",\n                                onClick: _cache[0] || (_cache[0] = ($event) => (isDrawerOpen.value = !isDrawerOpen.value))\n                            }, [...(_cache[1] || (_cache[1] = [\n                                    _createElementVNode(\"i\", { class: \"drawer-icon\" }, null, -1 /* CACHED */),\n                                    _createElementVNode(\"span\", null, \"\", -1 /* CACHED */)\n                                ]))]),\n                            _createElementVNode(\"div\", _hoisted_3, [\n                                _createCommentVNode(\"  \"),\n                                _createElementVNode(\"div\", _hoisted_4, [\n                                    _cache[2] || (_cache[2] = _createElementVNode(\"h5\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                                    (worldSpecificAttributes.value && Object.keys(worldSpecificAttributes.value).length > 0)\n                                        ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_5, [\n                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(worldSpecificAttributes.value, (value, key) => {\n                                                return (_openBlock(), _createElementBlock(\"li\", {\n                                                    key: key,\n                                                    class: \"attribute-item\"\n                                                }, [\n                                                    _createElementVNode(\"span\", _hoisted_6, _toDisplayString(key), 1 /* TEXT */),\n                                                    _createElementVNode(\"span\", _hoisted_7, _toDisplayString(formatAttribute(value)), 1 /* TEXT */)\n                                                ]));\n                                            }), 128 /* KEYED_FRAGMENT */))\n                                        ]))\n                                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_8, \"\"))\n                                ]),\n                                _createCommentVNode(\"  \"),\n                                _createElementVNode(\"div\", _hoisted_9, [\n                                    _cache[3] || (_cache[3] = _createElementVNode(\"h5\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                                    (combatAttributes.value && Object.keys(combatAttributes.value).length > 0)\n                                        ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_10, [\n                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(combatAttributes.value, (value, key) => {\n                                                return (_openBlock(), _createElementBlock(\"li\", {\n                                                    key: key,\n                                                    class: \"attribute-item\"\n                                                }, [\n                                                    _createElementVNode(\"span\", _hoisted_11, _toDisplayString(key), 1 /* TEXT */),\n                                                    _createElementVNode(\"span\", _hoisted_12, _toDisplayString(formatAttribute(value)), 1 /* TEXT */)\n                                                ]));\n                                            }), 128 /* KEYED_FRAGMENT */))\n                                        ]))\n                                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_13, \"\"))\n                                ])\n                            ])\n                        ], 2 /* CLASS */)\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_14, \"...\"))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./AvatarCharacterPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AvatarCharacterPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./AvatarCharacterPanel.vue?vue&type=style&index=0&id=609940ae&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-609940ae\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, normalizeStyle as _normalizeStyle, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"panel-wrapper inventory-panel\" };\nconst _hoisted_2 = { class: \"main-content\" };\nconst _hoisted_3 = { class: \"item-grid-container\" };\nconst _hoisted_4 = { class: \"item-grid\" };\nconst _hoisted_5 = [\"onClick\"];\nconst _hoisted_6 = {\n    class: \"item-name-arc\",\n    viewBox: \"0 0 100 100\"\n};\nconst _hoisted_7 = [\"id\"];\nconst _hoisted_8 = [\"xlink:href\"];\nconst _hoisted_9 = { class: \"item-footer\" };\nconst _hoisted_10 = {\n    key: 0,\n    class: \"item-quantity\"\n};\nconst _hoisted_11 = {\n    key: 0,\n    class: \"empty-grid\"\n};\nconst _hoisted_12 = { class: \"scroll-detail-view\" };\nconst _hoisted_13 = {\n    key: 0,\n    class: \"scroll-content\"\n};\nconst _hoisted_14 = { class: \"detail-meta\" };\nconst _hoisted_15 = {\n    key: 0,\n    class: \"meta-tier\"\n};\nconst _hoisted_16 = {\n    key: 1,\n    class: \"meta-type\"\n};\nconst _hoisted_17 = { class: \"detail-desc\" };\nconst _hoisted_18 = {\n    key: 0,\n    class: \"detail-effects\"\n};\nconst _hoisted_19 = { key: 0 };\nconst _hoisted_20 = { key: 1 };\nconst _hoisted_21 = {\n    key: 1,\n    class: \"loading\"\n};\nimport { computed, ref } from 'vue';\nimport { currentAvatar, avatarInventory } from '../../../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'AvatarInventoryPanel',\n    setup(__props) {\n        const selectedItem = ref(null);\n        const selectItem = (item) => {\n            selectedItem.value = item;\n        };\n        const closeDetail = () => {\n            selectedItem.value = null;\n        };\n        const avatarItems = computed(() => {\n            return avatarInventory.value;\n        });\n        const tierColorMap = {\n            common: '128, 128, 128', // grey-stone\n            rare: '45, 200, 240', // cyan-tian\n            epic: '138, 43, 226', // purple-mystery\n            legendary: '218, 165, 32', // gold-liu\n        };\n        const getTierStyle = (item) => {\n            let tierKey = 'common';\n            if (item && item.) {\n                const tier = item.;\n                if (tier >= 9)\n                    tierKey = 'legendary';\n                else if (tier >= 6)\n                    tierKey = 'epic';\n                else if (tier >= 3)\n                    tierKey = 'rare';\n            }\n            return {\n                '--tier-color-rgb': tierColorMap[tierKey],\n            };\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (_unref(currentAvatar))\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 0,\n                        class: _normalizeClass([\"inventory-layout\", { 'detail-open': selectedItem.value }])\n                    }, [\n                        _createCommentVNode(\" Main Content: Categories and Grid \"),\n                        _createElementVNode(\"div\", _hoisted_2, [\n                            _createCommentVNode(\"  \"),\n                            _createElementVNode(\"div\", _hoisted_3, [\n                                _createElementVNode(\"div\", _hoisted_4, [\n                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(avatarItems.value, (item, index) => {\n                                        return (_openBlock(), _createElementBlock(_Fragment, {\n                                            key: item.ID || `item-${index}`\n                                        }, [\n                                            _createCommentVNode(\"  \"),\n                                            _createElementVNode(\"div\", {\n                                                class: \"item-cell\",\n                                                style: _normalizeStyle(getTierStyle(item)),\n                                                onClick: ($event) => (selectItem(item))\n                                            }, [\n                                                _createCommentVNode(\" SVG \"),\n                                                (_openBlock(), _createElementBlock(\"svg\", _hoisted_6, [\n                                                    _createElementVNode(\"defs\", null, [\n                                                        _createCommentVNode(\"  \"),\n                                                        _createElementVNode(\"path\", {\n                                                            id: `arc-path-${item.ID || index}`,\n                                                            d: \"M 12,52 a 38,38 0 1,1 76,0\",\n                                                            fill: \"none\"\n                                                        }, null, 8 /* PROPS */, _hoisted_7)\n                                                    ]),\n                                                    _createElementVNode(\"text\", null, [\n                                                        _createElementVNode(\"textPath\", {\n                                                            class: \"arc-text\",\n                                                            \"xlink:href\": `#arc-path-${item.ID || index}`,\n                                                            startOffset: \"50%\",\n                                                            \"text-anchor\": \"middle\"\n                                                        }, _toDisplayString(item.), 9 /* TEXT, PROPS */, _hoisted_8)\n                                                    ])\n                                                ])),\n                                                _createElementVNode(\"div\", _hoisted_9, [\n                                                    ('' in item && item.)\n                                                        ? (_openBlock(), _createElementBlock(\"span\", _hoisted_10, \"x\" + _toDisplayString(item.), 1 /* TEXT */))\n                                                        : _createCommentVNode(\"v-if\", true)\n                                                ])\n                                            ], 12 /* STYLE, PROPS */, _hoisted_5)\n                                        ], 64 /* STABLE_FRAGMENT */));\n                                    }), 128 /* KEYED_FRAGMENT */))\n                                ]),\n                                (avatarItems.value.length === 0)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [...(_cache[0] || (_cache[0] = [\n                                            _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                                        ]))]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ])\n                        ]),\n                        _createCommentVNode(\" Right: Item Detail Scroll \"),\n                        _createElementVNode(\"div\", _hoisted_12, [\n                            (selectedItem.value)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_13, [\n                                    _createElementVNode(\"button\", {\n                                        onClick: closeDetail,\n                                        class: \"close-button\"\n                                    }, \"\"),\n                                    _createElementVNode(\"h4\", {\n                                        class: \"detail-name\",\n                                        style: _normalizeStyle(getTierStyle(selectedItem.value))\n                                    }, _toDisplayString(selectedItem.value.), 5 /* TEXT, STYLE */),\n                                    _createElementVNode(\"div\", _hoisted_14, [\n                                        (selectedItem.value.)\n                                            ? (_openBlock(), _createElementBlock(\"span\", _hoisted_15, \" \" + _toDisplayString(selectedItem.value.), 1 /* TEXT */))\n                                            : _createCommentVNode(\"v-if\", true),\n                                        (selectedItem.value.)\n                                            ? (_openBlock(), _createElementBlock(\"span\", _hoisted_16, _toDisplayString(selectedItem.value.), 1 /* TEXT */))\n                                            : _createCommentVNode(\"v-if\", true)\n                                    ]),\n                                    _createElementVNode(\"p\", _hoisted_17, _toDisplayString(selectedItem.value.), 1 /* TEXT */),\n                                    (selectedItem.value.effects)\n                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_18, [\n                                            _cache[1] || (_cache[1] = _createElementVNode(\"h5\", null, \":\", -1 /* CACHED */)),\n                                            (selectedItem.value.effects.attributes_bonus && Object.keys(selectedItem.value.effects.attributes_bonus).length > 0)\n                                                ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_19, [\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(selectedItem.value.effects.attributes_bonus, (value, key) => {\n                                                        return (_openBlock(), _createElementBlock(\"li\", { key: key }, _toDisplayString(key) + \" +\" + _toDisplayString(value), 1 /* TEXT */));\n                                                    }), 128 /* KEYED_FRAGMENT */))\n                                                ]))\n                                                : _createCommentVNode(\"v-if\", true),\n                                            (selectedItem.value.effects.percentage_bonus && Object.keys(selectedItem.value.effects.percentage_bonus).length > 0)\n                                                ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_20, [\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(selectedItem.value.effects.percentage_bonus, (value, key) => {\n                                                        return (_openBlock(), _createElementBlock(\"li\", { key: key }, _toDisplayString(key) + \" \" + _toDisplayString(value), 1 /* TEXT */));\n                                                    }), 128 /* KEYED_FRAGMENT */))\n                                                ]))\n                                                : _createCommentVNode(\"v-if\", true)\n                                        ]))\n                                        : _createCommentVNode(\"v-if\", true)\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ])\n                    ], 2 /* CLASS */))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_21, \"...\"))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./AvatarInventoryPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AvatarInventoryPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./AvatarInventoryPanel.vue?vue&type=style&index=0&id=4352d576&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-4352d576\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeClass as _normalizeClass, normalizeStyle as _normalizeStyle, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, unref as _unref } from \"vue\";\nconst _hoisted_1 = { class: \"panel-wrapper tasks-panel-starmap\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"starmap-container\"\n};\nconst _hoisted_3 = { class: \"starmap-svg\" };\nconst _hoisted_4 = [\"d\"];\nconst _hoisted_5 = [\"onClick\"];\nconst _hoisted_6 = { class: \"star-label\" };\nconst _hoisted_7 = [\"onClick\"];\nconst _hoisted_8 = { class: \"detail-desc\" };\nconst _hoisted_9 = { class: \"detail-meta\" };\nconst _hoisted_10 = { key: 0 };\nconst _hoisted_11 = { key: 1 };\nconst _hoisted_12 = { key: 2 };\nconst _hoisted_13 = { key: 3 };\nconst _hoisted_14 = {\n    key: 1,\n    class: \"no-data\"\n};\nimport { get } from 'lodash';\nimport { computed, reactive, ref } from 'vue';\nimport { currentAvatar } from '../../../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'AvatarTasksPanel',\n    setup(__props) {\n        const destiny = computed(() => get(currentAvatar.value, '', null));\n        // [Roo-Fix]  getItemsArray \n        const getItemsArray = (data) => {\n            if (!Array.isArray(data)) {\n                return [];\n            }\n            //  [ [items], \"desc\" ]  [ [items] ]\n            if (Array.isArray(data[0])) {\n                return data[0];\n            }\n            //  [items] ()\n            return data;\n        };\n        const allTasks = computed(() => {\n            if (!destiny.value)\n                return [];\n            const taskObject = get(destiny.value, '', {});\n            return Object.values(taskObject);\n        });\n        const ultimateTask = computed(() => {\n            if (!destiny.value)\n                return null;\n            return get(destiny.value, '', null);\n        });\n        const destinyNodes = computed(() => {\n            return allTasks.value.filter(task => task. === '');\n        });\n        const derivedTasks = computed(() => {\n            return allTasks.value.filter(task => task. === '');\n        });\n        const selectedNode = ref(null);\n        const detailModalStyle = reactive({ top: '0px', left: '0px', transform: 'translate(-50%, -50%)' });\n        const getTaskNameById = (taskId) => {\n            if (!taskId)\n                return '';\n            const task = allTasks.value.find(t => t.ID === taskId);\n            return task ? task. : taskId;\n        };\n        const starPositions = computed(() => {\n            const positions = [];\n            const totalNodes = destinyNodes.value.length;\n            positions.push({ top: '15%', left: '50%' });\n            const startY = 85;\n            const endY = 30;\n            destinyNodes.value.forEach((_, i) => {\n                const progress = totalNodes > 1 ? i / (totalNodes - 1) : 0.5;\n                const y = startY - (startY - endY) * progress;\n                const x = 50 + 20 * Math.sin(progress * Math.PI * 2);\n                positions.push({ top: `${y}%`, left: `${x}%` });\n            });\n            return positions;\n        });\n        const starPaths = computed(() => {\n            if (starPositions.value.length <= 1)\n                return [];\n            const paths = [];\n            for (let i = 0; i < destinyNodes.value.length - 1; i++) {\n                const startPos = starPositions.value[i + 1];\n                const endPos = starPositions.value[i + 2];\n                const d = `M ${parseFloat(startPos.left)} ${parseFloat(startPos.top)} Q ${(parseFloat(startPos.left) + parseFloat(endPos.left)) / 2} ${(parseFloat(startPos.top) + parseFloat(endPos.top)) / 2} ${parseFloat(endPos.left)} ${parseFloat(endPos.top)}`;\n                paths.push({\n                    d,\n                    class: destinyNodes.value[i + 1]. === '' ? 'star-path triggered' : 'star-path',\n                });\n            }\n            if (destinyNodes.value.length > 0) {\n                const lastNodePos = starPositions.value[destinyNodes.value.length];\n                const ultimatePos = starPositions.value[0];\n                const d = `M ${parseFloat(lastNodePos.left)} ${parseFloat(lastNodePos.top)} Q ${(parseFloat(lastNodePos.left) + parseFloat(ultimatePos.left)) / 2} ${(parseFloat(lastNodePos.top) + parseFloat(ultimatePos.top)) / 2} ${parseFloat(ultimatePos.left)} ${parseFloat(ultimatePos.top)}`;\n                paths.push({\n                    d,\n                    class: destinyNodes.value[destinyNodes.value.length - 1]. === '' ? 'star-path triggered' : 'star-path',\n                });\n            }\n            derivedTasks.value.forEach((task, index) => {\n                const parentNode = destinyNodes.value.find(n => n.ID === task.ID);\n                if (parentNode) {\n                    const parentNodeIndex = destinyNodes.value.indexOf(parentNode);\n                    const parentPos = starPositions.value[parentNodeIndex + 1];\n                    const taskPos = getDerivedStarPosition(task, index);\n                    const d = `M ${parseFloat(parentPos.left)} ${parseFloat(parentPos.top)} L ${parseFloat(taskPos.left.replace('calc(', '').replace(')', ''))} ${parseFloat(taskPos.top.replace('calc(', '').replace(')', ''))}`;\n                    paths.push({\n                        d,\n                        class: 'star-path derived-path',\n                    });\n                }\n            });\n            return paths;\n        });\n        const getDerivedStarPosition = (task, index) => {\n            const parentNode = destinyNodes.value.find(n => n.ID === task.ID);\n            if (!parentNode)\n                return { top: '0%', left: '0%' };\n            const parentNodeIndex = destinyNodes.value.indexOf(parentNode);\n            const parentPos = starPositions.value[parentNodeIndex + 1];\n            const offsetX = (index % 2 === 0 ? 5 : -5) * (Math.floor(index / 2) + 1);\n            const offsetY = (index % 2 === 0 ? -5 : 5) * (Math.floor(index / 2) + 1);\n            return {\n                top: `calc(${parentPos.top} + ${offsetY}%)`,\n                left: `calc(${parentPos.left} + ${offsetX}%)`,\n            };\n        };\n        const selectNode = (nodeData, type, event) => {\n            selectedNode.value = { data: nodeData, type, el: event.currentTarget };\n            const starNode = event.currentTarget;\n            const top = `calc(${starNode.style.top} + 20px)`;\n            const left = `calc(${starNode.style.left} + 20px)`;\n            detailModalStyle.top = top;\n            detailModalStyle.left = left;\n        };\n        const startDrag = (event) => {\n            const modal = event.target.closest('.node-detail-modal');\n            if (!modal)\n                return;\n            const startX = event.clientX;\n            const startY = event.clientY;\n            const startTop = modal.offsetTop;\n            const startLeft = modal.offsetLeft;\n            const doDrag = (e) => {\n                detailModalStyle.top = `${startTop + e.clientY - startY}px`;\n                detailModalStyle.left = `${startLeft + e.clientX - startX}px`;\n            };\n            const stopDrag = () => {\n                document.removeEventListener('mousemove', doDrag);\n                document.removeEventListener('mouseup', stopDrag);\n            };\n            document.addEventListener('mousemove', doDrag);\n            document.addEventListener('mouseup', stopDrag);\n        };\n        const getStarPosition = (index) => {\n            return starPositions.value[index] || { top: '50%', left: '50%' };\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (destiny.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        (_openBlock(), _createElementBlock(\"svg\", _hoisted_3, [\n                            _cache[2] || (_cache[2] = _createElementVNode(\"defs\", null, [\n                                _createElementVNode(\"linearGradient\", {\n                                    id: \"grad-triggered\",\n                                    x1: \"0%\",\n                                    y1: \"0%\",\n                                    x2: \"0%\",\n                                    y2: \"100%\"\n                                }, [\n                                    _createElementVNode(\"stop\", {\n                                        offset: \"0%\",\n                                        style: { \"stop-color\": \"rgba(0, 255, 255, 0.8)\" }\n                                    }),\n                                    _createElementVNode(\"stop\", {\n                                        offset: \"100%\",\n                                        style: { \"stop-color\": \"rgba(138, 43, 226, 0.8)\" }\n                                    })\n                                ])\n                            ], -1 /* CACHED */)),\n                            _createCommentVNode(\"  \"),\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(starPaths.value, (path) => {\n                                return (_openBlock(), _createElementBlock(\"path\", {\n                                    key: path.d,\n                                    d: path.d,\n                                    class: _normalizeClass(path.class)\n                                }, null, 10 /* CLASS, PROPS */, _hoisted_4));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ])),\n                        _createCommentVNode(\"  () \"),\n                        (ultimateTask.value)\n                            ? (_openBlock(), _createElementBlock(\"div\", {\n                                key: 0,\n                                class: \"star-node ultimate-star\",\n                                style: _normalizeStyle(getStarPosition(0)),\n                                onClick: _cache[0] || (_cache[0] = ($event) => (selectNode(ultimateTask.value, 'ultimate', $event)))\n                            }, [...(_cache[3] || (_cache[3] = [\n                                    _createElementVNode(\"div\", { class: \"star-core\" }, null, -1 /* CACHED */),\n                                    _createElementVNode(\"div\", { class: \"star-label\" }, \"\", -1 /* CACHED */)\n                                ]))], 4 /* STYLE */))\n                            : _createCommentVNode(\"v-if\", true),\n                        _createCommentVNode(\"  () \"),\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(destinyNodes.value, (node, index) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: node.ID,\n                                class: _normalizeClass([\"star-node destiny-star\", { triggered: node. === '' }]),\n                                style: _normalizeStyle(getStarPosition(index + 1)),\n                                onClick: ($event) => (selectNode(node, 'destiny', $event))\n                            }, [\n                                _cache[4] || (_cache[4] = _createElementVNode(\"div\", { class: \"star-core\" }, null, -1 /* CACHED */)),\n                                _createElementVNode(\"div\", _hoisted_6, _toDisplayString(node.), 1 /* TEXT */)\n                            ], 14 /* CLASS, STYLE, PROPS */, _hoisted_5));\n                        }), 128 /* KEYED_FRAGMENT */)),\n                        _createCommentVNode(\"  () \"),\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(derivedTasks.value, (task, index) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: task.ID,\n                                class: \"star-node derived-star\",\n                                style: _normalizeStyle(getDerivedStarPosition(task, index)),\n                                onClick: ($event) => (selectNode(task, 'derived', $event))\n                            }, [...(_cache[5] || (_cache[5] = [\n                                    _createElementVNode(\"div\", { class: \"star-core\" }, null, -1 /* CACHED */)\n                                ]))], 12 /* STYLE, PROPS */, _hoisted_7));\n                        }), 128 /* KEYED_FRAGMENT */)),\n                        _createCommentVNode(\"  \"),\n                        (selectedNode.value)\n                            ? (_openBlock(), _createElementBlock(\"div\", {\n                                key: 1,\n                                class: \"node-detail-modal\",\n                                style: _normalizeStyle(detailModalStyle)\n                            }, [\n                                _createElementVNode(\"h4\", {\n                                    class: \"detail-title\",\n                                    onMousedown: startDrag\n                                }, _toDisplayString(selectedNode.value.data.), 33 /* TEXT, NEED_HYDRATION */),\n                                _createElementVNode(\"p\", _hoisted_8, _toDisplayString(selectedNode.value.data.), 1 /* TEXT */),\n                                _createElementVNode(\"div\", _hoisted_9, [\n                                    (selectedNode.value.data.)\n                                        ? (_openBlock(), _createElementBlock(\"p\", _hoisted_10, [\n                                            _cache[6] || (_cache[6] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                            _createTextVNode(\" \" + _toDisplayString(selectedNode.value.data.), 1 /* TEXT */)\n                                        ]))\n                                        : _createCommentVNode(\"v-if\", true),\n                                    (selectedNode.value.data.)\n                                        ? (_openBlock(), _createElementBlock(\"p\", _hoisted_11, [\n                                            _cache[7] || (_cache[7] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                            _createTextVNode(\" \" + _toDisplayString(selectedNode.value.data.), 1 /* TEXT */)\n                                        ]))\n                                        : _createCommentVNode(\"v-if\", true),\n                                    (selectedNode.value.data.ID)\n                                        ? (_openBlock(), _createElementBlock(\"p\", _hoisted_12, [\n                                            _cache[8] || (_cache[8] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                            _createTextVNode(\" \" + _toDisplayString(getTaskNameById(selectedNode.value.data.ID)), 1 /* TEXT */)\n                                        ]))\n                                        : _createCommentVNode(\"v-if\", true),\n                                    (selectedNode.value.type === 'ultimate' && selectedNode.value.data.)\n                                        ? (_openBlock(), _createElementBlock(\"p\", _hoisted_13, [\n                                            _cache[9] || (_cache[9] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                            _createTextVNode(\" \" + _toDisplayString(selectedNode.value.data..join(', ')), 1 /* TEXT */)\n                                        ]))\n                                        : _createCommentVNode(\"v-if\", true)\n                                ]),\n                                _createElementVNode(\"button\", {\n                                    class: \"close-button\",\n                                    onClick: _cache[1] || (_cache[1] = ($event) => (selectedNode.value = null))\n                                }, \"\")\n                            ], 4 /* STYLE */))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_14, [\n                        _createElementVNode(\"p\", null, _toDisplayString(_unref(currentAvatar) ? '' : ''), 1 /* TEXT */)\n                    ]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./AvatarTasksPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AvatarTasksPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./AvatarTasksPanel.vue?vue&type=style&index=0&id=78623224&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-78623224\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createVNode as _createVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"panel-wrapper character-panel-container\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"character-sheet\"\n};\nconst _hoisted_3 = { class: \"drawer-content\" };\nconst _hoisted_4 = { class: \"info-item\" };\nconst _hoisted_5 = { class: \"value\" };\nconst _hoisted_6 = { class: \"info-item\" };\nconst _hoisted_7 = { class: \"value\" };\nconst _hoisted_8 = { class: \"world-attributes-section\" };\nconst _hoisted_9 = {\n    key: 0,\n    class: \"attributes-list\"\n};\nconst _hoisted_10 = { class: \"label\" };\nconst _hoisted_11 = { class: \"value\" };\nconst _hoisted_12 = {\n    key: 1,\n    class: \"empty-state\"\n};\nconst _hoisted_13 = {\n    key: 1,\n    class: \"loading-state\"\n};\nimport { computed, ref } from 'vue';\nimport { playerWorldAttributes } from '../../store/getters';\nimport { store } from '../../store';\nimport DestinyPlate from './DestinyPlate.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'CharacterPanel',\n    setup(__props) {\n        const getDisplayValue = (value, defaultValue = 0) => {\n            if (value === null || value === undefined)\n                return defaultValue;\n            return value;\n        };\n        const formatAttributeValue = (attrValue) => {\n            if (attrValue === null || attrValue === undefined)\n                return '-';\n            if (typeof attrValue === 'object' && !Array.isArray(attrValue)) {\n                //  ''  key\n                const { , ...rest } = attrValue;\n                const keys = Object.keys(rest).filter(k => k !== '$meta' && k !== 'description');\n                if (keys.length === 0)\n                    return ''; // \n                // Case 1: Progress bar\n                if (rest.current !== undefined && rest.max !== undefined) {\n                    return `${rest.current} / ${rest.max}`;\n                }\n                if (rest. !== undefined && rest. !== undefined) {\n                    return `${rest.} / ${rest.}`;\n                }\n                // Case 2: Simple value wrapper\n                if (rest.value !== undefined && keys.length === 1) {\n                    return String(getDisplayValue(rest.value));\n                }\n                // Case 3: List of named items\n                if (keys.length > 0 && keys.every(k => typeof rest[k] === 'object' && rest[k]?.)) {\n                    return keys.map(k => rest[k].).join('');\n                }\n                // Case 4: Composite structure\n                if (keys.length > 0) {\n                    return keys.map(key => `${key}: ${getDisplayValue(rest[key])}`).join(' | ');\n                }\n                return '...';\n            }\n            return String(getDisplayValue(attrValue));\n        };\n        const character = computed(() => store.character);\n        const soulOrigin = computed(() => getDisplayValue(character.value?., 0));\n        const daoHeart = computed(() => getDisplayValue(character.value?., 0));\n        const worldAttributes = playerWorldAttributes;\n        const isDrawerOpen = ref(false);\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (character.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _createCommentVNode(\"  \"),\n                        _createVNode(DestinyPlate, { character: character.value }, null, 8 /* PROPS */, [\"character\"]),\n                        _createCommentVNode(\"  \"),\n                        _createElementVNode(\"div\", {\n                            class: _normalizeClass([\"additional-info-drawer\", { 'is-open': isDrawerOpen.value }])\n                        }, [\n                            _createElementVNode(\"button\", {\n                                class: \"drawer-toggle\",\n                                onClick: _cache[0] || (_cache[0] = ($event) => (isDrawerOpen.value = !isDrawerOpen.value))\n                            }, [...(_cache[1] || (_cache[1] = [\n                                    _createElementVNode(\"i\", { class: \"drawer-icon\" }, null, -1 /* CACHED */),\n                                    _createElementVNode(\"span\", null, \"\", -1 /* CACHED */)\n                                ]))]),\n                            _createElementVNode(\"div\", _hoisted_3, [\n                                _createElementVNode(\"div\", _hoisted_4, [\n                                    _cache[2] || (_cache[2] = _createElementVNode(\"span\", { class: \"label\" }, \":\", -1 /* CACHED */)),\n                                    _createElementVNode(\"span\", _hoisted_5, _toDisplayString(getDisplayValue(character.value., '')), 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_6, [\n                                    _cache[3] || (_cache[3] = _createElementVNode(\"span\", { class: \"label\" }, \":\", -1 /* CACHED */)),\n                                    _createElementVNode(\"span\", _hoisted_7, _toDisplayString(daoHeart.value), 1 /* TEXT */)\n                                ]),\n                                _createCommentVNode(\"  \"),\n                                _createElementVNode(\"div\", _hoisted_8, [\n                                    _cache[4] || (_cache[4] = _createElementVNode(\"h5\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                                    (_unref(worldAttributes).length > 0)\n                                        ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_9, [\n                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(worldAttributes), (attr) => {\n                                                return (_openBlock(), _createElementBlock(\"li\", {\n                                                    key: attr.key,\n                                                    class: \"attribute-item\"\n                                                }, [\n                                                    _createElementVNode(\"span\", _hoisted_10, _toDisplayString(attr.key), 1 /* TEXT */),\n                                                    _createElementVNode(\"span\", _hoisted_11, _toDisplayString(formatAttributeValue(attr.value)), 1 /* TEXT */)\n                                                ]));\n                                            }), 128 /* KEYED_FRAGMENT */))\n                                        ]))\n                                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_12, \"\"))\n                                ])\n                            ])\n                        ], 2 /* CLASS */)\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_13, \"...\"))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./CharacterPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CharacterPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./CharacterPanel.vue?vue&type=style&index=0&id=02c12b4d&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-02c12b4d\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n    key: 0,\n    class: \"imprint-detail-modal-content\"\n};\nconst _hoisted_2 = { class: \"imprint-header\" };\nconst _hoisted_3 = { class: \"imprint-name\" };\nconst _hoisted_4 = { class: \"imprint-tags\" };\nconst _hoisted_5 = { class: \"tag type-tag\" };\nconst _hoisted_6 = [\"data-level\"];\nconst _hoisted_7 = { class: \"imprint-body\" };\nconst _hoisted_8 = { class: \"imprint-main-display\" };\nconst _hoisted_9 = [\"data-level\"];\nconst _hoisted_10 = { class: \"imprint-description\" };\nconst _hoisted_11 = { class: \"imprint-effects\" };\nconst _hoisted_12 = {\n    key: 0,\n    class: \"effects-list\"\n};\nconst _hoisted_13 = { class: \"effect-type\" };\nconst _hoisted_14 = { class: \"effect-value\" };\nconst _hoisted_15 = { class: \"effect-type\" };\nconst _hoisted_16 = { class: \"effect-value\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ImprintDetailModal',\n    props: {\n        imprint: {}\n    },\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (__props.imprint)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                    _createElementVNode(\"div\", _hoisted_2, [\n                        _createElementVNode(\"h2\", _hoisted_3, _toDisplayString(__props.imprint.), 1 /* TEXT */),\n                        _createElementVNode(\"div\", _hoisted_4, [\n                            _createElementVNode(\"span\", _hoisted_5, _toDisplayString(__props.imprint.), 1 /* TEXT */),\n                            _createElementVNode(\"span\", {\n                                class: \"tag level-tag\",\n                                \"data-level\": __props.imprint.\n                            }, \" \" + _toDisplayString(__props.imprint.), 9 /* TEXT, PROPS */, _hoisted_6)\n                        ])\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_7, [\n                        _createElementVNode(\"div\", _hoisted_8, [\n                            _createElementVNode(\"div\", {\n                                class: \"imprint-mandala\",\n                                \"data-level\": __props.imprint.\n                            }, [\n                                _createCommentVNode(\" Central visual element, can be an icon or complex SVG \"),\n                                _cache[0] || (_cache[0] = _createElementVNode(\"span\", { class: \"mandala-icon\" }, \"\", -1 /* CACHED */))\n                            ], 8 /* PROPS */, _hoisted_9),\n                            _createElementVNode(\"p\", _hoisted_10, _toDisplayString(__props.imprint.), 1 /* TEXT */)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_11, [\n                            _cache[3] || (_cache[3] = _createElementVNode(\"h3\", { class: \"effects-title\" }, \"\", -1 /* CACHED */)),\n                            (__props.imprint.effects)\n                                ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_12, [\n                                    (__props.imprint.effects.attributes_bonus)\n                                        ? (_openBlock(true), _createElementBlock(_Fragment, { key: 0 }, _renderList(__props.imprint.effects.attributes_bonus, (value, key) => {\n                                            return (_openBlock(), _createElementBlock(\"li\", {\n                                                key: key,\n                                                class: \"effect-item\"\n                                            }, [\n                                                _createElementVNode(\"strong\", _hoisted_13, _toDisplayString(key) + \":\", 1 /* TEXT */),\n                                                _createElementVNode(\"span\", _hoisted_14, \"+\" + _toDisplayString(value), 1 /* TEXT */),\n                                                _cache[1] || (_cache[1] = _createElementVNode(\"p\", { class: \"effect-description\" }, \"\", -1 /* CACHED */))\n                                            ]));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                        : _createCommentVNode(\"v-if\", true),\n                                    (__props.imprint.effects.percentage_bonus)\n                                        ? (_openBlock(true), _createElementBlock(_Fragment, { key: 1 }, _renderList(__props.imprint.effects.percentage_bonus, (value, key) => {\n                                            return (_openBlock(), _createElementBlock(\"li\", {\n                                                key: key,\n                                                class: \"effect-item\"\n                                            }, [\n                                                _createElementVNode(\"strong\", _hoisted_15, _toDisplayString(key) + \":\", 1 /* TEXT */),\n                                                _createElementVNode(\"span\", _hoisted_16, _toDisplayString(value), 1 /* TEXT */),\n                                                _cache[2] || (_cache[2] = _createElementVNode(\"p\", { class: \"effect-description\" }, \"\", -1 /* CACHED */))\n                                            ]));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                        : _createCommentVNode(\"v-if\", true)\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ])\n                    ])\n                ]))\n                : _createCommentVNode(\"v-if\", true);\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ImprintDetailModal.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ImprintDetailModal.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"panel-wrapper imprints-panel-container\" };\nconst _hoisted_2 = { class: \"imprints-grid\" };\nconst _hoisted_3 = [\"data-level\", \"onClick\"];\nconst _hoisted_4 = { class: \"imprint-name\" };\nconst _hoisted_5 = { class: \"imprint-level\" };\nconst _hoisted_6 = {\n    key: 1,\n    class: \"empty-text\"\n};\nimport { computed } from 'vue';\nimport { reincarnationImprints } from '../../store/getters';\nimport { detailModalService } from '../../services/DetailModalService';\nimport ImprintDetailModal from '../modals/ImprintDetailModal.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ImprintsPanel',\n    setup(__props) {\n        const imprints = computed(() => reincarnationImprints.value);\n        const openImprintDetail = (imprint) => {\n            detailModalService.show(imprint., ImprintDetailModal, { imprint });\n        };\n        // Ensure there are always 9 items for the layout, and filter out placeholders\n        const paddedImprints = computed(() => {\n            const validImprints = imprints.value || [];\n            const result = [...validImprints];\n            while (result.length < 9) {\n                result.push(null);\n            }\n            return result.slice(0, 9);\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(paddedImprints.value, (imprint, index) => {\n                        return (_openBlock(), _createElementBlock(\"div\", {\n                            key: index,\n                            class: _normalizeClass([\"imprint-slot\", { empty: !imprint, clickable: !!imprint }]),\n                            \"data-level\": imprint?.,\n                            onClick: ($event) => (imprint && openImprintDetail(imprint))\n                        }, [\n                            imprint\n                                ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                                    _createElementVNode(\"div\", _hoisted_4, _toDisplayString(imprint.), 1 /* TEXT */),\n                                    _createElementVNode(\"div\", _hoisted_5, \": \" + _toDisplayString(imprint.), 1 /* TEXT */)\n                                ], 64 /* STABLE_FRAGMENT */))\n                                : (_openBlock(), _createElementBlock(\"div\", _hoisted_6, \"\"))\n                        ], 10 /* CLASS, PROPS */, _hoisted_3));\n                    }), 128 /* KEYED_FRAGMENT */))\n                ]),\n                _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"detail-placeholder\" }, [\n                    _createElementVNode(\"p\", null, \"\")\n                ], -1 /* CACHED */))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ImprintsPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ImprintsPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ImprintsPanel.vue?vue&type=style&index=0&id=58aa44a0&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-58aa44a0\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeStyle as _normalizeStyle, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n    key: 0,\n    class: \"item-detail-panel\"\n};\nconst _hoisted_2 = { class: \"detail-name\" };\nconst _hoisted_3 = { class: \"detail-meta\" };\nconst _hoisted_4 = { class: \"meta-type\" };\nconst _hoisted_5 = { class: \"detail-desc\" };\nconst _hoisted_6 = {\n    key: 0,\n    class: \"detail-effects\"\n};\nconst _hoisted_7 = { key: 0 };\nconst _hoisted_8 = { key: 0 };\nconst _hoisted_9 = { key: 1 };\nconst _hoisted_10 = { key: 0 };\nconst _hoisted_11 = {\n    key: 1,\n    class: \"empty-detail\"\n};\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ItemDetailPanel',\n    props: {\n        item: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const tierColorMap = {\n            common: '#a0a0a0',\n            rare: '#3a8f9d',\n            epic: '#8a5db5',\n            legendary: '#d4af37',\n        };\n        const getTierStyle = (item, isText = false) => {\n            let tierKey = 'common';\n            if (item && item.) {\n                const tier = item.;\n                if (tier >= 9)\n                    tierKey = 'legendary';\n                else if (tier >= 6)\n                    tierKey = 'epic';\n                else if (tier >= 3)\n                    tierKey = 'rare';\n            }\n            if (isText) {\n                return { color: tierColorMap[tierKey] };\n            }\n            return {\n                '--tier-border-color': tierColorMap[tierKey],\n            };\n        };\n        return (_ctx, _cache) => {\n            return (__props.item)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                    _createElementVNode(\"h4\", _hoisted_2, _toDisplayString(__props.item.), 1 /* TEXT */),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _createElementVNode(\"span\", {\n                            class: \"meta-tier\",\n                            style: _normalizeStyle(getTierStyle(__props.item, true))\n                        }, \" \" + _toDisplayString(__props.item.), 5 /* TEXT, STYLE */),\n                        _createElementVNode(\"span\", _hoisted_4, _toDisplayString(__props.item.), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"p\", _hoisted_5, _toDisplayString(__props.item.), 1 /* TEXT */),\n                    (__props.item.effects)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [\n                            _cache[0] || (_cache[0] = _createElementVNode(\"h5\", null, \":\", -1 /* CACHED */)),\n                            (__props.item.effects.attributes_bonus && Object.keys(__props.item.effects.attributes_bonus).length > 1)\n                                ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_7, [\n                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.item.effects.attributes_bonus, (value, key) => {\n                                        return (_openBlock(), _createElementBlock(\"li\", { key: key }, [\n                                            (key !== '$meta')\n                                                ? (_openBlock(), _createElementBlock(\"span\", _hoisted_8, _toDisplayString(key) + \": +\" + _toDisplayString(value), 1 /* TEXT */))\n                                                : _createCommentVNode(\"v-if\", true)\n                                        ]));\n                                    }), 128 /* KEYED_FRAGMENT */))\n                                ]))\n                                : _createCommentVNode(\"v-if\", true),\n                            (__props.item.effects.percentage_bonus && Object.keys(__props.item.effects.percentage_bonus).length > 1)\n                                ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_9, [\n                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.item.effects.percentage_bonus, (value, key) => {\n                                        return (_openBlock(), _createElementBlock(\"li\", { key: key }, [\n                                            (key !== '$meta')\n                                                ? (_openBlock(), _createElementBlock(\"span\", _hoisted_10, _toDisplayString(key) + \": \" + _toDisplayString(value), 1 /* TEXT */))\n                                                : _createCommentVNode(\"v-if\", true)\n                                        ]));\n                                    }), 128 /* KEYED_FRAGMENT */))\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ]))\n                        : _createCommentVNode(\"v-if\", true)\n                ]))\n                : (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [...(_cache[1] || (_cache[1] = [\n                        _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                    ]))]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ItemDetailPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ItemDetailPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ItemDetailPanel.vue?vue&type=style&index=0&id=3737655a&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3737655a\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createElementVNode as _createElementVNode, normalizeStyle as _normalizeStyle, createVNode as _createVNode } from \"vue\";\nconst _hoisted_1 = { class: \"panel-wrapper inventory-panel\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"inventory-layout\"\n};\nconst _hoisted_3 = { class: \"category-header\" };\nconst _hoisted_4 = [\"onClick\"];\nconst _hoisted_5 = { class: \"main-content\" };\nconst _hoisted_6 = { class: \"item-grid-container\" };\nconst _hoisted_7 = {\n    key: 0,\n    class: \"item-grid\"\n};\nconst _hoisted_8 = [\"onClick\"];\nconst _hoisted_9 = { class: \"item-name\" };\nconst _hoisted_10 = {\n    key: 0,\n    class: \"item-quantity\"\n};\nconst _hoisted_11 = {\n    key: 1,\n    class: \"empty-grid\"\n};\nconst _hoisted_12 = {\n    key: 1,\n    class: \"loading\"\n};\nimport { computed, ref } from 'vue';\nimport { playerCharacter, playerInventory } from '../../store/getters';\nimport ItemDetailPanel from './inventory/ItemDetailPanel.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'InventoryPanel',\n    setup(__props) {\n        const selectedItem = ref(null);\n        const selectedCategory = ref(null);\n        const groupedItems = computed(() => {\n            const items = playerInventory.value;\n            const groups = {\n                : [],\n                : [],\n                : [],\n                : [],\n            };\n            if (!items)\n                return groups;\n            items.forEach(item => {\n                const category = item.;\n                if (groups[category]) {\n                    groups[category].push(item);\n                }\n            });\n            // Set initial category if not set\n            if (!selectedCategory.value) {\n                const firstCategoryWithItems = Object.keys(groups).find(k => groups[k].length > 0);\n                if (firstCategoryWithItems) {\n                    selectedCategory.value = firstCategoryWithItems;\n                }\n            }\n            return groups;\n        });\n        const itemsInSelectedCategory = computed(() => {\n            if (!selectedCategory.value || !groupedItems.value[selectedCategory.value]) {\n                return [];\n            }\n            return groupedItems.value[selectedCategory.value];\n        });\n        const selectItem = (item) => {\n            selectedItem.value = item;\n        };\n        const tierColorMap = {\n            common: '#a0a0a0',\n            rare: '#3a8f9d',\n            epic: '#8a5db5',\n            legendary: '#d4af37',\n        };\n        const getTierStyle = (item, isText = false) => {\n            let tierKey = 'common';\n            if (item && item.) {\n                const tier = item.;\n                if (tier >= 9)\n                    tierKey = 'legendary';\n                else if (tier >= 6)\n                    tierKey = 'epic';\n                else if (tier >= 3)\n                    tierKey = 'rare';\n            }\n            if (isText) {\n                return { color: tierColorMap[tierKey] };\n            }\n            return {\n                '--tier-border-color': tierColorMap[tierKey],\n            };\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (_unref(playerCharacter))\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _createCommentVNode(\" Top: Category List \"),\n                        _createElementVNode(\"div\", _hoisted_3, [\n                            _createElementVNode(\"ul\", null, [\n                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(Object.keys(groupedItems.value), (category) => {\n                                    return (_openBlock(), _createElementBlock(\"li\", {\n                                        key: category,\n                                        class: _normalizeClass({ active: selectedCategory.value === category }),\n                                        onClick: ($event) => (selectedCategory.value = category)\n                                    }, _toDisplayString(category) + \" (\" + _toDisplayString(groupedItems.value[category].length) + \") \", 11 /* TEXT, CLASS, PROPS */, _hoisted_4));\n                                }), 128 /* KEYED_FRAGMENT */))\n                            ])\n                        ]),\n                        _createCommentVNode(\" Bottom: Item Grid and Detail View \"),\n                        _createElementVNode(\"div\", _hoisted_5, [\n                            _createElementVNode(\"div\", _hoisted_6, [\n                                (itemsInSelectedCategory.value.length > 0)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [\n                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(itemsInSelectedCategory.value, (item) => {\n                                            return (_openBlock(), _createElementBlock(\"div\", {\n                                                key: item.ID,\n                                                class: _normalizeClass([\"item-cell\", { selected: selectedItem.value?.ID === item.ID }]),\n                                                style: _normalizeStyle(getTierStyle(item)),\n                                                onClick: ($event) => (selectItem(item))\n                                            }, [\n                                                _createElementVNode(\"div\", _hoisted_9, _toDisplayString(item.), 1 /* TEXT */),\n                                                (item.)\n                                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, \"x\" + _toDisplayString(item.), 1 /* TEXT */))\n                                                    : _createCommentVNode(\"v-if\", true)\n                                            ], 14 /* CLASS, STYLE, PROPS */, _hoisted_8));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                    ]))\n                                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [...(_cache[0] || (_cache[0] = [\n                                            _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                                        ]))]))\n                            ]),\n                            _createVNode(ItemDetailPanel, { item: selectedItem.value }, null, 8 /* PROPS */, [\"item\"])\n                        ])\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_12, \"...\"))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./InventoryPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./InventoryPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./InventoryPanel.vue?vue&type=style&index=0&id=12036030&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-12036030\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createVNode as _createVNode } from \"vue\";\nconst _hoisted_1 = { class: \"npc-directory-panel\" };\nconst _hoisted_2 = { class: \"npc-list-column\" };\nconst _hoisted_3 = {\n    key: 0,\n    class: \"npc-list\"\n};\nconst _hoisted_4 = [\"onClick\"];\nconst _hoisted_5 = { class: \"npc-info\" };\nconst _hoisted_6 = { class: \"npc-name\" };\nconst _hoisted_7 = { class: \"npc-location\" };\nconst _hoisted_8 = {\n    key: 1,\n    class: \"placeholder\"\n};\nconst _hoisted_9 = { class: \"npc-detail-column\" };\nconst _hoisted_10 = { key: 0 };\nconst _hoisted_11 = {\n    key: 1,\n    class: \"placeholder\"\n};\nimport { computed, ref, watch } from 'vue';\nimport { npcService } from '../../services/NpcService';\nimport NpcDetailDisplay from '../common/NpcDetailDisplay.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcDirectoryPanel',\n    setup(__props) {\n        const selectedNpc = ref(null);\n        const selectedNpcId = ref(null);\n        const npcSearchTerm = ref('');\n        const filteredNpcs = computed(() => {\n            let npcs = [...npcService.allNpcs.value];\n            if (!npcSearchTerm.value) {\n                return npcs;\n            }\n            return npcs.filter(n => n. && n..includes(npcSearchTerm.value));\n        });\n        function selectNpc(npc) {\n            selectedNpc.value = npc;\n            selectedNpcId.value = npcService.getNpcId(npc);\n        }\n        watch(filteredNpcs, () => {\n            if (selectedNpc.value && !filteredNpcs.value.includes(selectedNpc.value)) {\n                selectedNpc.value = null;\n                selectedNpcId.value = null;\n            }\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createCommentVNode(\" NPC List \"),\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[1] || (_cache[1] = _createElementVNode(\"h4\", null, \"NPC\", -1 /* CACHED */)),\n                    _withDirectives(_createElementVNode(\"input\", {\n                        type: \"text\",\n                        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((npcSearchTerm).value = $event)),\n                        placeholder: \"NPC...\",\n                        class: \"search-input\"\n                    }, null, 512 /* NEED_PATCH */), [\n                        [_vModelText, npcSearchTerm.value]\n                    ]),\n                    (filteredNpcs.value.length > 0)\n                        ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_3, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(filteredNpcs.value, (npc) => {\n                                return (_openBlock(), _createElementBlock(\"li\", {\n                                    key: npc.,\n                                    class: _normalizeClass({ active: selectedNpc.value === npc }),\n                                    onClick: ($event) => (selectNpc(npc))\n                                }, [\n                                    _createElementVNode(\"div\", _hoisted_5, [\n                                        _createElementVNode(\"span\", _hoisted_6, _toDisplayString(npc.), 1 /* TEXT */),\n                                        _createElementVNode(\"span\", _hoisted_7, _toDisplayString(npc.), 1 /* TEXT */)\n                                    ])\n                                ], 10 /* CLASS, PROPS */, _hoisted_4));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_8, \"NPC\"))\n                ]),\n                _createCommentVNode(\" NPC Details \"),\n                _createElementVNode(\"div\", _hoisted_9, [\n                    _cache[2] || (_cache[2] = _createElementVNode(\"h4\", null, \"NPC\", -1 /* CACHED */)),\n                    (selectedNpc.value)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [\n                            _createVNode(NpcDetailDisplay, {\n                                npc: selectedNpc.value,\n                                \"npc-id\": selectedNpcId.value\n                            }, null, 8 /* PROPS */, [\"npc\", \"npc-id\"])\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_11, \"NPC\"))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcDirectoryPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcDirectoryPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcDirectoryPanel.vue?vue&type=style&index=0&id=484925c9&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-484925c9\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = { class: \"log-panel-container\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"timeline\"\n};\nconst _hoisted_3 = [\"onClick\"];\nconst _hoisted_4 = { class: \"log-header\" };\nconst _hoisted_5 = { class: \"log-title\" };\nconst _hoisted_6 = { class: \"log-date\" };\nconst _hoisted_7 = { class: \"log-meta\" };\nconst _hoisted_8 = { class: \"log-description\" };\nconst _hoisted_9 = {\n    key: 0,\n    class: \"log-details\"\n};\nconst _hoisted_10 = { class: \"detail-section\" };\nconst _hoisted_11 = { class: \"detail-section\" };\nconst _hoisted_12 = { class: \"detail-section\" };\nconst _hoisted_13 = { class: \"detail-section automation-system\" };\nconst _hoisted_14 = {\n    key: 0,\n    class: \"log-tags\"\n};\nconst _hoisted_15 = {\n    key: 1,\n    class: \"empty-state\"\n};\nimport { computed, ref } from 'vue';\nimport { store } from '../../store';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'LogPanel',\n    setup(__props) {\n        const logs = computed(() => [...store.worldLog].sort((a, b) => b. - a.));\n        const expandedLog = ref(null);\n        function toggleDetails(logId) {\n            if (expandedLog.value === logId) {\n                expandedLog.value = null;\n            }\n            else {\n                expandedLog.value = logId;\n            }\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (logs.value.length > 0)\n                    ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_2, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(logs.value, (log) => {\n                            return (_openBlock(), _createElementBlock(\"li\", {\n                                key: log.,\n                                class: \"timeline-item\"\n                            }, [\n                                _cache[6] || (_cache[6] = _createElementVNode(\"div\", { class: \"timeline-marker\" }, null, -1 /* CACHED */)),\n                                _createElementVNode(\"div\", {\n                                    class: \"timeline-content\",\n                                    onClick: ($event) => (toggleDetails(log.))\n                                }, [\n                                    _createElementVNode(\"div\", _hoisted_4, [\n                                        _createElementVNode(\"span\", _hoisted_5, _toDisplayString(log.), 1 /* TEXT */),\n                                        _createElementVNode(\"span\", _hoisted_6, _toDisplayString(log.), 1 /* TEXT */)\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_7, [\n                                        _createElementVNode(\"span\", null, [\n                                            _cache[0] || (_cache[0] = _createElementVNode(\"i\", { class: \"fas fa-map-marker-alt icon\" }, null, -1 /* CACHED */)),\n                                            _createTextVNode(\" \" + _toDisplayString(log.), 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"span\", null, [\n                                            _cache[1] || (_cache[1] = _createElementVNode(\"i\", { class: \"fas fa-users icon\" }, null, -1 /* CACHED */)),\n                                            _createTextVNode(\" \" + _toDisplayString(log.), 1 /* TEXT */)\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"p\", _hoisted_8, _toDisplayString(log.), 1 /* TEXT */),\n                                    (expandedLog.value === log.)\n                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [\n                                            _createElementVNode(\"div\", _hoisted_10, [\n                                                _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                _createElementVNode(\"p\", null, _toDisplayString(log.), 1 /* TEXT */)\n                                            ]),\n                                            _createElementVNode(\"div\", _hoisted_11, [\n                                                _cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                _createElementVNode(\"p\", null, _toDisplayString(log.), 1 /* TEXT */)\n                                            ]),\n                                            _createElementVNode(\"div\", _hoisted_12, [\n                                                _cache[4] || (_cache[4] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                _createElementVNode(\"p\", null, _toDisplayString(log.), 1 /* TEXT */)\n                                            ]),\n                                            _createElementVNode(\"div\", _hoisted_13, [\n                                                _cache[5] || (_cache[5] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                _createElementVNode(\"pre\", null, _toDisplayString(log.), 1 /* TEXT */)\n                                            ]),\n                                            (log. && log..length > 0)\n                                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_14, [\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(log., (tag) => {\n                                                        return (_openBlock(), _createElementBlock(\"span\", {\n                                                            key: tag,\n                                                            class: \"tag\"\n                                                        }, _toDisplayString(tag), 1 /* TEXT */));\n                                                    }), 128 /* KEYED_FRAGMENT */))\n                                                ]))\n                                                : _createCommentVNode(\"v-if\", true)\n                                        ]))\n                                        : _createCommentVNode(\"v-if\", true)\n                                ], 8 /* PROPS */, _hoisted_3)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_15, [...(_cache[7] || (_cache[7] = [\n                            _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                        ]))]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./LogPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./LogPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./LogPanel.vue?vue&type=style&index=0&id=6a11ea22&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-6a11ea22\"]])\n\nexport default __exports__","import { reactive } from 'vue';\nimport { lorebookService } from './LorebookService';\n\nexport interface Ripple {\n  id: number;\n  title: string;\n  rawContent: string;\n  [key: string]: any;\n}\n\n//  actions.ts \nfunction parseBlock(block: string): { [key: string]: string } {\n  const data: { [key: string]: string } = {};\n  const lines = block.trim().split('\\n');\n  let currentKey = '';\n  for (const line of lines) {\n    const separatorIndex = line.indexOf('|');\n    if (separatorIndex !== -1) {\n      const key = line.substring(0, separatorIndex).trim();\n      const value = line.substring(separatorIndex + 1).trim();\n      data[key] = value;\n      currentKey = key;\n    } else if (currentKey && line.trim()) {\n      data[currentKey] += '\\n' + line;\n    }\n  }\n  for (const key in data) {\n    data[key] = data[key].trim();\n  }\n  return data;\n}\n\nclass RipplesService {\n  public ripples = reactive<Ripple[]>([]);\n\n  async initialize() {\n    await this.loadRipples();\n  }\n\n  async loadRipples() {\n    try {\n      const rippleContent = await lorebookService.readFromLorebook('');\n      if (!rippleContent || !rippleContent.trim()) {\n        this.ripples.splice(0, this.ripples.length); // \n        return;\n      }\n\n      const rippleBlocks = rippleContent.split('\\n\\n---\\n\\n');\n      const parsedRipples: Ripple[] = [];\n\n      for (const blockContent of rippleBlocks) {\n        if (!blockContent.trim()) continue;\n        const blockData = parseBlock(blockContent);\n        const rippleId = parseInt(blockData['x'], 10);\n\n        if (!isNaN(rippleId)) {\n          parsedRipples.push({\n            id: rippleId,\n            title: ` ${rippleId} `,\n            rawContent: blockContent,\n            ...blockData,\n          });\n        }\n      }\n\n      // \n      this.ripples.splice(0, this.ripples.length, ...parsedRipples.sort((a, b) => a.id - b.id));\n      console.log(`[RipplesService] Loaded ${this.ripples.length} ripples.`);\n    } catch (error) {\n      console.error('[RipplesService] Error loading ripples:', error);\n      this.ripples.splice(0, this.ripples.length); // \n    }\n  }\n\n  getRippleById(id: number): Ripple | undefined {\n    return this.ripples.find(r => r.id === id);\n  }\n}\n\nexport const ripplesService = new RipplesService();\n","import { defineComponent as _defineComponent } from 'vue';\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode } from \"vue\";\nconst _hoisted_1 = { class: \"ripples-panel\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"ripples-list\"\n};\nconst _hoisted_3 = {\n    key: 0,\n    class: \"empty-state\"\n};\nconst _hoisted_4 = { key: 1 };\nconst _hoisted_5 = [\"onClick\"];\nconst _hoisted_6 = { class: \"ripple-title\" };\nconst _hoisted_7 = { class: \"ripple-summary\" };\nconst _hoisted_8 = {\n    key: 1,\n    class: \"ripple-detail\"\n};\nconst _hoisted_9 = { class: \"detail-content\" };\nconst _hoisted_10 = { class: \"detail-key\" };\nconst _hoisted_11 = { class: \"detail-value\" };\nimport { ref, computed, onMounted } from 'vue';\nimport { ripplesService } from '../../services/RipplesService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'RipplesPanel',\n    setup(__props) {\n        const ripples = computed(() => ripplesService.ripples);\n        const selectedRipple = ref(null);\n        const selectRipple = (ripple) => {\n            selectedRipple.value = ripple;\n        };\n        onMounted(() => {\n            ripplesService.loadRipples();\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (!selectedRipple.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        (ripples.value.length === 0)\n                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, \"\"))\n                            : (_openBlock(), _createElementBlock(\"ul\", _hoisted_4, [\n                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(ripples.value, (ripple) => {\n                                    return (_openBlock(), _createElementBlock(\"li\", {\n                                        key: ripple.id,\n                                        onClick: ($event) => (selectRipple(ripple))\n                                    }, [\n                                        _createElementVNode(\"span\", _hoisted_6, _toDisplayString(ripple.title), 1 /* TEXT */),\n                                        _createElementVNode(\"span\", _hoisted_7, _toDisplayString(ripple['']?.substring(0, 50)) + \"...\", 1 /* TEXT */)\n                                    ], 8 /* PROPS */, _hoisted_5));\n                                }), 128 /* KEYED_FRAGMENT */))\n                            ]))\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [\n                        _createElementVNode(\"button\", {\n                            onClick: _cache[0] || (_cache[0] = ($event) => (selectedRipple.value = null)),\n                            class: \"back-button\"\n                        }, \"< \"),\n                        _createElementVNode(\"div\", _hoisted_9, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(selectedRipple.value, (value, key) => {\n                                return (_openBlock(), _createElementBlock(\"div\", {\n                                    key: key,\n                                    class: \"detail-item\"\n                                }, [\n                                    _createElementVNode(\"strong\", _hoisted_10, _toDisplayString(key) + \":\", 1 /* TEXT */),\n                                    _createElementVNode(\"pre\", _hoisted_11, _toDisplayString(value), 1 /* TEXT */)\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ])\n                    ]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./RipplesPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./RipplesPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./RipplesPanel.vue?vue&type=style&index=0&id=9bb6a416&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-9bb6a416\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = { class: \"avatar-selection\" };\nconst _hoisted_2 = { key: 0 };\nconst _hoisted_3 = [\"onClick\"];\nimport { computed } from 'vue';\nimport { actions, store } from '../../../store';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'AvatarSelection',\n    setup(__props) {\n        const avatars = computed(() => store.reincarnationAvatarOptions);\n        const selectAvatar = (avatar) => {\n            //  action\n            actions.selectAvatarAndStart(avatar.);\n            // \n            // \n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (avatars.value.length === 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, \"AI...\"))\n                    : (_openBlock(true), _createElementBlock(_Fragment, { key: 1 }, _renderList(avatars.value, (avatar, index) => {\n                        return (_openBlock(), _createElementBlock(\"div\", {\n                            key: index,\n                            class: \"avatar-card\",\n                            onClick: ($event) => (selectAvatar(avatar))\n                        }, [\n                            _createElementVNode(\"h4\", null, _toDisplayString(avatar.), 1 /* TEXT */),\n                            _createElementVNode(\"p\", null, [\n                                _cache[0] || (_cache[0] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                _createTextVNode(\" \" + _toDisplayString(avatar.), 1 /* TEXT */)\n                            ]),\n                            _createElementVNode(\"p\", null, [\n                                _cache[1] || (_cache[1] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                _createTextVNode(\" \" + _toDisplayString(avatar.), 1 /* TEXT */)\n                            ])\n                        ], 8 /* PROPS */, _hoisted_3));\n                    }), 128 /* KEYED_FRAGMENT */))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./AvatarSelection.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AvatarSelection.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./AvatarSelection.vue?vue&type=style&index=0&id=26829202&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-26829202\"]])\n\nexport default __exports__","import { reactive } from 'vue';\n\ninterface ConfirmationState {\n  isVisible: boolean;\n  title: string;\n  message: string;\n  onConfirm: (() => void) | null;\n  onCancel: (() => void) | null;\n  hideCancel: boolean;\n}\n\nconst state = reactive<ConfirmationState>({\n  isVisible: false,\n  title: '',\n  message: '',\n  onConfirm: null,\n  onCancel: null,\n  hideCancel: false,\n});\n\nexport const confirmationService = {\n  get state() {\n    return state;\n  },\n\n  show(title: string, message: string, onConfirm: () => void, hideCancel = false) {\n    return new Promise<boolean>(resolve => {\n      state.title = title;\n      state.message = message;\n      state.onConfirm = () => {\n        onConfirm();\n        resolve(true);\n      };\n      state.onCancel = () => {\n        this.hide();\n        resolve(false);\n      };\n      state.hideCancel = hideCancel;\n      state.isVisible = true;\n    });\n  },\n\n  hide() {\n    state.isVisible = false;\n    state.title = '';\n    state.message = '';\n    state.onConfirm = null;\n    state.onCancel = null;\n    state.hideCancel = false;\n  },\n\n  confirm() {\n    if (state.onConfirm) {\n      state.onConfirm(); // This will now also resolve the promise\n    }\n    // Hiding is handled within onConfirm/onCancel now\n  },\n  cancel() {\n    if (state.onCancel) {\n      state.onCancel();\n    }\n  },\n};\n","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"card-header\" };\nconst _hoisted_2 = { class: \"choice-type\" };\nconst _hoisted_3 = { class: \"card-body\" };\nconst _hoisted_4 = { class: \"description\" };\nconst _hoisted_5 = {\n    key: 0,\n    class: \"data-details\"\n};\nconst _hoisted_6 = { class: \"data-name\" };\nconst _hoisted_7 = { class: \"data-description\" };\nconst _hoisted_8 = { class: \"card-footer\" };\nconst _hoisted_9 = { class: \"cost\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'SettlementChoiceCard',\n    props: {\n        choice: {\n            type: Object,\n            required: true,\n        },\n        isSelected: {\n            type: Boolean,\n            default: false,\n        },\n    },\n    emits: ['select'],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emits = __emit;\n        const selectCard = () => {\n            emits('select', props.choice);\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n                class: _normalizeClass([\"settlement-choice-card\", { 'is-selected': __props.isSelected }]),\n                onClick: selectCard\n            }, [\n                _createElementVNode(\"div\", _hoisted_1, [\n                    _createElementVNode(\"span\", _hoisted_2, _toDisplayString(__props.choice.), 1 /* TEXT */)\n                ]),\n                _createElementVNode(\"div\", _hoisted_3, [\n                    _createElementVNode(\"p\", _hoisted_4, _toDisplayString(__props.choice.), 1 /* TEXT */),\n                    (__props.choice.)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n                            _createElementVNode(\"strong\", _hoisted_6, _toDisplayString(__props.choice..), 1 /* TEXT */),\n                            _createElementVNode(\"p\", _hoisted_7, _toDisplayString(__props.choice..), 1 /* TEXT */)\n                        ]))\n                        : _createCommentVNode(\"v-if\", true)\n                ]),\n                _createElementVNode(\"div\", _hoisted_8, [\n                    _createElementVNode(\"span\", _hoisted_9, \": \" + _toDisplayString(__props.choice.), 1 /* TEXT */)\n                ])\n            ], 2 /* CLASS */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./SettlementChoiceCard.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SettlementChoiceCard.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode } from \"vue\";\nconst _hoisted_1 = { class: \"settlement-view\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"choices-grid\"\n};\nconst _hoisted_3 = {\n    key: 1,\n    class: \"no-choices\"\n};\nconst _hoisted_4 = {\n    key: 2,\n    class: \"actions-footer\"\n};\nconst _hoisted_5 = [\"disabled\"];\nimport { get } from 'lodash';\nimport * as toastr from 'toastr';\nimport { computed, ref } from 'vue';\nimport { commandService } from '../../../services/CommandService';\nimport { confirmationService } from '../../../services/ConfirmationService';\nimport { store } from '../../../store';\nimport SettlementChoiceCard from './SettlementChoiceCard.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'SettlementView',\n    setup(__props) {\n        const selectedChoice = ref(null);\n        const choices = computed(() => {\n            const choicesObj = get(store.worldState, '...', {});\n            if (typeof choicesObj === 'object' && choicesObj !== null) {\n                return Object.values(choicesObj).filter((c) => c && c. && c. && !c..includes(''));\n            }\n            return [];\n        });\n        const confirmChoice = async () => {\n            if (!selectedChoice.value)\n                return;\n            const choice = selectedChoice.value;\n            // Robustly find the main character by looking for the '' property\n            const characters = get(store.worldState, '', {});\n            const mainCharacter = Object.values(characters).find((char) => char && char.hasOwnProperty(''));\n            if (!mainCharacter) {\n                toastr.error('');\n                console.error('Could not find the main character in the world state.');\n                return;\n            }\n            const soulEssence = get(mainCharacter, '', 0);\n            if (soulEssence < choice.) {\n                await confirmationService.show('', ` ${choice.}  ${soulEssence}`, () => { }, true);\n                return;\n            }\n            const confirmed = await confirmationService.show('?', ` ${choice.} ${choice..}`, () => { });\n            if (confirmed) {\n                // This is a placeholder for the action to confirm the choice.\n                // You would typically call a store action here.\n                console.log('Confirmed choice:', choice);\n                const command = `< ${JSON.stringify(choice.)}>`;\n                commandService.addCommand(command);\n                confirmationService.hide();\n                toastr.success(`: ${choice..}`);\n            }\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (choices.value.length > 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(choices.value, (choice, index) => {\n                            return (_openBlock(), _createBlock(SettlementChoiceCard, {\n                                key: index,\n                                choice: choice,\n                                \"is-selected\": selectedChoice.value === choice,\n                                onSelect: _cache[0] || (_cache[0] = ($event) => (selectedChoice.value = $event))\n                            }, null, 8 /* PROPS */, [\"choice\", \"is-selected\"]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [...(_cache[1] || (_cache[1] = [\n                            _createElementVNode(\"p\", null, \"\", -1 /* CACHED */),\n                            _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                        ]))])),\n                (choices.value.length > 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [\n                        _createElementVNode(\"button\", {\n                            class: \"confirm-button\",\n                            onClick: confirmChoice,\n                            disabled: !selectedChoice.value\n                        }, \"\", 8 /* PROPS */, _hoisted_5)\n                    ]))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./SettlementView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SettlementView.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import * as THREE from 'three';\nimport { OrbitControls } from 'three/addons/controls/OrbitControls.js';\n\ninterface WorldData {\n  id: number;\n  name: string;\n  [key: string]: any;\n}\n\ninterface StarObject extends THREE.Group {\n  orbitSpeed?: number;\n  orbitRadius?: number;\n  orbitAngle?: number;\n}\n\nexport class StarMapService {\n  private scene: THREE.Scene;\n  private camera: THREE.PerspectiveCamera;\n  private renderer: THREE.WebGLRenderer;\n  private controls: OrbitControls;\n  private container: HTMLElement;\n  private stars: THREE.Group;\n  private skybox: THREE.Mesh | null = null;\n  private starObjects: StarObject[] = [];\n  private speedMultiplier: number = 0.2; // Add a speed multiplier\n\n  constructor(container: HTMLElement) {\n    console.log('[StarMapService] Constructor called.');\n    this.container = container;\n    this.scene = new THREE.Scene();\n    this.camera = new THREE.PerspectiveCamera(75, this.container.clientWidth / this.container.clientHeight, 0.1, 1000);\n    this.renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });\n    this.stars = new THREE.Group();\n\n    this.init();\n\n    this.controls = new OrbitControls(this.camera, this.renderer.domElement);\n    this.controls.enableDamping = true; // Smooths out the camera movement\n    this.controls.dampingFactor = 0.05;\n    this.controls.autoRotate = true;\n    this.controls.autoRotateSpeed = 0.1;\n    this.controls.minDistance = 5; // Allow zooming in closer\n    this.controls.maxDistance = 200; // Allow zooming out further\n    this.controls.enablePan = true; // Enable panning with right-click\n    this.controls.panSpeed = 0.5;\n\n    this.animate();\n  }\n\n  private init() {\n    console.log('[StarMapService] Init started.');\n    // Renderer\n    this.renderer.setSize(this.container.clientWidth, this.container.clientHeight);\n    this.renderer.setPixelRatio(window.devicePixelRatio);\n    this.container.appendChild(this.renderer.domElement);\n\n    // Camera\n    this.camera.position.z = 50;\n    this.scene.add(this.camera);\n\n    // Stars group\n    this.scene.add(this.stars);\n\n    // Handle window resize\n    window.addEventListener('resize', this.onWindowResize.bind(this));\n    this.createSkybox();\n  }\n\n  private createSkybox() {\n    const shaderMaterial = new THREE.ShaderMaterial({\n      vertexShader: `\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      `,\n      fragmentShader: `\n        varying vec2 vUv;\n        uniform float u_time;\n\n        float random(vec2 st) {\n          return fract(sin(dot(st.xy, vec2(12.9898, 78.233))) * 43758.5453123);\n        }\n\n        float noise(vec2 st) {\n          vec2 i = floor(st);\n          vec2 f = fract(st);\n          vec2 u = f * f * (3.0 - 2.0 * f);\n          return mix(mix(random(i + vec2(0.0, 0.0)), random(i + vec2(1.0, 0.0)), u.x),\n                     mix(random(i + vec2(0.0, 1.0)), random(i + vec2(1.0, 1.0)), u.x), u.y);\n        }\n\n        mat2 rotate(float a) {\n          float s = sin(a);\n          float c = cos(a);\n          return mat2(c, -s, s, c);\n        }\n\n        float fbm(vec2 st) {\n          float value = 0.0;\n          float amplitude = 0.5;\n          for (int i = 0; i < 6; i++) {\n            value += amplitude * noise(st);\n            st *= 2.0;\n            amplitude *= 0.5;\n          }\n          return value;\n        }\n\n        void main() {\n          vec2 st = vUv * 5.0;\n          st.x *= 1.5;\n          st *= rotate(u_time * 0.005);\n          \n          float f = fbm(st + u_time * 0.01);\n          f *= fbm(st * 0.5 + u_time * 0.005);\n\n          vec3 color1 = vec3(0.05, 0.0, 0.15);   // Deep Space Blue\n          vec3 color2 = vec3(0.2, 0.1, 0.5);    // Nebula Purple\n          vec3 color3 = vec3(0.8, 0.3, 0.3);    // Distant Star Red\n\n          float t = smoothstep(0.3, 0.6, f);\n          vec3 finalColor = mix(color1, color2, t);\n          finalColor = mix(finalColor, color3, smoothstep(0.5, 0.7, f));\n\n          gl_FragColor = vec4(finalColor, 1.0);\n        }\n      `,\n      uniforms: {\n        u_time: { value: 0.0 },\n      },\n      side: THREE.BackSide,\n    });\n\n    const skyboxGeometry = new THREE.SphereGeometry(500, 60, 40);\n    this.skybox = new THREE.Mesh(skyboxGeometry, shaderMaterial);\n    this.scene.add(this.skybox);\n  }\n\n  private getColorForEnergyLevel(level: number): THREE.Color {\n    if (level <= 5) return new THREE.Color(0x00ffff); // Cyan\n    if (level <= 10) return new THREE.Color(0x00ff00); // Green\n    if (level <= 15) return new THREE.Color(0xffff00); // Yellow\n    if (level <= 20) return new THREE.Color(0xffa500); // Orange\n    return new THREE.Color(0x800080); // Purple\n  }\n\n  public createStars(worlds: WorldData[], selectableIds: Set<number>) {\n    console.log(`[StarMapService] Updating stars with ${worlds.length} worlds.`);\n\n    const existingStarIds = new Set(this.starObjects.map(s => s.userData.world.id));\n    const newWorldIds = new Set(worlds.map(w => w.id));\n\n    // --- Exit ---\n    this.starObjects = this.starObjects.filter(star => {\n      if (!newWorldIds.has(star.userData.world.id)) {\n        // Animate out and remove\n        this.stars.remove(star);\n        return false;\n      }\n      return true;\n    });\n\n    // --- Enter ---\n    worlds.forEach(world => {\n      if (!existingStarIds.has(world.id)) {\n        this.createSingleStar(world, selectableIds);\n      }\n    });\n\n    // --- Update ---\n    this.starObjects.forEach(star => {\n      const world = star.userData.world;\n      const isSelectable = selectableIds.has(world.id);\n      const energyLevel = world.energyLevel || 1;\n      const baseColor = this.getColorForEnergyLevel(energyLevel);\n      const newColor = isSelectable ? baseColor : new THREE.Color(0x444444);\n\n      const core = star.children[0] as THREE.Mesh<THREE.SphereGeometry, THREE.MeshBasicMaterial>;\n      const halo = star.children[1] as THREE.Mesh<THREE.SphereGeometry, THREE.MeshBasicMaterial>;\n\n      if (core && halo) {\n        core.material.color.lerp(newColor, 0.1);\n        halo.material.color.lerp(newColor, 0.1);\n      }\n    });\n  }\n\n  private createSingleStar(world: WorldData, selectableIds: Set<number>) {\n    const coreGeometry = new THREE.SphereGeometry(0.3, 16, 16);\n    const haloGeometry = new THREE.SphereGeometry(0.5, 16, 16);\n\n    const phi = Math.acos(-1 + 2 * Math.random());\n    const theta = Math.sqrt(this.starObjects.length * Math.PI) * phi;\n    const radius = 30;\n\n    const x = radius * Math.cos(theta) * Math.sin(phi);\n    const y = radius * Math.sin(theta) * Math.sin(phi);\n    const z = radius * Math.cos(phi);\n\n    const isSelectable = selectableIds.has(world.id);\n    const energyLevel = world.energyLevel || 1;\n    const timeFlow = world.timeFlow || 1;\n\n    const baseColor = this.getColorForEnergyLevel(energyLevel);\n    const starColor = isSelectable ? baseColor : new THREE.Color(0x444444);\n\n    // Star Core\n    const coreMaterial = new THREE.MeshBasicMaterial({ color: starColor });\n    const core = new THREE.Mesh(coreGeometry, coreMaterial);\n\n    // Star Halo\n    const haloMaterial = new THREE.MeshBasicMaterial({\n      color: starColor,\n      transparent: true,\n      opacity: 0.4,\n      blending: THREE.AdditiveBlending,\n    });\n    const halo = new THREE.Mesh(haloGeometry, haloMaterial);\n\n    const haloScale = 1.5;\n    halo.scale.set(haloScale, haloScale, haloScale);\n\n    const starGroup: StarObject = new THREE.Group();\n    starGroup.add(core);\n    starGroup.add(halo);\n\n    starGroup.position.set(x, y, z);\n\n    // Store world data in the group for picking\n    starGroup.userData = { world }; // Store data on the group itself\n    core.userData = { world }; // Also on core for raycasting\n    halo.userData = { world };\n\n    // Store orbit data\n    starGroup.orbitSpeed = Math.log1p(timeFlow) * 0.015; // Directly tie speed to timeFlow\n    starGroup.orbitRadius = Math.sqrt(x * x + z * z);\n    starGroup.orbitAngle = Math.atan2(z, x);\n\n    this.stars.add(starGroup);\n    this.starObjects.push(starGroup);\n  }\n\n  private animate() {\n    requestAnimationFrame(this.animate.bind(this));\n\n    // Update shader time uniform\n    if (this.skybox && this.skybox.material instanceof THREE.ShaderMaterial) {\n      this.skybox.material.uniforms.u_time.value += 0.01;\n    }\n\n    // Update star orbits\n    this.starObjects.forEach(star => {\n      if (star.orbitSpeed && star.orbitRadius && star.orbitAngle !== undefined) {\n        star.orbitAngle += star.orbitSpeed * this.speedMultiplier;\n        star.position.x = star.orbitRadius * Math.cos(star.orbitAngle);\n        star.position.z = star.orbitRadius * Math.sin(star.orbitAngle);\n      }\n    });\n\n    this.controls.update();\n    this.renderer.render(this.scene, this.camera);\n  }\n\n  private onWindowResize() {\n    this.camera.aspect = this.container.clientWidth / this.container.clientHeight;\n    this.camera.updateProjectionMatrix();\n    this.renderer.setSize(this.container.clientWidth, this.container.clientHeight);\n  }\n\n  public destroy() {\n    window.removeEventListener('resize', this.onWindowResize.bind(this));\n    this.renderer.dispose();\n    if (this.container && this.renderer.domElement) {\n      this.container.removeChild(this.renderer.domElement);\n    }\n  }\n\n  // Placeholder for click detection\n  public pickStar(event: MouseEvent): WorldData | null {\n    const raycaster = new THREE.Raycaster();\n    const mouse = new THREE.Vector2();\n    const rect = this.renderer.domElement.getBoundingClientRect();\n\n    // Calculate mouse position in normalized device coordinates\n    mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;\n    mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;\n\n    raycaster.setFromCamera(mouse, this.camera);\n    const intersects = raycaster.intersectObjects(this.stars.children);\n\n    if (intersects.length > 0) {\n      return intersects[0].object.userData.world as WorldData;\n    }\n    return null;\n  }\n\n  public setSpeedMultiplier(multiplier: number) {\n    this.speedMultiplier = Math.max(0, multiplier); // Ensure multiplier is not negative\n  }\n\n  public getSpeedMultiplier(): number {\n    return this.speedMultiplier;\n  }\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { normalizeStyle as _normalizeStyle, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, renderList as _renderList, Fragment as _Fragment, normalizeClass as _normalizeClass, unref as _unref } from \"vue\";\nconst _hoisted_1 = { class: \"world-selection-container\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"loading-state\"\n};\nconst _hoisted_3 = { class: \"progress-bar-container\" };\nconst _hoisted_4 = { class: \"detail-item\" };\nconst _hoisted_5 = { class: \"detail-item\" };\nconst _hoisted_6 = { class: \"epoch-tabs\" };\nconst _hoisted_7 = [\"onClick\"];\nconst _hoisted_8 = { class: \"detail-item\" };\nconst _hoisted_9 = { class: \"detail-item\" };\nconst _hoisted_10 = {\n    key: 0,\n    class: \"detail-item\"\n};\nconst _hoisted_11 = { class: \"world-description\" };\nconst _hoisted_12 = { class: \"panel-footer\" };\nconst _hoisted_13 = [\"disabled\"];\nconst _hoisted_14 = {\n    key: 1,\n    class: \"unselectable-notice\"\n};\nconst _hoisted_15 = { class: \"map-controls\" };\nconst _hoisted_16 = { class: \"speed-controls-overlay\" };\nconst _hoisted_17 = { class: \"speed-bar-container\" };\nconst _hoisted_18 = {\n    key: 2,\n    class: \"evolving-overlay\"\n};\nimport { computed, onMounted, onUnmounted, ref, watch } from 'vue';\nimport { get } from 'lodash';\n// import { lorebookService } from '../../../services/LorebookService'; // \nimport { StarMapService } from '../../../services/StarMapService';\nimport { actions, store } from '../../../store';\nimport { isSimulationRunning, simulatorCooldown } from '../../../store/getters';\nimport './WorldSelection.scss';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'WorldSelection',\n    setup(__props) {\n        const starmapContainer = ref(null);\n        let starMapService = null;\n        const isLoading = ref(true);\n        const detailedWorld = ref(null);\n        const selectableWorldIds = ref(new Set());\n        const progress = ref(0);\n        let progressInterval = null;\n        const activeEpochId = ref(null);\n        // 5-speed level control\n        const speedLevels = [0, 0.2, 0.5, 1.0, 2.0];\n        const speedLevel = ref(2); // Default to level 2 (1.0x speed)\n        const parsedWorlds = computed(() => {\n            const worlds = get(store.worldState, '', {});\n            let idCounter = 0;\n            return Object.entries(worlds)\n                .filter(([worldId]) => worldId !== '$meta' && !worldId.includes('template'))\n                .map(([worldId, worldData]) => {\n                const historicalEpochs = get(worldData, '.', {});\n                const epochs = Object.entries(historicalEpochs).map(([epochId, epochData]) => {\n                    const coreLaws = get(epochData, '.', {});\n                    return {\n                        id: epochId,\n                        name: epochData. || '',\n                        energyLevel: get(epochData, '.', 1),\n                        timeFlow: get(epochData, '.', 1),\n                        description: epochData. || '',\n                        coreLaws: Object.values(coreLaws)\n                            .map((law) => law.)\n                            .filter(Boolean),\n                    };\n                });\n                return {\n                    id: ++idCounter,\n                    name: worldData. || '',\n                    raw: { ...worldData, originalId: worldId },\n                    cosmologicalBlueprint: get(worldData, '..', ''),\n                    physicalScale: get(worldData, '..', ''),\n                    currentEpochId: get(worldData, '..ID', ''),\n                    epochs: epochs,\n                };\n            });\n        });\n        const cooldown = computed(() => simulatorCooldown.value);\n        const isDetailedWorldActive = computed(() => {\n            // 1.  2. \n            return !isSimulationRunning.value && cooldown.value.status !== '';\n        });\n        const selectRandomWorlds = () => {\n            //  `isSimulationRunning` getter \n            // \n            if (isSimulationRunning.value) {\n                selectableWorldIds.value = new Set();\n                return;\n            }\n            // \n            const worlds = parsedWorlds.value;\n            if (worlds.length === 0)\n                return;\n            const ids = worlds.map(w => w.id);\n            if (worlds.length <= 3) {\n                selectableWorldIds.value = new Set(ids);\n            }\n            else {\n                const shuffled = [...ids].sort(() => 0.5 - Math.random());\n                selectableWorldIds.value = new Set(shuffled.slice(0, 3));\n            }\n        };\n        const rescanWorlds = () => {\n            isLoading.value = true;\n            detailedWorld.value = null;\n            progress.value = 0;\n            if (progressInterval) {\n                clearInterval(progressInterval);\n            }\n            progressInterval = window.setInterval(() => {\n                if (progress.value < 99) {\n                    progress.value++;\n                }\n                else {\n                    if (progressInterval)\n                        clearInterval(progressInterval);\n                }\n            }, 960); // 135 (95000ms / 99 ~= 960ms)\n            // \n            actions.resetReincarnationSelection();\n            // UI\n            actions.triggerCreationWorkflow();\n        };\n        // const syncNewWorlds = () => {\n        //   store.newWorldsAvailable = false;\n        //   // \n        //   window.location.reload();\n        // };\n        const handleCanvasClick = (event) => {\n            if (!starMapService)\n                return;\n            const pickedWorld = starMapService.pickStar(event);\n            if (pickedWorld) {\n                detailedWorld.value = pickedWorld;\n            }\n            else {\n                detailedWorld.value = null;\n            }\n        };\n        const activeEpoch = computed(() => {\n            if (!detailedWorld.value || !activeEpochId.value)\n                return null;\n            return detailedWorld.value.epochs.find(e => e.id === activeEpochId.value);\n        });\n        watch(detailedWorld, newWorld => {\n            if (newWorld) {\n                activeEpochId.value = newWorld.currentEpochId;\n            }\n            else {\n                activeEpochId.value = null;\n            }\n        });\n        watch(starmapContainer, newContainer => {\n            if (newContainer && !starMapService) {\n                console.log('[WorldSelection] starmapContainer is now available. Initializing StarMapService.');\n                starMapService = new StarMapService(newContainer);\n                // If worlds are already loaded, create stars immediately\n                if (parsedWorlds.value.length > 0) {\n                    console.log('[WorldSelection] Worlds already present, calling createStars from container watch.');\n                    starMapService.createStars(parsedWorlds.value, selectableWorldIds.value);\n                }\n            }\n        });\n        onMounted(async () => {\n            console.log('[WorldSelection] Component Mounted.');\n            // isLoading.value = true; // \n            await actions.fetchReincarnationWorlds();\n            selectRandomWorlds();\n            if (starMapService) {\n                starMapService.createStars(parsedWorlds.value, selectableWorldIds.value);\n            }\n            isLoading.value = false; // \n        });\n        onUnmounted(() => {\n            starMapService?.destroy();\n        });\n        watch(parsedWorlds, newWorlds => {\n            console.log(`[WorldSelection] Parsed worlds watcher triggered: ${newWorlds.length} worlds.`);\n            if (newWorlds.length > 0) {\n                // if (isLoading.value) { // \n                //   isLoading.value = false;\n                // }\n                //  await\n                selectRandomWorlds();\n                // The service might not be ready yet, the starmapContainer watcher will handle creation\n                if (starMapService) {\n                    console.log('[WorldSelection] Service exists, calling createStars from worlds watch.');\n                    starMapService.createStars(newWorlds, selectableWorldIds.value);\n                }\n            }\n        }, { deep: true });\n        // \n        watch(isSimulationRunning, (isRunning, wasRunning) => {\n            // \n            if (wasRunning && !isRunning) {\n                console.log('[WorldSelection] Simulation has ended. Re-selecting random worlds.');\n                selectRandomWorlds();\n            }\n        });\n        const prepareReincarnation = (world) => {\n            if (!isSimulationRunning.value) {\n                actions.triggerIdentityWorkflow(world.originalId);\n                detailedWorld.value = null;\n            }\n        };\n        const adjustSpeed = (delta) => {\n            const newLevel = speedLevel.value + delta;\n            if (newLevel >= 0 && newLevel < speedLevels.length) {\n                speedLevel.value = newLevel;\n                if (starMapService) {\n                    starMapService.setSpeedMultiplier(speedLevels[speedLevel.value]);\n                }\n            }\n        };\n        watch(speedLevel, newLevel => {\n            if (starMapService) {\n                starMapService.setSpeedMultiplier(speedLevels[newLevel]);\n            }\n        }, { immediate: true });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (isLoading.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _createElementVNode(\"div\", _hoisted_3, [\n                            _createElementVNode(\"div\", {\n                                class: \"progress-bar\",\n                                style: _normalizeStyle({ width: progress.value + '%' })\n                            }, null, 4 /* STYLE */)\n                        ]),\n                        _createElementVNode(\"span\", null, \"... \" + _toDisplayString(progress.value) + \"%\", 1 /* TEXT */)\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                (!isLoading.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 1,\n                        ref_key: \"starmapContainer\",\n                        ref: starmapContainer,\n                        class: \"star-map-canvas\",\n                        onClick: handleCanvasClick\n                    }, null, 512 /* NEED_PATCH */))\n                    : _createCommentVNode(\"v-if\", true),\n                _createElementVNode(\"div\", {\n                    class: _normalizeClass([\"world-detail-panel\", { visible: !!detailedWorld.value }])\n                }, [\n                    (detailedWorld.value && activeEpoch.value)\n                        ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                            _createElementVNode(\"h4\", null, _toDisplayString(detailedWorld.value.name), 1 /* TEXT */),\n                            _createElementVNode(\"div\", _hoisted_4, [\n                                _createElementVNode(\"p\", null, [\n                                    _cache[4] || (_cache[4] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                    _createTextVNode(\" \" + _toDisplayString(detailedWorld.value.cosmologicalBlueprint), 1 /* TEXT */)\n                                ])\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_5, [\n                                _createElementVNode(\"p\", null, [\n                                    _cache[5] || (_cache[5] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                    _createTextVNode(\" \" + _toDisplayString(detailedWorld.value.physicalScale), 1 /* TEXT */)\n                                ])\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_6, [\n                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(detailedWorld.value.epochs, (epoch) => {\n                                    return (_openBlock(), _createElementBlock(\"button\", {\n                                        key: epoch.id,\n                                        class: _normalizeClass({ active: activeEpochId.value === epoch.id }),\n                                        onClick: ($event) => (activeEpochId.value = epoch.id)\n                                    }, _toDisplayString(epoch.name), 11 /* TEXT, CLASS, PROPS */, _hoisted_7));\n                                }), 128 /* KEYED_FRAGMENT */))\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_8, [\n                                _createElementVNode(\"p\", null, [\n                                    _cache[6] || (_cache[6] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                    _createTextVNode(\" \" + _toDisplayString(activeEpoch.value.energyLevel), 1 /* TEXT */)\n                                ])\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_9, [\n                                _createElementVNode(\"p\", null, [\n                                    _cache[7] || (_cache[7] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                    _createTextVNode(\" \" + _toDisplayString(activeEpoch.value.timeFlow) + \"x\", 1 /* TEXT */)\n                                ])\n                            ]),\n                            (activeEpoch.value.coreLaws && activeEpoch.value.coreLaws.length > 0)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [\n                                    _cache[8] || (_cache[8] = _createElementVNode(\"p\", null, [\n                                        _createElementVNode(\"strong\", null, \":\")\n                                    ], -1 /* CACHED */)),\n                                    _createElementVNode(\"ul\", null, [\n                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(activeEpoch.value.coreLaws, (law, index) => {\n                                            return (_openBlock(), _createElementBlock(\"li\", { key: index }, _toDisplayString(law), 1 /* TEXT */));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                    ])\n                                ]))\n                                : _createCommentVNode(\"v-if\", true),\n                            _createElementVNode(\"div\", _hoisted_11, [\n                                _createElementVNode(\"p\", null, _toDisplayString(activeEpoch.value.description), 1 /* TEXT */)\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_12, [\n                                (isDetailedWorldActive.value)\n                                    ? (_openBlock(), _createElementBlock(\"button\", {\n                                        key: 0,\n                                        onClick: _cache[0] || (_cache[0] = ($event) => (prepareReincarnation(detailedWorld.value.raw))),\n                                        disabled: !isDetailedWorldActive.value\n                                    }, \"  \", 8 /* PROPS */, _hoisted_13))\n                                    : (_openBlock(), _createElementBlock(\"p\", _hoisted_14, \"\"))\n                            ])\n                        ], 64 /* STABLE_FRAGMENT */))\n                        : _createCommentVNode(\"v-if\", true)\n                ], 2 /* CLASS */),\n                _createElementVNode(\"div\", _hoisted_15, [\n                    _createElementVNode(\"button\", {\n                        onClick: _cache[1] || (_cache[1] = ($event) => (rescanWorlds())),\n                        class: \"rescan-btn\"\n                    }, \"\")\n                ]),\n                _createElementVNode(\"div\", _hoisted_16, [\n                    _createElementVNode(\"button\", {\n                        onClick: _cache[2] || (_cache[2] = ($event) => (adjustSpeed(1))),\n                        title: \"\",\n                        class: \"control-btn\"\n                    }, \"+\"),\n                    _createElementVNode(\"div\", _hoisted_17, [\n                        _cache[9] || (_cache[9] = _createElementVNode(\"div\", { class: \"speed-bar-track\" }, null, -1 /* CACHED */)),\n                        _createElementVNode(\"div\", {\n                            class: \"speed-bar-fill\",\n                            style: _normalizeStyle({ height: `${speedLevel.value * 25}%` })\n                        }, null, 4 /* STYLE */)\n                    ]),\n                    _createElementVNode(\"button\", {\n                        onClick: _cache[3] || (_cache[3] = ($event) => (adjustSpeed(-1))),\n                        title: \"\",\n                        class: \"control-btn\"\n                    }, \"-\")\n                ]),\n                (_unref(isSimulationRunning))\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_18, [...(_cache[10] || (_cache[10] = [\n                            _createElementVNode(\"p\", null, \"...\", -1 /* CACHED */),\n                            _createElementVNode(\"div\", { class: \"spinner\" }, null, -1 /* CACHED */)\n                        ]))]))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./WorldSelection.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./WorldSelection.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./WorldSelection.vue?vue&type=style&index=0&id=7cfb4be4&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7cfb4be4\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createElementVNode as _createElementVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"reincarnation-panel\" };\nconst _hoisted_2 = { class: \"tabs\" };\nconst _hoisted_3 = [\"disabled\"];\nconst _hoisted_4 = [\"disabled\"];\nconst _hoisted_5 = [\"disabled\"];\nconst _hoisted_6 = { class: \"tab-content\" };\nconst _hoisted_7 = {\n    key: 5,\n    class: \"status-placeholder\"\n};\nimport { computed, ref, watch } from 'vue';\nimport LogPanel from './LogPanel.vue';\nimport RipplesPanel from './RipplesPanel.vue';\nimport AvatarSelection from './reincarnation/AvatarSelection.vue';\nimport SettlementView from './reincarnation/SettlementView.vue';\nimport WorldSelection from './reincarnation/WorldSelection.vue';\nimport { simulatorStatus, simulatorCooldown } from '../../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ReincarnationPanel',\n    setup(__props) {\n        const activeTab = ref('worldSelection');\n        const reincarnationStatus = computed(() => simulatorStatus.value);\n        const cooldown = computed(() => simulatorCooldown.value);\n        const statusText = computed(() => {\n            switch (reincarnationStatus.value) {\n                case 'world-selection':\n                    return '';\n                case 'avatar-selection':\n                    return '';\n                case 'simulating':\n                    return '';\n                case 'settlement':\n                    return '';\n                case 'cooldown':\n                    return `: ${cooldown.value.remainingTime}`;\n                default:\n                    return '';\n            }\n        });\n        watch(reincarnationStatus, newStatus => {\n            if (newStatus === 'world-selection') {\n                activeTab.value = 'worldSelection';\n            }\n            else if (newStatus === 'avatar-selection') {\n                activeTab.value = 'avatarSelection';\n            }\n            else if (newStatus === 'settlement') {\n                activeTab.value = 'settlementView';\n            }\n        }, { immediate: true });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass({ active: activeTab.value === 'worldSelection' }),\n                        onClick: _cache[0] || (_cache[0] = ($event) => (activeTab.value = 'worldSelection')),\n                        disabled: reincarnationStatus.value !== 'world-selection' && reincarnationStatus.value !== 'cooldown'\n                    }, \"  (\" + _toDisplayString(statusText.value) + \") \", 11 /* TEXT, CLASS, PROPS */, _hoisted_3),\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass({ active: activeTab.value === 'avatarSelection' }),\n                        onClick: _cache[1] || (_cache[1] = ($event) => (activeTab.value = 'avatarSelection')),\n                        disabled: reincarnationStatus.value !== 'avatar-selection'\n                    }, \"  \", 10 /* CLASS, PROPS */, _hoisted_4),\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass({ active: activeTab.value === 'settlementView' }),\n                        onClick: _cache[2] || (_cache[2] = ($event) => (activeTab.value = 'settlementView')),\n                        disabled: reincarnationStatus.value !== 'settlement'\n                    }, \"  \", 10 /* CLASS, PROPS */, _hoisted_5),\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass({ active: activeTab.value === 'log' }),\n                        onClick: _cache[3] || (_cache[3] = ($event) => (activeTab.value = 'log'))\n                    }, \"\", 2 /* CLASS */),\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass({ active: activeTab.value === 'ripples' }),\n                        onClick: _cache[4] || (_cache[4] = ($event) => (activeTab.value = 'ripples'))\n                    }, \"\", 2 /* CLASS */)\n                ]),\n                _createElementVNode(\"div\", _hoisted_6, [\n                    (activeTab.value === 'worldSelection')\n                        ? (_openBlock(), _createBlock(WorldSelection, { key: 0 }))\n                        : _createCommentVNode(\"v-if\", true),\n                    (activeTab.value === 'avatarSelection')\n                        ? (_openBlock(), _createBlock(AvatarSelection, { key: 1 }))\n                        : _createCommentVNode(\"v-if\", true),\n                    (activeTab.value === 'settlementView')\n                        ? (_openBlock(), _createBlock(SettlementView, { key: 2 }))\n                        : _createCommentVNode(\"v-if\", true),\n                    (activeTab.value === 'log')\n                        ? (_openBlock(), _createBlock(LogPanel, { key: 3 }))\n                        : _createCommentVNode(\"v-if\", true),\n                    (activeTab.value === 'ripples')\n                        ? (_openBlock(), _createBlock(RipplesPanel, { key: 4 }))\n                        : _createCommentVNode(\"v-if\", true),\n                    (reincarnationStatus.value === 'simulating')\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, \"...\"))\n                        : _createCommentVNode(\"v-if\", true)\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ReincarnationPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ReincarnationPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ReincarnationPanel.vue?vue&type=style&index=0&id=8bf6b682&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-8bf6b682\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode } from \"vue\";\nconst _hoisted_1 = { class: \"ripple-detail-panel\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"ripple-content\"\n};\nconst _hoisted_3 = { class: \"detail-key\" };\nconst _hoisted_4 = { class: \"detail-value\" };\nconst _hoisted_5 = {\n    key: 1,\n    class: \"loading-message\"\n};\nimport { ref, onMounted, toRefs } from 'vue';\nimport { ripplesService } from '../../services/RipplesService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'RippleDetailPanel',\n    props: {\n        rippleId: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const { rippleId } = toRefs(props);\n        const ripple = ref(undefined);\n        onMounted(() => {\n            ripple.value = ripplesService.getRippleById(rippleId.value);\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (ripple.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(ripple.value, (value, key) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: key,\n                                class: \"detail-item\"\n                            }, [\n                                _createElementVNode(\"strong\", _hoisted_3, _toDisplayString(key) + \":\", 1 /* TEXT */),\n                                _createElementVNode(\"span\", _hoisted_4, _toDisplayString(value), 1 /* TEXT */)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_5, \"...\"))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./RippleDetailPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./RippleDetailPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./RippleDetailPanel.vue?vue&type=style&index=0&id=4f93fcfc&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-4f93fcfc\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = { class: \"skills-panel\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"empty-state\"\n};\nconst _hoisted_3 = {\n    key: 1,\n    class: \"skills-list\"\n};\nconst _hoisted_4 = { class: \"skill-header\" };\nconst _hoisted_5 = { class: \"skill-level\" };\nconst _hoisted_6 = { class: \"skill-description\" };\nconst _hoisted_7 = { class: \"skill-progress\" };\nconst _hoisted_8 = { class: \"progress-bar-wrapper\" };\nconst _hoisted_9 = [\"value\", \"max\"];\nconst _hoisted_10 = { class: \"progress-text\" };\nconst _hoisted_11 = {\n    key: 0,\n    class: \"associated-skills\"\n};\nconst _hoisted_12 = [\"onClick\"];\nconst _hoisted_13 = {\n    key: 0,\n    class: \"associated-skills-list\"\n};\nconst _hoisted_14 = { class: \"skill-name\" };\nconst _hoisted_15 = { class: \"skill-detail skill-description-detail\" };\nconst _hoisted_16 = { class: \"skill-detail\" };\nconst _hoisted_17 = { class: \"skill-detail\" };\nimport { computed, ref } from 'vue';\nimport { playerSkills } from '../../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'SkillsPanel',\n    setup(__props) {\n        const skills = computed(() => playerSkills.value);\n        const expandedSkills = ref({});\n        const toggleSkills = (skillId) => {\n            expandedSkills.value[skillId] = !expandedSkills.value[skillId];\n        };\n        const isExpanded = (skillId) => {\n            return !!expandedSkills.value[skillId];\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _cache[4] || (_cache[4] = _createElementVNode(\"h2\", null, \"\", -1 /* CACHED */)),\n                (skills.value.length === 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [...(_cache[0] || (_cache[0] = [\n                            _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                        ]))]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(skills.value, (skill) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: skill.id,\n                                class: \"skill-item\"\n                            }, [\n                                _createElementVNode(\"div\", _hoisted_4, [\n                                    _createElementVNode(\"h3\", null, _toDisplayString(skill.name), 1 /* TEXT */),\n                                    _createElementVNode(\"div\", _hoisted_5, \" \" + _toDisplayString(skill.level), 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"p\", _hoisted_6, _toDisplayString(skill.description), 1 /* TEXT */),\n                                _createElementVNode(\"div\", _hoisted_7, [\n                                    _createElementVNode(\"div\", _hoisted_8, [\n                                        _createElementVNode(\"progress\", {\n                                            value: skill.exp,\n                                            max: skill.expToNextLevel === 'MAX' ? skill.exp : skill.expToNextLevel\n                                        }, null, 8 /* PROPS */, _hoisted_9),\n                                        _createElementVNode(\"span\", _hoisted_10, _toDisplayString(skill.exp) + \" / \" + _toDisplayString(skill.expToNextLevel), 1 /* TEXT */)\n                                    ])\n                                ]),\n                                (skill.associatedSkills && skill.associatedSkills.length > 0)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [\n                                        _createElementVNode(\"button\", {\n                                            onClick: ($event) => (toggleSkills(skill.id)),\n                                            class: \"associated-skills-title\"\n                                        }, [\n                                            _cache[1] || (_cache[1] = _createTextVNode(\"  \", -1 /* CACHED */)),\n                                            _createElementVNode(\"span\", {\n                                                class: _normalizeClass(['arrow', { expanded: isExpanded(skill.id) }])\n                                            }, null, 2 /* CLASS */)\n                                        ], 8 /* PROPS */, _hoisted_12),\n                                        (isExpanded(skill.id))\n                                            ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_13, [\n                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(skill.associatedSkills, (activeSkill) => {\n                                                    return (_openBlock(), _createElementBlock(\"li\", {\n                                                        key: activeSkill.ID,\n                                                        class: \"associated-skill-item\"\n                                                    }, [\n                                                        _createElementVNode(\"div\", _hoisted_14, [\n                                                            _createElementVNode(\"strong\", null, _toDisplayString(activeSkill.), 1 /* TEXT */),\n                                                            _createTextVNode(\" (\" + _toDisplayString(activeSkill.) + \") \", 1 /* TEXT */)\n                                                        ]),\n                                                        _createElementVNode(\"div\", _hoisted_15, _toDisplayString(activeSkill.), 1 /* TEXT */),\n                                                        _createElementVNode(\"div\", _hoisted_16, [\n                                                            _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                            _createTextVNode(\" \" + _toDisplayString(activeSkill.), 1 /* TEXT */)\n                                                        ]),\n                                                        _createElementVNode(\"div\", _hoisted_17, [\n                                                            _cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                            _createTextVNode(\" \" + _toDisplayString(activeSkill.), 1 /* TEXT */)\n                                                        ])\n                                                    ]));\n                                                }), 128 /* KEYED_FRAGMENT */))\n                                            ]))\n                                            : _createCommentVNode(\"v-if\", true)\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./SkillsPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SkillsPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./SkillsPanel.vue?vue&type=style&index=0&id=14bf0e7c&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-14bf0e7c\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, vModelCheckbox as _vModelCheckbox, withDirectives as _withDirectives, vModelText as _vModelText, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"panel-wrapper memory-panel-container\" };\nconst _hoisted_2 = { class: \"panel-content\" };\nconst _hoisted_3 = { class: \"section\" };\nconst _hoisted_4 = { class: \"setting-item\" };\nconst _hoisted_5 = { class: \"section\" };\nconst _hoisted_6 = { class: \"setting-item\" };\nconst _hoisted_7 = { class: \"setting-item\" };\nconst _hoisted_8 = { class: \"setting-item\" };\nconst _hoisted_9 = { class: \"section\" };\nconst _hoisted_10 = { class: \"tabs\" };\nconst _hoisted_11 = { class: \"memory-content\" };\nconst _hoisted_12 = [\"value\"];\nimport * as toastr from 'toastr';\nimport { computed, onMounted, onUnmounted, ref } from 'vue';\nimport { eventBus } from '../../services/EventBus';\nimport { lorebookService } from '../../services/LorebookService';\nimport { memoryService } from '../../services/MemoryService';\nimport { store } from '../../store';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'MemoryPanel',\n    setup(__props) {\n        const isAutoMemoryEnabled = ref(true); // Default to enabled\n        const config = ref({\n            instantMemoryCount: 3,\n            shortTermMemoryCount: 25,\n            longTermMemoryCount: 200,\n        });\n        const activeTab = ref('instant');\n        const memoryContent = ref({\n            instant: '...',\n            short: '...',\n            long: '...',\n        });\n        const activeMemoryContent = computed(() => {\n            return memoryContent.value[activeTab.value];\n        });\n        async function fetchMemoryContent(forceRefresh = false) {\n            try {\n                const [instant, short, long] = await Promise.all([\n                    lorebookService.readFromLorebook('[]', forceRefresh),\n                    lorebookService.readFromLorebook('[]', forceRefresh),\n                    lorebookService.readFromLorebook('[]', forceRefresh),\n                ]);\n                memoryContent.value.instant = instant || '';\n                memoryContent.value.short = short || '';\n                memoryContent.value.long = long || '';\n            }\n            catch (error) {\n                console.error('[MemoryPanel] Failed to fetch memory content:', error);\n                toastr.error('');\n            }\n        }\n        function updateConfig() {\n            memoryService.setConfig(config.value);\n            toastr.success('');\n        }\n        async function forceUpdate() {\n            toastr.info('...');\n            console.log('[MemoryPanel] Forcing update with worldLog:', JSON.stringify(store.worldLog, null, 2));\n            await memoryService.updateMemory(store.worldLog);\n            await fetchMemoryContent(true); // Force refresh after manual update\n            toastr.success('');\n        }\n        const handleMemoryUpdate = () => {\n            console.log('[MemoryPanel] Detected memory update. Refreshing content...');\n            fetchMemoryContent(true); // Force refresh\n        };\n        onMounted(() => {\n            config.value = memoryService.getConfig();\n            fetchMemoryContent();\n            eventBus.on('memoryUpdated', handleMemoryUpdate);\n        });\n        onUnmounted(() => {\n            eventBus.off('memoryUpdated', handleMemoryUpdate);\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[14] || (_cache[14] = _createElementVNode(\"h3\", { class: \"panel-title\" }, \"\", -1 /* CACHED */)),\n                    _createCommentVNode(\" Automation Control \"),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _createElementVNode(\"div\", _hoisted_4, [\n                            _cache[7] || (_cache[7] = _createElementVNode(\"label\", { for: \"auto-memory-switch\" }, \"\", -1 /* CACHED */)),\n                            _withDirectives(_createElementVNode(\"input\", {\n                                type: \"checkbox\",\n                                id: \"auto-memory-switch\",\n                                \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((isAutoMemoryEnabled).value = $event))\n                            }, null, 512 /* NEED_PATCH */), [\n                                [_vModelCheckbox, isAutoMemoryEnabled.value]\n                            ])\n                        ]),\n                        _cache[8] || (_cache[8] = _createElementVNode(\"p\", { class: \"description\" }, \"AI\", -1 /* CACHED */))\n                    ]),\n                    _createCommentVNode(\" Configuration \"),\n                    _createElementVNode(\"div\", _hoisted_5, [\n                        _cache[12] || (_cache[12] = _createElementVNode(\"h4\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"div\", _hoisted_6, [\n                            _cache[9] || (_cache[9] = _createElementVNode(\"label\", { for: \"instant-memory-count\" }, \"\", -1 /* CACHED */)),\n                            _withDirectives(_createElementVNode(\"input\", {\n                                type: \"number\",\n                                id: \"instant-memory-count\",\n                                \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event) => ((config.value.instantMemoryCount) = $event))\n                            }, null, 512 /* NEED_PATCH */), [\n                                [\n                                    _vModelText,\n                                    config.value.instantMemoryCount,\n                                    void 0,\n                                    { number: true }\n                                ]\n                            ])\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_7, [\n                            _cache[10] || (_cache[10] = _createElementVNode(\"label\", { for: \"short-term-count\" }, \"\", -1 /* CACHED */)),\n                            _withDirectives(_createElementVNode(\"input\", {\n                                type: \"number\",\n                                id: \"short-term-count\",\n                                \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event) => ((config.value.shortTermMemoryCount) = $event))\n                            }, null, 512 /* NEED_PATCH */), [\n                                [\n                                    _vModelText,\n                                    config.value.shortTermMemoryCount,\n                                    void 0,\n                                    { number: true }\n                                ]\n                            ])\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_8, [\n                            _cache[11] || (_cache[11] = _createElementVNode(\"label\", { for: \"long-term-count\" }, \"\", -1 /* CACHED */)),\n                            _withDirectives(_createElementVNode(\"input\", {\n                                type: \"number\",\n                                id: \"long-term-count\",\n                                \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event) => ((config.value.longTermMemoryCount) = $event))\n                            }, null, 512 /* NEED_PATCH */), [\n                                [\n                                    _vModelText,\n                                    config.value.longTermMemoryCount,\n                                    void 0,\n                                    { number: true }\n                                ]\n                            ])\n                        ]),\n                        _createElementVNode(\"button\", { onClick: updateConfig }, \"\"),\n                        _createElementVNode(\"button\", { onClick: forceUpdate }, \"\")\n                    ]),\n                    _createCommentVNode(\" Memory Review \"),\n                    _createElementVNode(\"div\", _hoisted_9, [\n                        _cache[13] || (_cache[13] = _createElementVNode(\"h4\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"div\", _hoisted_10, [\n                            _createElementVNode(\"button\", {\n                                class: _normalizeClass({ active: activeTab.value === 'instant' }),\n                                onClick: _cache[4] || (_cache[4] = ($event) => (activeTab.value = 'instant'))\n                            }, \"\", 2 /* CLASS */),\n                            _createElementVNode(\"button\", {\n                                class: _normalizeClass({ active: activeTab.value === 'short' }),\n                                onClick: _cache[5] || (_cache[5] = ($event) => (activeTab.value = 'short'))\n                            }, \"\", 2 /* CLASS */),\n                            _createElementVNode(\"button\", {\n                                class: _normalizeClass({ active: activeTab.value === 'long' }),\n                                onClick: _cache[6] || (_cache[6] = ($event) => (activeTab.value = 'long'))\n                            }, \"\", 2 /* CLASS */)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_11, [\n                            _createElementVNode(\"textarea\", {\n                                readonly: \"\",\n                                value: activeMemoryContent.value\n                            }, null, 8 /* PROPS */, _hoisted_12)\n                        ])\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./MemoryPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MemoryPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MemoryPanel.vue?vue&type=style&index=0&id=a508653a&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-a508653a\"]])\n\nexport default __exports__","import { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, vModelCheckbox as _vModelCheckbox, withDirectives as _withDirectives, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = { class: \"save-load-panel\" };\nconst _hoisted_2 = { class: \"panel-header\" };\nconst _hoisted_3 = { class: \"header-actions\" };\nconst _hoisted_4 = { class: \"save-slots-container\" };\nconst _hoisted_5 = { class: \"slot-group\" };\nconst _hoisted_6 = { class: \"slot-info\" };\nconst _hoisted_7 = { class: \"slot-name\" };\nconst _hoisted_8 = { class: \"slot-timestamp\" };\nconst _hoisted_9 = {\n    key: 0,\n    class: \"slot-world-log\"\n};\nconst _hoisted_10 = { class: \"log-date\" };\nconst _hoisted_11 = { class: \"log-title\" };\nconst _hoisted_12 = { class: \"slot-actions\" };\nconst _hoisted_13 = [\"onClick\"];\nconst _hoisted_14 = [\"onClick\", \"disabled\"];\nconst _hoisted_15 = [\"onClick\", \"disabled\"];\nconst _hoisted_16 = { class: \"slot-group\" };\nconst _hoisted_17 = { class: \"slot-info\" };\nconst _hoisted_18 = { class: \"slot-name\" };\nconst _hoisted_19 = { class: \"slot-timestamp\" };\nconst _hoisted_20 = {\n    key: 0,\n    class: \"slot-world-log\"\n};\nconst _hoisted_21 = { class: \"log-date\" };\nconst _hoisted_22 = { class: \"log-title\" };\nconst _hoisted_23 = { class: \"slot-actions\" };\nconst _hoisted_24 = [\"onClick\", \"disabled\"];\nconst _hoisted_25 = { class: \"auto-save-toggle\" };\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n    return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n        _createElementVNode(\"div\", _hoisted_2, [\n            _cache[5] || (_cache[5] = _createElementVNode(\"h2\", { class: \"panel-title\" }, \"\", -1 /* CACHED */)),\n            _createElementVNode(\"div\", _hoisted_3, [\n                _createElementVNode(\"button\", {\n                    onClick: _cache[0] || (_cache[0] =\n                        //@ts-ignore\n                        (...args) => (_ctx.importSave && _ctx.importSave(...args))),\n                    class: \"header-btn\"\n                }, \"\"),\n                _createElementVNode(\"button\", {\n                    onClick: _cache[1] || (_cache[1] =\n                        //@ts-ignore\n                        (...args) => (_ctx.exportSave && _ctx.exportSave(...args))),\n                    class: \"header-btn\"\n                }, \"\")\n            ])\n        ]),\n        _createElementVNode(\"div\", _hoisted_4, [\n            _createElementVNode(\"div\", _hoisted_5, [\n                _cache[6] || (_cache[6] = _createElementVNode(\"h3\", { class: \"group-title\" }, \"\", -1 /* CACHED */)),\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.manualSlots, (slot) => {\n                    return (_openBlock(), _createElementBlock(\"div\", {\n                        key: slot.id,\n                        class: \"save-slot\"\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_6, [\n                            _createElementVNode(\"span\", _hoisted_7, _toDisplayString(slot.name), 1 /* TEXT */),\n                            _createElementVNode(\"span\", _hoisted_8, _toDisplayString(slot.timestamp ? _ctx.formatTimestamp(slot.timestamp) : ''), 1 /* TEXT */),\n                            (slot.worldLogDate || slot.worldLogTitle)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [\n                                    _createElementVNode(\"span\", _hoisted_10, _toDisplayString(slot.worldLogDate), 1 /* TEXT */),\n                                    _createElementVNode(\"span\", _hoisted_11, _toDisplayString(slot.worldLogTitle), 1 /* TEXT */)\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_12, [\n                            _createElementVNode(\"button\", {\n                                onClick: ($event) => (_ctx.saveGame(slot.id)),\n                                class: \"action-btn save-btn\"\n                            }, \"\", 8 /* PROPS */, _hoisted_13),\n                            _createElementVNode(\"button\", {\n                                onClick: ($event) => (_ctx.loadGame(slot)),\n                                disabled: !slot.data,\n                                class: \"action-btn load-btn\"\n                            }, \"\", 8 /* PROPS */, _hoisted_14),\n                            _createElementVNode(\"button\", {\n                                onClick: ($event) => (_ctx.deleteSave(slot)),\n                                disabled: !slot.data,\n                                class: \"action-btn delete-btn\"\n                            }, \"\", 8 /* PROPS */, _hoisted_15)\n                        ])\n                    ]));\n                }), 128 /* KEYED_FRAGMENT */))\n            ]),\n            _createElementVNode(\"div\", _hoisted_16, [\n                _cache[7] || (_cache[7] = _createElementVNode(\"h3\", { class: \"group-title\" }, \"\", -1 /* CACHED */)),\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.autoSlots, (slot) => {\n                    return (_openBlock(), _createElementBlock(\"div\", {\n                        key: slot.id,\n                        class: \"save-slot auto-slot\"\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_17, [\n                            _createElementVNode(\"span\", _hoisted_18, _toDisplayString(slot.name), 1 /* TEXT */),\n                            _createElementVNode(\"span\", _hoisted_19, _toDisplayString(slot.timestamp ? _ctx.formatTimestamp(slot.timestamp) : ''), 1 /* TEXT */),\n                            (slot.worldLogDate || slot.worldLogTitle)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_20, [\n                                    _createElementVNode(\"span\", _hoisted_21, _toDisplayString(slot.worldLogDate), 1 /* TEXT */),\n                                    _createElementVNode(\"span\", _hoisted_22, _toDisplayString(slot.worldLogTitle), 1 /* TEXT */)\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_23, [\n                            _createElementVNode(\"button\", {\n                                onClick: ($event) => (_ctx.loadGame(slot)),\n                                disabled: !slot.data,\n                                class: \"action-btn load-btn\"\n                            }, \"\", 8 /* PROPS */, _hoisted_24)\n                        ])\n                    ]));\n                }), 128 /* KEYED_FRAGMENT */))\n            ]),\n            _createElementVNode(\"div\", _hoisted_25, [\n                _createElementVNode(\"label\", null, [\n                    _withDirectives(_createElementVNode(\"input\", {\n                        type: \"checkbox\",\n                        \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event) => ((_ctx.isAutoSaveEnabled) = $event)),\n                        onChange: _cache[3] || (_cache[3] =\n                            //@ts-ignore\n                            (...args) => (_ctx.toggleAutoSave && _ctx.toggleAutoSave(...args)))\n                    }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                        [_vModelCheckbox, _ctx.isAutoSaveEnabled]\n                    ]),\n                    _cache[8] || (_cache[8] = _createTextVNode(\"  \", -1 /* CACHED */))\n                ])\n            ])\n        ]),\n        _createElementVNode(\"input\", {\n            type: \"file\",\n            ref: \"fileInput\",\n            onChange: _cache[4] || (_cache[4] =\n                //@ts-ignore\n                (...args) => (_ctx.handleFileImport && _ctx.handleFileImport(...args))),\n            style: { \"display\": \"none\" },\n            accept: \".json\"\n        }, null, 544 /* NEED_HYDRATION, NEED_PATCH */)\n    ]));\n}\n","import { defineComponent, ref, onMounted } from 'vue';\nimport { saveLoadService } from '../../services/saveLoadService';\nimport * as toastr from 'toastr';\nexport default defineComponent({\n    name: 'SaveLoadPanel',\n    setup() {\n        const manualSlots = ref([]);\n        const autoSlots = ref([]);\n        const isAutoSaveEnabled = ref(true);\n        const fileInput = ref(null);\n        const loadSlots = async () => {\n            await saveLoadService.loadAllSaveSlots();\n            manualSlots.value = [...saveLoadService.manualSlots];\n            autoSlots.value = [...saveLoadService.autoSlots];\n        };\n        onMounted(() => {\n            loadSlots();\n            isAutoSaveEnabled.value = saveLoadService.isAutoSaveEnabled;\n        });\n        const formatTimestamp = (timestamp) => {\n            return new Date(timestamp).toLocaleString('zh-CN', { hour12: false });\n        };\n        const saveGame = async (slotId) => {\n            await saveLoadService.saveGame(slotId);\n            await loadSlots();\n        };\n        const loadGame = async (slot) => {\n            await saveLoadService.loadGame(slot);\n        };\n        const deleteSave = async (slot) => {\n            await saveLoadService.deleteSave(slot);\n            await loadSlots();\n        };\n        const toggleAutoSave = () => {\n            saveLoadService.toggleAutoSave(isAutoSaveEnabled.value);\n        };\n        const importSave = () => {\n            fileInput.value?.click();\n        };\n        const handleFileImport = (event) => {\n            const target = event.target;\n            if (target.files && target.files[0]) {\n                const file = target.files[0];\n                const reader = new FileReader();\n                reader.onload = async (e) => {\n                    try {\n                        const content = e.target?.result;\n                        await saveLoadService.importSave(content);\n                        await loadSlots();\n                    }\n                    catch (error) {\n                        toastr.error('');\n                        console.error(error);\n                    }\n                };\n                reader.readAsText(file);\n                target.value = ''; // Reset input\n            }\n        };\n        const exportSave = async () => {\n            // For simplicity, we'll export the first manual save slot with data\n            const slotToExport = manualSlots.value.find(slot => slot.data);\n            if (!slotToExport) {\n                toastr.warning('');\n                return;\n            }\n            saveLoadService.exportSave(slotToExport);\n        };\n        return {\n            manualSlots,\n            autoSlots,\n            isAutoSaveEnabled,\n            fileInput,\n            formatTimestamp,\n            saveGame,\n            loadGame,\n            deleteSave,\n            toggleAutoSave,\n            importSave,\n            handleFileImport,\n            exportSave,\n        };\n    },\n});\n","/* unplugin-vue-components disabled */import { render } from \"./SaveLoadPanel.vue?vue&type=template&id=83e7059e&scoped=true&ts=true\"\nimport script from \"./SaveLoadPanel.vue?vue&type=script&lang=ts\"\nexport * from \"./SaveLoadPanel.vue?vue&type=script&lang=ts\"\n\nimport \"./SaveLoadPanel.vue?vue&type=style&index=0&id=83e7059e&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-83e7059e\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { normalizeClass as _normalizeClass, createElementVNode as _createElementVNode, vShow as _vShow, createVNode as _createVNode, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"system-panel\" };\nconst _hoisted_2 = { class: \"panel-tabs\" };\nconst _hoisted_3 = { class: \"panel-content\" };\nimport { ref } from 'vue';\nimport MemoryPanel from './MemoryPanel.vue';\nimport SaveLoadPanel from './SaveLoadPanel.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'SystemPanel',\n    setup(__props) {\n        const activeTab = ref('saveLoad');\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass({ active: activeTab.value === 'saveLoad' }),\n                        onClick: _cache[0] || (_cache[0] = ($event) => (activeTab.value = 'saveLoad'))\n                    }, \"\", 2 /* CLASS */),\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass({ active: activeTab.value === 'memory' }),\n                        onClick: _cache[1] || (_cache[1] = ($event) => (activeTab.value = 'memory'))\n                    }, \"\", 2 /* CLASS */)\n                ]),\n                _createElementVNode(\"div\", _hoisted_3, [\n                    _withDirectives(_createVNode(SaveLoadPanel, null, null, 512 /* NEED_PATCH */), [\n                        [_vShow, activeTab.value === 'saveLoad']\n                    ]),\n                    _withDirectives(_createVNode(MemoryPanel, null, null, 512 /* NEED_PATCH */), [\n                        [_vShow, activeTab.value === 'memory']\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./SystemPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SystemPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./SystemPanel.vue?vue&type=style&index=0&id=da17a22c&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-da17a22c\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n    key: 0,\n    class: \"realm-detail-card\"\n};\nconst _hoisted_2 = { class: \"info-item\" };\nconst _hoisted_3 = { class: \"info-item\" };\nconst _hoisted_4 = { class: \"info-item full-width\" };\nconst _hoisted_5 = { class: \"info-item full-width\" };\nconst _hoisted_6 = { class: \"info-item full-width\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'RealmDetailCard',\n    props: {\n        realm: {\n            type: Object,\n            required: true,\n        },\n    },\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (__props.realm)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                    _createElementVNode(\"div\", _hoisted_2, [\n                        _cache[0] || (_cache[0] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.realm.), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _cache[1] || (_cache[1] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.realm.), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_4, [\n                        _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.realm.), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_5, [\n                        _cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.realm.?. && __props.realm.?. !== '' ? `${__props.realm..} - ${__props.realm..}` : ''), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_6, [\n                        _cache[4] || (_cache[4] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"ul\", null, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.realm., (req, key) => {\n                                return (_openBlock(), _createElementBlock(\"li\", { key: key }, _toDisplayString(req.), 1 /* TEXT */));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ])\n                    ])\n                ]))\n                : _createCommentVNode(\"v-if\", true);\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./RealmDetailCard.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./RealmDetailCard.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./RealmDetailCard.vue?vue&type=style&index=0&id=155d0d21&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-155d0d21\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment } from \"vue\";\nconst _hoisted_1 = {\n    key: 0,\n    class: \"panel-wrapper world-detail-panel-content\"\n};\nconst _hoisted_2 = { class: \"scroll-container\" };\nconst _hoisted_3 = { class: \"world-section\" };\nconst _hoisted_4 = { class: \"rules-grid\" };\nconst _hoisted_5 = { class: \"rule-item\" };\nconst _hoisted_6 = { class: \"rule-value\" };\nconst _hoisted_7 = { class: \"rule-item\" };\nconst _hoisted_8 = { class: \"rule-value\" };\nconst _hoisted_9 = { class: \"world-section epoch-selection\" };\nconst _hoisted_10 = { class: \"tabs-container main-tabs\" };\nconst _hoisted_11 = [\"innerHTML\"];\nconst _hoisted_12 = { class: \"world-section\" };\nconst _hoisted_13 = { class: \"epoch-header\" };\nconst _hoisted_14 = { class: \"section-title\" };\nconst _hoisted_15 = { class: \"epoch-overview\" };\nconst _hoisted_16 = { class: \"rules-grid\" };\nconst _hoisted_17 = { class: \"rule-item\" };\nconst _hoisted_18 = { class: \"rule-value\" };\nconst _hoisted_19 = { class: \"rule-item\" };\nconst _hoisted_20 = { class: \"rule-value\" };\nconst _hoisted_21 = { class: \"rule-item\" };\nconst _hoisted_22 = { class: \"rule-value\" };\nconst _hoisted_23 = { class: \"rule-item\" };\nconst _hoisted_24 = { class: \"rule-value\" };\nconst _hoisted_25 = { class: \"world-section\" };\nconst _hoisted_26 = { class: \"system-overview\" };\nconst _hoisted_27 = { class: \"subsection\" };\nconst _hoisted_28 = { class: \"ladder-container\" };\nconst _hoisted_29 = { class: \"-ladder\" };\nconst _hoisted_30 = [\"onClick\"];\nconst _hoisted_31 = { class: \"level-energy\" };\nconst _hoisted_32 = { class: \"level-name\" };\nconst _hoisted_33 = {\n    key: 1,\n    class: \"panel-wrapper loading-state\"\n};\nimport { computed, onMounted, ref, watch } from 'vue';\nimport { detailModalService } from '../../services/DetailModalService';\nimport { lorebookService } from '../../services/LorebookService';\nimport { avatarWorld, mainWorld } from '../../store/getters';\nimport RealmDetailCard from '../common/RealmDetailCard.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'WorldDetailsPanel',\n    props: {\n        worldType: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const activeTab = ref('details');\n        const worldSummary = ref('...');\n        const world = computed(() => {\n            return props.worldType === 'mainWorld' ? mainWorld.value : avatarWorld.value;\n        });\n        const availableEpochs = computed(() => {\n            if (!world.value || !world.value..)\n                return [];\n            return Object.values(world.value..).filter(epoch => typeof epoch === 'object' && epoch.ID);\n        });\n        const selectedEpochId = ref(null);\n        onMounted(async () => {\n            const entry = await lorebookService.readFromLorebook('[]');\n            if (entry) {\n                // HTML\n                worldSummary.value = entry\n                    .split('\\n\\n---\\n\\n')\n                    .map(block => `<p>${block.replace(/\\n/g, '<br>')}</p>`)\n                    .join('');\n            }\n            else {\n                worldSummary.value = '';\n            }\n        });\n        watch(world, newWorld => {\n            if (newWorld) {\n                selectedEpochId.value = newWorld...ID || availableEpochs.value[0]?.ID || null;\n            }\n        }, { immediate: true });\n        const activeEpoch = computed(() => {\n            if (!world.value || !selectedEpochId.value)\n                return null;\n            return world.value..[selectedEpochId.value] || null;\n        });\n        const Array = computed(() => {\n            if (!activeEpoch.value?.?.)\n                return [];\n            const definitions = activeEpoch.value..;\n            return Object.keys(definitions)\n                .filter(key => key !== '$meta')\n                .map(key => definitions[key])\n                .sort((a, b) => a. - b.);\n        });\n        const showRealmDetails = (realm) => {\n            if (!realm)\n                return;\n            detailModalService.show(realm., RealmDetailCard, { realm });\n        };\n        return (_ctx, _cache) => {\n            return (world.value && activeEpoch.value)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                    _createElementVNode(\"div\", _hoisted_2, [\n                        _createCommentVNode(\"  \"),\n                        _createElementVNode(\"section\", _hoisted_3, [\n                            _cache[4] || (_cache[4] = _createElementVNode(\"h3\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"div\", _hoisted_4, [\n                                _createElementVNode(\"div\", _hoisted_5, [\n                                    _cache[2] || (_cache[2] = _createElementVNode(\"div\", { class: \"rule-name\" }, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"div\", _hoisted_6, _toDisplayString(world.value...), 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_7, [\n                                    _cache[3] || (_cache[3] = _createElementVNode(\"div\", { class: \"rule-name\" }, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"div\", _hoisted_8, _toDisplayString(world.value...), 1 /* TEXT */)\n                                ])\n                            ])\n                        ]),\n                        _createCommentVNode(\"  \"),\n                        _createElementVNode(\"section\", _hoisted_9, [\n                            _cache[5] || (_cache[5] = _createElementVNode(\"h3\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"div\", _hoisted_10, [\n                                _createElementVNode(\"button\", {\n                                    class: _normalizeClass([\"epoch-tab\", { active: activeTab.value === 'details' }]),\n                                    onClick: _cache[0] || (_cache[0] = ($event) => (activeTab.value = 'details'))\n                                }, \"  \", 2 /* CLASS */),\n                                _createElementVNode(\"button\", {\n                                    class: _normalizeClass([\"epoch-tab\", { active: activeTab.value === 'summary' }]),\n                                    onClick: _cache[1] || (_cache[1] = ($event) => (activeTab.value = 'summary'))\n                                }, \"  \", 2 /* CLASS */)\n                            ])\n                        ]),\n                        (activeTab.value === 'summary')\n                            ? (_openBlock(), _createElementBlock(\"div\", {\n                                key: 0,\n                                class: \"summary-content\",\n                                innerHTML: worldSummary.value\n                            }, null, 8 /* PROPS */, _hoisted_11))\n                            : _createCommentVNode(\"v-if\", true),\n                        (activeTab.value === 'details' && activeEpoch.value)\n                            ? (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                                _createCommentVNode(\"  \"),\n                                _createElementVNode(\"section\", _hoisted_12, [\n                                    _createElementVNode(\"div\", _hoisted_13, [\n                                        _createElementVNode(\"h3\", _hoisted_14, \": \" + _toDisplayString(activeEpoch.value.), 1 /* TEXT */),\n                                        _createElementVNode(\"p\", _hoisted_15, _toDisplayString(activeEpoch.value.), 1 /* TEXT */)\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_16, [\n                                        _createElementVNode(\"div\", _hoisted_17, [\n                                            _cache[6] || (_cache[6] = _createElementVNode(\"div\", { class: \"rule-name\" }, \"\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_18, _toDisplayString(activeEpoch.value..), 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_19, [\n                                            _cache[7] || (_cache[7] = _createElementVNode(\"div\", { class: \"rule-name\" }, \"\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_20, _toDisplayString(activeEpoch.value..) + \"x\", 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_21, [\n                                            _cache[8] || (_cache[8] = _createElementVNode(\"div\", { class: \"rule-name\" }, \"\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_22, _toDisplayString(activeEpoch.value..) + \"%\", 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_23, [\n                                            _cache[9] || (_cache[9] = _createElementVNode(\"div\", { class: \"rule-name\" }, \"\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_24, _toDisplayString(activeEpoch.value...), 1 /* TEXT */)\n                                        ])\n                                    ])\n                                ]),\n                                _createCommentVNode(\"  \"),\n                                _createElementVNode(\"section\", _hoisted_25, [\n                                    _cache[11] || (_cache[11] = _createElementVNode(\"h3\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"p\", _hoisted_26, _toDisplayString(activeEpoch.value..), 1 /* TEXT */),\n                                    _createElementVNode(\"div\", _hoisted_27, [\n                                        _cache[10] || (_cache[10] = _createElementVNode(\"h4\", { class: \"subsection-title\" }, \"\", -1 /* CACHED */)),\n                                        _createElementVNode(\"div\", _hoisted_28, [\n                                            _createElementVNode(\"ul\", _hoisted_29, [\n                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(Array.value, (level) => {\n                                                    return (_openBlock(), _createElementBlock(\"li\", {\n                                                        key: level.,\n                                                        class: \"ladder-step\",\n                                                        onClick: ($event) => (showRealmDetails(level))\n                                                    }, [\n                                                        _createElementVNode(\"span\", _hoisted_31, \" \" + _toDisplayString(level.), 1 /* TEXT */),\n                                                        _createElementVNode(\"span\", _hoisted_32, _toDisplayString(level.), 1 /* TEXT */)\n                                                    ], 8 /* PROPS */, _hoisted_30));\n                                                }), 128 /* KEYED_FRAGMENT */))\n                                            ])\n                                        ])\n                                    ])\n                                ])\n                            ], 64 /* STABLE_FRAGMENT */))\n                            : _createCommentVNode(\"v-if\", true)\n                    ])\n                ]))\n                : (_openBlock(), _createElementBlock(\"div\", _hoisted_33, \"...\"));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./WorldDetailsPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./WorldDetailsPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./WorldDetailsPanel.vue?vue&type=style&index=0&id=7a84edf6&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7a84edf6\"]])\n\nexport default __exports__","import * as d3 from 'd3';\n\n/**\n * @file ColorService.ts\n * @description \n */\nclass ColorService {\n  private colorCache: Map<string, string> = new Map();\n  private colorScale = d3.scaleOrdinal(d3.schemeCategory10);\n\n  /**\n   * \n   * @param str - \n   * @returns - \n   */\n  private simpleHash(str: string): number {\n    let hash = 0;\n    for (let i = 0; i < str.length; i++) {\n      const char = str.charCodeAt(i);\n      hash = (hash << 5) - hash + char;\n      hash |= 0; // Convert to 32bit integer\n    }\n    return Math.abs(hash);\n  }\n\n  /**\n   * \n   * @param type - \n   * @returns - \n   */\n  public getColor(type: string): string {\n    if (this.colorCache.has(type)) {\n      return this.colorCache.get(type)!;\n    }\n\n    // \n    // d3.schemeCategory10  10 \n    // \n    const hash = this.simpleHash(type);\n    const color = this.colorScale(String(hash % 10));\n\n    this.colorCache.set(type, color);\n    return color;\n  }\n}\n\nexport const colorService = new ColorService();\n","import * as d3 from 'd3';\nimport type { MapNode, RelativeCoordinate } from '../types';\n\n/**\n * @file CoordinateService.ts\n * @description V7.2 - 2D\n *\n * @:\n * 1.  \"['', 15]\"\n * 2. km, AU, \n * 3.  (x, y)\n */\nclass CoordinateService {\n  private baseAngleMap: Map<string, number>;\n\n  constructor() {\n    //  (Y, X)\n    // SVG/Canvas : X, Y\n    // 0(0) -> \n    // 90(PI/2) -> \n    // 180(PI) -> \n    // 270(-PI/2) -> \n    this.baseAngleMap = new Map([\n      ['', 0],\n      ['E', 0],\n      ['', Math.PI / 4],\n      ['SE', Math.PI / 4],\n      ['', Math.PI / 2],\n      ['S', Math.PI / 2],\n      ['', (Math.PI * 3) / 4],\n      ['SW', (Math.PI * 3) / 4],\n      ['', Math.PI],\n      ['W', Math.PI],\n      ['', (Math.PI * 5) / 4],\n      ['NW', (Math.PI * 5) / 4],\n      ['', (Math.PI * 3) / 2],\n      ['N', (Math.PI * 3) / 2],\n      ['', (Math.PI * 7) / 4],\n      ['NE', (Math.PI * 7) / 4],\n      ['', 0],\n      ['C', 0],\n      ['', -Math.PI / 2],\n      ['Up', -Math.PI / 2],\n      ['', Math.PI / 2],\n      ['Down', Math.PI / 2],\n    ]);\n  }\n\n  /**\n   * \n   * @param -  \"['', 15]\"  \"['', -10]\"\n   * @returns \n   */\n  private parseAzimuth(azimuthValue: string | (string | number)[]): number | null {\n    try {\n      let baseDirection: string;\n      let offsetDegrees = 0;\n\n      if (Array.isArray(azimuthValue)) {\n        baseDirection = String(azimuthValue[0]).trim();\n        offsetDegrees = azimuthValue.length > 1 ? Number(azimuthValue[1]) : 0;\n      } else if (typeof azimuthValue === 'string') {\n        // Handle cases like \"['', 10]\" or just \"\"\n        const cleanedValue = azimuthValue.replace(/[[\\]'\"]/g, '').trim();\n        const parts = cleanedValue.split(',');\n        baseDirection = parts[0].trim();\n        offsetDegrees = parts.length > 1 ? Number(parts[1]) : 0;\n      } else {\n        console.warn('[CoordinateService] :', azimuthValue);\n        return null;\n      }\n\n      if (!baseDirection) {\n        console.warn('[CoordinateService] :', azimuthValue);\n        return null;\n      }\n\n      if (isNaN(offsetDegrees)) {\n        console.warn(`[CoordinateService] :`, azimuthValue);\n        // \n        const baseAngle = this.baseAngleMap.get(baseDirection);\n        return baseAngle !== undefined ? baseAngle : null;\n      }\n\n      const baseAngle = this.baseAngleMap.get(baseDirection);\n\n      if (baseAngle === undefined) {\n        console.warn(`[CoordinateService] : '${baseDirection}'`);\n        return null;\n      }\n\n      const offsetRadians = (offsetDegrees * Math.PI) / 180;\n      return baseAngle + offsetRadians;\n    } catch (error) {\n      console.error(`[CoordinateService] :`, { value: azimuthValue, error });\n      return null;\n    }\n  }\n\n  /**\n   * \n   * \n   * @param distance -  [100, \"km\"]\n   * @returns \n   */\n  private normalizeDistance(distance: [number | string, string]): number {\n    // \n    const value = Number(distance[0]);\n    const unit = distance[1];\n\n    if (isNaN(value)) {\n      return 0;\n    }\n\n    switch (unit.toLowerCase()) {\n      case 'km':\n        return value;\n      case 'au': // \n        return value * 149597870.7; // km\n      case '':\n        return value * 9460730472580.8; // km\n      default:\n        return value; // km\n    }\n  }\n\n  /**\n   * \n   * @param parentNode -  x, y \n   * @param relativeCoord - \n   * @param scaleFactor - \n   * @returns  { x, y }  null\n   */\n  public getCartesianCoordinates(\n    parentNode: MapNode,\n    relativeCoord: RelativeCoordinate,\n  ): { x: number; y: number } | null {\n    if (parentNode.x === undefined || parentNode.y === undefined || !relativeCoord) {\n      return null;\n    }\n\n    const azimuth = this.parseAzimuth(relativeCoord. as string | [string, number]);\n    if (azimuth === null) {\n      return null;\n    }\n\n    // \n    // \n    let baseDirection = '';\n    if (Array.isArray(relativeCoord.)) {\n      baseDirection = String(relativeCoord.[0]);\n    } else if (typeof relativeCoord. === 'string') {\n      const matches = relativeCoord..match(/'[^']*'|\"[^\"]*\"|[^,\\s]+/g);\n      if (matches && matches.length > 0) {\n        baseDirection = matches[0].replace(/['\"[\\]]/g, '').trim();\n      }\n    }\n\n    if (baseDirection === '' || baseDirection.toUpperCase() === 'C') {\n      return { x: parentNode.x, y: parentNode.y };\n    }\n\n    const theoreticalDistance = this.normalizeDistance(relativeCoord.);\n\n    const childX = parentNode.x + theoreticalDistance * Math.cos(azimuth);\n    const childY = parentNode.y + theoreticalDistance * Math.sin(azimuth);\n\n    return { x: childX, y: childY };\n  }\n  /**\n   * \n   * \n   * @param parent - \n   * @param children - \n   */\n  public calculateRelativePositions(parent: MapNode, children: MapNode[]): void {\n    if (!children || children.length === 0) {\n      return;\n    }\n\n    const allDistances = children\n      .map(child => (child.data. ? this.normalizeDistance(child.data..) : 0))\n      .filter(d => d > 0);\n\n    let distanceScale: d3.ScaleLinear<number, number>;\n    const visualMin = 150;\n    const visualMax = 400;\n\n    if (allDistances.length > 0) {\n      const min = Math.min(...allDistances);\n      const max = Math.max(...allDistances);\n      distanceScale = d3.scaleLinear().domain([min, max]).range([visualMin, visualMax]).clamp(true);\n    } else {\n      // \n      distanceScale = d3.scaleLinear().domain([0, 1]).range([visualMin, visualMin]);\n    }\n\n    children.forEach(child => {\n      const coord = child.data.;\n      if (!coord) {\n        child.x = parent.x;\n        child.y = parent.y;\n        return;\n      }\n\n      const isOverlapping = coord..includes('') && this.normalizeDistance(coord.) === 0;\n      const isVertical = coord..includes('') || coord..includes('');\n\n      if (isOverlapping || isVertical) {\n        child.x = parent.x;\n        child.y = parent.y;\n        if (isVertical) {\n          const azimuth = this.parseAzimuth(coord. as string | [string, number]);\n          if (azimuth !== null) {\n            const visualDistance = distanceScale(this.normalizeDistance(coord.));\n            child.y = (child.y ?? 0) + visualDistance * Math.sin(azimuth);\n          }\n        }\n        return;\n      }\n\n      const azimuth = this.parseAzimuth(coord. as string | [string, number]);\n      if (azimuth === null) {\n        child.x = parent.x;\n        child.y = parent.y;\n        return;\n      }\n\n      const theoreticalDistance = this.normalizeDistance(coord.);\n      const visualDistance = distanceScale(theoreticalDistance);\n\n      child.x = parent.x! + visualDistance * Math.cos(azimuth);\n      child.y = parent.y! + visualDistance * Math.sin(azimuth);\n    });\n  }\n}\n\nexport const coordinateService = new CoordinateService();\n","import type { SpatialEntity, WorldDefinition, Epoch } from '../../../types/world';\nimport type { MapHierarchy, MapNode } from '../types';\n\n/**\n * @file WorldMapDataService.ts\n * @description V8.0 - \n *\n * @:\n * 1.  ``  ``\n * 2.  ``  \"WORLD_ORIGIN\"  (`MapHierarchy`)\n * 3.  (`childCount`)\n * 4. UI\n */\nclass WorldMapDataService {\n  private hierarchyCache: MapHierarchy | null = null;\n\n  /**\n   * \n   * @param worldData -  lorebook \n   * @param epochId - ID\n   * @returns -  \"WORLD_ORIGIN\" \n   */\n  public getMapHierarchy(epoch: Epoch | null): MapHierarchy | null {\n    if (!epoch) return null;\n\n    const cacheKey = epoch.ID;\n    if (this.hierarchyCache && (this.hierarchyCache as any).cacheKey === cacheKey) {\n      return this.hierarchyCache;\n    }\n\n    const spatialEntities = epoch.?.;\n\n    if (!spatialEntities || Object.keys(spatialEntities).length === 0) {\n      console.warn(`WorldMapDataService:  \"${epoch.}\"  \"\" `);\n      return null;\n    }\n\n    //  Object.keys  for...in  Object.values\n    const entitiesArray: SpatialEntity[] = [];\n    for (const key in spatialEntities) {\n      if (key !== '$meta' && Object.prototype.hasOwnProperty.call(spatialEntities, key)) {\n        entitiesArray.push({ ...(spatialEntities as any)[key], ID: key });\n      }\n    }\n\n    const hierarchy = this.buildHierarchy(entitiesArray);\n    (hierarchy as any).cacheKey = cacheKey; // Attach cache key\n    this.hierarchyCache = hierarchy;\n    return this.hierarchyCache;\n  }\n\n  /**\n   * \n   */\n  public clearCache(): void {\n    this.hierarchyCache = null;\n  }\n\n  /**\n   * \n   * @param entities - \n   * @returns - \n   */\n  private buildHierarchy(entities: SpatialEntity[]): MapHierarchy {\n    const nodeMap = new Map<string, MapNode>();\n    const rootNodes: MapNode[] = [];\n\n    // 1. \n    entities.forEach(entity => {\n      nodeMap.set(entity.ID, {\n        id: entity.ID,\n        name: entity.,\n        type: entity.,\n        parentId: entity.?.ID,\n        children: [],\n        childCount: 0, // \n        radius: 10,\n        data: entity,\n      });\n    });\n\n    // 2. \n    for (const node of nodeMap.values()) {\n      // A node is a root node if it has no parentId, its parentId is 'WORLD_ORIGIN',\n      // or its parent is not found in the map (it's an orphan, treat as root).\n      const parent = node.parentId ? nodeMap.get(node.parentId) : null;\n      if (parent) {\n        parent.children.push(node);\n      } else {\n        rootNodes.push(node);\n      }\n    }\n\n    // 3. \n    for (const node of nodeMap.values()) {\n      node.childCount = node.children.length;\n    }\n\n    // 4. \n    const worldOrigin: MapNode = {\n      id: 'WORLD_ORIGIN',\n      name: '',\n      type: 'Origin',\n      parentId: null,\n      children: rootNodes,\n      childCount: rootNodes.length,\n      radius: 0,\n      data: {} as any,\n    };\n\n    return worldOrigin;\n  }\n}\n\nexport const worldMapDataService = new WorldMapDataService();\n","import { reactive, readonly } from 'vue';\nimport type { WorldDefinition } from '../../../types/world';\nimport type { MapNode } from '../types';\n\ninterface NavigationCrumb {\n  id: string;\n  name: string;\n}\n\ninterface MapState {\n  currentRootId: string;\n  navigationPath: NavigationCrumb[];\n  selectedNode: MapNode | null;\n  isDetailPanelVisible: boolean;\n  worldData: WorldDefinition | null;\n  userLocationId: string | null;\n  avatarLocationId: string | null;\n}\n\nconst state = reactive<MapState>({\n  currentRootId: 'WORLD_ORIGIN',\n  navigationPath: [{ id: 'WORLD_ORIGIN', name: '' }],\n  selectedNode: null,\n  isDetailPanelVisible: false,\n  worldData: null,\n  userLocationId: null,\n  avatarLocationId: null,\n});\n\nconst actions = {\n  /**\n   * \n   * @param node - \n   */\n  navigateToNode(node: MapNode): void {\n    state.currentRootId = node.id;\n    // \n    if (!state.navigationPath.find(crumb => crumb.id === node.id)) {\n      state.navigationPath.push({ id: node.id, name: node.name });\n    }\n  },\n\n  /**\n   * \n   * @param targetId - ID\n   */\n  navigateBack(targetId: string): void {\n    const targetIndex = state.navigationPath.findIndex(crumb => crumb.id === targetId);\n    if (targetIndex > -1) {\n      state.currentRootId = targetId;\n      state.navigationPath.splice(targetIndex + 1);\n    }\n  },\n\n  /**\n   * \n   * @param node - \n   */\n  selectNode(node: MapNode): void {\n    state.selectedNode = node;\n    state.isDetailPanelVisible = true;\n  },\n\n  /**\n   * \n   */\n  hideDetail(): void {\n    state.selectedNode = null;\n    state.isDetailPanelVisible = false;\n  },\n\n  /**\n   * \n   * @param path - \n   */\n  setNavigationPath(path: NavigationCrumb[]): void {\n    state.navigationPath = path;\n  },\n\n  /**\n   * \n   * @param data -  Lorebook \n   */\n  setWorldData(data: WorldDefinition): void {\n    state.worldData = data;\n  },\n\n  /**\n   * ID\n   * @param locations -  user  avatar ID\n   */\n  setPlayerLocations(locations: { user: string | null; avatar: string | null }): void {\n    state.userLocationId = locations.user;\n    state.avatarLocationId = locations.avatar;\n  },\n};\n\nexport const mapState = readonly(state);\nexport const mapActions = actions;\n","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = { class: \"map-navigator\" };\nconst _hoisted_2 = [\"onClick\"];\nconst _hoisted_3 = {\n    key: 0,\n    class: \"separator\"\n};\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'MapNavigator',\n    props: {\n        path: {\n            type: Array,\n            required: true,\n        },\n    },\n    emits: ['navigate'],\n    setup(__props, { emit: __emit }) {\n        const emit = __emit;\n        const onCrumbClick = (nodeId) => {\n            emit('navigate', nodeId);\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.path, (crumb, index) => {\n                    return (_openBlock(), _createElementBlock(\"span\", {\n                        key: crumb.id,\n                        class: \"crumb\",\n                        onClick: ($event) => (onCrumbClick(crumb.id))\n                    }, [\n                        _createTextVNode(_toDisplayString(crumb.name) + \" \", 1 /* TEXT */),\n                        (index < __props.path.length - 1)\n                            ? (_openBlock(), _createElementBlock(\"span\", _hoisted_3, \" > \"))\n                            : _createCommentVNode(\"v-if\", true)\n                    ], 8 /* PROPS */, _hoisted_2));\n                }), 128 /* KEYED_FRAGMENT */))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./MapNavigator.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MapNavigator.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MapNavigator.vue?vue&type=style&index=0&id=26d44248&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-26d44248\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment, normalizeClass as _normalizeClass, createStaticVNode as _createStaticVNode } from \"vue\";\nconst _hoisted_1 = { class: \"panel-header\" };\nconst _hoisted_2 = { class: \"panel-content\" };\nconst _hoisted_3 = { key: 0 };\nconst _hoisted_4 = { class: \"section\" };\nconst _hoisted_5 = { key: 0 };\nconst _hoisted_6 = {\n    key: 0,\n    class: \"section\"\n};\nconst _hoisted_7 = {\n    key: 1,\n    class: \"section\"\n};\nconst _hoisted_8 = { class: \"section-title\" };\nconst _hoisted_9 = { class: \"item-list\" };\nconst _hoisted_10 = [\"onClick\"];\nconst _hoisted_11 = {\n    key: 2,\n    class: \"section\"\n};\nconst _hoisted_12 = { class: \"item-list\" };\nconst _hoisted_13 = {\n    key: 3,\n    class: \"section\"\n};\nconst _hoisted_14 = { class: \"item-list\" };\nconst _hoisted_15 = { key: 1 };\nimport { computed, onMounted, ref } from 'vue';\nimport { mapActions, mapState } from '../store/mapState';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NodeDetailPanel',\n    props: {\n        node: {\n            type: Object,\n            default: null,\n        },\n    },\n    emits: ['close'],\n    setup(__props) {\n        const props = __props;\n        const onNavigate = (node) => {\n            if (node.childCount > 0) {\n                mapActions.navigateToNode(node);\n            }\n        };\n        const children = computed(() => {\n            return props.node?.children || [];\n        });\n        const associatedResources = computed(() => {\n            if (!props.node || !mapState.worldData?.?.) {\n                return [];\n            }\n            const resources = mapState.worldData..;\n            // \n            const resourcesArray = Array.isArray(resources) ? resources : [];\n            return resourcesArray.filter((resource) => resource.ID === props.node?.id);\n        });\n        const associatedFactions = computed(() => {\n            // @TODO: \n            if (!props.node || !mapState.worldData?.?.?.) {\n                return [];\n            }\n            const factionsSource = mapState.worldData...;\n            // \n            const factionsArray = Array.isArray(factionsSource) ? factionsSource : Object.values(factionsSource);\n            // \n            const filtered = factionsArray.filter(faction => {\n                // faction\n                if (!faction || typeof faction !== 'object')\n                    return false;\n                const factionDataString = JSON.stringify(faction);\n                return factionDataString.includes(props.node.name);\n            });\n            return filtered;\n        });\n        const panelRef = ref(null);\n        onMounted(() => {\n            const panel = panelRef.value;\n            if (!panel)\n                return;\n            const header = panel.querySelector('.panel-header');\n            // ---  ---\n            header.addEventListener('mousedown', (e) => {\n                let isDragging = true;\n                const startX = e.clientX;\n                const startY = e.clientY;\n                const startLeft = panel.offsetLeft;\n                const startTop = panel.offsetTop;\n                const onDragMove = (moveEvent) => {\n                    if (!isDragging)\n                        return;\n                    const dx = moveEvent.clientX - startX;\n                    const dy = moveEvent.clientY - startY;\n                    panel.style.left = `${startLeft + dx}px`;\n                    panel.style.top = `${startTop + dy}px`;\n                };\n                const onDragEnd = () => {\n                    isDragging = false;\n                    document.removeEventListener('mousemove', onDragMove);\n                    document.removeEventListener('mouseup', onDragEnd);\n                };\n                document.addEventListener('mousemove', onDragMove);\n                document.addEventListener('mouseup', onDragEnd);\n            });\n            // ---  ---\n            const handles = panel.querySelectorAll('.resize-handle');\n            handles.forEach(handle => {\n                handle.addEventListener('mousedown', (e) => {\n                    e.stopPropagation();\n                    const direction = handle.dataset.direction;\n                    if (!direction)\n                        return;\n                    let isResizing = true;\n                    const startX = e.clientX;\n                    const startY = e.clientY;\n                    const startWidth = panel.offsetWidth;\n                    const startHeight = panel.offsetHeight;\n                    const startLeft = panel.offsetLeft;\n                    const startTop = panel.offsetTop;\n                    const onResizeMove = (moveEvent) => {\n                        if (!isResizing)\n                            return;\n                        const dx = moveEvent.clientX - startX;\n                        const dy = moveEvent.clientY - startY;\n                        if (direction.includes('right')) {\n                            panel.style.width = `${startWidth + dx}px`;\n                        }\n                        if (direction.includes('bottom')) {\n                            panel.style.height = `${startHeight + dy}px`;\n                        }\n                        if (direction.includes('left')) {\n                            panel.style.width = `${startWidth - dx}px`;\n                            panel.style.left = `${startLeft + dx}px`;\n                        }\n                        if (direction.includes('top')) {\n                            panel.style.height = `${startHeight - dy}px`;\n                            panel.style.top = `${startTop + dy}px`;\n                        }\n                    };\n                    const onResizeEnd = () => {\n                        isResizing = false;\n                        document.removeEventListener('mousemove', onResizeMove);\n                        document.removeEventListener('mouseup', onResizeEnd);\n                    };\n                    document.addEventListener('mousemove', onResizeMove);\n                    document.addEventListener('mouseup', onResizeEnd);\n                });\n            });\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n                class: \"node-detail-panel\",\n                ref_key: \"panelRef\",\n                ref: panelRef\n            }, [\n                _createElementVNode(\"div\", _hoisted_1, [\n                    _createElementVNode(\"h3\", null, _toDisplayString(__props.node?.name || ''), 1 /* TEXT */),\n                    _createElementVNode(\"button\", {\n                        class: \"close-btn\",\n                        onClick: _cache[0] || (_cache[0] = ($event) => (_ctx.$emit('close')))\n                    }, \"\")\n                ]),\n                _createElementVNode(\"div\", _hoisted_2, [\n                    (__props.node)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                            _createCommentVNode(\"  \"),\n                            _createElementVNode(\"div\", _hoisted_4, [\n                                _createElementVNode(\"p\", null, [\n                                    _cache[1] || (_cache[1] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                    _createTextVNode(\" \" + _toDisplayString(__props.node.type), 1 /* TEXT */)\n                                ]),\n                                (__props.node.data.)\n                                    ? (_openBlock(), _createElementBlock(\"p\", _hoisted_5, [\n                                        _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                        _createTextVNode(\" \" + _toDisplayString(__props.node.data.[0]) + \" \" + _toDisplayString(__props.node.data.[1]), 1 /* TEXT */)\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ]),\n                            _createCommentVNode(\"  \"),\n                            (__props.node.data.)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [\n                                    _cache[3] || (_cache[3] = _createElementVNode(\"h4\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"pre\", null, _toDisplayString(__props.node.data.), 1 /* TEXT */)\n                                ]))\n                                : _createCommentVNode(\"v-if\", true),\n                            _createCommentVNode(\"  \"),\n                            (children.value.length > 0)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [\n                                    _createElementVNode(\"h4\", _hoisted_8, \" (\" + _toDisplayString(children.value.length) + \")\", 1 /* TEXT */),\n                                    _createElementVNode(\"ul\", _hoisted_9, [\n                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(children.value, (child) => {\n                                            return (_openBlock(), _createElementBlock(\"li\", {\n                                                key: child.id,\n                                                class: \"interactive list-item\",\n                                                onClick: ($event) => (onNavigate(child))\n                                            }, _toDisplayString(child.name) + \" (\" + _toDisplayString(child.type) + \") \", 9 /* TEXT, PROPS */, _hoisted_10));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                    ])\n                                ]))\n                                : _createCommentVNode(\"v-if\", true),\n                            _createCommentVNode(\"  \"),\n                            (associatedResources.value.length > 0)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [\n                                    _cache[4] || (_cache[4] = _createElementVNode(\"h4\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"ul\", _hoisted_12, [\n                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(associatedResources.value, (resource) => {\n                                            return (_openBlock(), _createElementBlock(\"li\", {\n                                                key: resource.ID,\n                                                class: \"list-item\"\n                                            }, [\n                                                _createTextVNode(_toDisplayString(resource.) + \" \", 1 /* TEXT */),\n                                                _createElementVNode(\"span\", {\n                                                    class: _normalizeClass([\"rarity\", `rarity-${resource.}`])\n                                                }, \"[\" + _toDisplayString(resource.) + \"]\", 3 /* TEXT, CLASS */)\n                                            ]));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                    ])\n                                ]))\n                                : _createCommentVNode(\"v-if\", true),\n                            _createCommentVNode(\"  () \"),\n                            (associatedFactions.value.length > 0)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_13, [\n                                    _cache[5] || (_cache[5] = _createElementVNode(\"h4\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"ul\", _hoisted_14, [\n                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(associatedFactions.value, (faction) => {\n                                            return (_openBlock(), _createElementBlock(\"li\", {\n                                                key: faction.ID,\n                                                class: \"list-item\"\n                                            }, _toDisplayString(faction.) + \" (\" + _toDisplayString(faction.) + \") \", 1 /* TEXT */));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                    ])\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_15, [...(_cache[6] || (_cache[6] = [\n                                _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                            ]))]))\n                ]),\n                _cache[7] || (_cache[7] = _createStaticVNode(\"<div class=\\\"resize-handle top\\\" data-direction=\\\"top\\\" data-v-49dd35d2></div><div class=\\\"resize-handle right\\\" data-direction=\\\"right\\\" data-v-49dd35d2></div><div class=\\\"resize-handle bottom\\\" data-direction=\\\"bottom\\\" data-v-49dd35d2></div><div class=\\\"resize-handle left\\\" data-direction=\\\"left\\\" data-v-49dd35d2></div><div class=\\\"resize-handle top-left\\\" data-direction=\\\"top-left\\\" data-v-49dd35d2></div><div class=\\\"resize-handle top-right\\\" data-direction=\\\"top-right\\\" data-v-49dd35d2></div><div class=\\\"resize-handle bottom-left\\\" data-direction=\\\"bottom-left\\\" data-v-49dd35d2></div><div class=\\\"resize-handle bottom-right\\\" data-direction=\\\"bottom-right\\\" data-v-49dd35d2></div>\", 8))\n            ], 512 /* NEED_PATCH */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NodeDetailPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NodeDetailPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NodeDetailPanel.vue?vue&type=style&index=0&id=49dd35d2&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-49dd35d2\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createVNode as _createVNode, createElementVNode as _createElementVNode, vModelText as _vModelText, withKeys as _withKeys, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, unref as _unref, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = { class: \"world-map-view\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"search-panel\"\n};\nconst _hoisted_3 = {\n    key: 0,\n    class: \"search-results\"\n};\nconst _hoisted_4 = [\"onClick\"];\nimport * as d3 from 'd3';\nimport { computed, nextTick, onActivated, onMounted, onUnmounted, ref, watch } from 'vue';\nimport { lorebookService } from '../../../services/LorebookService';\nimport { store } from '../../../store';\nimport { colorService } from '../services/ColorService';\nimport { coordinateService } from '../services/CoordinateService';\nimport { worldMapDataService } from '../services/WorldMapDataService';\nimport { mapActions, mapState } from '../store/mapState';\nimport MapNavigator from './MapNavigator.vue';\nimport NodeDetailPanel from './NodeDetailPanel.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'AvatarWorldMapView',\n    setup(__props) {\n        const svgRef = ref(null);\n        const fullHierarchy = ref(null);\n        const layoutNodes = ref([]);\n        const layoutLinks = ref([]);\n        const searchText = ref('');\n        const stars = ref([]);\n        const isSearchPanelVisible = ref(false);\n        //  store \n        const navigationPath = computed(() => mapState.navigationPath);\n        const isDetailPanelVisible = computed(() => mapState.isDetailPanelVisible);\n        const selectedNode = computed(() => mapState.selectedNode);\n        const currentRootId = computed(() => mapState.currentRootId);\n        // \n        const findNode = (node, id) => {\n            if (node.id === id)\n                return node;\n            for (const child of node.children) {\n                const found = findNode(child, id);\n                if (found)\n                    return found;\n            }\n            return null;\n        };\n        const currentRootNode = computed(() => {\n            if (!fullHierarchy.value)\n                return null;\n            return findNode(fullHierarchy.value, currentRootId.value);\n        });\n        const allNodes = computed(() => {\n            const nodes = [];\n            function traverse(node) {\n                nodes.push(node);\n                node.children.forEach(traverse);\n            }\n            if (fullHierarchy.value) {\n                traverse(fullHierarchy.value);\n            }\n            return nodes;\n        });\n        const searchResults = computed(() => {\n            if (!searchText.value)\n                return [];\n            return allNodes.value.filter(node => node.name.toLowerCase().includes(searchText.value.toLowerCase())).slice(0, 10); // 10\n        });\n        const getFullPath = (node) => {\n            const path = [];\n            let current = node;\n            while (current && current.id !== 'WORLD_ORIGIN') {\n                path.unshift(current.name);\n                current = allNodes.value.find(n => n.id === current.parentId);\n            }\n            return path.join(' > ');\n        };\n        const jumpToNode = (node) => {\n            const path = [];\n            let current = node;\n            while (current && current.parentId && current.id !== 'WORLD_ORIGIN') {\n                path.unshift(current);\n                current = allNodes.value.find(n => n.id === current.parentId);\n            }\n            if (current) {\n                path.unshift(current);\n            }\n            const newNavPath = path.map(p => ({ id: p.id, name: p.name }));\n            mapActions.setNavigationPath(newNavPath);\n            if (node.parentId) {\n                mapActions.navigateBack(node.parentId);\n            }\n            else {\n                mapActions.navigateBack('WORLD_ORIGIN');\n            }\n            searchText.value = '';\n        };\n        const jumpToFirstResult = () => {\n            if (searchResults.value.length > 0) {\n                jumpToNode(searchResults.value[0]);\n            }\n        };\n        const searchBtnRef = ref(null);\n        const initDraggableSearchBtn = () => {\n            const btn = searchBtnRef.value;\n            if (!btn)\n                return;\n            let isDragging = false;\n            let offsetX = 0, offsetY = 0;\n            const onMouseMove = (e) => {\n                if (!isDragging)\n                    return;\n                const container = btn.parentElement;\n                if (!container)\n                    return;\n                let x = e.clientX - offsetX;\n                let y = e.clientY - offsetY;\n                // \n                const containerRect = container.getBoundingClientRect();\n                x = Math.max(0, Math.min(x, containerRect.width - btn.offsetWidth));\n                y = Math.max(0, Math.min(y, containerRect.height - btn.offsetHeight));\n                btn.style.left = `${x}px`;\n                btn.style.top = `${y}px`;\n            };\n            const onMouseUp = () => {\n                if (!isDragging)\n                    return;\n                isDragging = false;\n                document.removeEventListener('mousemove', onMouseMove);\n                document.removeEventListener('mouseup', onMouseUp);\n                const containerRect = btn.parentElement.getBoundingClientRect();\n                const rect = btn.getBoundingClientRect();\n                const threshold = 50;\n                if (rect.left - containerRect.left < threshold) {\n                    btn.style.left = '10px';\n                }\n                else if (containerRect.right - rect.right < threshold) {\n                    btn.style.left = `${containerRect.width - rect.width - 10}px`;\n                }\n                if (rect.top - containerRect.top < threshold) {\n                    btn.style.top = '10px';\n                }\n                else if (containerRect.bottom - rect.bottom < threshold) {\n                    btn.style.top = `${containerRect.height - rect.height - 10}px`;\n                }\n            };\n            btn.onmousedown = e => {\n                isDragging = true;\n                offsetX = e.clientX - btn.offsetLeft;\n                offsetY = e.clientY - btn.offsetTop;\n                document.addEventListener('mousemove', onMouseMove);\n                document.addEventListener('mouseup', onMouseUp);\n            };\n        };\n        const visibleNodes = computed(() => {\n            return currentRootNode.value ? currentRootNode.value.children : [];\n        });\n        // \n        watch(currentRootNode, newRoot => {\n            if (newRoot && svgRef.value) {\n                // \n                const rootCopy = JSON.parse(JSON.stringify(newRoot));\n                const { width, height } = svgRef.value.getBoundingClientRect();\n                let nodesToRender = [];\n                let links = [];\n                let visualCenterNode = null;\n                if (rootCopy.id === 'WORLD_ORIGIN') {\n                    visualCenterNode = rootCopy.children[0];\n                    if (visualCenterNode) {\n                        visualCenterNode.x = width / 2;\n                        visualCenterNode.y = height / 2;\n                        coordinateService.calculateRelativePositions(visualCenterNode, rootCopy.children);\n                    }\n                    nodesToRender = rootCopy.children;\n                    links = rootCopy.children\n                        .slice(1)\n                        .map((child) => ({ source: visualCenterNode, target: child }));\n                }\n                else {\n                    visualCenterNode = rootCopy;\n                    rootCopy.x = width / 2;\n                    rootCopy.y = height / 2;\n                    coordinateService.calculateRelativePositions(rootCopy, rootCopy.children);\n                    nodesToRender = [rootCopy, ...rootCopy.children];\n                    links = rootCopy.children.map((child) => ({\n                        source: rootCopy,\n                        target: child,\n                    }));\n                }\n                const transform = d3.zoomIdentity;\n                layoutNodes.value = nodesToRender.filter(n => n.id !== 'WORLD_ORIGIN');\n                layoutLinks.value = links;\n                nextTick(() => {\n                    renderD3(layoutNodes.value, layoutLinks.value, transform);\n                });\n            }\n            else {\n                layoutNodes.value = [];\n                layoutLinks.value = [];\n                renderD3([], [], d3.zoomIdentity);\n            }\n        }, { immediate: true });\n        onMounted(async () => {\n            try {\n                const activeEpoch = await lorebookService.loadAndParseWorldData('');\n                if (activeEpoch) {\n                    fullHierarchy.value = worldMapDataService.getMapHierarchy(activeEpoch);\n                }\n                else {\n                    console.error('AvatarWorldMapView: Failed to load or parse avatar world epoch data.');\n                }\n            }\n            catch (error) {\n                console.error('AvatarWorldMapView: Error in onMounted:', error);\n            }\n            // Watch for worldState updates to set player locations\n            watch(() => store.worldState, newState => {\n                if (!newState)\n                    return;\n                const avatarId = newState.?.?.?.ID;\n                const userLocation = newState.?.?. || null;\n                let avatarLocation = null;\n                if (avatarId && newState.) {\n                    for (const world of Object.values(newState.)) {\n                        const foundAvatar = world.?.[avatarId];\n                        if (foundAvatar) {\n                            avatarLocation = foundAvatar. || null;\n                            break;\n                        }\n                    }\n                }\n                mapActions.setPlayerLocations({ user: userLocation, avatar: avatarLocation });\n            }, { immediate: true, deep: true });\n            if (svgRef.value) {\n                const { width, height } = svgRef.value.getBoundingClientRect();\n                const starFieldSize = Math.max(width, height) * 4;\n                stars.value = Array.from({ length: 1000 }, (_, i) => ({\n                    id: i,\n                    x: (Math.random() - 0.5) * starFieldSize + width / 2,\n                    y: (Math.random() - 0.5) * starFieldSize + height / 2,\n                    r: Math.random() * 1.2,\n                    o: Math.random() * 0.8 + 0.2,\n                }));\n                const svg = d3.select(svgRef.value);\n                const zoom = d3\n                    .zoom()\n                    .scaleExtent([0.01, 10])\n                    .on('zoom', event => {\n                    d3.select(svgRef.value).select('g.zoom-container').attr('transform', event.transform);\n                });\n                svg.call(zoom).on('dblclick.zoom', null); // \n            }\n            initDraggableSearchBtn();\n            // \n            const handleClickOutside = (event) => {\n                const searchPanel = document.querySelector('.search-panel');\n                if (searchPanel &&\n                    !searchPanel.contains(event.target) &&\n                    !searchBtnRef.value?.contains(event.target)) {\n                    isSearchPanelVisible.value = false;\n                }\n            };\n            document.addEventListener('click', handleClickOutside, true);\n            onUnmounted(() => {\n                document.removeEventListener('click', handleClickOutside, true);\n            });\n        });\n        onActivated(() => {\n            // \n            if (currentRootNode.value?.id === 'WORLD_ORIGIN') {\n                mapActions.setNavigationPath([]);\n            }\n        });\n        function renderD3(nodes, links, transform) {\n            const clickTimers = new Map();\n            if (!svgRef.value)\n                return;\n            const svg = d3.select(svgRef.value);\n            const zoomContainer = svg.selectAll('g.zoom-container').data([null]);\n            const zoomContainerEnter = zoomContainer.enter().append('g').attr('class', 'zoom-container');\n            const g = zoomContainer.merge(zoomContainerEnter);\n            //  (enter)\n            zoomContainerEnter\n                .append('g')\n                .selectAll('circle.star')\n                .data(stars.value)\n                .join('circle')\n                .attr('class', 'star')\n                .attr('cx', d => d.x)\n                .attr('cy', d => d.y)\n                .attr('r', d => d.r)\n                .attr('fill', 'white')\n                .attr('opacity', d => d.o);\n            const zoom = d3\n                .zoom()\n                .scaleExtent([0.01, 10])\n                .on('zoom', event => {\n                g.attr('transform', event.transform);\n            });\n            svg.call(zoom).on('dblclick.zoom', null);\n            svg\n                .transition()\n                .duration(750)\n                .call(zoom.transform, transform);\n            // ---  ---\n            const t = d3.transition().duration(750);\n            // \n            const visualCenterNode = nodes.find(n => n.id === currentRootId.value) || nodes[0];\n            if (visualCenterNode) {\n                const distances = nodes\n                    .filter(n => n.id !== visualCenterNode.id)\n                    .map(n => {\n                    const dx = (n.x ?? 0) - (visualCenterNode.x ?? 0);\n                    const dy = (n.y ?? 0) - (visualCenterNode.y ?? 0);\n                    return Math.sqrt(dx * dx + dy * dy);\n                })\n                    .filter(d => d > 0);\n                g.selectAll('circle.orbit-line')\n                    .data(distances)\n                    .join(enter => enter\n                    .append('circle')\n                    .attr('class', 'orbit-line')\n                    .attr('cx', visualCenterNode.x ?? 0)\n                    .attr('cy', visualCenterNode.y ?? 0)\n                    .attr('r', 0)\n                    .attr('fill', 'none')\n                    .attr('stroke', 'rgba(255, 255, 255, 0.1)')\n                    .call(enter => enter.transition(t).attr('r', d => d)), update => update.call(update => update\n                    .transition(t)\n                    .attr('cx', visualCenterNode.x ?? 0)\n                    .attr('cy', visualCenterNode.y ?? 0)\n                    .attr('r', d => d)), exit => exit.call(exit => exit.transition(t).attr('r', 0).remove()));\n            }\n            // \n            g.selectAll('line.link')\n                .data(links, (d) => `${d.source.id}-${d.target.id}`)\n                .join(enter => enter\n                .append('line')\n                .attr('class', 'link')\n                .attr('stroke', '#999')\n                .attr('stroke-opacity', 0)\n                .attr('x1', d => d.source.x || 0)\n                .attr('y1', d => d.source.y || 0)\n                .attr('x2', d => d.target.x || 0)\n                .attr('y2', d => d.target.y || 0)\n                .call(enter => enter.transition(t).attr('stroke-opacity', 0.4)), update => update.call(update => update\n                .transition(t)\n                .attr('x1', d => d.source.x || 0)\n                .attr('y1', d => d.source.y || 0)\n                .attr('x2', d => d.target.x || 0)\n                .attr('y2', d => d.target.y || 0)), exit => exit.call(exit => exit.transition(t).attr('stroke-opacity', 0).remove()));\n            // \n            const nodeGroups = g.selectAll('g.node-group').data(nodes, d => d.id);\n            const nodeEnter = nodeGroups\n                .enter()\n                .append('g')\n                .attr('class', 'node-group')\n                .attr('transform', (d) => `translate(${d.x || 0},${d.y || 0})`)\n                .attr('opacity', 0);\n            nodeEnter\n                .append('circle')\n                .attr('r', d => d.radius)\n                .attr('fill', d => colorService.getColor(d.type))\n                .attr('stroke', d => d3.color(colorService.getColor(d.type))?.brighter(1.5).toString() ?? '#fff')\n                .attr('stroke-width', 2);\n            nodeEnter\n                .append('text')\n                .text(d => d.name)\n                .attr('text-anchor', 'middle')\n                .attr('dy', d => d.radius + 15)\n                .attr('fill', 'white')\n                .style('font-size', '12px');\n            nodeGroups\n                .merge(nodeEnter)\n                .on('click', function (event, d) {\n                const existingTimeout = clickTimers.get(d.id);\n                if (existingTimeout) {\n                    clearTimeout(existingTimeout);\n                    clickTimers.delete(d.id);\n                    mapActions.selectNode(d);\n                }\n                else {\n                    const newTimeout = window.setTimeout(() => {\n                        if (d.childCount > 0) {\n                            mapActions.navigateToNode(d);\n                        }\n                        else {\n                            mapActions.selectNode(d);\n                        }\n                        clickTimers.delete(d.id);\n                    }, 250);\n                    clickTimers.set(d.id, newTimeout);\n                }\n            })\n                .transition(t)\n                .attr('transform', (d) => `translate(${d.x || 0},${d.y || 0})`)\n                .attr('opacity', 1);\n            nodeGroups.exit().transition(t).attr('opacity', 0).remove();\n        }\n        const onNavigateBack = (nodeId) => {\n            mapActions.navigateBack(nodeId);\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createVNode(MapNavigator, {\n                    path: navigationPath.value,\n                    onNavigate: onNavigateBack\n                }, null, 8 /* PROPS */, [\"path\"]),\n                _createElementVNode(\"button\", {\n                    ref_key: \"searchBtnRef\",\n                    ref: searchBtnRef,\n                    class: \"search-toggle-btn\",\n                    onClick: _cache[0] || (_cache[0] = ($event) => (isSearchPanelVisible.value = !isSearchPanelVisible.value))\n                }, \"  \", 512 /* NEED_PATCH */),\n                (isSearchPanelVisible.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _withDirectives(_createElementVNode(\"input\", {\n                            type: \"text\",\n                            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event) => ((searchText).value = $event)),\n                            placeholder: \"...\",\n                            onKeyup: _withKeys(jumpToFirstResult, [\"enter\"])\n                        }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                            [_vModelText, searchText.value]\n                        ]),\n                        (searchResults.value.length && searchText.value)\n                            ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_3, [\n                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(searchResults.value, (node) => {\n                                    return (_openBlock(), _createElementBlock(\"li\", {\n                                        key: node.id,\n                                        onClick: ($event) => (jumpToNode(node))\n                                    }, _toDisplayString(getFullPath(node)), 9 /* TEXT, PROPS */, _hoisted_4));\n                                }), 128 /* KEYED_FRAGMENT */))\n                            ]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                (_openBlock(), _createElementBlock(\"svg\", {\n                    ref_key: \"svgRef\",\n                    ref: svgRef,\n                    class: \"map-svg\"\n                }, null, 512 /* NEED_PATCH */)),\n                (isDetailPanelVisible.value)\n                    ? (_openBlock(), _createBlock(NodeDetailPanel, {\n                        key: 1,\n                        node: selectedNode.value,\n                        onClose: _unref(mapActions).hideDetail\n                    }, null, 8 /* PROPS */, [\"node\", \"onClose\"]))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./AvatarWorldMapView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AvatarWorldMapView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./AvatarWorldMapView.vue?vue&type=style&index=0&id=21eaaf4a&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createVNode as _createVNode, createElementVNode as _createElementVNode, vModelText as _vModelText, withKeys as _withKeys, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, unref as _unref, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n    key: 0,\n    class: \"search-panel\"\n};\nconst _hoisted_2 = {\n    key: 0,\n    class: \"search-results\"\n};\nconst _hoisted_3 = [\"onClick\"];\nimport * as d3 from 'd3';\nimport { debounce } from 'lodash';\nimport { computed, nextTick, onActivated, onMounted, onUnmounted, ref, watch } from 'vue';\nimport { store } from '../../../store';\nimport { colorService } from '../services/ColorService';\nimport { coordinateService } from '../services/CoordinateService';\nimport { worldMapDataService } from '../services/WorldMapDataService';\nimport { mapActions, mapState } from '../store/mapState';\nimport MapNavigator from './MapNavigator.vue';\nimport NodeDetailPanel from './NodeDetailPanel.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'WorldMapView',\n    setup(__props) {\n        const svgRef = ref(null);\n        const rootElRef = ref(null);\n        const fullHierarchy = ref(null);\n        const layoutNodes = ref([]);\n        const layoutLinks = ref([]);\n        const searchText = ref('');\n        const stars = ref([]);\n        const isSearchPanelVisible = ref(false);\n        const isStarfieldInitialized = ref(false);\n        const navigationPath = computed(() => mapState.navigationPath);\n        const isDetailPanelVisible = computed(() => mapState.isDetailPanelVisible);\n        const selectedNode = computed(() => mapState.selectedNode);\n        const currentRootId = computed(() => mapState.currentRootId);\n        const findNode = (node, id) => {\n            if (node.id === id)\n                return node;\n            for (const child of node.children) {\n                const found = findNode(child, id);\n                if (found)\n                    return found;\n            }\n            return null;\n        };\n        const currentRootNode = computed(() => {\n            if (!fullHierarchy.value)\n                return null;\n            return findNode(fullHierarchy.value, currentRootId.value);\n        });\n        const allNodes = computed(() => {\n            const nodes = [];\n            function traverse(node) {\n                nodes.push(node);\n                node.children.forEach(traverse);\n            }\n            if (fullHierarchy.value) {\n                traverse(fullHierarchy.value);\n            }\n            return nodes;\n        });\n        const searchResults = computed(() => {\n            if (!searchText.value)\n                return [];\n            return allNodes.value.filter(node => node.name.toLowerCase().includes(searchText.value.toLowerCase())).slice(0, 10);\n        });\n        const getFullPath = (node) => {\n            const path = [];\n            let current = node;\n            while (current && current.id !== 'WORLD_ORIGIN') {\n                path.unshift(current.name);\n                current = allNodes.value.find(n => n.id === current.parentId);\n            }\n            return path.join(' > ');\n        };\n        const jumpToNode = (node) => {\n            const path = [];\n            let current = node;\n            while (current && current.parentId && current.id !== 'WORLD_ORIGIN') {\n                path.unshift(current);\n                current = allNodes.value.find(n => n.id === current.parentId);\n            }\n            if (current) {\n                path.unshift(current);\n            }\n            const newNavPath = path.map(p => ({ id: p.id, name: p.name }));\n            mapActions.setNavigationPath(newNavPath);\n            if (node.parentId) {\n                mapActions.navigateBack(node.parentId);\n            }\n            else {\n                mapActions.navigateBack('WORLD_ORIGIN');\n            }\n            searchText.value = '';\n        };\n        const jumpToFirstResult = () => {\n            if (searchResults.value.length > 0) {\n                jumpToNode(searchResults.value[0]);\n            }\n        };\n        const searchBtnRef = ref(null);\n        const initDraggableSearchBtn = () => {\n            const btn = searchBtnRef.value;\n            if (!btn)\n                return;\n            let isDragging = false;\n            let offsetX = 0, offsetY = 0;\n            const onMouseMove = (e) => {\n                if (!isDragging)\n                    return;\n                const container = btn.parentElement;\n                if (!container)\n                    return;\n                let x = e.clientX - offsetX;\n                let y = e.clientY - offsetY;\n                const containerRect = container.getBoundingClientRect();\n                x = Math.max(0, Math.min(x, containerRect.width - btn.offsetWidth));\n                y = Math.max(0, Math.min(y, containerRect.height - btn.offsetHeight));\n                btn.style.left = `${x}px`;\n                btn.style.top = `${y}px`;\n            };\n            const onMouseUp = () => {\n                if (!isDragging)\n                    return;\n                isDragging = false;\n                document.removeEventListener('mousemove', onMouseMove);\n                document.removeEventListener('mouseup', onMouseUp);\n                const containerRect = btn.parentElement.getBoundingClientRect();\n                const rect = btn.getBoundingClientRect();\n                const threshold = 50;\n                if (rect.left - containerRect.left < threshold)\n                    btn.style.left = '10px';\n                else if (containerRect.right - rect.right < threshold)\n                    btn.style.left = `${containerRect.width - rect.width - 10}px`;\n                if (rect.top - containerRect.top < threshold)\n                    btn.style.top = '10px';\n                else if (containerRect.bottom - rect.bottom < threshold)\n                    btn.style.top = `${containerRect.height - rect.height - 10}px`;\n            };\n            btn.onmousedown = e => {\n                isDragging = true;\n                offsetX = e.clientX - btn.offsetLeft;\n                offsetY = e.clientY - btn.offsetTop;\n                document.addEventListener('mousemove', onMouseMove);\n                document.addEventListener('mouseup', onMouseUp);\n            };\n        };\n        // ---  ---\n        const mainWorldActiveEpoch = computed(() => {\n            const state = store.worldState;\n            if (!state || !state.)\n                return null;\n            const world = Object.values(state.).find(w => w.?.?. === '');\n            if (!world)\n                return null;\n            const currentEpochId = world.?.?.ID;\n            if (!currentEpochId || !world..)\n                return null;\n            return world..[currentEpochId] || null;\n        });\n        const updateAndRenderMap = debounce(() => {\n            if (!svgRef.value)\n                return;\n            const { width, height } = svgRef.value.getBoundingClientRect();\n            if (width === 0 || height === 0)\n                return; // \n            // \n            if (!isStarfieldInitialized.value) {\n                const starFieldSize = Math.max(width, height) * 4;\n                stars.value = Array.from({ length: 1000 }, (_, i) => ({\n                    id: i,\n                    x: (Math.random() - 0.5) * starFieldSize + width / 2,\n                    y: (Math.random() - 0.5) * starFieldSize + height / 2,\n                    r: Math.random() * 1.2,\n                    o: Math.random() * 0.8 + 0.2,\n                }));\n                isStarfieldInitialized.value = true;\n            }\n            if (!mainWorldActiveEpoch.value) {\n                renderD3([], [], d3.zoomIdentity);\n                return;\n            }\n            fullHierarchy.value = worldMapDataService.getMapHierarchy(mainWorldActiveEpoch.value);\n            if (!currentRootNode.value) {\n                renderD3([], [], d3.zoomIdentity);\n                return;\n            }\n            const rootCopy = JSON.parse(JSON.stringify(currentRootNode.value));\n            let nodesToRender = [];\n            let links = [];\n            if (rootCopy.id === 'WORLD_ORIGIN') {\n                const mainNode = rootCopy.children[0];\n                if (mainNode) {\n                    mainNode.x = width / 2;\n                    mainNode.y = height / 2;\n                    coordinateService.calculateRelativePositions(mainNode, rootCopy.children.slice(1));\n                }\n                nodesToRender = rootCopy.children;\n                links = rootCopy.children\n                    .slice(1)\n                    .map((child) => ({ source: mainNode, target: child }));\n            }\n            else {\n                rootCopy.x = width / 2;\n                rootCopy.y = height / 2;\n                coordinateService.calculateRelativePositions(rootCopy, rootCopy.children);\n                nodesToRender = [rootCopy, ...rootCopy.children];\n                links = rootCopy.children.map((child) => ({\n                    source: rootCopy,\n                    target: child,\n                }));\n            }\n            layoutNodes.value = nodesToRender.filter(n => n.id !== 'WORLD_ORIGIN');\n            layoutLinks.value = links;\n            nextTick(() => {\n                renderD3(layoutNodes.value, layoutLinks.value, d3.zoomIdentity);\n            });\n        }, 300);\n        watch(mainWorldActiveEpoch, updateAndRenderMap, { immediate: true });\n        watch(currentRootId, updateAndRenderMap);\n        watch(() => store.worldState, newState => {\n            if (!newState)\n                return;\n            const avatarId = newState.?.?.?.ID;\n            const userLocation = newState.?.?. || null;\n            let avatarLocation = null;\n            if (avatarId && newState.) {\n                for (const world of Object.values(newState.)) {\n                    const foundAvatar = world.?.[avatarId];\n                    if (foundAvatar) {\n                        avatarLocation = foundAvatar. || null;\n                        break;\n                    }\n                }\n            }\n            mapActions.setPlayerLocations({ user: userLocation, avatar: avatarLocation });\n        }, { deep: true, immediate: true });\n        onMounted(() => {\n            initDraggableSearchBtn();\n            const handleClickOutside = (event) => {\n                const searchPanel = document.querySelector('.search-panel');\n                if (searchPanel &&\n                    !searchPanel.contains(event.target) &&\n                    !searchBtnRef.value?.contains(event.target)) {\n                    isSearchPanelVisible.value = false;\n                }\n            };\n            document.addEventListener('click', handleClickOutside, true);\n            const observer = new ResizeObserver(() => {\n                updateAndRenderMap();\n            });\n            if (rootElRef.value) {\n                observer.observe(rootElRef.value);\n            }\n            onUnmounted(() => {\n                document.removeEventListener('click', handleClickOutside, true);\n                observer.disconnect();\n            });\n        });\n        onActivated(() => {\n            if (currentRootNode.value?.id === 'WORLD_ORIGIN') {\n                mapActions.setNavigationPath([]);\n            }\n        });\n        function renderD3(nodes, links, transform) {\n            const clickTimers = new Map();\n            if (!svgRef.value)\n                return;\n            const svg = d3.select(svgRef.value);\n            const zoomContainer = svg.selectAll('g.zoom-container').data([null]);\n            const zoomContainerEnter = zoomContainer.enter().append('g').attr('class', 'zoom-container');\n            const g = zoomContainer.merge(zoomContainerEnter);\n            zoomContainerEnter\n                .append('g')\n                .selectAll('circle.star')\n                .data(stars.value)\n                .join('circle')\n                .attr('class', 'star')\n                .attr('cx', (d) => d.x)\n                .attr('cy', (d) => d.y)\n                .attr('r', (d) => d.r)\n                .attr('fill', 'white')\n                .attr('opacity', (d) => d.o);\n            const zoom = d3\n                .zoom()\n                .scaleExtent([0.01, 10])\n                .on('zoom', (event) => {\n                g.attr('transform', event.transform);\n            });\n            svg.call(zoom).on('dblclick.zoom', null);\n            svg\n                .transition()\n                .duration(750)\n                .call(zoom.transform, transform);\n            const t = d3.transition().duration(750);\n            const visualCenterNode = nodes.find(n => n.id === currentRootId.value) || nodes[0];\n            if (visualCenterNode) {\n                const distances = nodes\n                    .filter(n => n.id !== visualCenterNode.id)\n                    .map(n => {\n                    const dx = (n.x ?? 0) - (visualCenterNode.x ?? 0);\n                    const dy = (n.y ?? 0) - (visualCenterNode.y ?? 0);\n                    return Math.sqrt(dx * dx + dy * dy);\n                })\n                    .filter(d => d > 0);\n                g.selectAll('circle.orbit-line')\n                    .data(distances)\n                    .join((enter) => enter\n                    .append('circle')\n                    .attr('class', 'orbit-line')\n                    .attr('cx', visualCenterNode.x ?? 0)\n                    .attr('cy', visualCenterNode.y ?? 0)\n                    .attr('r', 0)\n                    .attr('fill', 'none')\n                    .attr('stroke', 'rgba(255, 255, 255, 0.1)')\n                    .call((enter) => enter.transition(t).attr('r', (d) => d)), (update) => update.call((update) => update\n                    .transition(t)\n                    .attr('cx', visualCenterNode.x ?? 0)\n                    .attr('cy', visualCenterNode.y ?? 0)\n                    .attr('r', (d) => d)), (exit) => exit.call((exit) => exit.transition(t).attr('r', 0).remove()));\n            }\n            g.selectAll('line.link')\n                .data(links, (d) => `${d.source.id}-${d.target.id}`)\n                .join((enter) => enter\n                .append('line')\n                .attr('class', 'link')\n                .attr('stroke', '#999')\n                .attr('stroke-opacity', 0)\n                .attr('x1', (d) => d.source.x || 0)\n                .attr('y1', (d) => d.source.y || 0)\n                .attr('x2', (d) => d.target.x || 0)\n                .attr('y2', (d) => d.target.y || 0)\n                .call((enter) => enter.transition(t).attr('stroke-opacity', 0.4)), (update) => update.call((update) => update\n                .transition(t)\n                .attr('x1', (d) => d.source.x || 0)\n                .attr('y1', (d) => d.source.y || 0)\n                .attr('x2', (d) => d.target.x || 0)\n                .attr('y2', (d) => d.target.y || 0)), (exit) => exit.call((exit) => exit.transition(t).attr('stroke-opacity', 0).remove()));\n            const nodeGroups = g.selectAll('g.node-group').data(nodes, (d) => d.id);\n            const nodeEnter = nodeGroups\n                .enter()\n                .append('g')\n                .attr('class', 'node-group')\n                .classed('player-location', (d) => d.id === mapState.userLocationId)\n                .classed('avatar-location', (d) => d.id === mapState.avatarLocationId)\n                .attr('transform', (d) => `translate(${d.x || 0},${d.y || 0})`)\n                .attr('opacity', 0);\n            nodeEnter\n                .append('circle')\n                .attr('r', (d) => d.radius)\n                .attr('fill', (d) => colorService.getColor(d.type))\n                .attr('stroke', (d) => d3.color(colorService.getColor(d.type))?.brighter(1.5).toString() ?? '#fff')\n                .attr('stroke-width', 2);\n            nodeEnter\n                .append('text')\n                .text((d) => d.name)\n                .attr('text-anchor', 'middle')\n                .attr('dy', (d) => d.radius + 15)\n                .attr('fill', 'white')\n                .style('font-size', '12px');\n            nodeGroups\n                .merge(nodeEnter)\n                .on('click', function (event, d) {\n                const existingTimeout = clickTimers.get(d.id);\n                if (existingTimeout) {\n                    clearTimeout(existingTimeout);\n                    clickTimers.delete(d.id);\n                    mapActions.selectNode(d);\n                }\n                else {\n                    const newTimeout = window.setTimeout(() => {\n                        if (d.childCount > 0) {\n                            mapActions.navigateToNode(d);\n                        }\n                        else {\n                            mapActions.selectNode(d);\n                        }\n                        clickTimers.delete(d.id);\n                    }, 250);\n                    clickTimers.set(d.id, newTimeout);\n                }\n            })\n                .transition(t)\n                .attr('transform', (d) => `translate(${d.x || 0},${d.y || 0})`)\n                .attr('opacity', 1);\n            nodeGroups.exit().transition(t).attr('opacity', 0).remove();\n        }\n        const onNavigateBack = (nodeId) => {\n            mapActions.navigateBack(nodeId);\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n                class: \"world-map-view\",\n                ref_key: \"rootElRef\",\n                ref: rootElRef\n            }, [\n                _createVNode(MapNavigator, {\n                    path: navigationPath.value,\n                    onNavigate: onNavigateBack\n                }, null, 8 /* PROPS */, [\"path\"]),\n                _createElementVNode(\"button\", {\n                    ref_key: \"searchBtnRef\",\n                    ref: searchBtnRef,\n                    class: \"search-toggle-btn\",\n                    onClick: _cache[0] || (_cache[0] = ($event) => (isSearchPanelVisible.value = !isSearchPanelVisible.value))\n                }, \"  \", 512 /* NEED_PATCH */),\n                (isSearchPanelVisible.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                        _withDirectives(_createElementVNode(\"input\", {\n                            type: \"text\",\n                            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event) => ((searchText).value = $event)),\n                            placeholder: \"...\",\n                            onKeyup: _withKeys(jumpToFirstResult, [\"enter\"])\n                        }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                            [_vModelText, searchText.value]\n                        ]),\n                        (searchResults.value.length && searchText.value)\n                            ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_2, [\n                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(searchResults.value, (node) => {\n                                    return (_openBlock(), _createElementBlock(\"li\", {\n                                        key: node.id,\n                                        onClick: ($event) => (jumpToNode(node))\n                                    }, _toDisplayString(getFullPath(node)), 9 /* TEXT, PROPS */, _hoisted_3));\n                                }), 128 /* KEYED_FRAGMENT */))\n                            ]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                (_openBlock(), _createElementBlock(\"svg\", {\n                    ref_key: \"svgRef\",\n                    ref: svgRef,\n                    class: \"map-svg\"\n                }, null, 512 /* NEED_PATCH */)),\n                (isDetailPanelVisible.value)\n                    ? (_openBlock(), _createBlock(NodeDetailPanel, {\n                        key: 1,\n                        node: selectedNode.value,\n                        onClose: _unref(mapActions).hideDetail\n                    }, null, 8 /* PROPS */, [\"node\", \"onClose\"]))\n                    : _createCommentVNode(\"v-if\", true)\n            ], 512 /* NEED_PATCH */));\n        };\n    }\n});\n","import type { Component } from 'vue';\nimport AvatarCharacterPanel from '../components/panels/avatar/AvatarCharacterPanel.vue';\nimport AvatarInventoryPanel from '../components/panels/avatar/AvatarInventoryPanel.vue';\nimport AvatarTasksPanel from '../components/panels/avatar/AvatarTasksPanel.vue';\nimport CharacterPanel from '../components/panels/CharacterPanel.vue';\nimport ImprintsPanel from '../components/panels/ImprintsPanel.vue';\nimport InventoryPanel from '../components/panels/InventoryPanel.vue';\nimport NpcDirectoryPanel from '../components/panels/NpcDirectoryPanel.vue';\nimport ReincarnationPanel from '../components/panels/ReincarnationPanel.vue';\nimport RippleDetailPanel from '../components/panels/RippleDetailPanel.vue';\nimport SkillsPanel from '../components/panels/SkillsPanel.vue';\nimport SystemPanel from '../components/panels/SystemPanel.vue';\nimport WorldDetailsPanel from '../components/panels/WorldDetailsPanel.vue';\nimport AvatarWorldMapView from '../modules/world-map/components/AvatarWorldMapView.vue';\nimport WorldMapView from '../modules/world-map/components/WorldMapView.vue';\n\nexport interface PanelInfo {\n  component: Component;\n  title: string;\n}\n\ntype PanelRegistry = Record<string, Record<string, PanelInfo>>;\n\nexport const panelRegistry: PanelRegistry = {\n  mainWorld: {\n    character: { component: CharacterPanel, title: '' },\n    inventory: { component: InventoryPanel, title: '' },\n    skills: { component: SkillsPanel, title: '' },\n    imprints: { component: ImprintsPanel, title: '' },\n    worldDetails: { component: WorldDetailsPanel, title: '' },\n    sandbox: { component: WorldMapView, title: '' },\n  },\n  avatarWorld: {\n    character: { component: AvatarCharacterPanel, title: '' },\n    inventory: { component: AvatarInventoryPanel, title: '' },\n    tasks: { component: AvatarTasksPanel, title: '' },\n    worldDetails: { component: WorldDetailsPanel, title: '' },\n    sandbox: { component: AvatarWorldMapView, title: '' },\n  },\n  reincarnation: {\n    main: { component: ReincarnationPanel, title: '' },\n  },\n  allWorlds: {\n    npcDirectory: { component: NpcDirectoryPanel, title: '' },\n  },\n  ripples: {\n    detail: { component: RippleDetailPanel, title: '' },\n  },\n  system: {\n    saveLoad: { component: SystemPanel, title: '' },\n  },\n};\n","/* unplugin-vue-components disabled */import script from \"./WorldMapView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./WorldMapView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./WorldMapView.vue?vue&type=style&index=0&id=9c90c6f8&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { ComponentContainer, GoldenLayout, LayoutConfig } from 'golden-layout';\nimport { Component, defineComponent, h, render } from 'vue';\nimport MainView from '../MainView.vue';\nimport { panelRegistry } from './panelRegistry';\nimport { eventBus } from './EventBus';\n\nclass DockManagerService {\n  private goldenLayout: GoldenLayout | null = null;\n  private hostElement: HTMLElement | null = null;\n  private componentMap: Map<string, Component> = new Map();\n  public onAction: ((action: string) => void) | null = null;\n  initialize(hostElement: HTMLElement) {\n    if (this.goldenLayout || !hostElement) return;\n\n    this.hostElement = hostElement;\n    this.goldenLayout = new GoldenLayout(this.hostElement);\n\n    // Pre-register all possible panel components\n    this.registerComponent('main-view', MainView);\n    for (const world in panelRegistry) {\n      for (const panel in panelRegistry[world]) {\n        const componentName = `${world}-${panel}`.toLowerCase();\n        const panelInfo = panelRegistry[world][panel];\n        this.registerComponent(componentName, panelInfo.component);\n      }\n    }\n\n    window.addEventListener('resize', () => this.updateLayout());\n\n    // Layout loading is now handled by LayoutService restoring panels\n    // this.loadSavedLayout();\n  }\n\n  public loadLayout(config: LayoutConfig) {\n    if (!this.goldenLayout) return;\n    try {\n      this.goldenLayout.loadLayout(config);\n    } catch (e) {\n      console.error('Failed to load layout:', e);\n      // Attempt to load default as a fallback\n      try {\n        this.goldenLayout.loadLayout(this.getDefaultLayout());\n      } catch (e2) {\n        console.error('Failed to load default layout on fallback:', e2);\n      }\n    }\n  }\n\n  // This method is no longer needed as LayoutService handles restoration logic.\n  // We keep the method stub in case it's called elsewhere, but it does nothing.\n  loadSavedLayout() {\n    if (!this.goldenLayout) return;\n    // Load a minimal default layout, LayoutService will populate it.\n    this.goldenLayout.loadLayout(this.getDefaultLayout());\n  }\n\n  registerComponent(componentName: string, component: Component) {\n    if (this.componentMap.has(componentName)) {\n      return;\n    }\n    this.componentMap.set(componentName, component);\n\n    this.goldenLayout?.registerComponent(componentName, (container: ComponentContainer, componentState: any) => {\n      const vueComponent = defineComponent({\n        setup: () => () => h(component, componentState?.props || {}),\n      });\n      const vnode = h(vueComponent);\n      render(vnode, container.getElement() as HTMLElement);\n\n      // Directly set the title from the component state\n      if ((componentState as any)?.title) {\n        container.setTitle((componentState as any).title);\n      }\n\n      // Add a destroy listener to notify LayoutService\n      (container as any).on('destroy', () => {\n        const panelId = (componentState as any)?.panelId;\n        if (panelId) {\n          eventBus.emit('panelClosed', panelId);\n        }\n      });\n    });\n  }\n\n  openPanel(panelId: string, title: string, componentName: string, props: Record<string, any> = {}) {\n    if (!this.goldenLayout) {\n      console.error('Golden Layout not initialized.');\n      return;\n    }\n\n    const component = this.componentMap.get(componentName);\n    if (!component) {\n      console.error(`Component \"${componentName}\" is not registered.`);\n      return;\n    }\n\n    this.goldenLayout.addComponent(componentName, { title, props, panelId }, panelId);\n  }\n\n  updateLayout() {\n    if (this.goldenLayout && this.hostElement) {\n      this.goldenLayout.updateSize(this.hostElement.clientWidth, this.hostElement.clientHeight);\n    }\n  }\n\n  closeAllPanels() {\n    if (!this.goldenLayout?.rootItem) return;\n\n    // Create a copy of the array to avoid issues while iterating and removing\n    const closableItems = this.goldenLayout.rootItem.contentItems.filter((item: any) => item.isClosable);\n\n    closableItems.forEach((item: any) => {\n      try {\n        item.remove();\n      } catch (e) {\n        console.error('Failed to remove panel item:', item, e);\n      }\n    });\n  }\n\n  destroy() {\n    if (this.goldenLayout) {\n      this.goldenLayout.destroy();\n      this.goldenLayout = null;\n    }\n    this.componentMap.clear();\n    window.removeEventListener('resize', () => {});\n  }\n\n  unpinAllPanels() {\n    if (!this.goldenLayout) return;\n    // \n    this.goldenLayout.loadLayout(this.getDefaultLayout());\n    //  item  isPinned = false\n  }\n\n  private getDefaultLayout(): LayoutConfig {\n    return {\n      root: {\n        type: 'row',\n        content: [\n          {\n            type: 'component',\n            componentType: 'main-view',\n            title: '',\n            isClosable: false,\n          },\n        ],\n      },\n    };\n  }\n\n  public getFullscreenLayout(): LayoutConfig {\n    return {\n      root: {\n        type: 'row',\n        content: [\n          {\n            type: 'component',\n            componentType: 'main-view',\n            title: '',\n            isClosable: false,\n            width: 100,\n          },\n        ],\n      },\n    };\n  }\n}\n\nexport const dockManagerService = new DockManagerService();\n","import { dockManagerService } from './DockManagerService';\nimport { eventBus } from './EventBus';\nimport { panelRegistry } from './panelRegistry';\n\nexport function usePanelManager() {\n  const openPanel = (world: keyof typeof panelRegistry, panel: string, props: Record<string, any> = {}) => {\n    const panelInfo = panelRegistry[world]?.[panel];\n    if (panelInfo) {\n      const panelId = `${world}-${panel}-${props.rippleId || ''}`.toLowerCase();\n      const componentName = `${world}-${panel}`.toLowerCase();\n\n      // Ensure the component is registered before trying to open it\n      dockManagerService.registerComponent(componentName, panelInfo.component);\n\n      const finalProps = { worldType: world, ...props };\n      dockManagerService.openPanel(panelId, panelInfo.title, componentName, finalProps);\n\n      eventBus.emit('panelOpened', { world, panel, props, panelId });\n    }\n  };\n\n  return { openPanel };\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nimport { onMounted, onBeforeUnmount, ref } from 'vue';\nimport { dockManagerService } from '../services/DockManagerService';\nimport { panelRegistry } from '../services/usePanelManager';\nimport MainView from '../MainView.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'DockManager',\n    setup(__props) {\n        const dockHost = ref(null);\n        onMounted(() => {\n            if (dockHost.value) {\n                dockManagerService.initialize(dockHost.value);\n                // Register all components from the panel registry\n                for (const world in panelRegistry) {\n                    for (const panel in panelRegistry[world]) {\n                        const panelInfo = panelRegistry[world][panel];\n                        const componentName = `${world}-${panel}`;\n                        dockManagerService.registerComponent(componentName, panelInfo.component);\n                    }\n                }\n                // Register the main view separately\n                dockManagerService.registerComponent('main-view', MainView);\n                // Load layout (now that all components are registered)\n                dockManagerService.loadSavedLayout();\n            }\n        });\n        onBeforeUnmount(() => {\n            dockManagerService.destroy();\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n                ref_key: \"dockHost\",\n                ref: dockHost,\n                class: \"dock-manager-host\"\n            }, null, 512 /* NEED_PATCH */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./DockManager.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DockManager.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./DockManager.vue?vue&type=style&index=0&id=0f457032&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeStyle as _normalizeStyle, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = { class: \"loading-overlay\" };\nconst _hoisted_2 = { class: \"loading-content\" };\nconst _hoisted_3 = {\n    key: 0,\n    class: \"error-container\"\n};\nconst _hoisted_4 = { class: \"error-message\" };\nconst _hoisted_5 = { key: 1 };\nconst _hoisted_6 = { class: \"tip\" };\nconst _hoisted_7 = { class: \"progress-bar-container\" };\nconst _hoisted_8 = { class: \"progress-text\" };\nimport { onMounted, onUnmounted, ref, watch } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'LoadingIndicator',\n    props: {\n        error: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const tips = [\n            '',\n            '',\n            '',\n            '',\n            'NPC',\n            '',\n            '',\n            '',\n        ];\n        const randomTip = ref('');\n        const progress = ref(0);\n        let progressInterval = null;\n        onMounted(() => {\n            if (!props.error) {\n                startProgress();\n            }\n        });\n        onUnmounted(() => {\n            stopProgress();\n        });\n        watch(() => props.error, newError => {\n            if (newError) {\n                stopProgress();\n            }\n        });\n        function startProgress() {\n            // \n            randomTip.value = tips[Math.floor(Math.random() * tips.length)];\n            // \n            progress.value = 0;\n            progressInterval = window.setInterval(() => {\n                if (progress.value < 99) {\n                    progress.value += 1;\n                }\n                else {\n                    stopProgress();\n                }\n            }, 90000 / 99); // 90 seconds for 99%\n        }\n        function stopProgress() {\n            if (progressInterval) {\n                clearInterval(progressInterval);\n                progressInterval = null;\n            }\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    (__props.error)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                            _cache[0] || (_cache[0] = _createElementVNode(\"h3\", { class: \"error-title\" }, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"p\", _hoisted_4, _toDisplayString(__props.error), 1 /* TEXT */),\n                            _cache[1] || (_cache[1] = _createElementVNode(\"p\", { class: \"error-tip\" }, \"\", -1 /* CACHED */))\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n                            _createElementVNode(\"p\", _hoisted_6, _toDisplayString(randomTip.value), 1 /* TEXT */),\n                            _createElementVNode(\"div\", _hoisted_7, [\n                                _createElementVNode(\"div\", {\n                                    class: \"progress-bar\",\n                                    style: _normalizeStyle({ width: progress.value + '%' })\n                                }, null, 4 /* STYLE */)\n                            ]),\n                            _createElementVNode(\"span\", _hoisted_8, [\n                                _cache[2] || (_cache[2] = _createElementVNode(\"span\", { class: \"highlight\" }, \"\", -1 /* CACHED */)),\n                                _createTextVNode(\"... \" + _toDisplayString(Math.floor(progress.value)) + \"%\", 1 /* TEXT */)\n                            ])\n                        ]))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./LoadingIndicator.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./LoadingIndicator.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./LoadingIndicator.vue?vue&type=style&index=0&id=0d571492&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-0d571492\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode } from \"vue\";\nconst _hoisted_1 = { class: \"npc-list-modal-content\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"npc-list-container\"\n};\nconst _hoisted_3 = { class: \"npc-list\" };\nconst _hoisted_4 = { class: \"npc-header\" };\nconst _hoisted_5 = { class: \"npc-name\" };\nconst _hoisted_6 = { class: \"npc-identity\" };\nconst _hoisted_7 = { class: \"npc-description\" };\nconst _hoisted_8 = {\n    key: 1,\n    class: \"no-npcs\"\n};\nimport { computed } from 'vue';\nimport { npcService } from '../../services/NpcService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcListModal',\n    props: {\n        worldId: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const npcs = computed(() => {\n            return npcService.getNpcsByWorld(props.worldId);\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (npcs.value.length > 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _createElementVNode(\"ul\", _hoisted_3, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(npcs.value, (npc) => {\n                                return (_openBlock(), _createElementBlock(\"li\", {\n                                    key: npc.[0],\n                                    class: \"npc-item\"\n                                }, [\n                                    _createElementVNode(\"div\", _hoisted_4, [\n                                        _createElementVNode(\"span\", _hoisted_5, _toDisplayString(npc.[0]), 1 /* TEXT */),\n                                        _createElementVNode(\"span\", _hoisted_6, _toDisplayString(npc..join(', ')), 1 /* TEXT */)\n                                    ]),\n                                    _createElementVNode(\"p\", _hoisted_7, _toDisplayString(npc.), 1 /* TEXT */)\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ])\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [...(_cache[0] || (_cache[0] = [\n                            _createElementVNode(\"p\", null, \"NPC\", -1 /* CACHED */)\n                        ]))]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcListModal.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcListModal.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcListModal.vue?vue&type=style&index=0&id=b20458ac&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-b20458ac\"]])\n\nexport default __exports__","const __WEBPACK_NAMESPACE_OBJECT__ = $;","import $ from 'jquery';\nimport screenfull from 'screenfull';\n\nlet originalStyles: { [selector: string]: { [key: string]: string } } = {};\n\n// ---  (Browser Fullscreen) ---\n\nfunction toggleBrowserFullscreen() {\n  if (screenfull.isEnabled) {\n    screenfull.toggle();\n  } else {\n    console.warn('');\n  }\n}\n\nfunction onBrowserFullscreenChange(callback: (isFullscreen: boolean) => void) {\n  if (screenfull.isEnabled) {\n    screenfull.on('change', () => {\n      callback(screenfull.isFullscreen);\n    });\n  }\n}\n\n// ---  (Web Fullscreen) ---\n\nfunction getIframeSelector(): string | null {\n  const iframes = parent.document.getElementsByTagName('iframe');\n  for (let i = 0; i < iframes.length; i++) {\n    if (iframes[i].contentWindow === window) {\n      const iframe = iframes[i];\n      if (iframe.id) {\n        return `#${iframe.id}`;\n      }\n      const src = iframe.getAttribute('src');\n      if (src) {\n        const srcFileName = src.split('/').pop();\n        if (srcFileName) {\n          return `iframe[src*=\"${srcFileName}\"]`;\n        }\n      }\n      return null;\n    }\n  }\n  return null;\n}\n\nfunction enterWebFullscreen() {\n  const iframeSelector = getIframeSelector();\n  if (!iframeSelector) {\n    console.warn(' iframe');\n    return;\n  }\n\n  const elementsToModify: { [key: string]: JQuery.PlainObject } = {\n    [iframeSelector]: {\n      position: 'fixed',\n      top: '0',\n      left: '0',\n      width: '100vw',\n      height: '100vh',\n      zIndex: '99999',\n      border: 'none',\n      borderRadius: '0',\n    },\n    '#top-settings-holder': { display: 'none' },\n    '#form_sheld > :not(#chat)': { display: 'none' },\n    '#top-bar': { display: 'none' },\n    '#chat': { height: '100vh', maxHeight: '100vh' },\n    '#chat_fullscreen_button': { display: 'none' },\n  };\n\n  originalStyles = {};\n  for (const selector in elementsToModify) {\n    const $element = $(selector, parent.document);\n    if ($element.length > 0) {\n      originalStyles[selector] = {};\n      const newStyles = elementsToModify[selector as keyof typeof elementsToModify];\n      for (const prop in newStyles) {\n        originalStyles[selector][prop] = $element.css(prop);\n      }\n      $element.css(newStyles);\n    }\n  }\n  $(parent.document.documentElement).addClass('web-fullscreen-active');\n  $(parent.document.body).addClass('web-fullscreen-active');\n}\n\nfunction exitWebFullscreen() {\n  for (const selector in originalStyles) {\n    const $element = $(selector, parent.document);\n    if ($element.length > 0) {\n      $element.css(originalStyles[selector]);\n    }\n  }\n  originalStyles = {};\n  $(parent.document.documentElement).removeClass('web-fullscreen-active');\n  $(parent.document.body).removeClass('web-fullscreen-active');\n}\n\nexport const fullscreenService = {\n  // \n  enterWeb: enterWebFullscreen,\n  exitWeb: exitWebFullscreen,\n  // \n  toggleBrowser: toggleBrowserFullscreen,\n  onBrowserChange: onBrowserFullscreenChange,\n  get isBrowserFullscreen() {\n    return screenfull.isEnabled && screenfull.isFullscreen;\n  },\n};\n","import { reactive, markRaw } from 'vue';\nimport NpcListModal from '../components/modals/NpcListModal.vue';\n\ninterface NpcModalState {\n  isVisible: boolean;\n  title: string;\n  props: { worldId: string };\n}\n\nconst state = reactive<NpcModalState>({\n  isVisible: false,\n  title: '',\n  props: { worldId: '' },\n});\n\nconst show = (worldId: string) => {\n  state.title = 'NPC ';\n  state.props = { worldId };\n  //  DetailModalService \n  // state.component = markRaw(NpcListModal);\n  state.isVisible = true;\n};\n\nconst hide = () => {\n  state.isVisible = false;\n};\n\nexport const npcModalService = {\n  state,\n  show,\n  hide,\n};\n","import { reactive, readonly } from 'vue';\nimport { confirmationService } from '../services/ConfirmationService';\nimport { detailModalService } from '../services/DetailModalService';\nimport { dockManagerService } from '../services/DockManagerService';\nimport { eventBus } from '../services/EventBus';\nimport { fullscreenService } from '../services/fullscreenService';\nimport { inputModalActions } from '../services/InputModalService';\nimport { npcModalService } from '../services/NpcModalService';\n\n//  UI \ninterface UiState {\n  isWebFullscreen: boolean;\n  isBrowserFullscreen: boolean;\n}\n\n// \nconst state = reactive<UiState>({\n  isWebFullscreen: false,\n  isBrowserFullscreen: false,\n});\n\n// \nfullscreenService.onBrowserChange(isFullscreen => {\n  // Check if we are transitioning from fullscreen to not-fullscreen\n  if (state.isBrowserFullscreen && !isFullscreen) {\n    // Use Tavern's built-in refresh mechanism instead of a hard reload\n    TavernHelper.setChatMessages([], { refresh: 'all' });\n  }\n  state.isBrowserFullscreen = isFullscreen;\n});\n\n//  actions\nconst actions = {\n  /**\n   * \n   */\n  toggleBrowserFullscreen(): void {\n    // \n    dockManagerService.closeAllPanels();\n    confirmationService.hide();\n    detailModalService.hide();\n    npcModalService.hide();\n    inputModalActions.hide();\n\n    fullscreenService.toggleBrowser();\n  },\n\n  /**\n   * \n   */\n  toggleWebFullscreen(): void {\n    const newFullscreenState = !state.isWebFullscreen;\n    state.isWebFullscreen = newFullscreenState;\n\n    if (newFullscreenState) {\n      fullscreenService.enterWeb();\n    } else {\n      fullscreenService.exitWeb();\n    }\n    // Notify the layout service about the change\n    eventBus.emit('fullscreenChanged', newFullscreenState);\n  },\n\n  /**\n   * \n   */\n  unpinAllPanels(): void {\n    dockManagerService.unpinAllPanels();\n  },\n};\n\n//  actions\nexport const uiState = readonly(state);\nexport const uiActions = actions;\n","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"top-status\" };\nconst _hoisted_2 = { class: \"status-left\" };\nconst _hoisted_3 = { class: \"info-display chapter-info\" };\nconst _hoisted_4 = { class: \"chapter-title\" };\nconst _hoisted_5 = { class: \"chapter-details\" };\nconst _hoisted_6 = { class: \"status-center\" };\nconst _hoisted_7 = [\"title\"];\nconst _hoisted_8 = { class: \"status-right\" };\nconst _hoisted_9 = { class: \"info-display world-time\" };\nimport { computed } from 'vue';\nimport { uiState, uiActions } from '../store/ui';\nimport { usePanelManager } from '../services/usePanelManager';\nimport { actions } from '../store';\nimport { chapterInfo, worldTimeStr } from '../store/getters';\nimport { inputModalActions, inputModalState } from '../services/InputModalService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'TopStatusBar',\n    setup(__props) {\n        const isBrowserFullscreen = computed(() => uiState.isBrowserFullscreen);\n        const { openPanel } = usePanelManager();\n        const toggleFullscreen = () => {\n            uiActions.toggleBrowserFullscreen();\n            uiActions.toggleWebFullscreen(); // \n        };\n        const openSaveLoadPanel = () => {\n            openPanel('system', 'saveLoad');\n        };\n        const openInputModal = () => {\n            if (inputModalState.isVisible) {\n                inputModalActions.hide();\n            }\n            else {\n                inputModalActions.show();\n            }\n        };\n        const fullscreenTitle = computed(() => {\n            return isBrowserFullscreen.value ? '' : '';\n        });\n        const fullscreenIcon = computed(() => {\n            return isBrowserFullscreen.value ? 'fas fa-compress' : 'fas fa-expand';\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _createElementVNode(\"span\", _hoisted_4, _toDisplayString(_unref(chapterInfo).title), 1 /* TEXT */),\n                        _createElementVNode(\"span\", _hoisted_5, _toDisplayString(_unref(chapterInfo).details), 1 /* TEXT */)\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_6, [\n                    _createElementVNode(\"button\", {\n                        onClick: openSaveLoadPanel,\n                        class: \"view-toggle-btn\",\n                        title: \"\"\n                    }, [...(_cache[1] || (_cache[1] = [\n                            _createElementVNode(\"i\", { class: \"fas fa-cog\" }, null, -1 /* CACHED */)\n                        ]))]),\n                    _createElementVNode(\"button\", {\n                        onClick: openInputModal,\n                        class: \"view-toggle-btn\",\n                        title: \"\"\n                    }, [...(_cache[2] || (_cache[2] = [\n                            _createElementVNode(\"i\", { class: \"fas fa-keyboard\" }, null, -1 /* CACHED */)\n                        ]))]),\n                    _createElementVNode(\"button\", {\n                        onClick: toggleFullscreen,\n                        class: \"view-toggle-btn\",\n                        title: fullscreenTitle.value\n                    }, [\n                        _createElementVNode(\"i\", {\n                            class: _normalizeClass(fullscreenIcon.value)\n                        }, null, 2 /* CLASS */)\n                    ], 8 /* PROPS */, _hoisted_7),\n                    _createElementVNode(\"button\", {\n                        onClick: _cache[0] || (_cache[0] =\n                            //@ts-ignore\n                            (...args) => (_unref(actions).rerollLastAction && _unref(actions).rerollLastAction(...args))),\n                        class: \"view-toggle-btn\",\n                        title: \"\"\n                    }, [...(_cache[3] || (_cache[3] = [\n                            _createElementVNode(\"i\", { class: \"fas fa-undo\" }, null, -1 /* CACHED */)\n                        ]))])\n                ]),\n                _createElementVNode(\"div\", _hoisted_8, [\n                    _createElementVNode(\"div\", _hoisted_9, _toDisplayString(_unref(worldTimeStr)), 1 /* TEXT */)\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./TopStatusBar.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./TopStatusBar.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./TopStatusBar.vue?vue&type=style&index=0&id=87f225c0&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-87f225c0\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"world-time-display\" };\nconst _hoisted_2 = { class: \"world-name\" };\nconst _hoisted_3 = { class: \"time-string\" };\nimport { computed, toRefs } from 'vue';\nimport { timeStr as avatarTimeStr, mainWorldTimeStr } from '../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'WorldTimeDisplay',\n    props: {\n        worldType: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const { worldType } = toRefs(props);\n        const worldName = computed(() => {\n            return worldType.value === 'main' ? '' : '';\n        });\n        const timeString = computed(() => {\n            return worldType.value === 'main' ? mainWorldTimeStr.value : avatarTimeStr.value;\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"span\", _hoisted_2, _toDisplayString(worldName.value), 1 /* TEXT */),\n                _createElementVNode(\"span\", _hoisted_3, _toDisplayString(timeString.value), 1 /* TEXT */)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./WorldTimeDisplay.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./WorldTimeDisplay.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./WorldTimeDisplay.vue?vue&type=style&index=0&id=7a5f6689&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7a5f6689\"]])\n\nexport default __exports__","import { eventBus } from './EventBus';\n\nconst NORMAL_LAYOUT_KEY = 'reincarnation-simulator-layout-state-v3-normal';\nconst FULLSCREEN_LAYOUT_KEY = 'reincarnation-simulator-layout-state-v3-fullscreen';\n\nexport interface PanelState {\n  world: string;\n  panel: string;\n  props?: Record<string, any>;\n  panelId: string;\n}\n\nclass LayoutService {\n  private activePanels: Map<string, PanelState> = new Map();\n  private fullscreenPanels: Map<string, PanelState> = new Map();\n  private isFullscreen = false;\n\n  constructor() {\n    this.loadAllLayouts();\n    eventBus.on('panelOpened', (state: PanelState) => this.addPanel(state));\n    eventBus.on('panelClosed', (panelId: string) => this.removePanel(panelId));\n    eventBus.on('fullscreenChanged', (isFullscreen: boolean) => this.handleFullscreenChange(isFullscreen));\n  }\n\n  private loadAllLayouts() {\n    try {\n      const normalState = localStorage.getItem(NORMAL_LAYOUT_KEY);\n      if (normalState) this.activePanels = new Map(JSON.parse(normalState));\n\n      const fullscreenState = localStorage.getItem(FULLSCREEN_LAYOUT_KEY);\n      if (fullscreenState) this.fullscreenPanels = new Map(JSON.parse(fullscreenState));\n    } catch (e) {\n      console.error('Failed to load layout states:', e);\n    }\n  }\n\n  private saveLayoutState() {\n    if (this.isFullscreen) {\n      localStorage.setItem(FULLSCREEN_LAYOUT_KEY, JSON.stringify(Array.from(this.fullscreenPanels.entries())));\n    } else {\n      localStorage.setItem(NORMAL_LAYOUT_KEY, JSON.stringify(Array.from(this.activePanels.entries())));\n    }\n  }\n\n  public addPanel(state: PanelState) {\n    const currentMap = this.isFullscreen ? this.fullscreenPanels : this.activePanels;\n    if (!currentMap.has(state.panelId)) {\n      currentMap.set(state.panelId, state);\n      this.saveLayoutState();\n    }\n  }\n\n  public removePanel(panelId: string) {\n    const currentMap = this.isFullscreen ? this.fullscreenPanels : this.activePanels;\n    if (currentMap.has(panelId)) {\n      currentMap.delete(panelId);\n      this.saveLayoutState();\n    }\n  }\n\n  private handleFullscreenChange(isFullscreen: boolean) {\n    this.isFullscreen = isFullscreen;\n    this.restoreLayout();\n  }\n\n  public restoreLayout() {\n    const panelsToRestore = this.isFullscreen ? this.fullscreenPanels : this.activePanels;\n    console.log(`[LayoutService] Broadcasting restore ${this.isFullscreen ? 'fullscreen' : 'normal'} layout event...`);\n    eventBus.emit('restoreLayout', Array.from(panelsToRestore.values()));\n  }\n\n  public setCurrentFullscreenState(isFullscreen: boolean) {\n    this.isFullscreen = isFullscreen;\n  }\n}\n\nexport const layoutService = new LayoutService();\n","import { computed, defineComponent, onMounted, ref } from 'vue';\nimport ActionPanel from './components/common/ActionPanel.vue';\nimport EnhancedInputBox from './components/common/EnhancedInputBox.vue';\nimport InputHistoryPopup from './components/common/InputHistoryPopup.vue';\nimport NotificationContainer from './components/common/NotificationContainer.vue';\nimport SideMenuButton from './components/controls/SideMenuButton.vue';\nimport DockManager from './components/DockManager.vue';\nimport LoadingIndicator from './components/LoadingIndicator.vue';\nimport NpcListModal from './components/modals/NpcListModal.vue';\nimport TopStatusBar from './components/TopStatusBar.vue';\nimport WorldTimeDisplay from './components/WorldTimeDisplay.vue';\nimport { commandService } from './services/CommandService';\nimport { confirmationService } from './services/ConfirmationService';\nimport { detailModalService } from './services/DetailModalService';\nimport { dockManagerService } from './services/DockManagerService';\nimport { eventBus } from './services/EventBus';\nimport { inputModalActions, inputModalState } from './services/InputModalService';\nimport { layoutService } from './services/LayoutService';\nimport { npcModalService } from './services/NpcModalService';\nimport { saveLoadService } from './services/saveLoadService';\nimport { usePanelManager } from './services/usePanelManager';\nimport { actions, store } from './store';\nimport { uiState } from './store/ui';\nexport default defineComponent({\n    name: 'App',\n    components: {\n        DockManager,\n        EnhancedInputBox,\n        LoadingIndicator,\n        NpcListModal,\n        TopStatusBar,\n        WorldTimeDisplay,\n        SideMenuButton,\n        NotificationContainer,\n        ActionPanel,\n        InputHistoryPopup,\n    },\n    setup() {\n        const { openPanel } = usePanelManager();\n        const confirmation = computed(() => confirmationService.state);\n        const detailModal = computed(() => detailModalService.state);\n        const npcModal = computed(() => npcModalService.state);\n        const isWebFullscreen = computed(() => uiState.isWebFullscreen);\n        const inputModal = computed(() => inputModalState);\n        const isActionPanelVisible = ref(false);\n        const isHistoryVisible = ref(false);\n        const isQueueVisible = ref(false);\n        const commands = ref([]);\n        const commandCount = computed(() => commands.value.length);\n        const menuOptions = {\n            main: [\n                { id: 'character', icon: '', text: '', action: () => openPanel('mainWorld', 'character') },\n                { id: 'inventory', icon: '', text: '', action: () => openPanel('mainWorld', 'inventory') },\n                { id: 'skills', icon: '', text: '', action: () => openPanel('mainWorld', 'skills') },\n                { id: 'worldDetails', icon: '', text: '', action: () => openPanel('mainWorld', 'worldDetails') },\n                { id: 'sandbox', icon: '', text: '', action: () => openPanel('mainWorld', 'sandbox') },\n            ],\n            avatar: [\n                {\n                    id: 'avatar-character',\n                    icon: '',\n                    text: '',\n                    action: () => openPanel('avatarWorld', 'character'),\n                },\n                {\n                    id: 'avatar-inventory',\n                    icon: '',\n                    text: '',\n                    action: () => openPanel('avatarWorld', 'inventory'),\n                },\n                {\n                    id: 'avatar-tasks',\n                    icon: '',\n                    text: '',\n                    action: () => openPanel('avatarWorld', 'tasks'),\n                },\n                {\n                    id: 'avatar-worldDetails',\n                    icon: '',\n                    text: '',\n                    action: () => openPanel('avatarWorld', 'worldDetails'),\n                },\n                {\n                    id: 'avatar-sandbox',\n                    icon: '',\n                    text: '',\n                    action: () => openPanel('avatarWorld', 'sandbox'),\n                },\n            ],\n            common: [\n                { id: 'imprints', icon: '', text: '', action: () => openPanel('mainWorld', 'imprints') },\n                { id: 'reincarnation', icon: '', text: '', action: () => openPanel('reincarnation', 'main') },\n                { id: 'npcDirectory', icon: '', text: '', action: () => openPanel('allWorlds', 'npcDirectory') },\n            ],\n        };\n        const handleOverlayClick = () => {\n            if (inputModal.value.isVisible) {\n                inputModalActions.hide();\n                return;\n            }\n        };\n        const handleAction = async (actionContent) => {\n            console.log('Submitting to AI:', actionContent);\n            await actions.handleAction(actionContent);\n            await saveLoadService.performAutoSave();\n        };\n        const handleSubmit = async (actionContent) => {\n            // Correctly save the raw input value before it gets cleared.\n            const rawInput = inputModal.value.inputValue;\n            inputModalActions.setLastSubmittedValue(rawInput);\n            await handleAction(actionContent);\n            inputModalActions.hide();\n            inputModalActions.clearValue();\n        };\n        const toggleActionPanel = () => {\n            isActionPanelVisible.value = !isActionPanelVisible.value;\n        };\n        const updateCommands = () => {\n            commands.value = commandService.getCommands();\n        };\n        const clearCommands = () => {\n            commandService.clearCommands();\n        };\n        const toggleHistory = () => {\n            isHistoryVisible.value = !isHistoryVisible.value;\n            if (isHistoryVisible.value)\n                isQueueVisible.value = false;\n        };\n        const toggleCommandQueue = () => {\n            isQueueVisible.value = !isQueueVisible.value;\n            if (isQueueVisible.value)\n                isHistoryVisible.value = false;\n        };\n        const selectHistoryEntry = (entry) => {\n            inputModalActions.setValue(entry);\n            isHistoryVisible.value = false;\n        };\n        onMounted(() => {\n            const dockHost = document.getElementById('app');\n            if (dockHost) {\n                dockManagerService.initialize(dockHost);\n            }\n            else {\n                console.error('Dock host element not found.');\n            }\n            actions.loadAllData();\n            actions.initializeEventListeners();\n            dockManagerService.onAction = handleAction;\n            commandService.subscribe(updateCommands);\n            updateCommands();\n            // Setup layout restoration listener\n            eventBus.on('restoreLayout', (panels) => {\n                const { openPanel } = usePanelManager();\n                dockManagerService.closeAllPanels(); // Ensure a clean slate before restoring\n                panels.forEach(panelState => {\n                    try {\n                        openPanel(panelState.world, panelState.panel, panelState.props || {});\n                    }\n                    catch (e) {\n                        console.error(`Failed to restore panel: ${panelState.world}-${panelState.panel}`, e);\n                    }\n                });\n            });\n            // Initialize layout service with current fullscreen state and restore layout\n            layoutService.setCurrentFullscreenState(uiState.isWebFullscreen);\n            layoutService.restoreLayout();\n        });\n        return {\n            confirmation,\n            detailModal,\n            npcModal,\n            isWebFullscreen,\n            inputModal,\n            inputModalActions,\n            menuOptions,\n            handleAction,\n            handleSubmit,\n            handleOverlayClick,\n            store,\n            confirmationService,\n            detailModalService,\n            npcModalService,\n            isActionPanelVisible,\n            toggleActionPanel,\n            isHistoryVisible,\n            toggleHistory,\n            selectHistoryEntry,\n            isQueueVisible,\n            toggleCommandQueue,\n            commands,\n            commandCount,\n            clearCommands,\n        };\n    },\n});\n","/* unplugin-vue-components disabled */import { render } from \"./app.vue?vue&type=template&id=66207f84&ts=true\"\nimport script from \"./app.vue?vue&type=script&lang=ts\"\nexport * from \"./app.vue?vue&type=script&lang=ts\"\n\nimport \"./app.vue?vue&type=style&index=0&id=66207f84&lang=scss\"\n\nimport exportComponent from \"../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"attribute-item\" };\nconst _hoisted_2 = { class: \"attribute-name\" };\nconst _hoisted_3 = { class: \"attribute-value\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'AttributeDisplay',\n    props: {\n        name: {},\n        value: {}\n    },\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"span\", _hoisted_2, _toDisplayString(__props.name), 1 /* TEXT */),\n                _createElementVNode(\"span\", _hoisted_3, _toDisplayString(__props.value), 1 /* TEXT */)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./AttributeDisplay.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AttributeDisplay.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./AttributeDisplay.vue?vue&type=style&index=0&id=1b452a49&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1b452a49\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createBlock as _createBlock, createVNode as _createVNode, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = { class: \"character-panel\" };\nconst _hoisted_2 = { class: \"panel-section\" };\nconst _hoisted_3 = {\n    id: \"base-attributes-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_4 = { class: \"panel-section\" };\nconst _hoisted_5 = {\n    id: \"secondary-attributes-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_6 = { class: \"panel-section\" };\nconst _hoisted_7 = {\n    id: \"grades-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_8 = { class: \"panel-section\" };\nconst _hoisted_9 = {\n    id: \"skills-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_10 = { class: \"panel-section\" };\nconst _hoisted_11 = {\n    id: \"talents-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_12 = { class: \"panel-section\" };\nconst _hoisted_13 = {\n    id: \"schedule-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_14 = { class: \"panel-section\" };\nconst _hoisted_15 = {\n    id: \"relations-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_16 = { class: \"attribute-name\" };\nconst _hoisted_17 = { class: \"attribute-value\" };\nimport { getters } from '../store';\nimport AttributeDisplay from '../components/AttributeDisplay.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'CharacterView',\n    setup(__props) {\n        const { character, secondaryAttributes, todayCourses, getBaseAttributes, getSubjects, getSkills, getTalents, getRelationships, } = getters;\n        const baseAttributes = getBaseAttributes(character);\n        const subjects = getSubjects(character);\n        const skills = getSkills(character);\n        const talents = getters.getTalents(character);\n        const relationships = getRelationships(character);\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(baseAttributes).value, (attr, key) => {\n                            return (_openBlock(), _createBlock(AttributeDisplay, {\n                                key: key,\n                                name: String(key),\n                                value: `${attr.} / ${attr.}`\n                            }, null, 8 /* PROPS */, [\"name\", \"value\"]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    _cache[1] || (_cache[1] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_5, [\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: ` ${_unref(secondaryAttributes).}`\n                        }, null, 8 /* PROPS */, [\"value\"]),\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: _unref(secondaryAttributes).\n                        }, null, 8 /* PROPS */, [\"value\"])\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_6, [\n                    _cache[2] || (_cache[2] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_7, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(subjects).value, (subject, key) => {\n                            return (_openBlock(), _createBlock(AttributeDisplay, {\n                                key: key,\n                                name: String(key),\n                                value: `${subject.} (${subject.})`\n                            }, null, 8 /* PROPS */, [\"name\", \"value\"]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_8, [\n                    _cache[3] || (_cache[3] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_9, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(skills).value, (skill, key) => {\n                            return (_openBlock(), _createBlock(AttributeDisplay, {\n                                key: key,\n                                name: String(key),\n                                value: `Lv.${skill.} / ${skill.}`\n                            }, null, 8 /* PROPS */, [\"name\", \"value\"]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_10, [\n                    _cache[4] || (_cache[4] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_11, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(talents), (talent, index) => {\n                            return (_openBlock(), _createBlock(AttributeDisplay, {\n                                key: index,\n                                name: talent.,\n                                value: talent.\n                            }, null, 8 /* PROPS */, [\"name\", \"value\"]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_12, [\n                    _cache[5] || (_cache[5] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_13, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(todayCourses), (course, index) => {\n                            return (_openBlock(), _createBlock(AttributeDisplay, {\n                                key: index,\n                                name: course.,\n                                value: course.\n                            }, null, 8 /* PROPS */, [\"name\", \"value\"]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_14, [\n                    _cache[6] || (_cache[6] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_15, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(relationships).value, (rel, name) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: name,\n                                class: \"attribute-item\"\n                            }, [\n                                _createElementVNode(\"span\", _hoisted_16, _toDisplayString(name), 1 /* TEXT */),\n                                _createElementVNode(\"span\", _hoisted_17, \" :\" + _toDisplayString(rel.) + \" :\" + _toDisplayString(rel.), 1 /* TEXT */)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./CharacterView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CharacterView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./CharacterView.vue?vue&type=style&index=0&id=1c5d8637&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1c5d8637\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = { class: \"inventory-panel\" };\nconst _hoisted_2 = { class: \"panel-section\" };\nconst _hoisted_3 = { class: \"inventory-grid\" };\nconst _hoisted_4 = { class: \"item-name\" };\nconst _hoisted_5 = { class: \"item-quantity\" };\nimport { ref, onMounted } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'InventoryView',\n    setup(__props) {\n        const inventory = ref([]);\n        onMounted(() => {\n            // Mock data for display purposes\n            inventory.value = [\n                { id: 'food001', name: 'A', quantity: 1 },\n                { id: 'snack002', name: 'Pocky', quantity: 3 },\n                { id: 'study001', name: '', quantity: 1 },\n            ];\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(inventory.value, (item) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: item.id,\n                                class: \"inventory-item\"\n                            }, [\n                                _createElementVNode(\"div\", _hoisted_4, _toDisplayString(item.name), 1 /* TEXT */),\n                                _createElementVNode(\"div\", _hoisted_5, \"x\" + _toDisplayString(item.quantity), 1 /* TEXT */)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./InventoryView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./InventoryView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./InventoryView.vue?vue&type=style&index=0&id=d797c64c&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-d797c64c\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createVNode as _createVNode, createCommentVNode as _createCommentVNode, normalizeStyle as _normalizeStyle, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"main-content-view\" };\nconst _hoisted_2 = [\"innerHTML\"];\nconst _hoisted_3 = [\"innerHTML\"];\nimport { computed, reactive } from 'vue';\nimport EnhancedInputBox from '../components/common/EnhancedInputBox.vue';\nimport { combinedNarrative, getItemByName, getNpcByName } from '../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'MainContentView',\n    emits: ['submit-action'],\n    setup(__props, { emit: __emit }) {\n        const emit = __emit;\n        const tooltip = reactive({\n            visible: false,\n            content: '',\n            style: {\n                top: '0px',\n                left: '0px',\n            },\n        });\n        const processedNarrative = computed(() => {\n            let text = combinedNarrative.value;\n            // Regex to find <item name=\"...\">...</item> and <npc name=\"...\">...</npc>\n            const itemRegex = /<item name=\"([^\"]+)\">(.+?)<\\/item>/g;\n            const npcRegex = /<npc name=\"([^\"]+)\">(.+?)<\\/npc>/g;\n            text = text.replace(itemRegex, (match, name, content) => {\n                return `<span class=\"highlighted-item\" data-type=\"item\" data-name=\"${name}\">${content}</span>`;\n            });\n            text = text.replace(npcRegex, (match, name, content) => {\n                return `<span class=\"highlighted-npc\" data-type=\"npc\" data-name=\"${name}\">${content}</span>`;\n            });\n            return text;\n        });\n        const handleMouseOver = (event) => {\n            const target = event.target;\n            const dataType = target.dataset.type;\n            const dataName = target.dataset.name;\n            if (!dataType || !dataName)\n                return;\n            let entity;\n            if (dataType === 'item') {\n                entity = getItemByName(dataName);\n            }\n            else if (dataType === 'npc') {\n                entity = getNpcByName(dataName);\n            }\n            if (entity) {\n                tooltip.content = formatTooltipContent(entity, dataType);\n                tooltip.style.top = `${event.clientY + 15}px`;\n                tooltip.style.left = `${event.clientX + 15}px`;\n                tooltip.visible = true;\n            }\n        };\n        const handleMouseOut = () => {\n            tooltip.visible = false;\n        };\n        const formatTooltipContent = (entity, type) => {\n            if (type === 'item') {\n                return `\n      <div class=\"tooltip-title\">${entity.} [${entity.}]</div>\n      <div class=\"tooltip-description\">${entity.}</div>\n      <div class=\"tooltip-level\">: ${entity.}</div>\n    `;\n            }\n            if (type === 'npc') {\n                return `\n      <div class=\"tooltip-title\">${entity.}</div>\n      <div class=\"tooltip-description\">${entity.}</div>\n      <div class=\"tooltip-identity\">: ${entity..join(', ')}</div>\n    `;\n            }\n            return '';\n        };\n        const handleSubmit = (action) => {\n            emit('submit-action', action);\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", {\n                    class: \"narrative-container\",\n                    innerHTML: processedNarrative.value,\n                    onMouseover: handleMouseOver,\n                    onMouseout: handleMouseOut\n                }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_2),\n                _createVNode(EnhancedInputBox, {\n                    placeholder: \"...\",\n                    onSubmitAction: handleSubmit\n                }),\n                _createCommentVNode(\" Tooltip \"),\n                (tooltip.visible)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 0,\n                        class: \"narrative-tooltip\",\n                        style: _normalizeStyle(tooltip.style),\n                        innerHTML: tooltip.content\n                    }, null, 12 /* STYLE, PROPS */, _hoisted_3))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./MainContentView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MainContentView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MainContentView.vue?vue&type=style&index=0&id=4453ae69&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-4453ae69\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = { class: \"npc-list-panel\" };\nconst _hoisted_2 = { class: \"panel-section\" };\nconst _hoisted_3 = { class: \"npc-list\" };\nconst _hoisted_4 = { class: \"npc-name\" };\nconst _hoisted_5 = { class: \"npc-relationship\" };\nimport { ref, onMounted } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcListView',\n    setup(__props) {\n        const npcs = ref([]);\n        onMounted(() => {\n            // Mock data for display purposes\n            // In a real scenario, you would fetch this from the game state\n            npcs.value = [\n                { id: 'yukinoshita_yukino', name: '', favorability: 55 },\n                { id: 'yuigahama_yui', name: '', favorability: 60 },\n            ];\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"section-title\" }, \"NPC \", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(npcs.value, (npc) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: npc.id,\n                                class: \"npc-item\"\n                            }, [\n                                _createElementVNode(\"div\", _hoisted_4, _toDisplayString(npc.name), 1 /* TEXT */),\n                                _createElementVNode(\"div\", _hoisted_5, \": \" + _toDisplayString(npc.favorability), 1 /* TEXT */)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcListView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcListView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcListView.vue?vue&type=style&index=0&id=e354837a&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-e354837a\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"world-state-panel\" };\nconst _hoisted_2 = { class: \"panel-section\" };\nconst _hoisted_3 = { class: \"state-list\" };\nimport { ref, onMounted, computed } from 'vue';\nimport AttributeDisplay from '../components/AttributeDisplay.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'WorldStateView',\n    setup(__props) {\n        const worldState = ref(null);\n        const currentTime = computed(() => {\n            if (!worldState.value)\n                return '';\n            const time = worldState.value.;\n            return `${time.}-${time.}-${time.} ${time.}:${time.} (${time.})`;\n        });\n        onMounted(() => {\n            // Mock data for display purposes\n            worldState.value = {\n                : {\n                    : 2024,\n                    : 9,\n                    : 1,\n                    : 8,\n                    : 0,\n                    : '',\n                },\n                : '',\n                : '',\n                : 22,\n                : 100,\n                : 'Y2K',\n            };\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: currentTime.value\n                        }, null, 8 /* PROPS */, [\"value\"]),\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: worldState.value?. || 'N/A'\n                        }, null, 8 /* PROPS */, [\"value\"]),\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: worldState.value?. || 'N/A'\n                        }, null, 8 /* PROPS */, [\"value\"]),\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: `${worldState.value?. || 'N/A'}C`\n                        }, null, 8 /* PROPS */, [\"value\"]),\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: worldState.value?. || 0\n                        }, null, 8 /* PROPS */, [\"value\"]),\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: worldState.value?. || 'N/A'\n                        }, null, 8 /* PROPS */, [\"value\"])\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","import { createApp } from 'vue';\nimport { createMemoryHistory, createRouter, RouteRecordRaw } from 'vue-router';\nimport App from '../app.vue';\nimport CharacterView from '../views/CharacterView.vue';\nimport InventoryView from '../views/InventoryView.vue';\nimport MainContentView from '../views/MainContentView.vue';\nimport NpcListView from '../views/NpcListView.vue';\nimport WorldStateView from '../views/WorldStateView.vue';\n\n// \nconst routes: RouteRecordRaw[] = [\n  { path: '/', component: MainContentView },\n  { path: '/character', component: CharacterView },\n  { path: '/npc-list', component: NpcListView },\n  { path: '/inventory', component: InventoryView },\n  { path: '/world-state', component: WorldStateView },\n];\n\nconst router = createRouter({\n  history: createMemoryHistory(),\n  routes,\n});\n\n// \nrouter.replace('/');\n\n$(() => {\n  createApp(App).use(router).mount('#app');\n});\n","/* unplugin-vue-components disabled */import script from \"./WorldStateView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./WorldStateView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./WorldStateView.vue?vue&type=style&index=0&id=e33a51b8&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.27_typescript@6.0.0-dev.20250807__webpack@5.104.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-e33a51b8\"]])\n\nexport default __exports__","import { watch } from 'vue';\nimport 'golden-layout/dist/css/goldenlayout-base.css';\nimport 'golden-layout/dist/css/themes/goldenlayout-dark-theme.css';\nimport { commandService } from './services/CommandService';\nimport { entityIndexService } from './services/EntityIndexService';\nimport { inputModalActions, inputModalState } from './services/InputModalService';\nimport { logSyncService } from './services/LogSyncService';\nimport { memoryService } from './services/MemoryService';\nimport { npcService } from './services/NpcService';\nimport { saveLoadService } from './services/saveLoadService';\nimport { serviceLocator } from './services/service-locator';\nimport { tavernService } from './services/tavern';\nimport { actions, store } from './store';\nimport './styles/main.scss';\nimport './core/vue-loader';\n\n// 1. \nactions.loadAllData();\n\n// 2. \nserviceLocator.register('saveLoadService', saveLoadService);\nserviceLocator.register('inputModalState', inputModalState);\nserviceLocator.register('inputModalActions', inputModalActions);\nserviceLocator.register('store', store);\nserviceLocator.register('actions', actions);\n\n// 3.  store.isReady \nconst unwatch = watch(\n  () => store.isReady,\n  isReady => {\n    if (isReady) {\n      console.log('[Startup] Store is ready, proceeding with service initialization.');\n      initializeDependentServices();\n      unwatch(); // \n    }\n  },\n  { immediate: true }, //  isReady  true\n);\n\n/**\n *  worldState \n */\nasync function initializeDependentServices() {\n  if (!store.worldState) {\n    console.error('[Startup] worldState is null after store is ready. Aborting dependent service initialization.');\n    return;\n  }\n  await npcService.initializeWorldAndLocationData();\n  await entityIndexService.buildIndex(store.worldState);\n\n  console.log('All services initialized.');\n  handleRerollRestore();\n\n  // \n  logSyncService.startPolling(15000);\n\n  //  worldLog \n  watch(\n    () => store.worldLog,\n    (newLog, oldLog) => {\n      if (newLog.length > (oldLog?.length || 0)) {\n        console.log('[Auto-Memory] World log updated, triggering memory update.');\n        memoryService.updateMemory(newLog);\n      }\n    },\n    { deep: true },\n  );\n}\n\nfunction handleRerollRestore() {\n  const shouldRestore = localStorage.getItem('reincarnation-simulator-restore-input');\n  if (shouldRestore === 'true') {\n    console.log('[Startup] Restore flag found, restoring last input.');\n    const lastInput = localStorage.getItem('reincarnation-simulator-last-submitted');\n    if (lastInput) {\n      inputModalActions.setValue(lastInput);\n      inputModalActions.show();\n    }\n    localStorage.removeItem('reincarnation-simulator-restore-input');\n  }\n}\n\n// \nsaveLoadService;\ncommandService;\ntavernService;\n"],"names":["exports","sfc","props","target","__vccOpts","key","val","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","module","__webpack_modules__","n","getter","__esModule","d","a","definition","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","Vue","commandService","commands","listeners","subscribe","listener","this","push","unsubscribe","filter","l","notify","forEach","addCommand","command","getCommands","clearCommands","entityIndexService","indexByName","Map","indexById","isInitialized","buildIndex","worldState","console","log","clear","characters","charId","char","addEntity","id","name","type","size","findByName","findById","entity","existingByName","set","has","_","contextService","analyzeUserIntent","userInput","availableRipples","intent","actionType","explicitEntities","locations","dbItems","triggeredRipples","activeWorld","values","find","w","includes","avatarId","currentPlayer","currentLocationId","parentId","worldChars","intentScores","combat","inventory","social","exploration","creation","default","regex","weight","test","maxScore","bestIntent","score","entries","potentialNames","match","results","meta","source","loadFullPlayerData","activeWorldId","keys","wId","worldId","crossContextQuery","items","ripple","influence","sphereOfInfluence","isTriggered","locationIds","rippleEntities","extractEntitiesFromText","content","text","entities","identifyCoreEntities","currentCharacterId","Set","Array","from","allCharacters","currentUser","add","causalNet","playerRelations","sortedRelations","map","rel","intimacy","conflict","sort","b","length","mostHostile","character","buildLeanContext","userId","stat_data","leanState","playerFullData","playerLeanData","simplifyIdMap","coreEntities","activeWorldEntry","epochId","activeEpoch","leanEpoch","allLocations","leanLocations","locId","loc","parent","leanChars","sceneEntities","allActiveCharIds","fullCausalNet","activeCharIds","subjectId","relations","objectId","referencedDbIds","fullDatabase","category","categoryStore","itemId","targetWorld","targetDb","store","simple","processKeyValue","line","indent","stack","separatorIndex","indexOf","substring","trim","valueStr","newChild","level","startsWith","endsWith","newObj","pairs","slice","split","p","pair","parseValue","trimmed","inner","parts","buffer","inQuotes","bracketLevel","i","part","e","toLowerCase","isNaN","Number","LOREBOOK_NAME","entriesCache","async","getEntries","forceRefresh","TavernHelper","getLorebookEntries","error","readFromLorebook","entryName","entry","comment","writeToLorebook","options","isEnabled","allEntries","targetEntry","setLorebookEntries","uid","enabled","baseKey","replace","baseEntryTemplate","newEntryData","position","order","assign","selective","constant","case_sensitive","JSON","stringify","createLorebookEntries","lorebookService","appendToEntry","newContent","separator","existingContent","findEntryByComment","warn","setEntryEnabled","updatedEntry","loadAndParseWorldData","worldName","worldData","startIndex","lines","root","indentMatch","trimmedLine","pop","parentObj","listItemContent","isArray","grandParent","lastKey","newListItem","parseWorldLoreForMap","currentEpochId","firstPlayableEpoch","epoch","state","reactive","notifications","nextId","actions","show","title","message","duration","setTimeout","hide","index","findIndex","splice","success","info","notificationState","notificationService","registry","serviceLocator","register","instance","Error","tavernService","fetchTavernData","debug","messages","getChatMessages","getCurrentMessageId","generateAiResponse","prompt","variables","generateConfig","injects","role","should_scan","should_stream","aiResponse","generate","invokeMvuScript","script","oldVariables","inputData","old_variables","eventEmit","new_variables","z","threshold","Infinity","enum","findStage","stages","currentStage","stage","object","coerce","number","string","transform","ID","Date","getTime","url","or","literal","discriminatedUnion","v","Math","max","min","currentLevelInfo","nextLevelIndex","nextLevelInfo","array","date","record","optional","RootSchema","Yukinoshita_Yukino","Hikigaya_Hachiman","Yuigahama_Yui","shape","USER_ID","isReady","narrative","mainWorldNarrative","avatarWorldNarrative","activeView","isGenerating","generationError","lastSubmittedAction","worldLog","sanitizeStateData","data","watch","newState","oldState","deep","isLogHistoryLoaded","ZOD_ERROR_NOTIFIED_KEY","isZodErrorNotified","sessionStorage","getItem","checkForChangesAndNotify","oldCharIds","newCharIds","newChar","relId","oldRel","newRel","targetName","oldChar","attrKey","oldAttr","newAttr","oldCardIds","newCardIds","cardId","newCard","oldQuestIds","newQuestIds","questId","newQuest","fetchCoreData","rawStateData","cloneDeep","parseResult","safeParse","removeItem","firstIssue","issues","errorMessage","path","join","setItem","fullMessageContent","gameTextContent","loadAllData","logContent","loadWorldLogFromLorebook","parseBlock","block","currentKey","handleAction","actionText","contextVariables","aiResponseString","processedText","thinkingOpenIndex","thinkingCloseIndex","gametxtOpenIndex","newThinkingCloseIndex","gametxtOpenIndexAgain","gametxtCloseIndex","nextTagIndex","processTags","response","gameTextMatch","logRegex","logMatch","exec","newLogEntry","parseInt","t","Boolean","some","fullLogContent","updateScriptMatch","updateScript","jsonPatchMatch","patchString","patch","parse","newVariables","sanitizedVars","processAiResponse","messageZero","newData","setChatMessages","refresh","String","rerollLastAction","saveLoadService","loadRerollState","initializeEventListeners","eventOn","tavern_events","GENERATION_ENDED","STORAGE_KEY","LAST_SUBMITTED_STORAGE_KEY","isVisible","inputValue","localStorage","lastSubmittedValue","setValue","setLastSubmittedValue","clearValue","inputModalState","readonly","inputModalActions","eventBus","events","on","event","callback","off","cb","emit","args","memoryService","INSTANT_MEMORY_KEY","SHORT_TERM_MEMORY_KEY","LONG_TERM_MEMORY_KEY","config","instantMemoryCount","shortTermMemoryCount","longTermMemoryCount","updateMemory","updateInstantMemory","updateShortTermMemory","updateLongTermMemory","logs","writeMemory","coreInteraction","relationChange","coreConflict","getConfig","setConfig","newConfig","logSyncService","pollingInterval","isSyncing","startPolling","interval","stopPolling","setInterval","syncLogsFromChat","clearInterval","allParsedLogs","logBlockRegex","is_user","existingLogIds","newLogs","finalContentToAppend","logBlock","memError","locationCache","npcService","allNpcs","computed","npcs","initializeWorldAndLocationData","getLocationName","getNpcNameById","getNpcId","npc","getParentLocationName","toastr","SAVE_SLOT_PREFIX","AUTO_SAVE_SLOTS","REROLL_SAVE_SLOT_ID","LOREBOOK_KEYS_TO_BACKUP","manualSlots","autoSlots","rerollSlot","turnCounter","isAutoSaveEnabled","autoSaveInterval","areSlotsLoaded","constructor","initializeSlots","loadAutoSaveState","loadTurnCounter","ensureSlotsLoaded","loadAllSaveSlots","timestamp","updateSlot","slot","worldLogDate","worldLogTitle","entryUid","saveGame","slotId","isAutoSave","toISOString","lorebookBackup","lastLogEntry","saveData","mvu_data","message_content","lorebook_backup","existingEntry","_internalLoadGame","loadGame","confirm","deleteSave","deleteLorebookEntries","performAutoSave","toString","saveStateForReroll","window","location","reload","exportSave","dataStr","dataBlob","Blob","URL","createObjectURL","link","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL","importSave","jsonContent","emptySlot","toggleAutoSave","savedState","savedCounter","VueRouter","_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","style","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","__name","commandCount","mainOptions","avatarOptions","commonOptions","emits","setup","__props","_ctx","_cache","option","disabled","onClick","action","$event","$emit","STORAGE_KEY_RECENT","STORAGE_KEY_SAVED","inputHistoryService","recent","saved","loadHistory","recentData","savedData","saveHistory","input","existingIndex","unshift","save","deleteRecent","deleteSaved","clearAll","COT_FILES","NORMAL","CREATION","IDENTITY","workflowService","currentState","narrativeCache","updateScriptCache","preserveMode","switchTo","getCurrentState","force","allCots","flat","cotsToEnable","cotName","shouldBeEnabled","cacheNarrative","popNarrative","cacheUpdateScript","popUpdateScript","setPreserveMode","mode","popPreservedContent","placeholder","__emit","onInput","submitAction","trimmedInput","hasCommands","combinedContent","cmd","onKeypress","historyState","useEntry","isSaved","notification","hideNotification","Notification","icon","handleClick","x","clientX","y","clientY","playerCharacter","player","chapterInfo","chapter","details","worldTimeStr","time","toLocaleString","year","month","day","hour","minute","hour12","combinedNarrative","component","detailModalService","markRaw","age","formattedBirthDate","bd","getFullYear","getMonth","getDate","item","trait","toLocaleDateString","attributes","levelInfo","expToNextLevel","expPercentage","skills","description","attr","width","skill","label","color","displayValue","isBidirectional","fillStyle","left","right","backgroundColor","abs","vectorGroups","vectors","ref","immediate","expandedRelation","getFormattedTags","relation","causeTags","tag","relationName","group","vector","ProgressBar","npcId","RelationsDisplay","activeTab","tabs","tab","active","NpcArchiveTab","NpcAttributesTab","NpcCauseTab","locationId","required","locationDetails","world","historicalEpochs","parentLocationName","cleanValue","formatArea","area","formatCoordinates","coords","refId","refName","bearingParts","direction","angle","distanceParts","effects","attributes_bonus","percentage_bonus","npcNamesRegex","names","escapedNames","RegExp","locationNamesRegex","mainWorld","avatarWorld","databaseItemNamesRegex","database","segments","lastIndex","parseEntities","matchedText","innerText","outerClass","segment","combinedClass","parseText","entityRegexParts","entityRegex","getItemFromDatabase","relationshipClass","getNpcRelationshipClass","relationship","emotionalSum","npcName","NpcDetailDisplay","showNpcInfo","locationName","LocationInfoCard","showLocationInfo","DatabaseItemCard","FormattedTextRenderer","viewBox","defaultDescription","centerTitle","centerDescription","getDisplayValue","defaultValue","characterData","innerRingNodes","combatParams","orbitalNodes","attrs","currentEpoch","attributeTemplates","specialKeys","attrValue","template","isSpecial","valueKeys","k","current","every","setCenterContent","resetCenterContent","node","onMouseenter","onMouseleave","param","cx","cy","formatAttribute","worldSpecificAttributes","currentAvatar","combatAttributes","isDrawerOpen","DestinyPlate","selectedItem","closeDetail","avatarItems","avatarInventory","tierColorMap","common","rare","epic","legendary","getTierStyle","tierKey","tier","fill","startOffset","destiny","allTasks","taskObject","ultimateTask","destinyNodes","task","derivedTasks","selectedNode","detailModalStyle","top","getTaskNameById","taskId","starPositions","positions","totalNodes","progress","sin","PI","starPaths","paths","startPos","endPos","parseFloat","lastNodePos","ultimatePos","parentNode","parentNodeIndex","parentPos","taskPos","getDerivedStarPosition","offsetX","floor","offsetY","selectNode","nodeData","el","currentTarget","starNode","startDrag","modal","closest","startX","startY","startTop","offsetTop","startLeft","offsetLeft","doDrag","stopDrag","removeEventListener","addEventListener","getStarPosition","x1","y1","x2","y2","offset","triggered","onMousedown","formatAttributeValue","rest","daoHeart","worldAttributes","playerWorldAttributes","imprint","imprints","reincarnationImprints","paddedImprints","result","empty","clickable","ImprintDetailModal","openImprintDetail","isText","selectedCategory","groupedItems","playerInventory","groups","firstCategoryWithItems","itemsInSelectedCategory","selected","ItemDetailPanel","selectedNpc","selectedNpcId","npcSearchTerm","filteredNpcs","expandedLog","logId","ripplesService","ripples","initialize","loadRipples","rippleContent","rippleBlocks","parsedRipples","blockContent","blockData","rippleId","rawContent","getRippleById","selectedRipple","onMounted","avatars","reincarnationAvatarOptions","avatar","selectAvatarAndStart","onConfirm","onCancel","hideCancel","confirmationService","Promise","resolve","cancel","choice","isSelected","selectCard","selectedChoice","choices","choicesObj","c","confirmChoice","mainCharacter","soulEssence","SettlementChoiceCard","onSelect","StarMapService","scene","camera","renderer","controls","container","stars","skybox","starObjects","speedMultiplier","clientWidth","clientHeight","antialias","alpha","init","domElement","enableDamping","dampingFactor","autoRotate","autoRotateSpeed","minDistance","maxDistance","enablePan","panSpeed","animate","setSize","setPixelRatio","devicePixelRatio","onWindowResize","bind","createSkybox","shaderMaterial","vertexShader","fragmentShader","uniforms","u_time","side","skyboxGeometry","getColorForEnergyLevel","createStars","worlds","selectableIds","existingStarIds","s","userData","newWorldIds","star","remove","createSingleStar","isSelectable","energyLevel","baseColor","newColor","core","children","halo","material","lerp","coreGeometry","haloGeometry","phi","acos","random","theta","sqrt","cos","timeFlow","starColor","coreMaterial","haloMaterial","transparent","opacity","blending","scale","starGroup","orbitSpeed","log1p","orbitRadius","orbitAngle","atan2","requestAnimationFrame","update","render","aspect","updateProjectionMatrix","destroy","dispose","pickStar","raycaster","mouse","rect","getBoundingClientRect","height","setFromCamera","intersects","intersectObjects","setSpeedMultiplier","multiplier","getSpeedMultiplier","starmapContainer","starMapService","isLoading","detailedWorld","selectableWorldIds","progressInterval","activeEpochId","speedLevels","speedLevel","parsedWorlds","idCounter","epochs","epochData","coreLaws","law","raw","originalId","cosmologicalBlueprint","physicalScale","cooldown","simulatorCooldown","isDetailedWorldActive","isSimulationRunning","status","selectRandomWorlds","ids","shuffled","handleCanvasClick","pickedWorld","newWorld","newContainer","fetchReincarnationWorlds","onUnmounted","newWorlds","isRunning","wasRunning","adjustSpeed","delta","newLevel","ref_key","visible","triggerIdentityWorkflow","resetReincarnationSelection","triggerCreationWorkflow","reincarnationStatus","simulatorStatus","statusText","remainingTime","newStatus","WorldSelection","AvatarSelection","SettlementView","LogPanel","RipplesPanel","toRefs","playerSkills","expandedSkills","isExpanded","skillId","exp","associatedSkills","expanded","activeSkill","isAutoMemoryEnabled","memoryContent","instant","short","long","activeMemoryContent","fetchMemoryContent","all","updateConfig","forceUpdate","handleMemoryUpdate","for","_hoisted_24","_hoisted_25","defineComponent","fileInput","loadSlots","formatTimestamp","handleFileImport","files","file","reader","FileReader","onload","readAsText","slotToExport","$props","$setup","$data","$options","onChange","accept","SaveLoadPanel","MemoryPanel","realm","req","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","worldType","worldSummary","availableEpochs","selectedEpochId","definitions","innerHTML","RealmDetailCard","colorService","colorCache","colorScale","simpleHash","str","hash","charCodeAt","getColor","coordinateService","baseAngleMap","parseAzimuth","azimuthValue","baseDirection","offsetDegrees","baseAngle","normalizeDistance","distance","unit","getCartesianCoordinates","relativeCoord","azimuth","matches","toUpperCase","theoreticalDistance","calculateRelativePositions","allDistances","child","distanceScale","domain","range","clamp","coord","isOverlapping","isVertical","visualDistance","worldMapDataService","hierarchyCache","getMapHierarchy","cacheKey","spatialEntities","entitiesArray","hierarchy","buildHierarchy","clearCache","nodeMap","rootNodes","childCount","radius","currentRootId","navigationPath","isDetailPanelVisible","userLocationId","avatarLocationId","navigateToNode","crumb","navigateBack","targetId","targetIndex","hideDetail","setNavigationPath","setWorldData","setPlayerLocations","user","mapState","mapActions","nodeId","associatedResources","resources","resource","associatedFactions","factionsSource","faction","panelRef","panel","querySelector","isDragging","onDragMove","moveEvent","dx","dy","onDragEnd","querySelectorAll","handle","stopPropagation","dataset","isResizing","startWidth","offsetWidth","startHeight","offsetHeight","onResizeMove","onResizeEnd","svgRef","fullHierarchy","layoutNodes","layoutLinks","searchText","isSearchPanelVisible","findNode","found","currentRootNode","allNodes","nodes","traverse","searchResults","jumpToNode","newNavPath","jumpToFirstResult","searchBtnRef","renderD3","links","clickTimers","svg","zoomContainer","selectAll","zoomContainerEnter","enter","append","g","merge","zoom","scaleExtent","transition","visualCenterNode","distances","exit","nodeGroups","nodeEnter","brighter","existingTimeout","clearTimeout","delete","newTimeout","newRoot","rootCopy","nodesToRender","nextTick","userLocation","avatarLocation","foundAvatar","starFieldSize","select","btn","onMouseMove","parentElement","containerRect","onMouseUp","bottom","onmousedown","initDraggableSearchBtn","handleClickOutside","searchPanel","contains","onActivated","onNavigateBack","MapNavigator","onNavigate","onKeyup","getFullPath","NodeDetailPanel","onClose","rootElRef","isStarfieldInitialized","mainWorldActiveEpoch","updateAndRenderMap","debounce","mainNode","classed","observer","ResizeObserver","observe","disconnect","panelRegistry","CharacterPanel","InventoryPanel","SkillsPanel","ImprintsPanel","worldDetails","WorldDetailsPanel","sandbox","AvatarCharacterPanel","AvatarInventoryPanel","tasks","AvatarTasksPanel","AvatarWorldMapView","reincarnation","main","ReincarnationPanel","allWorlds","npcDirectory","NpcDirectoryPanel","detail","RippleDetailPanel","system","saveLoad","SystemPanel","dockManagerService","goldenLayout","hostElement","componentMap","onAction","registerComponent","MainView","componentName","panelInfo","updateLayout","loadLayout","getDefaultLayout","e2","loadSavedLayout","componentState","vueComponent","h","vnode","getElement","setTitle","panelId","openPanel","addComponent","updateSize","closeAllPanels","rootItem","contentItems","isClosable","unpinAllPanels","componentType","getFullscreenLayout","usePanelManager","finalProps","dockHost","onBeforeUnmount","tips","randomTip","stopProgress","newError","getNpcsByWorld","$","originalStyles","fullscreenService","enterWeb","iframeSelector","iframes","getElementsByTagName","contentWindow","iframe","src","getAttribute","srcFileName","getIframeSelector","elementsToModify","zIndex","border","borderRadius","display","maxHeight","selector","$element","newStyles","css","documentElement","addClass","exitWeb","removeClass","toggleBrowser","onBrowserChange","isBrowserFullscreen","npcModalService","isWebFullscreen","isFullscreen","toggleBrowserFullscreen","toggleWebFullscreen","newFullscreenState","uiState","uiActions","toggleFullscreen","openSaveLoadPanel","openInputModal","fullscreenTitle","fullscreenIcon","timeString","mainWorldTimeStr","NORMAL_LAYOUT_KEY","FULLSCREEN_LAYOUT_KEY","layoutService","activePanels","fullscreenPanels","loadAllLayouts","addPanel","removePanel","handleFullscreenChange","normalState","fullscreenState","saveLayoutState","currentMap","restoreLayout","panelsToRestore","setCurrentFullscreenState","components","DockManager","EnhancedInputBox","LoadingIndicator","NpcListModal","TopStatusBar","WorldTimeDisplay","SideMenuButton","NotificationContainer","ActionPanel","InputHistoryPopup","confirmation","detailModal","npcModal","inputModal","isActionPanelVisible","isHistoryVisible","isQueueVisible","menuOptions","actionContent","updateCommands","getElementById","panels","panelState","handleSubmit","rawInput","handleOverlayClick","toggleActionPanel","toggleHistory","selectHistoryEntry","toggleCommandQueue","_component_TopStatusBar","_component_DockManager","_component_LoadingIndicator","_component_NpcListModal","_component_ActionPanel","_component_EnhancedInputBox","_component_InputHistoryPopup","_component_NotificationContainer","onToggleHistory","onToggleCommands","onSubmitAction","onToggleActionPanel","onSelectEntry","secondaryAttributes","todayCourses","getBaseAttributes","getSubjects","getSkills","getTalents","getRelationships","getters","baseAttributes","subjects","talents","relationships","AttributeDisplay","subject","talent","course","quantity","tooltip","processedNarrative","handleMouseOver","dataType","dataName","getItemByName","getNpcByName","formatTooltipContent","handleMouseOut","onMouseover","onMouseout","favorability","currentTime","routes","MainContentView","CharacterView","NpcListView","InventoryView","router","createRouter","history","createMemoryHistory","createApp","use","mount","unwatch","lastInput","handleRerollRestore","newLog","oldLog","initializeDependentServices"],"ignoreList":[],"sourceRoot":""}