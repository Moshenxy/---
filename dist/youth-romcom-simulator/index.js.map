{"version":3,"file":"index.js","mappings":"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","sources":["src://tavern_helper_template/src/youth-romcom-simulator/services/DebugService.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/DestinyCardService.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/DetailModalService.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/DiarySynthesisService.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/EntityIndexService.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/EventBus.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/LorebookService.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/MemoryService.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/NotificationService.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/NpcService.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/StorylineService.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/WorkflowService.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/saveLoadService.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/service-locator.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/tavern.ts","src://tavern_helper_template/src/youth-romcom-simulator/store/getters.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/MemoryRetrievalService.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/ContextService.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/WorldEvolutionService.ts","src://tavern_helper_template/src/youth-romcom-simulator/store/actions.ts","src://tavern_helper_template/src/youth-romcom-simulator/utils/tagProcessor.ts","src://tavern_helper_template/src/youth-romcom-simulator/store/state.ts","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/cards/DestinyCard.vue?9a22","webpack://tavern_helper_template/src/youth-romcom-simulator/components/cards/DestinyCard.vue?6e10","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/DatabaseItemCard.vue?aa45","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/DatabaseItemCard.vue?d1f6","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/LocationInfoCard.vue?d00e","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/LocationInfoCard.vue?fafd","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/AttributeGrid.vue?452a","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/AttributeGrid.vue?80fe","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/npc-details/NpcArchiveTab.vue?c279","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/npc-details/NpcArchiveTab.vue?4a01","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/npc-details/ComplexAttribute.vue?3232","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/npc-details/ComplexAttribute.vue?5a9b","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/ObjectRendererItem.vue?2e3f","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/ObjectRendererItem.vue?e747","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/ObjectRenderer.vue?71f1","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/ObjectRenderer.vue?fa7d","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/npc-details/NpcPowerTab.vue?9e8f","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/npc-details/NpcPowerTab.vue?76f0","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/ProgressBar.vue?c703","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/ProgressBar.vue?558a","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/RelationsDisplay.vue?1b2a","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/RelationsDisplay.vue?e661","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/InventoryGrid.vue?5c6f","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/InventoryGrid.vue?308b","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/npc-details/NpcCauseTab.vue?c4cb","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/npc-details/NpcCauseTab.vue?9267","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/NpcDetailDisplay.vue?13d9","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/NpcDetailDisplay.vue?71aa","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/DebugPanel.vue?3094","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/DebugPanel.vue?1bce","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/destiny/CardBackpackTab.vue?c959","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/destiny/CardBackpackTab.vue?0a86","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/DestinyCardPanel.vue?226f","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/DestinyCardPanel.vue?50fe","src://tavern_helper_template/src/youth-romcom-simulator/services/diaryService.ts","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/DiaryPanel.vue?61da","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/DiaryPanel.vue?1738","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/inventory/ItemDetailPanel.vue?59f4","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/inventory/ItemDetailPanel.vue?f513","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/InventoryPanel.vue?7a2d","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/InventoryPanel.vue?3030","src://tavern_helper_template/src/youth-romcom-simulator/services/useFollowSystem.ts","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/FollowButton.vue?128a","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/FollowButton.vue?fbda","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/NpcDirectoryPanel.vue?99eb","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/NpcDirectoryPanel.vue?f46a","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/ReincarnationPanel.vue?bbb8","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/ReincarnationPanel.vue?14c6","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/SkillsPanel.vue?311c","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/SkillsPanel.vue?510c","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/MemoryPanel.vue?2aca","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/MemoryPanel.vue?df07","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/SaveLoadPanel.vue?8dd9","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/SaveLoadPanel.vue?694b","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/SaveLoadPanel.vue?43ca","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/SystemPanel.vue?0614","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/SystemPanel.vue?2396","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/RealmDetailCard.vue?4954","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/RealmDetailCard.vue?924c","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/WorldDetailsPanel.vue?bc33","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/WorldDetailsPanel.vue?feea","src://tavern_helper_template/node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js","src://tavern_helper_template/external module \"https://testingcf.jsdelivr.net/npm/dayjs/+esm\"","src://tavern_helper_template/external var \"Vue\"","src://tavern_helper_template/external var \"_\"","src://tavern_helper_template/external var \"toastr\"","src://tavern_helper_template/external var \"z\"","src://tavern_helper_template/webpack/bootstrap","src://tavern_helper_template/webpack/runtime/compat get default export","src://tavern_helper_template/webpack/runtime/define property getters","src://tavern_helper_template/webpack/runtime/hasOwnProperty shorthand","src://tavern_helper_template/webpack/runtime/make namespace object","src://tavern_helper_template/external var \"VueRouter\"","webpack://tavern_helper_template/./src/youth-romcom-simulator/app.vue?6ba6","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/cards/FloatingCard.vue?9445","webpack://tavern_helper_template/src/youth-romcom-simulator/components/cards/FloatingCard.vue?f737","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/ActionPanel.vue?59e6","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/ActionPanel.vue?c219","src://tavern_helper_template/src/youth-romcom-simulator/services/CommandService.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/InputHistoryService.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/InputModalService.ts","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/EnhancedInputBox.vue?15ff","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/EnhancedInputBox.vue?7bdb","src://tavern_helper_template/src/youth-romcom-simulator/components/common/InputHistoryPopup.vue","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/InputHistoryPopup.vue?32d2","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/Notification.vue?fa92","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/Notification.vue?41cb","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/NotificationContainer.vue?222a","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/NotificationContainer.vue?36b2","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/controls/SideMenuButton.vue?2d5f","webpack://tavern_helper_template/src/youth-romcom-simulator/components/controls/SideMenuButton.vue?2e65","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/FormattedTextRenderer.vue?144c","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/FormattedTextRenderer.vue?a7a1","webpack://tavern_helper_template/./src/youth-romcom-simulator/MainView.vue?17a7","webpack://tavern_helper_template/src/youth-romcom-simulator/MainView.vue?0a00","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/TimelinePanel.vue?016c","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/modals/StorylineStageDetail.vue?0669","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/modals/StorylineStageDetail.vue?127e","webpack://tavern_helper_template/src/youth-romcom-simulator/components/modals/StorylineStageDetail.vue?b08b","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/TimelinePanel.vue?c69c","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/TimelinePanel.vue?b001","src://tavern_helper_template/src/youth-romcom-simulator/services/panelRegistry.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/DockManagerService.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/usePanelManager.ts","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/DockManager.vue?d3e0","webpack://tavern_helper_template/src/youth-romcom-simulator/components/DockManager.vue?1193","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/LoadingIndicator.vue?02c2","webpack://tavern_helper_template/src/youth-romcom-simulator/components/LoadingIndicator.vue?5b1e","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/modals/NpcListModal.vue?70a0","webpack://tavern_helper_template/src/youth-romcom-simulator/components/modals/NpcListModal.vue?e07e","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/smartphone/SmartphoneShell.vue?a351","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/AttributeDisplay.vue?2d58","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/AttributeDisplay.vue?eea7","src://tavern_helper_template/src/youth-romcom-simulator/types/index.ts","webpack://tavern_helper_template/./src/youth-romcom-simulator/views/apps/CharacterApp.vue?440e","webpack://tavern_helper_template/src/youth-romcom-simulator/views/apps/CharacterApp.vue?5b0e","webpack://tavern_helper_template/./src/youth-romcom-simulator/views/apps/map/LocationNode.vue?827d","webpack://tavern_helper_template/./src/youth-romcom-simulator/views/apps/map/LocationNode.vue?0b5e","webpack://tavern_helper_template/src/youth-romcom-simulator/views/apps/map/LocationNode.vue?7442","webpack://tavern_helper_template/./src/youth-romcom-simulator/views/apps/MapApp.vue?7502","webpack://tavern_helper_template/src/youth-romcom-simulator/views/apps/MapApp.vue?297b","src://tavern_helper_template/src/youth-romcom-simulator/services/ForumService.ts","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/panels/ForumPanel.vue?201b","webpack://tavern_helper_template/src/youth-romcom-simulator/components/panels/ForumPanel.vue?380f","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/smartphone/AppViewContainer.vue?ec3a","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/smartphone/AppViewContainer.vue?79e5","webpack://tavern_helper_template/src/youth-romcom-simulator/components/smartphone/AppViewContainer.vue?7899","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/smartphone/HomeScreen.vue?85d6","src://tavern_helper_template/src/youth-romcom-simulator/services/SmartphoneService.ts","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/smartphone/AppIcon.vue?58d6","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/smartphone/AppIcon.vue?e3c4","webpack://tavern_helper_template/src/youth-romcom-simulator/components/smartphone/AppIcon.vue?6b07","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/smartphone/HomeScreen.vue?1635","webpack://tavern_helper_template/src/youth-romcom-simulator/components/smartphone/HomeScreen.vue?0379","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/smartphone/SmartphoneShell.vue?38ba","webpack://tavern_helper_template/src/youth-romcom-simulator/components/smartphone/SmartphoneShell.vue?f16a","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/common/ActionPointDisplay.vue?d9ec","webpack://tavern_helper_template/src/youth-romcom-simulator/components/common/ActionPointDisplay.vue?aef4","src://tavern_helper_template/src/youth-romcom-simulator/services/ConfirmationService.ts","src://tavern_helper_template/external var \"$\"","src://tavern_helper_template/src/youth-romcom-simulator/services/fullscreenService.ts","src://tavern_helper_template/src/youth-romcom-simulator/services/NpcModalService.ts","src://tavern_helper_template/src/youth-romcom-simulator/store/ui.ts","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/TopStatusBar.vue?ead9","webpack://tavern_helper_template/src/youth-romcom-simulator/components/TopStatusBar.vue?a7a3","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/WorldTimeDisplay.vue?8e1f","webpack://tavern_helper_template/src/youth-romcom-simulator/components/WorldTimeDisplay.vue?10fd","src://tavern_helper_template/src/youth-romcom-simulator/services/LayoutService.ts","webpack://tavern_helper_template/./src/youth-romcom-simulator/app.vue?e61b","webpack://tavern_helper_template/src/youth-romcom-simulator/app.vue?f04c","webpack://tavern_helper_template/./src/youth-romcom-simulator/components/AttributeDisplay.vue?92f3","webpack://tavern_helper_template/src/youth-romcom-simulator/components/AttributeDisplay.vue?2e3c","webpack://tavern_helper_template/./src/youth-romcom-simulator/views/CharacterView.vue?45f2","webpack://tavern_helper_template/src/youth-romcom-simulator/views/CharacterView.vue?4b9d","webpack://tavern_helper_template/./src/youth-romcom-simulator/views/InventoryView.vue?2f10","webpack://tavern_helper_template/src/youth-romcom-simulator/views/InventoryView.vue?9e93","webpack://tavern_helper_template/./src/youth-romcom-simulator/views/MainContentView.vue?7657","webpack://tavern_helper_template/src/youth-romcom-simulator/views/MainContentView.vue?dbb7","webpack://tavern_helper_template/./src/youth-romcom-simulator/views/NpcListView.vue?594a","webpack://tavern_helper_template/src/youth-romcom-simulator/views/NpcListView.vue?e152","webpack://tavern_helper_template/./src/youth-romcom-simulator/views/WorldStateView.vue?c846","src://tavern_helper_template/src/youth-romcom-simulator/core/vue-loader.ts","webpack://tavern_helper_template/src/youth-romcom-simulator/views/WorldStateView.vue?8f8a","src://tavern_helper_template/src/youth-romcom-simulator/services/LogSyncService.ts","src://tavern_helper_template/src/youth-romcom-simulator/index.ts"],"sourcesContent":["import { reactive } from 'vue';\nimport { lorebookService } from './LorebookService';\n\ninterface DebugInfo {\n  mainStoryStatus: string;\n  mainStoryContent: any;\n  mainStoryStats: {\n    filesLoaded: number;\n    totalEvents: number;\n    actionableEvents: number;\n    foreshadowedEvents: number;\n  };\n  calendarFixedStatus: string;\n  calendarFixedContent: any;\n  calendarRandomStatus: string;\n  calendarRandomContent: any;\n  calendarCrossoverStatus: string;\n  calendarCrossoverContent: any;\n  styleGuideStatus: string;\n  styleGuideContent: any;\n  lastContext: any;\n}\n\nclass DebugService {\n  public state = reactive<DebugInfo>({\n    mainStoryStatus: '',\n    mainStoryContent: null,\n    mainStoryStats: {\n      filesLoaded: 0,\n      totalEvents: 0,\n      actionableEvents: 0,\n      foreshadowedEvents: 0,\n    },\n    calendarFixedStatus: '',\n    calendarFixedContent: null,\n    calendarRandomStatus: '',\n    calendarRandomContent: null,\n    calendarCrossoverStatus: '',\n    calendarCrossoverContent: null,\n    styleGuideStatus: '',\n    styleGuideContent: null,\n    lastContext: null,\n  });\n\n  public async refreshData() {\n    // 1. \n    try {\n      const storyEntryKeys = [\n        '[]_',\n        '[]_',\n        '[]_',\n        '[]_',\n        '[]_',\n        '[]_',\n        '[]_',\n        '[]_',\n        '[]_',\n        '[]_',\n        '[]_',\n        '[]_',\n        '[]_',\n        '[]_',\n        '[]_',\n        '[]_',\n        '[]_',\n        '[]_',\n      ];\n\n      const storyContents = await Promise.all(storyEntryKeys.map(key => lorebookService.readFromLorebook(key)));\n\n      const loadedStories = storyContents\n        .filter(c => c)\n        .map(c => {\n          try {\n            return JSON.parse(this._cleanJsonString(c!));\n          } catch {\n            return null;\n          }\n        })\n        .filter(Boolean);\n\n      if (loadedStories.length > 0) {\n        this.state.mainStoryContent = loadedStories;\n        this.state.mainStoryStatus = ` (${loadedStories.length}/${storyEntryKeys.length})`;\n        const totalEvents = loadedStories.reduce((acc, story) => acc + (story.timeline?.length || 0), 0);\n        this.state.mainStoryStats.filesLoaded = loadedStories.length;\n        this.state.mainStoryStats.totalEvents = totalEvents;\n      } else {\n        this.state.mainStoryStatus = '';\n      }\n    } catch (e) {\n      this.state.mainStoryStatus = `${(e as Error).message}`;\n    }\n\n    // 2. \n    await this.loadDebugEntry('[]-', 'calendarFixedStatus', 'calendarFixedContent');\n    await this.loadDebugEntry('[]-', 'calendarRandomStatus', 'calendarRandomContent');\n    await this.loadDebugEntry('[]-', 'calendarCrossoverStatus', 'calendarCrossoverContent');\n\n    // 3. \n    await this.loadDebugEntry('[]', 'styleGuideStatus', 'styleGuideContent');\n  }\n\n  public setLastContext(context: any) {\n    this.state.lastContext = context;\n  }\n\n  public setMainStoryStats(stats: {\n    filesLoaded: number;\n    totalEvents: number;\n    actionableEvents: number;\n    foreshadowedEvents: number;\n  }) {\n    this.state.mainStoryStats = stats;\n  }\n\n  private async loadDebugEntry(entryKey: string, statusKey: keyof DebugInfo, contentKey: keyof DebugInfo) {\n    try {\n      const content = await lorebookService.readFromLorebook(entryKey);\n      if (content) {\n        (this.state as any)[contentKey] = JSON.parse(this._cleanJsonString(content));\n        (this.state as any)[statusKey] = '';\n      } else {\n        (this.state as any)[statusKey] = '';\n      }\n    } catch (e) {\n      (this.state as any)[statusKey] = `${(e as Error).message}`;\n    }\n  }\n\n  private _cleanJsonString(str: string): string {\n    try {\n      JSON.parse(str);\n      return str;\n    } catch (e) {\n      const firstBrace = str.indexOf('{');\n      const lastBrace = str.lastIndexOf('}');\n      if (firstBrace !== -1 && lastBrace !== -1 && lastBrace > firstBrace) {\n        return str.substring(firstBrace, lastBrace + 1);\n      }\n    }\n    return str;\n  }\n}\n\nexport const debugService = new DebugService();\n","import { computed, type ComputedRef } from 'vue';\nimport { store } from '../store';\nimport type {  as Card } from '../types';\n\n/**\n * \n * @description  `` \n */\nclass DestinyCardService {\n  /**\n   * \n   * @description  state \n   */\n  get activeCards(): ComputedRef<Card[]> {\n    return computed(() => {\n      const activeCardId = store.worldState?..;\n      if (!activeCardId) {\n        return [];\n      }\n      const allPlayerCards = this.playerBackpackCards.value;\n      const activeCard = allPlayerCards.find(card => card.ID === activeCardId);\n      return activeCard ? [activeCard] : [];\n    });\n  }\n\n  /**\n   * \n   * @description  state \n   */\n  get playerBackpackCards(): ComputedRef<Card[]> {\n    return computed(() => {\n      const protagonist = store.worldState?.;\n      if (\n        typeof protagonist === 'object' &&\n        protagonist &&\n        '' in protagonist &&\n        Array.isArray(protagonist.)\n      ) {\n        //  `.txt`\n        //  TypeScript \n        return protagonist. as Card[];\n      }\n      return [];\n    });\n  }\n}\n\nexport const destinyCardService = new DestinyCardService();\n","import { reactive, markRaw, readonly } from 'vue';\nimport type { Component } from 'vue';\n\ninterface DetailModalState {\n  isVisible: boolean;\n  component: Component | null;\n  props: Record<string, any>;\n  title: string;\n}\n\nconst state = reactive<DetailModalState>({\n  isVisible: false,\n  component: null,\n  props: {},\n  title: '',\n});\n\nexport const detailModalService = {\n  /**\n   * The reactive state of the detail modal.\n   */\n  state: readonly(state),\n\n  /**\n   * Shows a modal with a specified component and props.\n   * @param title The title to display in the modal header.\n   * @param component The Vue component to render inside the modal.\n   * @param props The props to pass to the component.\n   */\n  show(title: string, component: Component, props: Record<string, any> = {}) {\n    state.title = title;\n    state.component = markRaw(component);\n    state.props = props;\n    state.isVisible = true;\n  },\n\n  /**\n   * Hides the currently visible modal.\n   */\n  hide() {\n    state.isVisible = false;\n    // Delay clearing to allow for fade-out animations\n    setTimeout(() => {\n      state.component = null;\n      state.props = {};\n      state.title = '';\n    }, 300);\n  },\n};\n","import { serviceLocator } from './service-locator';\n\nconst DAILY_SYNTHESIS_THRESHOLD = 1; // 1\nconst WEEKLY_SYNTHESIS_THRESHOLD = 7; // 7\n\nclass DiarySynthesisService {\n  private processedDatesForDiary = new Set<string>();\n  private lastWeeklyReviewCount = 0;\n\n  /**\n   * \n   * @returns \n   */\n  public getSynthesisRequest(): string {\n    const store = serviceLocator.get('store');\n    if (!store.diaryFragments || store.diaryFragments.length === 0) {\n      return '';\n    }\n\n    const uniqueDates = [...new Set(store.diaryFragments.map(f => f.))].sort();\n\n    if (uniqueDates.length > 1) {\n      // \n      const dateToProcess = uniqueDates[0]; // \n\n      // \n      if (!this.processedDatesForDiary.has(dateToProcess)) {\n        const fragmentsToSynthesize = store.diaryFragments.filter(f => f. === dateToProcess);\n\n        if (fragmentsToSynthesize.length > 0) {\n          console.log(\n            `[DiarySynthesisService] New day detected. Triggering synthesis for previous day: ${dateToProcess}`,\n          );\n          // \n          this.processedDatesForDiary.add(dateToProcess);\n          const payload = JSON.stringify(fragmentsToSynthesize);\n          return `<>${payload}</>`;\n        } else {\n          // \n          this.processedDatesForDiary.add(dateToProcess);\n        }\n      }\n    }\n\n    // ---  () ---\n    // \n    const diariesToReview = store.diary.slice(this.lastWeeklyReviewCount);\n    if (diariesToReview.length >= WEEKLY_SYNTHESIS_THRESHOLD) {\n      console.log(\n        `[DiarySynthesisService] Diary count (${store.diary.length}) reached threshold. Triggering Weekly Review Synthesis.`,\n      );\n      const payload = JSON.stringify(diariesToReview);\n      this.lastWeeklyReviewCount += WEEKLY_SYNTHESIS_THRESHOLD;\n      return `<>${payload}</>`;\n    }\n\n    return '';\n  }\n\n  /**\n   * \n   */\n  public initialize() {\n    const store = serviceLocator.get('store');\n    this.processedDatesForDiary.clear();\n    // \n    store.diary.forEach(d => this.processedDatesForDiary.add(d.));\n    this.lastWeeklyReviewCount = store.weeklyReviews.length * WEEKLY_SYNTHESIS_THRESHOLD;\n    console.log('[DiarySynthesisService] Initialized. Processed dates restored:', this.processedDatesForDiary);\n  }\n}\n\nexport const diarySynthesisService = new DiarySynthesisService();\n","import { get } from 'lodash';\nimport type { ,  } from '../types';\n\n/**\n * \n */\nexport interface EntityMetadata {\n  id: string; // ID\n  name: string; // \n  type: 'character' | 'location' | 'skill' | 'item';\n  path: string; //  worldState \n  ownerId?: string; // ID (/)\n}\n\n/**\n *  V2.0 -  `-` \n * \n */\nclass EntityIndexService {\n  private indexByName = new Map<string, EntityMetadata[]>();\n  private indexById = new Map<string, EntityMetadata>();\n  private isInitialized = false;\n\n  /**\n   * \n   */\n  public async buildIndex(worldState:  | null): Promise<void> {\n    if (this.isInitialized || !worldState) return;\n\n    console.log('[EntityIndexService] Starting to build global entity index...');\n    this.indexByName.clear();\n    this.indexById.clear();\n\n    // 1. \n    if (worldState.) {\n      this.indexCharacters(worldState.);\n    }\n\n    // 2. \n    if (worldState.) {\n      this.indexLocations(worldState.);\n    }\n\n    this.isInitialized = true;\n    console.log(`[EntityIndexService] Global entity index built successfully with ${this.indexById.size} entries.`);\n  }\n\n  /**\n   * \n   */\n  public findByName(name: string): EntityMetadata[] | undefined {\n    return this.indexByName.get(name);\n  }\n\n  /**\n   * ID\n   */\n  public findById(id: string): EntityMetadata | undefined {\n    return this.indexById.get(id);\n  }\n\n  // ---  ---\n\n  private addEntity(entity: EntityMetadata) {\n    // \n    const existingByName = this.indexByName.get(entity.name) || [];\n    this.indexByName.set(entity.name, [...existingByName, entity]);\n\n    // ID\n    if (!this.indexById.has(entity.id)) {\n      this.indexById.set(entity.id, entity);\n    }\n  }\n\n  private indexCharacters(characters: { [key: string]:  | '' }) {\n    for (const charId in characters) {\n      const char = characters[charId];\n      if (typeof char !== 'object') continue;\n\n      // \n      this.addEntity({\n        id: charId,\n        name: char.,\n        type: 'character',\n        path: `.${charId}`,\n      });\n\n      // \n      if (char.) {\n        for (const skillId in char.) {\n          const skill = char.[skillId];\n          this.addEntity({\n            id: `${charId}-${skillId}`,\n            name: skillId, // ID\n            type: 'skill',\n            path: `.${charId}..${skillId}`,\n            ownerId: charId,\n          });\n        }\n      }\n\n      // \n      if (char.) {\n        for (const itemId in char.) {\n          this.addEntity({\n            id: itemId,\n            name: itemId, // ID, \n            type: 'item',\n            path: `.${charId}..${itemId}`,\n            ownerId: charId,\n          });\n        }\n      }\n    }\n  }\n\n  private indexLocations(locations: { [key: string]: any }) {\n    for (const locId in locations) {\n      const loc = locations[locId];\n      if (loc && loc.) {\n        this.addEntity({\n          id: locId,\n          name: loc.,\n          type: 'location',\n          path: `.${locId}`,\n        });\n      }\n    }\n  }\n}\n\nexport const entityIndexService = new EntityIndexService();\n","type EventCallback = (...args: any[]) => void;\n\nclass EventBus {\n  private events: Record<string, EventCallback[]> = {};\n\n  on(event: string, callback: EventCallback): void {\n    if (!this.events[event]) {\n      this.events[event] = [];\n    }\n    this.events[event].push(callback);\n  }\n\n  off(event: string, callback: EventCallback): void {\n    if (!this.events[event]) return;\n    this.events[event] = this.events[event].filter(cb => cb !== callback);\n  }\n\n  emit(event: string, ...args: any[]): void {\n    if (!this.events[event]) return;\n    this.events[event].forEach(callback => {\n      try {\n        callback(...args);\n      } catch (e) {\n        console.error(`Error in event handler for ${event}:`, e);\n      }\n    });\n  }\n}\n\nexport const eventBus = new EventBus();\n","//  TavernHelper API\ndeclare const TavernHelper: any;\n\nconst LOREBOOK_NAME = '-';\nlet entriesCache: any[] | null = null;\n\nasync function getEntries(forceRefresh = false) {\n  if (entriesCache && !forceRefresh) {\n    return entriesCache;\n  }\n  try {\n    const entries = await TavernHelper.getLorebookEntries(LOREBOOK_NAME);\n    if (!entries) {\n      console.error(`[LorebookService]  \"${LOREBOOK_NAME}\" `);\n      entriesCache = null;\n      return null;\n    }\n    entriesCache = entries;\n    return entries;\n  } catch (error) {\n    console.error(`[LorebookService]  getLorebookEntries :`, error);\n    return null;\n  }\n}\n\nfunction findEntryByComment(comment: string): any | null {\n  if (!entriesCache) {\n    console.warn('[LorebookService] findEntryByComment called before cache was populated.');\n    return null;\n  }\n  return entriesCache.find((e: any) => e.comment === comment) || null;\n}\n\nasync function readFromLorebook(entryName: string, forceRefresh = false): Promise<string | null> {\n  const entries = await getEntries(forceRefresh);\n  if (!entries) return null;\n  const entry = entries.find((e: any) => e.comment === entryName || e.name === entryName);\n  return entry ? entry.content : null;\n}\n\nasync function writeToLorebook(\n  entryName: string,\n  content: string,\n  options: { isEnabled: boolean; keys: string[] } = { isEnabled: true, keys: [] },\n) {\n  console.log(`[Roo Debug] Lorebook: Preparing to write/create entry: \"${entryName}\".`);\n  const allEntries = await getEntries();\n  if (!allEntries) return;\n\n  const targetEntry = allEntries.find((e: any) => e.comment === entryName || e.name === entryName);\n\n  try {\n    if (targetEntry) {\n      // ---  ---\n      console.log(`[Roo Debug] Lorebook: Entry \"${entryName}\" exists. Updating with setLorebookEntries.`);\n      await TavernHelper.setLorebookEntries(LOREBOOK_NAME, [\n        { uid: targetEntry.uid, content: content, enabled: options.isEnabled },\n      ]);\n    } else {\n      // ---  ( UpdateVariable5.html) ---\n      console.log(`[Roo Debug] Lorebook: Entry \"${entryName}\" does not exist. Creating with createLorebookEntries.`);\n\n      const baseKey = entryName.replace(/\\(\\d+\\)$/, '');\n      const baseEntryTemplate = allEntries.find((entry: any) => entry.comment === baseKey || entry.name === baseKey);\n\n      // \n      const newEntryData: any = {\n        comment: entryName,\n        content: content,\n        keys: [entryName],\n        enabled: options.isEnabled,\n        position: 'before_character_definition',\n        order: 100,\n      };\n\n      // \n      if (baseEntryTemplate) {\n        Object.assign(newEntryData, {\n          keys: [...(baseEntryTemplate.keys || []), entryName],\n          selective: baseEntryTemplate.selective,\n          constant: baseEntryTemplate.constant,\n          position: baseEntryTemplate.position,\n          order: baseEntryTemplate.order,\n          case_sensitive: baseEntryTemplate.case_sensitive,\n        });\n      }\n\n      console.log(\n        `[Roo Debug] Lorebook: Calling createLorebookEntries for \"${entryName}\" with payload:`,\n        JSON.stringify(newEntryData),\n      );\n      await TavernHelper.createLorebookEntries(LOREBOOK_NAME, [newEntryData]);\n    }\n    console.log(`[LorebookService] API call for \"${entryName}\" completed successfully.`);\n    entriesCache = null; // \n  } catch (error) {\n    console.error(`[LorebookService]  \"${entryName}\" :`, error);\n  }\n}\n\nasync function appendToEntry(entryName: string, newContent: string, separator = '\\n\\n---\\n\\n'): Promise<void> {\n  console.log(`[Roo Debug] Lorebook: Appending to entry \"${entryName}\".`);\n  try {\n    const existingContent = await readFromLorebook(entryName);\n    const content = existingContent ? `${existingContent}${separator}${newContent}` : newContent;\n    // `writeToLorebook` \n    await writeToLorebook(entryName, content);\n  } catch (error) {\n    console.error(`[LorebookService]  \"${entryName}\" :`, error);\n  }\n}\n\nexport const lorebookService = {\n  getEntries,\n  readFromLorebook,\n  writeToLorebook,\n  appendToEntry,\n  findEntryByComment,\n  setEntryEnabled,\n};\n\nasync function setEntryEnabled(entryName: string, isEnabled: boolean): Promise<void> {\n  console.log(`[LorebookService] Setting entry \"${entryName}\" enabled status to: ${isEnabled}`);\n  try {\n    const allEntries = await getEntries();\n    if (!allEntries) return;\n\n    const targetEntry = allEntries.find((e: any) => e.comment === entryName || e.name === entryName);\n\n    if (targetEntry) {\n      // [PATCH] \n      const updatedEntry = { ...targetEntry, enabled: isEnabled };\n      await TavernHelper.setLorebookEntries(LOREBOOK_NAME, [updatedEntry]);\n      console.log(`[LorebookService] Successfully set \"${entryName}\" enabled=${isEnabled}.`);\n    } else {\n      // \n      console.warn(`[LorebookService] setEntryEnabled: Entry \"${entryName}\" not found. Skipping.`);\n    }\n  } catch (error) {\n    console.error(`[LorebookService]  \"${entryName}\" :`, error);\n  }\n}\n","import { eventBus } from './EventBus';\nimport { lorebookService } from './LorebookService';\n\nclass MemoryService {\n  private readonly INSTANT_MEMORY_KEY = '[]';\n  private readonly SHORT_TERM_MEMORY_KEY = '[]';\n  private readonly LONG_TERM_MEMORY_KEY = '[]';\n  private readonly DIRECTOR_LOG_KEY = '';\n\n  // UIsetConfig\n  private config = {\n    instantMemoryCount: 10,\n    shortTermMemoryCount: 20,\n    longTermMemoryCount: 40,\n  };\n\n  /**\n   * () \n   */\n  public async processDirectorLog(): Promise<void> {\n    console.log('[MemoryService V3] Processing Director Log...');\n    try {\n      const rawLogContent = await lorebookService.readFromLorebook(this.DIRECTOR_LOG_KEY, true);\n\n      if (!rawLogContent) {\n        console.warn('[MemoryService V3] Director Log is empty. No new memory entries to add.');\n        return;\n      }\n\n      // Split the log by \"ID|\" to handle multiple appended entries and get the latest one.\n      const logEntries = rawLogContent.split(/(?=ID\\|)/).filter(entry => entry.trim() !== '');\n      const directorLogContent = logEntries.length > 0 ? logEntries[logEntries.length - 1] : '';\n\n      if (!directorLogContent) {\n        console.warn(\n          '[MemoryService V3] Processed Director Log content is empty after filtering. No new memory entries to add.',\n        );\n        return;\n      }\n\n      const instantContent = this._formatInstantContent(directorLogContent);\n      const shortTermContent = this._formatShortTermContent(directorLogContent);\n      const longTermContent = this._formatLongTermContent(directorLogContent);\n\n      await this._updateMemoryTier(this.INSTANT_MEMORY_KEY, instantContent, this.config.instantMemoryCount);\n      await this._updateMemoryTier(this.SHORT_TERM_MEMORY_KEY, shortTermContent, this.config.shortTermMemoryCount);\n      await this._updateMemoryTier(this.LONG_TERM_MEMORY_KEY, longTermContent, this.config.longTermMemoryCount);\n\n      console.log('[MemoryService V3] Director Log processed and memory tiers updated.');\n      eventBus.emit('memoryUpdated');\n    } catch (error) {\n      console.error('[MemoryService V3] Failed to process Director Log:', error);\n    }\n  }\n\n  /**\n   * () \n   */\n  private _extractSection(content: string, sectionName: string): string {\n    const regex = new RegExp(`${sectionName}([\\\\s\\\\S]*?)(?=\\\\n|$)`);\n    const match = content.match(regex);\n    return match && match[1] ? match[1].trim() : '';\n  }\n\n  /**\n   * () \n   */\n  private _formatInstantContent(logContent: string): string {\n    const scriptIdMatch = logContent.match(/^ID\\|(.+)/m);\n    const scriptIdLine = `ID|${scriptIdMatch ? scriptIdMatch[1].trim() : ''}`;\n    const anchorContent = `\\n${this._extractSection(logContent, '')}`;\n\n    // \n    const worldLineEditBlockContent = this._extractSection(logContent, '');\n    const progressContent = `\\n${worldLineEditBlockContent}`;\n\n    return [scriptIdLine, anchorContent, progressContent].join('\\n\\n---\\n\\n').trim();\n  }\n\n  /**\n   * () \n   */\n  private _formatShortTermContent(logContent: string): string {\n    const scriptIdMatch = logContent.match(/^ID\\|(.+)/m);\n    const scriptIdLine = `ID|${scriptIdMatch ? scriptIdMatch[1].trim() : ''}`;\n\n    let npcAnalysisText = '';\n    // NPC\n    const performanceBlock = this._extractSection(logContent, '');\n    if (performanceBlock !== '') {\n      const npcAnalysisRegex = /NPC\\|([\\s\\S]*)/;\n      const match = performanceBlock.match(npcAnalysisRegex);\n      if (match && match[1]) {\n        npcAnalysisText = match[1].trim();\n      }\n    }\n\n    const npcAnalysisContent = `NPC\\n${npcAnalysisText}`;\n    const bbsContent = `BBS\\n${this._extractSection(logContent, 'BBS')}`;\n    return [scriptIdLine, npcAnalysisContent, bbsContent].join('\\n\\n---\\n\\n').trim();\n  }\n\n  /**\n   * () \n   */\n  private _formatLongTermContent(logContent: string): string {\n    const scriptIdMatch = logContent.match(/^ID\\|(.+)/m);\n    const scriptIdLine = `ID|${scriptIdMatch ? scriptIdMatch[1].trim() : ''}`;\n\n    // \n    const directorIntentRegex = /\\|([\\s\\S]*?)(?=\\n---|$)/;\n    const directorIntentMatch = logContent.match(directorIntentRegex);\n    const directorIntentText = directorIntentMatch && directorIntentMatch[1] ? directorIntentMatch[1].trim() : '';\n    const directorIntentContent = `\\n${directorIntentText}`;\n\n    // NPC\n    let performanceAnalysisText = this._extractSection(logContent, '');\n    if (performanceAnalysisText !== '') {\n      const npcAnalysisIndex = performanceAnalysisText.indexOf('NPC|');\n      if (npcAnalysisIndex !== -1) {\n        performanceAnalysisText = performanceAnalysisText.substring(0, npcAnalysisIndex).trim();\n      }\n    }\n    const performanceAnalysisContent = `\\n${performanceAnalysisText}`;\n\n    const narrativePacingContent = `\\n${this._extractSection(logContent, '')}`;\n\n    return [scriptIdLine, directorIntentContent, performanceAnalysisContent, narrativePacingContent]\n      .join('\\n\\n---\\n\\n')\n      .trim();\n  }\n\n  /**\n   * () \n   */\n  private async _updateMemoryTier(key: string, newEntry: string, limit: number): Promise<void> {\n    const SEPARATOR = '\\n\\n<--MEMORY_ENTRY_SEPARATOR-->\\n\\n';\n    let existingContent: string | null = '';\n    try {\n      existingContent = await lorebookService.readFromLorebook(key, true);\n    } catch (error) {\n      console.log(`[MemoryService V3] Could not read memory tier \"${key}\", assuming it's new.`);\n    }\n\n    let entries: string[] = [];\n    if (existingContent && !existingContent.startsWith('')) {\n      entries = existingContent.split(SEPARATOR);\n    }\n\n    // Prevent duplicate entries\n    if (entries.length > 0 && entries[0] === newEntry) {\n      console.log(`[MemoryService V3] Skipping update for \"${key}\" as the new entry is identical to the latest one.`);\n      return;\n    }\n\n    // Prepend new entry\n    entries.unshift(newEntry);\n\n    // Truncate to limit\n    const truncatedEntries = entries.slice(0, limit);\n\n    // Join and write back\n    const newContent = truncatedEntries.join(SEPARATOR);\n    await this.writeMemory(key, newContent);\n  }\n\n  private async writeMemory(key: string, content: string): Promise<void> {\n    await lorebookService.writeToLorebook(key, content, {\n      isEnabled: true,\n      keys: [key],\n    });\n  }\n\n  public getConfig() {\n    return this.config;\n  }\n\n  public setConfig(newConfig: Partial<typeof this.config>) {\n    this.config = { ...this.config, ...newConfig };\n    console.log('[MemoryService V2] Config updated:', this.config);\n    this.processDirectorLog();\n  }\n}\n\nexport const memoryService = new MemoryService();\n","import { reactive } from 'vue';\n\nexport type NotificationType = 'info' | 'success' | 'warning' | 'error';\n\nexport interface Notification {\n  id: number;\n  title: string;\n  message: string;\n  type: NotificationType;\n}\n\nconst state = reactive({\n  notifications: [] as Notification[],\n});\n\nlet nextId = 0;\n\nconst actions = {\n  show(title: string, message: string, type: NotificationType = 'info', duration: number = 4000) {\n    const id = nextId++;\n    state.notifications.push({ id, title, message, type });\n\n    if (duration > 0) {\n      setTimeout(() => {\n        this.hide(id);\n      }, duration);\n    }\n  },\n\n  hide(id: number) {\n    const index = state.notifications.findIndex(n => n.id === id);\n    if (index !== -1) {\n      state.notifications.splice(index, 1);\n    }\n  },\n\n  success(title: string, message: string, duration: number = 4000) {\n    this.show(title, message, 'success', duration);\n  },\n\n  info(title: string, message: string, duration: number = 4000) {\n    this.show(title, message, 'info', duration);\n  },\n\n  warn(title: string, message: string, duration: number = 5000) {\n    this.show(title, message, 'warning', duration);\n  },\n\n  error(title: string, message: string, duration: number = 7000) {\n    this.show(title, message, 'error', duration);\n  },\n};\n\nexport const notificationState = state;\nexport const notificationService = actions;\n","import { get } from 'lodash';\nimport { computed, reactive } from 'vue';\nimport { store } from '../store';\nimport type { Npc,  } from '../types';\n\nexport const USER_ID = '{{user}}';\n\n// ID\nconst locationCache = reactive(new Map<string, { name: string; parentId: string | null }>());\n\n/**\n * NPC\n */\nconst allNpcs = computed((): (Npc & { id: string })[] => {\n  const worldState = store.worldState;\n  if (!worldState?.) return [];\n\n  const npcs: (Npc & { id: string })[] = [];\n  for (const charId in worldState.) {\n    const charData = worldState.[charId];\n    // \n    if (typeof charData === 'object' && charData !== null) {\n      npcs.push({ ...charData, id: charId });\n    }\n  }\n  return npcs;\n});\n\n/**\n * IDNPC\n *  worldIdNPC\n */\nfunction getNpcsByWorld(worldId: string): (Npc & { id: string })[] {\n  return allNpcs.value;\n}\n\n/**\n * \n * NPC\n */\nasync function initializeWorldAndLocationData(): Promise<{ id: string; name: string }[]> {\n  const characters = store.worldState?.;\n  if (!characters) {\n    console.warn('[NpcService] worldState. is not available for initialization.');\n    return [];\n  }\n\n  const worldSet = new Set<string>();\n  Object.values(characters).forEach((char: any) => {\n    if (typeof char === 'object' && char?.) {\n      char..forEach((s: any) => {\n        if (s.) {\n          worldSet.add(s.);\n        }\n      });\n    }\n  });\n\n  const worldInfoList = Array.from(worldSet).map(worldName => ({\n    id: worldName,\n    name: worldName,\n  }));\n\n  console.log('[NpcService] Initialized worlds from character data.', worldInfoList);\n  return worldInfoList;\n}\n\nfunction getLocationName(id: string): string {\n  if (!id) return '';\n  const location = get(store.worldState, `.${id}`) as any;\n  return location?. || id;\n}\n\nfunction getLocationDetails(id: string): any {\n  if (!id) return null;\n  return get(store.worldState, `.${id}`);\n}\n\nfunction getParentLocationName(id: string): string {\n  const parentId = locationCache.get(id)?.parentId;\n  if (!parentId) return '';\n  if (parentId === 'WORLD_ORIGIN') return '';\n  return locationCache.get(parentId)?.name || '';\n}\n\nfunction getNpcNameById(id: string): string {\n  if (id === USER_ID) {\n    const protagonist = store.worldState?.;\n    return typeof protagonist === 'object' ? protagonist. || id : id;\n  }\n  const character = get(store.worldState, `.${id}`) as Npc | '' | undefined;\n  if (typeof character === 'object' && character !== null) {\n    return character. || id;\n  }\n  return id;\n}\n\nfunction getNpcId(npc: Npc | ): string | null {\n  const characterList = store.worldState?.;\n  if (!characterList) return null;\n\n  for (const id in characterList) {\n    if ((characterList as Record<string, any>)[id] === npc) {\n      return id;\n    }\n  }\n\n  const protagonist = store.worldState?.;\n  if (typeof protagonist === 'object' && protagonist === npc) {\n    return USER_ID;\n  }\n\n  return null;\n}\n\nfunction cacheLocationData(spatialEntities: any[]) {\n  if (Array.isArray(spatialEntities)) {\n    for (const entity of spatialEntities) {\n      if (entity.ID && entity.) {\n        locationCache.set(entity.ID, { name: entity., parentId: entity.?.ID || null });\n      }\n    }\n  }\n}\n\nexport const npcService = {\n  getNpcsByWorld,\n  allNpcs,\n  initializeWorldAndLocationData,\n  getLocationName,\n  getLocationDetails,\n  getNpcNameById,\n  getNpcId,\n  locationCache,\n  getParentLocationName,\n  cacheLocationData,\n};\n","import dayjs from 'dayjs';\nimport { AppState, Npc } from '../types';\nimport { lorebookService } from './LorebookService';\n\ntype TimeSegment = '' | '' | '' | '' | '' | '' | '' | '';\n\n// JSON\ninterface RawStoryArc {\n  id: string;\n  title: string;\n  is_anchor: boolean;\n  stages?: RawStoryStage[];\n  ?: RawStoryStage[]; // key\n  trigger_conditions: any;\n  ?: string[];\n  ?: string;\n}\n\ninterface RawStoryStage {\n  id?: string; // key\n  stage_id?: string;\n  title?: string;\n  ?: string; // key\n  summary?: string;\n  trigger_time?: { date: string; segment: string };\n  ?: any; // key\n  trigger_conditions?: any;\n  key_characters?: string[];\n  ?: string[];\n  key_locations?: string[];\n  ?: string[];\n  key_items?: string[];\n  ?: string[];\n  scene_modifiers?: string[];\n  ?: string[];\n  key_points?: any[];\n  ?: any[];\n}\n\n// \nexport interface DisplayStoryStage extends RawStoryStage {\n  arcId: string;\n  arcTitle: string;\n  status: 'completed' | 'current' | 'future';\n  trigger_time: { date: string; segment: string };\n  key_characters?: string[];\n  key_locations?: string[];\n  key_items?: string[];\n  ?: string[];\n  ?: any[];\n}\n\nclass StorylineService {\n  private masterTimeline: RawStoryArc[] | null = null;\n  private flattenedStages:\n    | (RawStoryStage & { arcId: string; arcTitle: string; trigger_time: { date: string; segment: string } })[]\n    | null = null;\n  private fixedEvents: Record<string, string[]> | null = null;\n\n  /**\n   * \n   */\n  private async loadMasterTimeline(): Promise<void> {\n    if (this.masterTimeline) {\n      return;\n    }\n\n    try {\n      const storyContents = await Promise.all([\n        lorebookService.readFromLorebook('[]_'),\n        lorebookService.readFromLorebook('[]_'),\n        lorebookService.readFromLorebook('[]_'),\n        lorebookService.readFromLorebook('[]_'),\n        lorebookService.readFromLorebook('[]_'),\n        lorebookService.readFromLorebook('[]_'),\n        lorebookService.readFromLorebook('[]_'),\n        lorebookService.readFromLorebook('[]_'),\n        lorebookService.readFromLorebook('[]_'),\n        lorebookService.readFromLorebook('[]_'),\n        lorebookService.readFromLorebook('[]_'),\n        lorebookService.readFromLorebook('[]_'),\n        lorebookService.readFromLorebook('[]_'),\n        lorebookService.readFromLorebook('[]_'),\n        lorebookService.readFromLorebook('[]_'),\n        lorebookService.readFromLorebook('[]_'),\n        lorebookService.readFromLorebook('[]_'),\n        lorebookService.readFromLorebook('[]_'),\n      ]);\n\n      let combinedTimeline: RawStoryArc[] = [];\n      storyContents.forEach(content => {\n        if (content) {\n          try {\n            const storyData = JSON.parse(content);\n            if (storyData && Array.isArray(storyData.timeline)) {\n              combinedTimeline = combinedTimeline.concat(storyData.timeline);\n            }\n          } catch (e) {\n            console.error('Failed to parse story content:', e);\n          }\n        }\n      });\n      this.masterTimeline = combinedTimeline;\n      this.flattenStages();\n    } catch (error) {\n      console.error('[StorylineService] Failed to load main story data:', error);\n      this.masterTimeline = [];\n    }\n  }\n\n  /**\n   * \n   */\n  private flattenStages(): void {\n    if (!this.masterTimeline) {\n      this.flattenedStages = [];\n      return;\n    }\n    this.flattenedStages = this.masterTimeline.flatMap(arc => {\n      const stages = arc.stages || arc. || [];\n      return stages\n        .map(stage => {\n          const rawTriggerTime = stage.trigger_time || stage. || stage.trigger_conditions;\n          let date = 'N/A';\n          let segment = 'N/A';\n\n          if (rawTriggerTime) {\n            const conditions = rawTriggerTime. || rawTriggerTime.must_all;\n            if (conditions && Array.isArray(conditions)) {\n              for (const condition of conditions) {\n                if (typeof condition === 'string') {\n                  const dateMatch = condition.match(/ (\\d{4}-\\d{2}-\\d{2})/);\n                  if (dateMatch) {\n                    date = dateMatch[1];\n                  }\n                  const segmentMatch = condition.match(/ ([\\u4e00-\\u9fa5]+)/);\n                  if (segmentMatch) {\n                    segment = segmentMatch[1];\n                  }\n                }\n              }\n            } else if (rawTriggerTime.date) {\n              // Fallback for simple object\n              date = rawTriggerTime.date;\n              segment = rawTriggerTime.segment || 'N/A';\n            }\n          }\n\n          return {\n            ...stage,\n            id: stage.id || stage.stage_id || '',\n            arcId: arc.id,\n            arcTitle: arc.title,\n            trigger_time: { date, segment },\n          };\n        })\n        .filter(stage => stage.id);\n    });\n  }\n\n  /**\n   * \n   * @returns {Promise<(RawStoryStage & { arcId: string; arcTitle: string })[] | null>}\n   */\n  public async getFlattenedStages(): Promise<\n    (RawStoryStage & { arcId: string; arcTitle: string; trigger_time: { date: string; segment: string } })[] | null\n  > {\n    await this.loadMasterTimeline();\n    return this.flattenedStages as\n      | (RawStoryStage & { arcId: string; arcTitle: string; trigger_time: { date: string; segment: string } })[]\n      | null;\n  }\n\n  public async getMasterTimeline(): Promise<RawStoryArc[] | null> {\n    await this.loadMasterTimeline();\n    return this.masterTimeline;\n  }\n\n  /**\n   * () \n   * @param worldState - \n   * @returns {Promise<any | null>} - null\n   */\n  public async getActionableStoryline(worldState: AppState['worldState']): Promise<any | null> {\n    if (!worldState) return null;\n    await this.loadMasterTimeline();\n    if (!this.flattenedStages) return null;\n\n    const history = worldState.?. || [];\n    const now = dayjs(worldState...);\n    const currentTimeSegment = worldState...;\n\n    for (const stage of this.flattenedStages) {\n      if (!stage.id || history.includes(stage.id)) {\n        continue; // ID\n      }\n\n      const timeReached = this.isTimeReached(now, currentTimeSegment, stage);\n      if (!timeReached) {\n        continue;\n      }\n\n      const conditionsMet = this.checkTriggerConditions(stage, history, worldState);\n      if (conditionsMet) {\n        return stage; // \n      }\n    }\n\n    return null; // \n  }\n\n  public isTimeReached(now: dayjs.Dayjs, currentTimeSegment: string, stage: any): boolean {\n    let dateConditionStr: string | undefined;\n    let targetSegment: TimeSegment | undefined;\n\n    // V2 format check (e.g., []_v2.json)\n    if (stage.trigger_time && stage.trigger_time.date) {\n      dateConditionStr = stage.trigger_time.date;\n      targetSegment = stage.trigger_time.segment;\n    }\n    // V1 format check (e.g., []_.json)\n    else if (stage. && Array.isArray(stage..)) {\n      const conditions = stage..;\n      const dateCondition = conditions.find((c: any) => typeof c === 'string' && c.startsWith(''));\n      const segmentCondition = conditions.find((c: any) => typeof c === 'string' && c.startsWith(''));\n      if (dateCondition) {\n        dateConditionStr = dateCondition.replace(' ', '').trim();\n      }\n      if (segmentCondition) {\n        targetSegment = segmentCondition.replace(' ', '').trim() as TimeSegment;\n      }\n    }\n\n    // \n    if (!dateConditionStr) {\n      return true;\n    }\n\n    const targetDate = dayjs(dateConditionStr);\n    if (!targetDate.isValid()) {\n      console.warn(`[StorylineService] Invalid date format in trigger: ${dateConditionStr}`);\n      return false;\n    }\n\n    // \n    if (now.isBefore(targetDate, 'day')) {\n      return false; // \n    }\n\n    // \n    if (now.isSame(targetDate, 'day') && targetSegment) {\n      const segmentsOrder: TimeSegment[] = ['', '', '', '', '', '', '', ''];\n      const currentSegmentIndex = segmentsOrder.indexOf(currentTimeSegment as TimeSegment);\n      const targetSegmentIndex = segmentsOrder.indexOf(targetSegment);\n\n      if (targetSegmentIndex === -1) {\n        console.warn(`[StorylineService] Invalid time segment in trigger: ${targetSegment}`);\n        return false;\n      }\n\n      // \n      if (currentSegmentIndex < targetSegmentIndex) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  private checkTriggerConditions(stage: any, history: string[], worldState: AppState['worldState']): boolean {\n    const conditions = stage.?. || stage.trigger_conditions?.must_all;\n\n    if (!conditions || !Array.isArray(conditions)) {\n      return true; // \n    }\n\n    for (const condition of conditions) {\n      // V2 format\n      if (typeof condition === 'object' && condition.type) {\n        if (condition.type === 'event_completed') {\n          if (!history.includes(condition.event_id)) return false;\n        } else if (condition.type === 'character_not_has_status') {\n          if (!worldState) return false;\n          const characterId = condition.character_id;\n          const character = characterId === '{{user}}' ? worldState. : worldState.[characterId];\n          if (character && character !== '' && character..includes(condition.status)) {\n            return false;\n          }\n        }\n        // ... can add more v2 condition types here\n      }\n      // V1 format\n      else if (typeof condition === 'string') {\n        if (condition.startsWith('') || condition.startsWith('')) {\n          continue; //  isTimeReached \n        }\n        if (!this._parseNaturalLanguageCondition(condition, history, worldState)) {\n          return false;\n        }\n      }\n      // Malformed V1 data from screenshot\n      else if (typeof condition === 'object' && condition['']) {\n        if (!history.includes(condition[''])) {\n          return false;\n        }\n      }\n    }\n    return true;\n  }\n\n  private _parseNaturalLanguageCondition(\n    condition: string,\n    history: string[],\n    worldState: AppState['worldState'],\n  ): boolean {\n    if (!worldState) return false;\n\n    //  \" EVENT_ID\"\n    const eventMatch = condition.match(/\\s+([A-Z0-9._-]+)/);\n    if (eventMatch) {\n      return history.includes(eventMatch[1]);\n    }\n\n    //  \" ''\"\n    const statusMatch = condition.match(/(\\S+)\\s*\\s*([^]+)/);\n    if (statusMatch) {\n      const charName = statusMatch[1];\n      const statusToCheck = statusMatch[2];\n      if (!worldState.) return false;\n      const char = Object.values(worldState.).find((c: any) => typeof c === 'object' && c. === charName);\n      if (char && typeof char === 'object') {\n        const charStatus = (char as Npc). || [];\n        return !charStatus.some((s: any) => s.includes(statusToCheck));\n      }\n      return false; // \n    }\n\n    return true; // true\n  }\n  /**\n   * UI+3\n   * @param worldState - \n   * @returns {Promise<DisplayStoryStage[]>} - \n   */\n  public async getDisplayTimeline(worldState: AppState['worldState']): Promise<DisplayStoryStage[]> {\n    const allStages = await this.getAllTimelineStages(worldState);\n    if (!allStages || !worldState) return [];\n\n    const completedEventIds = new Set(worldState..);\n    let lastCompletedStageIndex = -1;\n    for (let i = allStages.length - 1; i >= 0; i--) {\n      if (allStages[i].id && completedEventIds.has(allStages[i].id!)) {\n        lastCompletedStageIndex = i;\n        break;\n      }\n    }\n\n    const startIndex = lastCompletedStageIndex + 1;\n    const endIndex = startIndex + 4;\n\n    const displayStages = allStages.slice(startIndex, endIndex);\n\n    if (displayStages.length > 0) {\n      displayStages[0].status = 'current';\n    }\n\n    return displayStages;\n  }\n\n  public async getAllTimelineStages(worldState: AppState['worldState']): Promise<DisplayStoryStage[]> {\n    await this.loadMasterTimeline();\n    if (!this.flattenedStages) {\n      return [];\n    }\n    const completedEventIds = new Set(worldState?.?. || []);\n\n    return this.flattenedStages.map(stage => ({\n      ...(stage as any),\n      status: completedEventIds.has(stage.id!) ? 'completed' : 'future',\n    }));\n  }\n\n  public async getFixedEvents(): Promise<Record<string, string[]>> {\n    if (this.fixedEvents) {\n      return this.fixedEvents;\n    }\n\n    try {\n      const content = await lorebookService.readFromLorebook('[]-', true);\n      if (!content) {\n        this.fixedEvents = {};\n        return {};\n      }\n      const rawData = JSON.parse(content);\n      const events: Record<string, string[]> = {};\n      if (rawData && rawData.events) {\n        for (const month in rawData.events) {\n          for (const day in rawData.events[month]) {\n            const key = `${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;\n            events[key] = rawData.events[month][day];\n          }\n        }\n      }\n      this.fixedEvents = events;\n      return this.fixedEvents;\n    } catch (error) {\n      console.error('[StorylineService] Failed to load or parse fixed events:', error);\n      this.fixedEvents = {};\n      return {};\n    }\n  }\n}\n\nexport const storylineService = new StorylineService();\n","import { lorebookService } from './LorebookService';\n\n// \nexport type WorkflowState = 'NORMAL' | 'CREATION' | 'IDENTITY';\n\n// CoT\n// \nconst COT_FILES: Record<WorkflowState, string[]> = {\n  NORMAL: ['cotcot'],\n  CREATION: ['cotcot'],\n  IDENTITY: ['cotcot'],\n};\n\nclass WorkflowService {\n  private currentState: WorkflowState = 'NORMAL';\n  private narrativeCache: string | null = null; //  <gametxt>\n  private updateScriptCache: string | null = null; //  <UpdateVariable>\n  private preserveMode: 'none' | 'gametxt' | 'full' = 'none';\n\n  constructor() {\n    // CoT\n    this.switchTo('NORMAL');\n  }\n\n  /**\n   * \n   */\n  public getCurrentState(): WorkflowState {\n    return this.currentState;\n  }\n\n  /**\n   * CoT/\n   * @param newState \n   */\n  public async switchTo(newState: WorkflowState, force: boolean = false) {\n    if (this.currentState === newState && !force) {\n      return; // \n    }\n\n    console.log(`[WorkflowService] Switching from ${this.currentState} to ${newState} (Forced: ${force})`);\n\n    const allCots = Object.values(COT_FILES).flat();\n    const cotsToEnable = COT_FILES[newState];\n\n    // CoT\n    for (const cotName of allCots) {\n      const shouldBeEnabled = cotsToEnable.includes(cotName);\n      await lorebookService.setEntryEnabled(cotName, shouldBeEnabled);\n    }\n\n    this.currentState = newState;\n    console.log(`[WorkflowService] Switched to ${newState}. Enabled CoTs: ${cotsToEnable.join(', ')}`);\n  }\n\n  /**\n   * \n   * @param narrative  <gametxt> \n   */\n  public cacheNarrative(narrative: string) {\n    this.narrativeCache = narrative;\n    console.log('[WorkflowService] Narrative cached.');\n  }\n\n  /**\n   * \n   * @returns  <gametxt>  null\n   */\n  public popNarrative(): string | null {\n    const narrative = this.narrativeCache;\n    this.narrativeCache = null;\n    if (narrative) {\n      console.log('[WorkflowService] Popped cached narrative.');\n    }\n    return narrative;\n  }\n\n  /**\n   * \n   */\n  public cacheUpdateScript(script: string) {\n    this.updateScriptCache = script;\n    console.log('[WorkflowService] Update script cached.');\n  }\n\n  /**\n   * \n   */\n  public popUpdateScript(): string | null {\n    const script = this.updateScriptCache;\n    this.updateScriptCache = null;\n    if (script) {\n      console.log('[WorkflowService] Popped cached update script.');\n    }\n    return script;\n  }\n\n  /**\n   * AI\n   * @param mode 'gametxt' , 'full' \n   */\n  public setPreserveMode(mode: 'none' | 'gametxt' | 'full') {\n    this.preserveMode = mode;\n    console.log(`[WorkflowService] Preserve mode set to: ${mode}`);\n  }\n\n  /**\n   * \n   * @returns \n   */\n  public popPreservedContent(): string {\n    let content = '';\n\n    if (this.preserveMode === 'gametxt' || this.preserveMode === 'full') {\n      if (this.narrativeCache) {\n        content += `\\n<gametxt>${this.narrativeCache}</gametxt>`;\n        console.log('[WorkflowService] Popped cached narrative for appending.');\n      }\n    }\n\n    if (this.preserveMode === 'full') {\n      if (this.updateScriptCache) {\n        content += `\\n<UpdateVariable>${this.updateScriptCache}</UpdateVariable>`;\n        console.log('[WorkflowService] Popped cached update script for appending.');\n      }\n    }\n\n    // \n    this.narrativeCache = null;\n    this.updateScriptCache = null;\n    this.preserveMode = 'none';\n\n    if (content) {\n      console.log('[WorkflowService] Final content to append length:', content.length);\n    }\n\n    return content;\n  }\n}\n\nexport const workflowService = new WorkflowService();\n","import * as toastr from 'toastr';\nimport { lorebookService } from './LorebookService';\nimport { serviceLocator } from './service-locator';\n\nconst LOREBOOK_NAME = '-';\nconst SAVE_SLOT_PREFIX = '-';\nconst MAX_MANUAL_SAVES = 5;\nconst AUTO_SAVE_SLOTS = ['-A', '-B'];\nconst REROLL_SAVE_SLOT_ID = '-';\nconst LOREBOOK_KEYS_TO_BACKUP: string[] = [\n  '[]',\n  '[]',\n  '[]',\n  '',\n  '-',\n  '',\n  '',\n  '',\n];\n\nexport interface SaveSlot {\n  id: string;\n  name: string;\n  timestamp: string | null;\n  data: any | null;\n  entryUid?: number;\n  diaryDate?: string | null;\n  diaryTimeSegment?: string | null;\n  diaryTitle?: string | null;\n}\n\nclass SaveLoadService {\n  public manualSlots: SaveSlot[] = [];\n  public autoSlots: SaveSlot[] = [];\n  public rerollSlot: SaveSlot | null = null;\n  public turnCounter: number = 0;\n  public isAutoSaveEnabled: boolean = true;\n  private autoSaveInterval: any;\n  private areSlotsLoaded = false;\n\n  constructor() {\n    this.initializeSlots();\n    this.loadAutoSaveState();\n    this.loadTurnCounter();\n    // \n  }\n\n  private async ensureSlotsLoaded() {\n    if (!this.areSlotsLoaded) {\n      await this.loadAllSaveSlots();\n      this.areSlotsLoaded = true;\n    }\n  }\n\n  private initializeSlots() {\n    for (let i = 1; i <= MAX_MANUAL_SAVES; i++) {\n      this.manualSlots.push({ id: `-${i}`, name: ` ${i}`, timestamp: null, data: null });\n    }\n    for (const id of AUTO_SAVE_SLOTS) {\n      this.autoSlots.push({ id, name: ` ${id.split('-')[1]}`, timestamp: null, data: null });\n    }\n    this.rerollSlot = { id: REROLL_SAVE_SLOT_ID, name: '', timestamp: null, data: null };\n  }\n\n  async loadAllSaveSlots() {\n    try {\n      const allEntries = await TavernHelper.getLorebookEntries(LOREBOOK_NAME);\n      if (!allEntries) return;\n\n      const updateSlot = (slot: SaveSlot) => {\n        const entry = allEntries.find((e: any) => e.comment === `${SAVE_SLOT_PREFIX}${slot.id}`);\n        if (entry && entry.content) {\n          try {\n            slot.data = JSON.parse(entry.content);\n            slot.timestamp = slot.data.timestamp;\n            slot.diaryDate = slot.data.diaryDate;\n            slot.diaryTimeSegment = slot.data.diaryTimeSegment;\n            slot.diaryTitle = slot.data.diaryTitle;\n            slot.entryUid = entry.uid;\n          } catch (e) {\n            console.error(` ${slot.id} :`, e);\n            slot.timestamp = '';\n            slot.data = null;\n          }\n        } else {\n          slot.timestamp = null;\n          slot.data = null;\n          slot.entryUid = undefined;\n        }\n      };\n\n      this.manualSlots.forEach(updateSlot);\n      this.autoSlots.forEach(updateSlot);\n      if (this.rerollSlot) {\n        updateSlot(this.rerollSlot);\n      }\n    } catch (error) {\n      console.error(':', error);\n      toastr.error('');\n    }\n  }\n\n  async saveGame(slotId: string, isAutoSave = false) {\n    await this.ensureSlotsLoaded(); // \n    if (!isAutoSave) {\n      toastr.info(` [${slotId}]...`);\n    }\n\n    try {\n      const messages = await TavernHelper.getChatMessages('0');\n      if (!messages || messages.length === 0) {\n        throw new Error('');\n      }\n      const messageZero = messages[0];\n      const timestamp = new Date().toISOString();\n\n      const lorebookBackup: { [key: string]: string } = {};\n      for (const key of LOREBOOK_KEYS_TO_BACKUP) {\n        const content = await lorebookService.readFromLorebook(key);\n        lorebookBackup[key] = content ?? '';\n      }\n\n      const store = serviceLocator.get('store');\n      const latestFragment = await this._getLatestFragment();\n      const worldTime = store.worldState?.?.;\n\n      // UpdateVariable\n      const cleanedMessage = messageZero.message.replace(\n        /(<\\s*UpdateVariable\\b[^>]*>)[\\s\\S]*?(<\\s*\\/\\s*UpdateVariable\\s*>)/g,\n        '$1$2',\n      );\n\n      const saveData = {\n        timestamp,\n        mvu_data: messageZero.data,\n        message_content: cleanedMessage, // \n        lorebook_backup: lorebookBackup,\n        diaryDate: worldTime?.,\n        diaryTimeSegment: worldTime?.,\n        diaryTitle: latestFragment?.,\n      };\n\n      const comment = `${SAVE_SLOT_PREFIX}${slotId}`;\n      const allEntries = await TavernHelper.getLorebookEntries(LOREBOOK_NAME);\n      const existingEntry = allEntries.find((e: any) => e.comment === comment);\n\n      if (existingEntry) {\n        await TavernHelper.setLorebookEntries(LOREBOOK_NAME, [\n          { uid: existingEntry.uid, content: JSON.stringify(saveData, null, 2) },\n        ]);\n      } else {\n        await TavernHelper.createLorebookEntries(LOREBOOK_NAME, [\n          {\n            comment: comment,\n            content: JSON.stringify(saveData, null, 2),\n            keys: [comment],\n            position: 'after_character_definition',\n            order: 200,\n          },\n        ]);\n      }\n\n      await this.loadAllSaveSlots();\n      if (!isAutoSave) {\n        toastr.success(` [${slotId}]`);\n      } else {\n        console.log(`[AutoSave]  ${slotId}`);\n      }\n    } catch (error) {\n      const errorMessage = `: ${error instanceof Error ? error.message : String(error)}`;\n      console.error(` ${slotId} :`, error);\n      if (!isAutoSave) {\n        toastr.error(errorMessage);\n      }\n    }\n  }\n\n  private async _internalLoadGame(slot: SaveSlot) {\n    if (!slot.data || !slot.data.mvu_data) {\n      throw new Error('');\n    }\n    if (slot.data.lorebook_backup) {\n      for (const key in slot.data.lorebook_backup) {\n        await lorebookService.writeToLorebook(key, slot.data.lorebook_backup[key]);\n      }\n    }\n    const messages = await TavernHelper.getChatMessages('0');\n    const messageZero = messages[0] || {};\n    messageZero.data = slot.data.mvu_data;\n    messageZero.message = slot.data.message_content;\n    await TavernHelper.setChatMessages([messageZero], { refresh: 'all' });\n  }\n\n  async loadGame(slot: SaveSlot) {\n    if (!confirm(` [${slot.name}] `)) {\n      return;\n    }\n    toastr.info(` [${slot.name}] ...`);\n    try {\n      await this._internalLoadGame(slot);\n      toastr.success(` [${slot.name}] ...`);\n    } catch (error) {\n      const errorMessage = `: ${error instanceof Error ? error.message : String(error)}`;\n      console.error(` ${slot.name} :`, error);\n      toastr.error(errorMessage);\n    }\n  }\n\n  private async _getLatestFragment(): Promise<{ : string } | null> {\n    try {\n      const messages = await TavernHelper.getChatMessages('0');\n      if (!messages || messages.length === 0) return null;\n\n      const lastAiMessage = [...messages]\n        .reverse()\n        .find(m => m.name !== 'You' && m.name !== '{{user}}' && m.message && m.message.includes('<>'));\n      if (!lastAiMessage) return null;\n\n      const fragmentMatch = lastAiMessage.message.match(/<>([\\s\\S]+?)<\\/>/);\n      if (!fragmentMatch || !fragmentMatch[1]) return null;\n\n      const titleMatch = fragmentMatch[1].match(/\\|(.+)/);\n      if (!titleMatch || !titleMatch[1]) return null;\n\n      return { : titleMatch[1].trim() };\n    } catch (error) {\n      console.error('Failed to get latest fragment:', error);\n      return null;\n    }\n  }\n\n  async deleteSave(slot: SaveSlot) {\n    if (!slot.entryUid) {\n      toastr.warning('');\n      return;\n    }\n    if (!confirm(` [${slot.name}] \\n`)) {\n      return;\n    }\n    toastr.info(` [${slot.name}]...`);\n    try {\n      await TavernHelper.deleteLorebookEntries(LOREBOOK_NAME, [slot.entryUid]);\n      await this.loadAllSaveSlots();\n      toastr.success(` [${slot.name}] `);\n    } catch (error) {\n      console.error(` ${slot.name} :`, error);\n      toastr.error(`: ${error instanceof Error ? error.message : String(error)}`);\n    }\n  }\n\n  async performAutoSave() {\n    if (!this.isAutoSaveEnabled) return;\n\n    this.turnCounter++;\n    localStorage.setItem('tianhua_turn_counter', this.turnCounter.toString());\n    const slotId = this.turnCounter % 2 === 1 ? AUTO_SAVE_SLOTS[0] : AUTO_SAVE_SLOTS[1];\n    await this.saveGame(slotId, true);\n  }\n\n  async saveStateForReroll() {\n    console.log('[Reroll] Saving state for potential reroll...');\n    await this.saveGame(REROLL_SAVE_SLOT_ID, true);\n  }\n\n  async loadRerollState() {\n    await this.ensureSlotsLoaded(); // \n\n    if (!this.rerollSlot || !this.rerollSlot.data) {\n      toastr.error('');\n      throw new Error('No reroll save state found.');\n    }\n    console.log('[Reroll] Loading state for reroll and setting restore flag...');\n\n    // \n    localStorage.setItem('reincarnation-simulator-restore-input', 'true');\n\n    // \n    await this._internalLoadGame(this.rerollSlot);\n    // \n    setTimeout(() => window.location.reload(), 500);\n  }\n\n  exportSave(slot: SaveSlot) {\n    if (!slot.data) {\n      toastr.warning('');\n      return;\n    }\n    const dataStr = JSON.stringify(slot.data, null, 2);\n    const dataBlob = new Blob([dataStr], { type: 'application/json' });\n    const url = URL.createObjectURL(dataBlob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = `[]-${slot.name}-${new Date().toISOString()}.json`;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    URL.revokeObjectURL(url);\n    toastr.success(` [${slot.name}] `);\n  }\n\n  async importSave(jsonContent: string) {\n    try {\n      const saveData = JSON.parse(jsonContent);\n      if (!saveData.timestamp || !saveData.mvu_data) {\n        throw new Error('');\n      }\n\n      const emptySlot = this.manualSlots.find(slot => !slot.data);\n      if (!emptySlot) {\n        toastr.error('');\n        return;\n      }\n\n      toastr.info(` [${emptySlot.name}]...`);\n\n      const comment = `${SAVE_SLOT_PREFIX}${emptySlot.id}`;\n      const allEntries = await TavernHelper.getLorebookEntries(LOREBOOK_NAME);\n      const existingEntry = allEntries.find((e: any) => e.comment === comment);\n\n      if (existingEntry) {\n        await TavernHelper.setLorebookEntries(LOREBOOK_NAME, [\n          { uid: existingEntry.uid, content: JSON.stringify(saveData, null, 2) },\n        ]);\n      } else {\n        await TavernHelper.createLorebookEntries(LOREBOOK_NAME, [\n          {\n            comment: comment,\n            content: JSON.stringify(saveData, null, 2),\n            keys: [comment],\n            position: 'after_character_definition',\n            order: 200,\n            enabled: false, // \n          },\n        ]);\n      }\n\n      await this.loadAllSaveSlots();\n      toastr.success(` [${emptySlot.name}]`);\n    } catch (error) {\n      const errorMessage = `: ${error instanceof Error ? error.message : String(error)}`;\n      console.error(':', error);\n      toastr.error(errorMessage);\n    }\n  }\n\n  toggleAutoSave(enabled: boolean) {\n    this.isAutoSaveEnabled = enabled;\n    localStorage.setItem('tianhua_auto_save_enabled', JSON.stringify(enabled));\n    toastr.info(`${enabled ? '' : ''}`);\n  }\n\n  private loadAutoSaveState() {\n    const savedState = localStorage.getItem('tianhua_auto_save_enabled');\n    if (savedState !== null) {\n      this.isAutoSaveEnabled = JSON.parse(savedState);\n    }\n  }\n\n  private loadTurnCounter() {\n    const savedCounter = localStorage.getItem('tianhua_turn_counter');\n    if (savedCounter !== null) {\n      this.turnCounter = parseInt(savedCounter, 10) || 0;\n    }\n  }\n}\n\nexport const saveLoadService = new SaveLoadService();\n","import type { saveLoadService } from './saveLoadService';\nimport type { inputModalActions, inputModalState } from './InputModalService';\nimport type { store, actions } from '../store';\nimport type { diarySynthesisService } from './DiarySynthesisService';\n\n// \nexport type SaveLoadService = typeof saveLoadService;\nexport type InputModalActions = typeof inputModalActions;\nexport type InputModalState = typeof inputModalState;\nexport type Store = typeof store;\nexport type Actions = typeof actions;\nexport type DiarySynthesisService = typeof diarySynthesisService;\n\ninterface ServiceRegistry {\n  saveLoadService: SaveLoadService;\n  inputModalActions: InputModalActions;\n  inputModalState: InputModalState;\n  store: Store;\n  actions: Actions;\n  diarySynthesisService: DiarySynthesisService;\n}\n\nconst registry: Partial<ServiceRegistry> = {};\n\nexport const serviceLocator = {\n  register<K extends keyof ServiceRegistry>(key: K, instance: ServiceRegistry[K]): void {\n    registry[key] = instance;\n  },\n  get<K extends keyof ServiceRegistry>(key: K): NonNullable<ServiceRegistry[K]> {\n    const instance = registry[key];\n    if (!instance) {\n      throw new Error(`Service with key \"${key}\" has not been registered.`);\n    }\n    return instance as NonNullable<ServiceRegistry[K]>;\n  },\n};\n","// API\ndeclare const TavernHelper: any;\ndeclare const eventEmit: any;\ndeclare const getChatMessages: (id: string) => Promise<any[]>;\ndeclare const getCurrentMessageId: () => string;\n\nclass TavernService {\n  /**\n   * Tavern\n   */\n  async fetchTavernData() {\n    console.debug('Fetching data from Tavern...');\n    const messages = await getChatMessages(getCurrentMessageId());\n    console.debug('Messages received:', messages);\n    return messages;\n  }\n\n  /**\n   * AI\n   * @param prompt - AI\n   * @param variables - \n   */\n  async generateAiResponse(prompt: string): Promise<string> {\n    const generateConfig: any = {\n      injects: [{ role: 'user', content: prompt, position: 'in_chat', should_scan: true }],\n      should_stream: false,\n    };\n\n    const aiResponse = await TavernHelper.generate(generateConfig);\n    if (typeof aiResponse !== 'string') {\n      throw new Error('AI');\n    }\n    return aiResponse;\n  }\n\n  /**\n   * MVU\n   * @param script - MVU\n   * @param oldVariables - \n   */\n  async invokeMvuScript(script: string, oldVariables: any): Promise<any> {\n    const inputData: any = { old_variables: oldVariables };\n\n    await eventEmit('mag_invoke_mvu', script, inputData);\n    return inputData.new_variables;\n  }\n}\n\nexport const tavernService = new TavernService();\n","import { get } from 'lodash';\nimport { computed, ComputedRef } from 'vue';\nimport { lorebookService } from '../services/LorebookService';\nimport {  as Character,  } from '../types';\nimport { store, USER_ID } from './state';\n\n// ---  Getters (-) ---\n\n/**\n * \n */\nexport const playerCharacter: ComputedRef<Character | null> = computed(() => {\n  if (!store.worldState) return null;\n  const character = get(store.worldState, `.${USER_ID}`);\n  //  ''  null\n  if (typeof character === 'string' || !character) {\n    return null;\n  }\n  return character as Character;\n});\n\n/**\n * \n */\nexport const mainWorldNarrative = computed(() => store.mainWorldNarrative);\n\n/**\n * \n * @param path - lodash get-style path to the variable\n */\nexport const getVariable = (path: string, defaultValue: any = null) => {\n  return computed(() => get(store.worldState, path, defaultValue));\n};\n\n// ---  Getters ---\n\nexport const playerAttributes = computed(() => {\n  if (!playerCharacter.value) return [];\n  return get(playerCharacter.value, '', {});\n});\n\nexport const playerSkills = computed(() => {\n  if (!playerCharacter.value) return [];\n  return get(playerCharacter.value, '', {});\n});\n\nexport const playerInventory = computed(() => {\n  if (!playerCharacter.value) return [];\n  return get(playerCharacter.value, '', {});\n});\n\n// ---  Getters ---\n\n/**\n * \n */\nexport const worldTimeStr = computed(() => {\n  if (!store.worldState?.?.) {\n    return '';\n  }\n  return new Date(store.worldState..).toLocaleString('zh-CN', {\n    year: 'numeric',\n    month: '2-digit',\n    day: '2-digit',\n    hour: '2-digit',\n    minute: '2-digit',\n    hour12: false,\n  });\n});\n\n/**\n * \n */\nexport const combinedNarrative = computed(() => {\n  const narrative = store.mainWorldNarrative || '...';\n  return `<div class=\"narrative-block main-world-narrative\">${narrative}</div>`;\n});\n\n// ---  Getters ---\n\n/**\n * Finds an NPC from the world state by their name.\n * @param name The name of the NPC to find.\n */\nexport const getNpcByName = (name: string): Character | null => {\n  const characters = store.worldState?.;\n  if (!characters) return null;\n\n  for (const charId in characters) {\n    const character = characters[charId];\n    if (typeof character !== 'string' && character && character. === name) {\n      return character as Character;\n    }\n  }\n  return null;\n};\n","import type { DiaryFragment, , , Npc } from '../types';\nimport dayjs from 'dayjs';\n\n// \ninterface ScoredLogEntry extends DiaryFragment {\n  relevanceScore: number;\n}\n\n// \ninterface MemoryRetrievalConfig {\n  topN: number; // N\n  recencyWeight: number; // \n  entityMatchWeight: number; // \n  locationMatchWeight: number; // \n  socialGraphWeight: number; // \n  coreTraitWeight: number; // \n  causalLinkWeight: number; // \n}\n\n/**\n * \n * @description \n */\nclass MemoryRetrievalService {\n  private cachedLogs: DiaryFragment[] = [];\n  private entityIdToNameMap: Map<string, string> = new Map(); // ID ->  \n  private lastLogCount = -1;\n\n  private config: MemoryRetrievalConfig = {\n    topN: 5,\n    recencyWeight: 1.5,\n    entityMatchWeight: 5.0,\n    locationMatchWeight: 3.0, // This is currently not used, but kept for future.\n    socialGraphWeight: 4.0,\n    coreTraitWeight: 2.5,\n    causalLinkWeight: 10.0,\n  };\n\n  /**\n   * \n   */\n  public getRelevantMemories(\n    combinedInput: string,\n    worldState: ,\n    diaryFragments: DiaryFragment[],\n    userId: string,\n    dateFilter?: (date: string) => boolean,\n  ): DiaryFragment[] {\n    this.ensureCacheIsReady(diaryFragments, worldState, userId);\n\n    let candidateLogs = this.cachedLogs;\n\n    //  1: \n    if (dateFilter) {\n      candidateLogs = this.cachedLogs.filter(log => log. && dateFilter(log.));\n    }\n\n    //  2: \n    const queryEntities = this.extractQueryEntities(combinedInput, worldState, userId);\n    const scoredLogs = candidateLogs.map(log => {\n      const score = this.calculateRelevanceScore(log, queryEntities, worldState, userId);\n      return { ...log, relevanceScore: score };\n    });\n\n    const highlyRelevantLogs = scoredLogs.filter(log => log.relevanceScore > 0);\n\n    //  3: \n    if (highlyRelevantLogs.length > 0) {\n      return highlyRelevantLogs.sort((a, b) => b.relevanceScore - a.relevanceScore).slice(0, this.config.topN);\n    } else if (dateFilter && candidateLogs.length > 0) {\n      return candidateLogs;\n    } else if (!dateFilter) {\n      return scoredLogs.sort((a, b) => b.relevanceScore - a.relevanceScore).slice(0, this.config.topN);\n    }\n\n    return [];\n  }\n\n  /**\n   * \n   */\n  private calculateRelevanceScore(\n    log: DiaryFragment,\n    queryEntities: Set<string>,\n    worldState: ,\n    userId: string,\n  ): number {\n    let score = 0;\n    const totalLogs = this.cachedLogs.length > 0 ? Math.max(...this.cachedLogs.map(l => l.)) : 1;\n    const logText = `${log.} ${log. || ''} ${log. || ''} ${log. || ''}`;\n    const logEntities = new Set<string>();\n\n    for (const [entityId, entityName] of this.entityIdToNameMap.entries()) {\n      if (entityName && logText.includes(entityName)) {\n        logEntities.add(entityId);\n      }\n    }\n\n    const intersection = new Set([...queryEntities].filter(x => logEntities.has(x)));\n    score += intersection.size * this.config.entityMatchWeight;\n    score += (log. / totalLogs) * this.config.recencyWeight;\n    score += this.getSocialGraphScore(logEntities, queryEntities, worldState);\n    score += this.getCoreTraitScore(logText, logEntities, worldState, userId);\n    score += this.getCausalLinkScore(log, queryEntities);\n\n    return score;\n  }\n\n  /**\n   * \n   */\n  private ensureCacheIsReady(diaryFragments: DiaryFragment[], worldState: , userId: string) {\n    if (diaryFragments.length !== this.lastLogCount) {\n      this.cachedLogs = [...diaryFragments];\n      this.lastLogCount = diaryFragments.length;\n      this.buildEntityIdToNameMap(worldState, userId);\n      console.log(\n        `[MemoryRetrievalService] Cache updated. Entity index rebuilt with ${this.entityIdToNameMap.size} entries.`,\n      );\n    }\n  }\n\n  /**\n   * ID\n   */\n  private buildEntityIdToNameMap(worldState: , userId: string) {\n    this.entityIdToNameMap.clear();\n    const { , ,  } = worldState;\n\n    if () {\n      for (const id in ) {\n        const char = [id];\n        if (typeof char === 'object' && char.) {\n          this.entityIdToNameMap.set(id, char.);\n        }\n      }\n    }\n\n    if () {\n      for (const id in ) {\n        const loc = [id];\n        if (loc.) {\n          this.entityIdToNameMap.set(id, loc.);\n        }\n      }\n    }\n\n    if ( && typeof  === 'object' && .) {\n      this.entityIdToNameMap.set(userId, .);\n    }\n  }\n\n  /**\n   * \n   */\n  private extractQueryEntities(combinedInput: string, worldState: , userId: string): Set<string> {\n    const entities = new Set<string>();\n    entities.add(userId);\n\n    for (const [entityId, entityName] of this.entityIdToNameMap.entries()) {\n      if (entityName && combinedInput.includes(entityName)) {\n        entities.add(entityId);\n      }\n    }\n\n    const protagonist = worldState.;\n    if (protagonist && typeof protagonist === 'object') {\n      const protagonistLocation = protagonist.;\n      if (protagonistLocation && worldState.) {\n        for (const charId in worldState.) {\n          const char = worldState.[charId];\n          if (typeof char === 'object' && char. === protagonistLocation) {\n            entities.add(charId);\n          }\n        }\n      }\n      if (protagonistLocation) {\n        entities.add(protagonistLocation);\n      }\n    }\n    return entities;\n  }\n\n  /**\n   * \n   */\n  private getSocialGraphScore(logEntities: Set<string>, queryEntities: Set<string>, worldState: ): number {\n    let score = 0;\n    if (!worldState.) return 0;\n\n    for (const logEntityId of logEntities) {\n      if (!this.entityIdToNameMap.has(logEntityId)) continue;\n\n      for (const queryEntityId of queryEntities) {\n        if (logEntityId === queryEntityId || !this.entityIdToNameMap.has(queryEntityId)) continue;\n\n        const subjectRelations = worldState.[logEntityId];\n        if (subjectRelations && typeof subjectRelations === 'object') {\n          const relationship = subjectRelations[queryEntityId];\n          if (relationship && typeof relationship === 'object' && relationship.) {\n            const affinityScore = Math.abs(relationship..);\n            const dominanceScore = Math.abs(relationship..);\n\n            if (affinityScore > 80) score += this.config.socialGraphWeight;\n            if (dominanceScore > 100) score += this.config.socialGraphWeight;\n          }\n        }\n      }\n    }\n    return score;\n  }\n\n  /**\n   * \n   */\n  private getCoreTraitScore(\n    logText: string,\n    logEntities: Set<string>,\n    worldState: ,\n    userId: string,\n  ): number {\n    let score = 0;\n    for (const entityId of logEntities) {\n      let character:  | '' | undefined;\n      if (entityId === userId) {\n        character = worldState.;\n      } else {\n        character = worldState.[entityId];\n      }\n\n      if (character && typeof character === 'object' && '' in character) {\n        const npcCharacter = character as Npc;\n        if (npcCharacter.?. && logText.includes(npcCharacter..)) {\n          score += this.config.coreTraitWeight;\n        }\n      }\n    }\n    return score;\n  }\n\n  /**\n   * \n   */\n  private getCausalLinkScore(log: DiaryFragment, queryEntities: Set<string>): number {\n    return 0;\n  }\n}\n\nexport const memoryRetrievalService = new MemoryRetrievalService();\n","import dayjs from 'dayjs';\nimport { AppState, DiaryFragment, Npc, ,  } from '../types';\nimport { InformationRipple } from '../types/evolution';\nimport { debugService } from './DebugService';\nimport { diarySynthesisService } from './DiarySynthesisService';\nimport { lorebookService } from './LorebookService';\nimport { memoryRetrievalService } from './MemoryRetrievalService';\nimport { storylineService } from './StorylineService';\n\ntype TimeSegment = '' | '' | '' | '' | '' | '' | '' | '';\n\nexport interface UserIntent {\n  actionType: 'combat' | 'social' | 'exploration' | 'inventory' | 'creation' | 'default';\n  crossContextQuery?: { worldId: string; epochId?: string; items?: string[]; locations?: string[] };\n  explicitEntities: {\n    characters: string[];\n    locations: string[];\n    dbItems: string[];\n  };\n  triggeredRipples: InformationRipple[];\n  loadFullPlayerData?: (keyof ( | Npc))[];\n}\n\nclass ContextService {\n  private lastProcessedCardDrawTime: { : string; : string } | null = null;\n  private hasIssuedDrawCommandForTime = false;\n\n  public analyzeUserIntent(\n    userInput: string,\n    worldState: AppState['worldState'],\n    availableRipples: InformationRipple[],\n  ): UserIntent {\n    const intent: UserIntent = {\n      actionType: 'default',\n      explicitEntities: {\n        characters: [],\n        locations: [],\n        dbItems: [],\n      },\n      triggeredRipples: [],\n    };\n    if (!worldState) return intent;\n    const patterns: { type: UserIntent['actionType']; regex: RegExp }[] = [\n      { type: 'social', regex: /(|||||||)/ },\n      { type: 'exploration', regex: /(||||||)/ },\n      { type: 'inventory', regex: /(|||||)/ },\n    ];\n    for (const { type, regex } of patterns) {\n      if (regex.test(userInput)) {\n        intent.actionType = type;\n        break;\n      }\n    }\n    if (worldState.) {\n      for (const charId in worldState.) {\n        const char = worldState.[charId];\n        if (typeof char === 'object' && char. && userInput.includes(char.)) {\n          intent.explicitEntities.characters.push(charId);\n        }\n      }\n    }\n    console.log('[ContextService] User Intent Analyzed:', intent);\n    return intent;\n  }\n\n  public async buildLeanContext(\n    intent: UserIntent,\n    userInput: string,\n    lastNarrative: string,\n    worldState: AppState['worldState'],\n    userId: string,\n    diaryFragments: DiaryFragment[],\n  ): Promise<{ sceneContext: object; worldContext: object }> {\n    if (!worldState || typeof worldState. !== 'object') {\n      console.error('[ContextService] World state or protagonist not found or invalid.');\n      return { sceneContext: {}, worldContext: {} };\n    }\n\n    const combinedInput = `${userInput} ${lastNarrative}`;\n    const dateFilter = this.parseRelativeDate(combinedInput, worldState);\n\n    const allStages = await storylineService.getFlattenedStages();\n    const protagonist = worldState.;\n    const protagonistId = userId;\n\n    const { anchorCharacterNames, anchorLocationNames } = await this.parseDirectorLogForAnchors();\n    const locationContext = this.buildLocationContext(worldState, protagonist, anchorLocationNames);\n    const sceneContext = this.buildSceneContext(worldState, protagonist, locationContext);\n\n    const { presentCharacters, absentCharacterSummaries, presentCharacterIds } = await this.buildCharacterContext(\n      intent,\n      combinedInput,\n      worldState,\n      protagonist,\n      protagonistId,\n      anchorCharacterNames,\n    );\n\n    const relationshipContext = this.buildRelationshipContext(worldState, presentCharacterIds, protagonistId);\n    const directiveContext = await this.buildDirectiveContext(worldState, presentCharacterIds, allStages);\n    const memoryContext = await this.buildMemoryContext(\n      worldState,\n      combinedInput,\n      diaryFragments,\n      allStages,\n      userId,\n      dateFilter,\n    );\n    const cardContext = this.buildCardContext(worldState);\n\n    const worldContext = {\n      : protagonist,\n      : presentCharacters,\n      : absentCharacterSummaries,\n      : relationshipContext,\n      : locationContext,\n      : directiveContext,\n      : cardContext,\n      ...memoryContext,\n    };\n\n    debugService.setLastContext({ ...sceneContext, ...worldContext });\n\n    return { sceneContext, worldContext };\n  }\n\n  private buildSceneContext(worldState: AppState['worldState'], protagonist:  | Npc, locationContext: any): object {\n    if (!worldState) {\n      return { : '', : '', : '', : '' };\n    }\n\n    const locationId = protagonist?.;\n    const currentLocation = locationId ? locationContext[locationId] : undefined;\n\n    return {\n      : currentLocation?. || '',\n      : `${worldState...} ${worldState...}`,\n      : worldState..,\n      : currentLocation?.?.map((t: any) => t.).join(', ') || '',\n    };\n  }\n\n  private buildLocationContext(\n    worldState: AppState['worldState'],\n    protagonist:  | Npc | undefined,\n    anchorLocationNames: string[] = [],\n  ): object {\n    const locationContext: any = {};\n    if (!worldState?.) return locationContext;\n\n    const allLocations = worldState.;\n    const anchorLocationIds = Object.entries(allLocations)\n      .filter(([, loc]) => anchorLocationNames.includes(loc.))\n      .map(([id]) => id);\n\n    const fullDetailLocationIds = new Set<string>(anchorLocationIds);\n\n    if (protagonist?.) {\n      fullDetailLocationIds.add(protagonist.);\n      const parentIds = this.getAllParentLocationIds(protagonist., allLocations);\n      parentIds.forEach(id => fullDetailLocationIds.add(id));\n    }\n\n    for (const locationId in allLocations) {\n      const location = allLocations[locationId];\n      if (fullDetailLocationIds.has(locationId)) {\n        locationContext[locationId] = location;\n      } else {\n        locationContext[locationId] = {\n          : location.,\n          : location.,\n        };\n      }\n    }\n    return locationContext;\n  }\n\n  private async buildCharacterContext(\n    intent: UserIntent,\n    combinedInput: string,\n    worldState: AppState['worldState'],\n    protagonist:  | Npc | undefined,\n    protagonistId: string | undefined,\n    anchorCharacterNames: string[] = [],\n  ): Promise<{ presentCharacters: any; absentCharacterSummaries: any; presentCharacterIds: Set<string> }> {\n    const presentCharacters: any = {};\n    const absentCharacterSummaries: any = {};\n    const presentCharacterIds = new Set<string>();\n\n    const clothingStyleGuide = await this.loadClothingStyles();\n\n    if (worldState && worldState.) {\n      const allChars = worldState.;\n      const anchorCharIds = Object.entries(allChars)\n        .filter(([, char]) => typeof char === 'object' && anchorCharacterNames.includes(char.))\n        .map(([id]) => id);\n\n      const sceneLocation = protagonist?.;\n      const explicitChars = new Set(intent.explicitEntities.characters);\n\n      const fullDetailCharIds = new Set<string>(anchorCharIds);\n      if (protagonistId) fullDetailCharIds.add(protagonistId);\n      explicitChars.forEach(id => fullDetailCharIds.add(id));\n\n      for (const charId in allChars) {\n        const char = allChars[charId];\n        if (typeof char === 'object' && char && char. === sceneLocation) {\n          fullDetailCharIds.add(charId);\n          presentCharacterIds.add(charId);\n        }\n      }\n\n      for (const charId in allChars) {\n        const char = allChars[charId];\n        if (typeof char !== 'object' || !char) continue;\n\n        const charWithStyle = { ...char };\n        const styleGuide = clothingStyleGuide?.[charId] || clothingStyleGuide?.DEFAULT;\n        if (styleGuide) {\n          const finalStyle: any = {\n            : styleGuide.,\n            : styleGuide.,\n          };\n\n          const season = this.getCurrentSeason(new Date(worldState...));\n          const weather = worldState..;\n\n          if (styleGuide.?.[season]) {\n            finalStyle. = { [season]: styleGuide.[season] };\n          }\n          if (styleGuide.?.[weather]) {\n            finalStyle. = { [weather]: styleGuide.[weather] };\n          }\n\n          (charWithStyle as any). = finalStyle;\n        }\n\n        if (fullDetailCharIds.has(charId)) {\n          presentCharacters[charId] = charWithStyle;\n          if (char. === sceneLocation) presentCharacterIds.add(charId);\n        } else {\n          absentCharacterSummaries[charId] = {\n            : char.,\n            : char.,\n            : char.,\n            : (char as Npc).?.,\n          };\n        }\n      }\n    }\n\n    return { presentCharacters, absentCharacterSummaries, presentCharacterIds };\n  }\n\n  private buildRelationshipContext(\n    worldState: AppState['worldState'],\n    presentCharacterIds: Set<string>,\n    protagonistId?: string,\n  ): object {\n    const relationshipContext: any = {};\n    if (!worldState?.) return relationshipContext;\n\n    const fullCausalNet = worldState.;\n    const idsToProcess = new Set(presentCharacterIds);\n    if (protagonistId) {\n      idsToProcess.add(protagonistId);\n    }\n\n    for (const subjectId of idsToProcess) {\n      const subjectRelations = fullCausalNet[subjectId];\n      if (!subjectRelations) continue;\n      relationshipContext[subjectId] = {};\n      for (const objectId of idsToProcess) {\n        if (subjectRelations[objectId]) {\n          relationshipContext[subjectId][objectId] = subjectRelations[objectId];\n        }\n      }\n    }\n    return relationshipContext;\n  }\n\n  private async buildDirectiveContext(\n    worldState: AppState['worldState'],\n    presentCharacterIds: Set<string>,\n    allStages: any[] | null,\n  ): Promise<object> {\n    if (!worldState) return {};\n    const directiveContext: any = {};\n\n    try {\n      if (allStages) {\n        const actionableEvent = await storylineService.getActionableStoryline(worldState);\n        let foreshadowedEvents: any[] = [];\n\n        if (actionableEvent) {\n          directiveContext. = {\n            ...actionableEvent,\n            :\n              'NPC``',\n          };\n          const actionableEventIndex = allStages.findIndex(s => s.id === actionableEvent.id);\n          if (actionableEventIndex !== -1) {\n            foreshadowedEvents = allStages.slice(actionableEventIndex + 1, actionableEventIndex + 4);\n          }\n        } else {\n          const history = worldState.?. || [];\n          const firstUncompletedIndex = allStages.findIndex(s => s.id && !history.includes(s.id));\n          if (firstUncompletedIndex !== -1) {\n            foreshadowedEvents = allStages.slice(firstUncompletedIndex, firstUncompletedIndex + 3);\n          }\n        }\n\n        if (foreshadowedEvents.length > 0) {\n          directiveContext. = foreshadowedEvents.map((event: any) => ({\n            ...event,\n            :\n              '``',\n          }));\n        }\n      }\n    } catch (error) {\n      console.error('[ContextService] Failed to process main story data:', error);\n    }\n\n    // \n    try {\n      const calendarContent = await lorebookService.readFromLorebook('[]-');\n      if (calendarContent) {\n        const calendarData = JSON.parse(calendarContent);\n        const currentMonth = new Date(worldState...).getMonth() + 1;\n        const currentDay = new Date(worldState...).getDate();\n        const monthKey = String(currentMonth).padStart(2, '0');\n\n        const fixedEvents = calendarData.events?.[monthKey] || {};\n\n        const upcomingEvents = [];\n        for (let i = 0; i < 7; i++) {\n          const checkDate = new Date(worldState...);\n          checkDate.setDate(currentDay + i);\n          const checkDayKey = String(checkDate.getDate()).padStart(2, '0');\n          if (fixedEvents[checkDayKey]) {\n            upcomingEvents.push({\n              : `${checkDate.getFullYear()}-${String(checkDate.getMonth() + 1).padStart(2, '0')}-${checkDayKey}`,\n              : fixedEvents[checkDayKey].join(' | '),\n            });\n          }\n        }\n\n        if (upcomingEvents.length > 0) {\n          directiveContext. = {\n            : '',\n            : upcomingEvents,\n          };\n        }\n      }\n\n      const randomEventsContent = await lorebookService.readFromLorebook('[]-');\n      if (randomEventsContent) {\n        const randomEventsData = JSON.parse(randomEventsContent);\n        const randomPool = randomEventsData.pool || [];\n        const availableRandomEvents = randomPool\n          .slice(0, 2)\n          .map((event: any) => ({ : event.type, : event.content, : event.detail }));\n        if (availableRandomEvents.length > 0) {\n          directiveContext. = {\n            : '',\n            : availableRandomEvents,\n          };\n        }\n      }\n    } catch (error) {\n      console.error('[ContextService] Failed to process calendar data:', error);\n    }\n\n    if (worldState. && worldState..) {\n      const cardDrawTime = worldState..;\n      if (cardDrawTime && cardDrawTime. && cardDrawTime.) {\n        if (\n          !this.lastProcessedCardDrawTime ||\n          this.lastProcessedCardDrawTime. !== cardDrawTime. ||\n          this.lastProcessedCardDrawTime. !== cardDrawTime.\n        ) {\n          this.hasIssuedDrawCommandForTime = false;\n          this.lastProcessedCardDrawTime = { ...cardDrawTime };\n        }\n\n        const timeToDraw = storylineService.isTimeReached(\n          dayjs(worldState...),\n          worldState... as TimeSegment,\n          {\n            trigger_time: cardDrawTime,\n          },\n        );\n\n        if (timeToDraw && !this.hasIssuedDrawCommandForTime) {\n          directiveContext. = directiveContext. || [];\n          directiveContext..push({\n            : '',\n            : '-',\n          });\n          this.hasIssuedDrawCommandForTime = true;\n        }\n      }\n    }\n\n    const synthesisRequest = diarySynthesisService.getSynthesisRequest();\n    if (synthesisRequest) {\n      directiveContext. = directiveContext. || [];\n      directiveContext..push({\n        : synthesisRequest.includes('') ? '' : '',\n        : synthesisRequest,\n      });\n    }\n\n    return directiveContext;\n  }\n\n  private async buildMemoryContext(\n    worldState: ,\n    combinedInput: string,\n    diaryFragments: DiaryFragment[],\n    allStages: any[] | null,\n    userId: string,\n    dateFilter?: (date: string) => boolean,\n  ): Promise<object> {\n    if (!worldState) return {};\n\n    const memoryContext: any = {};\n\n    const memories = memoryRetrievalService.getRelevantMemories(\n      combinedInput,\n      worldState,\n      diaryFragments,\n      userId,\n      dateFilter,\n    );\n\n    if (memories.length > 0) {\n      if (dateFilter) {\n        memoryContext. = {\n          : ``,\n          : memories,\n        };\n      } else {\n        memoryContext. = {\n          : '',\n          : memories,\n        };\n      }\n    }\n\n    if (!dateFilter && worldState.?. && worldState...length > 0 && allStages) {\n      const recentHistoryIds = worldState...slice(-3);\n      const recentEventsDetails = recentHistoryIds\n        .map(id => allStages.find(s => (s.id || s.stage_id) === id))\n        .filter(Boolean);\n\n      if (recentEventsDetails.length > 0) {\n        memoryContext. = {\n          : '3',\n          : recentEventsDetails,\n        };\n      }\n    }\n\n    return memoryContext;\n  }\n\n  private async parseDirectorLogForAnchors(): Promise<{\n    anchorCharacterNames: string[];\n    anchorLocationNames: string[];\n  }> {\n    const anchorCharacterNames: string[] = [];\n    const anchorLocationNames: string[] = [];\n    try {\n      const directorLogContent = await lorebookService.readFromLorebook('[]');\n      if (directorLogContent) {\n        const anchorSectionRegex = /\\s*([\\s\\S]*)/;\n        const match = directorLogContent.match(anchorSectionRegex);\n        if (match && match[1]) {\n          const content = match[1];\n          const charRegex = /(.*?)\\n/;\n          const locRegex = /(.*?)\\n/;\n\n          const charMatch = content.match(charRegex);\n          if (charMatch && charMatch[1]) {\n            anchorCharacterNames.push(...charMatch[1].split('').map(s => s.trim()));\n          }\n\n          const locMatch = content.match(locRegex);\n          if (locMatch && locMatch[1]) {\n            anchorLocationNames.push(...locMatch[1].split('').map(s => s.trim()));\n          }\n        }\n      }\n    } catch (error) {\n      console.error('[ContextService] Failed to parse director log for anchors:', error);\n    }\n    return { anchorCharacterNames, anchorLocationNames };\n  }\n\n  private getAllParentLocationIds(locationId: string, allLocations: Record<string, any>): string[] {\n    const parents: string[] = [];\n    let currentId: string | undefined = locationId;\n    for (let i = 0; i < 10 && currentId; i++) {\n      const location: any = allLocations[currentId];\n      if (location && location. && location..ID) {\n        const parentId: string = location..ID;\n        parents.push(parentId);\n        currentId = parentId;\n      } else {\n        break;\n      }\n    }\n    return parents;\n  }\n\n  private simplifyIdMap(map: any) {\n    if (!map) return {};\n    const simple: any = {};\n    for (const key in map) {\n      if (key === '$meta') continue;\n      simple[key] = typeof map[key] === 'number' ? map[key] : true;\n    }\n    return simple;\n  }\n\n  private parseRelativeDate(userInput: string, worldState: ): ((date: string) => boolean) | undefined {\n    const currentDate = dayjs(worldState...);\n    const chineseNumMap: { [key: string]: number } = {\n      : 1,\n      : 2,\n      : 3,\n      : 4,\n      : 5,\n      : 6,\n      : 7,\n      : 8,\n      : 9,\n      : 10,\n    };\n\n    const daysAgoMatch = userInput.match(/((\\d+)|[])/);\n    const weeksAgoMatch = userInput.match(/((\\d+)|[])/);\n    const shangZhouMatch = userInput.match(/^(+)/);\n    const monthsAgoMatch = userInput.match(/((\\d+)|[])/);\n    const specificMonthMatch = userInput.match(/((\\d+)|[])()?/);\n\n    if (daysAgoMatch) {\n      const numStr = daysAgoMatch[1];\n      const num = parseInt(numStr, 10) || chineseNumMap[numStr];\n      if (num) {\n        const target = currentDate.subtract(num, 'day').format('YYYY-MM-DD');\n        return (d: string) => d === target;\n      }\n    } else if (shangZhouMatch) {\n      const num = shangZhouMatch[1].length;\n      const targetWeekStart = currentDate.subtract(num, 'week').startOf('week');\n      const targetWeekEnd = currentDate.subtract(num, 'week').endOf('week');\n      return (d: string) => dayjs(d).isAfter(targetWeekStart) && dayjs(d).isBefore(targetWeekEnd);\n    } else if (weeksAgoMatch) {\n      const numStr = weeksAgoMatch[1];\n      const num = parseInt(numStr, 10) || chineseNumMap[numStr];\n      if (num) {\n        const targetWeekStart = currentDate.subtract(num, 'week').startOf('week');\n        const targetWeekEnd = currentDate.subtract(num, 'week').endOf('week');\n        return (d: string) => dayjs(d).isAfter(targetWeekStart) && dayjs(d).isBefore(targetWeekEnd);\n      }\n    } else if (monthsAgoMatch) {\n      const numStr = monthsAgoMatch[1];\n      const num = parseInt(numStr, 10) || chineseNumMap[numStr];\n      if (num) {\n        const targetMonth = currentDate.subtract(num, 'month');\n        const target = targetMonth.format('YYYY-MM');\n        return (d: string) => d.startsWith(target);\n      }\n    } else if (userInput.includes('')) {\n      const target = currentDate.subtract(1, 'year').format('YYYY');\n      return (d: string) => d.startsWith(target);\n    } else if (specificMonthMatch) {\n      const numStr = specificMonthMatch[1];\n      const monthNum = parseInt(numStr, 10) || chineseNumMap[numStr];\n      if (monthNum && monthNum > 0 && monthNum <= 12) {\n        let targetMonth = currentDate.month(monthNum - 1);\n        if (targetMonth.isAfter(currentDate)) {\n          targetMonth = targetMonth.subtract(1, 'year');\n        }\n        const target = targetMonth.format('YYYY-MM');\n        return (d: string) => d.startsWith(target);\n      }\n    } else if (userInput.includes('') || userInput.includes('')) {\n      const prefix = currentDate.format('YYYY-MM');\n      return (d: string) => d.startsWith(prefix) && parseInt(d.slice(-2), 10) <= 10;\n    } else if (userInput.includes('') || userInput.includes('')) {\n      const prefix = currentDate.format('YYYY-MM');\n      return (d: string) => d.startsWith(prefix) && parseInt(d.slice(-2), 10) > 10 && parseInt(d.slice(-2), 10) <= 20;\n    } else if (userInput.includes('') || userInput.includes('')) {\n      const prefix = currentDate.format('YYYY-MM');\n      return (d: string) => d.startsWith(prefix) && parseInt(d.slice(-2), 10) > 20;\n    } else if (userInput.includes('')) {\n      const target = currentDate.subtract(1, 'day').format('YYYY-MM-DD');\n      return (d: string) => d === target;\n    } else if (userInput.includes('')) {\n      const target = currentDate.subtract(2, 'day').format('YYYY-MM-DD');\n      return (d: string) => d === target;\n    }\n\n    return undefined;\n  }\n\n  private buildCardContext(worldState: AppState['worldState']): object {\n    const cardContext: any = {\n      : [],\n      : [],\n    };\n    if (!worldState?. || typeof worldState. === 'string') {\n      return cardContext;\n    }\n\n    // \n    cardContext. = worldState.. || [];\n    cardContext. = worldState.. || [];\n\n    return cardContext;\n  }\n\n  private async loadClothingStyles(): Promise<Record<string, any> | null> {\n    try {\n      const content = await lorebookService.readFromLorebook('[]');\n      if (content) {\n        const data = JSON.parse(content);\n        return data.character_styles || null;\n      }\n    } catch (e) {\n      console.error('Failed to load or parse []', e);\n    }\n    return null;\n  }\n\n  private getCurrentSeason(date: Date): '' | '' | '' | '' {\n    const month = date.getMonth() + 1;\n    if (month >= 3 && month <= 5) return '';\n    if (month >= 6 && month <= 8) return '';\n    if (month >= 9 && month <= 11) return '';\n    return '';\n  }\n}\n\nexport const contextService = new ContextService();\n","import { get } from 'lodash';\nimport { AppState, World, SpatialEntity } from '../types';\nimport {\n  EvolutionaryPressure,\n  InformationPropagationRule,\n  InformationRipple,\n  StressReactionEvent,\n} from '../types/evolution';\nimport { entityIndexService } from './EntityIndexService';\n\n/**\n * \n * \n * 1. \n * 2. \n * 3. \n */\nclass WorldEvolutionService {\n  /**\n   * \n   */\n  private informationDelayQueue: InformationRipple[] = [];\n\n  /**\n   * \n   * @param worldState - \n   * @returns \n   */\n  public applyPressure(worldState: AppState['worldState']): EvolutionaryPressure[] {\n    const pressures: EvolutionaryPressure[] = [];\n    if (!worldState?.) return pressures;\n\n    for (const world of Object.values(worldState.)) {\n      // 1. : NPC\n      const characters = get(world, '', {}) as { [id: string]: Character };\n      for (const charId in characters) {\n        if (charId.startsWith('sample_')) continue; // NPC\n        const char = characters[charId] as Character;\n        if (!char || !('' in char)) continue;\n\n        const desire = get(char, '..');\n        const powerLevel = get(char, '.', 0);\n        const spirit = get(char, '.', 0);\n\n        // 1\n        const isAmbitious = desire && Object.values(desire).some((g: any) => g. === '');\n\n        // 2\n        const isPowerful = powerLevel > 100 || spirit > 8; // \n\n        if (isAmbitious || isPowerful) {\n          const firstGoal = isAmbitious\n            ? (Object.values(desire)[0] as any)\n            : { : '', : '' };\n          let intensity = spirit * 5 + get(char, '..', 0);\n          if (isPowerful && !isAmbitious) {\n            intensity = powerLevel / 10; // \n          }\n\n          pressures.push({\n            type: isAmbitious ? 'desire' : 'authority', // \n            source: { type: 'npc', id: charId },\n            intensity,\n            description: `[${char.}] `,\n            intent: firstGoal. || '',\n          });\n        }\n      }\n    }\n\n    console.log(`[EvoSys-Pressure] Identified ${pressures.length} evolutionary pressures.`, pressures);\n    return pressures;\n  }\n\n  /**\n   * \n   * @param pressures - \n   * @param worldState - \n   * @returns \n   */\n  public simulateReactions(\n    pressures: EvolutionaryPressure[],\n    worldState: AppState['worldState'],\n  ): StressReactionEvent[] {\n    const reactions: StressReactionEvent[] = [];\n    if (!worldState) return reactions;\n\n    console.log(`[EvoSys-Reaction] Simulating reactions for ${pressures.length} pressures...`);\n    for (const pressure of pressures) {\n      if (pressure.intensity > 50) {\n        // \n        const sourceChar = get(\n          worldState,\n          `.${entityIndexService.findById(pressure.source.id)?.worldId}..${pressure.source.id}`,\n        );\n        if (sourceChar) {\n          const newEvent: StressReactionEvent = {\n            id: `event_${pressure.source.id}_${Date.now()}`,\n            timestamp: Date.now(), // \n            locationId: sourceChar.,\n            type: 'personal',\n            description: `${sourceChar.} ${pressure.intent}`,\n            participants: [pressure.source.id],\n            sourcePressure: pressure,\n          };\n          reactions.push(newEvent);\n          console.log(`[EvoSys-Reaction] Generated event:`, newEvent);\n        }\n      }\n    }\n\n    return reactions;\n  }\n\n  /**\n   * \n   * @param event - \n   * @param worldState - \n   */\n  public propagateRipples(event: StressReactionEvent, worldState: AppState['worldState']) {\n    if (!worldState?.) return;\n\n    const worldId = event.locationId ? entityIndexService.findById(event.locationId)?.worldId : null;\n    if (!worldId) return;\n\n    const world = worldState.[worldId];\n    if (!world) return;\n\n    // 1.  InformationRipple\n    // \n    const ripple: Omit<InformationRipple, 'arrivalTimestamp'> = {\n      id: `ripple_${event.id}_${Math.random().toString(36).substring(2, 6)}`,\n      sourceEventId: event.id,\n      type: 'rumor',\n      content: `${entityIndexService.findById(event.locationId)?.name || ''}`,\n      sphereOfInfluence: { locationIds: [], factionIds: [] },\n      decayRate: 0.1,\n      distortion: 0,\n    };\n\n    // 2. \n    const propagationRules = get(world, '..', []) as InformationPropagationRule[];\n    const rule = propagationRules.find(r => r.medium === ripple.type) || { baseSpeed: 100 }; // \n\n    // 3. \n    // \n    // \n    const distance = 1000; // 1000\n    const delayDays = distance / rule.baseSpeed;\n    const delayMilliseconds = delayDays * 24 * 60 * 60 * 1000;\n    const arrivalTimestamp = event.timestamp + delayMilliseconds;\n\n    // 4.  informationDelayQueue\n    const newRipple: InformationRipple = { ...ripple, arrivalTimestamp };\n    this.informationDelayQueue.push(newRipple);\n    console.log(\n      `[EvoSys-Ripple] New ripple queued. Distance: ${distance}km. Arrival in ${delayDays.toFixed(1)} days.`,\n      newRipple,\n    );\n    console.log('[EvoSys-Queue] Current Information Delay Queue:', this.informationDelayQueue);\n  }\n\n  /**\n   * \n   * @param currentTime - \n   * @returns \n   */\n  public getAvailableRipples(currentTime: number): InformationRipple[] {\n    const availableRipples: InformationRipple[] = [];\n    const remainingRipples: InformationRipple[] = [];\n\n    for (const ripple of this.informationDelayQueue) {\n      if (ripple.arrivalTimestamp <= currentTime) {\n        availableRipples.push(ripple);\n      } else {\n        remainingRipples.push(ripple);\n      }\n    }\n\n    // \n    this.informationDelayQueue = remainingRipples;\n\n    if (availableRipples.length > 0) {\n      console.log(\n        `[EvoSys-Gravity] ${availableRipples.length} ripples have arrived and are now available as 'narrative material'.`,\n        availableRipples,\n      );\n    }\n\n    return availableRipples;\n  }\n\n  /**\n   * \n   * @param locationIdA - ID\n   * @param locationIdB - ID\n   * @param world - \n   * @returns null\n   */\n  private calculateDistance(locationIdA: string, locationIdB: string, world: World): number | null {\n    const locationA = entityIndexService.findById(locationIdA);\n    const locationB = entityIndexService.findById(locationIdB);\n\n    if (!locationA || !locationB || !world) return null;\n\n    // \n    // A*\n    if (locationA.parentId === locationB.parentId && locationA.parentId !== 'WORLD_ORIGIN') {\n      const epochId = locationA.epochId || get(world, '..ID');\n      if (!epochId) return null;\n      const parentEntity = get(world, `..${epochId}...${locationA.parentId}`) as SpatialEntity;\n      const locAData = get(world, `..${epochId}...${locationIdA}`) as SpatialEntity;\n      const locBData = get(world, `..${epochId}...${locationIdB}`) as SpatialEntity;\n\n      if (locAData?. && locBData?.) {\n        // \n        return (locAData..?.[0] || 0) + (locBData..?.[0] || 0);\n      }\n    }\n\n    // /\n    return 1000;\n  }\n}\n\nexport const worldEvolutionService = new WorldEvolutionService();\n","import { cloneDeep, get, set } from 'lodash';\nimport { z } from 'zod';\nimport { contextService } from '../services/ContextService';\nimport { lorebookService } from '../services/LorebookService';\nimport { memoryService } from '../services/MemoryService';\nimport { notificationService } from '../services/NotificationService';\nimport { serviceLocator } from '../services/service-locator';\nimport { tavernService } from '../services/tavern';\nimport { workflowService } from '../services/WorkflowService';\nimport { worldEvolutionService } from '../services/WorldEvolutionService';\nimport { storylineService, DisplayStoryStage } from '../services/StorylineService';\nimport { diarySynthesisService } from '../services/DiarySynthesisService';\nimport { EvolutionaryPressure } from '../types/evolution';\nimport { processTags } from '../utils/tagProcessor';\nimport { store, USER_ID } from './state';\nimport type { DiaryEntry, WeeklyReview, , , Npc, DiaryFragment, DirectorLog } from '../types';\n\n/**\n * Sanitize incoming data from Tavern to ensure it points to the actual state object,\n * handling cases where `stat_data` root may or may not be present.\n */\nfunction sanitizeStateData(data: any): any {\n  if (!data) return null;\n  return data.stat_data || data;\n}\n\nlet lastProcessedMessageId: string | null = null;\nlet isLogHistoryLoaded = false;\nconst ZOD_ERROR_NOTIFIED_KEY = 'zodErrorNotified';\nlet isZodErrorNotified = sessionStorage.getItem(ZOD_ERROR_NOTIFIED_KEY) === 'true';\n\nfunction checkForChangesAndNotify(oldState: any, newState: any) {\n  if (!oldState || !newState) return;\n\n  const oldChars = get(oldState, '', {});\n  const newChars = get(newState, '', {});\n  for (const charId in newChars) {\n    if ((!oldChars[charId] || oldChars[charId] === '') && typeof newChars[charId] === 'object') {\n      const char = newChars[charId];\n      notificationService.info('', ` ${char.}`);\n    }\n  }\n\n  const oldInventory = get(oldState, '.', {});\n  const newInventory = get(newState, '.', {});\n  if (oldInventory && newInventory) {\n    const allItemIds = new Set([...Object.keys(oldInventory), ...Object.keys(newInventory)]);\n    for (const itemId of allItemIds) {\n      const oldQty = oldInventory[itemId]?. || 0;\n      const newQty = newInventory[itemId]?. || 0;\n      const diff = newQty - oldQty;\n      if (diff !== 0) {\n        const itemName = itemId;\n        const action = diff > 0 ? '' : '';\n        notificationService.success('', `${action} ${itemName} x${Math.abs(diff)}`);\n      }\n    }\n  }\n\n  const oldUser = get(oldState, '', {});\n  const newUser = get(newState, '', {});\n  if (oldUser && newUser) {\n    const compareAndNotify = (path: string, name: string) => {\n      const oldVal = get(oldUser, path);\n      const newVal = get(newUser, path);\n      if (JSON.stringify(oldVal) !== JSON.stringify(newVal)) {\n        notificationService.info('', `${name} `);\n      }\n    };\n\n    if (oldUser. && newUser.) {\n      const allAttributes = new Set([...Object.keys(oldUser.), ...Object.keys(newUser.)]);\n      for (const attr of allAttributes) {\n        compareAndNotify(`.${attr}`, `[${attr}]`);\n      }\n    }\n  }\n}\n\nfunction parseBlock(block: string): { [key: string]: any } {\n  const data: { [key: string]: any } = {};\n  const lines = block.trim().split('\\n');\n  let currentKey: string | null = null;\n  let isParsingMultiLine = false;\n  let multiLineContent: any = null;\n\n  for (const line of lines) {\n    if (line.trim() === '---') {\n      isParsingMultiLine = false;\n      currentKey = null;\n      continue;\n    }\n\n    if (!isParsingMultiLine) {\n      const separatorIndex = line.indexOf('|');\n      if (separatorIndex !== -1) {\n        const key = line.substring(0, separatorIndex).trim();\n        const value = line.substring(separatorIndex + 1).trim();\n        data[key] = value;\n        currentKey = key;\n\n        if (\n          [\n            '',\n            '',\n            'BBS',\n            '',\n            '',\n            '',\n            '',\n            '',\n          ].includes(key)\n        ) {\n          isParsingMultiLine = true;\n          multiLineContent = {};\n          data[key] = multiLineContent;\n        } else if (['', 'NPC', '', ''].includes(key)) {\n          isParsingMultiLine = true;\n          multiLineContent = [];\n          data[key] = multiLineContent;\n        }\n      }\n    } else if (currentKey) {\n      const trimmedLine = line.trim();\n      if (trimmedLine.startsWith('- ')) {\n        const itemContent = trimmedLine.substring(2).trim();\n        if (Array.isArray(data[currentKey])) {\n          data[currentKey].push(itemContent);\n        } else if (typeof data[currentKey] === 'object') {\n          const itemSeparatorIndex = itemContent.indexOf(':');\n          if (itemSeparatorIndex !== -1) {\n            const itemKey = itemContent.substring(0, itemSeparatorIndex).trim();\n            const itemValue = itemContent.substring(itemSeparatorIndex + 1).trim();\n            if (!data[currentKey][currentKey]) {\n              data[currentKey][currentKey] = [];\n            }\n            data[currentKey][currentKey].push({ [itemKey]: itemValue });\n          }\n        }\n      } else if (trimmedLine) {\n        if (typeof data[currentKey] === 'object' && !Array.isArray(data[currentKey])) {\n          const itemSeparatorIndex = trimmedLine.indexOf(':');\n          if (itemSeparatorIndex !== -1) {\n            const itemKey = trimmedLine.substring(0, itemSeparatorIndex).trim();\n            const itemValue = trimmedLine.substring(itemSeparatorIndex + 1).trim();\n            data[currentKey][itemKey] = itemValue;\n          }\n        }\n      }\n    }\n  }\n  return data;\n}\n\n// \nfunction parseDiaryFragment(block: string): Partial<DiaryFragment> {\n  const fragment: Partial<DiaryFragment> = {};\n  const sections = block.split('\\n---\\n');\n\n  //  key|value\n  const headerLines = sections[0]?.trim().split('\\n') || [];\n  for (const line of headerLines) {\n    const separatorIndex = line.indexOf('|');\n    if (separatorIndex !== -1) {\n      const key = line.substring(0, separatorIndex).trim();\n      const value = line.substring(separatorIndex + 1).trim();\n      switch (key) {\n        case '':\n          fragment. = parseInt(value, 10);\n          break;\n        case '':\n          fragment. = value;\n          break;\n        case '':\n          fragment. = value;\n          break;\n        case '':\n          fragment. = value;\n          break;\n      }\n    }\n  }\n\n  // \n  for (let i = 1; i < sections.length; i++) {\n    const section = sections[i].trim();\n    const headerMatch = section.match(/^(.+?)\\n?/);\n    if (!headerMatch) continue;\n\n    const header = headerMatch[1];\n    const content = section.substring(headerMatch[0].length).trim();\n\n    switch (header) {\n      case '': {\n        const summaryMatch = content.match(/^\\|(.+)/s);\n        if (summaryMatch) fragment. = summaryMatch[1].trim();\n        break;\n      }\n      case '': {\n        fragment. = content;\n        break;\n      }\n      case '': {\n        // \n        fragment. = content;\n        break;\n      }\n      case '': {\n        fragment. = content;\n        break;\n      }\n    }\n  }\n\n  return fragment;\n}\n\nasync function loadWeeklyReviewsFromLorebook() {\n  try {\n    const reviewContent = await lorebookService.readFromLorebook('');\n    if (!reviewContent || !reviewContent.trim()) {\n      store.weeklyReviews = [];\n      return;\n    }\n    const reviewBlocks = reviewContent.split('\\n\\n===\\n\\n');\n    const allReviews = reviewBlocks.map(block => parseBlock(block) as unknown as WeeklyReview);\n    store.weeklyReviews = allReviews.sort((a, b) => a. - b.);\n    console.log(`[Store] Loaded ${store.weeklyReviews.length} weekly reviews.`);\n  } catch (error) {\n    console.error('Error loading weekly reviews from lorebook:', error);\n    store.weeklyReviews = [];\n  }\n}\n\nasync function loadDiaryFromLorebook() {\n  try {\n    const diaryContent = (await lorebookService.readFromLorebook('')) || '';\n    const archiveContent = (await lorebookService.readFromLorebook('-')) || '';\n    const combinedContent = diaryContent + '\\n\\n---\\n\\n' + archiveContent;\n\n    if (!combinedContent.trim()) {\n      store.diary = [];\n      return;\n    }\n    const logBlocks = combinedContent.split(/\\n\\n---\\n\\n|\\n\\n===\\[\\]===\\n\\n/g);\n    const allLogs = logBlocks\n      .map(block => {\n        if (!block.trim()) return null;\n        try {\n          return parseBlock(block) as unknown as DiaryEntry;\n        } catch (e) {\n          console.error('Failed to parse diary block:', block, e);\n          return null;\n        }\n      })\n      .filter((log): log is DiaryEntry => log !== null && !!log.);\n\n    const uniqueLogsMap = new Map<string, DiaryEntry>();\n    for (const log of allLogs) {\n      if (log.) {\n        uniqueLogsMap.set(log., log);\n      }\n    }\n    const uniqueLogs = Array.from(uniqueLogsMap.values());\n    store.diary = uniqueLogs.sort((a, b) => new Date(a.).getTime() - new Date(b.).getTime());\n    console.log(`[Store] Loaded and deduplicated ${store.diary.length} entries from \"\" and \"-\".`);\n  } catch (error) {\n    console.error('Error loading diary from lorebook:', error);\n    store.diary = [];\n  }\n}\n\nasync function loadDiaryFragmentsFromLorebook() {\n  try {\n    const fragmentContent = (await lorebookService.readFromLorebook('')) || '';\n    const archiveContent = (await lorebookService.readFromLorebook('-')) || '';\n    const combinedContent = fragmentContent + '\\n\\n---\\n\\n' + archiveContent;\n\n    if (!combinedContent.trim()) {\n      store.diaryFragments = [];\n      return;\n    }\n    const fragmentBlocks = combinedContent.split('\\n\\n---\\n\\n');\n    const allFragments = fragmentBlocks\n      .map(block => {\n        if (!block.trim()) return null;\n        try {\n          // \n          return parseDiaryFragment(block) as DiaryFragment;\n        } catch (e) {\n          console.error('Failed to parse diary fragment block:', block, e);\n          return null;\n        }\n      })\n      .filter((frag): frag is DiaryFragment => frag !== null && frag. !== undefined);\n\n    const uniqueFragmentsMap = new Map<number, DiaryFragment>();\n    for (const frag of allFragments) {\n      uniqueFragmentsMap.set(frag., frag);\n    }\n    store.diaryFragments = Array.from(uniqueFragmentsMap.values()).sort((a, b) => a. - b.);\n    console.log(`[Store] Loaded and deduplicated ${store.diaryFragments.length} fragments.`);\n  } catch (error) {\n    console.error('Error loading diary fragments:', error);\n    store.diaryFragments = [];\n  }\n}\n\nasync function loadDirectorLogsFromLorebook() {\n  try {\n    const logContent = await lorebookService.readFromLorebook('');\n    if (!logContent || !logContent.trim()) {\n      store.directorLogs = [];\n      return;\n    }\n    const logBlocks = logContent.split('\\n\\n---\\n\\n');\n    const allLogs = logBlocks.map(block => parseBlock(block) as unknown as DirectorLog);\n    store.directorLogs = allLogs.sort((a, b) => parseInt(a.ID, 10) - parseInt(b.ID, 10));\n    console.log(`[Store] Loaded ${store.directorLogs.length} director logs.`);\n  } catch (error) {\n    console.error('Error loading director logs from lorebook:', error);\n    store.directorLogs = [];\n  }\n}\n\nasync function fetchCoreData() {\n  try {\n    const messages = await tavernService.fetchTavernData();\n    if (messages && messages.length > 0 && messages[0].data) {\n      const rawStateData = sanitizeStateData(messages[0].data);\n      const fullMessageContent = messages[0].message;\n      const currentMessageId = messages[0].id;\n      const oldState = JSON.parse(JSON.stringify(store.worldState));\n\n      try {\n        store.worldState = rawStateData as any;\n        if (isZodErrorNotified) {\n          sessionStorage.removeItem(ZOD_ERROR_NOTIFIED_KEY);\n          isZodErrorNotified = false;\n        }\n      } catch (error) {\n        console.warn('[Zod-AutoFix] Initial parsing failed. Attempting to auto-fix...', error);\n        const fixedData = cloneDeep(rawStateData);\n        if (error instanceof z.ZodError) {\n          for (const issue of error.issues) {\n            if (issue.code === 'invalid_type' && 'received' in issue && issue.received === 'undefined') {\n              let defaultValue: any = '';\n              if (issue.expected === 'number') defaultValue = 0;\n              else if (issue.expected === 'boolean') defaultValue = false;\n              else if (issue.expected === 'object') defaultValue = {};\n              else if (issue.expected === 'array') defaultValue = [];\n              set(fixedData, issue.path, defaultValue);\n            }\n          }\n          try {\n            store.worldState = fixedData as any;\n            notificationService.success('', '');\n            if (isZodErrorNotified) {\n              sessionStorage.removeItem(ZOD_ERROR_NOTIFIED_KEY);\n              isZodErrorNotified = false;\n            }\n          } catch (finalError) {\n            if (!isZodErrorNotified) {\n              const finalZodError = finalError as z.ZodError;\n              const firstIssue = finalZodError.issues[0];\n              const errorMessage = ` [${firstIssue.path.join(' -> ')}] : ${firstIssue.message}`;\n              console.error('Zod validation failed even after auto-fixing:', finalError);\n              notificationService.error('', `: ${errorMessage}`);\n              sessionStorage.setItem(ZOD_ERROR_NOTIFIED_KEY, 'true');\n              isZodErrorNotified = true;\n            }\n            store.worldState = fixedData as any;\n          }\n        } else {\n          store.worldState = rawStateData as any;\n          if (!isZodErrorNotified) {\n            console.error('Validation failed with non-Zod error:', error);\n            notificationService.error('', '');\n            sessionStorage.setItem(ZOD_ERROR_NOTIFIED_KEY, 'true');\n            isZodErrorNotified = true;\n          }\n        }\n      }\n\n      checkForChangesAndNotify(oldState, store.worldState);\n\n      const gameTextContent = fullMessageContent?.match(/<gametxt>([\\s\\S]*?)<\\/gametxt>/i)?.[1].trim();\n\n      if (gameTextContent) {\n        store.mainWorldNarrative = gameTextContent;\n      }\n\n      if (fullMessageContent && currentMessageId !== lastProcessedMessageId) {\n        lastProcessedMessageId = currentMessageId;\n        // await memoryService.updateMemory(store.diary); // FIXME: This method does not exist on MemoryService\n      }\n    }\n  } catch (error) {\n    console.error(':', error);\n  }\n}\n\nasync function loadAllData() {\n  if (!isLogHistoryLoaded) {\n    await Promise.all([\n      loadDiaryFromLorebook(),\n      loadWeeklyReviewsFromLorebook(),\n      loadDiaryFragmentsFromLorebook(),\n      loadDirectorLogsFromLorebook(),\n    ]);\n    isLogHistoryLoaded = true;\n  }\n  await fetchCoreData();\n  await lorebookService.getEntries(true);\n  store.isReady = true;\n  console.log('[Store] Core data loaded and lorebook cache refreshed.');\n}\n\nasync function processAiResponse(response: string, prefixedInput: string) {\n  if (!response) return;\n\n  const gameTextMatch = response.match(/<gametxt>([\\s\\S]+?)<\\/gametxt>/i);\n  const narrative = gameTextMatch ? gameTextMatch[1].trim() : null;\n\n  if (narrative) {\n    store.mainWorldNarrative = narrative;\n  }\n\n  const updateScriptMatch = response.match(/<UpdateVariable>([\\s\\S]+?)<\\/UpdateVariable>/i);\n  let updateScript = updateScriptMatch ? updateScriptMatch[1].trim() : null;\n\n  if (updateScript) {\n    const jsonPatchMatch = updateScript.match(/<JSONPatch>([\\s\\S]*?)<\\/JSONPatch>/i);\n    if (jsonPatchMatch && jsonPatchMatch[1]) {\n      store.lastGeneratedPatch = jsonPatchMatch[1].trim();\n      console.log('[Actions] Cached last generated patch.');\n    }\n  }\n\n  if (narrative) {\n    workflowService.cacheNarrative(narrative);\n  }\n  if (updateScript) {\n    workflowService.cacheUpdateScript(updateScript);\n  }\n\n  if (updateScript) {\n    const latestState = (await tavernService.fetchTavernData())?.[0]?.data ?? store.worldState;\n    const oldState = JSON.parse(JSON.stringify(store.worldState));\n    const newVariables = await tavernService.invokeMvuScript(updateScript, latestState);\n    if (newVariables) {\n      const sanitizedVars = sanitizeStateData(newVariables);\n      try {\n        store.worldState = sanitizedVars as any;\n        isZodErrorNotified = false;\n      } catch (error) {\n        if (!isZodErrorNotified) {\n          const zodError = error as z.ZodError;\n          const firstIssue = zodError.issues[0];\n          const errorMessage = ` [${firstIssue.path.join(' -> ')}] : ${firstIssue.message}`;\n          console.error('Zod validation failed for newVariables from MVU script:', error);\n          notificationService.error('', errorMessage);\n          isZodErrorNotified = true;\n        }\n        store.worldState = sanitizedVars as any;\n      }\n      checkForChangesAndNotify(oldState, store.worldState);\n    }\n  }\n}\n\nasync function updateLastPatchFromHistory() {\n  try {\n    const messages = await tavernService.fetchTavernData();\n    if (messages && messages.length > 0) {\n      const lastAiMessage = [...messages].reverse().find(m => !m.is_user);\n      if (!lastAiMessage) return;\n\n      const lastMessage = lastAiMessage;\n      const updateScriptMatch = lastMessage.message?.match(/<UpdateVariable>([\\s\\S]+?)<\\/UpdateVariable>/i);\n      const updateScript = updateScriptMatch ? updateScriptMatch[1].trim() : null;\n      const jsonPatchMatch = updateScript?.match(/<JSONPatch>([\\s\\S]*?)<\\/JSONPatch>/i);\n\n      if (jsonPatchMatch && jsonPatchMatch[1]) {\n        const patchContent = jsonPatchMatch[1].trim();\n        store.lastGeneratedPatch = patchContent;\n      } else {\n        store.lastGeneratedPatch = null;\n      }\n    }\n  } catch (error) {\n    console.error('Failed to silently update patch from history:', error);\n  }\n}\n\nasync function handleAction(actionText: string, isReroll = false) {\n  const saveLoadService = serviceLocator.get('saveLoadService');\n  if (!actionText.trim()) return;\n  if (!store.isReady) await loadAllData();\n\n  if (!isReroll) {\n    await saveLoadService.saveStateForReroll();\n  }\n\n  store.isGenerating = true;\n  try {\n    await updateLastPatchFromHistory();\n\n    console.log('[EvoSys] Executing Pre-Action Deduction...');\n    const pressures = worldEvolutionService.applyPressure(store.worldState);\n    const reactions = worldEvolutionService.simulateReactions(pressures, store.worldState);\n    for (const event of reactions) {\n      worldEvolutionService.propagateRipples(event, store.worldState);\n    }\n    const availableRipples = worldEvolutionService.getAvailableRipples(Date.now());\n    const currentState = workflowService.getCurrentState();\n    const intent = contextService.analyzeUserIntent(actionText, store.worldState, availableRipples);\n    const { sceneContext, worldContext } = await contextService.buildLeanContext(\n      intent,\n      actionText,\n      store.mainWorldNarrative, //  gametxt\n      store.worldState,\n      store.userId,\n      store.diaryFragments, // \n    );\n\n    console.log('[Actions] Generating AI response with modular context.');\n\n    const buildXmlTag = (tagName: string, content: any) => {\n      if (\n        !content ||\n        (Array.isArray(content) && content.length === 0) ||\n        (typeof content === 'object' && Object.keys(content).length === 0)\n      ) {\n        return '';\n      }\n      return `<${tagName}>\\n${JSON.stringify(content, null, 2)}\\n</${tagName}>\\n\\n`;\n    };\n\n    const worldContextData = worldContext as any;\n\n    const synthesisRequest = diarySynthesisService.getSynthesisRequest();\n\n    const aiInput = `<previous_patch>\n${store.lastGeneratedPatch || ''}\n</previous_patch>\n\n${buildXmlTag('', sceneContext)}\n${buildXmlTag('', worldContextData.)}\n${buildXmlTag('', worldContextData.)}\n${buildXmlTag('', worldContextData.)}\n${buildXmlTag('', worldContextData.)}\n${buildXmlTag('', worldContextData.)}\n${buildXmlTag('', { : worldContextData., : worldContextData. })}\n${synthesisRequest ? `\\n${synthesisRequest}\\n` : ''}\n<user_input>\n${actionText}\n</user_input>`;\n\n    console.log('[SUBMIT_DEBUG] Submitting to AI with combined input:', aiInput);\n\n    const rawAiResponse = await tavernService.generateAiResponse(aiInput);\n    const aiResponseString = processTags(rawAiResponse);\n    const preservedContent = workflowService.popPreservedContent();\n    const finalResponseString = aiResponseString + preservedContent;\n\n    await processAiResponse(finalResponseString, actionText);\n\n    const messages = await tavernService.fetchTavernData();\n    if (messages && messages.length > 0) {\n      const messageZero = messages[0];\n      messageZero.message = finalResponseString;\n      const newData = messageZero.data || {};\n      newData.stat_data = JSON.parse(JSON.stringify(store.worldState));\n      messageZero.data = newData;\n      await TavernHelper.setChatMessages([messageZero], { refresh: 'none' });\n    }\n\n    await saveLoadService.performAutoSave();\n\n    console.log('[EvoSys] Executing Post-Action Deduction...');\n    const actionAsPressure: EvolutionaryPressure = {\n      type: 'custom',\n      source: { type: 'npc', id: store.userId },\n      intensity: 75,\n      description: `: \"${actionText}\"`,\n      intent: actionText,\n    };\n    const actionReactions = worldEvolutionService.simulateReactions([actionAsPressure], store.worldState);\n    for (const event of actionReactions) {\n      worldEvolutionService.propagateRipples(event, store.worldState);\n    }\n  } catch (error) {\n    console.error(':', error);\n    const errorMessage = error instanceof Error ? error.message : String(error);\n    store.generationError = `AI: ${errorMessage}`;\n    notificationService.error('', 'AI');\n  } finally {\n    if (store.generationError) {\n      setTimeout(() => {\n        store.isGenerating = false;\n        store.generationError = null;\n      }, 5000);\n    } else {\n      store.isGenerating = false;\n    }\n  }\n}\n\nexport const actions = {\n  loadAllData,\n  handleAction,\n  loadFutureStorylines: async () => {\n    if (!store.worldState) {\n      return;\n    }\n    try {\n      const storylines = await storylineService.getDisplayTimeline(store.worldState);\n      store.futureStorylines = storylines as any;\n    } catch (error) {\n      console.error('Failed to load future storylines:', error);\n      notificationService.error('', '');\n    }\n  },\n  rerollLastAction: async () => {\n    const saveLoadService = serviceLocator.get('saveLoadService');\n    console.log('[Actions] Reroll requested.');\n    try {\n      notificationService.info('...', '');\n      await saveLoadService.loadRerollState();\n    } catch (error) {\n      console.error('Reroll failed:', error);\n      notificationService.error('', error instanceof Error ? error.message : '');\n    }\n  },\n};\n","/**\n * AI &#x60;<thinking>&#x60;  &#x60;<gametxt>&#x60; \n * @param text - AI\n * @returns - \n */\nexport function processTags(text: string): string {\n  let processedText = text;\n\n  // \n  //  thinking \n  processedText = processedText.replace(/<\\/?think(ing)?>/g, match => {\n    return match.startsWith('</') ? '</thinking>' : '<thinking>';\n  });\n\n  //  gametxt \n  processedText = processedText.replace(/<\\/?(game-?txt|gamet-?xt|gametxtt)>/g, match => {\n    return match.startsWith('</') ? '</gametxt>' : '<gametxt>';\n  });\n\n  // 1.  <thinking> \n  if (!processedText.includes('<thinking>')) {\n    processedText = '<thinking>\\n</thinking>\\n' + processedText;\n  }\n\n  // 2.  <thinking> \n  const thinkingOpenIndex = processedText.indexOf('<thinking>');\n  const thinkingCloseIndex = processedText.indexOf('</thinking>');\n  const gametxtOpenIndex = processedText.indexOf('<gametxt>');\n\n  if (thinkingOpenIndex !== -1 && thinkingCloseIndex === -1) {\n    if (gametxtOpenIndex !== -1 && gametxtOpenIndex > thinkingOpenIndex) {\n      //  <gametxt> \n      processedText =\n        processedText.slice(0, gametxtOpenIndex) + '</thinking>\\n' + processedText.slice(gametxtOpenIndex);\n    } else {\n      //  <gametxt>\n      processedText += '\\n</thinking>';\n    }\n  }\n\n  // 3.  <thinking>  <  > \n  const thinkingRegex = /<thinking>([\\s\\S]*?)<\\/thinking>/g;\n  processedText = processedText.replace(thinkingRegex, (match, content) => {\n    const sanitizedContent = content.replace(/<|>/g, '');\n    return `<thinking>${sanitizedContent}</thinking>`;\n  });\n\n  //  thinkingCloseIndex\n  const newThinkingCloseIndex = processedText.indexOf('</thinking>');\n\n  // 4.  <gametxt>  </thinking> \n  if (newThinkingCloseIndex !== -1 && !processedText.includes('<gametxt>')) {\n    processedText =\n      processedText.slice(0, newThinkingCloseIndex + '</thinking>'.length) +\n      '\\n<gametxt></gametxt>' +\n      processedText.slice(newThinkingCloseIndex + '</thinking>'.length);\n  }\n\n  // 5.  <gametxt> \n  const gametxtOpenIndexAgain = processedText.indexOf('<gametxt>');\n  const gametxtCloseIndex = processedText.indexOf('</gametxt>');\n\n  if (gametxtOpenIndexAgain !== -1 && gametxtCloseIndex === -1) {\n    //  < \n    const nextTagIndex = processedText.indexOf('<', gametxtOpenIndexAgain + '<gametxt>'.length);\n    if (nextTagIndex !== -1) {\n      processedText = processedText.slice(0, nextTagIndex) + '</gametxt>\\n' + processedText.slice(nextTagIndex);\n    } else {\n      // \n      processedText += '\\n</gametxt>';\n    }\n  }\n\n  return processedText;\n}\n","import { reactive, watch } from 'vue';\nimport type { AppState, , DisplayStoryStage, DirectorLog } from '../types';\n\n// ID\nexport const USER_ID = '{{user}}';\n\n//  AppState \nconst initialState: AppState = {\n  isReady: false,\n  worldState: null as  | null,\n  userId: USER_ID, // Add the user ID to the state\n  narrative: '...',\n  mainWorldNarrative: '...',\n  avatarWorldNarrative: '',\n  activeView: 'mainWorld',\n  isGenerating: false,\n  generationError: null as string | null,\n  lastSubmittedAction: null,\n  lastGeneratedPatch: null,\n  diary: [],\n  diaryFragments: [],\n  directorLogs: [] as DirectorLog[],\n  weeklyReviews: [],\n  futureStorylines: [] as DisplayStoryStage[],\n};\n\n//  reactive  store\nexport const store = reactive<AppState>({\n  ...initialState,\n});\n","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, normalizeStyle as _normalizeStyle, openBlock as _openBlock, createElementBlock as _createElementBlock, createTextVNode as _createTextVNode, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"card-header\" };\nconst _hoisted_2 = { class: \"card-type\" };\nconst _hoisted_3 = { class: \"card-level\" };\nconst _hoisted_4 = { class: \"card-content\" };\nconst _hoisted_5 = { class: \"card-name\" };\nconst _hoisted_6 = { class: \"card-face\" };\nconst _hoisted_7 = {\n    key: 1,\n    class: \"card-text-face\"\n};\nconst _hoisted_8 = { class: \"card-info\" };\nconst _hoisted_9 = { class: \"card-description\" };\nconst _hoisted_10 = { class: \"card-effect\" };\nimport { computed } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'DestinyCard',\n    props: {\n        card: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const typeColorMap = {\n            : '#4a90e2',\n            : '#50e3c2',\n            : '#b8e986',\n            : '#f5a623',\n            : '#9013fe',\n            : '#f8e71c',\n            : '#e58c00',\n            : '#d0021b',\n            : '#bd10e0',\n        };\n        const isImageUrl = computed(() => {\n            try {\n                new URL(props.card.);\n                return true;\n            }\n            catch {\n                return false;\n            }\n        });\n        const cardColor = computed(() => typeColorMap[props.card.] || '#7f8c8d');\n        const levelColorMap = {\n            F: '#6c757d',\n            E: '#6c757d',\n            D: '#33aaff',\n            C: '#33aaff',\n            B: '#9013fe',\n            A: '#d633ff',\n            S: '#ffd700',\n            SS: '#ff8c00',\n            SSS: '#ff4500',\n        };\n        const cardRarityClass = computed(() => {\n            const level = props.card.;\n            if (['S', 'SS', 'SSS'].includes(level))\n                return 'rarity-legendary';\n            if (['A', 'B'].includes(level))\n                return 'rarity-epic';\n            if (['C', 'D'].includes(level))\n                return 'rarity-rare';\n            return 'rarity-common';\n        });\n        const cardStyle = computed(() => ({\n            '--card-type-color': cardColor.value,\n            '--card-level-color': levelColorMap[props.card.] || '#6c757d',\n        }));\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n                class: _normalizeClass([\"destiny-card\", cardRarityClass.value]),\n                style: _normalizeStyle(cardStyle.value)\n            }, [\n                _cache[1] || (_cache[1] = _createElementVNode(\"div\", { class: \"card-border-glow\" }, null, -1 /* CACHED */)),\n                _createElementVNode(\"div\", _hoisted_1, [\n                    _createElementVNode(\"span\", _hoisted_2, _toDisplayString(__props.card.), 1 /* TEXT */),\n                    _createElementVNode(\"span\", _hoisted_3, \"[\" + _toDisplayString(__props.card.) + \"]\", 1 /* TEXT */)\n                ]),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    _createElementVNode(\"h3\", _hoisted_5, _toDisplayString(__props.card.), 1 /* TEXT */),\n                    _createElementVNode(\"div\", _hoisted_6, [\n                        (isImageUrl.value)\n                            ? (_openBlock(), _createElementBlock(\"div\", {\n                                key: 0,\n                                class: \"card-image\",\n                                style: _normalizeStyle({ backgroundImage: `url(${__props.card.})` })\n                            }, null, 4 /* STYLE */))\n                            : (_openBlock(), _createElementBlock(\"div\", _hoisted_7, _toDisplayString(__props.card.), 1 /* TEXT */))\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_8, [\n                        _createElementVNode(\"p\", _hoisted_9, _toDisplayString(__props.card.), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"p\", _hoisted_10, [\n                        _cache[0] || (_cache[0] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                        _createTextVNode(\" \" + _toDisplayString(__props.card.), 1 /* TEXT */)\n                    ])\n                ])\n            ], 6 /* CLASS, STYLE */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./DestinyCard.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DestinyCard.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./DestinyCard.vue?vue&type=style&index=0&id=2bc79802&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-2bc79802\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = { class: \"database-item-card\" };\nconst _hoisted_2 = { class: \"info-grid\" };\nconst _hoisted_3 = { class: \"info-item\" };\nconst _hoisted_4 = { class: \"info-item\" };\nconst _hoisted_5 = { class: \"info-item\" };\nconst _hoisted_6 = { class: \"info-item full-width\" };\nconst _hoisted_7 = {\n    key: 0,\n    class: \"info-item full-width\"\n};\nimport { computed } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'DatabaseItemCard',\n    props: {\n        item: {\n            type: Object,\n            required: true,\n        },\n    },\n    setup(__props) {\n        const props = __props;\n        const effects = computed(() => {\n            if (!props.item.effects)\n                return null;\n            const { attributes_bonus, percentage_bonus } = props.item.effects;\n            const parts = [];\n            if (attributes_bonus) {\n                for (const key in attributes_bonus) {\n                    if (key === '$meta')\n                        continue;\n                    parts.push(`${key} +${attributes_bonus[key]}`);\n                }\n            }\n            if (percentage_bonus) {\n                for (const key in percentage_bonus) {\n                    if (key === '$meta')\n                        continue;\n                    parts.push(`${key} +${percentage_bonus[key]}`);\n                }\n            }\n            return parts.join('');\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _cache[0] || (_cache[0] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.item. || ''), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_4, [\n                        _cache[1] || (_cache[1] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.item. || ''), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_5, [\n                        _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.item. ?? ''), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_6, [\n                        _cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.item. || ''), 1 /* TEXT */)\n                    ]),\n                    (effects.value)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [\n                            _cache[4] || (_cache[4] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"span\", null, _toDisplayString(effects.value), 1 /* TEXT */)\n                        ]))\n                        : _createCommentVNode(\"v-if\", true)\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./DatabaseItemCard.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DatabaseItemCard.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./DatabaseItemCard.vue?vue&type=style&index=0&id=58039cc0&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-58039cc0\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n    key: 0,\n    class: \"location-info-card\"\n};\nconst _hoisted_2 = { class: \"info-grid\" };\nconst _hoisted_3 = { class: \"info-item\" };\nconst _hoisted_4 = { class: \"info-item\" };\nconst _hoisted_5 = { class: \"info-item\" };\nconst _hoisted_6 = { class: \"info-item\" };\nconst _hoisted_7 = { class: \"info-item full-width\" };\nconst _hoisted_8 = {\n    key: 1,\n    class: \"loading-placeholder\"\n};\nimport { computed } from 'vue';\nimport { npcService } from '../../services/NpcService';\nimport { store } from '../../store';\nimport { get } from 'lodash';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'LocationInfoCard',\n    props: {\n        locationId: {\n            type: String,\n            required: true,\n        },\n    },\n    setup(__props) {\n        const props = __props;\n        const locationDetails = computed(() => {\n            if (!props.locationId || !store.worldState)\n                return null;\n            return get(store.worldState, `.${props.locationId}`);\n        });\n        const parentLocationName = computed(() => {\n            if (!locationDetails.value)\n                return '';\n            return npcService.getParentLocationName(props.locationId);\n        });\n        const cleanValue = (value) => {\n            if (typeof value !== 'string')\n                return value;\n            return value.replace(/[\"'\\[\\]]/g, '');\n        };\n        const formatArea = (area) => {\n            if (!area)\n                return '';\n            if (Array.isArray(area)) {\n                return area.join(' ');\n            }\n            const cleaned = cleanValue(String(area));\n            const parts = cleaned.split(',');\n            return parts.join(' ');\n        };\n        const formatCoordinates = (coords) => {\n            if (!coords)\n                return '';\n            try {\n                const refId = cleanValue(coords.ID);\n                const refName = npcService.getLocationName(refId);\n                const bearingString = cleanValue(coords.);\n                const bearingParts = bearingString.split(',');\n                const direction = bearingParts[0] || '';\n                const angle = bearingParts[1] || '';\n                const distanceString = cleanValue(String(coords.));\n                const distanceParts = distanceString.split(',');\n                const value = distanceParts[0] || '';\n                const unit = distanceParts[1] || '';\n                return ` ${refName} ${value}${unit} ${direction}${angle}`;\n            }\n            catch (e) {\n                console.error('Error formatting coordinates:', e);\n                return '';\n            }\n        };\n        return (_ctx, _cache) => {\n            return (locationDetails.value)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                    _createElementVNode(\"div\", _hoisted_2, [\n                        _createElementVNode(\"div\", _hoisted_3, [\n                            _cache[0] || (_cache[0] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"span\", null, _toDisplayString(cleanValue(locationDetails.value.)), 1 /* TEXT */)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_4, [\n                            _cache[1] || (_cache[1] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"span\", null, _toDisplayString(parentLocationName.value), 1 /* TEXT */)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_5, [\n                            _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"span\", null, _toDisplayString(formatArea(locationDetails.value.)), 1 /* TEXT */)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_6, [\n                            _cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"span\", null, _toDisplayString(formatCoordinates(locationDetails.value.)), 1 /* TEXT */)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_7, [\n                            _cache[4] || (_cache[4] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"span\", null, _toDisplayString(cleanValue(locationDetails.value.)), 1 /* TEXT */)\n                        ])\n                    ])\n                ]))\n                : (_openBlock(), _createElementBlock(\"div\", _hoisted_8, \"...\"));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./LocationInfoCard.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./LocationInfoCard.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./LocationInfoCard.vue?vue&type=style&index=0&id=4aea10f8&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-4aea10f8\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeStyle as _normalizeStyle, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = { class: \"attribute-grid\" };\nconst _hoisted_2 = { class: \"attribute-key\" };\nconst _hoisted_3 = { class: \"attribute-value\" };\nconst _hoisted_4 = {\n    key: 0,\n    class: \"progress-bar-container\"\n};\nconst _hoisted_5 = { class: \"progress-text\" };\nimport { computed } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'AttributeGrid',\n    props: {\n        attributes: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const  = [\n            { : 'F', : -5, : 100 },\n            { : 'E', : -3, : 200 },\n            { : 'D', : -1, : 300 },\n            { : 'C', : 0, : 400 },\n            { : 'B', : 2, : 500 },\n            { : 'A', : 5, : 600 },\n            { : 'S', : 10, : 800 },\n            { : 'SS', : 15, : 1000 },\n            { : 'SSS', : 20, : Infinity },\n        ];\n        const filteredAttributes = computed(() => {\n            if (!props.attributes)\n                return {};\n            const { $meta, ...rest } = props.attributes;\n            return rest;\n        });\n        function isAttribute(value) {\n            return typeof value === 'object' && value !== null && '' in value && '' in value;\n        }\n        function getAttributeLevelInfo(level) {\n            return .find(l => l. === level);\n        }\n        function calculateProgress(value) {\n            const levelInfo = getAttributeLevelInfo(value.);\n            if (!levelInfo || levelInfo. === Infinity)\n                return '0%';\n            const progress = (value. / levelInfo.) * 100;\n            return `${Math.min(progress, 100)}%`;\n        }\n        function formatValue(value) {\n            if (isAttribute(value)) {\n                return `${value.} (${value. >= 0 ? '+' : ''}${value.})`;\n            }\n            if (typeof value === 'object' && value !== null) {\n                if ('' in value && '' in value) {\n                    let output = `${value['']}/${value['']}`;\n                    if ('' in value) {\n                        output += ` (+${value['']})`;\n                    }\n                    return output;\n                }\n                return JSON.stringify(value); // Fallback for other objects\n            }\n            return String(value);\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(filteredAttributes.value, (value, key) => {\n                    return (_openBlock(), _createElementBlock(\"div\", {\n                        key: key,\n                        class: \"attribute-item\"\n                    }, [\n                        _createElementVNode(\"span\", _hoisted_2, _toDisplayString(key), 1 /* TEXT */),\n                        _createElementVNode(\"span\", _hoisted_3, _toDisplayString(formatValue(value)), 1 /* TEXT */),\n                        (isAttribute(value))\n                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [\n                                _createElementVNode(\"div\", {\n                                    class: \"progress-bar\",\n                                    style: _normalizeStyle({ width: calculateProgress(value) })\n                                }, null, 4 /* STYLE */),\n                                _createElementVNode(\"span\", _hoisted_5, _toDisplayString(value.) + \" / \" + _toDisplayString(getAttributeLevelInfo(value.)?.), 1 /* TEXT */)\n                            ]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]));\n                }), 128 /* KEYED_FRAGMENT */))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./AttributeGrid.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AttributeGrid.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./AttributeGrid.vue?vue&type=style&index=0&id=321a611a&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-321a611a\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createVNode as _createVNode } from \"vue\";\nconst _hoisted_1 = { class: \"detail-tab-content grid-layout\" };\nconst _hoisted_2 = { class: \"detail-item\" };\nconst _hoisted_3 = { class: \"detail-value\" };\nconst _hoisted_4 = { class: \"detail-item\" };\nconst _hoisted_5 = { class: \"detail-value\" };\nconst _hoisted_6 = { class: \"detail-item\" };\nconst _hoisted_7 = { class: \"detail-value\" };\nconst _hoisted_8 = { class: \"tag\" };\nconst _hoisted_9 = { class: \"detail-item\" };\nconst _hoisted_10 = { class: \"detail-value\" };\nconst _hoisted_11 = { class: \"detail-item\" };\nconst _hoisted_12 = { class: \"detail-value\" };\nconst _hoisted_13 = { class: \"detail-item\" };\nconst _hoisted_14 = { class: \"detail-value\" };\nconst _hoisted_15 = { class: \"detail-item evolution-level\" };\nconst _hoisted_16 = { class: \"evolution-tracks\" };\nconst _hoisted_17 = { class: \"track\" };\nconst _hoisted_18 = { class: \"track-level\" };\nconst _hoisted_19 = { class: \"track-status\" };\nconst _hoisted_20 = { class: \"track\" };\nconst _hoisted_21 = { class: \"track-level\" };\nconst _hoisted_22 = { class: \"track-status\" };\nconst _hoisted_23 = { class: \"detail-item full-width\" };\nconst _hoisted_24 = { class: \"detail-value\" };\nconst _hoisted_25 = { class: \"detail-item full-width\" };\nconst _hoisted_26 = { class: \"detail-value\" };\nconst _hoisted_27 = { class: \"history-list\" };\nconst _hoisted_28 = { class: \"influence-text\" };\nimport { computed } from 'vue';\nimport { store } from '../../../store';\nimport AttributeGrid from '../AttributeGrid.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcArchiveTab',\n    props: {\n        npc: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const physicalLevels = [\n            { lv: 0, status: '/' },\n            { lv: 1, status: '/' },\n            { lv: 2, status: '/' },\n            { lv: 3, status: '/' },\n            { lv: 4, status: '/' },\n            { lv: 5, status: '/' },\n            { lv: 6, status: '/' },\n        ];\n        const mentalLevels = [\n            { lv: 0, status: '/' },\n            { lv: 1, status: '/' },\n            { lv: 2, status: '/' },\n            { lv: 3, status: '/' },\n            { lv: 4, status: 'M' },\n            { lv: 5, status: '()' },\n        ];\n        const physicalLevelStatus = computed(() => {\n            const level = props.npc..NSFW?.phys ?? 0;\n            return physicalLevels.find(p => p.lv === level)?.status || '';\n        });\n        const mentalLevelStatus = computed(() => {\n            const level = props.npc..NSFW?.mind ?? 0;\n            return mentalLevels.find(m => m.lv === level)?.status || '';\n        });\n        const age = computed(() => {\n            if (!props.npc.?.)\n                return '';\n            const birthDate = new Date(props.npc..);\n            const worldDate = new Date(store.worldState?... || Date.now());\n            let age = worldDate.getFullYear() - birthDate.getFullYear();\n            const m = worldDate.getMonth() - birthDate.getMonth();\n            if (m < 0 || (m === 0 && worldDate.getDate() < birthDate.getDate())) {\n                age--;\n            }\n            return age;\n        });\n        const formattedBirthDate = computed(() => {\n            const bd = props.npc..;\n            if (!bd)\n                return '';\n            const date = new Date(bd);\n            return `${date.getFullYear()}${date.getMonth() + 1}${date.getDate()}`;\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _createElementVNode(\"p\", null, _toDisplayString(__props.npc.), 1 /* TEXT */)\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    _cache[1] || (_cache[1] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_5, [\n                        _createElementVNode(\"p\", null, _toDisplayString(formattedBirthDate.value) + \" (\" + _toDisplayString(age.value) + \")\", 1 /* TEXT */)\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_6, [\n                    _cache[2] || (_cache[2] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_7, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.npc., (item) => {\n                            return (_openBlock(), _createElementBlock(\"span\", _hoisted_8, _toDisplayString(item.) + \" - \" + _toDisplayString(item.), 1 /* TEXT */));\n                        }), 256 /* UNKEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_9, [\n                    _cache[3] || (_cache[3] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_10, [\n                        _createElementVNode(\"p\", null, _toDisplayString(__props.npc..), 1 /* TEXT */)\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_11, [\n                    _cache[4] || (_cache[4] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_12, [\n                        _createElementVNode(\"p\", null, _toDisplayString(__props.npc..), 1 /* TEXT */)\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_13, [\n                    _cache[5] || (_cache[5] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_14, [\n                        _createElementVNode(\"p\", null, _toDisplayString(__props.npc..) + \" (\" + _toDisplayString(__props.npc..) + \")\", 1 /* TEXT */)\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_15, [\n                    _cache[8] || (_cache[8] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_16, [\n                        _createElementVNode(\"div\", _hoisted_17, [\n                            _cache[6] || (_cache[6] = _createElementVNode(\"span\", { class: \"track-label\" }, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"span\", _hoisted_18, _toDisplayString(__props.npc..NSFW?.phys ?? 0), 1 /* TEXT */),\n                            _createElementVNode(\"span\", _hoisted_19, _toDisplayString(physicalLevelStatus.value), 1 /* TEXT */)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_20, [\n                            _cache[7] || (_cache[7] = _createElementVNode(\"span\", { class: \"track-label\" }, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"span\", _hoisted_21, _toDisplayString(__props.npc..NSFW?.mind ?? 0), 1 /* TEXT */),\n                            _createElementVNode(\"span\", _hoisted_22, _toDisplayString(mentalLevelStatus.value), 1 /* TEXT */)\n                        ])\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_23, [\n                    _cache[9] || (_cache[9] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_24, [\n                        _createVNode(AttributeGrid, {\n                            attributes: __props.npc..\n                        }, null, 8 /* PROPS */, [\"attributes\"])\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_25, [\n                    _cache[10] || (_cache[10] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \":\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_26, [\n                        _createElementVNode(\"ul\", _hoisted_27, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.npc.., (trauma, index) => {\n                                return (_openBlock(), _createElementBlock(\"li\", { key: index }, [\n                                    _createElementVNode(\"strong\", null, \": \" + _toDisplayString(trauma.), 1 /* TEXT */),\n                                    _createElementVNode(\"p\", _hoisted_28, \": \" + _toDisplayString(trauma.), 1 /* TEXT */)\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ])\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcArchiveTab.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcArchiveTab.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcArchiveTab.vue?vue&type=style&index=0&id=502908ed&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-502908ed\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createBlock as _createBlock, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = { class: \"complex-attribute\" };\nconst _hoisted_2 = { class: \"header\" };\nconst _hoisted_3 = { class: \"name\" };\nconst _hoisted_4 = { class: \"description\" };\nconst _hoisted_5 = { class: \"body\" };\nconst _hoisted_6 = { class: \"child-key\" };\nconst _hoisted_7 = { class: \"child-value\" };\nimport { computed } from 'vue';\nimport AttributeGrid from '../AttributeGrid.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ComplexAttribute',\n    props: {\n        data: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const childAttributes = computed(() => {\n            const { , , $meta, ...rest } = props.data;\n            return rest;\n        });\n        const isGridData = (value) => {\n            return typeof value === 'object' && value !== null && !Array.isArray(value);\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"h5\", _hoisted_3, _toDisplayString(__props.data.), 1 /* TEXT */),\n                    _createElementVNode(\"p\", _hoisted_4, _toDisplayString(__props.data.), 1 /* TEXT */)\n                ]),\n                _createElementVNode(\"div\", _hoisted_5, [\n                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(childAttributes.value, (value, key) => {\n                        return (_openBlock(), _createElementBlock(\"div\", {\n                            key: key,\n                            class: \"child-attribute\"\n                        }, [\n                            _createElementVNode(\"span\", _hoisted_6, _toDisplayString(key) + \":\", 1 /* TEXT */),\n                            _createElementVNode(\"div\", _hoisted_7, [\n                                (isGridData(value))\n                                    ? (_openBlock(), _createBlock(AttributeGrid, {\n                                        key: 0,\n                                        attributes: value,\n                                        style: {\n                                            display: 'grid',\n                                            'grid-template-columns': 'repeat(auto-fit, minmax(100px, 1fr))',\n                                        }\n                                    }, null, 8 /* PROPS */, [\"attributes\"]))\n                                    : (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                                        _createTextVNode(_toDisplayString(value), 1 /* TEXT */)\n                                    ], 64 /* STABLE_FRAGMENT */))\n                            ])\n                        ]));\n                    }), 128 /* KEYED_FRAGMENT */))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ComplexAttribute.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ComplexAttribute.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ComplexAttribute.vue?vue&type=style&index=0&id=5bb115c3&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-5bb115c3\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, openBlock as _openBlock, createBlock as _createBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeStyle as _normalizeStyle, createElementBlock as _createElementBlock, createVNode as _createVNode, Fragment as _Fragment, renderList as _renderList, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { key: 1 };\nconst _hoisted_2 = [\"title\"];\nconst _hoisted_3 = { class: \"value-cell\" };\nconst _hoisted_4 = {\n    key: 0,\n    class: \"progress-bar-container\"\n};\nconst _hoisted_5 = { class: \"progress-text\" };\nconst _hoisted_6 = { class: \"object-value\" };\nconst _hoisted_7 = { class: \"data-item\" };\nconst _hoisted_8 = { class: \"data-item-key\" };\nconst _hoisted_9 = { class: \"data-item-value\" };\nconst _hoisted_10 = { class: \"object-value\" };\nimport AttributeGrid from './AttributeGrid.vue';\nimport ComplexAttribute from './npc-details/ComplexAttribute.vue';\nimport ObjectRendererItem from './ObjectRendererItem.vue'; // Self-referencing\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ObjectRendererItem',\n    props: {\n        itemKey: {},\n        value: {}\n    },\n    setup(__props) {\n        const isObject = (value) => {\n            return typeof value === 'object' && value !== null && !Array.isArray(value);\n        };\n        const isAttributeGridData = (value) => {\n            if (!isObject(value))\n                return false;\n            //  ''  ''\n            if ('' in value || '' in value)\n                return false;\n            const values = Object.values(value);\n            return values.length > 1 && values.every(v => typeof v === 'string' || typeof v === 'number');\n        };\n        const isComplexAttribute = (value) => {\n            if (!isObject(value) || !('' in value && '' in value)) {\n                return false;\n            }\n            // Check if there are other properties that are objects themselves, which makes it complex\n            const otherKeys = Object.keys(value).filter(k => k !== '' && k !== '' && k !== '$meta');\n            return otherKeys.some(k => typeof value[k] === 'object');\n        };\n        const isProgressBar = (value) => {\n            return isObject(value) && 'current' in value && 'max' in value;\n        };\n        const isSimpleValue = (value) => {\n            return isObject(value) && 'value' in value && Object.keys(value).length <= 2;\n        };\n        const isDataItem = (value) => {\n            return (isObject(value) &&\n                ('ID' in value || '' in value) &&\n                !('value' in value) &&\n                !('current' in value) &&\n                Object.values(value).every(v => typeof v !== 'object'));\n        };\n        const filterMeta = (data) => {\n            if (!data)\n                return {};\n            const { $meta, ...rest } = data;\n            return rest;\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(_Fragment, null, [\n                _createCommentVNode(\" ComplexAttribute is a self-contained block, so it's rendered at the top level \"),\n                (isComplexAttribute(__props.value))\n                    ? (_openBlock(), _createBlock(ComplexAttribute, {\n                        key: 0,\n                        data: __props.value\n                    }, null, 8 /* PROPS */, [\"data\"]))\n                    : (_openBlock(), _createElementBlock(\"li\", _hoisted_1, [\n                        _createElementVNode(\"span\", {\n                            class: \"object-key\",\n                            title: __props.value?.description\n                        }, _toDisplayString(__props.itemKey) + \":\", 9 /* TEXT, PROPS */, _hoisted_2),\n                        _createElementVNode(\"div\", _hoisted_3, [\n                            _createCommentVNode(\" Case 1: Progress Bar (current/max) \"),\n                            (isProgressBar(__props.value))\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [\n                                    _createElementVNode(\"div\", {\n                                        class: \"progress-bar\",\n                                        style: _normalizeStyle({ width: `${(__props.value.current / __props.value.max) * 100}%` })\n                                    }, null, 4 /* STYLE */),\n                                    _createElementVNode(\"span\", _hoisted_5, _toDisplayString(__props.value.current) + \" / \" + _toDisplayString(__props.value.max), 1 /* TEXT */)\n                                ]))\n                                : (isAttributeGridData(__props.value))\n                                    ? (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                                        _createCommentVNode(\" Case 2: Attribute Grid \"),\n                                        _createVNode(AttributeGrid, { attributes: __props.value }, null, 8 /* PROPS */, [\"attributes\"])\n                                    ], 64 /* STABLE_FRAGMENT */))\n                                    : (isSimpleValue(__props.value))\n                                        ? (_openBlock(), _createElementBlock(_Fragment, { key: 2 }, [\n                                            _createCommentVNode(\" Case 3: Simple Value (value key) \"),\n                                            _createElementVNode(\"span\", _hoisted_6, _toDisplayString(__props.value.value), 1 /* TEXT */)\n                                        ], 64 /* STABLE_FRAGMENT */))\n                                        : (isDataItem(__props.value))\n                                            ? (_openBlock(), _createElementBlock(_Fragment, { key: 3 }, [\n                                                _createCommentVNode(\" Case 4: Data Item (ID, , ) \"),\n                                                _createElementVNode(\"div\", _hoisted_7, [\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.value, (dataValue, dataKey) => {\n                                                        return (_openBlock(), _createElementBlock(\"div\", {\n                                                            key: dataKey,\n                                                            class: \"data-item-row\"\n                                                        }, [\n                                                            _createElementVNode(\"span\", _hoisted_8, _toDisplayString(dataKey) + \":\", 1 /* TEXT */),\n                                                            _createElementVNode(\"span\", _hoisted_9, _toDisplayString(dataValue), 1 /* TEXT */)\n                                                        ]));\n                                                    }), 128 /* KEYED_FRAGMENT */))\n                                                ])\n                                            ], 64 /* STABLE_FRAGMENT */))\n                                            : (isObject(__props.value))\n                                                ? (_openBlock(), _createElementBlock(_Fragment, { key: 4 }, [\n                                                    _createCommentVNode(\" Case 5: Recursive Object \"),\n                                                    _createElementVNode(\"ul\", {\n                                                        class: _normalizeClass({ 'multi-column': Object.keys(__props.value).length > 4 })\n                                                    }, [\n                                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(filterMeta(__props.value), (subValue, subKey) => {\n                                                            return (_openBlock(), _createBlock(ObjectRendererItem, {\n                                                                key: subKey,\n                                                                \"item-key\": String(subKey),\n                                                                value: subValue\n                                                            }, null, 8 /* PROPS */, [\"item-key\", \"value\"]));\n                                                        }), 128 /* KEYED_FRAGMENT */))\n                                                    ], 2 /* CLASS */)\n                                                ], 64 /* STABLE_FRAGMENT */))\n                                                : (_openBlock(), _createElementBlock(_Fragment, { key: 5 }, [\n                                                    _createCommentVNode(\" Case 6: Primitive Value \"),\n                                                    _createElementVNode(\"span\", _hoisted_10, _toDisplayString(__props.value), 1 /* TEXT */)\n                                                ], 64 /* STABLE_FRAGMENT */))\n                        ])\n                    ]))\n            ], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ObjectRendererItem.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ObjectRendererItem.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ObjectRendererItem.vue?vue&type=style&index=0&id=02469c81&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-02469c81\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createBlock as _createBlock, normalizeClass as _normalizeClass, createElementVNode as _createElementVNode } from \"vue\";\nimport { computed } from 'vue';\nimport ObjectRendererItem from './ObjectRendererItem.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ObjectRenderer',\n    props: {\n        data: {},\n        isNested: { type: Boolean },\n        context: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const filteredData = computed(() => {\n            if (!props.data)\n                return {};\n            const { $meta, ...rest } = props.data;\n            return rest;\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n                class: _normalizeClass([\"object-renderer\", { 'is-nested': __props.isNested }])\n            }, [\n                _createElementVNode(\"ul\", {\n                    class: _normalizeClass({ 'multi-column': Object.keys(filteredData.value).length > 4 })\n                }, [\n                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(filteredData.value, (value, key) => {\n                        return (_openBlock(), _createBlock(ObjectRendererItem, {\n                            key: key,\n                            \"item-key\": String(key),\n                            value: value,\n                            context: props.context\n                        }, null, 8 /* PROPS */, [\"item-key\", \"value\", \"context\"]));\n                    }), 128 /* KEYED_FRAGMENT */))\n                ], 2 /* CLASS */)\n            ], 2 /* CLASS */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ObjectRenderer.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ObjectRenderer.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ObjectRenderer.vue?vue&type=style&index=0&id=6f2991f8&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-6f2991f8\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, normalizeClass as _normalizeClass, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = { class: \"detail-tab-content grid-layout\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"detail-item full-width\"\n};\nconst _hoisted_3 = { class: \"detail-item full-width\" };\nconst _hoisted_4 = {\n    key: 0,\n    class: \"kernel-content\"\n};\nconst _hoisted_5 = { class: \"kernel-section\" };\nconst _hoisted_6 = { class: \"kernel-text identifier\" };\nconst _hoisted_7 = { class: \"kernel-section\" };\nconst _hoisted_8 = { class: \"kernel-text\" };\nconst _hoisted_9 = { class: \"kernel-section\" };\nconst _hoisted_10 = { class: \"profile-list\" };\nconst _hoisted_11 = [\"onClick\"];\nconst _hoisted_12 = {\n    key: 0,\n    class: \"profile-details\"\n};\nconst _hoisted_13 = { class: \"profile-behavior\" };\nconst _hoisted_14 = { class: \"profile-motivation\" };\nconst _hoisted_15 = {\n    key: 0,\n    class: \"kernel-section\"\n};\nconst _hoisted_16 = { class: \"dialogue-style\" };\nconst _hoisted_17 = { key: 0 };\nconst _hoisted_18 = { key: 1 };\nconst _hoisted_19 = { class: \"tags-container\" };\nconst _hoisted_20 = {\n    key: 1,\n    class: \"placeholder\"\n};\nconst _hoisted_21 = { class: \"detail-item full-width\" };\nconst _hoisted_22 = {\n    key: 0,\n    class: \"skills-list\"\n};\nconst _hoisted_23 = [\"onClick\"];\nconst _hoisted_24 = { class: \"skill-header\" };\nconst _hoisted_25 = { class: \"skill-level\" };\nconst _hoisted_26 = {\n    key: 1,\n    class: \"placeholder\"\n};\nimport { ref, watch } from 'vue';\nimport { detailModalService } from '../../../services/DetailModalService';\nimport AttributeGrid from '../AttributeGrid.vue';\nimport ObjectRenderer from '../ObjectRenderer.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcPowerTab',\n    props: {\n        npc: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const expandedProfiles = ref({});\n        const toggleProfile = (index) => {\n            expandedProfiles.value[index] = !expandedProfiles.value[index];\n        };\n        // Reset expanded state when npc changes\n        watch(() => props.npc, () => {\n            expandedProfiles.value = {};\n        }, { immediate: true });\n        const showSkillDetail = (skill, skillName) => {\n            // Assuming a simple modal for now, this can be expanded\n            detailModalService.show(skillName, ObjectRenderer, { data: skill });\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (__props.npc.)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _cache[0] || (_cache[0] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \"\", -1 /* CACHED */)),\n                        _createVNode(AttributeGrid, {\n                            attributes: __props.npc.\n                        }, null, 8 /* PROPS */, [\"attributes\"])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                _createElementVNode(\"div\", _hoisted_3, [\n                    _cache[9] || (_cache[9] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \"\", -1 /* CACHED */)),\n                    (__props.npc.)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [\n                            _createElementVNode(\"div\", _hoisted_5, [\n                                _cache[1] || (_cache[1] = _createElementVNode(\"h5\", { class: \"kernel-title\" }, \"\", -1 /* CACHED */)),\n                                _createElementVNode(\"p\", _hoisted_6, _toDisplayString(__props.npc..), 1 /* TEXT */)\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_7, [\n                                _cache[2] || (_cache[2] = _createElementVNode(\"h5\", { class: \"kernel-title\" }, \"\", -1 /* CACHED */)),\n                                _createElementVNode(\"p\", _hoisted_8, _toDisplayString(__props.npc...), 1 /* TEXT */)\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_9, [\n                                _cache[5] || (_cache[5] = _createElementVNode(\"h5\", { class: \"kernel-title\" }, \"\", -1 /* CACHED */)),\n                                _createElementVNode(\"ul\", _hoisted_10, [\n                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.npc.., (profile, index) => {\n                                        return (_openBlock(), _createElementBlock(\"li\", {\n                                            key: index,\n                                            class: \"profile-item\"\n                                        }, [\n                                            _createElementVNode(\"strong\", {\n                                                class: \"profile-context\",\n                                                onClick: ($event) => (toggleProfile(index))\n                                            }, [\n                                                _createTextVNode(\" : \" + _toDisplayString(profile.) + \" \", 1 /* TEXT */),\n                                                _createElementVNode(\"span\", {\n                                                    class: _normalizeClass([\"toggle-icon\", { 'is-open': expandedProfiles.value[index] }])\n                                                }, \"\", 2 /* CLASS */)\n                                            ], 8 /* PROPS */, _hoisted_11),\n                                            (expandedProfiles.value[index])\n                                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_12, [\n                                                    _createElementVNode(\"p\", _hoisted_13, [\n                                                        _cache[3] || (_cache[3] = _createElementVNode(\"span\", null, \":\", -1 /* CACHED */)),\n                                                        _createTextVNode(\" \" + _toDisplayString(profile.), 1 /* TEXT */)\n                                                    ]),\n                                                    _createElementVNode(\"p\", _hoisted_14, [\n                                                        _cache[4] || (_cache[4] = _createElementVNode(\"span\", null, \":\", -1 /* CACHED */)),\n                                                        _createTextVNode(\" \" + _toDisplayString(profile.), 1 /* TEXT */)\n                                                    ])\n                                                ]))\n                                                : _createCommentVNode(\"v-if\", true)\n                                        ]));\n                                    }), 128 /* KEYED_FRAGMENT */))\n                                ])\n                            ]),\n                            (__props.npc..)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_15, [\n                                    _cache[8] || (_cache[8] = _createElementVNode(\"h5\", { class: \"kernel-title\" }, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"div\", _hoisted_16, [\n                                        (__props.npc...)\n                                            ? (_openBlock(), _createElementBlock(\"p\", _hoisted_17, [\n                                                _cache[6] || (_cache[6] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                _createTextVNode(\" \" + _toDisplayString(__props.npc...), 1 /* TEXT */)\n                                            ]))\n                                            : _createCommentVNode(\"v-if\", true),\n                                        (__props.npc...?.length)\n                                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_18, [\n                                                _cache[7] || (_cache[7] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                _createElementVNode(\"div\", _hoisted_19, [\n                                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.npc..., (phrase) => {\n                                                        return (_openBlock(), _createElementBlock(\"span\", {\n                                                            key: phrase,\n                                                            class: \"tag phrase-tag\"\n                                                        }, _toDisplayString(phrase), 1 /* TEXT */));\n                                                    }), 128 /* KEYED_FRAGMENT */))\n                                                ])\n                                            ]))\n                                            : _createCommentVNode(\"v-if\", true)\n                                    ])\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_20, \"\"))\n                ]),\n                _createElementVNode(\"div\", _hoisted_21, [\n                    _cache[10] || (_cache[10] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \"\", -1 /* CACHED */)),\n                    (__props.npc. && Object.keys(__props.npc.).length > 0)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_22, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.npc., (skill, skillName) => {\n                                return (_openBlock(), _createElementBlock(\"div\", {\n                                    key: skillName,\n                                    class: \"skill-item\",\n                                    onClick: ($event) => (showSkillDetail(skill, skillName))\n                                }, [\n                                    _createElementVNode(\"div\", _hoisted_24, [\n                                        _createElementVNode(\"h3\", null, _toDisplayString(skillName), 1 /* TEXT */),\n                                        _createElementVNode(\"div\", _hoisted_25, \" \" + _toDisplayString(skill.), 1 /* TEXT */)\n                                    ])\n                                ], 8 /* PROPS */, _hoisted_23));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_26, \"\"))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcPowerTab.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcPowerTab.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcPowerTab.vue?vue&type=style&index=0&id=0cc0afb0&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-0cc0afb0\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, normalizeStyle as _normalizeStyle } from \"vue\";\nconst _hoisted_1 = { class: \"progress-bar-container\" };\nconst _hoisted_2 = { class: \"label\" };\nconst _hoisted_3 = { class: \"progress-track\" };\nconst _hoisted_4 = {\n    key: 0,\n    class: \"center-tick\"\n};\nconst _hoisted_5 = { class: \"value\" };\nimport { computed } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ProgressBar',\n    props: {\n        label: {},\n        value: {},\n        max: {},\n        min: {},\n        color: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const displayValue = computed(() => props.value);\n        const isBidirectional = computed(() => props.min !== undefined && props.min < 0);\n        const fillStyle = computed(() => {\n            const min = props.min || 0;\n            const max = props.max || 100;\n            const value = Math.max(min, Math.min(max, props.value));\n            if (isBidirectional.value) {\n                const totalRange = max - min;\n                if (value > 0) {\n                    return {\n                        left: '50%',\n                        right: 'auto',\n                        width: `${(value / max) * 50}%`,\n                        backgroundColor: props.color,\n                    };\n                }\n                else {\n                    return {\n                        left: 'auto',\n                        right: '50%',\n                        width: `${(Math.abs(value) / Math.abs(min)) * 50}%`,\n                        backgroundColor: '#e53935', // \n                    };\n                }\n            }\n            else {\n                const percentage = max === min ? 0 : ((value - min) / (max - min)) * 100;\n                return {\n                    left: '0',\n                    right: 'auto',\n                    width: `${percentage}%`,\n                    backgroundColor: props.color,\n                };\n            }\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"span\", _hoisted_2, _toDisplayString(__props.label), 1 /* TEXT */),\n                _createElementVNode(\"div\", _hoisted_3, [\n                    (isBidirectional.value)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4))\n                        : _createCommentVNode(\"v-if\", true),\n                    _createElementVNode(\"div\", {\n                        class: \"progress-fill\",\n                        style: _normalizeStyle(fillStyle.value)\n                    }, null, 4 /* STYLE */)\n                ]),\n                _createElementVNode(\"span\", _hoisted_5, _toDisplayString(displayValue.value), 1 /* TEXT */)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ProgressBar.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ProgressBar.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ProgressBar.vue?vue&type=style&index=0&id=a2763620&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-a2763620\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, unref as _unref, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createBlock as _createBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = { class: \"relations-display\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"relation-list\"\n};\nconst _hoisted_3 = [\"onClick\"];\nconst _hoisted_4 = { class: \"relation-name\" };\nconst _hoisted_5 = { class: \"relation-tags\" };\nconst _hoisted_6 = { class: \"tag\" };\nconst _hoisted_7 = {\n    key: 0,\n    class: \"relation-details\"\n};\nconst _hoisted_8 = { class: \"group-title\" };\nconst _hoisted_9 = {\n    key: 1,\n    class: \"placeholder\"\n};\nimport { get } from 'lodash';\nimport { computed, ref } from 'vue';\nimport { npcService } from '../../services/NpcService';\nimport { store } from '../../store';\nimport ProgressBar from './ProgressBar.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'RelationsDisplay',\n    props: {\n        subjectId: {}\n    },\n    setup(__props) {\n        const vectorGroups = [\n            {\n                title: '',\n                vectors: [\n                    { label: '', path: '.', min: -100, max: 200, color: '#c74343' },\n                    { label: '', path: '.', min: -100, max: 200, color: '#3a8f9d' },\n                    { label: '', path: '.', min: -100, max: 200, color: '#d4af37' },\n                ],\n            },\n        ];\n        const props = __props;\n        const relations = computed(() => {\n            const allRelations = store.worldState?. || {};\n            const subjectRelations = {};\n            if (!props.subjectId)\n                return {};\n            //  subjectId  ()\n            const primaryRelations = allRelations[props.subjectId];\n            if (primaryRelations) {\n                for (const targetId in primaryRelations) {\n                    if (typeof primaryRelations[targetId] === 'object') {\n                        subjectRelations[targetId] = primaryRelations[targetId];\n                    }\n                }\n            }\n            return subjectRelations;\n        });\n        const { getNpcNameById } = npcService;\n        const expandedRelation = ref(null);\n        function toggleExpand(id) {\n            const relationId = String(id);\n            if (expandedRelation.value === relationId) {\n                expandedRelation.value = null;\n            }\n            else {\n                expandedRelation.value = relationId;\n            }\n        }\n        // This function is kept for potential future use, but the new structure doesn't have these tags.\n        function getFormattedTags(relation) {\n            const causeTags = get(relation, '', {});\n            return Object.values(causeTags)\n                .filter((tag) => typeof tag === 'object' && tag !== null && tag.)\n                .map((tag) => tag.);\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (Object.keys(relations.value).length > 0)\n                    ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_2, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(relations.value, (relation, id) => {\n                            return (_openBlock(), _createElementBlock(\"li\", {\n                                key: id,\n                                class: \"relation-item\"\n                            }, [\n                                _createElementVNode(\"div\", {\n                                    class: \"relation-header\",\n                                    onClick: ($event) => (toggleExpand(id))\n                                }, [\n                                    _createElementVNode(\"span\", _hoisted_4, _toDisplayString(_unref(getNpcNameById)(String(id))), 1 /* TEXT */),\n                                    _createElementVNode(\"div\", _hoisted_5, [\n                                        _createElementVNode(\"span\", _hoisted_6, _toDisplayString(relation..), 1 /* TEXT */)\n                                    ])\n                                ], 8 /* PROPS */, _hoisted_3),\n                                (expandedRelation.value === id)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [\n                                        (_openBlock(), _createElementBlock(_Fragment, null, _renderList(vectorGroups, (group) => {\n                                            return _createElementVNode(\"div\", {\n                                                key: group.title,\n                                                class: \"vector-group\"\n                                            }, [\n                                                _createElementVNode(\"strong\", _hoisted_8, _toDisplayString(group.title), 1 /* TEXT */),\n                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(group.vectors, (vector) => {\n                                                    return (_openBlock(), _createBlock(ProgressBar, {\n                                                        key: vector.label,\n                                                        label: vector.label,\n                                                        value: _unref(get)(relation, vector.path, 0),\n                                                        min: vector.min,\n                                                        max: vector.max,\n                                                        color: vector.color\n                                                    }, null, 8 /* PROPS */, [\"label\", \"value\", \"min\", \"max\", \"color\"]));\n                                                }), 128 /* KEYED_FRAGMENT */))\n                                            ]);\n                                        }), 64 /* STABLE_FRAGMENT */))\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_9, \"\"))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./RelationsDisplay.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./RelationsDisplay.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./RelationsDisplay.vue?vue&type=style&index=0&id=37746a86&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-37746a86\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = { class: \"inventory-grid\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"grid-container\"\n};\nconst _hoisted_3 = [\"onClick\"];\nconst _hoisted_4 = { class: \"item-name\" };\nconst _hoisted_5 = {\n    key: 0,\n    class: \"item-quantity\"\n};\nconst _hoisted_6 = {\n    key: 1,\n    class: \"empty-inventory\"\n};\nimport { detailModalService } from '../../services/DetailModalService';\nimport DatabaseItemCard from './DatabaseItemCard.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'InventoryGrid',\n    props: {\n        items: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const showItemDetail = (item) => {\n            if (!item)\n                return;\n            detailModalService.show(item., DatabaseItemCard, { item });\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (__props.items.length > 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.items, (item, index) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: index,\n                                class: \"item-cell\",\n                                onClick: ($event) => (showItemDetail(item))\n                            }, [\n                                _createElementVNode(\"span\", _hoisted_4, _toDisplayString(item.), 1 /* TEXT */),\n                                (item.)\n                                    ? (_openBlock(), _createElementBlock(\"span\", _hoisted_5, \"x\" + _toDisplayString(item.), 1 /* TEXT */))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ], 8 /* PROPS */, _hoisted_3));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [...(_cache[0] || (_cache[0] = [\n                            _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                        ]))]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./InventoryGrid.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./InventoryGrid.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./InventoryGrid.vue?vue&type=style&index=0&id=f5d19dc2&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-f5d19dc2\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = { class: \"detail-tab-content grid-layout\" };\nconst _hoisted_2 = { class: \"detail-item full-width\" };\nconst _hoisted_3 = { class: \"detail-item full-width\" };\nconst _hoisted_4 = { class: \"detail-item full-width\" };\nconst _hoisted_5 = {\n    key: 0,\n    class: \"memory-timeline\"\n};\nconst _hoisted_6 = [\"onClick\"];\nconst _hoisted_7 = {\n    key: 0,\n    class: \"memory-list\"\n};\nconst _hoisted_8 = { class: \"memory-header\" };\nconst _hoisted_9 = { class: \"memory-date\" };\nconst _hoisted_10 = { class: \"memory-event\" };\nconst _hoisted_11 = { class: \"memory-influence\" };\nconst _hoisted_12 = {\n    key: 1,\n    class: \"placeholder\"\n};\nimport { computed, reactive } from 'vue';\nimport { store } from '../../../store';\nimport RelationsDisplay from '../RelationsDisplay.vue';\nimport InventoryGrid from '../InventoryGrid.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcCauseTab',\n    props: {\n        npc: {},\n        npcId: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const yearExpansion = reactive({});\n        const toggleYear = (year) => {\n            yearExpansion[year] = !yearExpansion[year];\n        };\n        const inventoryItems = computed(() => {\n            // TODO: \n            const database = store.worldState?. || {};\n            if (!props.npc || !props.npc.)\n                return [];\n            const backpack = props.npc.;\n            const items = [];\n            for (const itemId in backpack) {\n                const quantity = backpack[itemId]?. || 0;\n                if (quantity <= 0)\n                    continue;\n                let itemDetails = null;\n                for (const category in database) {\n                    const categoryStore = database[category];\n                    if (categoryStore && categoryStore[itemId]) {\n                        itemDetails = categoryStore[itemId];\n                        break;\n                    }\n                }\n                if (itemDetails) {\n                    items.push({\n                        ...itemDetails,\n                        ID: itemId,\n                        : quantity,\n                    });\n                }\n            }\n            return items;\n        });\n        const groupedMemories = computed(() => {\n            if (!props.npc.)\n                return {};\n            const sorted = [...props.npc.].sort((a, b) => new Date(b.).getTime() - new Date(a.).getTime());\n            return sorted.reduce((acc, memory) => {\n                const year = new Date(memory.).getFullYear();\n                if (!acc[year]) {\n                    acc[year] = [];\n                }\n                acc[year].push(memory);\n                return acc;\n            }, {});\n        });\n        // Initially expand the most recent year\n        Object.keys(groupedMemories.value).forEach((year, index) => {\n            yearExpansion[year] = index === 0;\n        });\n        function getEmotionClass(emotion) {\n            switch (emotion) {\n                case '':\n                    return 'emotion-tag-anger';\n                case '':\n                    return 'emotion-tag-sadness';\n                case '':\n                    return 'emotion-tag-fear';\n                case '':\n                    return 'emotion-tag-humiliation';\n                case '':\n                    return 'emotion-tag-satisfaction';\n                case '':\n                    return 'emotion-tag-joy';\n                default:\n                    return '';\n            }\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \"\", -1 /* CACHED */)),\n                    _createVNode(InventoryGrid, { items: inventoryItems.value }, null, 8 /* PROPS */, [\"items\"])\n                ]),\n                _createElementVNode(\"div\", _hoisted_3, [\n                    _cache[1] || (_cache[1] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \"\", -1 /* CACHED */)),\n                    (__props.npcId)\n                        ? (_openBlock(), _createBlock(RelationsDisplay, {\n                            key: 0,\n                            \"subject-id\": __props.npcId\n                        }, null, 8 /* PROPS */, [\"subject-id\"]))\n                        : _createCommentVNode(\"v-if\", true)\n                ]),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    _cache[3] || (_cache[3] = _createElementVNode(\"strong\", { class: \"detail-key\" }, \"\", -1 /* CACHED */)),\n                    (Object.keys(groupedMemories.value).length > 0)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(groupedMemories.value, (memories, year) => {\n                                return (_openBlock(), _createElementBlock(\"div\", {\n                                    key: year,\n                                    class: \"year-group\"\n                                }, [\n                                    _createElementVNode(\"h5\", {\n                                        onClick: ($event) => (toggleYear(year)),\n                                        class: _normalizeClass({ collapsed: !yearExpansion[year] })\n                                    }, _toDisplayString(year) + \"\", 11 /* TEXT, CLASS, PROPS */, _hoisted_6),\n                                    (yearExpansion[year])\n                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [\n                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(memories, (memory, index) => {\n                                                return (_openBlock(), _createElementBlock(\"div\", {\n                                                    key: index,\n                                                    class: \"memory-item\"\n                                                }, [\n                                                    _createElementVNode(\"div\", _hoisted_8, [\n                                                        _createElementVNode(\"span\", _hoisted_9, _toDisplayString(new Date(memory.).toLocaleDateString()), 1 /* TEXT */)\n                                                    ]),\n                                                    _createElementVNode(\"p\", _hoisted_10, [\n                                                        _createElementVNode(\"span\", {\n                                                            class: _normalizeClass(['tag', getEmotionClass(memory.)])\n                                                        }, _toDisplayString(memory.), 3 /* TEXT, CLASS */),\n                                                        _createTextVNode(\" \" + _toDisplayString(memory.), 1 /* TEXT */)\n                                                    ]),\n                                                    _createElementVNode(\"p\", _hoisted_11, [\n                                                        _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                        _createTextVNode(\" \" + _toDisplayString(memory.), 1 /* TEXT */)\n                                                    ])\n                                                ]));\n                                            }), 128 /* KEYED_FRAGMENT */))\n                                        ]))\n                                        : _createCommentVNode(\"v-if\", true)\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_12, \"\"))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcCauseTab.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcCauseTab.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcCauseTab.vue?vue&type=style&index=0&id=1c024944&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1c024944\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createElementVNode as _createElementVNode, createBlock as _createBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = { class: \"npc-detail-display\" };\nconst _hoisted_2 = { class: \"tabs\" };\nconst _hoisted_3 = [\"onClick\"];\nconst _hoisted_4 = { class: \"tab-content\" };\nconst _hoisted_5 = {\n    key: 1,\n    class: \"placeholder\"\n};\nimport { ref } from 'vue';\nimport NpcArchiveTab from './npc-details/NpcArchiveTab.vue';\nimport NpcPowerTab from './npc-details/NpcPowerTab.vue';\nimport NpcCauseTab from './npc-details/NpcCauseTab.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcDetailDisplay',\n    props: {\n        npc: {},\n        npcId: {}\n    },\n    setup(__props) {\n        const activeTab = ref('archive');\n        const tabs = [\n            { id: 'archive', name: '' },\n            { id: 'power', name: '' },\n            { id: 'cause', name: '' },\n        ];\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    (_openBlock(), _createElementBlock(_Fragment, null, _renderList(tabs, (tab) => {\n                        return _createElementVNode(\"button\", {\n                            key: tab.id,\n                            class: _normalizeClass({ active: activeTab.value === tab.id }),\n                            onClick: ($event) => (activeTab.value = tab.id)\n                        }, _toDisplayString(tab.name), 11 /* TEXT, CLASS, PROPS */, _hoisted_3);\n                    }), 64 /* STABLE_FRAGMENT */))\n                ]),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    (__props.npc)\n                        ? (_openBlock(), _createElementBlock(_Fragment, { key: 0 }, [\n                            (activeTab.value === 'archive')\n                                ? (_openBlock(), _createBlock(NpcArchiveTab, {\n                                    key: 0,\n                                    npc: __props.npc\n                                }, null, 8 /* PROPS */, [\"npc\"]))\n                                : _createCommentVNode(\"v-if\", true),\n                            (activeTab.value === 'power')\n                                ? (_openBlock(), _createBlock(NpcPowerTab, {\n                                    key: 1,\n                                    npc: __props.npc\n                                }, null, 8 /* PROPS */, [\"npc\"]))\n                                : _createCommentVNode(\"v-if\", true),\n                            (activeTab.value === 'cause')\n                                ? (_openBlock(), _createBlock(NpcCauseTab, {\n                                    key: 2,\n                                    npc: __props.npc,\n                                    \"npc-id\": __props.npcId\n                                }, null, 8 /* PROPS */, [\"npc\", \"npc-id\"]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ], 64 /* STABLE_FRAGMENT */))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [...(_cache[0] || (_cache[0] = [\n                                _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                            ]))]))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcDetailDisplay.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcDetailDisplay.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcDetailDisplay.vue?vue&type=style&index=0&id=3d67675a&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3d67675a\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, unref as _unref, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"debug-panel\" };\nconst _hoisted_2 = { class: \"section\" };\nconst _hoisted_3 = { class: \"story-stats\" };\nconst _hoisted_4 = { class: \"section\" };\nconst _hoisted_5 = { class: \"section\" };\nconst _hoisted_6 = { class: \"section\" };\nconst _hoisted_7 = { class: \"section\" };\nconst _hoisted_8 = { class: \"section\" };\nconst _hoisted_9 = { class: \"section\" };\nconst _hoisted_10 = { class: \"section\" };\nconst _hoisted_11 = { class: \"section\" };\nconst _hoisted_12 = { class: \"section\" };\nimport { get } from 'lodash';\nimport * as toastr from 'toastr';\nimport { computed, onMounted } from 'vue';\nimport { debugService } from '../../services/DebugService';\nimport { lorebookService } from '../../services/LorebookService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'DebugPanel',\n    setup(__props) {\n        const debugState = debugService.state;\n        onMounted(() => {\n            debugService.refreshData();\n        });\n        const formattedJson = (data) => {\n            if (data === null)\n                return 'N/A';\n            try {\n                return JSON.stringify(data, null, 2);\n            }\n            catch {\n                return '';\n            }\n        };\n        const formattedLastContext = computed(() => formattedJson(debugState.lastContext));\n        const formattedMainStory = computed(() => formattedJson(debugState.mainStoryContent));\n        const formattedCalendarFixed = computed(() => formattedJson(debugState.calendarFixedContent));\n        const formattedCalendarRandom = computed(() => formattedJson(debugState.calendarRandomContent));\n        const formattedCalendarCrossover = computed(() => formattedJson(debugState.calendarCrossoverContent));\n        const formattedStyleGuide = computed(() => formattedJson(debugState.styleGuideContent));\n        const potentialStory = computed(() => get(debugState.lastContext, '.', {}));\n        const upcomingEvents = computed(() => get(debugState.lastContext, '..', []));\n        const recentEvents = computed(() => get(debugState.lastContext, '.', []));\n        const potentialStoryCount = computed(() => potentialStory.value && Object.keys(potentialStory.value).length > 0 ? 1 : 0);\n        const upcomingEventsCount = computed(() => upcomingEvents.value.length);\n        const recentEventsCount = computed(() => recentEvents.value.length);\n        const formattedPotentialStory = computed(() => formattedJson(potentialStory.value));\n        const formattedUpcomingEvents = computed(() => formattedJson(upcomingEvents.value));\n        const formattedRecentEvents = computed(() => formattedJson(recentEvents.value));\n        const statusClass = (status) => {\n            if (status.includes(''))\n                return 'status-success';\n            if (status.includes(''))\n                return 'status-error';\n            return '';\n        };\n        const clearAllMemoryLogs = async () => {\n            if (confirm('')) {\n                try {\n                    await lorebookService.writeToLorebook('[]', '');\n                    await lorebookService.writeToLorebook('[]', '');\n                    await lorebookService.writeToLorebook('[]', '');\n                    await lorebookService.writeToLorebook('', '');\n                    await lorebookService.writeToLorebook('', '');\n                    await lorebookService.writeToLorebook('-', '');\n                    await lorebookService.writeToLorebook('-', '');\n                    await lorebookService.writeToLorebook('', '');\n                    await lorebookService.writeToLorebook('', '');\n                    toastr.success('');\n                }\n                catch (error) {\n                    console.error(':', error);\n                    toastr.error('');\n                }\n            }\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _cache[13] || (_cache[13] = _createElementVNode(\"h2\", null, \"\", -1 /* CACHED */)),\n                _createElementVNode(\"div\", { class: \"section danger-zone\" }, [\n                    _createElementVNode(\"button\", {\n                        onClick: clearAllMemoryLogs,\n                        class: \"button is-warning\"\n                    }, \"\")\n                ]),\n                _createElementVNode(\"button\", {\n                    onClick: _cache[0] || (_cache[0] = ($event) => (_unref(debugService).refreshData()))\n                }, \"\"),\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[6] || (_cache[6] = _createElementVNode(\"h3\", null, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"p\", null, [\n                        _cache[1] || (_cache[1] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", {\n                            class: _normalizeClass(statusClass(_unref(debugState).mainStoryStatus))\n                        }, _toDisplayString(_unref(debugState).mainStoryStatus), 3 /* TEXT, CLASS */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _createElementVNode(\"p\", null, \" : \" + _toDisplayString(_unref(debugState).mainStoryStats.filesLoaded) + \" | : \" + _toDisplayString(_unref(debugState).mainStoryStats.totalEvents) + \" | : \" + _toDisplayString(_unref(debugState).mainStoryStats.actionableEvents) + \" | : \" + _toDisplayString(_unref(debugState).mainStoryStats.foreshadowedEvents), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"p\", null, [\n                        _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \"-:\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", {\n                            class: _normalizeClass(statusClass(_unref(debugState).calendarFixedStatus))\n                        }, _toDisplayString(_unref(debugState).calendarFixedStatus), 3 /* TEXT, CLASS */)\n                    ]),\n                    _createElementVNode(\"p\", null, [\n                        _cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \"-:\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", {\n                            class: _normalizeClass(statusClass(_unref(debugState).calendarRandomStatus))\n                        }, _toDisplayString(_unref(debugState).calendarRandomStatus), 3 /* TEXT, CLASS */)\n                    ]),\n                    _createElementVNode(\"p\", null, [\n                        _cache[4] || (_cache[4] = _createElementVNode(\"strong\", null, \"-:\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", {\n                            class: _normalizeClass(statusClass(_unref(debugState).calendarCrossoverStatus))\n                        }, _toDisplayString(_unref(debugState).calendarCrossoverStatus), 3 /* TEXT, CLASS */)\n                    ]),\n                    _createElementVNode(\"p\", null, [\n                        _cache[5] || (_cache[5] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", {\n                            class: _normalizeClass(statusClass(_unref(debugState).styleGuideStatus))\n                        }, _toDisplayString(_unref(debugState).styleGuideStatus), 3 /* TEXT, CLASS */)\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    _cache[7] || (_cache[7] = _createElementVNode(\"h3\", null, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"pre\", null, _toDisplayString(formattedLastContext.value), 1 /* TEXT */)\n                ]),\n                _createElementVNode(\"div\", _hoisted_5, [\n                    _createElementVNode(\"h3\", null, \" (\" + _toDisplayString(potentialStoryCount.value) + \")\", 1 /* TEXT */),\n                    _createElementVNode(\"pre\", null, _toDisplayString(formattedPotentialStory.value), 1 /* TEXT */)\n                ]),\n                _createElementVNode(\"div\", _hoisted_6, [\n                    _createElementVNode(\"h3\", null, \" (\" + _toDisplayString(upcomingEventsCount.value) + \")\", 1 /* TEXT */),\n                    _createElementVNode(\"pre\", null, _toDisplayString(formattedUpcomingEvents.value), 1 /* TEXT */)\n                ]),\n                _createElementVNode(\"div\", _hoisted_7, [\n                    _createElementVNode(\"h3\", null, \" (\" + _toDisplayString(recentEventsCount.value) + \")\", 1 /* TEXT */),\n                    _createElementVNode(\"pre\", null, _toDisplayString(formattedRecentEvents.value), 1 /* TEXT */)\n                ]),\n                _createElementVNode(\"div\", _hoisted_8, [\n                    _cache[8] || (_cache[8] = _createElementVNode(\"h3\", null, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"pre\", null, _toDisplayString(formattedMainStory.value), 1 /* TEXT */)\n                ]),\n                _createElementVNode(\"div\", _hoisted_9, [\n                    _cache[9] || (_cache[9] = _createElementVNode(\"h3\", null, \"-\", -1 /* CACHED */)),\n                    _createElementVNode(\"pre\", null, _toDisplayString(formattedCalendarFixed.value), 1 /* TEXT */)\n                ]),\n                _createElementVNode(\"div\", _hoisted_10, [\n                    _cache[10] || (_cache[10] = _createElementVNode(\"h3\", null, \"-\", -1 /* CACHED */)),\n                    _createElementVNode(\"pre\", null, _toDisplayString(formattedCalendarRandom.value), 1 /* TEXT */)\n                ]),\n                _createElementVNode(\"div\", _hoisted_11, [\n                    _cache[11] || (_cache[11] = _createElementVNode(\"h3\", null, \"-\", -1 /* CACHED */)),\n                    _createElementVNode(\"pre\", null, _toDisplayString(formattedCalendarCrossover.value), 1 /* TEXT */)\n                ]),\n                _createElementVNode(\"div\", _hoisted_12, [\n                    _cache[12] || (_cache[12] = _createElementVNode(\"h3\", null, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"pre\", null, _toDisplayString(formattedStyleGuide.value), 1 /* TEXT */)\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./DebugPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DebugPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./DebugPanel.vue?vue&type=style&index=0&id=1f4f8a7d&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1f4f8a7d\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, openBlock as _openBlock, createBlock as _createBlock, createElementBlock as _createElementBlock, unref as _unref, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"destiny-card-panel-layout\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"card-display-section-mobile\"\n};\nconst _hoisted_3 = { class: \"list-view-container\" };\nconst _hoisted_4 = { class: \"card-list-section\" };\nconst _hoisted_5 = { class: \"card-list\" };\nconst _hoisted_6 = [\"onClick\"];\nconst _hoisted_7 = { class: \"card-list-name\" };\nconst _hoisted_8 = { class: \"card-list-level\" };\nconst _hoisted_9 = {\n    key: 0,\n    class: \"empty-list\"\n};\nconst _hoisted_10 = { class: \"card-display-section-desktop\" };\nconst _hoisted_11 = {\n    key: 1,\n    class: \"placeholder\"\n};\nimport { ref, watch } from 'vue';\nimport DestinyCard from '../../cards/DestinyCard.vue';\nimport { destinyCardService } from '../../../services/DestinyCardService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'CardBackpackTab',\n    setup(__props) {\n        const selectedCard = ref(null);\n        const showDetailView = ref(false);\n        const backpackCards = destinyCardService.playerBackpackCards;\n        const selectCard = (card) => {\n            selectedCard.value = card;\n            showDetailView.value = true;\n        };\n        watch(backpackCards, newVal => {\n            if (!selectedCard.value || !newVal.find(c => c.ID === selectedCard.value?.ID)) {\n                selectedCard.value = newVal[0] || null;\n            }\n        }, { immediate: true });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createCommentVNode(\" Mobile Detail View \"),\n                (showDetailView.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _createElementVNode(\"button\", {\n                            class: \"back-to-list-btn\",\n                            onClick: _cache[0] || (_cache[0] = ($event) => (showDetailView.value = false))\n                        }, \"< \"),\n                        (selectedCard.value)\n                            ? (_openBlock(), _createBlock(DestinyCard, {\n                                key: 0,\n                                card: selectedCard.value\n                            }, null, 8 /* PROPS */, [\"card\"]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]))\n                    : (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                        _createCommentVNode(\" List View (Default on mobile, always visible on desktop) \"),\n                        _createElementVNode(\"div\", _hoisted_3, [\n                            _createElementVNode(\"div\", _hoisted_4, [\n                                _createElementVNode(\"ul\", _hoisted_5, [\n                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(backpackCards), (card) => {\n                                        return (_openBlock(), _createElementBlock(\"li\", {\n                                            key: card.ID,\n                                            onClick: ($event) => (selectCard(card)),\n                                            class: _normalizeClass({ active: selectedCard.value?.ID === card.ID })\n                                        }, [\n                                            _createElementVNode(\"span\", _hoisted_7, _toDisplayString(card.), 1 /* TEXT */),\n                                            _createElementVNode(\"span\", _hoisted_8, \"[\" + _toDisplayString(card.) + \"]\", 1 /* TEXT */)\n                                        ], 10 /* CLASS, PROPS */, _hoisted_6));\n                                    }), 128 /* KEYED_FRAGMENT */)),\n                                    (_unref(backpackCards).length === 0)\n                                        ? (_openBlock(), _createElementBlock(\"li\", _hoisted_9, \"\"))\n                                        : _createCommentVNode(\"v-if\", true)\n                                ])\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_10, [\n                                (selectedCard.value)\n                                    ? (_openBlock(), _createBlock(DestinyCard, {\n                                        key: 0,\n                                        card: selectedCard.value\n                                    }, null, 8 /* PROPS */, [\"card\"]))\n                                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_11, \"\"))\n                            ])\n                        ])\n                    ], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./CardBackpackTab.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CardBackpackTab.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./CardBackpackTab.vue?vue&type=style&index=0&id=ed5d0826&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-ed5d0826\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createVNode as _createVNode, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"destiny-card-panel\" };\nconst _hoisted_2 = { class: \"tab-content\" };\nimport CardBackpackTab from './destiny/CardBackpackTab.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'DestinyCardPanel',\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createVNode(CardBackpackTab)\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./DestinyCardPanel.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./DestinyCardPanel.vue?vue&type=script&lang=ts&setup=true\"\n\nimport \"./DestinyCardPanel.vue?vue&type=style&index=0&id=5dc88b4c&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-5dc88b4c\"]])\n\nexport default __exports__","import { lorebookService } from './LorebookService';\nimport type { DiaryEntry } from '../types';\n\nclass DiaryService {\n  private parseSingleDiaryEntry(block: string): DiaryEntry | null {\n    try {\n      const lines = block\n        .trim()\n        .split('\\n')\n        .map(l => l.trim());\n      if (lines.length < 2) return null;\n\n      const entry: DiaryEntry = {\n        : '',\n        : '',\n        : '',\n        : '',\n        : [],\n        : [],\n        : [],\n      };\n\n      let bodyStartIndex = 0;\n\n      // Flexible Header Parsing\n      for (let i = 0; i < lines.length; i++) {\n        const line = lines[i];\n        if (line.includes('|')) entry. = line.split('|')[1]?.trim() || '';\n        if (line.includes('|')) entry. = line.split('|')[1]?.trim() || '';\n        if (line.includes('|')) entry. = line.split('|')[1]?.trim() || '';\n\n        if (line === '---') {\n          bodyStartIndex = i + 1;\n          break;\n        }\n      }\n\n      if (!entry.) {\n        // Fallback if format is slightly different\n        const dateMatch = block.match(/\\|(.+)/);\n        if (dateMatch) entry. = dateMatch[1].trim();\n      }\n      if (!entry.) {\n        const titleMatch = block.match(/\\|(.+)/);\n        if (titleMatch) entry. = titleMatch[1].trim();\n      }\n      if (!entry.) {\n        const weatherMatch = block.match(/\\|(.+)/);\n        if (weatherMatch) entry. = weatherMatch[1].trim();\n      }\n\n      if (!entry. || !entry.) return null;\n\n      let currentSection: '' | '' | '' | '' | null = null;\n\n      for (let i = bodyStartIndex; i < lines.length; i++) {\n        const line = lines[i].trim();\n        if (!line) continue;\n\n        if (line.startsWith('')) {\n          if (line.includes('')) currentSection = '';\n          else if (line.includes('')) currentSection = '';\n          else if (line.includes('')) currentSection = '';\n          else if (line.includes('')) currentSection = '';\n          else currentSection = null;\n          continue;\n        }\n\n        switch (currentSection) {\n          case '':\n            entry. += (entry. ? '\\n' : '') + line;\n            break;\n          case '': {\n            if (line.startsWith('- :')) {\n              entry..push({ : line.replace('- :', '').trim(), : '', : '', : '' });\n            } else if (entry..length > 0) {\n              const lastEvent = entry.[entry..length - 1];\n              if (line.startsWith(':')) lastEvent. = line.replace(':', '').trim();\n              else if (line.startsWith(':')) lastEvent. = line.replace(':', '').trim();\n              else if (line.startsWith(':')) lastEvent. = line.replace(':', '').trim();\n            }\n            break;\n          }\n          case '': {\n            if (line.startsWith('- :')) {\n              entry..push({ : line.replace('- :', '').trim(), : '', : '' });\n            } else if (entry..length > 0) {\n              const lastRelation = entry.[entry..length - 1];\n              if (line.startsWith(':')) lastRelation. = line.replace(':', '').trim();\n              else if (line.startsWith(':')) lastRelation. = line.replace(':', '').trim();\n            }\n            break;\n          }\n          case '':\n            if (line.startsWith('- ')) {\n              entry..push(line.replace('- ', '').trim());\n            }\n            break;\n        }\n      }\n      return entry;\n    } catch (e) {\n      console.error('Error parsing single diary entry:', e, block);\n      return null;\n    }\n  }\n\n  private parseDiaryText(text: string): DiaryEntry[] {\n    const entries: DiaryEntry[] = [];\n    // A more robust way to split entries. Find '---' then check if the next non-empty line starts with '|'\n    const potentialBlocks = text.split('---');\n    let currentBlock = '';\n\n    for (const block of potentialBlocks) {\n      if (block.trim().startsWith('|')) {\n        if (currentBlock) {\n          const entry = this.parseSingleDiaryEntry(currentBlock);\n          if (entry) entries.push(entry);\n        }\n        currentBlock = block;\n      } else {\n        currentBlock += '---' + block;\n      }\n    }\n    // last block\n    if (currentBlock) {\n      const entry = this.parseSingleDiaryEntry(currentBlock);\n      if (entry) entries.push(entry);\n    }\n\n    return entries;\n  }\n\n  async getDiaryEntries(): Promise<DiaryEntry[]> {\n    const diaryContent = await lorebookService.readFromLorebook('', true);\n    if (!diaryContent) {\n      console.warn(\"Lorebook entry '' is empty or not found.\");\n      return [];\n    }\n    return this.parseDiaryText(diaryContent);\n  }\n}\n\nexport const diaryService = new DiaryService();\n","import { defineComponent as _defineComponent } from 'vue';\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, Transition as _Transition, withCtx as _withCtx, createVNode as _createVNode, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = { class: \"diary-app-container\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"side-nav\"\n};\nconst _hoisted_3 = [\"onClick\"];\nconst _hoisted_4 = { class: \"app-content\" };\nconst _hoisted_5 = { key: 0 };\nconst _hoisted_6 = { class: \"diary-header\" };\nconst _hoisted_7 = { class: \"date-weather\" };\nconst _hoisted_8 = { class: \"title\" };\nconst _hoisted_9 = { class: \"diary-section\" };\nconst _hoisted_10 = { class: \"diary-section collapsible\" };\nconst _hoisted_11 = {\n    key: 0,\n    class: \"collapsible-content\"\n};\nconst _hoisted_12 = { class: \"t\" };\nconst _hoisted_13 = { class: \"diary-section collapsible\" };\nconst _hoisted_14 = {\n    key: 0,\n    class: \"collapsible-content\"\n};\nconst _hoisted_15 = { class: \"diary-section collapsible\" };\nconst _hoisted_16 = {\n    key: 0,\n    class: \"collapsible-content\"\n};\nconst _hoisted_17 = {\n    key: 1,\n    class: \"empty-state\"\n};\nimport { ref, reactive, onMounted, watch } from 'vue';\nimport { diaryService } from '../../services/diaryService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'DiaryPanel',\n    props: {\n        isDiaryNavOpen: Boolean,\n    },\n    emits: ['close-diary-nav'],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emit = __emit;\n        const isNavOpen = ref(props.isDiaryNavOpen);\n        watch(() => props.isDiaryNavOpen, newVal => {\n            isNavOpen.value = newVal;\n        });\n        const diaryList = ref([]);\n        const selectedDiary = ref(null);\n        const sectionsOpen = reactive({\n            events: false,\n            relations: false,\n            memos: false,\n        });\n        const toggleSection = (section) => {\n            sectionsOpen[section] = !sectionsOpen[section];\n        };\n        const selectDiary = (diary) => {\n            selectedDiary.value = diary;\n            // isNavOpen.value = false; // Now controlled by parent\n            emit('close-diary-nav');\n        };\n        onMounted(async () => {\n            try {\n                const entries = await diaryService.getDiaryEntries();\n                diaryList.value = entries;\n                if (entries.length > 0) {\n                    selectedDiary.value = entries[0];\n                }\n            }\n            catch (error) {\n                console.error('Failed to load diary entries:', error);\n            }\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createVNode(_Transition, { name: \"slide-fade\" }, {\n                    default: _withCtx(() => [\n                        (isNavOpen.value)\n                            ? (_openBlock(), _createElementBlock(\"div\", {\n                                key: 0,\n                                class: \"side-nav-overlay\",\n                                onClick: _cache[0] || (_cache[0] = ($event) => (emit('close-diary-nav')))\n                            }))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]),\n                    _: 1 /* STABLE */\n                }),\n                _createVNode(_Transition, { name: \"slide\" }, {\n                    default: _withCtx(() => [\n                        (isNavOpen.value)\n                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                                _cache[4] || (_cache[4] = _createElementVNode(\"h3\", null, \"\", -1 /* CACHED */)),\n                                _createElementVNode(\"ul\", null, [\n                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(diaryList.value, (entry) => {\n                                        return (_openBlock(), _createElementBlock(\"li\", {\n                                            key: entry.,\n                                            class: _normalizeClass({ active: selectedDiary.value && selectedDiary.value. === entry. }),\n                                            onClick: ($event) => (selectDiary(entry))\n                                        }, _toDisplayString(entry.) + \" - \" + _toDisplayString(entry.), 11 /* TEXT, CLASS, PROPS */, _hoisted_3));\n                                    }), 128 /* KEYED_FRAGMENT */))\n                                ])\n                            ]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]),\n                    _: 1 /* STABLE */\n                }),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    (selectedDiary.value)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n                            _createElementVNode(\"div\", _hoisted_6, [\n                                _createElementVNode(\"div\", _hoisted_7, [\n                                    _createElementVNode(\"span\", null, _toDisplayString(selectedDiary.value.), 1 /* TEXT */),\n                                    _createElementVNode(\"span\", null, \": \" + _toDisplayString(selectedDiary.value.), 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"h1\", _hoisted_8, _toDisplayString(selectedDiary.value.), 1 /* TEXT */)\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_9, [\n                                _cache[5] || (_cache[5] = _createElementVNode(\"h2\", null, \"\", -1 /* CACHED */)),\n                                _createElementVNode(\"p\", null, _toDisplayString(selectedDiary.value.), 1 /* TEXT */)\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_10, [\n                                _createElementVNode(\"h2\", {\n                                    onClick: _cache[1] || (_cache[1] = ($event) => (toggleSection('events')))\n                                }, [\n                                    _cache[6] || (_cache[6] = _createTextVNode(\"  \", -1 /* CACHED */)),\n                                    _createElementVNode(\"span\", {\n                                        class: _normalizeClass([\"arrow\", { open: sectionsOpen.events }])\n                                    }, \"\", 2 /* CLASS */)\n                                ]),\n                                (sectionsOpen.events)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [\n                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(selectedDiary.value., (event, index) => {\n                                            return (_openBlock(), _createElementBlock(\"div\", {\n                                                key: index,\n                                                class: \"event-item\"\n                                            }, [\n                                                _createElementVNode(\"p\", null, [\n                                                    _cache[7] || (_cache[7] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                    _createTextVNode(\" \" + _toDisplayString(event.), 1 /* TEXT */)\n                                                ]),\n                                                _createElementVNode(\"p\", null, [\n                                                    _cache[8] || (_cache[8] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                    _createTextVNode(\" \" + _toDisplayString(event.), 1 /* TEXT */)\n                                                ]),\n                                                _createElementVNode(\"p\", null, [\n                                                    _cache[9] || (_cache[9] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                    _createTextVNode(\" \" + _toDisplayString(event.), 1 /* TEXT */)\n                                                ]),\n                                                _createElementVNode(\"p\", _hoisted_12, [\n                                                    _cache[10] || (_cache[10] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                    _createTextVNode(\" \" + _toDisplayString(event.), 1 /* TEXT */)\n                                                ])\n                                            ]));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_13, [\n                                _createElementVNode(\"h2\", {\n                                    onClick: _cache[2] || (_cache[2] = ($event) => (toggleSection('relations')))\n                                }, [\n                                    _cache[11] || (_cache[11] = _createTextVNode(\"  \", -1 /* CACHED */)),\n                                    _createElementVNode(\"span\", {\n                                        class: _normalizeClass([\"arrow\", { open: sectionsOpen.relations }])\n                                    }, \"\", 2 /* CLASS */)\n                                ]),\n                                (sectionsOpen.relations)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_14, [\n                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(selectedDiary.value., (relation, index) => {\n                                            return (_openBlock(), _createElementBlock(\"div\", {\n                                                key: index,\n                                                class: \"relation-item\"\n                                            }, [\n                                                _createElementVNode(\"p\", null, [\n                                                    _cache[12] || (_cache[12] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                    _createTextVNode(\" \" + _toDisplayString(relation.), 1 /* TEXT */)\n                                                ]),\n                                                _createElementVNode(\"p\", null, [\n                                                    _cache[13] || (_cache[13] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                    _createTextVNode(\" \" + _toDisplayString(relation.), 1 /* TEXT */)\n                                                ]),\n                                                _createElementVNode(\"p\", null, [\n                                                    _cache[14] || (_cache[14] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                    _createTextVNode(\" \" + _toDisplayString(relation.), 1 /* TEXT */)\n                                                ])\n                                            ]));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_15, [\n                                _createElementVNode(\"h2\", {\n                                    onClick: _cache[3] || (_cache[3] = ($event) => (toggleSection('memos')))\n                                }, [\n                                    _cache[15] || (_cache[15] = _createTextVNode(\"  \", -1 /* CACHED */)),\n                                    _createElementVNode(\"span\", {\n                                        class: _normalizeClass([\"arrow\", { open: sectionsOpen.memos }])\n                                    }, \"\", 2 /* CLASS */)\n                                ]),\n                                (sectionsOpen.memos)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_16, [\n                                        _createElementVNode(\"ul\", null, [\n                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(selectedDiary.value., (memo, index) => {\n                                                return (_openBlock(), _createElementBlock(\"li\", { key: index }, _toDisplayString(memo), 1 /* TEXT */));\n                                            }), 128 /* KEYED_FRAGMENT */))\n                                        ])\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ])\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_17, [...(_cache[16] || (_cache[16] = [\n                                _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                            ]))]))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./DiaryPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DiaryPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./DiaryPanel.vue?vue&type=style&index=0&id=2abe18ac&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-2abe18ac\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, normalizeStyle as _normalizeStyle, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = { class: \"item-detail-panel\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"item-details\"\n};\nconst _hoisted_3 = { class: \"item-tags\" };\nconst _hoisted_4 = { class: \"item-description\" };\nconst _hoisted_5 = {\n    key: 0,\n    class: \"item-effects\"\n};\nconst _hoisted_6 = {\n    key: 1,\n    class: \"placeholder\"\n};\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ItemDetailPanel',\n    props: {\n        item: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const typeColorMap = {\n            : { bg: 'rgba(108, 117, 125, 0.2)', text: '#6c757d' },\n            : { bg: 'rgba(58, 143, 157, 0.2)', text: '#3a8f9d' },\n            : { bg: 'rgba(212, 175, 55, 0.2)', text: '#d4af37' },\n            : { bg: 'rgba(138, 93, 181, 0.2)', text: '#8a5db5' },\n            : { bg: 'rgba(220, 53, 69, 0.2)', text: '#dc3545' },\n            : { bg: 'rgba(255, 193, 7, 0.2)', text: '#ffc107' },\n        };\n        const defaultColor = { bg: 'rgba(108, 117, 125, 0.2)', text: '#6c757d' };\n        const getTypeTagStyle = (item) => {\n            const colors = typeColorMap[item.] || defaultColor;\n            return {\n                backgroundColor: colors.bg,\n                color: colors.text,\n            };\n        };\n        const getTypeStyle = (item) => {\n            const color = typeColorMap[item.]?.text || defaultColor.text;\n            return { color };\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (__props.item)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _createElementVNode(\"h3\", {\n                            class: \"item-name\",\n                            style: _normalizeStyle(getTypeStyle(__props.item))\n                        }, _toDisplayString(__props.item.), 5 /* TEXT, STYLE */),\n                        _createElementVNode(\"div\", _hoisted_3, [\n                            _createElementVNode(\"span\", {\n                                class: \"tag\",\n                                style: _normalizeStyle(getTypeTagStyle(__props.item))\n                            }, _toDisplayString(__props.item.), 5 /* TEXT, STYLE */)\n                        ]),\n                        _createElementVNode(\"p\", _hoisted_4, _toDisplayString(__props.item.), 1 /* TEXT */),\n                        (__props.item.)\n                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n                                _cache[0] || (_cache[0] = _createElementVNode(\"h4\", null, \"\", -1 /* CACHED */)),\n                                _createElementVNode(\"p\", null, _toDisplayString(__props.item.), 1 /* TEXT */)\n                            ]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [...(_cache[1] || (_cache[1] = [\n                            _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                        ]))]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ItemDetailPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ItemDetailPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ItemDetailPanel.vue?vue&type=style&index=0&id=b1c37b8c&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-b1c37b8c\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, normalizeStyle as _normalizeStyle, createVNode as _createVNode, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = { class: \"inventory-panel-container\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"inventory-layout\"\n};\nconst _hoisted_3 = { class: \"list-view-container\" };\nconst _hoisted_4 = { class: \"category-header\" };\nconst _hoisted_5 = [\"onClick\"];\nconst _hoisted_6 = { class: \"main-content\" };\nconst _hoisted_7 = { class: \"item-grid-container\" };\nconst _hoisted_8 = {\n    key: 0,\n    class: \"item-grid\"\n};\nconst _hoisted_9 = [\"onClick\"];\nconst _hoisted_10 = { class: \"item-name\" };\nconst _hoisted_11 = {\n    key: 0,\n    class: \"item-quantity\"\n};\nconst _hoisted_12 = {\n    key: 1,\n    class: \"empty-grid\"\n};\nconst _hoisted_13 = {\n    key: 1,\n    class: \"loading\"\n};\nimport { computed, ref } from 'vue';\nimport { get } from 'lodash';\nimport { store } from '../../store';\nimport ItemDetailPanel from './inventory/ItemDetailPanel.vue';\nconst defaultColor = '#a0a0a0';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'InventoryPanel',\n    setup(__props) {\n        const selectedItemForModal = ref(null);\n        const selectedCategory = ref(null);\n        const playerCharacter = computed(() => {\n            const char = store.worldState?.;\n            if (typeof char === 'object' && char !== null && '' in char) {\n                return char;\n            }\n            return null;\n        });\n        const allItems = computed(() => {\n            if (!playerCharacter.value)\n                return [];\n            const inventory = playerCharacter.value.;\n            const itemDatabase = get(store.worldState, '', {});\n            return Object.entries(inventory)\n                .map(([itemId, itemData]) => {\n                const fullItemData = itemDatabase[itemId];\n                if (fullItemData) {\n                    return {\n                        ...fullItemData,\n                        ID: itemId,\n                        : itemData.,\n                    };\n                }\n                return null;\n            })\n                .filter((item) => item !== null);\n        });\n        const groupedItems = computed(() => {\n            const groups = {\n                : [],\n                : [],\n                : [],\n                : [],\n                : [],\n                : [],\n            };\n            allItems.value.forEach(item => {\n                const category = item.;\n                if (groups[category]) {\n                    groups[category].push(item);\n                }\n            });\n            if (!selectedCategory.value || !Object.keys(groups).includes(selectedCategory.value)) {\n                const firstCategoryWithItems = Object.keys(groups).find(k => groups[k].length > 0);\n                selectedCategory.value = firstCategoryWithItems || '';\n            }\n            return groups;\n        });\n        const itemsInSelectedCategory = computed(() => {\n            if (!selectedCategory.value || !groupedItems.value[selectedCategory.value]) {\n                return [];\n            }\n            return groupedItems.value[selectedCategory.value];\n        });\n        const selectItem = (item) => {\n            selectedItemForModal.value = item;\n        };\n        const selectCategory = (category) => {\n            selectedCategory.value = category;\n        };\n        const typeColorMap = {\n            : '#6c757d',\n            : '#3a8f9d',\n            : '#d4af37',\n            : '#8a5db5',\n            : '#dc3545',\n            : '#ffc107',\n        };\n        const getTypeStyle = (item) => {\n            const color = typeColorMap[item.] || defaultColor;\n            return { '--tier-border-color': color };\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (playerCharacter.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _createElementVNode(\"div\", _hoisted_3, [\n                            _createElementVNode(\"div\", _hoisted_4, [\n                                _createElementVNode(\"ul\", null, [\n                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(Object.keys(groupedItems.value), (category) => {\n                                        return (_openBlock(), _createElementBlock(\"li\", {\n                                            key: category,\n                                            class: _normalizeClass({ active: selectedCategory.value === category }),\n                                            onClick: ($event) => (selectCategory(category))\n                                        }, _toDisplayString(category) + \" (\" + _toDisplayString(groupedItems.value[category].length) + \") \", 11 /* TEXT, CLASS, PROPS */, _hoisted_5));\n                                    }), 128 /* KEYED_FRAGMENT */))\n                                ])\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_6, [\n                                _createElementVNode(\"div\", _hoisted_7, [\n                                    (itemsInSelectedCategory.value.length > 0)\n                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [\n                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(itemsInSelectedCategory.value, (item) => {\n                                                return (_openBlock(), _createElementBlock(\"div\", {\n                                                    key: item.ID,\n                                                    class: \"item-cell\",\n                                                    style: _normalizeStyle(getTypeStyle(item)),\n                                                    onClick: ($event) => (selectItem(item))\n                                                }, [\n                                                    _createElementVNode(\"div\", _hoisted_10, _toDisplayString(item.), 1 /* TEXT */),\n                                                    (item.)\n                                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, \"x\" + _toDisplayString(item.), 1 /* TEXT */))\n                                                        : _createCommentVNode(\"v-if\", true)\n                                                ], 12 /* STYLE, PROPS */, _hoisted_9));\n                                            }), 128 /* KEYED_FRAGMENT */))\n                                        ]))\n                                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_12, [...(_cache[3] || (_cache[3] = [\n                                                _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                                            ]))]))\n                                ])\n                            ])\n                        ])\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_13, \"...\")),\n                _createCommentVNode(\" Item Detail Modal \"),\n                (selectedItemForModal.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 2,\n                        class: \"modal-overlay\",\n                        onClick: _cache[2] || (_cache[2] = ($event) => (selectedItemForModal.value = null))\n                    }, [\n                        _createElementVNode(\"div\", {\n                            class: \"modal-content\",\n                            onClick: _cache[1] || (_cache[1] = _withModifiers(() => { }, [\"stop\"]))\n                        }, [\n                            _createVNode(ItemDetailPanel, { item: selectedItemForModal.value }, null, 8 /* PROPS */, [\"item\"]),\n                            _createElementVNode(\"button\", {\n                                class: \"close-button\",\n                                onClick: _cache[0] || (_cache[0] = ($event) => (selectedItemForModal.value = null))\n                            }, \"\")\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./InventoryPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./InventoryPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./InventoryPanel.vue?vue&type=style&index=0&id=2ebd8a93&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-2ebd8a93\"]])\n\nexport default __exports__","import { ref, watch } from 'vue';\n\nconst FOLLOWED_NPCS_STORAGE_KEY = 'reincarnation_followed_npcs';\n\nconst followedNpcs = ref(new Set<string>(JSON.parse(localStorage.getItem(FOLLOWED_NPCS_STORAGE_KEY) || '[]')));\n\nwatch(\n  followedNpcs,\n  newSet => {\n    localStorage.setItem(FOLLOWED_NPCS_STORAGE_KEY, JSON.stringify(Array.from(newSet)));\n  },\n  { deep: true },\n);\n\nexport function useFollowSystem() {\n  const follow = (npcId: string) => {\n    followedNpcs.value.add(npcId);\n  };\n\n  const unfollow = (npcId: string) => {\n    followedNpcs.value.delete(npcId);\n  };\n\n  const isFollowed = (npcId: string) => {\n    return followedNpcs.value.has(npcId);\n  };\n\n  const toggleFollow = (npcId: string) => {\n    if (isFollowed(npcId)) {\n      unfollow(npcId);\n    } else {\n      follow(npcId);\n    }\n  };\n\n  return { followedNpcs, toggleFollow, isFollowed };\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { withModifiers as _withModifiers, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nimport { ref, watchEffect } from 'vue';\nimport { useFollowSystem } from '../../services/useFollowSystem';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'FollowButton',\n    props: {\n        npcId: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const { toggleFollow, isFollowed } = useFollowSystem();\n        const isFollowedState = ref(false);\n        watchEffect(() => {\n            isFollowedState.value = isFollowed(props.npcId);\n        });\n        function toggle() {\n            toggleFollow(props.npcId);\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"button\", {\n                class: _normalizeClass([\"follow-btn\", { followed: isFollowedState.value }]),\n                onClick: _withModifiers(toggle, [\"stop\"])\n            }, \"\", 2 /* CLASS */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./FollowButton.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./FollowButton.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./FollowButton.vue?vue&type=style&index=0&id=69130bcd&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-69130bcd\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, vModelText as _vModelText, createElementVNode as _createElementVNode, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createBlock as _createBlock, createTextVNode as _createTextVNode, createVNode as _createVNode, Transition as _Transition, withCtx as _withCtx } from \"vue\";\nconst _hoisted_1 = { class: \"npc-directory-panel-mobile\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"npc-list-view\"\n};\nconst _hoisted_3 = {\n    key: 0,\n    class: \"npc-list\"\n};\nconst _hoisted_4 = [\"onClick\"];\nconst _hoisted_5 = { class: \"npc-info\" };\nconst _hoisted_6 = { class: \"npc-name\" };\nconst _hoisted_7 = { class: \"npc-location\" };\nconst _hoisted_8 = {\n    key: 1,\n    class: \"placeholder\"\n};\nconst _hoisted_9 = {\n    key: 1,\n    class: \"npc-detail-view\"\n};\nimport { computed, ref, watch } from 'vue';\nimport { npcService } from '../../services/NpcService';\nimport { useFollowSystem } from '../../services/useFollowSystem';\nimport { detailModalService } from '../../services/DetailModalService';\nimport FollowButton from '../common/FollowButton.vue';\nimport NpcDetailDisplay from '../common/NpcDetailDisplay.vue';\nimport LocationInfoCard from '../common/LocationInfoCard.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcDirectoryPanel',\n    setup(__props) {\n        const selectedNpc = ref(null);\n        const selectedNpcId = ref(null);\n        const npcSearchTerm = ref('');\n        const { isFollowed } = useFollowSystem();\n        const displayedNpcs = computed(() => {\n            // Directly use allNpcs from the service, as world filtering is no longer needed.\n            let npcs = npcService.allNpcs.value.map(npc => ({\n                ...npc,\n                // Ensure 'id' is attached for keying and other logic. The 'id' is attached in the service.\n                id: npc.id,\n                locationName: npcService.getLocationName(npc.),\n            }));\n            // Sort by followed status first\n            npcs.sort((a, b) => {\n                const aFollowed = a.id ? isFollowed(a.id) : false;\n                const bFollowed = b.id ? isFollowed(b.id) : false;\n                if (aFollowed && !bFollowed)\n                    return -1;\n                if (!aFollowed && bFollowed)\n                    return 1;\n                return 0;\n            });\n            if (!npcSearchTerm.value) {\n                return npcs;\n            }\n            return npcs.filter(n => n. && n..toLowerCase().includes(npcSearchTerm.value.toLowerCase()));\n        });\n        function selectNpc(npc) {\n            selectedNpc.value = npc;\n            selectedNpcId.value = npc.id;\n        }\n        function showLocationDetails(locationId) {\n            if (!locationId)\n                return;\n            detailModalService.show('', LocationInfoCard, { locationId });\n        }\n        // Watch for changes in the total NPC list and pre-select the first one if none is selected.\n        watch(displayedNpcs, newNpcs => {\n            if (newNpcs.length > 0 && !selectedNpc.value) {\n                // selectNpc(newNpcs[0]);\n            }\n            else if (newNpcs.length === 0) {\n                selectedNpc.value = null;\n                selectedNpcId.value = null;\n            }\n        }, { immediate: true });\n        const goBackToList = () => {\n            selectedNpc.value = null;\n            selectedNpcId.value = null;\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createVNode(_Transition, {\n                    name: \"slide-fade\",\n                    mode: \"out-in\"\n                }, {\n                    default: _withCtx(() => [\n                        (!selectedNpc.value)\n                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                                _withDirectives(_createElementVNode(\"input\", {\n                                    type: \"text\",\n                                    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((npcSearchTerm).value = $event)),\n                                    placeholder: \"...\",\n                                    class: \"search-input\"\n                                }, null, 512 /* NEED_PATCH */), [\n                                    [_vModelText, npcSearchTerm.value]\n                                ]),\n                                (displayedNpcs.value.length > 0)\n                                    ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_3, [\n                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(displayedNpcs.value, (npc) => {\n                                            return (_openBlock(), _createElementBlock(\"li\", {\n                                                key: npc.id,\n                                                onClick: ($event) => (selectNpc(npc))\n                                            }, [\n                                                _createElementVNode(\"div\", _hoisted_5, [\n                                                    _createElementVNode(\"span\", _hoisted_6, _toDisplayString(npc.), 1 /* TEXT */),\n                                                    _createElementVNode(\"span\", _hoisted_7, _toDisplayString(npc.locationName), 1 /* TEXT */)\n                                                ]),\n                                                (npc.id)\n                                                    ? (_openBlock(), _createBlock(FollowButton, {\n                                                        key: 0,\n                                                        \"npc-id\": npc.id\n                                                    }, null, 8 /* PROPS */, [\"npc-id\"]))\n                                                    : _createCommentVNode(\"v-if\", true)\n                                            ], 8 /* PROPS */, _hoisted_4));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                    ]))\n                                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_8, \"\"))\n                            ]))\n                            : (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [\n                                _createElementVNode(\"div\", { class: \"detail-header\" }, [\n                                    _createElementVNode(\"button\", {\n                                        onClick: goBackToList,\n                                        class: \"back-button\"\n                                    }, [...(_cache[1] || (_cache[1] = [\n                                            _createElementVNode(\"i\", { class: \"fas fa-arrow-left\" }, null, -1 /* CACHED */),\n                                            _createTextVNode(\" \", -1 /* CACHED */)\n                                        ]))])\n                                ]),\n                                _createVNode(NpcDetailDisplay, {\n                                    npc: selectedNpc.value,\n                                    \"npc-id\": selectedNpcId.value\n                                }, null, 8 /* PROPS */, [\"npc\", \"npc-id\"])\n                            ]))\n                    ]),\n                    _: 1 /* STABLE */\n                })\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcDirectoryPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcDirectoryPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcDirectoryPanel.vue?vue&type=style&index=0&id=6ec21cbc&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-6ec21cbc\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createVNode as _createVNode, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"reincarnation-panel\" };\nconst _hoisted_2 = { class: \"tab-content\" };\nimport DiaryPanel from './DiaryPanel.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ReincarnationPanel',\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createVNode(DiaryPanel)\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ReincarnationPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ReincarnationPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ReincarnationPanel.vue?vue&type=style&index=0&id=30be22b9&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-30be22b9\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = { class: \"skills-panel\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"empty-state\"\n};\nconst _hoisted_3 = {\n    key: 1,\n    class: \"skills-list\"\n};\nconst _hoisted_4 = { class: \"skill-header\" };\nconst _hoisted_5 = { class: \"skill-level\" };\nconst _hoisted_6 = { class: \"skill-description\" };\nconst _hoisted_7 = { class: \"skill-progress\" };\nconst _hoisted_8 = { class: \"progress-bar-wrapper\" };\nconst _hoisted_9 = [\"value\", \"max\"];\nconst _hoisted_10 = { class: \"progress-text\" };\nconst _hoisted_11 = {\n    key: 0,\n    class: \"associated-skills\"\n};\nconst _hoisted_12 = [\"onClick\"];\nconst _hoisted_13 = {\n    key: 0,\n    class: \"associated-skills-list\"\n};\nconst _hoisted_14 = { class: \"skill-name\" };\nconst _hoisted_15 = { class: \"skill-detail skill-description-detail\" };\nconst _hoisted_16 = { class: \"skill-detail\" };\nconst _hoisted_17 = { class: \"skill-detail\" };\nimport { computed, ref } from 'vue';\nimport { playerSkills } from '../../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'SkillsPanel',\n    setup(__props) {\n        const skills = computed(() => playerSkills.value);\n        const expandedSkills = ref({});\n        const toggleSkills = (skillId) => {\n            expandedSkills.value[skillId] = !expandedSkills.value[skillId];\n        };\n        const isExpanded = (skillId) => {\n            return !!expandedSkills.value[skillId];\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _cache[4] || (_cache[4] = _createElementVNode(\"h2\", null, \"\", -1 /* CACHED */)),\n                (skills.value.length === 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [...(_cache[0] || (_cache[0] = [\n                            _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                        ]))]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(skills.value, (skill) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: skill.id,\n                                class: \"skill-item\"\n                            }, [\n                                _createElementVNode(\"div\", _hoisted_4, [\n                                    _createElementVNode(\"h3\", null, _toDisplayString(skill.name), 1 /* TEXT */),\n                                    _createElementVNode(\"div\", _hoisted_5, \" \" + _toDisplayString(skill.level), 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"p\", _hoisted_6, _toDisplayString(skill.description), 1 /* TEXT */),\n                                _createElementVNode(\"div\", _hoisted_7, [\n                                    _createElementVNode(\"div\", _hoisted_8, [\n                                        _createElementVNode(\"progress\", {\n                                            value: skill.exp,\n                                            max: skill.expToNextLevel === 'MAX' ? skill.exp : skill.expToNextLevel\n                                        }, null, 8 /* PROPS */, _hoisted_9),\n                                        _createElementVNode(\"span\", _hoisted_10, _toDisplayString(skill.exp) + \" / \" + _toDisplayString(skill.expToNextLevel), 1 /* TEXT */)\n                                    ])\n                                ]),\n                                (skill.associatedSkills && skill.associatedSkills.length > 0)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [\n                                        _createElementVNode(\"button\", {\n                                            onClick: ($event) => (toggleSkills(skill.id)),\n                                            class: \"associated-skills-title\"\n                                        }, [\n                                            _cache[1] || (_cache[1] = _createTextVNode(\"  \", -1 /* CACHED */)),\n                                            _createElementVNode(\"span\", {\n                                                class: _normalizeClass(['arrow', { expanded: isExpanded(skill.id) }])\n                                            }, null, 2 /* CLASS */)\n                                        ], 8 /* PROPS */, _hoisted_12),\n                                        (isExpanded(skill.id))\n                                            ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_13, [\n                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(skill.associatedSkills, (activeSkill) => {\n                                                    return (_openBlock(), _createElementBlock(\"li\", {\n                                                        key: activeSkill.ID,\n                                                        class: \"associated-skill-item\"\n                                                    }, [\n                                                        _createElementVNode(\"div\", _hoisted_14, [\n                                                            _createElementVNode(\"strong\", null, _toDisplayString(activeSkill.), 1 /* TEXT */),\n                                                            _createTextVNode(\" (\" + _toDisplayString(activeSkill.) + \") \", 1 /* TEXT */)\n                                                        ]),\n                                                        _createElementVNode(\"div\", _hoisted_15, _toDisplayString(activeSkill.), 1 /* TEXT */),\n                                                        _createElementVNode(\"div\", _hoisted_16, [\n                                                            _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                            _createTextVNode(\" \" + _toDisplayString(activeSkill.), 1 /* TEXT */)\n                                                        ]),\n                                                        _createElementVNode(\"div\", _hoisted_17, [\n                                                            _cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                                            _createTextVNode(\" \" + _toDisplayString(activeSkill.), 1 /* TEXT */)\n                                                        ])\n                                                    ]));\n                                                }), 128 /* KEYED_FRAGMENT */))\n                                            ]))\n                                            : _createCommentVNode(\"v-if\", true)\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./SkillsPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SkillsPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./SkillsPanel.vue?vue&type=style&index=0&id=14bf0e7c&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-14bf0e7c\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, vModelCheckbox as _vModelCheckbox, withDirectives as _withDirectives, vModelText as _vModelText, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"panel-wrapper memory-panel-container\" };\nconst _hoisted_2 = { class: \"panel-content\" };\nconst _hoisted_3 = { class: \"section\" };\nconst _hoisted_4 = { class: \"setting-item\" };\nconst _hoisted_5 = { class: \"section\" };\nconst _hoisted_6 = { class: \"setting-item\" };\nconst _hoisted_7 = { class: \"setting-item\" };\nconst _hoisted_8 = { class: \"setting-item\" };\nconst _hoisted_9 = { class: \"section\" };\nconst _hoisted_10 = { class: \"tabs\" };\nconst _hoisted_11 = { class: \"memory-content\" };\nconst _hoisted_12 = [\"value\"];\nimport * as toastr from 'toastr';\nimport { computed, onMounted, onUnmounted, ref } from 'vue';\nimport { eventBus } from '../../services/EventBus';\nimport { lorebookService } from '../../services/LorebookService';\nimport { memoryService } from '../../services/MemoryService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'MemoryPanel',\n    setup(__props) {\n        const isAutoMemoryEnabled = ref(true); // Default to enabled\n        const config = ref({\n            instantMemoryCount: 3,\n            shortTermMemoryCount: 25,\n            longTermMemoryCount: 200,\n        });\n        const activeTab = ref('instant');\n        const memoryContent = ref({\n            instant: '...',\n            short: '...',\n            long: '...',\n        });\n        const activeMemoryContent = computed(() => {\n            return memoryContent.value[activeTab.value];\n        });\n        async function fetchMemoryContent(forceRefresh = false) {\n            try {\n                const [instant, short, long] = await Promise.all([\n                    lorebookService.readFromLorebook('[]', forceRefresh),\n                    lorebookService.readFromLorebook('[]', forceRefresh),\n                    lorebookService.readFromLorebook('[]', forceRefresh),\n                ]);\n                memoryContent.value.instant = instant || '';\n                memoryContent.value.short = short || '';\n                memoryContent.value.long = long || '';\n            }\n            catch (error) {\n                console.error('[MemoryPanel] Failed to fetch memory content:', error);\n                toastr.error('');\n            }\n        }\n        function updateConfig() {\n            memoryService.setConfig(config.value);\n            toastr.success('');\n        }\n        async function forceUpdate() {\n            toastr.info('...');\n            console.log('[MemoryPanel] Forcing update via processDirectorLog...');\n            await memoryService.processDirectorLog();\n            await fetchMemoryContent(true); // Force refresh after manual update\n            toastr.success('');\n        }\n        const handleMemoryUpdate = () => {\n            console.log('[MemoryPanel] Detected memory update. Refreshing content...');\n            fetchMemoryContent(true); // Force refresh\n        };\n        onMounted(() => {\n            config.value = memoryService.getConfig();\n            fetchMemoryContent();\n            eventBus.on('memoryUpdated', handleMemoryUpdate);\n        });\n        onUnmounted(() => {\n            eventBus.off('memoryUpdated', handleMemoryUpdate);\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[14] || (_cache[14] = _createElementVNode(\"h3\", { class: \"panel-title\" }, \"\", -1 /* CACHED */)),\n                    _createCommentVNode(\" Automation Control \"),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _createElementVNode(\"div\", _hoisted_4, [\n                            _cache[7] || (_cache[7] = _createElementVNode(\"label\", { for: \"auto-memory-switch\" }, \"\", -1 /* CACHED */)),\n                            _withDirectives(_createElementVNode(\"input\", {\n                                type: \"checkbox\",\n                                id: \"auto-memory-switch\",\n                                \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => ((isAutoMemoryEnabled).value = $event))\n                            }, null, 512 /* NEED_PATCH */), [\n                                [_vModelCheckbox, isAutoMemoryEnabled.value]\n                            ])\n                        ]),\n                        _cache[8] || (_cache[8] = _createElementVNode(\"p\", { class: \"description\" }, \"AI\", -1 /* CACHED */))\n                    ]),\n                    _createCommentVNode(\" Configuration \"),\n                    _createElementVNode(\"div\", _hoisted_5, [\n                        _cache[12] || (_cache[12] = _createElementVNode(\"h4\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"div\", _hoisted_6, [\n                            _cache[9] || (_cache[9] = _createElementVNode(\"label\", { for: \"instant-memory-count\" }, \"\", -1 /* CACHED */)),\n                            _withDirectives(_createElementVNode(\"input\", {\n                                type: \"number\",\n                                id: \"instant-memory-count\",\n                                \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event) => ((config.value.instantMemoryCount) = $event))\n                            }, null, 512 /* NEED_PATCH */), [\n                                [\n                                    _vModelText,\n                                    config.value.instantMemoryCount,\n                                    void 0,\n                                    { number: true }\n                                ]\n                            ])\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_7, [\n                            _cache[10] || (_cache[10] = _createElementVNode(\"label\", { for: \"short-term-count\" }, \"\", -1 /* CACHED */)),\n                            _withDirectives(_createElementVNode(\"input\", {\n                                type: \"number\",\n                                id: \"short-term-count\",\n                                \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event) => ((config.value.shortTermMemoryCount) = $event))\n                            }, null, 512 /* NEED_PATCH */), [\n                                [\n                                    _vModelText,\n                                    config.value.shortTermMemoryCount,\n                                    void 0,\n                                    { number: true }\n                                ]\n                            ])\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_8, [\n                            _cache[11] || (_cache[11] = _createElementVNode(\"label\", { for: \"long-term-count\" }, \"\", -1 /* CACHED */)),\n                            _withDirectives(_createElementVNode(\"input\", {\n                                type: \"number\",\n                                id: \"long-term-count\",\n                                \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event) => ((config.value.longTermMemoryCount) = $event))\n                            }, null, 512 /* NEED_PATCH */), [\n                                [\n                                    _vModelText,\n                                    config.value.longTermMemoryCount,\n                                    void 0,\n                                    { number: true }\n                                ]\n                            ])\n                        ]),\n                        _createElementVNode(\"button\", { onClick: updateConfig }, \"\"),\n                        _createElementVNode(\"button\", { onClick: forceUpdate }, \"\")\n                    ]),\n                    _createCommentVNode(\" Memory Review \"),\n                    _createElementVNode(\"div\", _hoisted_9, [\n                        _cache[13] || (_cache[13] = _createElementVNode(\"h4\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"div\", _hoisted_10, [\n                            _createElementVNode(\"button\", {\n                                class: _normalizeClass({ active: activeTab.value === 'instant' }),\n                                onClick: _cache[4] || (_cache[4] = ($event) => (activeTab.value = 'instant'))\n                            }, \"\", 2 /* CLASS */),\n                            _createElementVNode(\"button\", {\n                                class: _normalizeClass({ active: activeTab.value === 'short' }),\n                                onClick: _cache[5] || (_cache[5] = ($event) => (activeTab.value = 'short'))\n                            }, \"\", 2 /* CLASS */),\n                            _createElementVNode(\"button\", {\n                                class: _normalizeClass({ active: activeTab.value === 'long' }),\n                                onClick: _cache[6] || (_cache[6] = ($event) => (activeTab.value = 'long'))\n                            }, \"\", 2 /* CLASS */)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_11, [\n                            _createElementVNode(\"textarea\", {\n                                readonly: \"\",\n                                value: activeMemoryContent.value\n                            }, null, 8 /* PROPS */, _hoisted_12)\n                        ])\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./MemoryPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MemoryPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MemoryPanel.vue?vue&type=style&index=0&id=8153ab84&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-8153ab84\"]])\n\nexport default __exports__","import { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, vModelCheckbox as _vModelCheckbox, withDirectives as _withDirectives, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = { class: \"save-load-panel\" };\nconst _hoisted_2 = { class: \"panel-header\" };\nconst _hoisted_3 = { class: \"header-actions\" };\nconst _hoisted_4 = { class: \"save-slots-container\" };\nconst _hoisted_5 = { class: \"slot-group\" };\nconst _hoisted_6 = { class: \"slot-info\" };\nconst _hoisted_7 = { class: \"slot-name\" };\nconst _hoisted_8 = { class: \"slot-timestamp\" };\nconst _hoisted_9 = {\n    key: 0,\n    class: \"slot-diary\"\n};\nconst _hoisted_10 = { class: \"log-date\" };\nconst _hoisted_11 = { class: \"log-title\" };\nconst _hoisted_12 = { class: \"slot-actions\" };\nconst _hoisted_13 = [\"onClick\"];\nconst _hoisted_14 = [\"onClick\", \"disabled\"];\nconst _hoisted_15 = [\"onClick\", \"disabled\"];\nconst _hoisted_16 = { class: \"slot-group\" };\nconst _hoisted_17 = { class: \"slot-info\" };\nconst _hoisted_18 = { class: \"slot-name\" };\nconst _hoisted_19 = { class: \"slot-timestamp\" };\nconst _hoisted_20 = {\n    key: 0,\n    class: \"slot-diary\"\n};\nconst _hoisted_21 = { class: \"log-date\" };\nconst _hoisted_22 = { class: \"log-title\" };\nconst _hoisted_23 = { class: \"slot-actions\" };\nconst _hoisted_24 = [\"onClick\", \"disabled\"];\nconst _hoisted_25 = { class: \"auto-save-toggle\" };\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n    return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n        _createElementVNode(\"div\", _hoisted_2, [\n            _cache[5] || (_cache[5] = _createElementVNode(\"h2\", { class: \"panel-title\" }, \"\", -1 /* CACHED */)),\n            _createElementVNode(\"div\", _hoisted_3, [\n                _createElementVNode(\"button\", {\n                    onClick: _cache[0] || (_cache[0] =\n                        //@ts-ignore\n                        (...args) => (_ctx.importSave && _ctx.importSave(...args))),\n                    class: \"header-btn\"\n                }, \"\"),\n                _createElementVNode(\"button\", {\n                    onClick: _cache[1] || (_cache[1] =\n                        //@ts-ignore\n                        (...args) => (_ctx.exportSave && _ctx.exportSave(...args))),\n                    class: \"header-btn\"\n                }, \"\")\n            ])\n        ]),\n        _createElementVNode(\"div\", _hoisted_4, [\n            _createElementVNode(\"div\", _hoisted_5, [\n                _cache[6] || (_cache[6] = _createElementVNode(\"h3\", { class: \"group-title\" }, \"\", -1 /* CACHED */)),\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.manualSlots, (slot) => {\n                    return (_openBlock(), _createElementBlock(\"div\", {\n                        key: slot.id,\n                        class: \"save-slot\"\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_6, [\n                            _createElementVNode(\"span\", _hoisted_7, _toDisplayString(slot.name), 1 /* TEXT */),\n                            _createElementVNode(\"span\", _hoisted_8, _toDisplayString(slot.timestamp ? _ctx.formatTimestamp(slot.timestamp) : ''), 1 /* TEXT */),\n                            (slot.diaryDate || slot.diaryTimeSegment || slot.diaryTitle)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [\n                                    _createElementVNode(\"span\", _hoisted_10, _toDisplayString(slot.diaryDate) + \" \" + _toDisplayString(slot.diaryTimeSegment), 1 /* TEXT */),\n                                    _createElementVNode(\"span\", _hoisted_11, _toDisplayString(slot.diaryTitle), 1 /* TEXT */)\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_12, [\n                            _createElementVNode(\"button\", {\n                                onClick: ($event) => (_ctx.saveGame(slot.id)),\n                                class: \"action-btn save-btn\"\n                            }, \"\", 8 /* PROPS */, _hoisted_13),\n                            _createElementVNode(\"button\", {\n                                onClick: ($event) => (_ctx.loadGame(slot)),\n                                disabled: !slot.data,\n                                class: \"action-btn load-btn\"\n                            }, \"\", 8 /* PROPS */, _hoisted_14),\n                            _createElementVNode(\"button\", {\n                                onClick: ($event) => (_ctx.deleteSave(slot)),\n                                disabled: !slot.data,\n                                class: \"action-btn delete-btn\"\n                            }, \"\", 8 /* PROPS */, _hoisted_15)\n                        ])\n                    ]));\n                }), 128 /* KEYED_FRAGMENT */))\n            ]),\n            _createElementVNode(\"div\", _hoisted_16, [\n                _cache[7] || (_cache[7] = _createElementVNode(\"h3\", { class: \"group-title\" }, \"\", -1 /* CACHED */)),\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.autoSlots, (slot) => {\n                    return (_openBlock(), _createElementBlock(\"div\", {\n                        key: slot.id,\n                        class: \"save-slot auto-slot\"\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_17, [\n                            _createElementVNode(\"span\", _hoisted_18, _toDisplayString(slot.name), 1 /* TEXT */),\n                            _createElementVNode(\"span\", _hoisted_19, _toDisplayString(slot.timestamp ? _ctx.formatTimestamp(slot.timestamp) : ''), 1 /* TEXT */),\n                            (slot.diaryDate || slot.diaryTimeSegment || slot.diaryTitle)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_20, [\n                                    _createElementVNode(\"span\", _hoisted_21, _toDisplayString(slot.diaryDate) + \" \" + _toDisplayString(slot.diaryTimeSegment), 1 /* TEXT */),\n                                    _createElementVNode(\"span\", _hoisted_22, _toDisplayString(slot.diaryTitle), 1 /* TEXT */)\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_23, [\n                            _createElementVNode(\"button\", {\n                                onClick: ($event) => (_ctx.loadGame(slot)),\n                                disabled: !slot.data,\n                                class: \"action-btn load-btn\"\n                            }, \"\", 8 /* PROPS */, _hoisted_24)\n                        ])\n                    ]));\n                }), 128 /* KEYED_FRAGMENT */))\n            ]),\n            _createElementVNode(\"div\", _hoisted_25, [\n                _createElementVNode(\"label\", null, [\n                    _withDirectives(_createElementVNode(\"input\", {\n                        type: \"checkbox\",\n                        \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event) => ((_ctx.isAutoSaveEnabled) = $event)),\n                        onChange: _cache[3] || (_cache[3] =\n                            //@ts-ignore\n                            (...args) => (_ctx.toggleAutoSave && _ctx.toggleAutoSave(...args)))\n                    }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [\n                        [_vModelCheckbox, _ctx.isAutoSaveEnabled]\n                    ]),\n                    _cache[8] || (_cache[8] = _createTextVNode(\"  \", -1 /* CACHED */))\n                ])\n            ])\n        ]),\n        _createElementVNode(\"input\", {\n            type: \"file\",\n            ref: \"fileInput\",\n            onChange: _cache[4] || (_cache[4] =\n                //@ts-ignore\n                (...args) => (_ctx.handleFileImport && _ctx.handleFileImport(...args))),\n            style: { \"display\": \"none\" },\n            accept: \".json\"\n        }, null, 544 /* NEED_HYDRATION, NEED_PATCH */)\n    ]));\n}\n","import * as toastr from 'toastr';\nimport { defineComponent, onMounted, ref } from 'vue';\nimport { saveLoadService } from '../../services/saveLoadService';\nexport default defineComponent({\n    name: 'SaveLoadPanel',\n    setup() {\n        const manualSlots = ref([]);\n        const autoSlots = ref([]);\n        const isAutoSaveEnabled = ref(true);\n        const fileInput = ref(null);\n        const loadSlots = async () => {\n            await saveLoadService.loadAllSaveSlots();\n            manualSlots.value = [...saveLoadService.manualSlots];\n            autoSlots.value = [...saveLoadService.autoSlots];\n        };\n        onMounted(() => {\n            loadSlots();\n            isAutoSaveEnabled.value = saveLoadService.isAutoSaveEnabled;\n        });\n        const formatTimestamp = (timestamp) => {\n            return new Date(timestamp).toLocaleString('zh-CN', { hour12: false });\n        };\n        const saveGame = async (slotId) => {\n            await saveLoadService.saveGame(slotId);\n            await loadSlots();\n        };\n        const loadGame = async (slot) => {\n            await saveLoadService.loadGame(slot);\n        };\n        const deleteSave = async (slot) => {\n            await saveLoadService.deleteSave(slot);\n            await loadSlots();\n        };\n        const toggleAutoSave = () => {\n            saveLoadService.toggleAutoSave(isAutoSaveEnabled.value);\n        };\n        const importSave = () => {\n            fileInput.value?.click();\n        };\n        const handleFileImport = (event) => {\n            const target = event.target;\n            if (target.files && target.files[0]) {\n                const file = target.files[0];\n                const reader = new FileReader();\n                reader.onload = async (e) => {\n                    try {\n                        const content = e.target?.result;\n                        await saveLoadService.importSave(content);\n                        await loadSlots();\n                    }\n                    catch (error) {\n                        toastr.error('');\n                        console.error(error);\n                    }\n                };\n                reader.readAsText(file);\n                target.value = ''; // Reset input\n            }\n        };\n        const exportSave = async () => {\n            // For simplicity, we'll export the first manual save slot with data\n            const slotToExport = manualSlots.value.find(slot => slot.data);\n            if (!slotToExport) {\n                toastr.warning('');\n                return;\n            }\n            saveLoadService.exportSave(slotToExport);\n        };\n        return {\n            manualSlots,\n            autoSlots,\n            isAutoSaveEnabled,\n            fileInput,\n            formatTimestamp,\n            saveGame,\n            loadGame,\n            deleteSave,\n            toggleAutoSave,\n            importSave,\n            handleFileImport,\n            exportSave,\n        };\n    },\n});\n","/* unplugin-vue-components disabled */import { render } from \"./SaveLoadPanel.vue?vue&type=template&id=7bd14af8&scoped=true&ts=true\"\nimport script from \"./SaveLoadPanel.vue?vue&type=script&lang=ts\"\nexport * from \"./SaveLoadPanel.vue?vue&type=script&lang=ts\"\n\nimport \"./SaveLoadPanel.vue?vue&type=style&index=0&id=7bd14af8&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-7bd14af8\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { normalizeClass as _normalizeClass, createElementVNode as _createElementVNode, vShow as _vShow, createVNode as _createVNode, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"system-panel\" };\nconst _hoisted_2 = { class: \"panel-tabs\" };\nconst _hoisted_3 = { class: \"panel-content\" };\nimport { ref } from 'vue';\nimport MemoryPanel from './MemoryPanel.vue';\nimport SaveLoadPanel from './SaveLoadPanel.vue';\nimport DebugPanel from './DebugPanel.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'SystemPanel',\n    setup(__props) {\n        const activeTab = ref('saveLoad');\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass({ active: activeTab.value === 'saveLoad' }),\n                        onClick: _cache[0] || (_cache[0] = ($event) => (activeTab.value = 'saveLoad'))\n                    }, \"\", 2 /* CLASS */),\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass({ active: activeTab.value === 'memory' }),\n                        onClick: _cache[1] || (_cache[1] = ($event) => (activeTab.value = 'memory'))\n                    }, \"\", 2 /* CLASS */),\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass({ active: activeTab.value === 'debug' }),\n                        onClick: _cache[2] || (_cache[2] = ($event) => (activeTab.value = 'debug'))\n                    }, \"\", 2 /* CLASS */)\n                ]),\n                _createElementVNode(\"div\", _hoisted_3, [\n                    _withDirectives(_createVNode(SaveLoadPanel, null, null, 512 /* NEED_PATCH */), [\n                        [_vShow, activeTab.value === 'saveLoad']\n                    ]),\n                    _withDirectives(_createVNode(MemoryPanel, null, null, 512 /* NEED_PATCH */), [\n                        [_vShow, activeTab.value === 'memory']\n                    ]),\n                    _withDirectives(_createVNode(DebugPanel, null, null, 512 /* NEED_PATCH */), [\n                        [_vShow, activeTab.value === 'debug']\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./SystemPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SystemPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./SystemPanel.vue?vue&type=style&index=0&id=0bab00cc&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-0bab00cc\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n    key: 0,\n    class: \"realm-detail-card\"\n};\nconst _hoisted_2 = { class: \"info-item\" };\nconst _hoisted_3 = { class: \"info-item\" };\nconst _hoisted_4 = { class: \"info-item full-width\" };\nconst _hoisted_5 = { class: \"info-item full-width\" };\nconst _hoisted_6 = { class: \"info-item full-width\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'RealmDetailCard',\n    props: {\n        realm: {\n            type: Object,\n            required: true,\n        },\n    },\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (__props.realm)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                    _createElementVNode(\"div\", _hoisted_2, [\n                        _cache[0] || (_cache[0] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.realm.), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _cache[1] || (_cache[1] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.realm.), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_4, [\n                        _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.realm.), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_5, [\n                        _cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"span\", null, _toDisplayString(__props.realm.?. && __props.realm.?. !== '' ? `${__props.realm..} - ${__props.realm..}` : ''), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_6, [\n                        _cache[4] || (_cache[4] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                        _createElementVNode(\"ul\", null, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.realm., (req, key) => {\n                                return (_openBlock(), _createElementBlock(\"li\", { key: key }, _toDisplayString(req.), 1 /* TEXT */));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ])\n                    ])\n                ]))\n                : _createCommentVNode(\"v-if\", true);\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./RealmDetailCard.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./RealmDetailCard.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./RealmDetailCard.vue?vue&type=style&index=0&id=155d0d21&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-155d0d21\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment } from \"vue\";\nconst _hoisted_1 = {\n    key: 0,\n    class: \"panel-wrapper world-detail-panel-content\"\n};\nconst _hoisted_2 = { class: \"scroll-container\" };\nconst _hoisted_3 = { class: \"world-section\" };\nconst _hoisted_4 = { class: \"rules-grid\" };\nconst _hoisted_5 = { class: \"rule-item\" };\nconst _hoisted_6 = { class: \"rule-value\" };\nconst _hoisted_7 = { class: \"rule-item\" };\nconst _hoisted_8 = { class: \"rule-value\" };\nconst _hoisted_9 = { class: \"world-section epoch-selection\" };\nconst _hoisted_10 = { class: \"tabs-container main-tabs\" };\nconst _hoisted_11 = [\"innerHTML\"];\nconst _hoisted_12 = { class: \"world-section\" };\nconst _hoisted_13 = { class: \"epoch-header\" };\nconst _hoisted_14 = { class: \"section-title\" };\nconst _hoisted_15 = { class: \"epoch-overview\" };\nconst _hoisted_16 = { class: \"rules-grid\" };\nconst _hoisted_17 = { class: \"rule-item\" };\nconst _hoisted_18 = { class: \"rule-value\" };\nconst _hoisted_19 = { class: \"rule-item\" };\nconst _hoisted_20 = { class: \"rule-value\" };\nconst _hoisted_21 = { class: \"rule-item\" };\nconst _hoisted_22 = { class: \"rule-value\" };\nconst _hoisted_23 = { class: \"rule-item\" };\nconst _hoisted_24 = { class: \"rule-value\" };\nconst _hoisted_25 = { class: \"world-section\" };\nconst _hoisted_26 = { class: \"system-overview\" };\nconst _hoisted_27 = { class: \"subsection\" };\nconst _hoisted_28 = { class: \"ladder-container\" };\nconst _hoisted_29 = { class: \"-ladder\" };\nconst _hoisted_30 = [\"onClick\"];\nconst _hoisted_31 = { class: \"level-energy\" };\nconst _hoisted_32 = { class: \"level-name\" };\nconst _hoisted_33 = {\n    key: 1,\n    class: \"panel-wrapper loading-state\"\n};\nimport { computed, onMounted, ref, watch } from 'vue';\nimport { detailModalService } from '../../services/DetailModalService';\nimport { lorebookService } from '../../services/LorebookService';\nimport { avatarWorld, mainWorld } from '../../store/getters';\nimport RealmDetailCard from '../common/RealmDetailCard.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'WorldDetailsPanel',\n    props: {\n        worldType: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const activeTab = ref('details');\n        const worldSummary = ref('...');\n        const world = computed(() => {\n            return props.worldType === 'mainWorld' ? mainWorld.value : avatarWorld.value;\n        });\n        const availableEpochs = computed(() => {\n            if (!world.value || !world.value..)\n                return [];\n            return Object.values(world.value..).filter(epoch => typeof epoch === 'object' && epoch.ID);\n        });\n        const selectedEpochId = ref(null);\n        onMounted(async () => {\n            const entry = await lorebookService.readFromLorebook('[]');\n            if (entry) {\n                // HTML\n                worldSummary.value = entry\n                    .split('\\n\\n---\\n\\n')\n                    .map(block => `<p>${block.replace(/\\n/g, '<br>')}</p>`)\n                    .join('');\n            }\n            else {\n                worldSummary.value = '';\n            }\n        });\n        watch(world, newWorld => {\n            if (newWorld) {\n                selectedEpochId.value = newWorld...ID || availableEpochs.value[0]?.ID || null;\n            }\n        }, { immediate: true });\n        const activeEpoch = computed(() => {\n            if (!world.value || !selectedEpochId.value)\n                return null;\n            return world.value..[selectedEpochId.value] || null;\n        });\n        const Array = computed(() => {\n            if (!activeEpoch.value?.?.)\n                return [];\n            const definitions = activeEpoch.value..;\n            return Object.keys(definitions)\n                .filter(key => key !== '$meta')\n                .map(key => definitions[key])\n                .sort((a, b) => a. - b.);\n        });\n        const showRealmDetails = (realm) => {\n            if (!realm)\n                return;\n            detailModalService.show(realm., RealmDetailCard, { realm });\n        };\n        return (_ctx, _cache) => {\n            return (world.value && activeEpoch.value)\n                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                    _createElementVNode(\"div\", _hoisted_2, [\n                        _createCommentVNode(\"  \"),\n                        _createElementVNode(\"section\", _hoisted_3, [\n                            _cache[4] || (_cache[4] = _createElementVNode(\"h3\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"div\", _hoisted_4, [\n                                _createElementVNode(\"div\", _hoisted_5, [\n                                    _cache[2] || (_cache[2] = _createElementVNode(\"div\", { class: \"rule-name\" }, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"div\", _hoisted_6, _toDisplayString(world.value...), 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_7, [\n                                    _cache[3] || (_cache[3] = _createElementVNode(\"div\", { class: \"rule-name\" }, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"div\", _hoisted_8, _toDisplayString(world.value...), 1 /* TEXT */)\n                                ])\n                            ])\n                        ]),\n                        _createCommentVNode(\"  \"),\n                        _createElementVNode(\"section\", _hoisted_9, [\n                            _cache[5] || (_cache[5] = _createElementVNode(\"h3\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"div\", _hoisted_10, [\n                                _createElementVNode(\"button\", {\n                                    class: _normalizeClass([\"epoch-tab\", { active: activeTab.value === 'details' }]),\n                                    onClick: _cache[0] || (_cache[0] = ($event) => (activeTab.value = 'details'))\n                                }, \"  \", 2 /* CLASS */),\n                                _createElementVNode(\"button\", {\n                                    class: _normalizeClass([\"epoch-tab\", { active: activeTab.value === 'summary' }]),\n                                    onClick: _cache[1] || (_cache[1] = ($event) => (activeTab.value = 'summary'))\n                                }, \"  \", 2 /* CLASS */)\n                            ])\n                        ]),\n                        (activeTab.value === 'summary')\n                            ? (_openBlock(), _createElementBlock(\"div\", {\n                                key: 0,\n                                class: \"summary-content\",\n                                innerHTML: worldSummary.value\n                            }, null, 8 /* PROPS */, _hoisted_11))\n                            : _createCommentVNode(\"v-if\", true),\n                        (activeTab.value === 'details' && activeEpoch.value)\n                            ? (_openBlock(), _createElementBlock(_Fragment, { key: 1 }, [\n                                _createCommentVNode(\"  \"),\n                                _createElementVNode(\"section\", _hoisted_12, [\n                                    _createElementVNode(\"div\", _hoisted_13, [\n                                        _createElementVNode(\"h3\", _hoisted_14, \": \" + _toDisplayString(activeEpoch.value.), 1 /* TEXT */),\n                                        _createElementVNode(\"p\", _hoisted_15, _toDisplayString(activeEpoch.value.), 1 /* TEXT */)\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_16, [\n                                        _createElementVNode(\"div\", _hoisted_17, [\n                                            _cache[6] || (_cache[6] = _createElementVNode(\"div\", { class: \"rule-name\" }, \"\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_18, _toDisplayString(activeEpoch.value..), 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_19, [\n                                            _cache[7] || (_cache[7] = _createElementVNode(\"div\", { class: \"rule-name\" }, \"\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_20, _toDisplayString(activeEpoch.value..) + \"x\", 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_21, [\n                                            _cache[8] || (_cache[8] = _createElementVNode(\"div\", { class: \"rule-name\" }, \"\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_22, _toDisplayString(activeEpoch.value..) + \"%\", 1 /* TEXT */)\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_23, [\n                                            _cache[9] || (_cache[9] = _createElementVNode(\"div\", { class: \"rule-name\" }, \"\", -1 /* CACHED */)),\n                                            _createElementVNode(\"div\", _hoisted_24, _toDisplayString(activeEpoch.value...), 1 /* TEXT */)\n                                        ])\n                                    ])\n                                ]),\n                                _createCommentVNode(\"  \"),\n                                _createElementVNode(\"section\", _hoisted_25, [\n                                    _cache[11] || (_cache[11] = _createElementVNode(\"h3\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"p\", _hoisted_26, _toDisplayString(activeEpoch.value..), 1 /* TEXT */),\n                                    _createElementVNode(\"div\", _hoisted_27, [\n                                        _cache[10] || (_cache[10] = _createElementVNode(\"h4\", { class: \"subsection-title\" }, \"\", -1 /* CACHED */)),\n                                        _createElementVNode(\"div\", _hoisted_28, [\n                                            _createElementVNode(\"ul\", _hoisted_29, [\n                                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(Array.value, (level) => {\n                                                    return (_openBlock(), _createElementBlock(\"li\", {\n                                                        key: level.,\n                                                        class: \"ladder-step\",\n                                                        onClick: ($event) => (showRealmDetails(level))\n                                                    }, [\n                                                        _createElementVNode(\"span\", _hoisted_31, \" \" + _toDisplayString(level.), 1 /* TEXT */),\n                                                        _createElementVNode(\"span\", _hoisted_32, _toDisplayString(level.), 1 /* TEXT */)\n                                                    ], 8 /* PROPS */, _hoisted_30));\n                                                }), 128 /* KEYED_FRAGMENT */))\n                                            ])\n                                        ])\n                                    ])\n                                ])\n                            ], 64 /* STABLE_FRAGMENT */))\n                            : _createCommentVNode(\"v-if\", true)\n                    ])\n                ]))\n                : (_openBlock(), _createElementBlock(\"div\", _hoisted_33, \"...\"));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./WorldDetailsPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./WorldDetailsPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./WorldDetailsPanel.vue?vue&type=style&index=0&id=7a84edf6&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7a84edf6\"]])\n\nexport default __exports__","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","var x = (y) => {\n\tvar x = {}; __webpack_require__.d(x, y); return x\n} \nvar y = (x) => (() => (x))\nmodule.exports = x({ [\"default\"]: () => (__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_dayjs_esm_c37928cb__[\"default\"]) });","module.exports = Vue;","module.exports = _;","module.exports = toastr;","module.exports = z;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = VueRouter;","import { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, withModifiers as _withModifiers, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveDynamicComponent as _resolveDynamicComponent, normalizeProps as _normalizeProps, guardReactiveProps as _guardReactiveProps, createBlock as _createBlock, normalizeClass as _normalizeClass, renderList as _renderList, Fragment as _Fragment, Transition as _Transition, withCtx as _withCtx } from \"vue\";\nconst _hoisted_1 = { class: \"main-layout\" };\nconst _hoisted_2 = { class: \"modal-content confirmation-modal\" };\nconst _hoisted_3 = { class: \"confirmation-title\" };\nconst _hoisted_4 = { class: \"confirmation-message\" };\nconst _hoisted_5 = { class: \"confirmation-buttons\" };\nconst _hoisted_6 = { class: \"modal-header\" };\nconst _hoisted_7 = { class: \"modal-title\" };\nconst _hoisted_8 = { class: \"modal-body\" };\nconst _hoisted_9 = { class: \"modal-content detail-modal\" };\nconst _hoisted_10 = { class: \"modal-header\" };\nconst _hoisted_11 = { class: \"modal-title\" };\nconst _hoisted_12 = { class: \"modal-body\" };\nconst _hoisted_13 = {\n    key: 4,\n    class: \"modal-overlay input-modal-overlay\"\n};\nconst _hoisted_14 = { class: \"modal-content input-modal-content\" };\nconst _hoisted_15 = { class: \"input-area-container\" };\nconst _hoisted_16 = { class: \"input-area-with-buttons\" };\nconst _hoisted_17 = {\n    key: 1,\n    class: \"command-queue-popup\",\n    style: { \"background-color\": \"#0a0f1e\", \"border\": \"1px solid #d4af37\" }\n};\nconst _hoisted_18 = { class: \"popup-header\" };\nconst _hoisted_19 = { class: \"popup-body\" };\nconst _hoisted_20 = {\n    key: 0,\n    class: \"command-list\"\n};\nconst _hoisted_21 = {\n    key: 1,\n    class: \"empty-queue\"\n};\nconst _hoisted_22 = {\n    key: 0,\n    class: \"popup-footer\"\n};\nconst _hoisted_23 = { class: \"floating-cards-container\" };\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n    const _component_TopStatusBar = _resolveComponent(\"TopStatusBar\");\n    const _component_DockManager = _resolveComponent(\"DockManager\");\n    const _component_LoadingIndicator = _resolveComponent(\"LoadingIndicator\");\n    const _component_NpcListModal = _resolveComponent(\"NpcListModal\");\n    const _component_EnhancedInputBox = _resolveComponent(\"EnhancedInputBox\");\n    const _component_InputHistoryPopup = _resolveComponent(\"InputHistoryPopup\");\n    const _component_NotificationContainer = _resolveComponent(\"NotificationContainer\");\n    const _component_SmartphoneShell = _resolveComponent(\"SmartphoneShell\");\n    const _component_FloatingCard = _resolveComponent(\"FloatingCard\");\n    return (_openBlock(), _createElementBlock(\"div\", {\n        class: _normalizeClass([\"guixu-root-container\", { 'web-fullscreen': _ctx.isWebFullscreen }])\n    }, [\n        _createVNode(_component_TopStatusBar),\n        _createElementVNode(\"div\", _hoisted_1, [\n            _createVNode(_component_DockManager)\n        ]),\n        _createCommentVNode(\" Global Modals \"),\n        (_ctx.confirmation.isVisible)\n            ? (_openBlock(), _createElementBlock(\"div\", {\n                key: 0,\n                class: \"modal-overlay\",\n                onClick: _cache[2] || (_cache[2] = _withModifiers(($event) => (_ctx.confirmationService.hide()), [\"self\"]))\n            }, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"h3\", _hoisted_3, _toDisplayString(_ctx.confirmation.title), 1 /* TEXT */),\n                    _createElementVNode(\"p\", _hoisted_4, _toDisplayString(_ctx.confirmation.message), 1 /* TEXT */),\n                    _createElementVNode(\"div\", _hoisted_5, [\n                        _createElementVNode(\"button\", {\n                            onClick: _cache[0] || (_cache[0] = ($event) => (_ctx.confirmationService.hide()))\n                        }, \"\"),\n                        _createElementVNode(\"button\", {\n                            class: \"primary\",\n                            onClick: _cache[1] || (_cache[1] = ($event) => (_ctx.confirmationService.confirm()))\n                        }, \"\")\n                    ])\n                ])\n            ]))\n            : _createCommentVNode(\"v-if\", true),\n        (_ctx.detailModal.isVisible)\n            ? (_openBlock(), _createElementBlock(\"div\", {\n                key: 1,\n                class: \"modal-overlay\",\n                onClick: _cache[4] || (_cache[4] = _withModifiers(($event) => (_ctx.detailModalService.hide()), [\"self\"]))\n            }, [\n                _createElementVNode(\"div\", {\n                    class: _normalizeClass([\"modal-content detail-modal\", [_ctx.detailModal.props?.modalClass]])\n                }, [\n                    _createElementVNode(\"div\", _hoisted_6, [\n                        _createElementVNode(\"h3\", _hoisted_7, _toDisplayString(_ctx.detailModal.title), 1 /* TEXT */),\n                        _createElementVNode(\"button\", {\n                            class: \"close-button\",\n                            onClick: _cache[3] || (_cache[3] = ($event) => (_ctx.detailModalService.hide()))\n                        }, \"\")\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_8, [\n                        (_openBlock(), _createBlock(_resolveDynamicComponent(_ctx.detailModal.component), _normalizeProps(_guardReactiveProps(_ctx.detailModal.props)), null, 16 /* FULL_PROPS */))\n                    ])\n                ], 2 /* CLASS */)\n            ]))\n            : _createCommentVNode(\"v-if\", true),\n        (_ctx.store.isGenerating)\n            ? (_openBlock(), _createBlock(_component_LoadingIndicator, {\n                key: 2,\n                error: _ctx.store.generationError\n            }, null, 8 /* PROPS */, [\"error\"]))\n            : _createCommentVNode(\"v-if\", true),\n        (_ctx.npcModal.isVisible)\n            ? (_openBlock(), _createElementBlock(\"div\", {\n                key: 3,\n                class: \"modal-overlay\",\n                onClick: _cache[6] || (_cache[6] = _withModifiers(($event) => (_ctx.npcModalService.hide()), [\"self\"]))\n            }, [\n                _createElementVNode(\"div\", _hoisted_9, [\n                    _createElementVNode(\"div\", _hoisted_10, [\n                        _createElementVNode(\"h3\", _hoisted_11, _toDisplayString(_ctx.npcModal.title), 1 /* TEXT */),\n                        _createElementVNode(\"button\", {\n                            class: \"close-button\",\n                            onClick: _cache[5] || (_cache[5] = ($event) => (_ctx.npcModalService.hide()))\n                        }, \"\")\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_12, [\n                        _createVNode(_component_NpcListModal, _normalizeProps(_guardReactiveProps(_ctx.npcModal.props)), null, 16 /* FULL_PROPS */)\n                    ])\n                ])\n            ]))\n            : _createCommentVNode(\"v-if\", true),\n        (_ctx.inputModal.isVisible)\n            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_13, [\n                _createElementVNode(\"div\", _hoisted_14, [\n                    _createElementVNode(\"div\", _hoisted_15, [\n                        _createElementVNode(\"div\", _hoisted_16, [\n                            _createVNode(_component_EnhancedInputBox, {\n                                onSubmitAction: _ctx.handleSubmit,\n                                onToggleHistory: _ctx.toggleHistory\n                            }, null, 8 /* PROPS */, [\"onSubmitAction\", \"onToggleHistory\"])\n                        ]),\n                        (_ctx.isHistoryVisible)\n                            ? (_openBlock(), _createBlock(_component_InputHistoryPopup, {\n                                key: 0,\n                                onClose: _ctx.toggleHistory,\n                                onSelectEntry: _ctx.selectHistoryEntry\n                            }, null, 8 /* PROPS */, [\"onClose\", \"onSelectEntry\"]))\n                            : _createCommentVNode(\"v-if\", true),\n                        (_ctx.isQueueVisible)\n                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_17, [\n                                _createElementVNode(\"div\", _hoisted_18, [\n                                    _cache[10] || (_cache[10] = _createElementVNode(\"h3\", null, \"\", -1 /* CACHED */)),\n                                    _createElementVNode(\"button\", {\n                                        class: \"close-popup-button\",\n                                        onClick: _cache[7] || (_cache[7] =\n                                            //@ts-ignore\n                                            (...args) => (_ctx.toggleCommandQueue && _ctx.toggleCommandQueue(...args)))\n                                    }, \"\")\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_19, [\n                                    (_ctx.commandCount > 0)\n                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_20, [\n                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.commands, (cmd, index) => {\n                                                return (_openBlock(), _createElementBlock(\"div\", {\n                                                    key: index,\n                                                    class: \"command-item\"\n                                                }, _toDisplayString(cmd), 1 /* TEXT */));\n                                            }), 128 /* KEYED_FRAGMENT */))\n                                        ]))\n                                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_21, \"\"))\n                                ]),\n                                (_ctx.commandCount > 0)\n                                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_22, [\n                                        _createElementVNode(\"button\", {\n                                            class: \"clear-button\",\n                                            onClick: _cache[8] || (_cache[8] =\n                                                //@ts-ignore\n                                                (...args) => (_ctx.clearCommands && _ctx.clearCommands(...args)))\n                                        }, \"\")\n                                    ]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ])\n                ])\n            ]))\n            : _createCommentVNode(\"v-if\", true),\n        _createVNode(_component_NotificationContainer),\n        _createCommentVNode(\" Smartphone UI \"),\n        _createVNode(_Transition, { name: \"fade\" }, {\n            default: _withCtx(() => [\n                (_ctx.isSmartphoneOpen)\n                    ? (_openBlock(), _createBlock(_component_SmartphoneShell, {\n                        key: 0,\n                        onCloseSmartphone: _ctx.toggleSmartphone\n                    }, null, 8 /* PROPS */, [\"onCloseSmartphone\"]))\n                    : _createCommentVNode(\"v-if\", true)\n            ]),\n            _: 1 /* STABLE */\n        }),\n        _createCommentVNode(\" Smartphone Toggle Button \"),\n        (!_ctx.isSmartphoneOpen)\n            ? (_openBlock(), _createElementBlock(\"button\", {\n                key: 5,\n                class: \"smartphone-toggle-btn\",\n                onClick: _cache[9] || (_cache[9] =\n                    //@ts-ignore\n                    (...args) => (_ctx.toggleSmartphone && _ctx.toggleSmartphone(...args)))\n            }, [...(_cache[11] || (_cache[11] = [\n                    _createElementVNode(\"i\", { class: \"fas fa-mobile-alt\" }, null, -1 /* CACHED */)\n                ]))]))\n            : _createCommentVNode(\"v-if\", true),\n        _createCommentVNode(\" Floating Active Cards \"),\n        _createElementVNode(\"div\", _hoisted_23, [\n            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.activeCards, (card) => {\n                return (_openBlock(), _createBlock(_component_FloatingCard, {\n                    key: card.ID,\n                    card: card\n                }, null, 8 /* PROPS */, [\"card\"]));\n            }), 128 /* KEYED_FRAGMENT */))\n        ])\n    ], 2 /* CLASS */));\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { withModifiers as _withModifiers, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createVNode as _createVNode, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"floating-card-wrapper\" };\nimport { ref } from 'vue';\nimport DestinyCard from './DestinyCard.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'FloatingCard',\n    props: {\n        card: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const isZoomed = ref(false);\n        const toggleZoom = () => {\n            isZoomed.value = !isZoomed.value;\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n                class: _normalizeClass([\"floating-card-container\", { zoomed: isZoomed.value }])\n            }, [\n                (isZoomed.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 0,\n                        class: \"backdrop\",\n                        onClick: _cache[0] || (_cache[0] = _withModifiers(($event) => (isZoomed.value = false), [\"stop\"]))\n                    }))\n                    : _createCommentVNode(\"v-if\", true),\n                _createElementVNode(\"div\", _hoisted_1, [\n                    _createVNode(DestinyCard, {\n                        card: __props.card,\n                        class: \"the-card\",\n                        onClick: toggleZoom\n                    }, null, 8 /* PROPS */, [\"card\"])\n                ])\n            ], 2 /* CLASS */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./FloatingCard.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./FloatingCard.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./FloatingCard.vue?vue&type=style&index=0&id=161cd48e&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-161cd48e\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode } from \"vue\";\nconst _hoisted_1 = { class: \"action-panel\" };\nconst _hoisted_2 = { class: \"button-container\" };\nconst _hoisted_3 = [\"disabled\", \"onClick\"];\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ActionPanel',\n    props: {\n        commandCount: {},\n        options: {}\n    },\n    emits: ['toggle-history', 'toggle-commands'],\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(__props.options, (option) => {\n                        return (_openBlock(), _createElementBlock(\"button\", {\n                            key: option.id,\n                            class: \"action-button\",\n                            disabled: option.disabled && option.disabled(),\n                            onClick: option.action\n                        }, _toDisplayString(option.text), 9 /* TEXT, PROPS */, _hoisted_3));\n                    }), 128 /* KEYED_FRAGMENT */)),\n                    _createElementVNode(\"button\", {\n                        class: \"action-button\",\n                        onClick: _cache[0] || (_cache[0] = ($event) => (_ctx.$emit('toggle-history')))\n                    }, \"\"),\n                    _createElementVNode(\"button\", {\n                        class: \"action-button\",\n                        onClick: _cache[1] || (_cache[1] = ($event) => (_ctx.$emit('toggle-commands')))\n                    }, \" (\" + _toDisplayString(__props.commandCount) + \")\", 1 /* TEXT */)\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ActionPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ActionPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ActionPanel.vue?vue&type=style&index=0&id=06f56abf&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-06f56abf\"]])\n\nexport default __exports__","type CommandListener = (commands: string[]) => void;\n\nclass CommandService {\n  private commands: string[] = [];\n  private listeners: CommandListener[] = [];\n\n  subscribe(listener: CommandListener) {\n    this.listeners.push(listener);\n  }\n\n  unsubscribe(listener: CommandListener) {\n    this.listeners = this.listeners.filter(l => l !== listener);\n  }\n\n  private notify() {\n    this.listeners.forEach(listener => listener([...this.commands]));\n  }\n\n  addCommand(command: string) {\n    this.commands.push(command);\n    this.notify();\n  }\n\n  getCommands(): string[] {\n    return [...this.commands];\n  }\n\n  clearCommands() {\n    this.commands = [];\n    this.notify();\n  }\n}\n\nexport const commandService = new CommandService();\n","import { reactive } from 'vue';\n\nconst MAX_RECENT_HISTORY = 5;\nconst MAX_SAVED_HISTORY = 5;\nconst STORAGE_KEY_RECENT = 'reincarnation_input_history_recent';\nconst STORAGE_KEY_SAVED = 'reincarnation_input_history_saved';\n\nclass InputHistoryService {\n  public state = reactive({\n    recent: [] as string[],\n    saved: [] as string[],\n  });\n\n  constructor() {\n    this.loadHistory();\n  }\n\n  private loadHistory() {\n    const recentData = localStorage.getItem(STORAGE_KEY_RECENT);\n    const savedData = localStorage.getItem(STORAGE_KEY_SAVED);\n    if (recentData) {\n      this.state.recent = JSON.parse(recentData);\n    }\n    if (savedData) {\n      this.state.saved = JSON.parse(savedData);\n    }\n  }\n\n  private saveHistory() {\n    localStorage.setItem(STORAGE_KEY_RECENT, JSON.stringify(this.state.recent));\n    localStorage.setItem(STORAGE_KEY_SAVED, JSON.stringify(this.state.saved));\n  }\n\n  add(input: string) {\n    if (!input || input.trim() === '') {\n      return;\n    }\n    // Avoid duplicates\n    const existingIndex = this.state.recent.indexOf(input);\n    if (existingIndex > -1) {\n      this.state.recent.splice(existingIndex, 1);\n    }\n\n    this.state.recent.unshift(input);\n    if (this.state.recent.length > MAX_RECENT_HISTORY) {\n      this.state.recent.pop();\n    }\n    this.saveHistory();\n  }\n\n  save(entry: string) {\n    if (this.state.saved.includes(entry)) {\n      return;\n    }\n\n    this.state.saved.unshift(entry);\n    if (this.state.saved.length > MAX_SAVED_HISTORY) {\n      this.state.saved.pop();\n    }\n    this.saveHistory();\n  }\n\n  deleteRecent(index: number) {\n    this.state.recent.splice(index, 1);\n    this.saveHistory();\n  }\n\n  deleteSaved(index: number) {\n    this.state.saved.splice(index, 1);\n    this.saveHistory();\n  }\n\n  clearAll() {\n    this.state.recent = [];\n    this.state.saved = [];\n    this.saveHistory();\n  }\n}\n\nexport const inputHistoryService = new InputHistoryService();\n","import { reactive, readonly } from 'vue';\nimport { store } from '../store';\n\ninterface InputModalState {\n  isVisible: boolean;\n  inputValue: string;\n  lastSubmittedValue: string;\n}\n\nconst STORAGE_KEY = 'reincarnation-simulator-input-value';\nconst LAST_SUBMITTED_STORAGE_KEY = 'reincarnation-simulator-last-submitted';\n\nconst state = reactive<InputModalState>({\n  isVisible: false,\n  inputValue: localStorage.getItem(STORAGE_KEY) || '',\n  lastSubmittedValue: localStorage.getItem(LAST_SUBMITTED_STORAGE_KEY) || '',\n});\n\nconst actions = {\n  show(): void {\n    if (store.generationError) {\n      // \n      state.inputValue = state.lastSubmittedValue;\n    }\n    state.isVisible = true;\n  },\n\n  hide(): void {\n    state.isVisible = false;\n  },\n\n  setValue(value: string): void {\n    state.inputValue = value;\n    localStorage.setItem(STORAGE_KEY, value);\n  },\n\n  setLastSubmittedValue(value: string): void {\n    state.lastSubmittedValue = value;\n    localStorage.setItem(LAST_SUBMITTED_STORAGE_KEY, value);\n  },\n\n  clearValue(): void {\n    state.inputValue = '';\n    localStorage.removeItem(STORAGE_KEY);\n  },\n};\n\nexport const inputModalState = readonly(state);\nexport const inputModalActions = actions;\n","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, withModifiers as _withModifiers, withKeys as _withKeys, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"enhanced-input-box-container\" };\nconst _hoisted_2 = { class: \"input-wrapper\" };\nconst _hoisted_3 = [\"value\", \"placeholder\", \"onKeypress\"];\nimport { computed } from 'vue';\nimport { commandService } from '../../services/CommandService';\nimport { inputHistoryService } from '../../services/InputHistoryService';\nimport { inputModalActions, inputModalState } from '../../services/InputModalService';\nimport { workflowService } from '../../services/WorkflowService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'EnhancedInputBox',\n    props: {\n        placeholder: {\n            type: String,\n            default: '...',\n        },\n    },\n    emits: ['submit-action', 'toggle-history'],\n    setup(__props, { emit: __emit }) {\n        const emit = __emit;\n        const inputValue = computed(() => inputModalState.inputValue);\n        const commands = computed(() => commandService.getCommands());\n        const onInput = (event) => {\n            const target = event.target;\n            inputModalActions.setValue(target.value);\n        };\n        const submitAction = () => {\n            const trimmedInput = inputValue.value.trim();\n            const hasCommands = commands.value.length > 0;\n            if (!trimmedInput && !hasCommands) {\n                return;\n            }\n            if (trimmedInput) {\n                inputHistoryService.add(trimmedInput);\n            }\n            let combinedContent = '';\n            if (hasCommands) {\n                combinedContent += '[]\\n' + commands.value.map(cmd => `- ${cmd}`).join('\\n');\n            }\n            if (trimmedInput) {\n                if (hasCommands) {\n                    combinedContent += '\\n';\n                }\n                combinedContent += `<>\\n${trimmedInput}\\n</>`;\n            }\n            workflowService.switchTo('NORMAL', true);\n            emit('submit-action', combinedContent);\n            commandService.clearCommands();\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"button\", {\n                        class: \"action-button activator\",\n                        onClick: _cache[0] || (_cache[0] = ($event) => (_ctx.$emit('toggle-history')))\n                    }, \"\"),\n                    _createElementVNode(\"textarea\", {\n                        value: inputValue.value,\n                        onInput: onInput,\n                        placeholder: __props.placeholder,\n                        onKeypress: _withKeys(_withModifiers(submitAction, [\"exact\", \"prevent\"]), [\"enter\"])\n                    }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_3),\n                    _createElementVNode(\"button\", {\n                        class: \"action-button primary\",\n                        onClick: submitAction\n                    }, \"\")\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./EnhancedInputBox.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./EnhancedInputBox.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./EnhancedInputBox.vue?vue&type=style&index=0&id=ca7d1390&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-ca7d1390\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = { class: \"input-history-popup\" };\nconst _hoisted_2 = { class: \"history-section\" };\nconst _hoisted_3 = { key: 0 };\nconst _hoisted_4 = [\"onClick\"];\nconst _hoisted_5 = { class: \"actions\" };\nconst _hoisted_6 = [\"onClick\", \"disabled\"];\nconst _hoisted_7 = [\"onClick\"];\nconst _hoisted_8 = {\n    key: 1,\n    class: \"empty-text\"\n};\nconst _hoisted_9 = { class: \"history-section\" };\nconst _hoisted_10 = { key: 0 };\nconst _hoisted_11 = [\"onClick\"];\nconst _hoisted_12 = { class: \"actions\" };\nconst _hoisted_13 = [\"onClick\"];\nconst _hoisted_14 = {\n    key: 1,\n    class: \"empty-text\"\n};\nimport { inputHistoryService } from '../../services/InputHistoryService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'InputHistoryPopup',\n    emits: ['select-entry', 'close'],\n    setup(__props, { emit: __emit }) {\n        const historyState = inputHistoryService.state;\n        const emit = __emit;\n        const useEntry = (entry) => {\n            emit('select-entry', entry);\n        };\n        const saveEntry = (entry) => {\n            inputHistoryService.save(entry);\n        };\n        const deleteRecentEntry = (index) => {\n            inputHistoryService.deleteRecent(index);\n        };\n        const deleteSavedEntry = (index) => {\n            inputHistoryService.deleteSaved(index);\n        };\n        const isSaved = (entry) => {\n            return historyState.saved.includes(entry);\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[1] || (_cache[1] = _createElementVNode(\"h4\", null, \"\", -1 /* CACHED */)),\n                    (_unref(historyState).recent.length > 0)\n                        ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_3, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(historyState).recent, (entry, index) => {\n                                return (_openBlock(), _createElementBlock(\"li\", {\n                                    key: `recent-${index}`\n                                }, [\n                                    _createElementVNode(\"span\", {\n                                        class: \"entry-text\",\n                                        onClick: ($event) => (useEntry(entry))\n                                    }, _toDisplayString(entry), 9 /* TEXT, PROPS */, _hoisted_4),\n                                    _createElementVNode(\"div\", _hoisted_5, [\n                                        _createElementVNode(\"button\", {\n                                            onClick: ($event) => (saveEntry(entry)),\n                                            disabled: isSaved(entry)\n                                        }, \"\", 8 /* PROPS */, _hoisted_6),\n                                        _createElementVNode(\"button\", {\n                                            onClick: ($event) => (deleteRecentEntry(index))\n                                        }, \"\", 8 /* PROPS */, _hoisted_7)\n                                    ])\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"p\", _hoisted_8, \"\"))\n                ]),\n                _createElementVNode(\"div\", _hoisted_9, [\n                    _cache[2] || (_cache[2] = _createElementVNode(\"h4\", null, \"\", -1 /* CACHED */)),\n                    (_unref(historyState).saved.length > 0)\n                        ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_10, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(historyState).saved, (entry, index) => {\n                                return (_openBlock(), _createElementBlock(\"li\", {\n                                    key: `saved-${index}`\n                                }, [\n                                    _createElementVNode(\"span\", {\n                                        class: \"entry-text\",\n                                        onClick: ($event) => (useEntry(entry))\n                                    }, _toDisplayString(entry), 9 /* TEXT, PROPS */, _hoisted_11),\n                                    _createElementVNode(\"div\", _hoisted_12, [\n                                        _createElementVNode(\"button\", {\n                                            onClick: ($event) => (deleteSavedEntry(index))\n                                        }, \"\", 8 /* PROPS */, _hoisted_13)\n                                    ])\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"p\", _hoisted_14, \"\"))\n                ]),\n                _createElementVNode(\"button\", {\n                    onClick: _cache[0] || (_cache[0] = ($event) => (_ctx.$emit('close'))),\n                    class: \"close-button-popup\"\n                }, \"\")\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./InputHistoryPopup.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./InputHistoryPopup.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./InputHistoryPopup.vue?vue&type=style&index=0&id=1f596ce4&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1f596ce4\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, Transition as _Transition, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = { class: \"notification__content\" };\nconst _hoisted_2 = { class: \"notification__title\" };\nconst _hoisted_3 = { class: \"notification__message\" };\nimport { notificationService } from '../../services/NotificationService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'Notification',\n    props: {\n        notification: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const hideNotification = () => {\n            notificationService.hide(props.notification.id);\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createBlock(_Transition, { name: \"notification-fade\" }, {\n                default: _withCtx(() => [\n                    _createElementVNode(\"div\", {\n                        class: _normalizeClass(['notification', `notification--${__props.notification.type}`]),\n                        onClick: hideNotification\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_1, [\n                            _createElementVNode(\"h4\", _hoisted_2, _toDisplayString(__props.notification.title), 1 /* TEXT */),\n                            _createElementVNode(\"p\", _hoisted_3, _toDisplayString(__props.notification.message), 1 /* TEXT */)\n                        ]),\n                        _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"notification__arrow\" }, null, -1 /* CACHED */))\n                    ], 2 /* CLASS */)\n                ]),\n                _: 1 /* STABLE */\n            }));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./Notification.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./Notification.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./Notification.vue?vue&type=style&index=0&id=080f1bc9&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = { class: \"notification-container\" };\nimport { notificationState } from '../../services/NotificationService';\nimport Notification from './Notification.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NotificationContainer',\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(notificationState).notifications, (notification) => {\n                    return (_openBlock(), _createBlock(Notification, {\n                        key: notification.id,\n                        notification: notification\n                    }, null, 8 /* PROPS */, [\"notification\"]));\n                }), 128 /* KEYED_FRAGMENT */))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NotificationContainer.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NotificationContainer.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NotificationContainer.vue?vue&type=style&index=0&id=602ef071&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"icon\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'SideMenuButton',\n    props: {\n        icon: {}\n    },\n    emits: ['open'],\n    setup(__props, { emit: __emit }) {\n        const props = __props;\n        const emit = __emit;\n        const handleClick = (event) => {\n            emit('open', { x: event.clientX, y: event.clientY });\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"button\", {\n                class: \"side-menu-button\",\n                onClick: handleClick\n            }, [\n                _createElementVNode(\"span\", _hoisted_1, _toDisplayString(__props.icon), 1 /* TEXT */)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./SideMenuButton.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./SideMenuButton.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./SideMenuButton.vue?vue&type=style&index=0&id=fa6acc08&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-fa6acc08\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"game-text-container\" };\nconst _hoisted_2 = [\"onClick\"];\nimport { computed } from 'vue';\nimport { npcService } from '../../services/NpcService';\nimport { detailModalService } from '../../services/DetailModalService';\nimport NpcDetailDisplay from './NpcDetailDisplay.vue';\nimport LocationInfoCard from './LocationInfoCard.vue';\nimport DatabaseItemCard from './DatabaseItemCard.vue';\nimport { store } from '../../store';\nimport { mainWorld, avatarWorld } from '../../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'FormattedTextRenderer',\n    props: {\n        text: {\n            type: String,\n            required: true,\n        },\n    },\n    setup(__props) {\n        const props = __props;\n        const npcNamesRegex = computed(() => {\n            const names = npcService.allNpcs.value.map(npc => (Array.isArray(npc.) ? npc.[0] : npc.)).filter(Boolean);\n            if (names.length === 0)\n                return null;\n            const escapedNames = names.map(name => name.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'));\n            return new RegExp(`(${escapedNames.join('|')})`, 'g');\n        });\n        const locationNamesRegex = computed(() => {\n            const names = Array.from(npcService.locationCache.values()).map(loc => loc.name);\n            if (names.length === 0)\n                return null;\n            const escapedNames = names.map(name => name.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'));\n            return new RegExp(`(${escapedNames.join('|')})`, 'g');\n        });\n        const activeWorld = computed(() => (store.activeView === 'mainWorld' ? mainWorld.value : avatarWorld.value));\n        const databaseItemNamesRegex = computed(() => {\n            const database = activeWorld.value?.;\n            if (!database)\n                return null;\n            const names = [];\n            for (const category in database) {\n                if (category === '$meta')\n                    continue;\n                const categoryStore = database[category];\n                if (categoryStore) {\n                    for (const itemId in categoryStore) {\n                        if (itemId === '$meta')\n                            continue;\n                        const item = categoryStore[itemId];\n                        if (item && item.) {\n                            names.push(item.);\n                        }\n                    }\n                }\n            }\n            if (names.length === 0)\n                return null;\n            const escapedNames = names.map(name => name.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'));\n            return new RegExp(`(${escapedNames.join('|')})`, 'g');\n        });\n        const segments = computed(() => {\n            if (!props.text)\n                return [];\n            const cleanText = props.text.replace(/<[^>]*>/g, '');\n            return parseText(cleanText);\n        });\n        function parseText(text) {\n            const segments = [];\n            const regex = /(.*?)|(.*?)|(.*?)|(\\*.*?\\*)/g;\n            let lastIndex = 0;\n            let match;\n            while ((match = regex.exec(text)) !== null) {\n                if (match.index > lastIndex) {\n                    segments.push(...parseEntities(text.substring(lastIndex, match.index)));\n                }\n                const matchedText = match[0];\n                let innerText = '';\n                let outerClass = '';\n                if (match[1]) {\n                    innerText = matchedText.slice(2, -2);\n                    outerClass = 'text-system-highlight';\n                }\n                else if (match[2]) {\n                    innerText = matchedText.slice(1, -1);\n                    outerClass = 'text-scenery';\n                }\n                else if (match[3]) {\n                    innerText = matchedText.slice(1, -1);\n                    outerClass = 'text-dialogue';\n                }\n                else if (match[4]) {\n                    innerText = matchedText.slice(1, -1);\n                    outerClass = 'text-psychology';\n                }\n                const innerSegments = parseEntities(innerText);\n                innerSegments.forEach(segment => {\n                    const combinedClass = Array.isArray(segment.class)\n                        ? [outerClass, ...segment.class]\n                        : [outerClass, segment.class].filter(Boolean);\n                    segments.push({ ...segment, class: combinedClass });\n                });\n                lastIndex = match.index + matchedText.length;\n            }\n            if (lastIndex < text.length) {\n                segments.push(...parseEntities(text.substring(lastIndex)));\n            }\n            return segments;\n        }\n        function parseEntities(text) {\n            const segments = [];\n            const entityRegexParts = [];\n            if (npcNamesRegex.value)\n                entityRegexParts.push(npcNamesRegex.value.source);\n            if (locationNamesRegex.value)\n                entityRegexParts.push(locationNamesRegex.value.source);\n            if (databaseItemNamesRegex.value)\n                entityRegexParts.push(databaseItemNamesRegex.value.source);\n            if (entityRegexParts.length === 0) {\n                return [{ text, class: '' }];\n            }\n            const entityRegex = new RegExp(entityRegexParts.join('|'), 'g');\n            let lastIndex = 0;\n            let match;\n            while ((match = entityRegex.exec(text)) !== null) {\n                if (match.index > lastIndex) {\n                    segments.push({ text: text.substring(lastIndex, match.index), class: '' });\n                }\n                const name = match[0];\n                const npc = npcService.allNpcs.value.find(n => (Array.isArray(n.) ? n.[0] : n.) === name);\n                const locId = [...npcService.locationCache.entries()].find(([id, loc]) => loc.name === name)?.[0];\n                const item = getItemFromDatabase(name);\n                if (npc) {\n                    const relationshipClass = getNpcRelationshipClass(npc);\n                    segments.push({ text: name, class: ['npc-name', relationshipClass], npc });\n                }\n                else if (locId) {\n                    segments.push({ text: name, class: 'location-name', locationId: locId });\n                }\n                else if (item) {\n                    segments.push({ text: name, class: 'database-item-name', item });\n                }\n                else {\n                    segments.push({ text: name, class: '' });\n                }\n                lastIndex = match.index + name.length;\n            }\n            if (lastIndex < text.length) {\n                segments.push({ text: text.substring(lastIndex), class: '' });\n            }\n            return segments;\n        }\n        const showNpcInfo = (npc) => {\n            if (!npc)\n                return;\n            const npcId = npcService.getNpcId(npc);\n            const npcName = Array.isArray(npc.) ? npc.[0] : npc.;\n            detailModalService.show(npcName, NpcDetailDisplay, { npc, npcId });\n        };\n        const showLocationInfo = (locationId) => {\n            if (!locationId)\n                return;\n            const locationName = npcService.getLocationName(locationId);\n            detailModalService.show(locationName, LocationInfoCard, { locationId });\n        };\n        const showDatabaseItemInfo = (item) => {\n            if (!item)\n                return;\n            detailModalService.show(item., DatabaseItemCard, { item });\n        };\n        function getItemFromDatabase(name) {\n            const database = activeWorld.value?.;\n            if (!database)\n                return null;\n            for (const category in database) {\n                if (category === '$meta')\n                    continue;\n                const categoryStore = database[category];\n                if (categoryStore) {\n                    for (const itemId in categoryStore) {\n                        if (itemId === '$meta')\n                            continue;\n                        const item = categoryStore[itemId];\n                        if (item && item. === name) {\n                            return item;\n                        }\n                    }\n                }\n            }\n            return null;\n        }\n        function getNpcRelationshipClass(npc) {\n            const npcId = npcService.getNpcId(npc);\n            const causalNet = activeWorld.value?.;\n            if (!npcId || !causalNet || !causalNet[npcId]?.['']) {\n                return 'npc-unknown';\n            }\n            const relationship = causalNet[npcId][''];\n            const emotionalSum = (relationship.?. || 0) + (relationship.?. || 0);\n            if (emotionalSum <= -150)\n                return 'npc-hostile-intense';\n            if (emotionalSum <= -50)\n                return 'npc-hostile';\n            if (emotionalSum < 0)\n                return 'npc-unfriendly';\n            if (emotionalSum < 50)\n                return 'npc-neutral';\n            if (emotionalSum < 100)\n                return 'npc-friendly';\n            if (emotionalSum < 150)\n                return 'npc-devoted';\n            return 'npc-fanatical';\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(segments.value, (segment, index) => {\n                    return (_openBlock(), _createElementBlock(\"span\", {\n                        key: index,\n                        class: _normalizeClass(segment.class),\n                        onClick: ($event) => (segment.npc\n                            ? showNpcInfo(segment.npc)\n                            : segment.locationId\n                                ? showLocationInfo(segment.locationId)\n                                : segment.item\n                                    ? showDatabaseItemInfo(segment.item)\n                                    : null)\n                    }, _toDisplayString(segment.text), 11 /* TEXT, CLASS, PROPS */, _hoisted_2));\n                }), 128 /* KEYED_FRAGMENT */))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./FormattedTextRenderer.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./FormattedTextRenderer.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./FormattedTextRenderer.vue?vue&type=style&index=0&id=316766ee&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-316766ee\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n    class: \"main-content-wrapper\",\n    ref: \"mainContentWrapper\"\n};\nimport { combinedNarrative } from './store/getters';\nimport FormattedTextRenderer from './components/common/FormattedTextRenderer.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'MainView',\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createVNode(FormattedTextRenderer, { text: _unref(combinedNarrative) }, null, 8 /* PROPS */, [\"text\"])\n            ], 512 /* NEED_PATCH */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./MainView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MainView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MainView.vue?vue&type=style&index=0&id=41e6892e&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, normalizeClass as _normalizeClass, resolveComponent as _resolveComponent, createVNode as _createVNode } from \"vue\";\nconst _hoisted_1 = { class: \"timeline-panel\" };\nconst _hoisted_2 = { class: \"calendar-header\" };\nconst _hoisted_3 = { class: \"panel-title\" };\nconst _hoisted_4 = {\n    key: 0,\n    class: \"calendar-grid\"\n};\nconst _hoisted_5 = [\"onClick\"];\nconst _hoisted_6 = { class: \"day-number\" };\nconst _hoisted_7 = { class: \"events-container\" };\nconst _hoisted_8 = {\n    key: 0,\n    class: \"event-marker\"\n};\nconst _hoisted_9 = {\n    key: 1,\n    class: \"event-marker festival-marker\"\n};\nconst _hoisted_10 = { class: \"details-content\" };\nconst _hoisted_11 = {\n    key: 0,\n    class: \"day-details\"\n};\nconst _hoisted_12 = {\n    key: 0,\n    class: \"detail-section\"\n};\nconst _hoisted_13 = {\n    key: 1,\n    class: \"detail-section\"\n};\nconst _hoisted_14 = { class: \"stage-summary\" };\nconst _hoisted_15 = {\n    key: 1,\n    class: \"no-selection-message\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n    const _component_StorylineStageDetail = _resolveComponent(\"StorylineStageDetail\");\n    return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n        _createElementVNode(\"div\", _hoisted_2, [\n            _createElementVNode(\"button\", {\n                onClick: _cache[0] || (_cache[0] =\n                    //@ts-ignore\n                    (...args) => (_ctx.prevMonth && _ctx.prevMonth(...args)))\n            }, \"<\"),\n            _createElementVNode(\"h2\", _hoisted_3, _toDisplayString(_ctx.currentYear) + \" \" + _toDisplayString(_ctx.currentMonth + 1) + \"\", 1 /* TEXT */),\n            _createElementVNode(\"button\", {\n                onClick: _cache[1] || (_cache[1] =\n                    //@ts-ignore\n                    (...args) => (_ctx.nextMonth && _ctx.nextMonth(...args)))\n            }, \">\")\n        ]),\n        (_ctx.storylines.length > 0)\n            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.weekDays, (dayName) => {\n                    return (_openBlock(), _createElementBlock(\"div\", {\n                        key: dayName,\n                        class: \"day-header\"\n                    }, _toDisplayString(dayName), 1 /* TEXT */));\n                }), 128 /* KEYED_FRAGMENT */)),\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.calendarDays, (day) => {\n                    return (_openBlock(), _createElementBlock(\"div\", {\n                        key: day.date,\n                        class: _normalizeClass([\"day-cell\", { 'other-month': !day.isCurrentMonth, selected: _ctx.selectedDay?.date === day.date }]),\n                        onClick: ($event) => (_ctx.selectDay(day))\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_6, _toDisplayString(day.day), 1 /* TEXT */),\n                        _createElementVNode(\"div\", _hoisted_7, [\n                            (day.events.length > 0)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8))\n                                : _createCommentVNode(\"v-if\", true),\n                            (day.fixedEvents)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9))\n                                : _createCommentVNode(\"v-if\", true)\n                        ])\n                    ], 10 /* CLASS, PROPS */, _hoisted_5));\n                }), 128 /* KEYED_FRAGMENT */))\n            ]))\n            : _createCommentVNode(\"v-if\", true),\n        _createElementVNode(\"div\", {\n            class: _normalizeClass([\"details-drawer\", { 'is-open': _ctx.isDrawerOpen }])\n        }, [\n            _createElementVNode(\"div\", {\n                class: \"drawer-handle\",\n                onClick: _cache[2] || (_cache[2] =\n                    //@ts-ignore\n                    (...args) => (_ctx.toggleDrawer && _ctx.toggleDrawer(...args)))\n            }),\n            _createElementVNode(\"div\", _hoisted_10, [\n                (_ctx.selectedDay && (_ctx.selectedDay.events.length > 0 || _ctx.selectedDay.fixedEvents))\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [\n                        (_ctx.selectedDay.fixedEvents)\n                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_12, [\n                                _cache[3] || (_cache[3] = _createElementVNode(\"h4\", null, \"\", -1 /* CACHED */)),\n                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.selectedDay.fixedEvents, (event, index) => {\n                                    return (_openBlock(), _createElementBlock(\"p\", {\n                                        key: `fixed-${index}`\n                                    }, _toDisplayString(event), 1 /* TEXT */));\n                                }), 128 /* KEYED_FRAGMENT */))\n                            ]))\n                            : _createCommentVNode(\"v-if\", true),\n                        (_ctx.selectedDay.events.length > 0)\n                            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_13, [\n                                _cache[4] || (_cache[4] = _createElementVNode(\"h4\", null, \"\", -1 /* CACHED */)),\n                                _createElementVNode(\"p\", _hoisted_14, _toDisplayString(_ctx.selectedDay.events[0]. || _ctx.selectedDay.events[0].summary || ''), 1 /* TEXT */),\n                                _createVNode(_component_StorylineStageDetail, {\n                                    stage: _ctx.selectedDay.events[0]\n                                }, null, 8 /* PROPS */, [\"stage\"])\n                            ]))\n                            : _createCommentVNode(\"v-if\", true)\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_15, [...(_cache[5] || (_cache[5] = [\n                            _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                        ]))]))\n            ])\n        ], 2 /* CLASS */)\n    ]));\n}\n","import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment } from \"vue\";\nconst _hoisted_1 = { class: \"storyline-stage-detail\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"detail-block\"\n};\nconst _hoisted_3 = {\n    key: 1,\n    class: \"detail-block\"\n};\nconst _hoisted_4 = {\n    key: 2,\n    class: \"detail-block\"\n};\nconst _hoisted_5 = {\n    key: 3,\n    class: \"detail-block\"\n};\nconst _hoisted_6 = {\n    key: 4,\n    class: \"detail-block\"\n};\nconst _hoisted_7 = { class: \"key-points-list\" };\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n    return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n        (_ctx.stage. && _ctx.stage..length > 0)\n            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                _cache[0] || (_cache[0] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                _createElementVNode(\"p\", null, _toDisplayString(_ctx.stage..join(' ')), 1 /* TEXT */)\n            ]))\n            : _createCommentVNode(\"v-if\", true),\n        (_ctx.stage.key_characters || _ctx.stage.)\n            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                _cache[1] || (_cache[1] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                _createElementVNode(\"p\", null, _toDisplayString((_ctx.stage.key_characters || _ctx.stage.)?.join(', ')), 1 /* TEXT */)\n            ]))\n            : _createCommentVNode(\"v-if\", true),\n        (_ctx.stage.key_locations || _ctx.stage.)\n            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [\n                _cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                _createElementVNode(\"p\", null, _toDisplayString((_ctx.stage.key_locations || _ctx.stage.)?.join(', ')), 1 /* TEXT */)\n            ]))\n            : _createCommentVNode(\"v-if\", true),\n        (_ctx.stage.key_items || _ctx.stage.)\n            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n                _cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                _createElementVNode(\"p\", null, _toDisplayString((_ctx.stage.key_items || _ctx.stage.)?.join(', ')), 1 /* TEXT */)\n            ]))\n            : _createCommentVNode(\"v-if\", true),\n        (_ctx.stage. && _ctx.stage..length > 0)\n            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [\n                _cache[4] || (_cache[4] = _createElementVNode(\"strong\", null, \"\", -1 /* CACHED */)),\n                _createElementVNode(\"ul\", _hoisted_7, [\n                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.stage., (point) => {\n                        return (_openBlock(), _createElementBlock(\"li\", {\n                            key: point.id\n                        }, _toDisplayString(point.), 1 /* TEXT */));\n                    }), 128 /* KEYED_FRAGMENT */))\n                ])\n            ]))\n            : _createCommentVNode(\"v-if\", true)\n    ]));\n}\n","import { defineComponent } from 'vue';\nexport default defineComponent({\n    name: 'StorylineStageDetail',\n    props: {\n        stage: {\n            type: Object,\n            required: true,\n        },\n    },\n});\n","/* unplugin-vue-components disabled */import { render } from \"./StorylineStageDetail.vue?vue&type=template&id=55cb78c7&ts=true\"\nimport script from \"./StorylineStageDetail.vue?vue&type=script&lang=ts\"\nexport * from \"./StorylineStageDetail.vue?vue&type=script&lang=ts\"\n\nimport \"./StorylineStageDetail.vue?vue&type=style&index=0&id=55cb78c7&lang=scss\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { computed, defineComponent, onMounted, ref, watch } from 'vue';\nimport { storylineService } from '../../services/StorylineService';\nimport { store } from '../../store';\nimport StorylineStageDetail from '../modals/StorylineStageDetail.vue';\nexport default defineComponent({\n    name: 'TimelinePanel',\n    components: { StorylineStageDetail },\n    setup() {\n        const storylines = ref([]);\n        const fixedEvents = ref({});\n        const currentDate = ref(new Date());\n        const selectedDay = ref(null);\n        const isDrawerOpen = ref(false);\n        const currentYear = computed(() => currentDate.value.getFullYear());\n        const currentMonth = computed(() => currentDate.value.getMonth());\n        const weekDays = ['', '', '', '', '', '', ''];\n        const calendarDays = computed(() => {\n            const days = [];\n            const year = currentYear.value;\n            const month = currentMonth.value;\n            const firstDayOfMonth = new Date(year, month, 1);\n            const lastDayOfMonth = new Date(year, month + 1, 0);\n            const startDayOfWeek = firstDayOfMonth.getDay();\n            const daysInMonth = lastDayOfMonth.getDate();\n            // a. Fill previous month's days\n            const prevMonthLastDay = new Date(year, month, 0).getDate();\n            for (let i = startDayOfWeek - 1; i >= 0; i--) {\n                const day = prevMonthLastDay - i;\n                const date = new Date(year, month - 1, day);\n                days.push({\n                    date: date.toLocaleDateString('sv'), // Use 'sv' locale for YYYY-MM-DD format\n                    day,\n                    isCurrentMonth: false,\n                    events: [],\n                });\n            }\n            // b. Fill current month's days\n            for (let day = 1; day <= daysInMonth; day++) {\n                const date = new Date(year, month, day);\n                const dateString = date.toLocaleDateString('sv');\n                const dayEvents = storylines.value.filter(stage => stage.trigger_time?.date === dateString);\n                const monthDayKey = `${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;\n                days.push({\n                    date: dateString,\n                    day,\n                    isCurrentMonth: true,\n                    events: dayEvents,\n                    fixedEvents: fixedEvents.value[monthDayKey],\n                });\n            }\n            // c. Fill next month's days\n            const lastDayOfWeek = lastDayOfMonth.getDay();\n            const remainingDays = 6 - lastDayOfWeek;\n            for (let i = 1; i <= remainingDays; i++) {\n                const date = new Date(year, month + 1, i);\n                days.push({\n                    date: date.toLocaleDateString('sv'),\n                    day: i,\n                    isCurrentMonth: false,\n                    events: [],\n                });\n            }\n            return days;\n        });\n        const prevMonth = () => {\n            currentDate.value = new Date(currentDate.value.setMonth(currentDate.value.getMonth() - 1));\n        };\n        const nextMonth = () => {\n            currentDate.value = new Date(currentDate.value.setMonth(currentDate.value.getMonth() + 1));\n        };\n        const refresh = async () => {\n            if (store.worldState) {\n                const fetchedStorylines = await storylineService.getAllTimelineStages(store.worldState);\n                storylines.value = fetchedStorylines;\n                fixedEvents.value = await storylineService.getFixedEvents();\n                const upcomingEvents = fetchedStorylines.filter(e => e.status === 'future' || e.status === 'current');\n                if (upcomingEvents.length > 0 &&\n                    upcomingEvents[0].trigger_time?.date &&\n                    upcomingEvents[0].trigger_time.date !== 'N/A') {\n                    const firstEventDate = new Date(upcomingEvents[0].trigger_time.date.replace(/-/g, '/'));\n                    currentDate.value = new Date(firstEventDate.getFullYear(), firstEventDate.getMonth(), 1);\n                }\n                else if (store.worldState...) {\n                    const [year, month, day] = store.worldState....split('-').map(Number);\n                    currentDate.value = new Date(year, month - 1, day);\n                }\n                console.log('TimelinePanel refreshed:', storylines.value);\n            }\n        };\n        const selectDay = (day) => {\n            selectedDay.value = day;\n            if (day.events.length > 0 || day.fixedEvents) {\n                isDrawerOpen.value = true;\n            }\n        };\n        const toggleDrawer = () => {\n            isDrawerOpen.value = !isDrawerOpen.value;\n        };\n        onMounted(refresh);\n        watch(() => store.worldState?.?., (newHistory, oldHistory) => {\n            if (newHistory && oldHistory && newHistory.length !== oldHistory.length) {\n                console.log('History changed, refreshing timeline...');\n                refresh();\n            }\n        }, { deep: true });\n        watch(() => store.worldState, newState => {\n            if (newState) {\n                console.log('worldState became available, refreshing timeline...');\n                refresh();\n            }\n        });\n        return {\n            storylines,\n            refresh,\n            currentYear,\n            currentMonth,\n            calendarDays,\n            weekDays,\n            prevMonth,\n            nextMonth,\n            selectedDay,\n            selectDay,\n            isDrawerOpen,\n            toggleDrawer,\n        };\n    },\n});\n","/* unplugin-vue-components disabled */import { render } from \"./TimelinePanel.vue?vue&type=template&id=5d21d8f0&ts=true\"\nimport script from \"./TimelinePanel.vue?vue&type=script&lang=ts\"\nexport * from \"./TimelinePanel.vue?vue&type=script&lang=ts\"\n\nimport \"./TimelinePanel.vue?vue&type=style&index=0&id=5d21d8f0&lang=scss\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { defineAsyncComponent, type Component } from 'vue';\n\nexport interface PanelInfo {\n  component: Component;\n  title: string;\n}\n\n// \ntype PanelRegistry = Record<string, Record<string, PanelInfo>>;\n\n/**\n * Panel Registry v2.0 -  `-` \n * @description  `mainWorld`, `avatarWorld`, `reincarnation` \n *              \n */\nexport const panelRegistry: PanelRegistry = {\n  // \n  world: {\n    inventory: {\n      component: defineAsyncComponent(() => import('../components/panels/InventoryPanel.vue')),\n      title: '',\n    },\n    skills: {\n      component: defineAsyncComponent(() => import('../components/panels/SkillsPanel.vue')),\n      title: '',\n    },\n    worldDetails: {\n      component: defineAsyncComponent(() => import('../components/panels/WorldDetailsPanel.vue')),\n      title: '',\n    },\n    destiny: {\n      component: defineAsyncComponent(() => import('../components/panels/DestinyCardPanel.vue')),\n      title: '',\n    },\n  },\n  // \n  system: {\n    npcDirectory: {\n      component: defineAsyncComponent(() => import('../components/panels/NpcDirectoryPanel.vue')),\n      title: '',\n    },\n    saveLoad: {\n      component: defineAsyncComponent(() => import('../components/panels/SystemPanel.vue')),\n      title: '',\n    },\n    debug: {\n      component: defineAsyncComponent(() => import('../components/panels/DebugPanel.vue')),\n      title: '',\n    },\n    review: {\n      component: defineAsyncComponent(() => import('../components/panels/ReincarnationPanel.vue')),\n      title: '',\n    },\n  },\n};\n","import { ComponentContainer, GoldenLayout, LayoutConfig } from 'golden-layout';\nimport { Component, defineComponent, h, render } from 'vue';\nimport MainView from '../MainView.vue';\nimport TimelinePanel from '../components/panels/TimelinePanel.vue';\nimport { panelRegistry } from './panelRegistry';\nimport { eventBus } from './EventBus';\n\nclass DockManagerService {\n  private goldenLayout: GoldenLayout | null = null;\n  private hostElement: HTMLElement | null = null;\n  private componentMap: Map<string, Component> = new Map();\n  public onAction: ((action: string) => void) | null = null;\n  initialize(hostElement: HTMLElement) {\n    if (this.goldenLayout || !hostElement) return;\n\n    this.hostElement = hostElement;\n    this.goldenLayout = new GoldenLayout(this.hostElement);\n\n    // Pre-register all possible panel components\n    this.registerComponent('main-view', MainView);\n    this.registerComponent('timeline-panel', TimelinePanel);\n    for (const world in panelRegistry) {\n      for (const panel in panelRegistry[world]) {\n        const componentName = `${world}-${panel}`.toLowerCase();\n        const panelInfo = panelRegistry[world][panel];\n        this.registerComponent(componentName, panelInfo.component);\n      }\n    }\n\n    window.addEventListener('resize', () => this.updateLayout());\n\n    // Layout loading is now handled by LayoutService restoring panels\n    // this.loadSavedLayout();\n  }\n\n  public loadLayout(config: LayoutConfig) {\n    if (!this.goldenLayout) return;\n    try {\n      this.goldenLayout.loadLayout(config);\n    } catch (e) {\n      console.error('Failed to load layout:', e);\n      // Attempt to load default as a fallback\n      try {\n        this.goldenLayout.loadLayout(this.getDefaultLayout());\n      } catch (e2) {\n        console.error('Failed to load default layout on fallback:', e2);\n      }\n    }\n  }\n\n  // This method is no longer needed as LayoutService handles restoration logic.\n  // We keep the method stub in case it's called elsewhere, but it does nothing.\n  loadSavedLayout() {\n    if (!this.goldenLayout) return;\n    // Load a minimal default layout, LayoutService will populate it.\n    this.goldenLayout.loadLayout(this.getDefaultLayout());\n  }\n\n  registerComponent(componentName: string, component: Component) {\n    if (this.componentMap.has(componentName)) {\n      return;\n    }\n    this.componentMap.set(componentName, component);\n\n    this.goldenLayout?.registerComponent(componentName, (container: ComponentContainer, componentState: any) => {\n      const vueComponent = defineComponent({\n        setup: () => () => h(component, componentState?.props || {}),\n      });\n      const vnode = h(vueComponent);\n      render(vnode, container.getElement() as HTMLElement);\n\n      // Directly set the title from the component state\n      if ((componentState as any)?.title) {\n        container.setTitle((componentState as any).title);\n      }\n\n      // Add a destroy listener to notify LayoutService\n      (container as any).on('destroy', () => {\n        const panelId = (componentState as any)?.panelId;\n        if (panelId) {\n          eventBus.emit('panelClosed', panelId);\n        }\n      });\n    });\n  }\n\n  openPanel(panelId: string, title: string, componentName: string, props: Record<string, any> = {}) {\n    if (!this.goldenLayout) {\n      console.error('Golden Layout not initialized.');\n      return;\n    }\n\n    const component = this.componentMap.get(componentName);\n    if (!component) {\n      console.error(`Component \"${componentName}\" is not registered.`);\n      return;\n    }\n\n    this.goldenLayout.addComponent(componentName, { title, props, panelId }, panelId);\n  }\n\n  updateLayout() {\n    if (this.goldenLayout && this.hostElement) {\n      this.goldenLayout.updateSize(this.hostElement.clientWidth, this.hostElement.clientHeight);\n    }\n  }\n\n  closeAllPanels() {\n    if (!this.goldenLayout?.rootItem) return;\n\n    // Create a copy of the array to avoid issues while iterating and removing\n    const closableItems = this.goldenLayout.rootItem.contentItems.filter((item: any) => item.isClosable);\n\n    closableItems.forEach((item: any) => {\n      try {\n        item.remove();\n      } catch (e) {\n        console.error('Failed to remove panel item:', item, e);\n      }\n    });\n  }\n\n  destroy() {\n    if (this.goldenLayout) {\n      this.goldenLayout.destroy();\n      this.goldenLayout = null;\n    }\n    this.componentMap.clear();\n    window.removeEventListener('resize', () => {});\n  }\n\n  unpinAllPanels() {\n    if (!this.goldenLayout) return;\n    // \n    this.goldenLayout.loadLayout(this.getDefaultLayout());\n    //  item  isPinned = false\n  }\n\n  private getDefaultLayout(): LayoutConfig {\n    return {\n      root: {\n        type: 'row',\n        content: [\n          {\n            type: 'component',\n            componentType: 'main-view',\n            title: '',\n            isClosable: false,\n          },\n        ],\n      },\n    };\n  }\n\n  public getFullscreenLayout(): LayoutConfig {\n    return {\n      root: {\n        type: 'row',\n        content: [\n          {\n            type: 'component',\n            componentType: 'main-view',\n            title: '',\n            isClosable: false,\n            width: 100,\n          },\n        ],\n      },\n    };\n  }\n}\n\nexport const dockManagerService = new DockManagerService();\n","import { dockManagerService } from './DockManagerService';\nimport { eventBus } from './EventBus';\nimport { panelRegistry } from './panelRegistry';\n\n/**\n * Panel Manager Hook v2.0 -  `-` \n * @description \n */\nexport function usePanelManager() {\n  const openPanel = (category: keyof typeof panelRegistry, panel: string, props: Record<string, any> = {}) => {\n    const panelInfo = panelRegistry[category]?.[panel];\n\n    if (panelInfo) {\n      //  category  panel ID\n      const panelId = `${category}-${panel}-${props.id || ''}`.toLowerCase();\n      const componentName = `${category}-${panel}`.toLowerCase();\n\n      // \n      dockManagerService.registerComponent(componentName, panelInfo.component);\n\n      // \n      dockManagerService.openPanel(panelId, panelInfo.title, componentName, props);\n\n      // \n      eventBus.emit('panelOpened', { category, panel, props, panelId });\n    } else {\n      console.warn(`[PanelManager] Panel not found for category: ${category}, panel: ${panel}`);\n    }\n  };\n\n  return { openPanel };\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nimport { onMounted, onBeforeUnmount, ref } from 'vue';\nimport { dockManagerService } from '../services/DockManagerService';\nimport { panelRegistry } from '../services/usePanelManager';\nimport MainView from '../MainView.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'DockManager',\n    setup(__props) {\n        const dockHost = ref(null);\n        onMounted(() => {\n            if (dockHost.value) {\n                dockManagerService.initialize(dockHost.value);\n                // Register all components from the panel registry\n                for (const world in panelRegistry) {\n                    for (const panel in panelRegistry[world]) {\n                        const panelInfo = panelRegistry[world][panel];\n                        const componentName = `${world}-${panel}`;\n                        dockManagerService.registerComponent(componentName, panelInfo.component);\n                    }\n                }\n                // Register the main view separately\n                dockManagerService.registerComponent('main-view', MainView);\n                // Load layout (now that all components are registered)\n                dockManagerService.loadSavedLayout();\n            }\n        });\n        onBeforeUnmount(() => {\n            dockManagerService.destroy();\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n                ref_key: \"dockHost\",\n                ref: dockHost,\n                class: \"dock-manager-host\"\n            }, null, 512 /* NEED_PATCH */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./DockManager.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./DockManager.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./DockManager.vue?vue&type=style&index=0&id=0f457032&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeStyle as _normalizeStyle } from \"vue\";\nconst _hoisted_1 = { class: \"loading-overlay\" };\nconst _hoisted_2 = { class: \"loading-content\" };\nconst _hoisted_3 = {\n    key: 0,\n    class: \"error-container\"\n};\nconst _hoisted_4 = { class: \"error-message\" };\nconst _hoisted_5 = { key: 1 };\nconst _hoisted_6 = { class: \"tip\" };\nconst _hoisted_7 = { class: \"progress-bar-container\" };\nimport { onMounted, onUnmounted, ref, watch } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'LoadingIndicator',\n    props: {\n        error: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const tips = [\n            '...',\n            '',\n            '',\n            '',\n            '',\n            'MAX',\n            '',\n            '',\n            '',\n            '',\n            '',\n            '',\n        ];\n        const randomTip = ref('');\n        const progress = ref(0);\n        let progressInterval = null;\n        onMounted(() => {\n            if (!props.error) {\n                startProgress();\n            }\n        });\n        onUnmounted(() => {\n            stopProgress();\n        });\n        watch(() => props.error, newError => {\n            if (newError) {\n                stopProgress();\n            }\n        });\n        function startProgress() {\n            // \n            randomTip.value = tips[Math.floor(Math.random() * tips.length)];\n            // \n            progress.value = 0;\n            progressInterval = window.setInterval(() => {\n                if (progress.value < 99) {\n                    progress.value += 1;\n                }\n                else {\n                    stopProgress();\n                }\n            }, 90000 / 99); // 90 seconds for 99%\n        }\n        function stopProgress() {\n            if (progressInterval) {\n                clearInterval(progressInterval);\n                progressInterval = null;\n            }\n        }\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    (__props.error)\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                            _cache[0] || (_cache[0] = _createElementVNode(\"h3\", { class: \"error-title\" }, \"\", -1 /* CACHED */)),\n                            _createElementVNode(\"p\", _hoisted_4, _toDisplayString(__props.error), 1 /* TEXT */),\n                            _cache[1] || (_cache[1] = _createElementVNode(\"p\", { class: \"error-tip\" }, \"\", -1 /* CACHED */))\n                        ]))\n                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n                            _createElementVNode(\"p\", _hoisted_6, _toDisplayString(randomTip.value), 1 /* TEXT */),\n                            _createElementVNode(\"div\", _hoisted_7, [\n                                _createElementVNode(\"div\", {\n                                    class: \"progress-bar\",\n                                    style: _normalizeStyle({ width: progress.value + '%' })\n                                }, null, 4 /* STYLE */)\n                            ]),\n                            _cache[2] || (_cache[2] = _createElementVNode(\"span\", { class: \"progress-text\" }, \"...\", -1 /* CACHED */))\n                        ]))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./LoadingIndicator.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./LoadingIndicator.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./LoadingIndicator.vue?vue&type=style&index=0&id=2f88c8df&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-2f88c8df\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode } from \"vue\";\nconst _hoisted_1 = { class: \"npc-list-modal-content\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"npc-list-container\"\n};\nconst _hoisted_3 = { class: \"npc-list\" };\nconst _hoisted_4 = { class: \"npc-header\" };\nconst _hoisted_5 = { class: \"npc-name\" };\nconst _hoisted_6 = { class: \"npc-identity\" };\nconst _hoisted_7 = { class: \"npc-description\" };\nconst _hoisted_8 = {\n    key: 1,\n    class: \"no-npcs\"\n};\nimport { computed } from 'vue';\nimport { npcService } from '../../services/NpcService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcListModal',\n    props: {\n        worldId: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const npcs = computed(() => {\n            return npcService.getNpcsByWorld(props.worldId);\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (npcs.value.length > 0)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _createElementVNode(\"ul\", _hoisted_3, [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(npcs.value, (npc) => {\n                                return (_openBlock(), _createElementBlock(\"li\", {\n                                    key: npc.[0],\n                                    class: \"npc-item\"\n                                }, [\n                                    _createElementVNode(\"div\", _hoisted_4, [\n                                        _createElementVNode(\"span\", _hoisted_5, _toDisplayString(npc.[0]), 1 /* TEXT */),\n                                        _createElementVNode(\"span\", _hoisted_6, _toDisplayString(npc..join(', ')), 1 /* TEXT */)\n                                    ]),\n                                    _createElementVNode(\"p\", _hoisted_7, _toDisplayString(npc.), 1 /* TEXT */)\n                                ]));\n                            }), 128 /* KEYED_FRAGMENT */))\n                        ])\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [...(_cache[0] || (_cache[0] = [\n                            _createElementVNode(\"p\", null, \"NPC\", -1 /* CACHED */)\n                        ]))]))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcListModal.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcListModal.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcListModal.vue?vue&type=style&index=0&id=b20458ac&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-b20458ac\"]])\n\nexport default __exports__","import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, resolveComponent as _resolveComponent, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementBlock as _createElementBlock, resolveDynamicComponent as _resolveDynamicComponent, withCtx as _withCtx, Transition as _Transition, createVNode as _createVNode } from \"vue\";\nconst _hoisted_1 = { class: \"smartphone-shell\" };\nconst _hoisted_2 = { class: \"smartphone-screen\" };\nconst _hoisted_3 = { class: \"status-bar\" };\nconst _hoisted_4 = { class: \"time\" };\nconst _hoisted_5 = { class: \"battery-status\" };\nconst _hoisted_6 = { class: \"navigation-bar\" };\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n    const _component_HomeScreen = _resolveComponent(\"HomeScreen\");\n    const _component_AppViewContainer = _resolveComponent(\"AppViewContainer\");\n    return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n        _createElementVNode(\"div\", _hoisted_2, [\n            _createElementVNode(\"div\", _hoisted_3, [\n                _createElementVNode(\"div\", _hoisted_4, _toDisplayString(_ctx.currentTime), 1 /* TEXT */),\n                _createElementVNode(\"div\", _hoisted_5, [\n                    _createElementVNode(\"span\", null, _toDisplayString(_ctx.batteryLevel) + \"%\", 1 /* TEXT */),\n                    _createElementVNode(\"i\", {\n                        class: _normalizeClass([\"fas\", _ctx.batteryIcon])\n                    }, null, 2 /* CLASS */)\n                ])\n            ]),\n            _createVNode(_Transition, {\n                name: \"app-fade\",\n                mode: \"out-in\"\n            }, {\n                default: _withCtx(() => [\n                    (!_ctx.activeAppId)\n                        ? (_openBlock(), _createBlock(_component_HomeScreen, {\n                            key: 0,\n                            onOpenApp: _ctx.openApp\n                        }, null, 8 /* PROPS */, [\"onOpenApp\"]))\n                        : (_openBlock(), _createBlock(_component_AppViewContainer, {\n                            key: 1,\n                            title: _ctx.getAppName(_ctx.activeAppId),\n                            onBack: _ctx.goHome\n                        }, {\n                            \"header-actions\": _withCtx(() => [\n                                (_ctx.activeAppId === 'diary')\n                                    ? (_openBlock(), _createElementBlock(\"button\", {\n                                        key: 0,\n                                        class: \"header-action-btn\",\n                                        onClick: _cache[0] || (_cache[0] = ($event) => (_ctx.isDiaryNavOpen = !_ctx.isDiaryNavOpen))\n                                    }, [...(_cache[4] || (_cache[4] = [\n                                            _createElementVNode(\"i\", { class: \"fas fa-bars\" }, null, -1 /* CACHED */)\n                                        ]))]))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ]),\n                            default: _withCtx(() => [\n                                (_openBlock(), _createBlock(_resolveDynamicComponent(_ctx.activeApp), {\n                                    \"is-diary-nav-open\": _ctx.isDiaryNavOpen,\n                                    onCloseDiaryNav: _cache[1] || (_cache[1] = ($event) => (_ctx.isDiaryNavOpen = false))\n                                }, null, 40 /* PROPS, NEED_HYDRATION */, [\"is-diary-nav-open\"]))\n                            ]),\n                            _: 1 /* STABLE */\n                        }, 8 /* PROPS */, [\"title\", \"onBack\"]))\n                ]),\n                _: 1 /* STABLE */\n            })\n        ]),\n        _createElementVNode(\"div\", _hoisted_6, [\n            _cache[5] || (_cache[5] = _createElementVNode(\"button\", { class: \"nav-btn menu-btn\" }, [\n                _createElementVNode(\"span\", { class: \"bar\" }),\n                _createElementVNode(\"span\", { class: \"bar\" }),\n                _createElementVNode(\"span\", { class: \"bar\" })\n            ], -1 /* CACHED */)),\n            _createElementVNode(\"button\", {\n                class: \"nav-btn home-btn\",\n                onClick: _cache[2] || (_cache[2] = ($event) => (_ctx.$emit('close-smartphone')))\n            }),\n            _createElementVNode(\"button\", {\n                class: \"nav-btn back-btn\",\n                onClick: _cache[3] || (_cache[3] =\n                    //@ts-ignore\n                    (...args) => (_ctx.goHome && _ctx.goHome(...args)))\n            })\n        ])\n    ]));\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeStyle as _normalizeStyle, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"attribute-display\" };\nconst _hoisted_2 = { class: \"attribute-header\" };\nconst _hoisted_3 = { class: \"attribute-name\" };\nconst _hoisted_4 = { class: \"attribute-level\" };\nconst _hoisted_5 = { class: \"xp-bar\" };\nconst _hoisted_6 = { class: \"attribute-details\" };\nimport { computed } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'AttributeDisplay',\n    props: {\n        name: {},\n        value: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const levelXpRequirements = {\n            F: 100,\n            E: 200,\n            D: 300,\n            C: 400,\n            B: 500,\n            A: 600,\n            S: 800,\n            SS: 1000,\n            SSS: Infinity,\n        };\n        const nextLevelXp = computed(() => {\n            return levelXpRequirements[props.value.] || 100;\n        });\n        const xpPercentage = computed(() => {\n            if (nextLevelXp.value === 0)\n                return 0;\n            return Math.min((props.value. / nextLevelXp.value) * 100, 100);\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"span\", _hoisted_3, _toDisplayString(__props.name), 1 /* TEXT */),\n                    _createElementVNode(\"span\", _hoisted_4, _toDisplayString(__props.value.), 1 /* TEXT */)\n                ]),\n                _createElementVNode(\"div\", _hoisted_5, [\n                    _createElementVNode(\"div\", {\n                        class: \"xp-bar-fill\",\n                        style: _normalizeStyle({ width: xpPercentage.value + '%' })\n                    }, null, 4 /* STYLE */)\n                ]),\n                _createElementVNode(\"div\", _hoisted_6, [\n                    _createElementVNode(\"span\", null, \": \" + _toDisplayString(__props.value. >= 0 ? '+' : '') + _toDisplayString(__props.value.), 1 /* TEXT */),\n                    _createElementVNode(\"span\", null, \"XP: \" + _toDisplayString(__props.value.) + \" / \" + _toDisplayString(nextLevelXp.value), 1 /* TEXT */)\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./AttributeDisplay.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AttributeDisplay.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./AttributeDisplay.vue?vue&type=style&index=0&id=4be36c02&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-4be36c02\"]])\n\nexport default __exports__","import { z } from 'zod';\n\n/**\n * @file  - - v2.2 (/NPC, V3, )\n * @description  `.txt`  Zod Schema \n */\n\n// ---  ---\n\nconst  = {\n  : [\n    { name: '', threshold: -Infinity },\n    { name: '', threshold: -500 },\n    { name: '', threshold: -250 },\n    { name: '', threshold: -100 },\n    { name: '', threshold: -20 },\n    { name: '', threshold: 20 },\n    { name: '', threshold: 150 },\n    { name: '', threshold: 400 },\n    { name: '', threshold: 700 },\n    { name: '', threshold: 850 },\n    { name: '', threshold: 1000 },\n  ],\n  : [\n    { name: '', threshold: -Infinity },\n    { name: '', threshold: -100 },\n    { name: '', threshold: -60 },\n    { name: '', threshold: -30 },\n    { name: '', threshold: 40 },\n    { name: '', threshold: 150 },\n    { name: '', threshold: 200 },\n    { name: '', threshold: 300 },\n    { name: '', threshold: 400 },\n    { name: '', threshold: 500 },\n    { name: '', threshold: 700 },\n    { name: '', threshold: 800 },\n  ],\n  : [\n    { name: '', threshold: -Infinity },\n    { name: '', threshold: -500 },\n    { name: '', threshold: -250 },\n    { name: '', threshold: -100 },\n    { name: '', threshold: -20 },\n    { name: '', threshold: 140 },\n    { name: '', threshold: 400 },\n    { name: '', threshold: 550 },\n    { name: '', threshold: 700 },\n    { name: '', threshold: 900 },\n    { name: '', threshold: 1000 },\n  ],\n};\n\nconst  = [\n  { name: '', threshold: 0, : '' },\n  { name: '', threshold: 25, : '' },\n  {\n    name: '',\n    threshold: 50,\n    : '',\n  },\n  { name: '', threshold: 75, : '' },\n  { name: '', threshold: 90, : '' },\n] as const;\n\nexport const  = [\n  { : 'F', : -5, : 100 },\n  { : 'E', : -3, : 200 },\n  { : 'D', : -1, : 300 },\n  { : 'C', : 0, : 400 },\n  { : 'B', : 2, : 500 },\n  { : 'A', : 5, : 600 },\n  { : 'S', : 10, : 800 },\n  { : 'SS', : 15, : 1000 },\n  { : 'SSS', : 20, : Infinity },\n] as const;\n\nexport type  = (typeof )[number][''];\nconst  = z.enum(['F', 'E', 'D', 'C', 'B', 'A', 'S', 'SS', 'SSS']);\n\nconst findStage = (value: number, stages: readonly { name: string; threshold: number }[]) => {\n  let currentStage = stages[0];\n  for (const stage of stages) {\n    if (value >= stage.threshold) {\n      currentStage = stage;\n    } else {\n      break;\n    }\n  }\n  return currentStage.name;\n};\n\n// --- Zod Schema  ---\n\nexport const Schema = z\n  .object({\n    : z\n      .object({\n        : z.coerce.number().default(0),\n        : z.coerce.number().default(0),\n        : z.coerce.number().default(0),\n      })\n      .default({ : 0, : 0, : 0 }),\n    : z\n      .object({\n        : z.string().default(''),\n        : z.string().default(''),\n        : z.string().default(''),\n      })\n      .default({ : '', : '', : '' }),\n    : z.string().default(''),\n    : z\n      .record(\n        z.string().describe('ID'),\n        z\n          .string()\n          .regex(/^\\d{4}-\\d{2}-\\d{2}$/)\n          .describe('YYYY-MM-DD '),\n      )\n      .optional()\n      .default({}),\n  })\n  .default({\n    : { : 0, : 0, : 0 },\n    : { : '', : '', : '' },\n    : '',\n    : {},\n  })\n  .transform(val => {\n    val.. = findStage(val.., .);\n    val.. = findStage(val.., .);\n    val.. = findStage(val.., .);\n    return val;\n  });\n\nexport const Schema = z.object({\n  ID: z.string().default(() => `card_${new Date().getTime()}`),\n  : z.enum(['', '', '', '', '', '', '', '', '']),\n  : .default('F'),\n  : z.string().default(''),\n  : z.string().default(''),\n  : z.string().url().or(z.literal('')).default(''),\n  : z.string().default(''),\n});\n\nexport const Schema = z.object({\n  : z.enum(['', '']),\n  : .default('F'),\n  : z.string().default(''),\n  : z.coerce.number().default(0),\n  : z.coerce.number().default(0),\n  : z.discriminatedUnion('', [\n    z.object({\n      : z.literal(''),\n      : z.string(),\n      : z.enum(['', '', '', '']),\n      : z.coerce.number(),\n      : z.coerce\n        .number()\n        .transform(v => Math.max(0, Math.min(v, 100)))\n        .default(100),\n    }),\n    z.object({\n      : z.literal(''),\n      : z.string(),\n    }),\n  ]),\n});\n\nexport const Schema = z\n  .object({\n    : .default('C'),\n    : z.coerce.number().default(0),\n    : z.coerce.number().default(0),\n  })\n  .transform(val => {\n    const currentLevelInfo = .find(l => l. === val.);\n    if (currentLevelInfo) {\n      val. = currentLevelInfo.;\n      if (val. >= currentLevelInfo. && currentLevelInfo. !== Infinity) {\n        const nextLevelIndex = .findIndex(l => l. === val.) + 1;\n        if (nextLevelIndex < .length) {\n          const nextLevelInfo = [nextLevelIndex];\n          val. = nextLevelInfo.;\n          val. -= currentLevelInfo.;\n          val. = nextLevelInfo.;\n        }\n      }\n    }\n    return val;\n  });\n\nexport const Schema = z.object({\n  : z.string().describe(''),\n  : z.object({\n    : z.string().describe(''),\n    : z\n      .array(\n        z.object({\n          : z.string().describe('ID'),\n          : z.string().describe(''),\n        }),\n      )\n      .optional(),\n  }),\n  : z.array(\n    z.object({\n      : z.string().describe(''),\n      : z.string().describe(''),\n      : z.string().describe(''),\n    }),\n  ),\n  : z.object({\n    : z.array(z.string()),\n    : z.string().optional(),\n    : z.array(z.string()).optional(),\n  }),\n});\n\nexport const Schema = z.object({\n  : z\n    .record(z.string().describe('ID'), z.string().describe(''))\n    .optional(),\n  : z\n    .array(\n      z.object({\n        : z.string().describe(''),\n        : z.string().describe(''),\n        : z.string().describe(''),\n      }),\n    )\n    .optional(),\n});\n\nconst Schema = z.object({\n  : z.string().default(''),\n  : z.array(z.object({ : z.string(), : z.string() })).default([]),\n  : z\n    .object({\n      : z.coerce.date().optional(),\n      : z.coerce.number().default(17),\n      : z.string().default(''),\n      : z.string().default(''),\n      : z.string().default(''),\n      : z.enum(['', '', '']).default(''),\n    })\n    .default({\n      : 17,\n      : '',\n      : '',\n      : '',\n      : '',\n    }),\n  : z.record(z.enum(['', '', '', '', '', '']), Schema).optional(),\n  : z.record(z.string(), Schema).optional(),\n  : z.record(z.string(), z.object({ : z.coerce.number().default(1) })).optional(),\n  : z\n    .array(\n      z.object({\n        : z.string(),\n        : z.string(),\n        : z\n          .object({\n            : z.string(),\n            : z.string(),\n          })\n          .nullable(),\n        : z.string(),\n      }),\n    )\n    .default([]),\n  : z.string().default(''),\n  : z.array(Schema).optional(),\n});\n\nexport const Schema = Schema.extend({});\n\nexport const NpcSchema = Schema.extend({\n  : z\n    .object({\n      : z.coerce\n        .number()\n        .transform(v => Math.max(0, Math.min(v, 100)))\n        .default(80),\n      : z.string().default(''),\n      : z\n        .record(z.enum(['', '', '', '', '']), z.coerce.number())\n        .default({ : 50, : 30, : 10, : 10, : 10 }),\n      : z.array(z.object({ : z.string(), : z.string() })).default([]),\n      NSFW: z\n        .object({\n          phys: z.coerce.number().min(0).max(6).default(0).describe(''),\n          mind: z.coerce.number().min(0).max(5).default(0).describe(''),\n        })\n        .default({ phys: 0, mind: 0 }),\n    })\n    .default({\n      : 80,\n      : '',\n      : { : 50, : 30, : 10, : 10, : 10 },\n      : [],\n      NSFW: { phys: 0, mind: 0 },\n    })\n    .transform((val: any) => {\n      if (val.) val. = findStage(val., );\n      return val;\n    }),\n  : Schema,\n  : Schema,\n  : z\n    .array(\n      z.object({\n        : z.coerce.date(),\n        : z.string(),\n        : z.enum(['', '', '', '', '', '']),\n        : z.string(),\n      }),\n    )\n    .default([]),\n});\n\nexport const Schema = z.object({\n  : z.string(),\n  : z.string(),\n  : z.string(),\n  : z\n    .object({\n      : z.array(z.string()).optional(),\n      : z.array(z.string()).optional(),\n      : z.array(z.string()).optional(),\n      : z.enum(['', '']).optional(),\n    })\n    .optional(),\n});\n\nexport const Schema = z.object({\n  : z.string(),\n  : z.enum(['', '', '', '', '', '']),\n  : z.object({ ID: z.string() }).nullable(),\n  : z.string(),\n  : z.array(Schema).optional(),\n  : z.array(z.string()).optional(),\n});\n\nexport const RootSchema = z.object({\n  : z\n    .object({\n      : z\n        .object({\n          : z\n            .string()\n            .regex(/^\\d{4}-\\d{2}-\\d{2}$/)\n            .default('2012-04-08'),\n          : z.enum(['', '', '', '', '', '', '', '']).default(''),\n          : z.enum(['', '', '', '', '', '', '']).default(''),\n        })\n        .default({ : '2012-04-08', : '', : '' }),\n      : z\n        .object({\n          : z.coerce.number().default(2),\n          : z.coerce.number().default(2),\n        })\n        .default({ : 2, : 2 }),\n      : z.string().default(''),\n      : z.enum(['', '', '', '', '', '', '', '', '']).default(''),\n      : z.enum(['', '', '', '', '', '', '', '', '']).default(''),\n      : z\n        .object({\n          : z.string().default(''),\n          : z.coerce.number().default(1),\n          : z.coerce.number().default(1),\n          : z.string().default(''),\n        })\n        .default({\n          : '',\n          : 1,\n          : 1,\n          : '',\n        }),\n    })\n    .default({\n      : { : '2012-04-08', : '', : '' },\n      : { : 2, : 2 },\n      : '',\n      : '',\n      : '',\n      : { : '', : 1, : 1, : '' },\n    }),\n  : Schema.or(z.literal('')).default(''),\n  : z.record(z.string(), Schema).optional(),\n  : z.record(z.string(), NpcSchema.or(z.literal(''))).default({}),\n  : z.record(z.string(), z.record(z.string(), Schema)).default({}),\n  : z\n    .object({\n      : z\n        .object({\n          : z\n            .string()\n            .regex(/^\\d{4}-\\d{2}-\\d{2}$/)\n            .default('2013-04-08'),\n          : z.enum(['', '', '', '', '', '', '', '']).default(''),\n        })\n        .default({ : '2013-04-08', : '' }),\n    })\n    .default({\n      : { : '2013-04-08', : '' },\n    }),\n  : z\n    .object({\n      : z\n        .record(\n          z.string(),\n          z.object({\n            : z.string(),\n            : z.string(),\n            : z.enum(['', '', '', '']),\n            : z.string(),\n          }),\n        )\n        .default({}),\n      : z.array(z.string()).default([]),\n      : z.string().nullable().default(null),\n    })\n    .default({\n      : {},\n      : [],\n      : null,\n    }),\n});\n\n// --- TypeScript  ---\n\nexport type  = z.infer<typeof Schema>;\nexport type  = z.infer<typeof Schema>;\nexport type  = z.infer<typeof Schema>;\nexport type  = z.infer<typeof Schema>;\nexport type  = z.infer<typeof Schema>;\nexport type  = z.infer<typeof Schema>;\nexport type Npc = z.infer<typeof NpcSchema>;\nexport type  =  | Npc;\nexport type  = z.infer<typeof RootSchema>;\n\n// V4 \nexport interface DiaryEntry {\n  : string;\n  : string;\n  : string;\n  : string;\n  : {\n    : string;\n    : string;\n    : string;\n    : string;\n  }[];\n  : {\n    : string;\n    : string;\n    : string;\n  }[];\n  : string[];\n}\n\nexport interface WeeklyReview {\n  : number;\n  : string;\n  : string;\n  : string;\n  : {\n    MVP: string;\n    : string;\n    : string;\n    : string;\n    : string;\n    : string;\n    : string;\n  };\n  : {\n    : string;\n    : string;\n    : string;\n  };\n  : {\n    : string;\n    : string;\n    : string[];\n  };\n}\n\nexport interface DisplayStoryStage {\n  id: string;\n  title: string;\n  summary: string;\n  arcId: string;\n  arcTitle: string;\n  status: 'completed' | 'current' | 'future';\n  trigger_time: { date: string; segment: string };\n  ?: string[];\n  ?: any[];\n  key_characters?: string[];\n  key_locations?: string[];\n  key_items?: string[];\n}\n\nexport interface DiaryFragment {\n  : number;\n  : string;\n  : string;\n  : string;\n  : string;\n  : string;\n  : string;\n  : string;\n}\n\nexport interface DirectorLog {\n  ID: string;\n  : string;\n  : string;\n  : string;\n  NPC: any[];\n  : string;\n  : string;\n  : any;\n  BBS: any;\n  : any;\n}\n\nexport interface AppState {\n  isReady: boolean;\n  worldState:  | null;\n  userId: string;\n  narrative: string;\n  mainWorldNarrative: string;\n  avatarWorldNarrative: string;\n  activeView: 'mainWorld' | 'avatarWorld' | null;\n  isGenerating: boolean;\n  generationError: string | null;\n  lastSubmittedAction: string | null;\n  lastGeneratedPatch: string | null;\n  diary: DiaryEntry[];\n  diaryFragments: DiaryFragment[];\n  directorLogs: DirectorLog[];\n  weeklyReviews: WeeklyReview[];\n  futureStorylines: DisplayStoryStage[];\n}\n","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, normalizeClass as _normalizeClass, renderList as _renderList, Fragment as _Fragment, createBlock as _createBlock, normalizeStyle as _normalizeStyle, createTextVNode as _createTextVNode, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = { class: \"character-app-container\" };\nconst _hoisted_2 = {\n    key: 0,\n    class: \"character-app\"\n};\nconst _hoisted_3 = { class: \"card character-header\" };\nconst _hoisted_4 = { class: \"avatar\" };\nconst _hoisted_5 = { class: \"character-info\" };\nconst _hoisted_6 = { class: \"character-name\" };\nconst _hoisted_7 = {\n    key: 0,\n    class: \"character-identity\"\n};\nconst _hoisted_8 = { class: \"tabs\" };\nconst _hoisted_9 = { class: \"tab-content\" };\nconst _hoisted_10 = {\n    key: 0,\n    class: \"card status-section\"\n};\nconst _hoisted_11 = {\n    key: 0,\n    class: \"status-list\"\n};\nconst _hoisted_12 = [\"onClick\"];\nconst _hoisted_13 = { class: \"status-duration\" };\nconst _hoisted_14 = {\n    key: 1,\n    class: \"empty-state\"\n};\nconst _hoisted_15 = {\n    key: 1,\n    class: \"card attributes-section\"\n};\nconst _hoisted_16 = { class: \"attributes-grid\" };\nconst _hoisted_17 = {\n    key: 2,\n    class: \"card skills-section\"\n};\nconst _hoisted_18 = {\n    key: 0,\n    class: \"skills-list\"\n};\nconst _hoisted_19 = [\"onClick\"];\nconst _hoisted_20 = { class: \"skill-header\" };\nconst _hoisted_21 = { class: \"skill-name\" };\nconst _hoisted_22 = { class: \"skill-description\" };\nconst _hoisted_23 = {\n    key: 1,\n    class: \"empty-state\"\n};\nconst _hoisted_24 = {\n    key: 1,\n    class: \"loading-pane\"\n};\nconst _hoisted_25 = { class: \"modal-header\" };\nconst _hoisted_26 = { class: \"modal-body\" };\nconst _hoisted_27 = { class: \"modal-header\" };\nconst _hoisted_28 = { class: \"modal-body\" };\nconst _hoisted_29 = { class: \"experience-bar\" };\nconst _hoisted_30 = { class: \"progress-text\" };\nimport { ref, computed } from 'vue';\nimport { store } from '../../store';\nimport AttributeDisplay from '../../components/common/AttributeDisplay.vue';\nimport {  } from '../../types';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'CharacterApp',\n    setup(__props) {\n        const activeTab = ref('status');\n        const selectedStatus = ref(null);\n        const selectedSkill = ref(null);\n        const protagonist = computed(() => {\n            const char = store.worldState?.;\n            if (typeof char === 'object' && char !== null && '' in char) {\n                return char;\n            }\n            return null;\n        });\n        const attributeTranslations = {\n            : '',\n            : '',\n            : '',\n            : '',\n            : '',\n            : '',\n        };\n        const translateAttribute = (key) => {\n            return attributeTranslations[key] || key;\n        };\n        const formatDuration = (duration, full = false) => {\n            if (!duration) {\n                return '';\n            }\n            if (full) {\n                return `${duration.} ${duration.}`;\n            }\n            return ` ${duration.}`;\n        };\n        const getSkillLevelColor = (level) => {\n            switch (level) {\n                case 'S':\n                case 'SS':\n                case 'SSS':\n                    return '#ffd700'; // Gold\n                case 'A':\n                    return '#da70d6'; // Orchid\n                case 'B':\n                    return '#87cefa'; // Light Sky Blue\n                case 'C':\n                    return '#90ee90'; // Light Green\n                default:\n                    return '#a0a0a0'; // Grey\n            }\n        };\n        const getSkillExpCap = (skill) => {\n            const levelInfo = .find(l => l. === skill.);\n            return levelInfo ? levelInfo. : '??';\n        };\n        const getSkillExpPercentage = (skill) => {\n            const cap = getSkillExpCap(skill);\n            if (typeof cap === 'number' && cap > 0) {\n                return (skill. / cap) * 100;\n            }\n            return 0;\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (protagonist.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [\n                        _createElementVNode(\"div\", _hoisted_3, [\n                            _createElementVNode(\"div\", _hoisted_4, [\n                                _createElementVNode(\"span\", null, _toDisplayString(protagonist.value. ? protagonist.value..charAt(0) : '?'), 1 /* TEXT */)\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_5, [\n                                _createElementVNode(\"h2\", _hoisted_6, _toDisplayString(protagonist.value.), 1 /* TEXT */),\n                                (protagonist.value. && protagonist.value..length > 0)\n                                    ? (_openBlock(), _createElementBlock(\"p\", _hoisted_7, _toDisplayString(protagonist.value.[0].) + \" - \" + _toDisplayString(protagonist.value.[0].), 1 /* TEXT */))\n                                    : _createCommentVNode(\"v-if\", true)\n                            ])\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_8, [\n                            _createElementVNode(\"button\", {\n                                onClick: _cache[0] || (_cache[0] = ($event) => (activeTab.value = 'status')),\n                                class: _normalizeClass({ active: activeTab.value === 'status' })\n                            }, \"\", 2 /* CLASS */),\n                            _createElementVNode(\"button\", {\n                                onClick: _cache[1] || (_cache[1] = ($event) => (activeTab.value = 'attributes')),\n                                class: _normalizeClass({ active: activeTab.value === 'attributes' })\n                            }, \"\", 2 /* CLASS */),\n                            _createElementVNode(\"button\", {\n                                onClick: _cache[2] || (_cache[2] = ($event) => (activeTab.value = 'skills')),\n                                class: _normalizeClass({ active: activeTab.value === 'skills' })\n                            }, \"\", 2 /* CLASS */)\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_9, [\n                            (activeTab.value === 'status')\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [\n                                    (protagonist.value. && protagonist.value..length)\n                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [\n                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(protagonist.value., (status, index) => {\n                                                return (_openBlock(), _createElementBlock(\"div\", {\n                                                    key: index,\n                                                    class: \"status-item\",\n                                                    onClick: ($event) => (selectedStatus.value = status)\n                                                }, [\n                                                    _createElementVNode(\"span\", null, _toDisplayString(status.), 1 /* TEXT */),\n                                                    _createElementVNode(\"span\", _hoisted_13, _toDisplayString(formatDuration(status.)), 1 /* TEXT */)\n                                                ], 8 /* PROPS */, _hoisted_12));\n                                            }), 128 /* KEYED_FRAGMENT */))\n                                        ]))\n                                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_14, \"\"))\n                                ]))\n                                : _createCommentVNode(\"v-if\", true),\n                            (activeTab.value === 'attributes')\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_15, [\n                                    _createElementVNode(\"div\", _hoisted_16, [\n                                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(protagonist.value., (attr, key) => {\n                                            return (_openBlock(), _createBlock(AttributeDisplay, {\n                                                key: key,\n                                                name: translateAttribute(key),\n                                                value: attr\n                                            }, null, 8 /* PROPS */, [\"name\", \"value\"]));\n                                        }), 128 /* KEYED_FRAGMENT */))\n                                    ])\n                                ]))\n                                : _createCommentVNode(\"v-if\", true),\n                            (activeTab.value === 'skills')\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_17, [\n                                    (protagonist.value. && Object.keys(protagonist.value.).length)\n                                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_18, [\n                                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(protagonist.value., (skill, key) => {\n                                                return (_openBlock(), _createElementBlock(\"div\", {\n                                                    key: key,\n                                                    class: \"skill-item\",\n                                                    onClick: ($event) => (selectedSkill.value = { name: key, ...skill })\n                                                }, [\n                                                    _createElementVNode(\"div\", _hoisted_20, [\n                                                        _createElementVNode(\"span\", _hoisted_21, _toDisplayString(key), 1 /* TEXT */),\n                                                        _createElementVNode(\"span\", {\n                                                            class: \"skill-level\",\n                                                            style: _normalizeStyle({ color: getSkillLevelColor(skill.) })\n                                                        }, \"Lv. \" + _toDisplayString(skill.), 5 /* TEXT, STYLE */)\n                                                    ]),\n                                                    _createElementVNode(\"p\", _hoisted_22, _toDisplayString(skill.), 1 /* TEXT */)\n                                                ], 8 /* PROPS */, _hoisted_19));\n                                            }), 128 /* KEYED_FRAGMENT */))\n                                        ]))\n                                        : (_openBlock(), _createElementBlock(\"div\", _hoisted_23, \"\"))\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ])\n                    ]))\n                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_24, \"...\")),\n                _createCommentVNode(\" Status Detail Modal \"),\n                (selectedStatus.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 2,\n                        class: \"modal-overlay\",\n                        onClick: _cache[5] || (_cache[5] = ($event) => (selectedStatus.value = null))\n                    }, [\n                        _createElementVNode(\"div\", {\n                            class: \"modal-content\",\n                            onClick: _cache[4] || (_cache[4] = _withModifiers(() => { }, [\"stop\"]))\n                        }, [\n                            _createElementVNode(\"div\", _hoisted_25, [\n                                _createElementVNode(\"h3\", null, _toDisplayString(selectedStatus.value.), 1 /* TEXT */),\n                                _createElementVNode(\"button\", {\n                                    class: \"close-button\",\n                                    onClick: _cache[3] || (_cache[3] = ($event) => (selectedStatus.value = null))\n                                }, \"\")\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_26, [\n                                _createElementVNode(\"p\", null, [\n                                    _cache[9] || (_cache[9] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                    _createTextVNode(\" \" + _toDisplayString(selectedStatus.value.), 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"p\", null, [\n                                    _cache[10] || (_cache[10] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                    _createTextVNode(\" \" + _toDisplayString(selectedStatus.value.), 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"p\", null, [\n                                    _cache[11] || (_cache[11] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                    _createTextVNode(\" \" + _toDisplayString(formatDuration(selectedStatus.value., true)), 1 /* TEXT */)\n                                ])\n                            ])\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                _createCommentVNode(\" Skill Detail Modal \"),\n                (selectedSkill.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 3,\n                        class: \"modal-overlay\",\n                        onClick: _cache[8] || (_cache[8] = ($event) => (selectedSkill.value = null))\n                    }, [\n                        _createElementVNode(\"div\", {\n                            class: \"modal-content\",\n                            onClick: _cache[7] || (_cache[7] = _withModifiers(() => { }, [\"stop\"]))\n                        }, [\n                            _createElementVNode(\"div\", _hoisted_27, [\n                                _createElementVNode(\"h3\", null, _toDisplayString(selectedSkill.value.name), 1 /* TEXT */),\n                                _createElementVNode(\"button\", {\n                                    class: \"close-button\",\n                                    onClick: _cache[6] || (_cache[6] = ($event) => (selectedSkill.value = null))\n                                }, \"\")\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_28, [\n                                _createElementVNode(\"p\", null, [\n                                    _cache[12] || (_cache[12] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                    _createElementVNode(\"span\", {\n                                        style: _normalizeStyle({ color: getSkillLevelColor(selectedSkill.value.) })\n                                    }, \"Lv. \" + _toDisplayString(selectedSkill.value.), 5 /* TEXT, STYLE */)\n                                ]),\n                                _createElementVNode(\"p\", null, [\n                                    _cache[13] || (_cache[13] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                    _createTextVNode(\" \" + _toDisplayString(selectedSkill.value.), 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_29, [\n                                    _createElementVNode(\"div\", {\n                                        class: \"progress-fill\",\n                                        style: _normalizeStyle({ width: `${getSkillExpPercentage(selectedSkill.value)}%` })\n                                    }, null, 4 /* STYLE */),\n                                    _createElementVNode(\"span\", _hoisted_30, \": \" + _toDisplayString(selectedSkill.value.) + \" / \" + _toDisplayString(getSkillExpCap(selectedSkill.value)), 1 /* TEXT */)\n                                ]),\n                                _createElementVNode(\"p\", null, [\n                                    _cache[14] || (_cache[14] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                                    _createTextVNode(\" \" + _toDisplayString(selectedSkill.value.), 1 /* TEXT */)\n                                ])\n                            ])\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./CharacterApp.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CharacterApp.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./CharacterApp.vue?vue&type=style&index=0&id=c70ebe1c&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-c70ebe1c\"]])\n\nexport default __exports__","import { openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, resolveComponent as _resolveComponent, createBlock as _createBlock, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = {\n    key: 0,\n    class: \"arrow\"\n};\nconst _hoisted_2 = { class: \"node-name\" };\nconst _hoisted_3 = {\n    key: 0,\n    class: \"node-details\"\n};\nconst _hoisted_4 = { class: \"description\" };\nconst _hoisted_5 = {\n    key: 0,\n    class: \"characters\"\n};\nconst _hoisted_6 = {\n    key: 1,\n    class: \"children-list\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n    const _component_LocationNode = _resolveComponent(\"LocationNode\", true);\n    return (_openBlock(), _createElementBlock(\"li\", {\n        class: _normalizeClass([\"location-node\", { expanded: _ctx.isExpanded }])\n    }, [\n        _createElementVNode(\"div\", {\n            class: \"node-content\",\n            onClick: _cache[0] || (_cache[0] =\n                //@ts-ignore\n                (...args) => (_ctx.toggle && _ctx.toggle(...args)))\n        }, [\n            (_ctx.hasChildren)\n                ? (_openBlock(), _createElementBlock(\"span\", _hoisted_1, \"\"))\n                : _createCommentVNode(\"v-if\", true),\n            _createElementVNode(\"span\", _hoisted_2, _toDisplayString(_ctx.location.), 1 /* TEXT */)\n        ]),\n        (_ctx.isExpanded)\n            ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [\n                _createElementVNode(\"p\", _hoisted_4, _toDisplayString(_ctx.location.), 1 /* TEXT */),\n                (_ctx.charactersHere.length)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n                        _cache[1] || (_cache[1] = _createElementVNode(\"strong\", null, \":\", -1 /* CACHED */)),\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.charactersHere, (char) => {\n                            return (_openBlock(), _createElementBlock(\"span\", {\n                                key: char.,\n                                class: \"character-tag\"\n                            }, _toDisplayString(char.), 1 /* TEXT */));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]))\n                    : _createCommentVNode(\"v-if\", true),\n                (_ctx.hasChildren)\n                    ? (_openBlock(), _createElementBlock(\"ul\", _hoisted_6, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.location.children, (child) => {\n                            return (_openBlock(), _createBlock(_component_LocationNode, {\n                                key: child.id,\n                                location: child,\n                                \"all-locations\": _ctx.allLocations,\n                                \"characters-by-location\": _ctx.charactersByLocation\n                            }, null, 8 /* PROPS */, [\"location\", \"all-locations\", \"characters-by-location\"]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ]))\n                    : _createCommentVNode(\"v-if\", true)\n            ]))\n            : _createCommentVNode(\"v-if\", true)\n    ], 2 /* CLASS */));\n}\n","import { defineComponent, ref, computed } from 'vue';\nexport default defineComponent({\n    name: 'LocationNode',\n    props: {\n        location: {\n            type: Object,\n            required: true,\n        },\n        allLocations: {\n            type: Object,\n            required: true,\n        },\n        charactersByLocation: {\n            type: Object,\n            required: true,\n        },\n    },\n    setup(props) {\n        const isExpanded = ref(false);\n        const hasChildren = computed(() => props.location.children && props.location.children.length > 0);\n        const charactersHere = computed(() => {\n            return props.charactersByLocation[props.location.id] || [];\n        });\n        const toggle = () => {\n            isExpanded.value = !isExpanded.value;\n        };\n        return {\n            isExpanded,\n            toggle,\n            hasChildren,\n            charactersHere,\n        };\n    },\n});\n","/* unplugin-vue-components disabled */import { render } from \"./LocationNode.vue?vue&type=template&id=67766190&scoped=true&ts=true\"\nimport script from \"./LocationNode.vue?vue&type=script&lang=ts\"\nexport * from \"./LocationNode.vue?vue&type=script&lang=ts\"\n\nimport \"./LocationNode.vue?vue&type=style&index=0&id=67766190&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-67766190\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createBlock as _createBlock, createElementVNode as _createElementVNode } from \"vue\";\nconst _hoisted_1 = { class: \"map-app\" };\nconst _hoisted_2 = { class: \"location-tree\" };\nimport { computed } from 'vue';\nimport { get } from 'lodash';\nimport { store } from '../../store';\nimport LocationNode from './map/LocationNode.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'MapApp',\n    setup(__props) {\n        const locations = computed(() => get(store.worldState, '', {}));\n        const characters = computed(() => get(store.worldState, '', {}));\n        const charactersByLocation = computed(() => {\n            const map = {};\n            for (const charId in characters.value) {\n                const char = characters.value[charId];\n                if (typeof char === 'object' && char !== null && char.) {\n                    if (!map[char.]) {\n                        map[char.] = [];\n                    }\n                    map[char.].push(char);\n                }\n            }\n            return map;\n        });\n        const locationTree = computed(() => {\n            const locationsValue = locations.value;\n            const roots = [];\n            const childrenOf = {};\n            for (const id in locationsValue) {\n                const location = { ...locationsValue[id], id, children: [] };\n                if (location. && location..ID) {\n                    if (!childrenOf[location..ID]) {\n                        childrenOf[location..ID] = [];\n                    }\n                    childrenOf[location..ID].push(location);\n                }\n                else {\n                    roots.push(location);\n                }\n            }\n            const buildTree = (nodes) => {\n                return nodes.map(node => ({\n                    ...node,\n                    children: childrenOf[node.id] ? buildTree(childrenOf[node.id]) : [],\n                }));\n            };\n            return buildTree(roots);\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"ul\", _hoisted_2, [\n                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(locationTree.value, (location) => {\n                        return (_openBlock(), _createBlock(LocationNode, {\n                            key: location.id,\n                            location: location,\n                            \"all-locations\": locations.value,\n                            \"characters-by-location\": charactersByLocation.value\n                        }, null, 8 /* PROPS */, [\"location\", \"all-locations\", \"characters-by-location\"]));\n                    }), 128 /* KEYED_FRAGMENT */))\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./MapApp.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MapApp.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MapApp.vue?vue&type=style&index=0&id=de092378&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-de092378\"]])\n\nexport default __exports__","import { ref } from 'vue';\nimport { lorebookService } from './LorebookService';\n\nexport interface BbsPost {\n  id: string;\n  title: string;\n  author: string;\n  content: string;\n}\n\nexport interface WeeklyReview {\n  : string;\n  : string;\n  : string;\n  : string;\n}\n\nclass ForumService {\n  public posts = ref<BbsPost[]>([]);\n  public reviews = ref<WeeklyReview[]>([]);\n\n  private lastBbsLogContent = '';\n  private lastReviewLogContent = '';\n  private pollingInterval: any = null;\n\n  constructor() {\n    this.startPolling();\n  }\n\n  public startPolling(interval = 5000) {\n    if (this.pollingInterval) {\n      clearInterval(this.pollingInterval);\n    }\n    this.pollingInterval = setInterval(() => {\n      this.fetchBbsPostsFromLorebook();\n      this.fetchWeeklyReviewsFromLorebook();\n    }, interval);\n  }\n\n  public stopPolling() {\n    if (this.pollingInterval) {\n      clearInterval(this.pollingInterval);\n      this.pollingInterval = null;\n    }\n  }\n\n  private async fetchBbsPostsFromLorebook() {\n    try {\n      const currentLogContent = await lorebookService.readFromLorebook('', true);\n      if (currentLogContent && currentLogContent !== this.lastBbsLogContent) {\n        this.lastBbsLogContent = currentLogContent;\n        this.parseDirectorLogForBbs(currentLogContent);\n      }\n    } catch (error) {\n      // console.error('[Forum Service] Error fetching BBS logs:', error);\n    }\n  }\n\n  private async fetchWeeklyReviewsFromLorebook() {\n    try {\n      const currentLogContent = await lorebookService.readFromLorebook('', true);\n      if (currentLogContent && currentLogContent !== this.lastReviewLogContent) {\n        this.lastReviewLogContent = currentLogContent;\n        this.parseWeeklyReviews(currentLogContent);\n      }\n    } catch (error) {\n      // console.error('[Forum Service] Error fetching Weekly Reviews:', error);\n    }\n  }\n\n  private parseDirectorLogForBbs(logContent: string) {\n    const allPosts: BbsPost[] = [];\n    const logs = logContent.split('---'); // Split by the main separator\n    logs.forEach((log, index) => {\n      const scriptIdMatch = log.match(/ID\\|(\\S+)/);\n      const scriptId = scriptIdMatch ? scriptIdMatch[1] : `log-${index}`;\n\n      if (log.includes('BBS')) {\n        const bbsSection = log.split('BBS')[1];\n        const postMatches = bbsSection.match(/- : \"(.*?)\"\\s*: (.*?)\\s*: \"(.*?)\"/g);\n        if (postMatches) {\n          postMatches.forEach(match => {\n            const postMatch = /- : \"(.*?)\"\\s*: (.*?)\\s*: \"(.*?)\"/.exec(match);\n            if (postMatch) {\n              allPosts.push({\n                id: `${scriptId}-${postMatch[1]}`,\n                title: postMatch[1],\n                author: postMatch[2],\n                content: postMatch[3],\n              });\n            }\n          });\n        }\n      }\n    });\n    this.posts.value = allPosts.reverse();\n  }\n\n  private parseWeeklyReviews(logContent: string) {\n    const allReviews: WeeklyReview[] = [];\n    const reviewsText = logContent.split('<>').slice(1);\n    reviewsText.forEach(reviewText => {\n      const kHMatch = reviewText.match(/\\|(.*?)\\n/);\n      const fXrqMatch = reviewText.match(/\\|(.*?)\\n/);\n      const bZttMatch = reviewText.match(/\\|(.*?)\\n/);\n      const yZRdZjMatch = reviewText.match(/\\n([\\s\\S]*?)\\n---/);\n\n      if (kHMatch && fXrqMatch && bZttMatch && yZRdZjMatch) {\n        allReviews.push({\n          : kHMatch[1],\n          : fXrqMatch[1],\n          : bZttMatch[1],\n          : yZRdZjMatch[1].trim(),\n        });\n      }\n    });\n    this.reviews.value = allReviews.reverse();\n  }\n}\n\nexport const forumService = new ForumService();\n","import { defineComponent as _defineComponent } from 'vue';\nimport { normalizeClass as _normalizeClass, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = { class: \"forum-panel\" };\nconst _hoisted_2 = { class: \"tabs\" };\nconst _hoisted_3 = { class: \"tab-content\" };\nconst _hoisted_4 = {\n    key: 0,\n    class: \"bbs-view\"\n};\nconst _hoisted_5 = {\n    key: 0,\n    class: \"post-list\"\n};\nconst _hoisted_6 = { class: \"post-title\" };\nconst _hoisted_7 = { class: \"post-content\" };\nconst _hoisted_8 = { class: \"post-meta\" };\nconst _hoisted_9 = {\n    key: 1,\n    class: \"empty-state\"\n};\nconst _hoisted_10 = {\n    key: 1,\n    class: \"weekly-review-view\"\n};\nconst _hoisted_11 = {\n    key: 0,\n    class: \"review-list\"\n};\nconst _hoisted_12 = { class: \"review-title\" };\nconst _hoisted_13 = { class: \"review-meta\" };\nconst _hoisted_14 = { class: \"review-content\" };\nconst _hoisted_15 = {\n    key: 1,\n    class: \"empty-state\"\n};\nimport { ref, computed } from 'vue';\nimport { forumService } from '../../services/ForumService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ForumPanel',\n    setup(__props) {\n        const activeTab = ref('bbs');\n        const posts = computed(() => forumService.posts.value);\n        const reviews = computed(() => forumService.reviews.value);\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass({ active: activeTab.value === 'bbs' }),\n                        onClick: _cache[0] || (_cache[0] = ($event) => (activeTab.value = 'bbs'))\n                    }, \"BBS\", 2 /* CLASS */),\n                    _createElementVNode(\"button\", {\n                        class: _normalizeClass({ active: activeTab.value === 'weekly' }),\n                        onClick: _cache[1] || (_cache[1] = ($event) => (activeTab.value = 'weekly'))\n                    }, \"\", 2 /* CLASS */)\n                ]),\n                _createElementVNode(\"div\", _hoisted_3, [\n                    (activeTab.value === 'bbs')\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [\n                            (posts.value.length > 0)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(posts.value, (post, index) => {\n                                        return (_openBlock(), _createElementBlock(\"div\", {\n                                            key: index,\n                                            class: \"post-item\"\n                                        }, [\n                                            _createElementVNode(\"h5\", _hoisted_6, _toDisplayString(post.title), 1 /* TEXT */),\n                                            _createElementVNode(\"p\", _hoisted_7, _toDisplayString(post.content), 1 /* TEXT */),\n                                            _createElementVNode(\"div\", _hoisted_8, [\n                                                _createElementVNode(\"span\", null, \": \" + _toDisplayString(post.author), 1 /* TEXT */)\n                                            ])\n                                        ]));\n                                    }), 128 /* KEYED_FRAGMENT */))\n                                ]))\n                                : (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [...(_cache[2] || (_cache[2] = [\n                                        _createElementVNode(\"p\", null, \"BBS\", -1 /* CACHED */)\n                                    ]))]))\n                        ]))\n                        : _createCommentVNode(\"v-if\", true),\n                    (activeTab.value === 'weekly')\n                        ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [\n                            (reviews.value.length > 0)\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [\n                                    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(reviews.value, (review) => {\n                                        return (_openBlock(), _createElementBlock(\"div\", {\n                                            key: review.,\n                                            class: \"review-item\"\n                                        }, [\n                                            _createElementVNode(\"h4\", _hoisted_12, _toDisplayString(review.), 1 /* TEXT */),\n                                            _createElementVNode(\"div\", _hoisted_13, [\n                                                _createElementVNode(\"span\", null, \"\" + _toDisplayString(review.) + \" | \" + _toDisplayString(review.), 1 /* TEXT */)\n                                            ]),\n                                            _createElementVNode(\"p\", _hoisted_14, _toDisplayString(review.), 1 /* TEXT */)\n                                        ]));\n                                    }), 128 /* KEYED_FRAGMENT */))\n                                ]))\n                                : (_openBlock(), _createElementBlock(\"div\", _hoisted_15, [...(_cache[3] || (_cache[3] = [\n                                        _createElementVNode(\"p\", null, \"\", -1 /* CACHED */)\n                                    ]))]))\n                        ]))\n                        : _createCommentVNode(\"v-if\", true)\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ForumPanel.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ForumPanel.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ForumPanel.vue?vue&type=style&index=0&id=573a9fa6&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-573a9fa6\"]])\n\nexport default __exports__","import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, renderSlot as _renderSlot, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"app-view-container\" };\nconst _hoisted_2 = { class: \"app-header\" };\nconst _hoisted_3 = { class: \"app-title\" };\nconst _hoisted_4 = { class: \"header-actions\" };\nconst _hoisted_5 = { class: \"app-content\" };\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n    return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n        _createElementVNode(\"div\", _hoisted_2, [\n            _createElementVNode(\"button\", {\n                class: \"back-btn\",\n                onClick: _cache[0] || (_cache[0] = ($event) => (_ctx.$emit('back')))\n            }, [...(_cache[1] || (_cache[1] = [\n                    _createElementVNode(\"i\", { class: \"fas fa-chevron-left\" }, null, -1 /* CACHED */)\n                ]))]),\n            _createElementVNode(\"h3\", _hoisted_3, _toDisplayString(_ctx.title), 1 /* TEXT */),\n            _createElementVNode(\"div\", _hoisted_4, [\n                _renderSlot(_ctx.$slots, \"header-actions\", {}, undefined, true)\n            ])\n        ]),\n        _createElementVNode(\"div\", _hoisted_5, [\n            _renderSlot(_ctx.$slots, \"default\", {}, undefined, true)\n        ])\n    ]));\n}\n","import { defineComponent } from 'vue';\nexport default defineComponent({\n    name: 'AppViewContainer',\n    props: {\n        title: {\n            type: String,\n            required: true,\n        },\n    },\n    emits: ['back'],\n});\n","/* unplugin-vue-components disabled */import { render } from \"./AppViewContainer.vue?vue&type=template&id=2cf8f05c&scoped=true&ts=true\"\nimport script from \"./AppViewContainer.vue?vue&type=script&lang=ts\"\nexport * from \"./AppViewContainer.vue?vue&type=script&lang=ts\"\n\nimport \"./AppViewContainer.vue?vue&type=style&index=0&id=2cf8f05c&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-2cf8f05c\"]])\n\nexport default __exports__","import { normalizeStyle as _normalizeStyle, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = { class: \"home-screen\" };\nconst _hoisted_2 = { class: \"content-overlay\" };\nconst _hoisted_3 = { class: \"header-info\" };\nconst _hoisted_4 = { class: \"date\" };\nconst _hoisted_5 = { class: \"time\" };\nconst _hoisted_6 = { class: \"location-weather-widget\" };\nconst _hoisted_7 = { class: \"app-grid\" };\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n    const _component_AppIcon = _resolveComponent(\"AppIcon\");\n    return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n        _createElementVNode(\"div\", {\n            class: \"wallpaper-background\",\n            style: _normalizeStyle(_ctx.wallpaperStyle)\n        }, null, 4 /* STYLE */),\n        _createElementVNode(\"div\", _hoisted_2, [\n            _createElementVNode(\"div\", _hoisted_3, [\n                _createElementVNode(\"div\", _hoisted_4, _toDisplayString(_ctx.formattedDate), 1 /* TEXT */),\n                _createElementVNode(\"div\", _hoisted_5, _toDisplayString(_ctx.worldTime), 1 /* TEXT */),\n                _createElementVNode(\"div\", _hoisted_6, [\n                    _createElementVNode(\"span\", null, [\n                        _cache[0] || (_cache[0] = _createElementVNode(\"i\", { class: \"fas fa-map-marker-alt\" }, null, -1 /* CACHED */)),\n                        _createTextVNode(\" \" + _toDisplayString(_ctx.currentLocation), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"span\", null, [\n                        _cache[1] || (_cache[1] = _createElementVNode(\"i\", { class: \"fas fa-cloud-sun\" }, null, -1 /* CACHED */)),\n                        _createTextVNode(\" \" + _toDisplayString(_ctx.currentWeather) + \"  \" + _toDisplayString(_ctx.futureWeather), 1 /* TEXT */)\n                    ])\n                ])\n            ]),\n            _createElementVNode(\"div\", _hoisted_7, [\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.apps, (app) => {\n                    return (_openBlock(), _createBlock(_component_AppIcon, {\n                        key: app.id,\n                        \"icon-class\": app.icon,\n                        name: app.name,\n                        onClick: ($event) => (_ctx.$emit('open-app', app.id))\n                    }, null, 8 /* PROPS */, [\"icon-class\", \"name\", \"onClick\"]));\n                }), 128 /* KEYED_FRAGMENT */))\n            ])\n        ])\n    ]));\n}\n","import { reactive, ref } from 'vue';\nimport { lorebookService } from './LorebookService';\n\nconst LOREBOOK_ENTRY_NAME = '';\n\nclass SmartphoneService {\n  private state = reactive({\n    wallpaperContent: '',\n    isLoading: false,\n    error: null as string | null,\n  });\n\n  public readonly wallpaperContent = ref('');\n\n  async fetchWallpaperContent() {\n    this.state.isLoading = true;\n    this.state.error = null;\n    try {\n      let content = await lorebookService.readFromLorebook(LOREBOOK_ENTRY_NAME, true);\n      // URLBBCode\n      if (content) {\n        content = content.replace(/\\[\\/?img\\]/g, '').trim();\n      }\n      this.wallpaperContent.value = content || '';\n      this.state.wallpaperContent = content || '';\n    } catch (e: any) {\n      this.state.error = e.message || 'Failed to fetch wallpaper content.';\n      console.error(this.state.error);\n      this.wallpaperContent.value = ''; // Fallback content\n    } finally {\n      this.state.isLoading = false;\n    }\n  }\n\n  getState() {\n    return this.state;\n  }\n}\n\nexport const smartphoneService = new SmartphoneService();\n","import { normalizeClass as _normalizeClass, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"icon-visual\" };\nconst _hoisted_2 = { class: \"app-name\" };\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n    return (_openBlock(), _createElementBlock(\"div\", {\n        class: \"app-icon\",\n        onClick: _cache[0] || (_cache[0] = ($event) => (_ctx.$emit('click')))\n    }, [\n        _createElementVNode(\"div\", _hoisted_1, [\n            _createElementVNode(\"i\", {\n                class: _normalizeClass(_ctx.iconClass)\n            }, null, 2 /* CLASS */)\n        ]),\n        _createElementVNode(\"span\", _hoisted_2, _toDisplayString(_ctx.name), 1 /* TEXT */)\n    ]));\n}\n","import { defineComponent } from 'vue';\nexport default defineComponent({\n    name: 'AppIcon',\n    props: {\n        iconClass: {\n            type: String,\n            required: true,\n        },\n        name: {\n            type: String,\n            required: true,\n        },\n    },\n    emits: ['click'],\n});\n","/* unplugin-vue-components disabled */import { render } from \"./AppIcon.vue?vue&type=template&id=43ed2323&scoped=true&ts=true\"\nimport script from \"./AppIcon.vue?vue&type=script&lang=ts\"\nexport * from \"./AppIcon.vue?vue&type=script&lang=ts\"\n\nimport \"./AppIcon.vue?vue&type=style&index=0&id=43ed2323&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-43ed2323\"]])\n\nexport default __exports__","import { computed, defineComponent, onMounted, ref } from 'vue';\nimport { npcService } from '../../services/NpcService';\nimport { smartphoneService } from '../../services/SmartphoneService';\nimport { store } from '../../store';\nimport AppIcon from './AppIcon.vue';\nexport default defineComponent({\n    name: 'HomeScreen',\n    components: { AppIcon },\n    emits: ['open-app'],\n    setup() {\n        const wallpaper = smartphoneService.wallpaperContent;\n        onMounted(() => {\n            smartphoneService.fetchWallpaperContent();\n        });\n        const isWallpaperUrl = computed(() => {\n            return wallpaper.value && (wallpaper.value.startsWith('http') || wallpaper.value.startsWith('/'));\n        });\n        const wallpaperStyle = computed(() => {\n            if (isWallpaperUrl.value) {\n                return {\n                    backgroundImage: `url(${wallpaper.value})`,\n                    backgroundSize: 'cover',\n                    backgroundPosition: 'center',\n                    backgroundRepeat: 'no-repeat',\n                };\n            }\n            return {};\n        });\n        const apps = ref([\n            { id: 'contacts', name: '', icon: 'fas fa-address-book' },\n            { id: 'calendar', name: '', icon: 'fas fa-calendar-alt' },\n            { id: 'character', name: '', icon: 'fas fa-user' },\n            { id: 'destiny', name: '', icon: 'fas fa-star' },\n            { id: 'diary', name: '', icon: 'fas fa-book' },\n            { id: 'inventory', name: '', icon: 'fas fa-briefcase' },\n            { id: 'forum', name: '', icon: 'fas fa-comments' },\n            { id: 'map', name: '', icon: 'fas fa-map-marked-alt' },\n            { id: 'system', name: '', icon: 'fas fa-cog' },\n        ]);\n        const formattedDate = computed(() => {\n            const dateStr = store.worldState?.?.?.;\n            if (!dateStr)\n                return '';\n            const date = new Date(dateStr);\n            return `${date.getMonth() + 1}${date.getDate()} ${['', '', '', '', '', '', ''][date.getDay()]}`;\n        });\n        const worldTime = computed(() => store.worldState?.?.?. || '');\n        const currentLocation = computed(() => {\n            const protagonist = store.worldState?.;\n            if (protagonist && typeof protagonist === 'object' && '' in protagonist) {\n                const locationId = protagonist.;\n                return locationId ? npcService.getLocationName(locationId) : '';\n            }\n            return '';\n        });\n        const currentWeather = computed(() => store.worldState?.?. || '');\n        const futureWeather = computed(() => store.worldState?.?. || '');\n        return {\n            apps,\n            formattedDate,\n            worldTime,\n            currentLocation,\n            currentWeather,\n            futureWeather,\n            wallpaper,\n            wallpaperStyle,\n            isWallpaperUrl,\n        };\n    },\n});\n","/* unplugin-vue-components disabled */import { render } from \"./HomeScreen.vue?vue&type=template&id=6b541c26&scoped=true&ts=true\"\nimport script from \"./HomeScreen.vue?vue&type=script&lang=ts\"\nexport * from \"./HomeScreen.vue?vue&type=script&lang=ts\"\n\nimport \"./HomeScreen.vue?vue&type=style&index=0&id=6b541c26&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-6b541c26\"]])\n\nexport default __exports__","import { computed, defineComponent, onMounted, ref, shallowRef } from 'vue';\nimport { store } from '../../store';\nimport CharacterApp from '../../views/apps/CharacterApp.vue';\nimport MapApp from '../../views/apps/MapApp.vue';\nimport DestinyCardPanel from '../panels/DestinyCardPanel.vue';\nimport DiaryPanel from '../panels/DiaryPanel.vue';\nimport ForumPanel from '../panels/ForumPanel.vue';\nimport InventoryPanel from '../panels/InventoryPanel.vue';\nimport NpcDirectoryPanel from '../panels/NpcDirectoryPanel.vue';\nimport SystemPanel from '../panels/SystemPanel.vue';\nimport TimelinePanel from '../panels/TimelinePanel.vue';\nimport AppViewContainer from './AppViewContainer.vue';\nimport HomeScreen from './HomeScreen.vue';\nconst apps = {\n    contacts: NpcDirectoryPanel,\n    calendar: TimelinePanel,\n    character: CharacterApp,\n    destiny: DestinyCardPanel,\n    diary: DiaryPanel,\n    inventory: InventoryPanel,\n    forum: ForumPanel,\n    map: MapApp,\n    system: SystemPanel,\n};\nexport default defineComponent({\n    name: 'SmartphoneShell',\n    components: { HomeScreen, AppViewContainer },\n    emits: ['close-smartphone'],\n    setup() {\n        const activeAppId = ref(null);\n        const activeApp = shallowRef(null);\n        const isDiaryNavOpen = ref(false);\n        const getAppName = (id) => {\n            const appMap = {\n                contacts: '',\n                calendar: '',\n                character: '',\n                destiny: '',\n                diary: '',\n                forum: '',\n                system: '',\n                map: '',\n                inventory: '',\n            };\n            return appMap[id] || '';\n        };\n        const openApp = (appId) => {\n            if (apps[appId]) {\n                activeApp.value = apps[appId];\n                activeAppId.value = appId;\n                if (appId !== 'diary') {\n                    isDiaryNavOpen.value = false;\n                }\n            }\n            else {\n                console.warn(`App not found: ${appId}`);\n                activeApp.value = null;\n                activeAppId.value = appId;\n            }\n        };\n        const goHome = () => {\n            activeAppId.value = null;\n            activeApp.value = null;\n            isDiaryNavOpen.value = false;\n        };\n        const currentTime = ref('');\n        const updateTime = () => {\n            const now = new Date();\n            currentTime.value = now.toTimeString().slice(0, 5);\n        };\n        onMounted(() => {\n            updateTime();\n            setInterval(updateTime, 1000 * 60);\n        });\n        const totalApPerDay = 21;\n        const batteryLevel = computed(() => {\n            const ap = store.worldState?.?.;\n            if (!ap)\n                return 100;\n            // This is a simplified logic. A more robust solution would track AP spent since morning.\n            // Assuming the '' resets each time segment, which isn't accurate for a daily total.\n            // For now, let's use a rough estimation.\n            // A better way is to calculate AP spent based on current time segment.\n            const segmentAPMap = {\n                : 2,\n                : 1,\n                : 2,\n                : 3,\n                : 2,\n                : 5,\n                : 3,\n                : 3,\n            };\n            const segments = ['', '', '', '', '', '', '', ''];\n            const currentSegment = store.worldState?.?.?. || '';\n            const currentSegmentIndex = segments.indexOf(currentSegment);\n            let apSpent = 0;\n            for (let i = 0; i < currentSegmentIndex; i++) {\n                apSpent += segmentAPMap[segments[i]];\n            }\n            apSpent += segmentAPMap[currentSegment] - ap.;\n            const percentage = 100 - Math.round((apSpent / totalApPerDay) * 100);\n            return Math.max(0, percentage);\n        });\n        const batteryIcon = computed(() => {\n            if (batteryLevel.value > 80)\n                return 'fa-battery-full';\n            if (batteryLevel.value > 60)\n                return 'fa-battery-three-quarters';\n            if (batteryLevel.value > 40)\n                return 'fa-battery-half';\n            if (batteryLevel.value > 10)\n                return 'fa-battery-quarter';\n            return 'fa-battery-empty';\n        });\n        return {\n            activeAppId,\n            activeApp,\n            openApp,\n            goHome,\n            getAppName,\n            currentTime,\n            batteryLevel,\n            batteryIcon,\n            isDiaryNavOpen,\n        };\n    },\n});\n","/* unplugin-vue-components disabled */import { render } from \"./SmartphoneShell.vue?vue&type=template&id=437b950a&scoped=true&ts=true\"\nimport script from \"./SmartphoneShell.vue?vue&type=script&lang=ts\"\nexport * from \"./SmartphoneShell.vue?vue&type=script&lang=ts\"\n\nimport \"./SmartphoneShell.vue?vue&type=style&index=0&id=437b950a&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-437b950a\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = { class: \"action-points-display\" };\nimport { computed } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'ActionPointDisplay',\n    props: {\n        : {\n            type: Number,\n            required: true,\n        },\n        : {\n            type: Number,\n            required: true,\n        },\n    },\n    setup(__props) {\n        const props = __props;\n        const dots = computed(() => {\n            return Array.from({ length: props. }, (_, i) => ({\n                id: i,\n                active: i < props.,\n            }));\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(dots.value, (dot) => {\n                    return (_openBlock(), _createElementBlock(\"span\", {\n                        key: dot.id,\n                        class: _normalizeClass([\"ap-dot\", { used: !dot.active }])\n                    }, null, 2 /* CLASS */));\n                }), 128 /* KEYED_FRAGMENT */))\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./ActionPointDisplay.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./ActionPointDisplay.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./ActionPointDisplay.vue?vue&type=style&index=0&id=0bb0013f&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-0bb0013f\"]])\n\nexport default __exports__","import { reactive } from 'vue';\n\ninterface ConfirmationState {\n  isVisible: boolean;\n  title: string;\n  message: string;\n  onConfirm: (() => void) | null;\n  onCancel: (() => void) | null;\n  hideCancel: boolean;\n}\n\nconst state = reactive<ConfirmationState>({\n  isVisible: false,\n  title: '',\n  message: '',\n  onConfirm: null,\n  onCancel: null,\n  hideCancel: false,\n});\n\nexport const confirmationService = {\n  get state() {\n    return state;\n  },\n\n  show(title: string, message: string, onConfirm: () => void, hideCancel = false) {\n    return new Promise<boolean>(resolve => {\n      state.title = title;\n      state.message = message;\n      state.onConfirm = () => {\n        onConfirm();\n        resolve(true);\n      };\n      state.onCancel = () => {\n        this.hide();\n        resolve(false);\n      };\n      state.hideCancel = hideCancel;\n      state.isVisible = true;\n    });\n  },\n\n  hide() {\n    state.isVisible = false;\n    state.title = '';\n    state.message = '';\n    state.onConfirm = null;\n    state.onCancel = null;\n    state.hideCancel = false;\n  },\n\n  confirm() {\n    if (state.onConfirm) {\n      state.onConfirm(); // This will now also resolve the promise\n    }\n    // Hiding is handled within onConfirm/onCancel now\n  },\n  cancel() {\n    if (state.onCancel) {\n      state.onCancel();\n    }\n  },\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = $;","import $ from 'jquery';\nimport screenfull from 'screenfull';\n\nlet originalStyles: { [selector: string]: { [key: string]: string } } = {};\n\n// ---  (Browser Fullscreen) ---\n\nfunction toggleBrowserFullscreen() {\n  if (screenfull.isEnabled) {\n    screenfull.toggle();\n  } else {\n    console.warn('');\n  }\n}\n\nfunction onBrowserFullscreenChange(callback: (isFullscreen: boolean) => void) {\n  if (screenfull.isEnabled) {\n    screenfull.on('change', () => {\n      callback(screenfull.isFullscreen);\n    });\n  }\n}\n\n// ---  (Web Fullscreen) ---\n\nfunction getIframeSelector(): string | null {\n  const iframes = parent.document.getElementsByTagName('iframe');\n  for (let i = 0; i < iframes.length; i++) {\n    if (iframes[i].contentWindow === window) {\n      const iframe = iframes[i];\n      if (iframe.id) {\n        return `#${iframe.id}`;\n      }\n      const src = iframe.getAttribute('src');\n      if (src) {\n        const srcFileName = src.split('/').pop();\n        if (srcFileName) {\n          return `iframe[src*=\"${srcFileName}\"]`;\n        }\n      }\n      return null;\n    }\n  }\n  return null;\n}\n\nfunction enterWebFullscreen() {\n  const iframeSelector = getIframeSelector();\n  if (!iframeSelector) {\n    console.warn(' iframe');\n    return;\n  }\n\n  const elementsToModify: { [key: string]: JQuery.PlainObject } = {\n    [iframeSelector]: {\n      position: 'fixed',\n      top: '0',\n      left: '0',\n      width: '100vw',\n      height: '100vh',\n      zIndex: '99999',\n      border: 'none',\n      borderRadius: '0',\n    },\n    '#top-settings-holder': { display: 'none' },\n    '#form_sheld > :not(#chat)': { display: 'none' },\n    '#top-bar': { display: 'none' },\n    '#chat': { height: '100vh', maxHeight: '100vh' },\n    '#chat_fullscreen_button': { display: 'none' },\n  };\n\n  originalStyles = {};\n  for (const selector in elementsToModify) {\n    const $element = $(selector, parent.document);\n    if ($element.length > 0) {\n      originalStyles[selector] = {};\n      const newStyles = elementsToModify[selector as keyof typeof elementsToModify];\n      for (const prop in newStyles) {\n        originalStyles[selector][prop] = $element.css(prop);\n      }\n      $element.css(newStyles);\n    }\n  }\n  $(parent.document.documentElement).addClass('web-fullscreen-active');\n  $(parent.document.body).addClass('web-fullscreen-active');\n}\n\nfunction exitWebFullscreen() {\n  for (const selector in originalStyles) {\n    const $element = $(selector, parent.document);\n    if ($element.length > 0) {\n      $element.css(originalStyles[selector]);\n    }\n  }\n  originalStyles = {};\n  $(parent.document.documentElement).removeClass('web-fullscreen-active');\n  $(parent.document.body).removeClass('web-fullscreen-active');\n}\n\nexport const fullscreenService = {\n  // \n  enterWeb: enterWebFullscreen,\n  exitWeb: exitWebFullscreen,\n  // \n  toggleBrowser: toggleBrowserFullscreen,\n  onBrowserChange: onBrowserFullscreenChange,\n  get isBrowserFullscreen() {\n    return screenfull.isEnabled && screenfull.isFullscreen;\n  },\n};\n","import { reactive, markRaw } from 'vue';\nimport NpcListModal from '../components/modals/NpcListModal.vue';\n\ninterface NpcModalState {\n  isVisible: boolean;\n  title: string;\n  props: { worldId: string };\n}\n\nconst state = reactive<NpcModalState>({\n  isVisible: false,\n  title: '',\n  props: { worldId: '' },\n});\n\nconst show = (worldId: string) => {\n  state.title = 'NPC ';\n  state.props = { worldId };\n  //  DetailModalService \n  // state.component = markRaw(NpcListModal);\n  state.isVisible = true;\n};\n\nconst hide = () => {\n  state.isVisible = false;\n};\n\nexport const npcModalService = {\n  state,\n  show,\n  hide,\n};\n","import { reactive, readonly } from 'vue';\nimport { confirmationService } from '../services/ConfirmationService';\nimport { detailModalService } from '../services/DetailModalService';\nimport { dockManagerService } from '../services/DockManagerService';\nimport { eventBus } from '../services/EventBus';\nimport { fullscreenService } from '../services/fullscreenService';\nimport { inputModalActions } from '../services/InputModalService';\nimport { npcModalService } from '../services/NpcModalService';\n\n//  UI \ninterface UiState {\n  isWebFullscreen: boolean;\n  isBrowserFullscreen: boolean;\n}\n\n// \nconst state = reactive<UiState>({\n  isWebFullscreen: false,\n  isBrowserFullscreen: false,\n});\n\n// \nfullscreenService.onBrowserChange(isFullscreen => {\n  // Check if we are transitioning from fullscreen to not-fullscreen\n  if (state.isBrowserFullscreen && !isFullscreen) {\n    // Use Tavern's built-in refresh mechanism instead of a hard reload\n    TavernHelper.setChatMessages([], { refresh: 'all' });\n  }\n  state.isBrowserFullscreen = isFullscreen;\n});\n\n//  actions\nconst actions = {\n  /**\n   * \n   */\n  toggleBrowserFullscreen(): void {\n    // \n    dockManagerService.closeAllPanels();\n    confirmationService.hide();\n    detailModalService.hide();\n    npcModalService.hide();\n    inputModalActions.hide();\n\n    fullscreenService.toggleBrowser();\n  },\n\n  /**\n   * \n   */\n  toggleWebFullscreen(): void {\n    const newFullscreenState = !state.isWebFullscreen;\n    state.isWebFullscreen = newFullscreenState;\n\n    if (newFullscreenState) {\n      fullscreenService.enterWeb();\n    } else {\n      fullscreenService.exitWeb();\n    }\n    // Notify the layout service about the change\n    eventBus.emit('fullscreenChanged', newFullscreenState);\n  },\n\n  /**\n   * \n   */\n  unpinAllPanels(): void {\n    dockManagerService.unpinAllPanels();\n  },\n};\n\n//  actions\nexport const uiState = readonly(state);\nexport const uiActions = actions;\n","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, unref as _unref, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"top-status\" };\nconst _hoisted_2 = { class: \"status-left\" };\nconst _hoisted_3 = { class: \"chapter-info\" };\nconst _hoisted_4 = { class: \"work-title\" };\nconst _hoisted_5 = { class: \"chapter-title\" };\nconst _hoisted_6 = { class: \"status-center\" };\nconst _hoisted_7 = [\"title\"];\nconst _hoisted_8 = { class: \"status-right\" };\nconst _hoisted_9 = { class: \"date-time-info\" };\nconst _hoisted_10 = { class: \"date-time\" };\nconst _hoisted_11 = { class: \"day-weather\" };\nimport { computed } from 'vue';\nimport ActionPointDisplay from './common/ActionPointDisplay.vue';\nimport { usePanelManager } from '../services/usePanelManager';\nimport { actions, store } from '../store';\nimport { getVariable } from '../store/getters';\nimport { uiActions, uiState } from '../store/ui';\nimport { inputModalActions, inputModalState } from '../services/InputModalService';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'TopStatusBar',\n    setup(__props) {\n        const isBrowserFullscreen = computed(() => uiState.isBrowserFullscreen);\n        const { openPanel } = usePanelManager();\n        const chapterInfo = computed(() => {\n            const chapter = getVariable('.').value;\n            if (!chapter) {\n                return {\n                    workTitle: '',\n                    fullChapterTitle: '',\n                };\n            }\n            return {\n                workTitle: chapter. || '',\n                fullChapterTitle: `${chapter. ?? '?'} ${chapter. ?? '?'}: ${chapter. || ''}`,\n            };\n        });\n        const worldTimeInfo = computed(() => {\n            const worldState = store.worldState?.;\n            if (!worldState || !worldState. || !worldState..) {\n                return {\n                    date: '--------',\n                    timeSegment: '',\n                    dayOfWeek: '?',\n                    weather: '',\n                };\n            }\n            const date = new Date(worldState..);\n            const dateOptions = {\n                year: 'numeric',\n                month: '2-digit',\n                day: '2-digit',\n            };\n            return {\n                date: date.toLocaleDateString('zh-CN', dateOptions).replace(/\\//g, '-'),\n                timeSegment: worldState.. || '',\n                dayOfWeek: `${worldState..}` || '?',\n                weather: worldState. || '',\n            };\n        });\n        const toggleFullscreen = () => {\n            uiActions.toggleBrowserFullscreen();\n            uiActions.toggleWebFullscreen(); // \n        };\n        const openSaveLoadPanel = () => {\n            openPanel('system', 'saveLoad');\n        };\n        const openInputModal = () => {\n            if (inputModalState.isVisible) {\n                inputModalActions.hide();\n            }\n            else {\n                inputModalActions.show();\n            }\n        };\n        const fullscreenTitle = computed(() => {\n            return isBrowserFullscreen.value ? '' : '';\n        });\n        const fullscreenIcon = computed(() => {\n            return isBrowserFullscreen.value ? 'fas fa-compress' : 'fas fa-expand';\n        });\n        const actionPoints = computed(() => {\n            const ap = getVariable('.').value;\n            if (!ap) {\n                return { : 0, : 0 };\n            }\n            return {\n                : ap. ?? 0,\n                : ap. ?? 0,\n            };\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _createElementVNode(\"span\", _hoisted_4, _toDisplayString(chapterInfo.value.workTitle), 1 /* TEXT */),\n                        _createElementVNode(\"span\", _hoisted_5, _toDisplayString(chapterInfo.value.fullChapterTitle), 1 /* TEXT */)\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_6, [\n                    _createElementVNode(\"button\", {\n                        onClick: openSaveLoadPanel,\n                        class: \"view-toggle-btn\",\n                        title: \"\"\n                    }, [...(_cache[1] || (_cache[1] = [\n                            _createElementVNode(\"i\", { class: \"fas fa-cog\" }, null, -1 /* CACHED */)\n                        ]))]),\n                    _createElementVNode(\"button\", {\n                        onClick: openInputModal,\n                        class: \"view-toggle-btn\",\n                        title: \"\"\n                    }, [...(_cache[2] || (_cache[2] = [\n                            _createElementVNode(\"i\", { class: \"fas fa-keyboard\" }, null, -1 /* CACHED */)\n                        ]))]),\n                    _createElementVNode(\"button\", {\n                        onClick: toggleFullscreen,\n                        class: \"view-toggle-btn\",\n                        title: fullscreenTitle.value\n                    }, [\n                        _createElementVNode(\"i\", {\n                            class: _normalizeClass(fullscreenIcon.value)\n                        }, null, 2 /* CLASS */)\n                    ], 8 /* PROPS */, _hoisted_7),\n                    _createElementVNode(\"button\", {\n                        onClick: _cache[0] || (_cache[0] =\n                            //@ts-ignore\n                            (...args) => (_unref(actions).rerollLastAction && _unref(actions).rerollLastAction(...args))),\n                        class: \"view-toggle-btn\",\n                        title: \"\"\n                    }, [...(_cache[3] || (_cache[3] = [\n                            _createElementVNode(\"i\", { class: \"fas fa-undo\" }, null, -1 /* CACHED */)\n                        ]))])\n                ]),\n                _createElementVNode(\"div\", _hoisted_8, [\n                    _createVNode(ActionPointDisplay, {\n                        : actionPoints.value.,\n                        : actionPoints.value.\n                    }, null, 8 /* PROPS */, [\"\", \"\"]),\n                    _createElementVNode(\"div\", _hoisted_9, [\n                        _createElementVNode(\"span\", _hoisted_10, _toDisplayString(worldTimeInfo.value.date) + \" \" + _toDisplayString(worldTimeInfo.value.timeSegment), 1 /* TEXT */),\n                        _createElementVNode(\"span\", _hoisted_11, _toDisplayString(worldTimeInfo.value.dayOfWeek) + \" | \" + _toDisplayString(worldTimeInfo.value.weather), 1 /* TEXT */)\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./TopStatusBar.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./TopStatusBar.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./TopStatusBar.vue?vue&type=style&index=0&id=a72d5322&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-a72d5322\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"world-time-display\" };\nconst _hoisted_2 = { class: \"world-name\" };\nconst _hoisted_3 = { class: \"time-string\" };\nimport { computed, toRefs } from 'vue';\nimport { timeStr as avatarTimeStr, mainWorldTimeStr } from '../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'WorldTimeDisplay',\n    props: {\n        worldType: {}\n    },\n    setup(__props) {\n        const props = __props;\n        const { worldType } = toRefs(props);\n        const worldName = computed(() => {\n            return worldType.value === 'main' ? '' : '';\n        });\n        const timeString = computed(() => {\n            return worldType.value === 'main' ? mainWorldTimeStr.value : avatarTimeStr.value;\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"span\", _hoisted_2, _toDisplayString(worldName.value), 1 /* TEXT */),\n                _createElementVNode(\"span\", _hoisted_3, _toDisplayString(timeString.value), 1 /* TEXT */)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./WorldTimeDisplay.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./WorldTimeDisplay.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./WorldTimeDisplay.vue?vue&type=style&index=0&id=7a5f6689&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7a5f6689\"]])\n\nexport default __exports__","import { eventBus } from './EventBus';\n\nconst NORMAL_LAYOUT_KEY = 'youth-romcom-simulator-layout-state-v1-normal';\nconst FULLSCREEN_LAYOUT_KEY = 'youth-romcom-simulator-layout-state-v1-fullscreen';\n\nexport interface PanelState {\n  world: string;\n  panel: string;\n  props?: Record<string, any>;\n  panelId: string;\n}\n\nclass LayoutService {\n  private activePanels: Map<string, PanelState> = new Map();\n  private fullscreenPanels: Map<string, PanelState> = new Map();\n  private isFullscreen = false;\n\n  constructor() {\n    this.loadAllLayouts();\n    eventBus.on('panelOpened', (state: PanelState) => this.addPanel(state));\n    eventBus.on('panelClosed', (panelId: string) => this.removePanel(panelId));\n    eventBus.on('fullscreenChanged', (isFullscreen: boolean) => this.handleFullscreenChange(isFullscreen));\n  }\n\n  private loadAllLayouts() {\n    try {\n      const normalState = localStorage.getItem(NORMAL_LAYOUT_KEY);\n      if (normalState) this.activePanels = new Map(JSON.parse(normalState));\n\n      const fullscreenState = localStorage.getItem(FULLSCREEN_LAYOUT_KEY);\n      if (fullscreenState) this.fullscreenPanels = new Map(JSON.parse(fullscreenState));\n    } catch (e) {\n      console.error('Failed to load layout states:', e);\n    }\n  }\n\n  private saveLayoutState() {\n    if (this.isFullscreen) {\n      localStorage.setItem(FULLSCREEN_LAYOUT_KEY, JSON.stringify(Array.from(this.fullscreenPanels.entries())));\n    } else {\n      localStorage.setItem(NORMAL_LAYOUT_KEY, JSON.stringify(Array.from(this.activePanels.entries())));\n    }\n  }\n\n  public addPanel(state: PanelState) {\n    const currentMap = this.isFullscreen ? this.fullscreenPanels : this.activePanels;\n    if (!currentMap.has(state.panelId)) {\n      currentMap.set(state.panelId, state);\n      this.saveLayoutState();\n    }\n  }\n\n  public removePanel(panelId: string) {\n    const currentMap = this.isFullscreen ? this.fullscreenPanels : this.activePanels;\n    if (currentMap.has(panelId)) {\n      currentMap.delete(panelId);\n      this.saveLayoutState();\n    }\n  }\n\n  private handleFullscreenChange(isFullscreen: boolean) {\n    this.isFullscreen = isFullscreen;\n    this.restoreLayout();\n  }\n\n  public restoreLayout() {\n    const panelsToRestore = this.isFullscreen ? this.fullscreenPanels : this.activePanels;\n    console.log(`[LayoutService] Broadcasting restore ${this.isFullscreen ? 'fullscreen' : 'normal'} layout event...`);\n    eventBus.emit('restoreLayout', Array.from(panelsToRestore.values()));\n  }\n\n  public setCurrentFullscreenState(isFullscreen: boolean) {\n    this.isFullscreen = isFullscreen;\n  }\n}\n\nexport const layoutService = new LayoutService();\n","import { computed, defineComponent, onMounted, ref } from 'vue';\nimport FloatingCard from './components/cards/FloatingCard.vue';\nimport ActionPanel from './components/common/ActionPanel.vue';\nimport EnhancedInputBox from './components/common/EnhancedInputBox.vue';\nimport InputHistoryPopup from './components/common/InputHistoryPopup.vue';\nimport NotificationContainer from './components/common/NotificationContainer.vue';\nimport SideMenuButton from './components/controls/SideMenuButton.vue';\nimport DockManager from './components/DockManager.vue';\nimport LoadingIndicator from './components/LoadingIndicator.vue';\nimport NpcListModal from './components/modals/NpcListModal.vue';\nimport SmartphoneShell from './components/smartphone/SmartphoneShell.vue';\nimport TopStatusBar from './components/TopStatusBar.vue';\nimport WorldTimeDisplay from './components/WorldTimeDisplay.vue';\nimport { commandService } from './services/CommandService';\nimport { confirmationService } from './services/ConfirmationService';\nimport { destinyCardService } from './services/DestinyCardService';\nimport { detailModalService } from './services/DetailModalService';\nimport { dockManagerService } from './services/DockManagerService';\nimport { eventBus } from './services/EventBus';\nimport { inputModalActions, inputModalState } from './services/InputModalService';\nimport { layoutService } from './services/LayoutService';\nimport { npcModalService } from './services/NpcModalService';\nimport { usePanelManager } from './services/usePanelManager';\nimport { actions, store } from './store';\nimport { uiState } from './store/ui';\nexport default defineComponent({\n    name: 'App',\n    components: {\n        DockManager,\n        EnhancedInputBox,\n        LoadingIndicator,\n        NpcListModal,\n        TopStatusBar,\n        WorldTimeDisplay,\n        SideMenuButton,\n        NotificationContainer,\n        ActionPanel,\n        InputHistoryPopup,\n        SmartphoneShell,\n        FloatingCard,\n    },\n    setup() {\n        const { openPanel } = usePanelManager();\n        const activeCards = destinyCardService.activeCards;\n        const isSmartphoneOpen = ref(false);\n        const toggleSmartphone = () => {\n            isSmartphoneOpen.value = !isSmartphoneOpen.value;\n        };\n        const confirmation = computed(() => confirmationService.state);\n        const detailModal = computed(() => detailModalService.state);\n        const npcModal = computed(() => npcModalService.state);\n        const isWebFullscreen = computed(() => uiState.isWebFullscreen);\n        const inputModal = computed(() => inputModalState);\n        const isActionPanelVisible = ref(false); //  ActionPanel,  false\n        const isHistoryVisible = ref(false);\n        const isQueueVisible = ref(false);\n        const commands = ref([]);\n        const commandCount = computed(() => commands.value.length);\n        const allOptions = [\n            {\n                id: 'inventory',\n                icon: '',\n                text: '',\n                action: () => openPanel('world', 'inventory'),\n                disabled: () => !store.isReady,\n            },\n            {\n                id: 'skills',\n                icon: '',\n                text: '',\n                action: () => openPanel('world', 'skills'),\n                disabled: () => !store.isReady,\n            },\n            {\n                id: 'destiny',\n                icon: '',\n                text: '',\n                action: () => openPanel('world', 'destiny'),\n                disabled: () => !store.isReady,\n            },\n            {\n                id: 'review',\n                icon: '',\n                text: '',\n                action: () => openPanel('system', 'review'),\n                disabled: () => !store.isReady,\n            },\n            {\n                id: 'npcDirectory',\n                icon: '',\n                text: '',\n                action: () => openPanel('system', 'npcDirectory'),\n                disabled: () => !store.isReady,\n            },\n            {\n                id: 'worldDetails',\n                icon: '',\n                text: '',\n                action: () => openPanel('world', 'worldDetails'),\n                disabled: () => !store.isReady,\n            },\n            {\n                id: 'timeline',\n                icon: '',\n                text: '',\n                action: () => dockManagerService.openPanel('timeline', '', 'timeline-panel'),\n                disabled: () => !store.isReady,\n            },\n            {\n                id: 'debug',\n                icon: '',\n                text: '',\n                action: () => openPanel('system', 'debug'),\n                disabled: () => !store.isReady,\n            },\n        ];\n        const handleOverlayClick = () => {\n            if (inputModal.value.isVisible) {\n                inputModalActions.hide();\n                return;\n            }\n        };\n        const handleAction = async (actionContent) => {\n            console.log('Submitting to AI:', actionContent);\n            await actions.handleAction(actionContent);\n        };\n        const handleSubmit = async (actionContent) => {\n            const rawInput = inputModal.value.inputValue;\n            inputModalActions.setLastSubmittedValue(rawInput);\n            await handleAction(actionContent);\n            inputModalActions.hide();\n            inputModalActions.clearValue();\n        };\n        const toggleActionPanel = () => {\n            // isActionPanelVisible.value = !isActionPanelVisible.value; // No-op\n        };\n        const updateCommands = () => {\n            commands.value = commandService.getCommands();\n        };\n        const clearCommands = () => {\n            commandService.clearCommands();\n        };\n        const toggleHistory = () => {\n            isHistoryVisible.value = !isHistoryVisible.value;\n            if (isHistoryVisible.value)\n                isQueueVisible.value = false;\n        };\n        const toggleCommandQueue = () => {\n            isQueueVisible.value = !isQueueVisible.value;\n            if (isQueueVisible.value)\n                isHistoryVisible.value = false;\n        };\n        const selectHistoryEntry = (entry) => {\n            inputModalActions.setValue(entry);\n            isHistoryVisible.value = false;\n        };\n        onMounted(() => {\n            const dockHost = document.getElementById('app');\n            if (dockHost) {\n                dockManagerService.initialize(dockHost);\n            }\n            else {\n                console.error('Dock host element not found.');\n            }\n            actions.loadAllData();\n            dockManagerService.onAction = handleAction;\n            commandService.subscribe(updateCommands);\n            updateCommands();\n            eventBus.on('restoreLayout', (panels) => {\n                const { openPanel } = usePanelManager();\n                dockManagerService.closeAllPanels();\n                panels.forEach(panelState => {\n                    try {\n                        const category = panelState.world === 'mainWorld' || panelState.world === 'avatarWorld' ? 'world' : 'system';\n                        openPanel(category, panelState.panel, panelState.props || {});\n                    }\n                    catch (e) {\n                        console.error(`Failed to restore panel: ${panelState.world}-${panelState.panel}`, e);\n                    }\n                });\n            });\n            layoutService.setCurrentFullscreenState(uiState.isWebFullscreen);\n            layoutService.restoreLayout();\n        });\n        return {\n            confirmation,\n            detailModal,\n            npcModal,\n            isWebFullscreen,\n            inputModal,\n            inputModalActions,\n            allOptions,\n            handleAction,\n            handleSubmit,\n            handleOverlayClick,\n            store,\n            confirmationService,\n            detailModalService,\n            npcModalService,\n            isActionPanelVisible,\n            isHistoryVisible,\n            toggleHistory,\n            selectHistoryEntry,\n            isQueueVisible,\n            toggleCommandQueue,\n            commands,\n            commandCount,\n            clearCommands,\n            isSmartphoneOpen,\n            toggleSmartphone,\n            activeCards,\n        };\n    },\n});\n","/* unplugin-vue-components disabled */import { render } from \"./app.vue?vue&type=template&id=c9bc0060&ts=true\"\nimport script from \"./app.vue?vue&type=script&lang=ts\"\nexport * from \"./app.vue?vue&type=script&lang=ts\"\n\nimport \"./app.vue?vue&type=style&index=0&id=c9bc0060&lang=scss\"\n\nimport exportComponent from \"../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"attribute-item\" };\nconst _hoisted_2 = { class: \"attribute-name\" };\nconst _hoisted_3 = { class: \"attribute-value\" };\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'AttributeDisplay',\n    props: {\n        name: {},\n        value: {}\n    },\n    setup(__props) {\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"span\", _hoisted_2, _toDisplayString(__props.name), 1 /* TEXT */),\n                _createElementVNode(\"span\", _hoisted_3, _toDisplayString(__props.value), 1 /* TEXT */)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./AttributeDisplay.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AttributeDisplay.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./AttributeDisplay.vue?vue&type=style&index=0&id=1b452a49&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1b452a49\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createBlock as _createBlock, createVNode as _createVNode, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = { class: \"character-panel\" };\nconst _hoisted_2 = { class: \"panel-section\" };\nconst _hoisted_3 = {\n    id: \"base-attributes-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_4 = { class: \"panel-section\" };\nconst _hoisted_5 = {\n    id: \"secondary-attributes-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_6 = { class: \"panel-section\" };\nconst _hoisted_7 = {\n    id: \"grades-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_8 = { class: \"panel-section\" };\nconst _hoisted_9 = {\n    id: \"skills-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_10 = { class: \"panel-section\" };\nconst _hoisted_11 = {\n    id: \"talents-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_12 = { class: \"panel-section\" };\nconst _hoisted_13 = {\n    id: \"schedule-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_14 = { class: \"panel-section\" };\nconst _hoisted_15 = {\n    id: \"relations-list\",\n    class: \"attributes-list\"\n};\nconst _hoisted_16 = { class: \"attribute-name\" };\nconst _hoisted_17 = { class: \"attribute-value\" };\nimport { getters } from '../store';\nimport AttributeDisplay from '../components/AttributeDisplay.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'CharacterView',\n    setup(__props) {\n        const { character, secondaryAttributes, todayCourses, getBaseAttributes, getSubjects, getSkills, getTalents, getRelationships, } = getters;\n        const baseAttributes = getBaseAttributes(character);\n        const subjects = getSubjects(character);\n        const skills = getSkills(character);\n        const talents = getters.getTalents(character);\n        const relationships = getRelationships(character);\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(baseAttributes).value, (attr, key) => {\n                            return (_openBlock(), _createBlock(AttributeDisplay, {\n                                key: key,\n                                name: String(key),\n                                value: `${attr.} / ${attr.}`\n                            }, null, 8 /* PROPS */, [\"name\", \"value\"]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_4, [\n                    _cache[1] || (_cache[1] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_5, [\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: ` ${_unref(secondaryAttributes).}`\n                        }, null, 8 /* PROPS */, [\"value\"]),\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: _unref(secondaryAttributes).\n                        }, null, 8 /* PROPS */, [\"value\"])\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_6, [\n                    _cache[2] || (_cache[2] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_7, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(subjects).value, (subject, key) => {\n                            return (_openBlock(), _createBlock(AttributeDisplay, {\n                                key: key,\n                                name: String(key),\n                                value: `${subject.} (${subject.})`\n                            }, null, 8 /* PROPS */, [\"name\", \"value\"]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_8, [\n                    _cache[3] || (_cache[3] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_9, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(skills).value, (skill, key) => {\n                            return (_openBlock(), _createBlock(AttributeDisplay, {\n                                key: key,\n                                name: String(key),\n                                value: `Lv.${skill.} / ${skill.}`\n                            }, null, 8 /* PROPS */, [\"name\", \"value\"]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_10, [\n                    _cache[4] || (_cache[4] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_11, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(talents), (talent, index) => {\n                            return (_openBlock(), _createBlock(AttributeDisplay, {\n                                key: index,\n                                name: talent.,\n                                value: talent.\n                            }, null, 8 /* PROPS */, [\"name\", \"value\"]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_12, [\n                    _cache[5] || (_cache[5] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_13, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(todayCourses), (course, index) => {\n                            return (_openBlock(), _createBlock(AttributeDisplay, {\n                                key: index,\n                                name: course.,\n                                value: course.\n                            }, null, 8 /* PROPS */, [\"name\", \"value\"]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ]),\n                _createElementVNode(\"div\", _hoisted_14, [\n                    _cache[6] || (_cache[6] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_15, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(relationships).value, (rel, name) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: name,\n                                class: \"attribute-item\"\n                            }, [\n                                _createElementVNode(\"span\", _hoisted_16, _toDisplayString(name), 1 /* TEXT */),\n                                _createElementVNode(\"span\", _hoisted_17, \" :\" + _toDisplayString(rel.) + \" :\" + _toDisplayString(rel.), 1 /* TEXT */)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./CharacterView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./CharacterView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./CharacterView.vue?vue&type=style&index=0&id=1c5d8637&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1c5d8637\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = { class: \"inventory-panel\" };\nconst _hoisted_2 = { class: \"panel-section\" };\nconst _hoisted_3 = { class: \"inventory-grid\" };\nconst _hoisted_4 = { class: \"item-name\" };\nconst _hoisted_5 = { class: \"item-quantity\" };\nimport { ref, onMounted } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'InventoryView',\n    setup(__props) {\n        const inventory = ref([]);\n        onMounted(() => {\n            // Mock data for display purposes\n            inventory.value = [\n                { id: 'food001', name: 'A', quantity: 1 },\n                { id: 'snack002', name: 'Pocky', quantity: 3 },\n                { id: 'study001', name: '', quantity: 1 },\n            ];\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(inventory.value, (item) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: item.id,\n                                class: \"inventory-item\"\n                            }, [\n                                _createElementVNode(\"div\", _hoisted_4, _toDisplayString(item.name), 1 /* TEXT */),\n                                _createElementVNode(\"div\", _hoisted_5, \"x\" + _toDisplayString(item.quantity), 1 /* TEXT */)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./InventoryView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./InventoryView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./InventoryView.vue?vue&type=style&index=0&id=d797c64c&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-d797c64c\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createVNode as _createVNode, createCommentVNode as _createCommentVNode, normalizeStyle as _normalizeStyle, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"main-content-view\" };\nconst _hoisted_2 = [\"innerHTML\"];\nconst _hoisted_3 = [\"innerHTML\"];\nimport { computed, reactive } from 'vue';\nimport EnhancedInputBox from '../components/common/EnhancedInputBox.vue';\nimport { combinedNarrative, getItemByName, getNpcByName } from '../store/getters';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'MainContentView',\n    emits: ['submit-action'],\n    setup(__props, { emit: __emit }) {\n        const emit = __emit;\n        const tooltip = reactive({\n            visible: false,\n            content: '',\n            style: {\n                top: '0px',\n                left: '0px',\n            },\n        });\n        const processedNarrative = computed(() => {\n            let text = combinedNarrative.value;\n            // Regex to find <item name=\"...\">...</item> and <npc name=\"...\">...</npc>\n            const itemRegex = /<item name=\"([^\"]+)\">(.+?)<\\/item>/g;\n            const npcRegex = /<npc name=\"([^\"]+)\">(.+?)<\\/npc>/g;\n            text = text.replace(itemRegex, (match, name, content) => {\n                return `<span class=\"highlighted-item\" data-type=\"item\" data-name=\"${name}\">${content}</span>`;\n            });\n            text = text.replace(npcRegex, (match, name, content) => {\n                return `<span class=\"highlighted-npc\" data-type=\"npc\" data-name=\"${name}\">${content}</span>`;\n            });\n            return text;\n        });\n        const handleMouseOver = (event) => {\n            const target = event.target;\n            const dataType = target.dataset.type;\n            const dataName = target.dataset.name;\n            if (!dataType || !dataName)\n                return;\n            let entity;\n            if (dataType === 'item') {\n                entity = getItemByName(dataName);\n            }\n            else if (dataType === 'npc') {\n                entity = getNpcByName(dataName);\n            }\n            if (entity) {\n                tooltip.content = formatTooltipContent(entity, dataType);\n                tooltip.style.top = `${event.clientY + 15}px`;\n                tooltip.style.left = `${event.clientX + 15}px`;\n                tooltip.visible = true;\n            }\n        };\n        const handleMouseOut = () => {\n            tooltip.visible = false;\n        };\n        const formatTooltipContent = (entity, type) => {\n            if (type === 'item') {\n                return `\n      <div class=\"tooltip-title\">${entity.} [${entity.}]</div>\n      <div class=\"tooltip-description\">${entity.}</div>\n      <div class=\"tooltip-level\">: ${entity.}</div>\n    `;\n            }\n            if (type === 'npc') {\n                return `\n      <div class=\"tooltip-title\">${entity.}</div>\n      <div class=\"tooltip-description\">${entity.}</div>\n      <div class=\"tooltip-identity\">: ${entity..join(', ')}</div>\n    `;\n            }\n            return '';\n        };\n        const handleSubmit = (action) => {\n            emit('submit-action', action);\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", {\n                    class: \"narrative-container\",\n                    innerHTML: processedNarrative.value,\n                    onMouseover: handleMouseOver,\n                    onMouseout: handleMouseOut\n                }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_2),\n                _createVNode(EnhancedInputBox, {\n                    placeholder: \"...\",\n                    onSubmitAction: handleSubmit\n                }),\n                _createCommentVNode(\" Tooltip \"),\n                (tooltip.visible)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 0,\n                        class: \"narrative-tooltip\",\n                        style: _normalizeStyle(tooltip.style),\n                        innerHTML: tooltip.content\n                    }, null, 12 /* STYLE, PROPS */, _hoisted_3))\n                    : _createCommentVNode(\"v-if\", true)\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./MainContentView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./MainContentView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./MainContentView.vue?vue&type=style&index=0&id=4453ae69&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-4453ae69\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = { class: \"npc-list-panel\" };\nconst _hoisted_2 = { class: \"panel-section\" };\nconst _hoisted_3 = { class: \"npc-list\" };\nconst _hoisted_4 = { class: \"npc-name\" };\nconst _hoisted_5 = { class: \"npc-relationship\" };\nimport { ref, onMounted } from 'vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'NpcListView',\n    setup(__props) {\n        const npcs = ref([]);\n        onMounted(() => {\n            // Mock data for display purposes\n            // In a real scenario, you would fetch this from the game state\n            npcs.value = [\n                { id: 'yukinoshita_yukino', name: '', favorability: 55 },\n                { id: 'yuigahama_yui', name: '', favorability: 60 },\n            ];\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"section-title\" }, \"NPC \", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(npcs.value, (npc) => {\n                            return (_openBlock(), _createElementBlock(\"div\", {\n                                key: npc.id,\n                                class: \"npc-item\"\n                            }, [\n                                _createElementVNode(\"div\", _hoisted_4, _toDisplayString(npc.name), 1 /* TEXT */),\n                                _createElementVNode(\"div\", _hoisted_5, \": \" + _toDisplayString(npc.favorability), 1 /* TEXT */)\n                            ]));\n                        }), 128 /* KEYED_FRAGMENT */))\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./NpcListView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NpcListView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./NpcListView.vue?vue&type=style&index=0&id=e354837a&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-e354837a\"]])\n\nexport default __exports__","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"world-state-panel\" };\nconst _hoisted_2 = { class: \"panel-section\" };\nconst _hoisted_3 = { class: \"state-list\" };\nimport { ref, onMounted, computed } from 'vue';\nimport AttributeDisplay from '../components/AttributeDisplay.vue';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'WorldStateView',\n    setup(__props) {\n        const worldState = ref(null);\n        const currentTime = computed(() => {\n            if (!worldState.value)\n                return '';\n            const time = worldState.value.;\n            return `${time.}-${time.}-${time.} ${time.}:${time.} (${time.})`;\n        });\n        onMounted(() => {\n            // Mock data for display purposes\n            worldState.value = {\n                : {\n                    : 2024,\n                    : 9,\n                    : 1,\n                    : 8,\n                    : 0,\n                    : '',\n                },\n                : '',\n                : '',\n                : 22,\n                : 100,\n                : 'Y2K',\n            };\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n                _createElementVNode(\"div\", _hoisted_2, [\n                    _cache[0] || (_cache[0] = _createElementVNode(\"div\", { class: \"section-title\" }, \"\", -1 /* CACHED */)),\n                    _createElementVNode(\"div\", _hoisted_3, [\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: currentTime.value\n                        }, null, 8 /* PROPS */, [\"value\"]),\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: worldState.value?. || 'N/A'\n                        }, null, 8 /* PROPS */, [\"value\"]),\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: worldState.value?. || 'N/A'\n                        }, null, 8 /* PROPS */, [\"value\"]),\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: `${worldState.value?. || 'N/A'}C`\n                        }, null, 8 /* PROPS */, [\"value\"]),\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: worldState.value?. || 0\n                        }, null, 8 /* PROPS */, [\"value\"]),\n                        _createVNode(AttributeDisplay, {\n                            name: \"\",\n                            value: worldState.value?. || 'N/A'\n                        }, null, 8 /* PROPS */, [\"value\"])\n                    ])\n                ])\n            ]));\n        };\n    }\n});\n","import { createApp } from 'vue';\nimport { createMemoryHistory, createRouter, RouteRecordRaw } from 'vue-router';\nimport App from '../app.vue';\nimport CharacterView from '../views/CharacterView.vue';\nimport InventoryView from '../views/InventoryView.vue';\nimport MainContentView from '../views/MainContentView.vue';\nimport NpcListView from '../views/NpcListView.vue';\nimport WorldStateView from '../views/WorldStateView.vue';\n\n// \nconst routes: RouteRecordRaw[] = [\n  { path: '/', component: MainContentView },\n  { path: '/character', component: CharacterView },\n  { path: '/npc-list', component: NpcListView },\n  { path: '/inventory', component: InventoryView },\n  { path: '/world-state', component: WorldStateView },\n];\n\nconst router = createRouter({\n  history: createMemoryHistory(),\n  routes,\n});\n\n// \nrouter.replace('/');\n\n$(() => {\n  createApp(App).use(router).mount('#app');\n});\n","/* unplugin-vue-components disabled */import script from \"./WorldStateView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./WorldStateView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./WorldStateView.vue?vue&type=style&index=0&id=e33a51b8&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.28_typescript@6.0.0-dev.20250807__webpack@5.105.2/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-e33a51b8\"]])\n\nexport default __exports__","import { store } from '../store';\nimport type { AppState, DiaryEntry, WeeklyReview, DirectorLog, DiaryFragment } from '../types';\nimport { lorebookService } from './LorebookService';\nimport { memoryService } from './MemoryService';\nimport { notificationService } from './NotificationService';\nimport { tavernService } from './tavern';\n\n//  v4\nfunction parseBlock(blockText: string): { [key: string]: any } {\n  const lines = blockText.trim().split('\\n');\n  const result: { [key: string]: any } = {};\n  let currentMajorKey: string | null = null;\n  let currentList: any[] | null = null;\n  let currentObjectInList: { [key: string]: string } | null = null;\n\n  for (const line of lines) {\n    if (line.trim() === '---') {\n      currentMajorKey = null;\n      currentList = null;\n      currentObjectInList = null;\n      continue;\n    }\n\n    const separatorIndex = line.indexOf('|');\n    if (separatorIndex !== -1 && !currentMajorKey) {\n      const key = line.substring(0, separatorIndex).trim();\n      const value = line.substring(separatorIndex + 1).trim();\n      result[key] = value;\n      continue;\n    }\n\n    if (line.trim().startsWith('') && line.trim().endsWith('')) {\n      currentMajorKey = line.trim();\n      result[currentMajorKey] = [];\n      currentList = result[currentMajorKey];\n      currentObjectInList = null;\n      continue;\n    }\n\n    if (currentList && currentMajorKey) {\n      //  currentMajorKey \n      const trimmedLine = line.trim();\n      if (trimmedLine.startsWith('- ')) {\n        const itemContent = trimmedLine.substring(2).trim();\n        const itemSeparatorIndex = itemContent.indexOf(':');\n\n        if (itemSeparatorIndex !== -1) {\n          const itemKey = itemContent.substring(0, itemSeparatorIndex).trim();\n          const itemValue = itemContent.substring(itemSeparatorIndex + 1).trim();\n          currentObjectInList = { [itemKey]: itemValue };\n          currentList.push(currentObjectInList);\n        } else {\n          currentList.push(itemContent);\n          currentObjectInList = null;\n        }\n      } else if (currentObjectInList && trimmedLine) {\n        const lastKey = Object.keys(currentObjectInList).pop();\n        if (lastKey) {\n          currentObjectInList[lastKey] += '\\n' + trimmedLine;\n        }\n      } else if (trimmedLine) {\n        if (result[currentMajorKey].length > 0) {\n          const lastItem = result[currentMajorKey][result[currentMajorKey].length - 1];\n          if (typeof lastItem === 'string') {\n            result[currentMajorKey][result[currentMajorKey].length - 1] += '\\n' + trimmedLine;\n          }\n        } else {\n          result[currentMajorKey].push(trimmedLine);\n        }\n      }\n    }\n  }\n  for (const key in result) {\n    if (Array.isArray(result[key]) && result[key].length === 1 && typeof result[key][0] === 'string') {\n      result[key] = result[key][0];\n    }\n  }\n\n  return result;\n}\n\nclass LogSyncService {\n  private pollingInterval: any | null = null;\n  private isSyncing = false;\n\n  public startPolling(interval = 15000) {\n    if (this.pollingInterval) this.stopPolling();\n    console.log(`[LogSyncService] Starting to poll chat history every ${interval}ms.`);\n    this.pollingInterval = setInterval(() => this.syncLogsFromChat(), interval);\n    this.syncLogsFromChat();\n  }\n\n  public stopPolling() {\n    if (this.pollingInterval) {\n      clearInterval(this.pollingInterval);\n      this.pollingInterval = null;\n      console.log('[LogSyncService] Stopped polling chat history.');\n    }\n  }\n\n  private async processLogs<T extends { [key: string]: any }>(\n    messages: any[],\n    config: {\n      tagName: string;\n      lorebookEntry: string;\n      storeKey: keyof AppState;\n      idKey: string;\n      idParser?: (id: any) => any;\n      onNewLogFound?: (newLogs: T[]) => Promise<void>;\n    },\n  ) {\n    const { tagName, lorebookEntry, storeKey, idKey, idParser = id => String(id), onNewLogFound } = config;\n    const logBlockRegex = new RegExp(`<${tagName}>([\\\\s\\\\S]+?)<\\\\/${tagName}>`, 'g');\n    let allNewBlocks: string[] = [];\n\n    for (const message of messages) {\n      if (message.is_user) continue;\n      let match;\n      while ((match = logBlockRegex.exec(message.message)) !== null) {\n        allNewBlocks.push(match[1].trim());\n      }\n    }\n\n    if (allNewBlocks.length === 0) return;\n\n    const existingContent = (await lorebookService.readFromLorebook(lorebookEntry)) || '';\n    const archiveContent = (await lorebookService.readFromLorebook(`${lorebookEntry}-`)) || '';\n    const existingIds = new Set();\n\n    const allExistingBlocks = (existingContent + archiveContent).split('\\n\\n---\\n\\n');\n    for (const block of allExistingBlocks) {\n      const idMatch = block.match(new RegExp(`^\\\\s*${idKey}\\\\|(.+)$`, 'm'));\n      if (idMatch && idMatch[1]) {\n        existingIds.add(idParser(idMatch[1].trim()));\n      }\n    }\n\n    const localStoreRef = (store as any)[storeKey] as T[];\n    for (const item of localStoreRef) {\n      if (item[idKey]) existingIds.add(idParser(item[idKey]));\n    }\n\n    const newItems: T[] = [];\n    const newBlockContents: string[] = [];\n\n    for (const blockText of allNewBlocks) {\n      try {\n        const parsed = parseBlock(blockText) as T;\n        const id = parsed[idKey] ? idParser(parsed[idKey]) : null;\n        if (id && !existingIds.has(id)) {\n          newItems.push(parsed);\n          newBlockContents.push(blockText);\n          existingIds.add(id);\n        }\n      } catch (e) {\n        console.error(`[LogSyncService] Error parsing block for <${tagName}>`, e, 'Block:', blockText);\n      }\n    }\n\n    if (newItems.length > 0) {\n      (store as any)[storeKey] = [...localStoreRef, ...newItems].sort((a, b) => (a[idKey] > b[idKey] ? 1 : -1));\n      const contentToAppend = newBlockContents.join('\\n\\n---\\n\\n');\n      await lorebookService.appendToEntry(lorebookEntry, contentToAppend, '\\n\\n---\\n\\n');\n      notificationService.success(`${lorebookEntry}`, ` ${newItems.length} `);\n\n      if (onNewLogFound) {\n        await onNewLogFound(newItems);\n      }\n    }\n  }\n\n  public async syncLogsFromChat() {\n    if (this.isSyncing) return;\n    this.isSyncing = true;\n    console.log('[LogSyncService] Starting log sync...');\n\n    try {\n      const messages = await tavernService.fetchTavernData();\n      if (!messages) return;\n\n      await this.processLogs<DiaryFragment>(messages, {\n        tagName: '',\n        lorebookEntry: '',\n        storeKey: 'diaryFragments',\n        idKey: '',\n        idParser: id => parseInt(id, 10),\n      });\n\n      await this.processLogs<DirectorLog>(messages, {\n        tagName: '',\n        lorebookEntry: '',\n        storeKey: 'directorLogs',\n        idKey: 'ID',\n      });\n\n      await this.processLogs<DiaryEntry>(messages, {\n        tagName: '',\n        lorebookEntry: '',\n        storeKey: 'diary',\n        idKey: '',\n        onNewLogFound: async newDiaries => {\n          const datesToArchive = new Set(newDiaries.map(d => d.));\n          const fragmentContent = await lorebookService.readFromLorebook('');\n          if (!fragmentContent) return;\n\n          const fragments = fragmentContent.split('\\n\\n---\\n\\n');\n          const fragmentsToArchive = fragments.filter(f => {\n            const dateMatch = f.match(/^\\|(.+)$/m);\n            return dateMatch && datesToArchive.has(dateMatch[1].trim());\n          });\n          const remainingFragments = fragments.filter(f => {\n            const dateMatch = f.match(/^\\|(.+)$/m);\n            return !dateMatch || !datesToArchive.has(dateMatch[1].trim());\n          });\n\n          if (fragmentsToArchive.length > 0) {\n            await lorebookService.appendToEntry('-', fragmentsToArchive.join('\\n\\n---\\n\\n'), '\\n\\n---\\n\\n');\n            await lorebookService.writeToLorebook('', remainingFragments.join('\\n\\n---\\n\\n'));\n            notificationService.info('', ` ${fragmentsToArchive.length} `);\n          }\n        },\n      });\n\n      await this.processLogs<WeeklyReview>(messages, {\n        tagName: '',\n        lorebookEntry: '',\n        storeKey: 'weeklyReviews',\n        idKey: '',\n        idParser: id => parseInt(id, 10),\n      });\n    } catch (error) {\n      console.error('[LogSyncService] Error during log sync:', error);\n    } finally {\n      this.isSyncing = false;\n      console.log('[LogSyncService] Log sync finished.');\n    }\n  }\n}\n\nexport const logSyncService = new LogSyncService();\n","import 'golden-layout/dist/css/goldenlayout-base.css';\nimport 'golden-layout/dist/css/themes/goldenlayout-dark-theme.css';\nimport { watch } from 'vue';\nimport './core/vue-loader';\nimport { commandService } from './services/CommandService';\nimport { diarySynthesisService } from './services/DiarySynthesisService';\nimport { entityIndexService } from './services/EntityIndexService';\nimport { inputModalActions, inputModalState } from './services/InputModalService';\nimport { logSyncService } from './services/LogSyncService';\nimport { lorebookService } from './services/LorebookService';\nimport { memoryService } from './services/MemoryService';\nimport { npcService } from './services/NpcService';\nimport { saveLoadService } from './services/saveLoadService';\nimport { serviceLocator } from './services/service-locator';\nimport { tavernService } from './services/tavern';\nimport { actions, store } from './store';\nimport './styles/main.scss';\n\n// \nasync function initializeServices() {\n  // \n  serviceLocator.register('saveLoadService', saveLoadService);\n  serviceLocator.register('inputModalState', inputModalState);\n  serviceLocator.register('inputModalActions', inputModalActions);\n  serviceLocator.register('store', store);\n  serviceLocator.register('actions', actions);\n  serviceLocator.register('diarySynthesisService', diarySynthesisService);\n\n  await npcService.initializeWorldAndLocationData();\n  //  worldState \n  if (!store.worldState) {\n    // Wait for worldState to be loaded\n    await new Promise(resolve => {\n      const unwatch = watch(\n        () => store.worldState,\n        newValue => {\n          if (newValue) {\n            unwatch();\n            resolve(true);\n          }\n        },\n      );\n    });\n  }\n  await entityIndexService.buildIndex(store.worldState);\n  diarySynthesisService.initialize();\n  // \n}\n\nfunction handleRerollRestore() {\n  const shouldRestore = localStorage.getItem('reincarnation-simulator-restore-input');\n  if (shouldRestore === 'true') {\n    console.log('[Startup] Restore flag found, restoring last input.');\n    const lastInput = localStorage.getItem('reincarnation-simulator-last-submitted');\n    if (lastInput) {\n      inputModalActions.setValue(lastInput);\n      inputModalActions.show();\n    }\n    localStorage.removeItem('reincarnation-simulator-restore-input');\n  }\n}\n\n// \ninitializeServices().then(() => {\n  console.log('All services initialized.');\n  handleRerollRestore();\n\n  // \n  logSyncService.startPolling(15000);\n\n  //  worldLog \n  // The diary watch logic is now replaced by the WeeklyReviewService\n  // and other more direct update mechanisms.\n  // watch\n  let lastDirectorLogContent = '';\n  setInterval(async () => {\n    // \n    const currentLogContent = await lorebookService.readFromLorebook('', true);\n\n    // \n    if (currentLogContent && currentLogContent !== lastDirectorLogContent) {\n      console.log('[Auto-Memory Polling] Detected change in \"\", processing...');\n      await memoryService.processDirectorLog();\n      lastDirectorLogContent = currentLogContent;\n    }\n  }, 5000); // 5\n});\n\n// \nsaveLoadService;\ncommandService;\ntavernService;\n"],"names":["debugService","state","reactive","mainStoryStatus","mainStoryContent","mainStoryStats","filesLoaded","totalEvents","actionableEvents","foreshadowedEvents","calendarFixedStatus","calendarFixedContent","calendarRandomStatus","calendarRandomContent","calendarCrossoverStatus","calendarCrossoverContent","styleGuideStatus","styleGuideContent","lastContext","refreshData","storyEntryKeys","loadedStories","Promise","all","map","key","readFromLorebook","filter","c","JSON","parse","this","_cleanJsonString","Boolean","length","reduce","acc","story","timeline","e","message","loadDebugEntry","setLastContext","context","setMainStoryStats","stats","entryKey","statusKey","contentKey","content","str","firstBrace","indexOf","lastBrace","lastIndexOf","substring","destinyCardService","activeCards","computed","activeCardId","worldState","activeCard","playerBackpackCards","value","find","card","ID","protagonist","Array","isArray","isVisible","component","props","title","detailModalService","readonly","show","markRaw","hide","setTimeout","diarySynthesisService","processedDatesForDiary","Set","lastWeeklyReviewCount","getSynthesisRequest","store","get","diaryFragments","uniqueDates","f","sort","dateToProcess","has","fragmentsToSynthesize","console","log","add","stringify","diariesToReview","diary","slice","payload","initialize","clear","forEach","d","weeklyReviews","entityIndexService","indexByName","Map","indexById","isInitialized","buildIndex","indexCharacters","indexLocations","size","findByName","name","findById","id","addEntity","entity","existingByName","set","characters","charId","char","type","path","skillId","ownerId","itemId","locations","locId","loc","eventBus","events","on","event","callback","push","off","cb","emit","args","error","LOREBOOK_NAME","entriesCache","async","getEntries","forceRefresh","entries","TavernHelper","getLorebookEntries","entryName","entry","comment","writeToLorebook","options","isEnabled","keys","allEntries","targetEntry","setLorebookEntries","uid","enabled","baseKey","replace","baseEntryTemplate","newEntryData","position","order","Object","assign","selective","constant","case_sensitive","createLorebookEntries","lorebookService","appendToEntry","newContent","separator","existingContent","findEntryByComment","warn","setEntryEnabled","updatedEntry","memoryService","INSTANT_MEMORY_KEY","SHORT_TERM_MEMORY_KEY","LONG_TERM_MEMORY_KEY","DIRECTOR_LOG_KEY","config","instantMemoryCount","shortTermMemoryCount","longTermMemoryCount","processDirectorLog","rawLogContent","logEntries","split","trim","directorLogContent","instantContent","_formatInstantContent","shortTermContent","_formatShortTermContent","longTermContent","_formatLongTermContent","_updateMemoryTier","_extractSection","sectionName","regex","RegExp","match","logContent","scriptIdMatch","join","scriptIdLine","npcAnalysisText","performanceBlock","npcAnalysisRegex","directorIntentMatch","directorIntentContent","performanceAnalysisText","npcAnalysisIndex","newEntry","limit","SEPARATOR","startsWith","unshift","writeMemory","getConfig","setConfig","newConfig","notifications","nextId","actions","duration","index","findIndex","n","splice","success","info","notificationState","notificationService","USER_ID","locationCache","allNpcs","npcs","charData","npcService","getNpcsByWorld","worldId","initializeWorldAndLocationData","worldSet","values","s","worldInfoList","from","worldName","getLocationName","location","getLocationDetails","getNpcNameById","character","getNpcId","npc","characterList","getParentLocationName","parentId","cacheLocationData","spatialEntities","storylineService","masterTimeline","flattenedStages","fixedEvents","loadMasterTimeline","storyContents","combinedTimeline","storyData","concat","flattenStages","flatMap","arc","stages","stage","rawTriggerTime","trigger_time","trigger_conditions","date","segment","conditions","must_all","condition","dateMatch","segmentMatch","stage_id","arcId","arcTitle","getFlattenedStages","getMasterTimeline","getActionableStoryline","history","now","currentTimeSegment","includes","isTimeReached","checkTriggerConditions","dateConditionStr","targetSegment","dateCondition","segmentCondition","targetDate","isValid","isBefore","isSame","segmentsOrder","currentSegmentIndex","targetSegmentIndex","event_id","characterId","character_id","status","_parseNaturalLanguageCondition","eventMatch","statusMatch","charName","statusToCheck","some","getDisplayTimeline","allStages","getAllTimelineStages","completedEventIds","lastCompletedStageIndex","i","startIndex","endIndex","displayStages","getFixedEvents","rawData","month","day","String","padStart","COT_FILES","NORMAL","CREATION","IDENTITY","workflowService","currentState","narrativeCache","updateScriptCache","preserveMode","constructor","switchTo","getCurrentState","newState","force","allCots","flat","cotsToEnable","cotName","shouldBeEnabled","cacheNarrative","narrative","popNarrative","cacheUpdateScript","script","popUpdateScript","setPreserveMode","mode","popPreservedContent","SAVE_SLOT_PREFIX","AUTO_SAVE_SLOTS","REROLL_SAVE_SLOT_ID","LOREBOOK_KEYS_TO_BACKUP","saveLoadService","manualSlots","autoSlots","rerollSlot","turnCounter","isAutoSaveEnabled","autoSaveInterval","areSlotsLoaded","initializeSlots","loadAutoSaveState","loadTurnCounter","ensureSlotsLoaded","loadAllSaveSlots","timestamp","data","updateSlot","slot","diaryDate","diaryTimeSegment","diaryTitle","entryUid","undefined","saveGame","slotId","isAutoSave","messages","getChatMessages","Error","messageZero","Date","toISOString","lorebookBackup","latestFragment","_getLatestFragment","worldTime","cleanedMessage","saveData","mvu_data","message_content","lorebook_backup","existingEntry","errorMessage","_internalLoadGame","setChatMessages","refresh","loadGame","confirm","lastAiMessage","reverse","m","fragmentMatch","titleMatch","deleteSave","deleteLorebookEntries","performAutoSave","localStorage","setItem","toString","saveStateForReroll","loadRerollState","window","reload","exportSave","dataStr","dataBlob","Blob","url","URL","createObjectURL","link","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL","importSave","jsonContent","emptySlot","toggleAutoSave","savedState","getItem","savedCounter","parseInt","registry","serviceLocator","register","instance","tavernService","fetchTavernData","debug","getCurrentMessageId","generateAiResponse","prompt","generateConfig","injects","role","should_scan","should_stream","aiResponse","generate","invokeMvuScript","oldVariables","inputData","old_variables","eventEmit","new_variables","playerCharacter","getVariable","mainWorldNarrative","defaultValue","playerSkills","combinedNarrative","toLocaleString","year","hour","minute","hour12","getNpcByName","memoryRetrievalService","cachedLogs","entityIdToNameMap","lastLogCount","topN","recencyWeight","entityMatchWeight","locationMatchWeight","socialGraphWeight","coreTraitWeight","causalLinkWeight","getRelevantMemories","combinedInput","userId","dateFilter","ensureCacheIsReady","candidateLogs","queryEntities","extractQueryEntities","scoredLogs","score","calculateRelevanceScore","relevanceScore","highlyRelevantLogs","a","b","totalLogs","Math","max","l","logText","logEntities","entityId","entityName","x","getSocialGraphScore","getCoreTraitScore","getCausalLinkScore","buildEntityIdToNameMap","entities","protagonistLocation","logEntityId","queryEntityId","subjectRelations","relationship","affinityScore","abs","dominanceScore","npcCharacter","contextService","lastProcessedCardDrawTime","hasIssuedDrawCommandForTime","analyzeUserIntent","userInput","availableRipples","intent","actionType","explicitEntities","dbItems","triggeredRipples","patterns","test","buildLeanContext","lastNarrative","sceneContext","worldContext","parseRelativeDate","protagonistId","anchorCharacterNames","anchorLocationNames","parseDirectorLogForAnchors","locationContext","buildLocationContext","buildSceneContext","presentCharacters","absentCharacterSummaries","presentCharacterIds","buildCharacterContext","relationshipContext","buildRelationshipContext","directiveContext","buildDirectiveContext","memoryContext","buildMemoryContext","buildCardContext","locationId","currentLocation","t","allLocations","anchorLocationIds","fullDetailLocationIds","getAllParentLocationIds","clothingStyleGuide","loadClothingStyles","allChars","anchorCharIds","sceneLocation","explicitChars","fullDetailCharIds","charWithStyle","styleGuide","DEFAULT","finalStyle","season","getCurrentSeason","weather","fullCausalNet","idsToProcess","subjectId","objectId","actionableEvent","actionableEventIndex","firstUncompletedIndex","calendarContent","calendarData","currentMonth","getMonth","currentDay","getDate","monthKey","upcomingEvents","checkDate","setDate","checkDayKey","getFullYear","randomEventsContent","randomEventsData","availableRandomEvents","pool","detail","cardDrawTime","synthesisRequest","memories","recentEventsDetails","anchorSectionRegex","charRegex","locRegex","charMatch","locMatch","parents","currentId","simplifyIdMap","simple","currentDate","chineseNumMap","daysAgoMatch","weeksAgoMatch","shangZhouMatch","monthsAgoMatch","specificMonthMatch","numStr","num","target","subtract","format","targetWeekStart","startOf","targetWeekEnd","endOf","isAfter","monthNum","targetMonth","prefix","cardContext","character_styles","worldEvolutionService","informationDelayQueue","applyPressure","pressures","world","desire","powerLevel","spirit","isAmbitious","g","isPowerful","firstGoal","intensity","source","description","simulateReactions","reactions","pressure","sourceChar","newEvent","participants","sourcePressure","propagateRipples","ripple","random","sourceEventId","sphereOfInfluence","locationIds","factionIds","decayRate","distortion","delayDays","r","medium","baseSpeed","delayMilliseconds","arrivalTimestamp","newRipple","toFixed","getAvailableRipples","currentTime","remainingRipples","calculateDistance","locationIdA","locationIdB","locationA","locationB","epochId","locAData","locBData","sanitizeStateData","stat_data","lastProcessedMessageId","isLogHistoryLoaded","ZOD_ERROR_NOTIFIED_KEY","isZodErrorNotified","sessionStorage","checkForChangesAndNotify","oldState","oldChars","newChars","oldInventory","newInventory","allItemIds","oldQty","diff","itemName","action","oldUser","newUser","compareAndNotify","oldVal","newVal","allAttributes","attr","parseBlock","block","lines","currentKey","isParsingMultiLine","multiLineContent","line","trimmedLine","itemContent","itemSeparatorIndex","itemKey","itemValue","separatorIndex","loadWeeklyReviewsFromLorebook","reviewContent","allReviews","loadDiaryFromLorebook","diaryContent","combinedContent","allLogs","uniqueLogsMap","uniqueLogs","getTime","loadDiaryFragmentsFromLorebook","fragmentContent","allFragments","fragment","sections","headerLines","section","headerMatch","header","summaryMatch","parseDiaryFragment","frag","uniqueFragmentsMap","loadDirectorLogsFromLorebook","directorLogs","loadAllData","tavern","rawStateData","fullMessageContent","currentMessageId","removeItem","fixedData","cloneDeep","z","ZodError","issue","issues","code","received","expected","finalError","firstIssue","gameTextContent","fetchCoreData","isReady","handleAction","actionText","isReroll","isGenerating","is_user","lastMessage","updateScriptMatch","updateScript","jsonPatchMatch","patchContent","lastGeneratedPatch","updateLastPatchFromHistory","buildXmlTag","tagName","worldContextData","aiInput","aiResponseString","text","processedText","thinkingOpenIndex","thinkingCloseIndex","gametxtOpenIndex","newThinkingCloseIndex","gametxtOpenIndexAgain","gametxtCloseIndex","nextTagIndex","processTags","finalResponseString","response","gameTextMatch","latestState","newVariables","sanitizedVars","processAiResponse","newData","actionAsPressure","actionReactions","generationError","loadFutureStorylines","storylines","futureStorylines","rerollLastAction","initialState","avatarWorldNarrative","activeView","lastSubmittedAction","_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","__name","setup","__props","typeColorMap","isImageUrl","cardColor","levelColorMap","F","E","D","C","B","A","S","SS","SSS","cardRarityClass","level","cardStyle","_ctx","_cache","style","backgroundImage","item","required","effects","attributes_bonus","percentage_bonus","parts","locationDetails","parentLocationName","cleanValue","formatArea","area","formatCoordinates","coords","refId","refName","bearingParts","direction","angle","distanceParts","attributes","Infinity","filteredAttributes","$meta","rest","isAttribute","getAttributeLevelInfo","calculateProgress","levelInfo","progress","min","formatValue","output","width","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","physicalLevels","lv","mentalLevels","physicalLevelStatus","NSFW","phys","p","mentalLevelStatus","mind","age","birthDate","worldDate","formattedBirthDate","bd","AttributeGrid","trauma","childAttributes","isGridData","display","isObject","isAttributeGridData","every","v","isComplexAttribute","k","isSimpleValue","isDataItem","filterMeta","ComplexAttribute","current","dataValue","dataKey","subValue","subKey","ObjectRendererItem","isNested","filteredData","expandedProfiles","ref","watch","immediate","profile","onClick","$event","phrase","skill","skillName","ObjectRenderer","label","color","displayValue","isBidirectional","fillStyle","left","right","backgroundColor","vectorGroups","vectors","relations","allRelations","primaryRelations","targetId","expandedRelation","relation","relationId","group","vector","ProgressBar","items","DatabaseItemCard","npcId","yearExpansion","inventoryItems","database","backpack","quantity","itemDetails","category","categoryStore","groupedMemories","memory","getEmotionClass","emotion","InventoryGrid","RelationsDisplay","collapsed","toLocaleDateString","activeTab","tabs","tab","active","NpcArchiveTab","NpcPowerTab","NpcCauseTab","debugState","onMounted","formattedJson","formattedLastContext","formattedMainStory","formattedCalendarFixed","formattedCalendarRandom","formattedCalendarCrossover","formattedStyleGuide","potentialStory","recentEvents","potentialStoryCount","upcomingEventsCount","recentEventsCount","formattedPotentialStory","formattedUpcomingEvents","formattedRecentEvents","statusClass","clearAllMemoryLogs","selectedCard","showDetailView","backpackCards","DestinyCard","CardBackpackTab","diaryService","parseSingleDiaryEntry","bodyStartIndex","weatherMatch","currentSection","lastEvent","lastRelation","parseDiaryText","potentialBlocks","currentBlock","getDiaryEntries","isDiaryNavOpen","emits","__emit","isNavOpen","diaryList","selectedDiary","sectionsOpen","memos","toggleSection","default","_","open","memo","bg","defaultColor","getTypeTagStyle","colors","selectedItemForModal","selectedCategory","allItems","inventory","itemDatabase","itemData","fullItemData","groupedItems","groups","firstCategoryWithItems","itemsInSelectedCategory","getTypeStyle","ItemDetailPanel","FOLLOWED_NPCS_STORAGE_KEY","followedNpcs","useFollowSystem","isFollowed","toggleFollow","delete","unfollow","follow","newSet","deep","isFollowedState","toggle","watchEffect","followed","selectedNpc","selectedNpcId","npcSearchTerm","displayedNpcs","locationName","aFollowed","bFollowed","toLowerCase","newNpcs","goBackToList","NpcDetailDisplay","placeholder","FollowButton","DiaryPanel","skills","expandedSkills","isExpanded","exp","expToNextLevel","associatedSkills","expanded","activeSkill","isAutoMemoryEnabled","memoryContent","instant","short","long","activeMemoryContent","fetchMemoryContent","updateConfig","forceUpdate","handleMemoryUpdate","onUnmounted","for","number","defineComponent","fileInput","loadSlots","formatTimestamp","handleFileImport","files","file","reader","FileReader","onload","result","readAsText","slotToExport","$props","$setup","$data","$options","disabled","onChange","accept","SaveLoadPanel","MemoryPanel","DebugPanel","realm","req","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","worldType","worldSummary","mainWorld","avatarWorld","availableEpochs","epoch","selectedEpochId","newWorld","activeEpoch","definitions","innerHTML","RealmDetailCard","exports","sfc","__vccOpts","val","module","y","__webpack_require__","__WEBPACK_EXTERNAL_MODULE_https_testingcf_jsdelivr_net_npm_dayjs_esm_c37928cb__","Vue","toastr","__webpack_module_cache__","moduleId","cachedModule","__webpack_modules__","getter","__esModule","definition","o","defineProperty","enumerable","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","VueRouter","isZoomed","toggleZoom","zoomed","commandCount","option","$emit","commandService","commands","listeners","subscribe","listener","unsubscribe","notify","addCommand","command","getCommands","clearCommands","STORAGE_KEY_RECENT","STORAGE_KEY_SAVED","inputHistoryService","recent","saved","loadHistory","recentData","savedData","saveHistory","input","existingIndex","pop","save","deleteRecent","deleteSaved","clearAll","STORAGE_KEY","LAST_SUBMITTED_STORAGE_KEY","inputValue","lastSubmittedValue","setValue","setLastSubmittedValue","clearValue","inputModalState","inputModalActions","onInput","submitAction","trimmedInput","hasCommands","cmd","onKeypress","historyState","useEntry","isSaved","notification","hideNotification","Notification","icon","handleClick","clientX","clientY","npcNamesRegex","names","escapedNames","locationNamesRegex","activeWorld","databaseItemNamesRegex","segments","lastIndex","exec","parseEntities","matchedText","innerText","outerClass","combinedClass","parseText","entityRegexParts","entityRegex","getItemFromDatabase","relationshipClass","getNpcRelationshipClass","causalNet","emotionalSum","npcName","showNpcInfo","LocationInfoCard","showLocationInfo","FormattedTextRenderer","key_characters","key_locations","key_items","point","components","StorylineStageDetail","selectedDay","isDrawerOpen","currentYear","calendarDays","days","firstDayOfMonth","lastDayOfMonth","startDayOfWeek","getDay","daysInMonth","prevMonthLastDay","isCurrentMonth","dateString","dayEvents","monthDayKey","remainingDays","fetchedStorylines","firstEventDate","Number","newHistory","oldHistory","weekDays","prevMonth","setMonth","nextMonth","selectDay","toggleDrawer","_component_StorylineStageDetail","dayName","selected","summary","panelRegistry","defineAsyncComponent","worldDetails","destiny","system","npcDirectory","saveLoad","review","dockManagerService","goldenLayout","hostElement","componentMap","onAction","registerComponent","MainView","TimelinePanel","panel","componentName","panelInfo","addEventListener","updateLayout","loadLayout","getDefaultLayout","e2","loadSavedLayout","container","componentState","vueComponent","h","vnode","render","getElement","setTitle","panelId","openPanel","addComponent","updateSize","clientWidth","clientHeight","closeAllPanels","rootItem","contentItems","isClosable","remove","destroy","removeEventListener","unpinAllPanels","root","componentType","getFullscreenLayout","usePanelManager","dockHost","onBeforeUnmount","ref_key","tips","randomTip","progressInterval","stopProgress","clearInterval","floor","setInterval","newError","levelXpRequirements","nextLevelXp","xpPercentage","threshold","enum","findStage","currentStage","object","coerce","string","record","describe","optional","transform","or","literal","discriminatedUnion","currentLevelInfo","nextLevelIndex","nextLevelInfo","array","nullable","extend","NpcSchema","selectedStatus","selectedSkill","attributeTranslations","translateAttribute","formatDuration","full","getSkillLevelColor","getSkillExpCap","getSkillExpPercentage","cap","charAt","AttributeDisplay","charactersByLocation","hasChildren","children","charactersHere","_component_LocationNode","child","locationTree","locationsValue","roots","childrenOf","buildTree","nodes","node","LocationNode","forumService","posts","reviews","lastBbsLogContent","lastReviewLogContent","pollingInterval","startPolling","interval","fetchBbsPostsFromLorebook","fetchWeeklyReviewsFromLorebook","stopPolling","currentLogContent","parseDirectorLogForBbs","parseWeeklyReviews","allPosts","scriptId","postMatches","postMatch","author","reviewText","kHMatch","fXrqMatch","bZttMatch","yZRdZjMatch","post","$slots","smartphoneService","wallpaperContent","isLoading","fetchWallpaperContent","getState","iconClass","AppIcon","wallpaper","isWallpaperUrl","wallpaperStyle","backgroundSize","backgroundPosition","backgroundRepeat","apps","formattedDate","dateStr","currentWeather","futureWeather","_component_AppIcon","app","contacts","NpcDirectoryPanel","calendar","CharacterApp","DestinyCardPanel","InventoryPanel","forum","ForumPanel","MapApp","SystemPanel","HomeScreen","AppViewContainer","activeAppId","activeApp","shallowRef","updateTime","toTimeString","batteryLevel","ap","segmentAPMap","currentSegment","apSpent","percentage","round","batteryIcon","openApp","appId","goHome","getAppName","_component_HomeScreen","_component_AppViewContainer","onBack","onCloseDiaryNav","onOpenApp","dots","dot","used","onConfirm","onCancel","hideCancel","confirmationService","resolve","cancel","$","originalStyles","fullscreenService","enterWeb","iframeSelector","iframes","parent","getElementsByTagName","contentWindow","iframe","src","getAttribute","srcFileName","getIframeSelector","elementsToModify","top","height","zIndex","border","borderRadius","maxHeight","selector","$element","newStyles","css","documentElement","addClass","exitWeb","removeClass","toggleBrowser","onBrowserChange","isBrowserFullscreen","npcModalService","isWebFullscreen","isFullscreen","toggleBrowserFullscreen","toggleWebFullscreen","newFullscreenState","uiState","uiActions","chapterInfo","chapter","workTitle","fullChapterTitle","worldTimeInfo","timeSegment","dayOfWeek","toggleFullscreen","openSaveLoadPanel","openInputModal","fullscreenTitle","fullscreenIcon","actionPoints","ActionPointDisplay","toRefs","timeString","mainWorldTimeStr","NORMAL_LAYOUT_KEY","FULLSCREEN_LAYOUT_KEY","layoutService","activePanels","fullscreenPanels","loadAllLayouts","addPanel","removePanel","handleFullscreenChange","normalState","fullscreenState","saveLayoutState","currentMap","restoreLayout","panelsToRestore","setCurrentFullscreenState","DockManager","EnhancedInputBox","LoadingIndicator","NpcListModal","TopStatusBar","WorldTimeDisplay","SideMenuButton","NotificationContainer","ActionPanel","InputHistoryPopup","SmartphoneShell","FloatingCard","isSmartphoneOpen","confirmation","detailModal","npcModal","inputModal","isActionPanelVisible","isHistoryVisible","isQueueVisible","allOptions","actionContent","updateCommands","getElementById","panels","panelState","handleSubmit","rawInput","handleOverlayClick","toggleHistory","selectHistoryEntry","toggleCommandQueue","toggleSmartphone","_component_TopStatusBar","_component_DockManager","_component_LoadingIndicator","_component_NpcListModal","_component_EnhancedInputBox","_component_InputHistoryPopup","_component_NotificationContainer","_component_SmartphoneShell","_component_FloatingCard","modalClass","onSubmitAction","onToggleHistory","onClose","onSelectEntry","onCloseSmartphone","secondaryAttributes","todayCourses","getBaseAttributes","getSubjects","getSkills","getTalents","getRelationships","getters","baseAttributes","subjects","talents","relationships","subject","talent","course","rel","tooltip","visible","processedNarrative","handleMouseOver","dataType","dataset","dataName","getItemByName","formatTooltipContent","handleMouseOut","onMouseover","onMouseout","favorability","time","routes","MainContentView","CharacterView","NpcListView","InventoryView","router","createRouter","createMemoryHistory","createApp","use","mount","blockText","currentMajorKey","currentList","currentObjectInList","endsWith","lastKey","logSyncService","isSyncing","syncLogsFromChat","processLogs","lorebookEntry","storeKey","idKey","idParser","onNewLogFound","logBlockRegex","allNewBlocks","archiveContent","existingIds","allExistingBlocks","idMatch","localStoreRef","newItems","newBlockContents","parsed","contentToAppend","newDiaries","datesToArchive","fragments","fragmentsToArchive","remainingFragments","unwatch","newValue","initializeServices","then","lastInput","handleRerollRestore","lastDirectorLogContent"],"sourceRoot":""}