# 【设计提案】“归墟纪元悖论”系统 (Guixu Epoch Paradox System) - V2

## 1. 核心构想

为实现“在同一世界内进行跨纪元轮回”的核心玩法，本提案旨在将世界的“历史”从静态的背景描述，升级为一组可交互、可作为轮回起点的“世界状态快照”。

其核心目标是：

1.  **可扮演的纪元 (Playable Epochs)**: 玩家在选择一个世界后，不再是直接进入其“当前时间”，而是可以选择该世界历史长河中某一个关键的“纪元”作为降临的起点。
2.  **因果的涟漪 (Causal Ripples)**: 玩家在过去纪元中的行为，其影响将被系统记录。当玩家下一次轮回选择一个更晚的纪元时，这些过去的影响将作为“历史的惯性”被加载，从而实现“在过去埋下的种子，在未来开花结果”的玩法。
3.  **命运的道标 (Destiny Beacons)**:每一次轮回的结束，都将在对应世界的对应纪元时间轴上，留下一个“道标”，记录了化身的关键事迹和对世界的改变。这为AI推演后续纪元的历史提供了依据。

### 1.1. 核心机制：基于『回响』的纪元生成 (Echo Weaving)

为降低AI初次创世的负担，并将纪元解锁过程游戏化，本系统引入**“回响”**这一核心概念，将“渐进式解锁”升级为玩家主动参与的“创世”过程。

-   **初始单点**: AI在生成一个支持纪元穿越的世界时，**仅需生成一个** `可扮演: true` 的纪元作为初始轮回点。
-   **收集回响**: 玩家在轮回过程中，可以通过探索遗迹、击败强敌、完成任务等方式，获得名为**“回响”**的特殊物品。“回响”是“历史的遗物”或“未来的构想”的具象化。
-   **回响织世**: 玩家可以在特定界面（如轮回面板），组合收集到的“回响”，发动“织世”功能。
-   **动态生成与添加**: AI接收到玩家组合的“回响”后，会将其中的`纪元倾向`作为核心灵感，遵循`创世之心`COT动态生成一个全新的纪元，并通过 `<化身世界修改>` 指令，使用 `添加 到 '历史纪元'` 的方式，将其追加到世界书中，使其成为一个新的可扮演轮回起点。

## 2. 数据结构重构提案

### 2.1. 新增 `数据库.回响`

在 `[InitVar].txt` 的 `数据库` 模块下，新增 `回响` 分类。

```json
"数据库": {
  "回响": {
    "$meta": { "extensible": true, "description": "【纪元悖论系统核心】用于生成新纪元的“创世素材”。" },
    "echo_broken_godhood_01": {
      "名称": "破碎的神格",
      "类型": "历史遗物",
      "描述": "来自上一个纪元末期，某位陨落神祇最后的力量残响，其中蕴含着关于“法则崩坏”的零碎记忆。",
      "所属世界ID": "world_xuanhuang_01",
      "纪元倾向": ["神话时代", "法则崩坏", "权柄:混沌", "终末战争"]
    },
    "echo_singularity_concept_02": {
      "名称": "技术奇点构想",
      "类型": "未来构思",
      "描述": "一份来自某个失落文明的蓝图，描绘了意识上传、化身数字神明的未来愿景。",
      "所属世界ID": "world_cybernetics_01",
      "纪元倾向": ["科技飞升", "数字生命", "超脱", "权柄:信息"]
    }
  }
}
```
-   **`纪元倾向`**: 核心字段。这是一个关键词数组，AI将把这些词作为生成新纪元时的核心Prompt和灵感来源。

### 2.2. “纪元中心化”的世界结构

为了实现纪元的状态快照和渐进式解锁，我们需要对 `[系统]世界生成及演化规则.txt` 中定义的 `自动化规则` 进行一次 **“纪元中心化”** 的结构重构。

世界的顶层 `自动化规则` 将作为元数据容器，而所有详细的世界规则、内容和力量体系都将 **嵌套在各自所属的 `历史纪元` 对象内部**。

```yaml
自动化规则:
  基础信息:
    ID: "world_xuanhuang_01"
    名称: "玄黄界"
    描述: "一个在“神话”与“末法”之间轮回的修仙世界。"
  规则: # <- 顶层规则只保留最核心的元数据
    宇宙蓝图: "位面宇宙"
    物理尺度: "尺度等级 3"
    支持纪元穿越: true # 标志此世界支持新玩法
  历史纪元: # <- 成为核心容器
    - 纪元ID: "epoch_myth_era_01"
      纪元名称: "神话时代"
      可扮演: true
      纪元概述: "诸神行走于大地，巨兽肆虐，凡人于夹缝中求生..."
      # 【核心重构】从此往下，是完整的、属于这个纪元的世界定义
      规则:
        世界能级: 15
        时间流速: 1x
        # ... 此纪元特有的规则
      内容:
        空间实体:
          # ... 神话时代的地理和地点
        文明:
          # ... 神话时代的势力和文化
      力量体系:
        # ... 神话时代的力量体系和境界定义
    - 纪元ID: "epoch_dharma_end_02"
      纪元名称: "末法时代"
      可扮演: false # <- 初始锁定，等待玩家解锁
      纪元概述: "天地灵气枯竭，仙神绝迹，修士挣扎求存..."
      解锁条件: "在“神话时代”中，寻找到关于“灵脉枯竭”的真相。"
      规则:
        世界能级: 5
        # ...
      内容:
        # ... 末法时代的地理和势力
      力量体系:
        # ... 末法时代残缺的力量体系
```

### 2.2. 新增顶层变量：`往世道标 (Past-life Beacons)`

为了记录玩家在不同纪元留下的影响，我们需要在 `[InitVar].txt` 中新增一个顶层对象。

```json
{
  // ... 其他顶层对象如 数据库, 角色, 世界...
  "往世道标": {
    "$meta": { "extensible": true, "description": "【纪元悖论系统核心】记录每一次轮回在特定世界特定纪元留下的因果烙印。结构: [世界ID][纪元ID] = {道标信息}" },
    "world_xianxia_01": {
      "epoch_myth_era_01": {
        "化身ID": "avatar_hero_01",
        "最高成就": "封印上古魔神",
        "世界影响摘要": "成功封印魔神，为人类文明赢得了千年喘息，但也导致部分地域被魔气永久污染。",
        "遗留机缘": {
          "item_seed_of_worldtree_01": {
            "类型": "奇物种子",
            "埋藏地点ID": "location_holy_mountain_peak_01",
            "触发条件": "千年后，当身怀“神农血脉”的后人再次登顶时..."
          }
        }
      }
    }
  }
}
```

## 3. 核心玩法流程变更

### 3.1. 轮回准备阶段

1.  玩家选择目标世界。
2.  **【新增】纪元选择**: 如果 `世界.ID.规则.支持纪元穿越` 为 `true`，系统将读取该世界所有 `可扮演: true` 的 `历史纪元`，并将其`纪元概述`展示给玩家，供玩家选择一个作为降临的时间点。
3.  后续流程照旧。

### 3.2. 化身生成阶段

AI在执行“身份之心”COT时，**必须**将玩家选择的纪元作为核心情景。
-   生成的`可选化身`的`身份`、`当前位置`、`过去经历`等，都必须严格符合所选纪元的`纪元状态快照`。例如，在“神话时代”，化身可能是“神王的祭司”，但在“末法时代”，则可能是“最后一个修士”。

### 3.3. 轮回结束阶段

1.  AI正常生成`<往世涟漪>`作为当世总结。
2.  **【新增】生成道标**: AI必须根据本次轮回的`<往世涟漪>`，提炼核心信息，生成或更新一条`往世道标`记录，并使用 `_.assign` 指令将其写入。其中`遗留机缘`等需要AI发挥创造力，设计有趣的因果链。

## 4. AI 思考链 (COT) 调整

### 4.1. `【cot】创世之心.txt` & `【cot】创世必要关键cot.txt`

-   在生成支持纪元穿越的世界时，AI只需完整构思并生成 **一个** 可扮演的初始纪元及其嵌套的完整世界定义。
-   对于其他待解锁的纪元，只需生成其 `纪元ID`, `纪元名称`, `可扮演: false` 和一个简短的`解锁条件`（作为提示）即可，无需生成详细内容。

### 4.2. `【cot】身份之心.txt`

-   在核心构思阶段，必须增加一步：“**读取并解析目标纪元嵌套的 `规则`, `内容`, `力量体系`**”，并以此为基础来创造符合该时代背景的化身。

### 4.3. `【cot】天衍之心.txt` & `【cot】必要关键cot.txt` (常规推演)

-   在“情景分析”阶段，需要明确当前所处的`纪元`。
-   **【回响产出】**: 在“变量与日志构思”阶段，当玩家达成重大成就、探索到关键遗迹或击败传奇敌人时，AI应构思产出对应的“回响”，并为其创建模板、加入玩家背包。
-   **【回响织世】(新流程)**: 当玩家触发“织世”功能并提交“回响”组合时，AI的核心任务是：
    1.  **解析倾向**: 提取所有“回响”的`纪元倾向`关键词。
    2.  **启动创世**: 以这些关键词为核心Prompt，启动一次**微缩版的`创世之心`COT**，专门用于构思一个全新的纪元（包含其嵌套的规则、内容、力量体系）。
    3.  **动态添加**: 生成一条 `<化身世界修改>` 指令，使用 `添加 到 '历史纪元'` 将这个新纪元的完整定义追加到世界书。
-   **【因果触发】**: 当推演后续纪元的剧情时，AI有责任检索`往世道标`，检查当前情景是否满足了某个过去纪元留下的`遗留机缘`的`触发条件`。如果满足，则必须构思对应的剧情，让玩家“发现”自己过去留下的宝藏或苦果。

## 5. 前端界面影响 (简述)

-   `ReincarnationPanel.vue` (或相关面板) 需要进行改造，在世界选择后，增加一个“纪元选择”的步骤。
-   `WorldDetailModal.vue` 等世界信息展示界面，可以增加一个“历史年表”或“纪元”页签，用于展示世界的不同历史时期。

此提案旨在为“纪元穿越”玩法打下坚实的规则基础。一旦通过，后续的开发将围绕这些新的数据结构和逻辑流程展开。
