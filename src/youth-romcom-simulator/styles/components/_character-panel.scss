// [Theme] Reincarnation Simulator - Visual Recast
// Component: Character Panel
// File: _character-panel.scss

@use '../theme/variables' as *;
@use '../theme/mixins' as *;

.character-panel-container {
  container-type: inline-size; // Enable container queries

  .destiny-wheel {
    position: relative;
    width: 100%;
    max-width: 300px;
    aspect-ratio: 1 / 1;
    margin: $spacing-lg auto;
    display: grid;
    place-items: center;
  }

  .galaxy-background,
  .nodes-container {
    grid-area: 1 / 1;
    width: 100%;
    height: 100%;
  }

  .galaxy-background {
    background:
      radial-gradient(ellipse at center, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0) 40%),
      radial-gradient(ellipse at center, rgba($color-cyan-tian, 0.15) 0%, rgba($color-cyan-tian, 0) 70%),
      url('https://www.transparenttextures.com/patterns/stardust.png');
    background-color: $color-black-void;
    border-radius: 50%;

    &::before {
      content: '';
      position: absolute;
      inset: -10%;
      background: conic-gradient(from 0deg, transparent 50%, $color-cyan-tian 100%);
      border-radius: 50%;
      animation: rotate-galaxy 15s linear infinite;
    }
  }

  .nodes-container {
    position: relative;
  }

  .center-node {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 10;
    width: 40%; // Responsive size
    height: 40%; // Responsive size
    background: radial-gradient(circle, lighten($color-indigo-deep, 8%), $color-indigo-deep);
    border-radius: 50%;
    border: 2px solid $color-gold-liu;
    box-shadow:
      0 0 25px rgba($color-gold-liu, 0.7),
      inset 0 0 15px rgba($color-black-void, 0.9);
    @include flex-center;
    flex-direction: column;
    color: $color-gold-pale;
    font-family: $font-family-title;

    .label {
      font-size: 1.1rem; // Base size
    }
    .value {
      font-size: 2.2rem; // Base size
      font-weight: bold;
      text-shadow: 0 0 5px $color-gold-liu;
    }
  }

  .attribute-node {
    position: absolute;
    top: 50%; // Start from center
    left: 50%; // Start from center
    z-index: 5;
    width: 25%; // Responsive size
    height: 25%; // Responsive size
    transition: all 0.3s ease;
    // Positioning is handled by JS transform

    .star-core {
      width: 100%;
      height: 100%;
      background: radial-gradient(circle, lighten($color-charcoal-glass, 10%), $color-charcoal-glass);
      border-radius: 50%;
      border: 1px solid $color-cyan-tian;
      box-shadow:
        0 0 8px rgba($color-cyan-tian, 0.4),
        inset 0 0 5px rgba($color-black-void, 0.7);
      @include flex-center;
      flex-direction: column;
      color: $color-white-moon;

      .label {
        font-family: $font-family-title;
        font-size: 0.9rem; // Base size
        opacity: 0.8;
      }
      .value {
        font-size: 1.3rem; // Base size
      }
    }

    // Star Connector Line
    &::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 1px;
      // Dynamic height based on radius, using a CSS variable set from JS
      height: var(--radius);
      background: linear-gradient(to top, rgba($color-cyan-tian, 0.6) 0%, transparent 100%);
      transform-origin: bottom;
      transform: translate(-50%, -100%) rotate(var(--connector-rotation));
      z-index: -1;
    }

    &:hover {
      .star-core {
        transform: scale(1.1);
        box-shadow:
          0 0 20px $color-cyan-tian,
          0 0 30px rgba($color-white-moon, 0.7);
        border-color: lighten($color-cyan-tian, 20%);
      }
    }
  }
}

@keyframes rotate-galaxy {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@keyframes twinkle {
  0%,
  100% {
    opacity: 0.8;
    transform: scale(0.98);
  }
  50% {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes grow-line {
  from {
    height: 0;
  }
  to {
    height: 80px; // Adjust based on radius
  }
}

// Container Queries for responsive font sizes
@container (max-width: 250px) {
  .center-node {
    .label {
      font-size: 0.9rem;
    }
    .value {
      font-size: 1.8rem;
    }
  }
  .attribute-node .star-core {
    .label {
      font-size: 0.7rem;
    }
    .value {
      font-size: 1.1rem;
    }
  }
}

@container (max-width: 200px) {
  .center-node {
    .label {
      font-size: 0.7rem;
    }
    .value {
      font-size: 1.5rem;
    }
  }
  .attribute-node .star-core {
    .label {
      font-size: 0.6rem;
    }
    .value {
      font-size: 0.9rem;
    }
  }
}
